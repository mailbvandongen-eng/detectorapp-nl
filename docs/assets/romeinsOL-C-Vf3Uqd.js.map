{"version":3,"file":"romeinsOL-C-Vf3Uqd.js","sources":["../../src/layers/romeinsOL.ts"],"sourcesContent":["/**\n * Romeinse wegen Layers for OpenLayers\n * Itiner-E Roman road network dataset\n * Two versions:\n * - Romeinse wegen: filtered to Benelux + Rheinland (default for Detectie preset)\n * - Romeinse wegen (Wereld): complete world dataset\n */\n\nimport { Vector as VectorLayer } from 'ol/layer'\nimport { Vector as VectorSource } from 'ol/source'\nimport { Style, Stroke } from 'ol/style'\nimport type { Feature } from 'ol'\nimport type { Geometry, LineString, MultiLineString } from 'ol/geom'\nimport { loadGeoJSON, parseGeoJSON } from '../utils/layerLoaderOL.js'\n\n// Bounding box for Benelux + relevant Germany (Rheinland-Westfalen to Saarland/Frankfurt)\n// West: Belgium west, East: past Frankfurt, South: Saarland, North: North Netherlands\nconst BENELUX_BOUNDS = {\n  minLon: 2.5,\n  maxLon: 10.5,\n  minLat: 49.0,\n  maxLat: 54.0\n}\n\n// Cache styles per resolution to avoid recreating\nconst styleCache = new Map<string, Style>()\n\nfunction getLineWidth(resolution: number): number {\n  // Thinner when zoomed out, thicker when zoomed in\n  if (resolution > 300) return 0.5    // Very zoomed out\n  if (resolution > 150) return 0.75   // Zoomed out\n  if (resolution > 75) return 1       // Medium-far\n  if (resolution > 40) return 1.5     // Medium\n  if (resolution > 20) return 2       // Medium-close\n  if (resolution > 10) return 2.5     // Close\n  return 3                            // Very close\n}\n\nfunction createStyle(resolution: number): Style {\n  const width = getLineWidth(resolution)\n  const cacheKey = `roman-${width}`\n\n  let style = styleCache.get(cacheKey)\n  if (!style) {\n    style = new Style({\n      stroke: new Stroke({\n        color: '#dc2626',\n        width: width\n      })\n    })\n    styleCache.set(cacheKey, style)\n  }\n  return style\n}\n\n// Check if a feature intersects the bounding box\nfunction featureIntersectsBounds(feature: Feature<Geometry>): boolean {\n  const geometry = feature.getGeometry()\n  if (!geometry) return false\n\n  // Get coordinates based on geometry type\n  let coordinates: number[][] = []\n\n  if (geometry.getType() === 'LineString') {\n    coordinates = (geometry as LineString).getCoordinates()\n  } else if (geometry.getType() === 'MultiLineString') {\n    // Flatten all line coordinates\n    const lines = (geometry as MultiLineString).getCoordinates()\n    coordinates = lines.flat()\n  }\n\n  // Check if any coordinate is within bounds\n  return coordinates.some(coord => {\n    const [lon, lat] = coord\n    return lon >= BENELUX_BOUNDS.minLon &&\n           lon <= BENELUX_BOUNDS.maxLon &&\n           lat >= BENELUX_BOUNDS.minLat &&\n           lat <= BENELUX_BOUNDS.maxLat\n  })\n}\n\n/**\n * Romeinse wegen - filtered to Benelux + Rheinland region\n * Default layer for Detectie preset\n */\nexport async function createRomeinseWegenLayerOL() {\n  try {\n    const geojson = await loadGeoJSON('/detectorapp-nl/data/romeinse_wegen_itiner_e.geojson')\n    const allFeatures = parseGeoJSON(geojson)\n\n    // Filter to only features that intersect the Benelux bounds\n    const filteredFeatures = allFeatures.filter(featureIntersectsBounds)\n\n    const layer = new VectorLayer({\n      properties: { title: 'Romeinse wegen' },\n      source: new VectorSource({ features: filteredFeatures }),\n      style: (feature, resolution) => createStyle(resolution),\n      opacity: 0.8,\n      zIndex: 20\n    })\n\n    console.log(`✓ Romeinse wegen loaded (${filteredFeatures.length}/${allFeatures.length} features in Benelux region)`)\n    return layer\n\n  } catch (error) {\n    console.error('Failed to load Romeinse wegen layer:', error)\n    return null\n  }\n}\n\n/**\n * Romeinse wegen (Wereld) - complete world dataset\n * Optional layer for users who want to see the full network\n */\nexport async function createRomeinseWegenWereldLayerOL() {\n  try {\n    const geojson = await loadGeoJSON('/detectorapp-nl/data/romeinse_wegen_itiner_e.geojson')\n    const features = parseGeoJSON(geojson)\n\n    const layer = new VectorLayer({\n      properties: { title: 'Romeinse wegen (Wereld)' },\n      source: new VectorSource({ features }),\n      style: (feature, resolution) => createStyle(resolution),\n      opacity: 0.8,\n      zIndex: 20\n    })\n\n    console.log(`✓ Romeinse wegen (Wereld) loaded (${features.length} features)`)\n    return layer\n\n  } catch (error) {\n    console.error('Failed to load Romeinse wegen (Wereld) layer:', error)\n    return null\n  }\n}\n"],"names":["BENELUX_BOUNDS","styleCache","getLineWidth","resolution","createStyle","width","cacheKey","style","Style","Stroke","featureIntersectsBounds","feature","geometry","coordinates","coord","lon","lat","createRomeinseWegenLayerOL","geojson","loadGeoJSON","allFeatures","parseGeoJSON","filteredFeatures","layer","VectorLayer","VectorSource","error","createRomeinseWegenWereldLayerOL","features"],"mappings":"oHAiBA,MAAMA,EAAiB,CACrB,OAAQ,IACR,OAAQ,KACR,OAAQ,GACR,OAAQ,EACV,EAGMC,MAAiB,IAEvB,SAASC,EAAaC,EAA4B,CAEhD,OAAIA,EAAa,IAAY,GACzBA,EAAa,IAAY,IACzBA,EAAa,GAAW,EACxBA,EAAa,GAAW,IACxBA,EAAa,GAAW,EACxBA,EAAa,GAAW,IACrB,CACT,CAEA,SAASC,EAAYD,EAA2B,CAC9C,MAAME,EAAQH,EAAaC,CAAU,EAC/BG,EAAW,SAASD,CAAK,GAE/B,IAAIE,EAAQN,EAAW,IAAIK,CAAQ,EACnC,OAAKC,IACHA,EAAQ,IAAIC,EAAM,CAChB,OAAQ,IAAIC,EAAO,CACjB,MAAO,UACP,MAAAJ,CAAA,CACD,CAAA,CACF,EACDJ,EAAW,IAAIK,EAAUC,CAAK,GAEzBA,CACT,CAGA,SAASG,EAAwBC,EAAqC,CACpE,MAAMC,EAAWD,EAAQ,YAAA,EACzB,GAAI,CAACC,EAAU,MAAO,GAGtB,IAAIC,EAA0B,CAAA,EAE9B,OAAID,EAAS,QAAA,IAAc,aACzBC,EAAeD,EAAwB,eAAA,EAC9BA,EAAS,QAAA,IAAc,oBAGhCC,EADeD,EAA6B,eAAA,EACxB,KAAA,GAIfC,EAAY,KAAKC,GAAS,CAC/B,KAAM,CAACC,EAAKC,CAAG,EAAIF,EACnB,OAAOC,GAAOf,EAAe,QACtBe,GAAOf,EAAe,QACtBgB,GAAOhB,EAAe,QACtBgB,GAAOhB,EAAe,MAC/B,CAAC,CACH,CAMA,eAAsBiB,GAA6B,CACjD,GAAI,CACF,MAAMC,EAAU,MAAMC,EAAY,sDAAsD,EAClFC,EAAcC,EAAaH,CAAO,EAGlCI,EAAmBF,EAAY,OAAOV,CAAuB,EAE7Da,EAAQ,IAAIC,EAAY,CAC5B,WAAY,CAAE,MAAO,gBAAA,EACrB,OAAQ,IAAIC,EAAa,CAAE,SAAUH,EAAkB,EACvD,MAAO,CAACX,EAASR,IAAeC,EAAYD,CAAU,EACtD,QAAS,GACT,OAAQ,EAAA,CACT,EAED,eAAQ,IAAI,4BAA4BmB,EAAiB,MAAM,IAAIF,EAAY,MAAM,8BAA8B,EAC5GG,CAET,OAASG,EAAO,CACd,eAAQ,MAAM,uCAAwCA,CAAK,EACpD,IACT,CACF,CAMA,eAAsBC,GAAmC,CACvD,GAAI,CACF,MAAMT,EAAU,MAAMC,EAAY,sDAAsD,EAClFS,EAAWP,EAAaH,CAAO,EAE/BK,EAAQ,IAAIC,EAAY,CAC5B,WAAY,CAAE,MAAO,yBAAA,EACrB,OAAQ,IAAIC,EAAa,CAAE,SAAAG,EAAU,EACrC,MAAO,CAACjB,EAASR,IAAeC,EAAYD,CAAU,EACtD,QAAS,GACT,OAAQ,EAAA,CACT,EAED,eAAQ,IAAI,qCAAqCyB,EAAS,MAAM,YAAY,EACrEL,CAET,OAASG,EAAO,CACd,eAAQ,MAAM,gDAAiDA,CAAK,EAC7D,IACT,CACF"}