const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/amkOL-CvnJoHr-.js","assets/layerLoaderOL-CPt8TpSh.js","assets/GeoJSON-CXQnNmht.js","assets/romeinsOL-BPRLEMA-.js","assets/castellaPuntenOL-Cbl-KAvL.js","assets/iconStyles-Co-sQSgI.js","assets/castellaLijnenOL-r0dxOzVh.js","assets/oppidaOL-CrgJsLHM.js","assets/kastelenOL-Bwx9CyfT.js","assets/veengebiedenOL-BHdNseVt.js","assets/hunebeddenOL-CjBKsTP4.js","assets/euroevolOL-D00kBV09.js","assets/uikavArcheoPuntenOL-bGdBlEZg.js","assets/proj4-CArpAlnP.js","assets/uikavVlakkenOL-Cy1K8DJK.js","assets/uikavBufferlaagOL-CEBpYVc-.js","assets/uikavExpertOL-BADSr80x.js","assets/uikavUiterwaardenOL-YQOmu04g.js","assets/speeltuinenOL-C8v2anin.js","assets/museaOL-BCTR1P1N.js","assets/strandjesOL-B6mS4AMD.js","assets/parkenOL-CR29JWZA.js","assets/fossielenOL-OFMQusCb.js","assets/bunkersOL-23i1oAUR.js","assets/grafheuvelsOL-B1UvCWF3.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();function kw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fv={exports:{}},Rd={},Gv={exports:{}},Zt={};var S2;function $O(){if(S2)return Zt;S2=1;var n=Symbol.for("react.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function m($){return $===null||typeof $!="object"?null:($=g&&$[g]||$["@@iterator"],typeof $=="function"?$:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,S={};function w($,K,At){this.props=$,this.context=K,this.refs=S,this.updater=At||v}w.prototype.isReactComponent={},w.prototype.setState=function($,K){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,K,"setState")},w.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function R(){}R.prototype=w.prototype;function P($,K,At){this.props=$,this.context=K,this.refs=S,this.updater=At||v}var M=P.prototype=new R;M.constructor=P,y(M,w.prototype),M.isPureReactComponent=!0;var L=Array.isArray,D=Object.prototype.hasOwnProperty,j={current:null},b={key:!0,ref:!0,__self:!0,__source:!0};function A($,K,At){var Rt,Pt={},Nt=null,Vt=null;if(K!=null)for(Rt in K.ref!==void 0&&(Vt=K.ref),K.key!==void 0&&(Nt=""+K.key),K)D.call(K,Rt)&&!b.hasOwnProperty(Rt)&&(Pt[Rt]=K[Rt]);var $t=arguments.length-2;if($t===1)Pt.children=At;else if(1<$t){for(var Xt=Array($t),ye=0;ye<$t;ye++)Xt[ye]=arguments[ye+2];Pt.children=Xt}if($&&$.defaultProps)for(Rt in $t=$.defaultProps,$t)Pt[Rt]===void 0&&(Pt[Rt]=$t[Rt]);return{$$typeof:n,type:$,key:Nt,ref:Vt,props:Pt,_owner:j.current}}function k($,K){return{$$typeof:n,type:$.type,key:K,ref:$.ref,props:$.props,_owner:$._owner}}function V($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function F($){var K={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(At){return K[At]})}var U=/\/+/g;function N($,K){return typeof $=="object"&&$!==null&&$.key!=null?F(""+$.key):K.toString(36)}function ut($,K,At,Rt,Pt){var Nt=typeof $;(Nt==="undefined"||Nt==="boolean")&&($=null);var Vt=!1;if($===null)Vt=!0;else switch(Nt){case"string":case"number":Vt=!0;break;case"object":switch($.$$typeof){case n:case t:Vt=!0}}if(Vt)return Vt=$,Pt=Pt(Vt),$=Rt===""?"."+N(Vt,0):Rt,L(Pt)?(At="",$!=null&&(At=$.replace(U,"$&/")+"/"),ut(Pt,K,At,"",function(ye){return ye})):Pt!=null&&(V(Pt)&&(Pt=k(Pt,At+(!Pt.key||Vt&&Vt.key===Pt.key?"":(""+Pt.key).replace(U,"$&/")+"/")+$)),K.push(Pt)),1;if(Vt=0,Rt=Rt===""?".":Rt+":",L($))for(var $t=0;$t<$.length;$t++){Nt=$[$t];var Xt=Rt+N(Nt,$t);Vt+=ut(Nt,K,At,Xt,Pt)}else if(Xt=m($),typeof Xt=="function")for($=Xt.call($),$t=0;!(Nt=$.next()).done;)Nt=Nt.value,Xt=Rt+N(Nt,$t++),Vt+=ut(Nt,K,At,Xt,Pt);else if(Nt==="object")throw K=String($),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Vt}function wt($,K,At){if($==null)return $;var Rt=[],Pt=0;return ut($,Rt,"","",function(Nt){return K.call(At,Nt,Pt++)}),Rt}function yt($){if($._status===-1){var K=$._result;K=K(),K.then(function(At){($._status===0||$._status===-1)&&($._status=1,$._result=At)},function(At){($._status===0||$._status===-1)&&($._status=2,$._result=At)}),$._status===-1&&($._status=0,$._result=K)}if($._status===1)return $._result.default;throw $._result}var dt={current:null},J={transition:null},at={ReactCurrentDispatcher:dt,ReactCurrentBatchConfig:J,ReactCurrentOwner:j};function it(){throw Error("act(...) is not supported in production builds of React.")}return Zt.Children={map:wt,forEach:function($,K,At){wt($,function(){K.apply(this,arguments)},At)},count:function($){var K=0;return wt($,function(){K++}),K},toArray:function($){return wt($,function(K){return K})||[]},only:function($){if(!V($))throw Error("React.Children.only expected to receive a single React element child.");return $}},Zt.Component=w,Zt.Fragment=e,Zt.Profiler=r,Zt.PureComponent=P,Zt.StrictMode=i,Zt.Suspense=u,Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=at,Zt.act=it,Zt.cloneElement=function($,K,At){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var Rt=y({},$.props),Pt=$.key,Nt=$.ref,Vt=$._owner;if(K!=null){if(K.ref!==void 0&&(Nt=K.ref,Vt=j.current),K.key!==void 0&&(Pt=""+K.key),$.type&&$.type.defaultProps)var $t=$.type.defaultProps;for(Xt in K)D.call(K,Xt)&&!b.hasOwnProperty(Xt)&&(Rt[Xt]=K[Xt]===void 0&&$t!==void 0?$t[Xt]:K[Xt])}var Xt=arguments.length-2;if(Xt===1)Rt.children=At;else if(1<Xt){$t=Array(Xt);for(var ye=0;ye<Xt;ye++)$t[ye]=arguments[ye+2];Rt.children=$t}return{$$typeof:n,type:$.type,key:Pt,ref:Nt,props:Rt,_owner:Vt}},Zt.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:s,_context:$},$.Consumer=$},Zt.createElement=A,Zt.createFactory=function($){var K=A.bind(null,$);return K.type=$,K},Zt.createRef=function(){return{current:null}},Zt.forwardRef=function($){return{$$typeof:a,render:$}},Zt.isValidElement=V,Zt.lazy=function($){return{$$typeof:d,_payload:{_status:-1,_result:$},_init:yt}},Zt.memo=function($,K){return{$$typeof:h,type:$,compare:K===void 0?null:K}},Zt.startTransition=function($){var K=J.transition;J.transition={};try{$()}finally{J.transition=K}},Zt.unstable_act=it,Zt.useCallback=function($,K){return dt.current.useCallback($,K)},Zt.useContext=function($){return dt.current.useContext($)},Zt.useDebugValue=function(){},Zt.useDeferredValue=function($){return dt.current.useDeferredValue($)},Zt.useEffect=function($,K){return dt.current.useEffect($,K)},Zt.useId=function(){return dt.current.useId()},Zt.useImperativeHandle=function($,K,At){return dt.current.useImperativeHandle($,K,At)},Zt.useInsertionEffect=function($,K){return dt.current.useInsertionEffect($,K)},Zt.useLayoutEffect=function($,K){return dt.current.useLayoutEffect($,K)},Zt.useMemo=function($,K){return dt.current.useMemo($,K)},Zt.useReducer=function($,K,At){return dt.current.useReducer($,K,At)},Zt.useRef=function($){return dt.current.useRef($)},Zt.useState=function($){return dt.current.useState($)},Zt.useSyncExternalStore=function($,K,At){return dt.current.useSyncExternalStore($,K,At)},Zt.useTransition=function(){return dt.current.useTransition()},Zt.version="18.3.1",Zt}var I2;function dg(){return I2||(I2=1,Gv.exports=$O()),Gv.exports}var A2;function WO(){if(A2)return Rd;A2=1;var n=dg(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,h){var d,g={},m=null,v=null;h!==void 0&&(m=""+h),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(v=u.ref);for(d in u)i.call(u,d)&&!s.hasOwnProperty(d)&&(g[d]=u[d]);if(a&&a.defaultProps)for(d in u=a.defaultProps,u)g[d]===void 0&&(g[d]=u[d]);return{$$typeof:t,type:a,key:m,ref:v,props:g,_owner:r.current}}return Rd.Fragment=e,Rd.jsx=o,Rd.jsxs=o,Rd}var R2;function KO(){return R2||(R2=1,Fv.exports=WO()),Fv.exports}var z=KO(),np={},Uv={exports:{}},wi={},jv={exports:{}},zv={};var P2;function qO(){return P2||(P2=1,(function(n){function t(J,at){var it=J.length;J.push(at);t:for(;0<it;){var $=it-1>>>1,K=J[$];if(0<r(K,at))J[$]=at,J[it]=K,it=$;else break t}}function e(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var at=J[0],it=J.pop();if(it!==at){J[0]=it;t:for(var $=0,K=J.length,At=K>>>1;$<At;){var Rt=2*($+1)-1,Pt=J[Rt],Nt=Rt+1,Vt=J[Nt];if(0>r(Pt,it))Nt<K&&0>r(Vt,Pt)?(J[$]=Vt,J[Nt]=it,$=Nt):(J[$]=Pt,J[Rt]=it,$=Rt);else if(Nt<K&&0>r(Vt,it))J[$]=Vt,J[Nt]=it,$=Nt;else break t}}return at}function r(J,at){var it=J.sortIndex-at.sortIndex;return it!==0?it:J.id-at.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],h=[],d=1,g=null,m=3,v=!1,y=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(J){for(var at=e(h);at!==null;){if(at.callback===null)i(h);else if(at.startTime<=J)i(h),at.sortIndex=at.expirationTime,t(u,at);else break;at=e(h)}}function L(J){if(S=!1,M(J),!y)if(e(u)!==null)y=!0,yt(D);else{var at=e(h);at!==null&&dt(L,at.startTime-J)}}function D(J,at){y=!1,S&&(S=!1,R(A),A=-1),v=!0;var it=m;try{for(M(at),g=e(u);g!==null&&(!(g.expirationTime>at)||J&&!F());){var $=g.callback;if(typeof $=="function"){g.callback=null,m=g.priorityLevel;var K=$(g.expirationTime<=at);at=n.unstable_now(),typeof K=="function"?g.callback=K:g===e(u)&&i(u),M(at)}else i(u);g=e(u)}if(g!==null)var At=!0;else{var Rt=e(h);Rt!==null&&dt(L,Rt.startTime-at),At=!1}return At}finally{g=null,m=it,v=!1}}var j=!1,b=null,A=-1,k=5,V=-1;function F(){return!(n.unstable_now()-V<k)}function U(){if(b!==null){var J=n.unstable_now();V=J;var at=!0;try{at=b(!0,J)}finally{at?N():(j=!1,b=null)}}else j=!1}var N;if(typeof P=="function")N=function(){P(U)};else if(typeof MessageChannel<"u"){var ut=new MessageChannel,wt=ut.port2;ut.port1.onmessage=U,N=function(){wt.postMessage(null)}}else N=function(){w(U,0)};function yt(J){b=J,j||(j=!0,N())}function dt(J,at){A=w(function(){J(n.unstable_now())},at)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){y||v||(y=!0,yt(D))},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return e(u)},n.unstable_next=function(J){switch(m){case 1:case 2:case 3:var at=3;break;default:at=m}var it=m;m=at;try{return J()}finally{m=it}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,at){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var it=m;m=J;try{return at()}finally{m=it}},n.unstable_scheduleCallback=function(J,at,it){var $=n.unstable_now();switch(typeof it=="object"&&it!==null?(it=it.delay,it=typeof it=="number"&&0<it?$+it:$):it=$,J){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=it+K,J={id:d++,callback:at,priorityLevel:J,startTime:it,expirationTime:K,sortIndex:-1},it>$?(J.sortIndex=it,t(h,J),e(u)===null&&J===e(h)&&(S?(R(A),A=-1):S=!0,dt(L,it-$))):(J.sortIndex=K,t(u,J),y||v||(y=!0,yt(D))),J},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(J){var at=m;return function(){var it=m;m=at;try{return J.apply(this,arguments)}finally{m=it}}}})(zv)),zv}var C2;function HO(){return C2||(C2=1,jv.exports=qO()),jv.exports}var M2;function XO(){if(M2)return wi;M2=1;var n=dg(),t=HO();function e(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(l,c){o(l,c),o(l+"Capture",c)}function o(l,c){for(r[l]=c,l=0;l<c.length;l++)i.add(c[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function m(l){return u.call(g,l)?!0:u.call(d,l)?!1:h.test(l)?g[l]=!0:(d[l]=!0,!1)}function v(l,c,f,_){if(f!==null&&f.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return _?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,c,f,_){if(c===null||typeof c>"u"||v(l,c,f,_))return!0;if(_)return!1;if(f!==null)switch(f.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function S(l,c,f,_,E,x,C){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=_,this.attributeNamespace=E,this.mustUseProperty=f,this.propertyName=l,this.type=c,this.sanitizeURL=x,this.removeEmptyString=C}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new S(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var c=l[0];w[c]=new S(c,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new S(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new S(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new S(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new S(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new S(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new S(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new S(l,5,!1,l.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function P(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var c=l.replace(R,P);w[c]=new S(c,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var c=l.replace(R,P);w[c]=new S(c,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var c=l.replace(R,P);w[c]=new S(c,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new S(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new S(l,1,!1,l.toLowerCase(),null,!0,!0)});function M(l,c,f,_){var E=w.hasOwnProperty(c)?w[c]:null;(E!==null?E.type!==0:_||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,f,E,_)&&(f=null),_||E===null?m(c)&&(f===null?l.removeAttribute(c):l.setAttribute(c,""+f)):E.mustUseProperty?l[E.propertyName]=f===null?E.type===3?!1:"":f:(c=E.attributeName,_=E.attributeNamespace,f===null?l.removeAttribute(c):(E=E.type,f=E===3||E===4&&f===!0?"":""+f,_?l.setAttributeNS(_,c,f):l.setAttribute(c,f))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),j=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),F=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),ut=Symbol.for("react.suspense_list"),wt=Symbol.for("react.memo"),yt=Symbol.for("react.lazy"),dt=Symbol.for("react.offscreen"),J=Symbol.iterator;function at(l){return l===null||typeof l!="object"?null:(l=J&&l[J]||l["@@iterator"],typeof l=="function"?l:null)}var it=Object.assign,$;function K(l){if($===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);$=c&&c[1]||""}return`
`+$+l}var At=!1;function Rt(l,c){if(!l||At)return"";At=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Z){var _=Z}Reflect.construct(l,[],c)}else{try{c.call()}catch(Z){_=Z}l.call(c.prototype)}else{try{throw Error()}catch(Z){_=Z}l()}}catch(Z){if(Z&&_&&typeof Z.stack=="string"){for(var E=Z.stack.split(`
`),x=_.stack.split(`
`),C=E.length-1,G=x.length-1;1<=C&&0<=G&&E[C]!==x[G];)G--;for(;1<=C&&0<=G;C--,G--)if(E[C]!==x[G]){if(C!==1||G!==1)do if(C--,G--,0>G||E[C]!==x[G]){var B=`
`+E[C].replace(" at new "," at ");return l.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",l.displayName)),B}while(1<=C&&0<=G);break}}}finally{At=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?K(l):""}function Pt(l){switch(l.tag){case 5:return K(l.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return l=Rt(l.type,!1),l;case 11:return l=Rt(l.type.render,!1),l;case 1:return l=Rt(l.type,!0),l;default:return""}}function Nt(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case b:return"Fragment";case j:return"Portal";case k:return"Profiler";case A:return"StrictMode";case N:return"Suspense";case ut:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case F:return(l.displayName||"Context")+".Consumer";case V:return(l._context.displayName||"Context")+".Provider";case U:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case wt:return c=l.displayName||null,c!==null?c:Nt(l.type)||"Memo";case yt:c=l._payload,l=l._init;try{return Nt(l(c))}catch{}}return null}function Vt(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nt(c);case 8:return c===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function $t(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Xt(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ye(l){var c=Xt(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,c),_=""+l[c];if(!l.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,x=f.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return E.call(this)},set:function(C){_=""+C,x.call(this,C)}}),Object.defineProperty(l,c,{enumerable:f.enumerable}),{getValue:function(){return _},setValue:function(C){_=""+C},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function Ar(l){l._valueTracker||(l._valueTracker=ye(l))}function Fs(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var f=c.getValue(),_="";return l&&(_=Xt(l)?l.checked?"true":"false":l.value),l=_,l!==f?(c.setValue(l),!0):!1}function fi(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function gi(l,c){var f=c.checked;return it({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function An(l,c){var f=c.defaultValue==null?"":c.defaultValue,_=c.checked!=null?c.checked:c.defaultChecked;f=$t(c.value!=null?c.value:f),l._wrapperState={initialChecked:_,initialValue:f,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Rn(l,c){c=c.checked,c!=null&&M(l,"checked",c,!1)}function mi(l,c){Rn(l,c);var f=$t(c.value),_=c.type;if(f!=null)_==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(_==="submit"||_==="reset"){l.removeAttribute("value");return}c.hasOwnProperty("value")?Re(l,c.type,f):c.hasOwnProperty("defaultValue")&&Re(l,c.type,$t(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(l.defaultChecked=!!c.defaultChecked)}function Ji(l,c,f){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var _=c.type;if(!(_!=="submit"&&_!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+l._wrapperState.initialValue,f||c===l.value||(l.value=c),l.defaultValue=c}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function Re(l,c,f){(c!=="number"||fi(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var ve=Array.isArray;function yn(l,c,f,_){if(l=l.options,c){c={};for(var E=0;E<f.length;E++)c["$"+f[E]]=!0;for(f=0;f<l.length;f++)E=c.hasOwnProperty("$"+l[f].value),l[f].selected!==E&&(l[f].selected=E),E&&_&&(l[f].defaultSelected=!0)}else{for(f=""+$t(f),c=null,E=0;E<l.length;E++){if(l[E].value===f){l[E].selected=!0,_&&(l[E].defaultSelected=!0);return}c!==null||l[E].disabled||(c=l[E])}c!==null&&(c.selected=!0)}}function tr(l,c){if(c.dangerouslySetInnerHTML!=null)throw Error(e(91));return it({},c,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function De(l,c){var f=c.value;if(f==null){if(f=c.children,c=c.defaultValue,f!=null){if(c!=null)throw Error(e(92));if(ve(f)){if(1<f.length)throw Error(e(93));f=f[0]}c=f}c==null&&(c=""),f=c}l._wrapperState={initialValue:$t(f)}}function Co(l,c){var f=$t(c.value),_=$t(c.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),c.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),_!=null&&(l.defaultValue=""+_)}function er(l){var c=l.textContent;c===l._wrapperState.initialValue&&c!==""&&c!==null&&(l.value=c)}function Yr(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rr(l,c){return l==null||l==="http://www.w3.org/1999/xhtml"?Yr(c):l==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Zr,Xa=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,f,_,E){MSApp.execUnsafeLocalFunction(function(){return l(c,f,_,E)})}:l})(function(l,c){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=c;else{for(Zr=Zr||document.createElement("div"),Zr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Zr.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;c.firstChild;)l.appendChild(c.firstChild)}});function Qr(l,c){if(c){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=c;return}}l.textContent=c}var nr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pu=["Webkit","ms","Moz","O"];Object.keys(nr).forEach(function(l){Pu.forEach(function(c){c=c+l.charAt(0).toUpperCase()+l.substring(1),nr[c]=nr[l]})});function Jr(l,c,f){return c==null||typeof c=="boolean"||c===""?"":f||typeof c!="number"||c===0||nr.hasOwnProperty(l)&&nr[l]?(""+c).trim():c+"px"}function Gs(l,c){l=l.style;for(var f in c)if(c.hasOwnProperty(f)){var _=f.indexOf("--")===0,E=Jr(f,c[f],_);f==="float"&&(f="cssFloat"),_?l.setProperty(f,E):l[f]=E}}var Mo=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ii(l,c){if(c){if(Mo[l]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(e(137,l));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(e(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(e(61))}if(c.style!=null&&typeof c.style!="object")throw Error(e(62))}}function Us(l,c){if(l.indexOf("-")===-1)return typeof c.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ts=null;function es(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var ri=null,si=null,Ie=null;function bo(l){if(l=dd(l)){if(typeof ri!="function")throw Error(e(280));var c=l.stateNode;c&&(c=_m(c),ri(l.stateNode,l.type,c))}}function Pr(l){si?Ie?Ie.push(l):Ie=[l]:si=l}function Ye(){if(si){var l=si,c=Ie;if(Ie=si=null,bo(l),c)for(l=0;l<c.length;l++)bo(c[l])}}function ir(l,c){return l(c)}function Pn(){}var Ze=!1;function Cn(l,c,f){if(Ze)return l(c,f);Ze=!0;try{return ir(l,c,f)}finally{Ze=!1,(si!==null||Ie!==null)&&(Pn(),Ye())}}function Mn(l,c){var f=l.stateNode;if(f===null)return null;var _=_m(f);if(_===null)return null;f=_[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(l=l.type,_=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!_;break t;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(e(231,c,typeof f));return f}var vn=!1;if(a)try{var ce={};Object.defineProperty(ce,"passive",{get:function(){vn=!0}}),window.addEventListener("test",ce,ce),window.removeEventListener("test",ce,ce)}catch{vn=!1}function rn(l,c,f,_,E,x,C,G,B){var Z=Array.prototype.slice.call(arguments,3);try{c.apply(f,Z)}catch(ot){this.onError(ot)}}var cn=!1,rr=null,Cu=!1,sr=null,Xg={onError:function(l){cn=!0,rr=l}};function Yg(l,c,f,_,E,x,C,G,B){cn=!1,rr=null,rn.apply(Xg,arguments)}function Uh(l,c,f,_,E,x,C,G,B){if(Yg.apply(this,arguments),cn){if(cn){var Z=rr;cn=!1,rr=null}else throw Error(e(198));Cu||(Cu=!0,sr=Z)}}function Cr(l){var c=l,f=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(f=c.return),l=c.return;while(l)}return c.tag===3?f:null}function jh(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function Zg(l){if(Cr(l)!==l)throw Error(e(188))}function Qg(l){var c=l.alternate;if(!c){if(c=Cr(l),c===null)throw Error(e(188));return c!==l?null:l}for(var f=l,_=c;;){var E=f.return;if(E===null)break;var x=E.alternate;if(x===null){if(_=E.return,_!==null){f=_;continue}break}if(E.child===x.child){for(x=E.child;x;){if(x===f)return Zg(E),l;if(x===_)return Zg(E),c;x=x.sibling}throw Error(e(188))}if(f.return!==_.return)f=E,_=x;else{for(var C=!1,G=E.child;G;){if(G===f){C=!0,f=E,_=x;break}if(G===_){C=!0,_=E,f=x;break}G=G.sibling}if(!C){for(G=x.child;G;){if(G===f){C=!0,f=x,_=E;break}if(G===_){C=!0,_=x,f=E;break}G=G.sibling}if(!C)throw Error(e(189))}}if(f.alternate!==_)throw Error(e(190))}if(f.tag!==3)throw Error(e(188));return f.stateNode.current===f?l:c}function Jg(l){return l=Qg(l),l!==null?Ya(l):null}function Ya(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=Ya(l);if(c!==null)return c;l=l.sibling}return null}var zh=t.unstable_scheduleCallback,Mu=t.unstable_cancelCallback,Za=t.unstable_shouldYield,js=t.unstable_requestPaint,Ce=t.unstable_now,my=t.unstable_getCurrentPriorityLevel,bu=t.unstable_ImmediatePriority,Bh=t.unstable_UserBlockingPriority,Qa=t.unstable_NormalPriority,$h=t.unstable_LowPriority,ku=t.unstable_IdlePriority,Ja=null,Li=null;function tm(l){if(Li&&typeof Li.onCommitFiberRoot=="function")try{Li.onCommitFiberRoot(Ja,l,void 0,(l.current.flags&128)===128)}catch{}}var Di=Math.clz32?Math.clz32:tl,ns=Math.log,or=Math.LN2;function tl(l){return l>>>=0,l===0?32:31-(ns(l)/or|0)|0}var is=64,ko=4194304;function he(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function zs(l,c){var f=l.pendingLanes;if(f===0)return 0;var _=0,E=l.suspendedLanes,x=l.pingedLanes,C=f&268435455;if(C!==0){var G=C&~E;G!==0?_=he(G):(x&=C,x!==0&&(_=he(x)))}else C=f&~E,C!==0?_=he(C):x!==0&&(_=he(x));if(_===0)return 0;if(c!==0&&c!==_&&(c&E)===0&&(E=_&-_,x=c&-c,E>=x||E===16&&(x&4194240)!==0))return c;if((_&4)!==0&&(_|=f&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=_;0<c;)f=31-Di(c),E=1<<f,_|=l[f],c&=~E;return _}function el(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nl(l,c){for(var f=l.suspendedLanes,_=l.pingedLanes,E=l.expirationTimes,x=l.pendingLanes;0<x;){var C=31-Di(x),G=1<<C,B=E[C];B===-1?((G&f)===0||(G&_)!==0)&&(E[C]=el(G,c)):B<=c&&(l.expiredLanes|=G),x&=~G}}function Wh(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Kh(){var l=is;return is<<=1,(is&4194240)===0&&(is=64),l}function qh(l){for(var c=[],f=0;31>f;f++)c.push(l);return c}function il(l,c,f){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Di(c),l[c]=f}function py(l,c){var f=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<f;){var E=31-Di(f),x=1<<E;c[E]=0,_[E]=-1,l[E]=-1,f&=~x}}function Hh(l,c){var f=l.entangledLanes|=c;for(l=l.entanglements;f;){var _=31-Di(f),E=1<<_;E&c|l[_]&c&&(l[_]|=c),f&=~E}}var ee=0;function rs(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Xh,Lu,Yh,Zh,Qh,ss=!1,Du=[],os=null,as=null,bn=null,rl=new Map,Bs=new Map,Ni=[],em="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lo(l,c){switch(l){case"focusin":case"focusout":os=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":bn=null;break;case"pointerover":case"pointerout":rl.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bs.delete(c.pointerId)}}function Mr(l,c,f,_,E,x){return l===null||l.nativeEvent!==x?(l={blockedOn:c,domEventName:f,eventSystemFlags:_,nativeEvent:x,targetContainers:[E]},c!==null&&(c=dd(c),c!==null&&Lu(c)),l):(l.eventSystemFlags|=_,c=l.targetContainers,E!==null&&c.indexOf(E)===-1&&c.push(E),l)}function nm(l,c,f,_,E){switch(c){case"focusin":return os=Mr(os,l,c,f,_,E),!0;case"dragenter":return as=Mr(as,l,c,f,_,E),!0;case"mouseover":return bn=Mr(bn,l,c,f,_,E),!0;case"pointerover":var x=E.pointerId;return rl.set(x,Mr(rl.get(x)||null,l,c,f,_,E)),!0;case"gotpointercapture":return x=E.pointerId,Bs.set(x,Mr(Bs.get(x)||null,l,c,f,_,E)),!0}return!1}function Nu(l){var c=ll(l.target);if(c!==null){var f=Cr(c);if(f!==null){if(c=f.tag,c===13){if(c=jh(f),c!==null){l.blockedOn=c,Qh(l.priority,function(){Yh(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Ae(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var f=Ou(l.domEventName,l.eventSystemFlags,c[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var _=new f.constructor(f.type,f);ts=_,f.target.dispatchEvent(_),ts=null}else return c=dd(f),c!==null&&Lu(c),l.blockedOn=f,!1;c.shift()}return!0}function im(l,c,f){Ae(l)&&f.delete(c)}function _y(){ss=!1,os!==null&&Ae(os)&&(os=null),as!==null&&Ae(as)&&(as=null),bn!==null&&Ae(bn)&&(bn=null),rl.forEach(im),Bs.forEach(im)}function Do(l,c){l.blockedOn===c&&(l.blockedOn=null,ss||(ss=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,_y)))}function No(l){function c(E){return Do(E,l)}if(0<Du.length){Do(Du[0],l);for(var f=1;f<Du.length;f++){var _=Du[f];_.blockedOn===l&&(_.blockedOn=null)}}for(os!==null&&Do(os,l),as!==null&&Do(as,l),bn!==null&&Do(bn,l),rl.forEach(c),Bs.forEach(c),f=0;f<Ni.length;f++)_=Ni[f],_.blockedOn===l&&(_.blockedOn=null);for(;0<Ni.length&&(f=Ni[0],f.blockedOn===null);)Nu(f),f.blockedOn===null&&Ni.shift()}var $s=L.ReactCurrentBatchConfig,Ws=!0;function ls(l,c,f,_){var E=ee,x=$s.transition;$s.transition=null;try{ee=1,Jh(l,c,f,_)}finally{ee=E,$s.transition=x}}function rm(l,c,f,_){var E=ee,x=$s.transition;$s.transition=null;try{ee=4,Jh(l,c,f,_)}finally{ee=E,$s.transition=x}}function Jh(l,c,f,_){if(Ws){var E=Ou(l,c,f,_);if(E===null)Py(l,c,_,us,f),Lo(l,_);else if(nm(E,l,c,f,_))_.stopPropagation();else if(Lo(l,_),c&4&&-1<em.indexOf(l)){for(;E!==null;){var x=dd(E);if(x!==null&&Xh(x),x=Ou(l,c,f,_),x===null&&Py(l,c,_,us,f),x===E)break;E=x}E!==null&&_.stopPropagation()}else Py(l,c,_,null,f)}}var us=null;function Ou(l,c,f,_){if(us=null,l=es(_),l=ll(l),l!==null)if(c=Cr(l),c===null)l=null;else if(f=c.tag,f===13){if(l=jh(c),l!==null)return l;l=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null);return us=l,null}function Vu(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(my()){case bu:return 1;case Bh:return 4;case Qa:case $h:return 16;case ku:return 536870912;default:return 16}default:return 16}}var Oi=null,Fu=null,Ks=null;function sm(){if(Ks)return Ks;var l,c=Fu,f=c.length,_,E="value"in Oi?Oi.value:Oi.textContent,x=E.length;for(l=0;l<f&&c[l]===E[l];l++);var C=f-l;for(_=1;_<=C&&c[f-_]===E[x-_];_++);return Ks=E.slice(l,1<_?1-_:void 0)}function sl(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function cs(){return!0}function td(){return!1}function jn(l){function c(f,_,E,x,C){this._reactName=f,this._targetInst=E,this.type=_,this.nativeEvent=x,this.target=C,this.currentTarget=null;for(var G in l)l.hasOwnProperty(G)&&(f=l[G],this[G]=f?f(x):x[G]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?cs:td,this.isPropagationStopped=td,this}return it(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),c}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=jn(hs),Oo=it({},hs,{view:0,detail:0}),Gu=jn(Oo),Uu,ju,Vi,al=it({},Oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wt,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Vi&&(Vi&&l.type==="mousemove"?(Uu=l.screenX-Vi.screenX,ju=l.screenY-Vi.screenY):ju=Uu=0,Vi=l),Uu)},movementY:function(l){return"movementY"in l?l.movementY:ju}}),ed=jn(al),om=it({},al,{dataTransfer:0}),am=jn(om),zu=it({},Oo,{relatedTarget:0}),kn=jn(zu),lm=it({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),um=jn(lm),Vo=it({},hs,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),p=jn(Vo),T=it({},hs,{data:0}),I=jn(T),O={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ft(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=Q[l])?!!c[l]:!1}function Wt(){return ft}var Qe=it({},Oo,{key:function(l){if(l.key){var c=O[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=sl(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?X[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wt,charCode:function(l){return l.type==="keypress"?sl(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?sl(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Ee=jn(Qe),sn=it({},al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fi=jn(sn),qs=it({},Oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wt}),ds=jn(qs),fs=it({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bu=jn(fs),nd=it({},al,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),F3=jn(nd),G3=[9,13,27,32],yy=a&&"CompositionEvent"in window,id=null;a&&"documentMode"in document&&(id=document.documentMode);var U3=a&&"TextEvent"in window&&!id,pS=a&&(!yy||id&&8<id&&11>=id),_S=" ",yS=!1;function vS(l,c){switch(l){case"keyup":return G3.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ES(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var $u=!1;function j3(l,c){switch(l){case"compositionend":return ES(c);case"keypress":return c.which!==32?null:(yS=!0,_S);case"textInput":return l=c.data,l===_S&&yS?null:l;default:return null}}function z3(l,c){if($u)return l==="compositionend"||!yy&&vS(l,c)?(l=sm(),Ks=Fu=Oi=null,$u=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return pS&&c.locale!=="ko"?null:c.data;default:return null}}var B3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wS(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!B3[l.type]:c==="textarea"}function xS(l,c,f,_){Pr(_),c=gm(c,"onChange"),0<c.length&&(f=new ol("onChange","change",null,f,_),l.push({event:f,listeners:c}))}var rd=null,sd=null;function $3(l){US(l,0)}function cm(l){var c=Xu(l);if(Fs(c))return l}function W3(l,c){if(l==="change")return c}var TS=!1;if(a){var vy;if(a){var Ey="oninput"in document;if(!Ey){var SS=document.createElement("div");SS.setAttribute("oninput","return;"),Ey=typeof SS.oninput=="function"}vy=Ey}else vy=!1;TS=vy&&(!document.documentMode||9<document.documentMode)}function IS(){rd&&(rd.detachEvent("onpropertychange",AS),sd=rd=null)}function AS(l){if(l.propertyName==="value"&&cm(sd)){var c=[];xS(c,sd,l,es(l)),Cn($3,c)}}function K3(l,c,f){l==="focusin"?(IS(),rd=c,sd=f,rd.attachEvent("onpropertychange",AS)):l==="focusout"&&IS()}function q3(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return cm(sd)}function H3(l,c){if(l==="click")return cm(c)}function X3(l,c){if(l==="input"||l==="change")return cm(c)}function Y3(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var br=typeof Object.is=="function"?Object.is:Y3;function od(l,c){if(br(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var f=Object.keys(l),_=Object.keys(c);if(f.length!==_.length)return!1;for(_=0;_<f.length;_++){var E=f[_];if(!u.call(c,E)||!br(l[E],c[E]))return!1}return!0}function RS(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function PS(l,c){var f=RS(l);l=0;for(var _;f;){if(f.nodeType===3){if(_=l+f.textContent.length,l<=c&&_>=c)return{node:f,offset:c-l};l=_}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=RS(f)}}function CS(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?CS(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function MS(){for(var l=window,c=fi();c instanceof l.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)l=c.contentWindow;else break;c=fi(l.document)}return c}function wy(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}function Z3(l){var c=MS(),f=l.focusedElem,_=l.selectionRange;if(c!==f&&f&&f.ownerDocument&&CS(f.ownerDocument.documentElement,f)){if(_!==null&&wy(f)){if(c=_.start,l=_.end,l===void 0&&(l=c),"selectionStart"in f)f.selectionStart=c,f.selectionEnd=Math.min(l,f.value.length);else if(l=(c=f.ownerDocument||document)&&c.defaultView||window,l.getSelection){l=l.getSelection();var E=f.textContent.length,x=Math.min(_.start,E);_=_.end===void 0?x:Math.min(_.end,E),!l.extend&&x>_&&(E=_,_=x,x=E),E=PS(f,x);var C=PS(f,_);E&&C&&(l.rangeCount!==1||l.anchorNode!==E.node||l.anchorOffset!==E.offset||l.focusNode!==C.node||l.focusOffset!==C.offset)&&(c=c.createRange(),c.setStart(E.node,E.offset),l.removeAllRanges(),x>_?(l.addRange(c),l.extend(C.node,C.offset)):(c.setEnd(C.node,C.offset),l.addRange(c)))}}for(c=[],l=f;l=l.parentNode;)l.nodeType===1&&c.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<c.length;f++)l=c[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var Q3=a&&"documentMode"in document&&11>=document.documentMode,Wu=null,xy=null,ad=null,Ty=!1;function bS(l,c,f){var _=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Ty||Wu==null||Wu!==fi(_)||(_=Wu,"selectionStart"in _&&wy(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),ad&&od(ad,_)||(ad=_,_=gm(xy,"onSelect"),0<_.length&&(c=new ol("onSelect","select",null,c,f),l.push({event:c,listeners:_}),c.target=Wu)))}function hm(l,c){var f={};return f[l.toLowerCase()]=c.toLowerCase(),f["Webkit"+l]="webkit"+c,f["Moz"+l]="moz"+c,f}var Ku={animationend:hm("Animation","AnimationEnd"),animationiteration:hm("Animation","AnimationIteration"),animationstart:hm("Animation","AnimationStart"),transitionend:hm("Transition","TransitionEnd")},Sy={},kS={};a&&(kS=document.createElement("div").style,"AnimationEvent"in window||(delete Ku.animationend.animation,delete Ku.animationiteration.animation,delete Ku.animationstart.animation),"TransitionEvent"in window||delete Ku.transitionend.transition);function dm(l){if(Sy[l])return Sy[l];if(!Ku[l])return l;var c=Ku[l],f;for(f in c)if(c.hasOwnProperty(f)&&f in kS)return Sy[l]=c[f];return l}var LS=dm("animationend"),DS=dm("animationiteration"),NS=dm("animationstart"),OS=dm("transitionend"),VS=new Map,FS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fo(l,c){VS.set(l,c),s(c,[l])}for(var Iy=0;Iy<FS.length;Iy++){var Ay=FS[Iy],J3=Ay.toLowerCase(),tO=Ay[0].toUpperCase()+Ay.slice(1);Fo(J3,"on"+tO)}Fo(LS,"onAnimationEnd"),Fo(DS,"onAnimationIteration"),Fo(NS,"onAnimationStart"),Fo("dblclick","onDoubleClick"),Fo("focusin","onFocus"),Fo("focusout","onBlur"),Fo(OS,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eO=new Set("cancel close invalid load scroll toggle".split(" ").concat(ld));function GS(l,c,f){var _=l.type||"unknown-event";l.currentTarget=f,Uh(_,c,void 0,l),l.currentTarget=null}function US(l,c){c=(c&4)!==0;for(var f=0;f<l.length;f++){var _=l[f],E=_.event;_=_.listeners;t:{var x=void 0;if(c)for(var C=_.length-1;0<=C;C--){var G=_[C],B=G.instance,Z=G.currentTarget;if(G=G.listener,B!==x&&E.isPropagationStopped())break t;GS(E,G,Z),x=B}else for(C=0;C<_.length;C++){if(G=_[C],B=G.instance,Z=G.currentTarget,G=G.listener,B!==x&&E.isPropagationStopped())break t;GS(E,G,Z),x=B}}}if(Cu)throw l=sr,Cu=!1,sr=null,l}function Me(l,c){var f=c[Dy];f===void 0&&(f=c[Dy]=new Set);var _=l+"__bubble";f.has(_)||(jS(c,l,2,!1),f.add(_))}function Ry(l,c,f){var _=0;c&&(_|=4),jS(f,l,_,c)}var fm="_reactListening"+Math.random().toString(36).slice(2);function ud(l){if(!l[fm]){l[fm]=!0,i.forEach(function(f){f!=="selectionchange"&&(eO.has(f)||Ry(f,!1,l),Ry(f,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[fm]||(c[fm]=!0,Ry("selectionchange",!1,c))}}function jS(l,c,f,_){switch(Vu(c)){case 1:var E=ls;break;case 4:E=rm;break;default:E=Jh}f=E.bind(null,c,f,l),E=void 0,!vn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(E=!0),_?E!==void 0?l.addEventListener(c,f,{capture:!0,passive:E}):l.addEventListener(c,f,!0):E!==void 0?l.addEventListener(c,f,{passive:E}):l.addEventListener(c,f,!1)}function Py(l,c,f,_,E){var x=_;if((c&1)===0&&(c&2)===0&&_!==null)t:for(;;){if(_===null)return;var C=_.tag;if(C===3||C===4){var G=_.stateNode.containerInfo;if(G===E||G.nodeType===8&&G.parentNode===E)break;if(C===4)for(C=_.return;C!==null;){var B=C.tag;if((B===3||B===4)&&(B=C.stateNode.containerInfo,B===E||B.nodeType===8&&B.parentNode===E))return;C=C.return}for(;G!==null;){if(C=ll(G),C===null)return;if(B=C.tag,B===5||B===6){_=x=C;continue t}G=G.parentNode}}_=_.return}Cn(function(){var Z=x,ot=es(f),lt=[];t:{var rt=VS.get(l);if(rt!==void 0){var vt=ol,xt=l;switch(l){case"keypress":if(sl(f)===0)break t;case"keydown":case"keyup":vt=Ee;break;case"focusin":xt="focus",vt=kn;break;case"focusout":xt="blur",vt=kn;break;case"beforeblur":case"afterblur":vt=kn;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=ed;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=am;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=ds;break;case LS:case DS:case NS:vt=um;break;case OS:vt=Bu;break;case"scroll":vt=Gu;break;case"wheel":vt=F3;break;case"copy":case"cut":case"paste":vt=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=Fi}var St=(c&4)!==0,Je=!St&&l==="scroll",H=St?rt!==null?rt+"Capture":null:rt;St=[];for(var W=Z,Y;W!==null;){Y=W;var ht=Y.stateNode;if(Y.tag===5&&ht!==null&&(Y=ht,H!==null&&(ht=Mn(W,H),ht!=null&&St.push(cd(W,ht,Y)))),Je)break;W=W.return}0<St.length&&(rt=new vt(rt,xt,null,f,ot),lt.push({event:rt,listeners:St}))}}if((c&7)===0){t:{if(rt=l==="mouseover"||l==="pointerover",vt=l==="mouseout"||l==="pointerout",rt&&f!==ts&&(xt=f.relatedTarget||f.fromElement)&&(ll(xt)||xt[Hs]))break t;if((vt||rt)&&(rt=ot.window===ot?ot:(rt=ot.ownerDocument)?rt.defaultView||rt.parentWindow:window,vt?(xt=f.relatedTarget||f.toElement,vt=Z,xt=xt?ll(xt):null,xt!==null&&(Je=Cr(xt),xt!==Je||xt.tag!==5&&xt.tag!==6)&&(xt=null)):(vt=null,xt=Z),vt!==xt)){if(St=ed,ht="onMouseLeave",H="onMouseEnter",W="mouse",(l==="pointerout"||l==="pointerover")&&(St=Fi,ht="onPointerLeave",H="onPointerEnter",W="pointer"),Je=vt==null?rt:Xu(vt),Y=xt==null?rt:Xu(xt),rt=new St(ht,W+"leave",vt,f,ot),rt.target=Je,rt.relatedTarget=Y,ht=null,ll(ot)===Z&&(St=new St(H,W+"enter",xt,f,ot),St.target=Y,St.relatedTarget=Je,ht=St),Je=ht,vt&&xt)e:{for(St=vt,H=xt,W=0,Y=St;Y;Y=qu(Y))W++;for(Y=0,ht=H;ht;ht=qu(ht))Y++;for(;0<W-Y;)St=qu(St),W--;for(;0<Y-W;)H=qu(H),Y--;for(;W--;){if(St===H||H!==null&&St===H.alternate)break e;St=qu(St),H=qu(H)}St=null}else St=null;vt!==null&&zS(lt,rt,vt,St,!1),xt!==null&&Je!==null&&zS(lt,Je,xt,St,!0)}}t:{if(rt=Z?Xu(Z):window,vt=rt.nodeName&&rt.nodeName.toLowerCase(),vt==="select"||vt==="input"&&rt.type==="file")var It=W3;else if(wS(rt))if(TS)It=X3;else{It=q3;var Lt=K3}else(vt=rt.nodeName)&&vt.toLowerCase()==="input"&&(rt.type==="checkbox"||rt.type==="radio")&&(It=H3);if(It&&(It=It(l,Z))){xS(lt,It,f,ot);break t}Lt&&Lt(l,rt,Z),l==="focusout"&&(Lt=rt._wrapperState)&&Lt.controlled&&rt.type==="number"&&Re(rt,"number",rt.value)}switch(Lt=Z?Xu(Z):window,l){case"focusin":(wS(Lt)||Lt.contentEditable==="true")&&(Wu=Lt,xy=Z,ad=null);break;case"focusout":ad=xy=Wu=null;break;case"mousedown":Ty=!0;break;case"contextmenu":case"mouseup":case"dragend":Ty=!1,bS(lt,f,ot);break;case"selectionchange":if(Q3)break;case"keydown":case"keyup":bS(lt,f,ot)}var Dt;if(yy)t:{switch(l){case"compositionstart":var Ft="onCompositionStart";break t;case"compositionend":Ft="onCompositionEnd";break t;case"compositionupdate":Ft="onCompositionUpdate";break t}Ft=void 0}else $u?vS(l,f)&&(Ft="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(Ft="onCompositionStart");Ft&&(pS&&f.locale!=="ko"&&($u||Ft!=="onCompositionStart"?Ft==="onCompositionEnd"&&$u&&(Dt=sm()):(Oi=ot,Fu="value"in Oi?Oi.value:Oi.textContent,$u=!0)),Lt=gm(Z,Ft),0<Lt.length&&(Ft=new I(Ft,l,null,f,ot),lt.push({event:Ft,listeners:Lt}),Dt?Ft.data=Dt:(Dt=ES(f),Dt!==null&&(Ft.data=Dt)))),(Dt=U3?j3(l,f):z3(l,f))&&(Z=gm(Z,"onBeforeInput"),0<Z.length&&(ot=new I("onBeforeInput","beforeinput",null,f,ot),lt.push({event:ot,listeners:Z}),ot.data=Dt))}US(lt,c)})}function cd(l,c,f){return{instance:l,listener:c,currentTarget:f}}function gm(l,c){for(var f=c+"Capture",_=[];l!==null;){var E=l,x=E.stateNode;E.tag===5&&x!==null&&(E=x,x=Mn(l,f),x!=null&&_.unshift(cd(l,x,E)),x=Mn(l,c),x!=null&&_.push(cd(l,x,E))),l=l.return}return _}function qu(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function zS(l,c,f,_,E){for(var x=c._reactName,C=[];f!==null&&f!==_;){var G=f,B=G.alternate,Z=G.stateNode;if(B!==null&&B===_)break;G.tag===5&&Z!==null&&(G=Z,E?(B=Mn(f,x),B!=null&&C.unshift(cd(f,B,G))):E||(B=Mn(f,x),B!=null&&C.push(cd(f,B,G)))),f=f.return}C.length!==0&&l.push({event:c,listeners:C})}var nO=/\r\n?/g,iO=/\u0000|\uFFFD/g;function BS(l){return(typeof l=="string"?l:""+l).replace(nO,`
`).replace(iO,"")}function mm(l,c,f){if(c=BS(c),BS(l)!==c&&f)throw Error(e(425))}function pm(){}var Cy=null,My=null;function by(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ky=typeof setTimeout=="function"?setTimeout:void 0,rO=typeof clearTimeout=="function"?clearTimeout:void 0,$S=typeof Promise=="function"?Promise:void 0,sO=typeof queueMicrotask=="function"?queueMicrotask:typeof $S<"u"?function(l){return $S.resolve(null).then(l).catch(oO)}:ky;function oO(l){setTimeout(function(){throw l})}function Ly(l,c){var f=c,_=0;do{var E=f.nextSibling;if(l.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"){if(_===0){l.removeChild(E),No(c);return}_--}else f!=="$"&&f!=="$?"&&f!=="$!"||_++;f=E}while(f);No(c)}function Go(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return l}function WS(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return l;c--}else f==="/$"&&c++}l=l.previousSibling}return null}var Hu=Math.random().toString(36).slice(2),gs="__reactFiber$"+Hu,hd="__reactProps$"+Hu,Hs="__reactContainer$"+Hu,Dy="__reactEvents$"+Hu,aO="__reactListeners$"+Hu,lO="__reactHandles$"+Hu;function ll(l){var c=l[gs];if(c)return c;for(var f=l.parentNode;f;){if(c=f[Hs]||f[gs]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(l=WS(l);l!==null;){if(f=l[gs])return f;l=WS(l)}return c}l=f,f=l.parentNode}return null}function dd(l){return l=l[gs]||l[Hs],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Xu(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(e(33))}function _m(l){return l[hd]||null}var Ny=[],Yu=-1;function Uo(l){return{current:l}}function be(l){0>Yu||(l.current=Ny[Yu],Ny[Yu]=null,Yu--)}function Pe(l,c){Yu++,Ny[Yu]=l.current,l.current=c}var jo={},zn=Uo(jo),pi=Uo(!1),ul=jo;function Zu(l,c){var f=l.type.contextTypes;if(!f)return jo;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===c)return _.__reactInternalMemoizedMaskedChildContext;var E={},x;for(x in f)E[x]=c[x];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=E),E}function _i(l){return l=l.childContextTypes,l!=null}function ym(){be(pi),be(zn)}function KS(l,c,f){if(zn.current!==jo)throw Error(e(168));Pe(zn,c),Pe(pi,f)}function qS(l,c,f){var _=l.stateNode;if(c=c.childContextTypes,typeof _.getChildContext!="function")return f;_=_.getChildContext();for(var E in _)if(!(E in c))throw Error(e(108,Vt(l)||"Unknown",E));return it({},f,_)}function vm(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||jo,ul=zn.current,Pe(zn,l),Pe(pi,pi.current),!0}function HS(l,c,f){var _=l.stateNode;if(!_)throw Error(e(169));f?(l=qS(l,c,ul),_.__reactInternalMemoizedMergedChildContext=l,be(pi),be(zn),Pe(zn,l)):be(pi),Pe(pi,f)}var Xs=null,Em=!1,Oy=!1;function XS(l){Xs===null?Xs=[l]:Xs.push(l)}function uO(l){Em=!0,XS(l)}function zo(){if(!Oy&&Xs!==null){Oy=!0;var l=0,c=ee;try{var f=Xs;for(ee=1;l<f.length;l++){var _=f[l];do _=_(!0);while(_!==null)}Xs=null,Em=!1}catch(E){throw Xs!==null&&(Xs=Xs.slice(l+1)),zh(bu,zo),E}finally{ee=c,Oy=!1}}return null}var Qu=[],Ju=0,wm=null,xm=0,ar=[],lr=0,cl=null,Ys=1,Zs="";function hl(l,c){Qu[Ju++]=xm,Qu[Ju++]=wm,wm=l,xm=c}function YS(l,c,f){ar[lr++]=Ys,ar[lr++]=Zs,ar[lr++]=cl,cl=l;var _=Ys;l=Zs;var E=32-Di(_)-1;_&=~(1<<E),f+=1;var x=32-Di(c)+E;if(30<x){var C=E-E%5;x=(_&(1<<C)-1).toString(32),_>>=C,E-=C,Ys=1<<32-Di(c)+E|f<<E|_,Zs=x+l}else Ys=1<<x|f<<E|_,Zs=l}function Vy(l){l.return!==null&&(hl(l,1),YS(l,1,0))}function Fy(l){for(;l===wm;)wm=Qu[--Ju],Qu[Ju]=null,xm=Qu[--Ju],Qu[Ju]=null;for(;l===cl;)cl=ar[--lr],ar[lr]=null,Zs=ar[--lr],ar[lr]=null,Ys=ar[--lr],ar[lr]=null}var Gi=null,Ui=null,Ne=!1,kr=null;function ZS(l,c){var f=dr(5,null,null,0);f.elementType="DELETED",f.stateNode=c,f.return=l,c=l.deletions,c===null?(l.deletions=[f],l.flags|=16):c.push(f)}function QS(l,c){switch(l.tag){case 5:var f=l.type;return c=c.nodeType!==1||f.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(l.stateNode=c,Gi=l,Ui=Go(c.firstChild),!0):!1;case 6:return c=l.pendingProps===""||c.nodeType!==3?null:c,c!==null?(l.stateNode=c,Gi=l,Ui=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(f=cl!==null?{id:Ys,overflow:Zs}:null,l.memoizedState={dehydrated:c,treeContext:f,retryLane:1073741824},f=dr(18,null,null,0),f.stateNode=c,f.return=l,l.child=f,Gi=l,Ui=null,!0):!1;default:return!1}}function Gy(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Uy(l){if(Ne){var c=Ui;if(c){var f=c;if(!QS(l,c)){if(Gy(l))throw Error(e(418));c=Go(f.nextSibling);var _=Gi;c&&QS(l,c)?ZS(_,f):(l.flags=l.flags&-4097|2,Ne=!1,Gi=l)}}else{if(Gy(l))throw Error(e(418));l.flags=l.flags&-4097|2,Ne=!1,Gi=l}}}function JS(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Gi=l}function Tm(l){if(l!==Gi)return!1;if(!Ne)return JS(l),Ne=!0,!1;var c;if((c=l.tag!==3)&&!(c=l.tag!==5)&&(c=l.type,c=c!=="head"&&c!=="body"&&!by(l.type,l.memoizedProps)),c&&(c=Ui)){if(Gy(l))throw tI(),Error(e(418));for(;c;)ZS(l,c),c=Go(c.nextSibling)}if(JS(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(e(317));t:{for(l=l.nextSibling,c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(c===0){Ui=Go(l.nextSibling);break t}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++}l=l.nextSibling}Ui=null}}else Ui=Gi?Go(l.stateNode.nextSibling):null;return!0}function tI(){for(var l=Ui;l;)l=Go(l.nextSibling)}function tc(){Ui=Gi=null,Ne=!1}function jy(l){kr===null?kr=[l]:kr.push(l)}var cO=L.ReactCurrentBatchConfig;function fd(l,c,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(e(309));var _=f.stateNode}if(!_)throw Error(e(147,l));var E=_,x=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===x?c.ref:(c=function(C){var G=E.refs;C===null?delete G[x]:G[x]=C},c._stringRef=x,c)}if(typeof l!="string")throw Error(e(284));if(!f._owner)throw Error(e(290,l))}return l}function Sm(l,c){throw l=Object.prototype.toString.call(c),Error(e(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function eI(l){var c=l._init;return c(l._payload)}function nI(l){function c(H,W){if(l){var Y=H.deletions;Y===null?(H.deletions=[W],H.flags|=16):Y.push(W)}}function f(H,W){if(!l)return null;for(;W!==null;)c(H,W),W=W.sibling;return null}function _(H,W){for(H=new Map;W!==null;)W.key!==null?H.set(W.key,W):H.set(W.index,W),W=W.sibling;return H}function E(H,W){return H=Yo(H,W),H.index=0,H.sibling=null,H}function x(H,W,Y){return H.index=Y,l?(Y=H.alternate,Y!==null?(Y=Y.index,Y<W?(H.flags|=2,W):Y):(H.flags|=2,W)):(H.flags|=1048576,W)}function C(H){return l&&H.alternate===null&&(H.flags|=2),H}function G(H,W,Y,ht){return W===null||W.tag!==6?(W=kv(Y,H.mode,ht),W.return=H,W):(W=E(W,Y),W.return=H,W)}function B(H,W,Y,ht){var It=Y.type;return It===b?ot(H,W,Y.props.children,ht,Y.key):W!==null&&(W.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===yt&&eI(It)===W.type)?(ht=E(W,Y.props),ht.ref=fd(H,W,Y),ht.return=H,ht):(ht=Hm(Y.type,Y.key,Y.props,null,H.mode,ht),ht.ref=fd(H,W,Y),ht.return=H,ht)}function Z(H,W,Y,ht){return W===null||W.tag!==4||W.stateNode.containerInfo!==Y.containerInfo||W.stateNode.implementation!==Y.implementation?(W=Lv(Y,H.mode,ht),W.return=H,W):(W=E(W,Y.children||[]),W.return=H,W)}function ot(H,W,Y,ht,It){return W===null||W.tag!==7?(W=vl(Y,H.mode,ht,It),W.return=H,W):(W=E(W,Y),W.return=H,W)}function lt(H,W,Y){if(typeof W=="string"&&W!==""||typeof W=="number")return W=kv(""+W,H.mode,Y),W.return=H,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case D:return Y=Hm(W.type,W.key,W.props,null,H.mode,Y),Y.ref=fd(H,null,W),Y.return=H,Y;case j:return W=Lv(W,H.mode,Y),W.return=H,W;case yt:var ht=W._init;return lt(H,ht(W._payload),Y)}if(ve(W)||at(W))return W=vl(W,H.mode,Y,null),W.return=H,W;Sm(H,W)}return null}function rt(H,W,Y,ht){var It=W!==null?W.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return It!==null?null:G(H,W,""+Y,ht);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:return Y.key===It?B(H,W,Y,ht):null;case j:return Y.key===It?Z(H,W,Y,ht):null;case yt:return It=Y._init,rt(H,W,It(Y._payload),ht)}if(ve(Y)||at(Y))return It!==null?null:ot(H,W,Y,ht,null);Sm(H,Y)}return null}function vt(H,W,Y,ht,It){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return H=H.get(Y)||null,G(W,H,""+ht,It);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case D:return H=H.get(ht.key===null?Y:ht.key)||null,B(W,H,ht,It);case j:return H=H.get(ht.key===null?Y:ht.key)||null,Z(W,H,ht,It);case yt:var Lt=ht._init;return vt(H,W,Y,Lt(ht._payload),It)}if(ve(ht)||at(ht))return H=H.get(Y)||null,ot(W,H,ht,It,null);Sm(W,ht)}return null}function xt(H,W,Y,ht){for(var It=null,Lt=null,Dt=W,Ft=W=0,xn=null;Dt!==null&&Ft<Y.length;Ft++){Dt.index>Ft?(xn=Dt,Dt=null):xn=Dt.sibling;var se=rt(H,Dt,Y[Ft],ht);if(se===null){Dt===null&&(Dt=xn);break}l&&Dt&&se.alternate===null&&c(H,Dt),W=x(se,W,Ft),Lt===null?It=se:Lt.sibling=se,Lt=se,Dt=xn}if(Ft===Y.length)return f(H,Dt),Ne&&hl(H,Ft),It;if(Dt===null){for(;Ft<Y.length;Ft++)Dt=lt(H,Y[Ft],ht),Dt!==null&&(W=x(Dt,W,Ft),Lt===null?It=Dt:Lt.sibling=Dt,Lt=Dt);return Ne&&hl(H,Ft),It}for(Dt=_(H,Dt);Ft<Y.length;Ft++)xn=vt(Dt,H,Ft,Y[Ft],ht),xn!==null&&(l&&xn.alternate!==null&&Dt.delete(xn.key===null?Ft:xn.key),W=x(xn,W,Ft),Lt===null?It=xn:Lt.sibling=xn,Lt=xn);return l&&Dt.forEach(function(Zo){return c(H,Zo)}),Ne&&hl(H,Ft),It}function St(H,W,Y,ht){var It=at(Y);if(typeof It!="function")throw Error(e(150));if(Y=It.call(Y),Y==null)throw Error(e(151));for(var Lt=It=null,Dt=W,Ft=W=0,xn=null,se=Y.next();Dt!==null&&!se.done;Ft++,se=Y.next()){Dt.index>Ft?(xn=Dt,Dt=null):xn=Dt.sibling;var Zo=rt(H,Dt,se.value,ht);if(Zo===null){Dt===null&&(Dt=xn);break}l&&Dt&&Zo.alternate===null&&c(H,Dt),W=x(Zo,W,Ft),Lt===null?It=Zo:Lt.sibling=Zo,Lt=Zo,Dt=xn}if(se.done)return f(H,Dt),Ne&&hl(H,Ft),It;if(Dt===null){for(;!se.done;Ft++,se=Y.next())se=lt(H,se.value,ht),se!==null&&(W=x(se,W,Ft),Lt===null?It=se:Lt.sibling=se,Lt=se);return Ne&&hl(H,Ft),It}for(Dt=_(H,Dt);!se.done;Ft++,se=Y.next())se=vt(Dt,H,Ft,se.value,ht),se!==null&&(l&&se.alternate!==null&&Dt.delete(se.key===null?Ft:se.key),W=x(se,W,Ft),Lt===null?It=se:Lt.sibling=se,Lt=se);return l&&Dt.forEach(function(BO){return c(H,BO)}),Ne&&hl(H,Ft),It}function Je(H,W,Y,ht){if(typeof Y=="object"&&Y!==null&&Y.type===b&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:t:{for(var It=Y.key,Lt=W;Lt!==null;){if(Lt.key===It){if(It=Y.type,It===b){if(Lt.tag===7){f(H,Lt.sibling),W=E(Lt,Y.props.children),W.return=H,H=W;break t}}else if(Lt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===yt&&eI(It)===Lt.type){f(H,Lt.sibling),W=E(Lt,Y.props),W.ref=fd(H,Lt,Y),W.return=H,H=W;break t}f(H,Lt);break}else c(H,Lt);Lt=Lt.sibling}Y.type===b?(W=vl(Y.props.children,H.mode,ht,Y.key),W.return=H,H=W):(ht=Hm(Y.type,Y.key,Y.props,null,H.mode,ht),ht.ref=fd(H,W,Y),ht.return=H,H=ht)}return C(H);case j:t:{for(Lt=Y.key;W!==null;){if(W.key===Lt)if(W.tag===4&&W.stateNode.containerInfo===Y.containerInfo&&W.stateNode.implementation===Y.implementation){f(H,W.sibling),W=E(W,Y.children||[]),W.return=H,H=W;break t}else{f(H,W);break}else c(H,W);W=W.sibling}W=Lv(Y,H.mode,ht),W.return=H,H=W}return C(H);case yt:return Lt=Y._init,Je(H,W,Lt(Y._payload),ht)}if(ve(Y))return xt(H,W,Y,ht);if(at(Y))return St(H,W,Y,ht);Sm(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,W!==null&&W.tag===6?(f(H,W.sibling),W=E(W,Y),W.return=H,H=W):(f(H,W),W=kv(Y,H.mode,ht),W.return=H,H=W),C(H)):f(H,W)}return Je}var ec=nI(!0),iI=nI(!1),Im=Uo(null),Am=null,nc=null,zy=null;function By(){zy=nc=Am=null}function $y(l){var c=Im.current;be(Im),l._currentValue=c}function Wy(l,c,f){for(;l!==null;){var _=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,_!==null&&(_.childLanes|=c)):_!==null&&(_.childLanes&c)!==c&&(_.childLanes|=c),l===f)break;l=l.return}}function ic(l,c){Am=l,zy=nc=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&c)!==0&&(yi=!0),l.firstContext=null)}function ur(l){var c=l._currentValue;if(zy!==l)if(l={context:l,memoizedValue:c,next:null},nc===null){if(Am===null)throw Error(e(308));nc=l,Am.dependencies={lanes:0,firstContext:l}}else nc=nc.next=l;return c}var dl=null;function Ky(l){dl===null?dl=[l]:dl.push(l)}function rI(l,c,f,_){var E=c.interleaved;return E===null?(f.next=f,Ky(c)):(f.next=E.next,E.next=f),c.interleaved=f,Qs(l,_)}function Qs(l,c){l.lanes|=c;var f=l.alternate;for(f!==null&&(f.lanes|=c),f=l,l=l.return;l!==null;)l.childLanes|=c,f=l.alternate,f!==null&&(f.childLanes|=c),f=l,l=l.return;return f.tag===3?f.stateNode:null}var Bo=!1;function qy(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sI(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Js(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function $o(l,c,f){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,(re&2)!==0){var E=_.pending;return E===null?c.next=c:(c.next=E.next,E.next=c),_.pending=c,Qs(l,f)}return E=_.interleaved,E===null?(c.next=c,Ky(_)):(c.next=E.next,E.next=c),_.interleaved=c,Qs(l,f)}function Rm(l,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194240)!==0)){var _=c.lanes;_&=l.pendingLanes,f|=_,c.lanes=f,Hh(l,f)}}function oI(l,c){var f=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,f===_)){var E=null,x=null;if(f=f.firstBaseUpdate,f!==null){do{var C={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};x===null?E=x=C:x=x.next=C,f=f.next}while(f!==null);x===null?E=x=c:x=x.next=c}else E=x=c;f={baseState:_.baseState,firstBaseUpdate:E,lastBaseUpdate:x,shared:_.shared,effects:_.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=c:l.next=c,f.lastBaseUpdate=c}function Pm(l,c,f,_){var E=l.updateQueue;Bo=!1;var x=E.firstBaseUpdate,C=E.lastBaseUpdate,G=E.shared.pending;if(G!==null){E.shared.pending=null;var B=G,Z=B.next;B.next=null,C===null?x=Z:C.next=Z,C=B;var ot=l.alternate;ot!==null&&(ot=ot.updateQueue,G=ot.lastBaseUpdate,G!==C&&(G===null?ot.firstBaseUpdate=Z:G.next=Z,ot.lastBaseUpdate=B))}if(x!==null){var lt=E.baseState;C=0,ot=Z=B=null,G=x;do{var rt=G.lane,vt=G.eventTime;if((_&rt)===rt){ot!==null&&(ot=ot.next={eventTime:vt,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});t:{var xt=l,St=G;switch(rt=c,vt=f,St.tag){case 1:if(xt=St.payload,typeof xt=="function"){lt=xt.call(vt,lt,rt);break t}lt=xt;break t;case 3:xt.flags=xt.flags&-65537|128;case 0:if(xt=St.payload,rt=typeof xt=="function"?xt.call(vt,lt,rt):xt,rt==null)break t;lt=it({},lt,rt);break t;case 2:Bo=!0}}G.callback!==null&&G.lane!==0&&(l.flags|=64,rt=E.effects,rt===null?E.effects=[G]:rt.push(G))}else vt={eventTime:vt,lane:rt,tag:G.tag,payload:G.payload,callback:G.callback,next:null},ot===null?(Z=ot=vt,B=lt):ot=ot.next=vt,C|=rt;if(G=G.next,G===null){if(G=E.shared.pending,G===null)break;rt=G,G=rt.next,rt.next=null,E.lastBaseUpdate=rt,E.shared.pending=null}}while(!0);if(ot===null&&(B=lt),E.baseState=B,E.firstBaseUpdate=Z,E.lastBaseUpdate=ot,c=E.shared.interleaved,c!==null){E=c;do C|=E.lane,E=E.next;while(E!==c)}else x===null&&(E.shared.lanes=0);ml|=C,l.lanes=C,l.memoizedState=lt}}function aI(l,c,f){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var _=l[c],E=_.callback;if(E!==null){if(_.callback=null,_=f,typeof E!="function")throw Error(e(191,E));E.call(_)}}}var gd={},ms=Uo(gd),md=Uo(gd),pd=Uo(gd);function fl(l){if(l===gd)throw Error(e(174));return l}function Hy(l,c){switch(Pe(pd,c),Pe(md,l),Pe(ms,gd),l=c.nodeType,l){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Rr(null,"");break;default:l=l===8?c.parentNode:c,c=l.namespaceURI||null,l=l.tagName,c=Rr(c,l)}be(ms),Pe(ms,c)}function rc(){be(ms),be(md),be(pd)}function lI(l){fl(pd.current);var c=fl(ms.current),f=Rr(c,l.type);c!==f&&(Pe(md,l),Pe(ms,f))}function Xy(l){md.current===l&&(be(ms),be(md))}var Ue=Uo(0);function Cm(l){for(var c=l;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Yy=[];function Zy(){for(var l=0;l<Yy.length;l++)Yy[l]._workInProgressVersionPrimary=null;Yy.length=0}var Mm=L.ReactCurrentDispatcher,Qy=L.ReactCurrentBatchConfig,gl=0,je=null,hn=null,En=null,bm=!1,_d=!1,yd=0,hO=0;function Bn(){throw Error(e(321))}function Jy(l,c){if(c===null)return!1;for(var f=0;f<c.length&&f<l.length;f++)if(!br(l[f],c[f]))return!1;return!0}function tv(l,c,f,_,E,x){if(gl=x,je=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Mm.current=l===null||l.memoizedState===null?mO:pO,l=f(_,E),_d){x=0;do{if(_d=!1,yd=0,25<=x)throw Error(e(301));x+=1,En=hn=null,c.updateQueue=null,Mm.current=_O,l=f(_,E)}while(_d)}if(Mm.current=Dm,c=hn!==null&&hn.next!==null,gl=0,En=hn=je=null,bm=!1,c)throw Error(e(300));return l}function ev(){var l=yd!==0;return yd=0,l}function ps(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?je.memoizedState=En=l:En=En.next=l,En}function cr(){if(hn===null){var l=je.alternate;l=l!==null?l.memoizedState:null}else l=hn.next;var c=En===null?je.memoizedState:En.next;if(c!==null)En=c,hn=l;else{if(l===null)throw Error(e(310));hn=l,l={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},En===null?je.memoizedState=En=l:En=En.next=l}return En}function vd(l,c){return typeof c=="function"?c(l):c}function nv(l){var c=cr(),f=c.queue;if(f===null)throw Error(e(311));f.lastRenderedReducer=l;var _=hn,E=_.baseQueue,x=f.pending;if(x!==null){if(E!==null){var C=E.next;E.next=x.next,x.next=C}_.baseQueue=E=x,f.pending=null}if(E!==null){x=E.next,_=_.baseState;var G=C=null,B=null,Z=x;do{var ot=Z.lane;if((gl&ot)===ot)B!==null&&(B=B.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),_=Z.hasEagerState?Z.eagerState:l(_,Z.action);else{var lt={lane:ot,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};B===null?(G=B=lt,C=_):B=B.next=lt,je.lanes|=ot,ml|=ot}Z=Z.next}while(Z!==null&&Z!==x);B===null?C=_:B.next=G,br(_,c.memoizedState)||(yi=!0),c.memoizedState=_,c.baseState=C,c.baseQueue=B,f.lastRenderedState=_}if(l=f.interleaved,l!==null){E=l;do x=E.lane,je.lanes|=x,ml|=x,E=E.next;while(E!==l)}else E===null&&(f.lanes=0);return[c.memoizedState,f.dispatch]}function iv(l){var c=cr(),f=c.queue;if(f===null)throw Error(e(311));f.lastRenderedReducer=l;var _=f.dispatch,E=f.pending,x=c.memoizedState;if(E!==null){f.pending=null;var C=E=E.next;do x=l(x,C.action),C=C.next;while(C!==E);br(x,c.memoizedState)||(yi=!0),c.memoizedState=x,c.baseQueue===null&&(c.baseState=x),f.lastRenderedState=x}return[x,_]}function uI(){}function cI(l,c){var f=je,_=cr(),E=c(),x=!br(_.memoizedState,E);if(x&&(_.memoizedState=E,yi=!0),_=_.queue,rv(fI.bind(null,f,_,l),[l]),_.getSnapshot!==c||x||En!==null&&En.memoizedState.tag&1){if(f.flags|=2048,Ed(9,dI.bind(null,f,_,E,c),void 0,null),wn===null)throw Error(e(349));(gl&30)!==0||hI(f,c,E)}return E}function hI(l,c,f){l.flags|=16384,l={getSnapshot:c,value:f},c=je.updateQueue,c===null?(c={lastEffect:null,stores:null},je.updateQueue=c,c.stores=[l]):(f=c.stores,f===null?c.stores=[l]:f.push(l))}function dI(l,c,f,_){c.value=f,c.getSnapshot=_,gI(c)&&mI(l)}function fI(l,c,f){return f(function(){gI(c)&&mI(l)})}function gI(l){var c=l.getSnapshot;l=l.value;try{var f=c();return!br(l,f)}catch{return!0}}function mI(l){var c=Qs(l,1);c!==null&&Or(c,l,1,-1)}function pI(l){var c=ps();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vd,lastRenderedState:l},c.queue=l,l=l.dispatch=gO.bind(null,je,l),[c.memoizedState,l]}function Ed(l,c,f,_){return l={tag:l,create:c,destroy:f,deps:_,next:null},c=je.updateQueue,c===null?(c={lastEffect:null,stores:null},je.updateQueue=c,c.lastEffect=l.next=l):(f=c.lastEffect,f===null?c.lastEffect=l.next=l:(_=f.next,f.next=l,l.next=_,c.lastEffect=l)),l}function _I(){return cr().memoizedState}function km(l,c,f,_){var E=ps();je.flags|=l,E.memoizedState=Ed(1|c,f,void 0,_===void 0?null:_)}function Lm(l,c,f,_){var E=cr();_=_===void 0?null:_;var x=void 0;if(hn!==null){var C=hn.memoizedState;if(x=C.destroy,_!==null&&Jy(_,C.deps)){E.memoizedState=Ed(c,f,x,_);return}}je.flags|=l,E.memoizedState=Ed(1|c,f,x,_)}function yI(l,c){return km(8390656,8,l,c)}function rv(l,c){return Lm(2048,8,l,c)}function vI(l,c){return Lm(4,2,l,c)}function EI(l,c){return Lm(4,4,l,c)}function wI(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function xI(l,c,f){return f=f!=null?f.concat([l]):null,Lm(4,4,wI.bind(null,c,l),f)}function sv(){}function TI(l,c){var f=cr();c=c===void 0?null:c;var _=f.memoizedState;return _!==null&&c!==null&&Jy(c,_[1])?_[0]:(f.memoizedState=[l,c],l)}function SI(l,c){var f=cr();c=c===void 0?null:c;var _=f.memoizedState;return _!==null&&c!==null&&Jy(c,_[1])?_[0]:(l=l(),f.memoizedState=[l,c],l)}function II(l,c,f){return(gl&21)===0?(l.baseState&&(l.baseState=!1,yi=!0),l.memoizedState=f):(br(f,c)||(f=Kh(),je.lanes|=f,ml|=f,l.baseState=!0),c)}function dO(l,c){var f=ee;ee=f!==0&&4>f?f:4,l(!0);var _=Qy.transition;Qy.transition={};try{l(!1),c()}finally{ee=f,Qy.transition=_}}function AI(){return cr().memoizedState}function fO(l,c,f){var _=Ho(l);if(f={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null},RI(l))PI(c,f);else if(f=rI(l,c,f,_),f!==null){var E=ai();Or(f,l,_,E),CI(f,c,_)}}function gO(l,c,f){var _=Ho(l),E={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null};if(RI(l))PI(c,E);else{var x=l.alternate;if(l.lanes===0&&(x===null||x.lanes===0)&&(x=c.lastRenderedReducer,x!==null))try{var C=c.lastRenderedState,G=x(C,f);if(E.hasEagerState=!0,E.eagerState=G,br(G,C)){var B=c.interleaved;B===null?(E.next=E,Ky(c)):(E.next=B.next,B.next=E),c.interleaved=E;return}}catch{}f=rI(l,c,E,_),f!==null&&(E=ai(),Or(f,l,_,E),CI(f,c,_))}}function RI(l){var c=l.alternate;return l===je||c!==null&&c===je}function PI(l,c){_d=bm=!0;var f=l.pending;f===null?c.next=c:(c.next=f.next,f.next=c),l.pending=c}function CI(l,c,f){if((f&4194240)!==0){var _=c.lanes;_&=l.pendingLanes,f|=_,c.lanes=f,Hh(l,f)}}var Dm={readContext:ur,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},mO={readContext:ur,useCallback:function(l,c){return ps().memoizedState=[l,c===void 0?null:c],l},useContext:ur,useEffect:yI,useImperativeHandle:function(l,c,f){return f=f!=null?f.concat([l]):null,km(4194308,4,wI.bind(null,c,l),f)},useLayoutEffect:function(l,c){return km(4194308,4,l,c)},useInsertionEffect:function(l,c){return km(4,2,l,c)},useMemo:function(l,c){var f=ps();return c=c===void 0?null:c,l=l(),f.memoizedState=[l,c],l},useReducer:function(l,c,f){var _=ps();return c=f!==void 0?f(c):c,_.memoizedState=_.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},_.queue=l,l=l.dispatch=fO.bind(null,je,l),[_.memoizedState,l]},useRef:function(l){var c=ps();return l={current:l},c.memoizedState=l},useState:pI,useDebugValue:sv,useDeferredValue:function(l){return ps().memoizedState=l},useTransition:function(){var l=pI(!1),c=l[0];return l=dO.bind(null,l[1]),ps().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,f){var _=je,E=ps();if(Ne){if(f===void 0)throw Error(e(407));f=f()}else{if(f=c(),wn===null)throw Error(e(349));(gl&30)!==0||hI(_,c,f)}E.memoizedState=f;var x={value:f,getSnapshot:c};return E.queue=x,yI(fI.bind(null,_,x,l),[l]),_.flags|=2048,Ed(9,dI.bind(null,_,x,f,c),void 0,null),f},useId:function(){var l=ps(),c=wn.identifierPrefix;if(Ne){var f=Zs,_=Ys;f=(_&~(1<<32-Di(_)-1)).toString(32)+f,c=":"+c+"R"+f,f=yd++,0<f&&(c+="H"+f.toString(32)),c+=":"}else f=hO++,c=":"+c+"r"+f.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},pO={readContext:ur,useCallback:TI,useContext:ur,useEffect:rv,useImperativeHandle:xI,useInsertionEffect:vI,useLayoutEffect:EI,useMemo:SI,useReducer:nv,useRef:_I,useState:function(){return nv(vd)},useDebugValue:sv,useDeferredValue:function(l){var c=cr();return II(c,hn.memoizedState,l)},useTransition:function(){var l=nv(vd)[0],c=cr().memoizedState;return[l,c]},useMutableSource:uI,useSyncExternalStore:cI,useId:AI,unstable_isNewReconciler:!1},_O={readContext:ur,useCallback:TI,useContext:ur,useEffect:rv,useImperativeHandle:xI,useInsertionEffect:vI,useLayoutEffect:EI,useMemo:SI,useReducer:iv,useRef:_I,useState:function(){return iv(vd)},useDebugValue:sv,useDeferredValue:function(l){var c=cr();return hn===null?c.memoizedState=l:II(c,hn.memoizedState,l)},useTransition:function(){var l=iv(vd)[0],c=cr().memoizedState;return[l,c]},useMutableSource:uI,useSyncExternalStore:cI,useId:AI,unstable_isNewReconciler:!1};function Lr(l,c){if(l&&l.defaultProps){c=it({},c),l=l.defaultProps;for(var f in l)c[f]===void 0&&(c[f]=l[f]);return c}return c}function ov(l,c,f,_){c=l.memoizedState,f=f(_,c),f=f==null?c:it({},c,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var Nm={isMounted:function(l){return(l=l._reactInternals)?Cr(l)===l:!1},enqueueSetState:function(l,c,f){l=l._reactInternals;var _=ai(),E=Ho(l),x=Js(_,E);x.payload=c,f!=null&&(x.callback=f),c=$o(l,x,E),c!==null&&(Or(c,l,E,_),Rm(c,l,E))},enqueueReplaceState:function(l,c,f){l=l._reactInternals;var _=ai(),E=Ho(l),x=Js(_,E);x.tag=1,x.payload=c,f!=null&&(x.callback=f),c=$o(l,x,E),c!==null&&(Or(c,l,E,_),Rm(c,l,E))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var f=ai(),_=Ho(l),E=Js(f,_);E.tag=2,c!=null&&(E.callback=c),c=$o(l,E,_),c!==null&&(Or(c,l,_,f),Rm(c,l,_))}};function MI(l,c,f,_,E,x,C){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,x,C):c.prototype&&c.prototype.isPureReactComponent?!od(f,_)||!od(E,x):!0}function bI(l,c,f){var _=!1,E=jo,x=c.contextType;return typeof x=="object"&&x!==null?x=ur(x):(E=_i(c)?ul:zn.current,_=c.contextTypes,x=(_=_!=null)?Zu(l,E):jo),c=new c(f,x),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Nm,l.stateNode=c,c._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=x),c}function kI(l,c,f,_){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,_),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,_),c.state!==l&&Nm.enqueueReplaceState(c,c.state,null)}function av(l,c,f,_){var E=l.stateNode;E.props=f,E.state=l.memoizedState,E.refs={},qy(l);var x=c.contextType;typeof x=="object"&&x!==null?E.context=ur(x):(x=_i(c)?ul:zn.current,E.context=Zu(l,x)),E.state=l.memoizedState,x=c.getDerivedStateFromProps,typeof x=="function"&&(ov(l,c,x,f),E.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(c=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),c!==E.state&&Nm.enqueueReplaceState(E,E.state,null),Pm(l,f,E,_),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function sc(l,c){try{var f="",_=c;do f+=Pt(_),_=_.return;while(_);var E=f}catch(x){E=`
Error generating stack: `+x.message+`
`+x.stack}return{value:l,source:c,stack:E,digest:null}}function lv(l,c,f){return{value:l,source:null,stack:f??null,digest:c??null}}function uv(l,c){try{console.error(c.value)}catch(f){setTimeout(function(){throw f})}}var yO=typeof WeakMap=="function"?WeakMap:Map;function LI(l,c,f){f=Js(-1,f),f.tag=3,f.payload={element:null};var _=c.value;return f.callback=function(){zm||(zm=!0,Sv=_),uv(l,c)},f}function DI(l,c,f){f=Js(-1,f),f.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var E=c.value;f.payload=function(){return _(E)},f.callback=function(){uv(l,c)}}var x=l.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(f.callback=function(){uv(l,c),typeof _!="function"&&(Ko===null?Ko=new Set([this]):Ko.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})}),f}function NI(l,c,f){var _=l.pingCache;if(_===null){_=l.pingCache=new yO;var E=new Set;_.set(c,E)}else E=_.get(c),E===void 0&&(E=new Set,_.set(c,E));E.has(f)||(E.add(f),l=kO.bind(null,l,c,f),c.then(l,l))}function OI(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function VI(l,c,f,_,E){return(l.mode&1)===0?(l===c?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(c=Js(-1,1),c.tag=2,$o(f,c,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=E,l)}var vO=L.ReactCurrentOwner,yi=!1;function oi(l,c,f,_){c.child=l===null?iI(c,null,f,_):ec(c,l.child,f,_)}function FI(l,c,f,_,E){f=f.render;var x=c.ref;return ic(c,E),_=tv(l,c,f,_,x,E),f=ev(),l!==null&&!yi?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,to(l,c,E)):(Ne&&f&&Vy(c),c.flags|=1,oi(l,c,_,E),c.child)}function GI(l,c,f,_,E){if(l===null){var x=f.type;return typeof x=="function"&&!bv(x)&&x.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(c.tag=15,c.type=x,UI(l,c,x,_,E)):(l=Hm(f.type,null,_,c,c.mode,E),l.ref=c.ref,l.return=c,c.child=l)}if(x=l.child,(l.lanes&E)===0){var C=x.memoizedProps;if(f=f.compare,f=f!==null?f:od,f(C,_)&&l.ref===c.ref)return to(l,c,E)}return c.flags|=1,l=Yo(x,_),l.ref=c.ref,l.return=c,c.child=l}function UI(l,c,f,_,E){if(l!==null){var x=l.memoizedProps;if(od(x,_)&&l.ref===c.ref)if(yi=!1,c.pendingProps=_=x,(l.lanes&E)!==0)(l.flags&131072)!==0&&(yi=!0);else return c.lanes=l.lanes,to(l,c,E)}return cv(l,c,f,_,E)}function jI(l,c,f){var _=c.pendingProps,E=_.children,x=l!==null?l.memoizedState:null;if(_.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(ac,ji),ji|=f;else{if((f&1073741824)===0)return l=x!==null?x.baseLanes|f:f,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,Pe(ac,ji),ji|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=x!==null?x.baseLanes:f,Pe(ac,ji),ji|=_}else x!==null?(_=x.baseLanes|f,c.memoizedState=null):_=f,Pe(ac,ji),ji|=_;return oi(l,c,E,f),c.child}function zI(l,c){var f=c.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(c.flags|=512,c.flags|=2097152)}function cv(l,c,f,_,E){var x=_i(f)?ul:zn.current;return x=Zu(c,x),ic(c,E),f=tv(l,c,f,_,x,E),_=ev(),l!==null&&!yi?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,to(l,c,E)):(Ne&&_&&Vy(c),c.flags|=1,oi(l,c,f,E),c.child)}function BI(l,c,f,_,E){if(_i(f)){var x=!0;vm(c)}else x=!1;if(ic(c,E),c.stateNode===null)Vm(l,c),bI(c,f,_),av(c,f,_,E),_=!0;else if(l===null){var C=c.stateNode,G=c.memoizedProps;C.props=G;var B=C.context,Z=f.contextType;typeof Z=="object"&&Z!==null?Z=ur(Z):(Z=_i(f)?ul:zn.current,Z=Zu(c,Z));var ot=f.getDerivedStateFromProps,lt=typeof ot=="function"||typeof C.getSnapshotBeforeUpdate=="function";lt||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(G!==_||B!==Z)&&kI(c,C,_,Z),Bo=!1;var rt=c.memoizedState;C.state=rt,Pm(c,_,C,E),B=c.memoizedState,G!==_||rt!==B||pi.current||Bo?(typeof ot=="function"&&(ov(c,f,ot,_),B=c.memoizedState),(G=Bo||MI(c,f,G,_,rt,B,Z))?(lt||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(c.flags|=4194308)):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=_,c.memoizedState=B),C.props=_,C.state=B,C.context=Z,_=G):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),_=!1)}else{C=c.stateNode,sI(l,c),G=c.memoizedProps,Z=c.type===c.elementType?G:Lr(c.type,G),C.props=Z,lt=c.pendingProps,rt=C.context,B=f.contextType,typeof B=="object"&&B!==null?B=ur(B):(B=_i(f)?ul:zn.current,B=Zu(c,B));var vt=f.getDerivedStateFromProps;(ot=typeof vt=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(G!==lt||rt!==B)&&kI(c,C,_,B),Bo=!1,rt=c.memoizedState,C.state=rt,Pm(c,_,C,E);var xt=c.memoizedState;G!==lt||rt!==xt||pi.current||Bo?(typeof vt=="function"&&(ov(c,f,vt,_),xt=c.memoizedState),(Z=Bo||MI(c,f,Z,_,rt,xt,B)||!1)?(ot||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(_,xt,B),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(_,xt,B)),typeof C.componentDidUpdate=="function"&&(c.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof C.componentDidUpdate!="function"||G===l.memoizedProps&&rt===l.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&rt===l.memoizedState||(c.flags|=1024),c.memoizedProps=_,c.memoizedState=xt),C.props=_,C.state=xt,C.context=B,_=Z):(typeof C.componentDidUpdate!="function"||G===l.memoizedProps&&rt===l.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&rt===l.memoizedState||(c.flags|=1024),_=!1)}return hv(l,c,f,_,x,E)}function hv(l,c,f,_,E,x){zI(l,c);var C=(c.flags&128)!==0;if(!_&&!C)return E&&HS(c,f,!1),to(l,c,x);_=c.stateNode,vO.current=c;var G=C&&typeof f.getDerivedStateFromError!="function"?null:_.render();return c.flags|=1,l!==null&&C?(c.child=ec(c,l.child,null,x),c.child=ec(c,null,G,x)):oi(l,c,G,x),c.memoizedState=_.state,E&&HS(c,f,!0),c.child}function $I(l){var c=l.stateNode;c.pendingContext?KS(l,c.pendingContext,c.pendingContext!==c.context):c.context&&KS(l,c.context,!1),Hy(l,c.containerInfo)}function WI(l,c,f,_,E){return tc(),jy(E),c.flags|=256,oi(l,c,f,_),c.child}var dv={dehydrated:null,treeContext:null,retryLane:0};function fv(l){return{baseLanes:l,cachePool:null,transitions:null}}function KI(l,c,f){var _=c.pendingProps,E=Ue.current,x=!1,C=(c.flags&128)!==0,G;if((G=C)||(G=l!==null&&l.memoizedState===null?!1:(E&2)!==0),G?(x=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),Pe(Ue,E&1),l===null)return Uy(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((c.mode&1)===0?c.lanes=1:l.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(C=_.children,l=_.fallback,x?(_=c.mode,x=c.child,C={mode:"hidden",children:C},(_&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=C):x=Xm(C,_,0,null),l=vl(l,_,f,null),x.return=c,l.return=c,x.sibling=l,c.child=x,c.child.memoizedState=fv(f),c.memoizedState=dv,l):gv(c,C));if(E=l.memoizedState,E!==null&&(G=E.dehydrated,G!==null))return EO(l,c,C,_,G,E,f);if(x){x=_.fallback,C=c.mode,E=l.child,G=E.sibling;var B={mode:"hidden",children:_.children};return(C&1)===0&&c.child!==E?(_=c.child,_.childLanes=0,_.pendingProps=B,c.deletions=null):(_=Yo(E,B),_.subtreeFlags=E.subtreeFlags&14680064),G!==null?x=Yo(G,x):(x=vl(x,C,f,null),x.flags|=2),x.return=c,_.return=c,_.sibling=x,c.child=_,_=x,x=c.child,C=l.child.memoizedState,C=C===null?fv(f):{baseLanes:C.baseLanes|f,cachePool:null,transitions:C.transitions},x.memoizedState=C,x.childLanes=l.childLanes&~f,c.memoizedState=dv,_}return x=l.child,l=x.sibling,_=Yo(x,{mode:"visible",children:_.children}),(c.mode&1)===0&&(_.lanes=f),_.return=c,_.sibling=null,l!==null&&(f=c.deletions,f===null?(c.deletions=[l],c.flags|=16):f.push(l)),c.child=_,c.memoizedState=null,_}function gv(l,c){return c=Xm({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Om(l,c,f,_){return _!==null&&jy(_),ec(c,l.child,null,f),l=gv(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function EO(l,c,f,_,E,x,C){if(f)return c.flags&256?(c.flags&=-257,_=lv(Error(e(422))),Om(l,c,C,_)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(x=_.fallback,E=c.mode,_=Xm({mode:"visible",children:_.children},E,0,null),x=vl(x,E,C,null),x.flags|=2,_.return=c,x.return=c,_.sibling=x,c.child=_,(c.mode&1)!==0&&ec(c,l.child,null,C),c.child.memoizedState=fv(C),c.memoizedState=dv,x);if((c.mode&1)===0)return Om(l,c,C,null);if(E.data==="$!"){if(_=E.nextSibling&&E.nextSibling.dataset,_)var G=_.dgst;return _=G,x=Error(e(419)),_=lv(x,_,void 0),Om(l,c,C,_)}if(G=(C&l.childLanes)!==0,yi||G){if(_=wn,_!==null){switch(C&-C){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(_.suspendedLanes|C))!==0?0:E,E!==0&&E!==x.retryLane&&(x.retryLane=E,Qs(l,E),Or(_,l,E,-1))}return Mv(),_=lv(Error(e(421))),Om(l,c,C,_)}return E.data==="$?"?(c.flags|=128,c.child=l.child,c=LO.bind(null,l),E._reactRetry=c,null):(l=x.treeContext,Ui=Go(E.nextSibling),Gi=c,Ne=!0,kr=null,l!==null&&(ar[lr++]=Ys,ar[lr++]=Zs,ar[lr++]=cl,Ys=l.id,Zs=l.overflow,cl=c),c=gv(c,_.children),c.flags|=4096,c)}function qI(l,c,f){l.lanes|=c;var _=l.alternate;_!==null&&(_.lanes|=c),Wy(l.return,c,f)}function mv(l,c,f,_,E){var x=l.memoizedState;x===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:_,tail:f,tailMode:E}:(x.isBackwards=c,x.rendering=null,x.renderingStartTime=0,x.last=_,x.tail=f,x.tailMode=E)}function HI(l,c,f){var _=c.pendingProps,E=_.revealOrder,x=_.tail;if(oi(l,c,_.children,f),_=Ue.current,(_&2)!==0)_=_&1|2,c.flags|=128;else{if(l!==null&&(l.flags&128)!==0)t:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&qI(l,f,c);else if(l.tag===19)qI(l,f,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break t;for(;l.sibling===null;){if(l.return===null||l.return===c)break t;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(Pe(Ue,_),(c.mode&1)===0)c.memoizedState=null;else switch(E){case"forwards":for(f=c.child,E=null;f!==null;)l=f.alternate,l!==null&&Cm(l)===null&&(E=f),f=f.sibling;f=E,f===null?(E=c.child,c.child=null):(E=f.sibling,f.sibling=null),mv(c,!1,E,f,x);break;case"backwards":for(f=null,E=c.child,c.child=null;E!==null;){if(l=E.alternate,l!==null&&Cm(l)===null){c.child=E;break}l=E.sibling,E.sibling=f,f=E,E=l}mv(c,!0,f,null,x);break;case"together":mv(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Vm(l,c){(c.mode&1)===0&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function to(l,c,f){if(l!==null&&(c.dependencies=l.dependencies),ml|=c.lanes,(f&c.childLanes)===0)return null;if(l!==null&&c.child!==l.child)throw Error(e(153));if(c.child!==null){for(l=c.child,f=Yo(l,l.pendingProps),c.child=f,f.return=c;l.sibling!==null;)l=l.sibling,f=f.sibling=Yo(l,l.pendingProps),f.return=c;f.sibling=null}return c.child}function wO(l,c,f){switch(c.tag){case 3:$I(c),tc();break;case 5:lI(c);break;case 1:_i(c.type)&&vm(c);break;case 4:Hy(c,c.stateNode.containerInfo);break;case 10:var _=c.type._context,E=c.memoizedProps.value;Pe(Im,_._currentValue),_._currentValue=E;break;case 13:if(_=c.memoizedState,_!==null)return _.dehydrated!==null?(Pe(Ue,Ue.current&1),c.flags|=128,null):(f&c.child.childLanes)!==0?KI(l,c,f):(Pe(Ue,Ue.current&1),l=to(l,c,f),l!==null?l.sibling:null);Pe(Ue,Ue.current&1);break;case 19:if(_=(f&c.childLanes)!==0,(l.flags&128)!==0){if(_)return HI(l,c,f);c.flags|=128}if(E=c.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Pe(Ue,Ue.current),_)break;return null;case 22:case 23:return c.lanes=0,jI(l,c,f)}return to(l,c,f)}var XI,pv,YI,ZI;XI=function(l,c){for(var f=c.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},pv=function(){},YI=function(l,c,f,_){var E=l.memoizedProps;if(E!==_){l=c.stateNode,fl(ms.current);var x=null;switch(f){case"input":E=gi(l,E),_=gi(l,_),x=[];break;case"select":E=it({},E,{value:void 0}),_=it({},_,{value:void 0}),x=[];break;case"textarea":E=tr(l,E),_=tr(l,_),x=[];break;default:typeof E.onClick!="function"&&typeof _.onClick=="function"&&(l.onclick=pm)}ii(f,_);var C;f=null;for(Z in E)if(!_.hasOwnProperty(Z)&&E.hasOwnProperty(Z)&&E[Z]!=null)if(Z==="style"){var G=E[Z];for(C in G)G.hasOwnProperty(C)&&(f||(f={}),f[C]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(r.hasOwnProperty(Z)?x||(x=[]):(x=x||[]).push(Z,null));for(Z in _){var B=_[Z];if(G=E?.[Z],_.hasOwnProperty(Z)&&B!==G&&(B!=null||G!=null))if(Z==="style")if(G){for(C in G)!G.hasOwnProperty(C)||B&&B.hasOwnProperty(C)||(f||(f={}),f[C]="");for(C in B)B.hasOwnProperty(C)&&G[C]!==B[C]&&(f||(f={}),f[C]=B[C])}else f||(x||(x=[]),x.push(Z,f)),f=B;else Z==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,G=G?G.__html:void 0,B!=null&&G!==B&&(x=x||[]).push(Z,B)):Z==="children"?typeof B!="string"&&typeof B!="number"||(x=x||[]).push(Z,""+B):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(r.hasOwnProperty(Z)?(B!=null&&Z==="onScroll"&&Me("scroll",l),x||G===B||(x=[])):(x=x||[]).push(Z,B))}f&&(x=x||[]).push("style",f);var Z=x;(c.updateQueue=Z)&&(c.flags|=4)}},ZI=function(l,c,f,_){f!==_&&(c.flags|=4)};function wd(l,c){if(!Ne)switch(l.tailMode){case"hidden":c=l.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var _=null;f!==null;)f.alternate!==null&&(_=f),f=f.sibling;_===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function $n(l){var c=l.alternate!==null&&l.alternate.child===l.child,f=0,_=0;if(c)for(var E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags&14680064,_|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags,_|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=_,l.childLanes=f,c}function xO(l,c,f){var _=c.pendingProps;switch(Fy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(c),null;case 1:return _i(c.type)&&ym(),$n(c),null;case 3:return _=c.stateNode,rc(),be(pi),be(zn),Zy(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(Tm(c)?c.flags|=4:l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,kr!==null&&(Rv(kr),kr=null))),pv(l,c),$n(c),null;case 5:Xy(c);var E=fl(pd.current);if(f=c.type,l!==null&&c.stateNode!=null)YI(l,c,f,_,E),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!_){if(c.stateNode===null)throw Error(e(166));return $n(c),null}if(l=fl(ms.current),Tm(c)){_=c.stateNode,f=c.type;var x=c.memoizedProps;switch(_[gs]=c,_[hd]=x,l=(c.mode&1)!==0,f){case"dialog":Me("cancel",_),Me("close",_);break;case"iframe":case"object":case"embed":Me("load",_);break;case"video":case"audio":for(E=0;E<ld.length;E++)Me(ld[E],_);break;case"source":Me("error",_);break;case"img":case"image":case"link":Me("error",_),Me("load",_);break;case"details":Me("toggle",_);break;case"input":An(_,x),Me("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!x.multiple},Me("invalid",_);break;case"textarea":De(_,x),Me("invalid",_)}ii(f,x),E=null;for(var C in x)if(x.hasOwnProperty(C)){var G=x[C];C==="children"?typeof G=="string"?_.textContent!==G&&(x.suppressHydrationWarning!==!0&&mm(_.textContent,G,l),E=["children",G]):typeof G=="number"&&_.textContent!==""+G&&(x.suppressHydrationWarning!==!0&&mm(_.textContent,G,l),E=["children",""+G]):r.hasOwnProperty(C)&&G!=null&&C==="onScroll"&&Me("scroll",_)}switch(f){case"input":Ar(_),Ji(_,x,!0);break;case"textarea":Ar(_),er(_);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(_.onclick=pm)}_=E,c.updateQueue=_,_!==null&&(c.flags|=4)}else{C=E.nodeType===9?E:E.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Yr(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=C.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof _.is=="string"?l=C.createElement(f,{is:_.is}):(l=C.createElement(f),f==="select"&&(C=l,_.multiple?C.multiple=!0:_.size&&(C.size=_.size))):l=C.createElementNS(l,f),l[gs]=c,l[hd]=_,XI(l,c,!1,!1),c.stateNode=l;t:{switch(C=Us(f,_),f){case"dialog":Me("cancel",l),Me("close",l),E=_;break;case"iframe":case"object":case"embed":Me("load",l),E=_;break;case"video":case"audio":for(E=0;E<ld.length;E++)Me(ld[E],l);E=_;break;case"source":Me("error",l),E=_;break;case"img":case"image":case"link":Me("error",l),Me("load",l),E=_;break;case"details":Me("toggle",l),E=_;break;case"input":An(l,_),E=gi(l,_),Me("invalid",l);break;case"option":E=_;break;case"select":l._wrapperState={wasMultiple:!!_.multiple},E=it({},_,{value:void 0}),Me("invalid",l);break;case"textarea":De(l,_),E=tr(l,_),Me("invalid",l);break;default:E=_}ii(f,E),G=E;for(x in G)if(G.hasOwnProperty(x)){var B=G[x];x==="style"?Gs(l,B):x==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&Xa(l,B)):x==="children"?typeof B=="string"?(f!=="textarea"||B!=="")&&Qr(l,B):typeof B=="number"&&Qr(l,""+B):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(r.hasOwnProperty(x)?B!=null&&x==="onScroll"&&Me("scroll",l):B!=null&&M(l,x,B,C))}switch(f){case"input":Ar(l),Ji(l,_,!1);break;case"textarea":Ar(l),er(l);break;case"option":_.value!=null&&l.setAttribute("value",""+$t(_.value));break;case"select":l.multiple=!!_.multiple,x=_.value,x!=null?yn(l,!!_.multiple,x,!1):_.defaultValue!=null&&yn(l,!!_.multiple,_.defaultValue,!0);break;default:typeof E.onClick=="function"&&(l.onclick=pm)}switch(f){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break t;case"img":_=!0;break t;default:_=!1}}_&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return $n(c),null;case 6:if(l&&c.stateNode!=null)ZI(l,c,l.memoizedProps,_);else{if(typeof _!="string"&&c.stateNode===null)throw Error(e(166));if(f=fl(pd.current),fl(ms.current),Tm(c)){if(_=c.stateNode,f=c.memoizedProps,_[gs]=c,(x=_.nodeValue!==f)&&(l=Gi,l!==null))switch(l.tag){case 3:mm(_.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&mm(_.nodeValue,f,(l.mode&1)!==0)}x&&(c.flags|=4)}else _=(f.nodeType===9?f:f.ownerDocument).createTextNode(_),_[gs]=c,c.stateNode=_}return $n(c),null;case 13:if(be(Ue),_=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Ne&&Ui!==null&&(c.mode&1)!==0&&(c.flags&128)===0)tI(),tc(),c.flags|=98560,x=!1;else if(x=Tm(c),_!==null&&_.dehydrated!==null){if(l===null){if(!x)throw Error(e(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(e(317));x[gs]=c}else tc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;$n(c),x=!1}else kr!==null&&(Rv(kr),kr=null),x=!0;if(!x)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=f,c):(_=_!==null,_!==(l!==null&&l.memoizedState!==null)&&_&&(c.child.flags|=8192,(c.mode&1)!==0&&(l===null||(Ue.current&1)!==0?dn===0&&(dn=3):Mv())),c.updateQueue!==null&&(c.flags|=4),$n(c),null);case 4:return rc(),pv(l,c),l===null&&ud(c.stateNode.containerInfo),$n(c),null;case 10:return $y(c.type._context),$n(c),null;case 17:return _i(c.type)&&ym(),$n(c),null;case 19:if(be(Ue),x=c.memoizedState,x===null)return $n(c),null;if(_=(c.flags&128)!==0,C=x.rendering,C===null)if(_)wd(x,!1);else{if(dn!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(C=Cm(l),C!==null){for(c.flags|=128,wd(x,!1),_=C.updateQueue,_!==null&&(c.updateQueue=_,c.flags|=4),c.subtreeFlags=0,_=f,f=c.child;f!==null;)x=f,l=_,x.flags&=14680066,C=x.alternate,C===null?(x.childLanes=0,x.lanes=l,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=C.childLanes,x.lanes=C.lanes,x.child=C.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=C.memoizedProps,x.memoizedState=C.memoizedState,x.updateQueue=C.updateQueue,x.type=C.type,l=C.dependencies,x.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return Pe(Ue,Ue.current&1|2),c.child}l=l.sibling}x.tail!==null&&Ce()>lc&&(c.flags|=128,_=!0,wd(x,!1),c.lanes=4194304)}else{if(!_)if(l=Cm(C),l!==null){if(c.flags|=128,_=!0,f=l.updateQueue,f!==null&&(c.updateQueue=f,c.flags|=4),wd(x,!0),x.tail===null&&x.tailMode==="hidden"&&!C.alternate&&!Ne)return $n(c),null}else 2*Ce()-x.renderingStartTime>lc&&f!==1073741824&&(c.flags|=128,_=!0,wd(x,!1),c.lanes=4194304);x.isBackwards?(C.sibling=c.child,c.child=C):(f=x.last,f!==null?f.sibling=C:c.child=C,x.last=C)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=Ce(),c.sibling=null,f=Ue.current,Pe(Ue,_?f&1|2:f&1),c):($n(c),null);case 22:case 23:return Cv(),_=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(c.flags|=8192),_&&(c.mode&1)!==0?(ji&1073741824)!==0&&($n(c),c.subtreeFlags&6&&(c.flags|=8192)):$n(c),null;case 24:return null;case 25:return null}throw Error(e(156,c.tag))}function TO(l,c){switch(Fy(c),c.tag){case 1:return _i(c.type)&&ym(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return rc(),be(pi),be(zn),Zy(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 5:return Xy(c),null;case 13:if(be(Ue),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(e(340));tc()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return be(Ue),null;case 4:return rc(),null;case 10:return $y(c.type._context),null;case 22:case 23:return Cv(),null;case 24:return null;default:return null}}var Fm=!1,Wn=!1,SO=typeof WeakSet=="function"?WeakSet:Set,Et=null;function oc(l,c){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(_){We(l,c,_)}else f.current=null}function _v(l,c,f){try{f()}catch(_){We(l,c,_)}}var QI=!1;function IO(l,c){if(Cy=Ws,l=MS(),wy(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else t:{f=(f=l.ownerDocument)&&f.defaultView||window;var _=f.getSelection&&f.getSelection();if(_&&_.rangeCount!==0){f=_.anchorNode;var E=_.anchorOffset,x=_.focusNode;_=_.focusOffset;try{f.nodeType,x.nodeType}catch{f=null;break t}var C=0,G=-1,B=-1,Z=0,ot=0,lt=l,rt=null;e:for(;;){for(var vt;lt!==f||E!==0&&lt.nodeType!==3||(G=C+E),lt!==x||_!==0&&lt.nodeType!==3||(B=C+_),lt.nodeType===3&&(C+=lt.nodeValue.length),(vt=lt.firstChild)!==null;)rt=lt,lt=vt;for(;;){if(lt===l)break e;if(rt===f&&++Z===E&&(G=C),rt===x&&++ot===_&&(B=C),(vt=lt.nextSibling)!==null)break;lt=rt,rt=lt.parentNode}lt=vt}f=G===-1||B===-1?null:{start:G,end:B}}else f=null}f=f||{start:0,end:0}}else f=null;for(My={focusedElem:l,selectionRange:f},Ws=!1,Et=c;Et!==null;)if(c=Et,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,Et=l;else for(;Et!==null;){c=Et;try{var xt=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(xt!==null){var St=xt.memoizedProps,Je=xt.memoizedState,H=c.stateNode,W=H.getSnapshotBeforeUpdate(c.elementType===c.type?St:Lr(c.type,St),Je);H.__reactInternalSnapshotBeforeUpdate=W}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(ht){We(c,c.return,ht)}if(l=c.sibling,l!==null){l.return=c.return,Et=l;break}Et=c.return}return xt=QI,QI=!1,xt}function xd(l,c,f){var _=c.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var E=_=_.next;do{if((E.tag&l)===l){var x=E.destroy;E.destroy=void 0,x!==void 0&&_v(c,f,x)}E=E.next}while(E!==_)}}function Gm(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&l)===l){var _=f.create;f.destroy=_()}f=f.next}while(f!==c)}}function yv(l){var c=l.ref;if(c!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof c=="function"?c(l):c.current=l}}function JI(l){var c=l.alternate;c!==null&&(l.alternate=null,JI(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&(delete c[gs],delete c[hd],delete c[Dy],delete c[aO],delete c[lO])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function t2(l){return l.tag===5||l.tag===3||l.tag===4}function e2(l){t:for(;;){for(;l.sibling===null;){if(l.return===null||t2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue t;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function vv(l,c,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?f.nodeType===8?f.parentNode.insertBefore(l,c):f.insertBefore(l,c):(f.nodeType===8?(c=f.parentNode,c.insertBefore(l,f)):(c=f,c.appendChild(l)),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=pm));else if(_!==4&&(l=l.child,l!==null))for(vv(l,c,f),l=l.sibling;l!==null;)vv(l,c,f),l=l.sibling}function Ev(l,c,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?f.insertBefore(l,c):f.appendChild(l);else if(_!==4&&(l=l.child,l!==null))for(Ev(l,c,f),l=l.sibling;l!==null;)Ev(l,c,f),l=l.sibling}var Ln=null,Dr=!1;function Wo(l,c,f){for(f=f.child;f!==null;)n2(l,c,f),f=f.sibling}function n2(l,c,f){if(Li&&typeof Li.onCommitFiberUnmount=="function")try{Li.onCommitFiberUnmount(Ja,f)}catch{}switch(f.tag){case 5:Wn||oc(f,c);case 6:var _=Ln,E=Dr;Ln=null,Wo(l,c,f),Ln=_,Dr=E,Ln!==null&&(Dr?(l=Ln,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):Ln.removeChild(f.stateNode));break;case 18:Ln!==null&&(Dr?(l=Ln,f=f.stateNode,l.nodeType===8?Ly(l.parentNode,f):l.nodeType===1&&Ly(l,f),No(l)):Ly(Ln,f.stateNode));break;case 4:_=Ln,E=Dr,Ln=f.stateNode.containerInfo,Dr=!0,Wo(l,c,f),Ln=_,Dr=E;break;case 0:case 11:case 14:case 15:if(!Wn&&(_=f.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){E=_=_.next;do{var x=E,C=x.destroy;x=x.tag,C!==void 0&&((x&2)!==0||(x&4)!==0)&&_v(f,c,C),E=E.next}while(E!==_)}Wo(l,c,f);break;case 1:if(!Wn&&(oc(f,c),_=f.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=f.memoizedProps,_.state=f.memoizedState,_.componentWillUnmount()}catch(G){We(f,c,G)}Wo(l,c,f);break;case 21:Wo(l,c,f);break;case 22:f.mode&1?(Wn=(_=Wn)||f.memoizedState!==null,Wo(l,c,f),Wn=_):Wo(l,c,f);break;default:Wo(l,c,f)}}function i2(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new SO),c.forEach(function(_){var E=DO.bind(null,l,_);f.has(_)||(f.add(_),_.then(E,E))})}}function Nr(l,c){var f=c.deletions;if(f!==null)for(var _=0;_<f.length;_++){var E=f[_];try{var x=l,C=c,G=C;t:for(;G!==null;){switch(G.tag){case 5:Ln=G.stateNode,Dr=!1;break t;case 3:Ln=G.stateNode.containerInfo,Dr=!0;break t;case 4:Ln=G.stateNode.containerInfo,Dr=!0;break t}G=G.return}if(Ln===null)throw Error(e(160));n2(x,C,E),Ln=null,Dr=!1;var B=E.alternate;B!==null&&(B.return=null),E.return=null}catch(Z){We(E,c,Z)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)r2(c,l),c=c.sibling}function r2(l,c){var f=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Nr(c,l),_s(l),_&4){try{xd(3,l,l.return),Gm(3,l)}catch(St){We(l,l.return,St)}try{xd(5,l,l.return)}catch(St){We(l,l.return,St)}}break;case 1:Nr(c,l),_s(l),_&512&&f!==null&&oc(f,f.return);break;case 5:if(Nr(c,l),_s(l),_&512&&f!==null&&oc(f,f.return),l.flags&32){var E=l.stateNode;try{Qr(E,"")}catch(St){We(l,l.return,St)}}if(_&4&&(E=l.stateNode,E!=null)){var x=l.memoizedProps,C=f!==null?f.memoizedProps:x,G=l.type,B=l.updateQueue;if(l.updateQueue=null,B!==null)try{G==="input"&&x.type==="radio"&&x.name!=null&&Rn(E,x),Us(G,C);var Z=Us(G,x);for(C=0;C<B.length;C+=2){var ot=B[C],lt=B[C+1];ot==="style"?Gs(E,lt):ot==="dangerouslySetInnerHTML"?Xa(E,lt):ot==="children"?Qr(E,lt):M(E,ot,lt,Z)}switch(G){case"input":mi(E,x);break;case"textarea":Co(E,x);break;case"select":var rt=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!x.multiple;var vt=x.value;vt!=null?yn(E,!!x.multiple,vt,!1):rt!==!!x.multiple&&(x.defaultValue!=null?yn(E,!!x.multiple,x.defaultValue,!0):yn(E,!!x.multiple,x.multiple?[]:"",!1))}E[hd]=x}catch(St){We(l,l.return,St)}}break;case 6:if(Nr(c,l),_s(l),_&4){if(l.stateNode===null)throw Error(e(162));E=l.stateNode,x=l.memoizedProps;try{E.nodeValue=x}catch(St){We(l,l.return,St)}}break;case 3:if(Nr(c,l),_s(l),_&4&&f!==null&&f.memoizedState.isDehydrated)try{No(c.containerInfo)}catch(St){We(l,l.return,St)}break;case 4:Nr(c,l),_s(l);break;case 13:Nr(c,l),_s(l),E=l.child,E.flags&8192&&(x=E.memoizedState!==null,E.stateNode.isHidden=x,!x||E.alternate!==null&&E.alternate.memoizedState!==null||(Tv=Ce())),_&4&&i2(l);break;case 22:if(ot=f!==null&&f.memoizedState!==null,l.mode&1?(Wn=(Z=Wn)||ot,Nr(c,l),Wn=Z):Nr(c,l),_s(l),_&8192){if(Z=l.memoizedState!==null,(l.stateNode.isHidden=Z)&&!ot&&(l.mode&1)!==0)for(Et=l,ot=l.child;ot!==null;){for(lt=Et=ot;Et!==null;){switch(rt=Et,vt=rt.child,rt.tag){case 0:case 11:case 14:case 15:xd(4,rt,rt.return);break;case 1:oc(rt,rt.return);var xt=rt.stateNode;if(typeof xt.componentWillUnmount=="function"){_=rt,f=rt.return;try{c=_,xt.props=c.memoizedProps,xt.state=c.memoizedState,xt.componentWillUnmount()}catch(St){We(_,f,St)}}break;case 5:oc(rt,rt.return);break;case 22:if(rt.memoizedState!==null){a2(lt);continue}}vt!==null?(vt.return=rt,Et=vt):a2(lt)}ot=ot.sibling}t:for(ot=null,lt=l;;){if(lt.tag===5){if(ot===null){ot=lt;try{E=lt.stateNode,Z?(x=E.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(G=lt.stateNode,B=lt.memoizedProps.style,C=B!=null&&B.hasOwnProperty("display")?B.display:null,G.style.display=Jr("display",C))}catch(St){We(l,l.return,St)}}}else if(lt.tag===6){if(ot===null)try{lt.stateNode.nodeValue=Z?"":lt.memoizedProps}catch(St){We(l,l.return,St)}}else if((lt.tag!==22&&lt.tag!==23||lt.memoizedState===null||lt===l)&&lt.child!==null){lt.child.return=lt,lt=lt.child;continue}if(lt===l)break t;for(;lt.sibling===null;){if(lt.return===null||lt.return===l)break t;ot===lt&&(ot=null),lt=lt.return}ot===lt&&(ot=null),lt.sibling.return=lt.return,lt=lt.sibling}}break;case 19:Nr(c,l),_s(l),_&4&&i2(l);break;case 21:break;default:Nr(c,l),_s(l)}}function _s(l){var c=l.flags;if(c&2){try{t:{for(var f=l.return;f!==null;){if(t2(f)){var _=f;break t}f=f.return}throw Error(e(160))}switch(_.tag){case 5:var E=_.stateNode;_.flags&32&&(Qr(E,""),_.flags&=-33);var x=e2(l);Ev(l,x,E);break;case 3:case 4:var C=_.stateNode.containerInfo,G=e2(l);vv(l,G,C);break;default:throw Error(e(161))}}catch(B){We(l,l.return,B)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function AO(l,c,f){Et=l,s2(l)}function s2(l,c,f){for(var _=(l.mode&1)!==0;Et!==null;){var E=Et,x=E.child;if(E.tag===22&&_){var C=E.memoizedState!==null||Fm;if(!C){var G=E.alternate,B=G!==null&&G.memoizedState!==null||Wn;G=Fm;var Z=Wn;if(Fm=C,(Wn=B)&&!Z)for(Et=E;Et!==null;)C=Et,B=C.child,C.tag===22&&C.memoizedState!==null?l2(E):B!==null?(B.return=C,Et=B):l2(E);for(;x!==null;)Et=x,s2(x),x=x.sibling;Et=E,Fm=G,Wn=Z}o2(l)}else(E.subtreeFlags&8772)!==0&&x!==null?(x.return=E,Et=x):o2(l)}}function o2(l){for(;Et!==null;){var c=Et;if((c.flags&8772)!==0){var f=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Wn||Gm(5,c);break;case 1:var _=c.stateNode;if(c.flags&4&&!Wn)if(f===null)_.componentDidMount();else{var E=c.elementType===c.type?f.memoizedProps:Lr(c.type,f.memoizedProps);_.componentDidUpdate(E,f.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var x=c.updateQueue;x!==null&&aI(c,x,_);break;case 3:var C=c.updateQueue;if(C!==null){if(f=null,c.child!==null)switch(c.child.tag){case 5:f=c.child.stateNode;break;case 1:f=c.child.stateNode}aI(c,C,f)}break;case 5:var G=c.stateNode;if(f===null&&c.flags&4){f=G;var B=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&f.focus();break;case"img":B.src&&(f.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Z=c.alternate;if(Z!==null){var ot=Z.memoizedState;if(ot!==null){var lt=ot.dehydrated;lt!==null&&No(lt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}Wn||c.flags&512&&yv(c)}catch(rt){We(c,c.return,rt)}}if(c===l){Et=null;break}if(f=c.sibling,f!==null){f.return=c.return,Et=f;break}Et=c.return}}function a2(l){for(;Et!==null;){var c=Et;if(c===l){Et=null;break}var f=c.sibling;if(f!==null){f.return=c.return,Et=f;break}Et=c.return}}function l2(l){for(;Et!==null;){var c=Et;try{switch(c.tag){case 0:case 11:case 15:var f=c.return;try{Gm(4,c)}catch(B){We(c,f,B)}break;case 1:var _=c.stateNode;if(typeof _.componentDidMount=="function"){var E=c.return;try{_.componentDidMount()}catch(B){We(c,E,B)}}var x=c.return;try{yv(c)}catch(B){We(c,x,B)}break;case 5:var C=c.return;try{yv(c)}catch(B){We(c,C,B)}}}catch(B){We(c,c.return,B)}if(c===l){Et=null;break}var G=c.sibling;if(G!==null){G.return=c.return,Et=G;break}Et=c.return}}var RO=Math.ceil,Um=L.ReactCurrentDispatcher,wv=L.ReactCurrentOwner,hr=L.ReactCurrentBatchConfig,re=0,wn=null,on=null,Dn=0,ji=0,ac=Uo(0),dn=0,Td=null,ml=0,jm=0,xv=0,Sd=null,vi=null,Tv=0,lc=1/0,eo=null,zm=!1,Sv=null,Ko=null,Bm=!1,qo=null,$m=0,Id=0,Iv=null,Wm=-1,Km=0;function ai(){return(re&6)!==0?Ce():Wm!==-1?Wm:Wm=Ce()}function Ho(l){return(l.mode&1)===0?1:(re&2)!==0&&Dn!==0?Dn&-Dn:cO.transition!==null?(Km===0&&(Km=Kh()),Km):(l=ee,l!==0||(l=window.event,l=l===void 0?16:Vu(l.type)),l)}function Or(l,c,f,_){if(50<Id)throw Id=0,Iv=null,Error(e(185));il(l,f,_),((re&2)===0||l!==wn)&&(l===wn&&((re&2)===0&&(jm|=f),dn===4&&Xo(l,Dn)),Ei(l,_),f===1&&re===0&&(c.mode&1)===0&&(lc=Ce()+500,Em&&zo()))}function Ei(l,c){var f=l.callbackNode;nl(l,c);var _=zs(l,l===wn?Dn:0);if(_===0)f!==null&&Mu(f),l.callbackNode=null,l.callbackPriority=0;else if(c=_&-_,l.callbackPriority!==c){if(f!=null&&Mu(f),c===1)l.tag===0?uO(c2.bind(null,l)):XS(c2.bind(null,l)),sO(function(){(re&6)===0&&zo()}),f=null;else{switch(rs(_)){case 1:f=bu;break;case 4:f=Bh;break;case 16:f=Qa;break;case 536870912:f=ku;break;default:f=Qa}f=y2(f,u2.bind(null,l))}l.callbackPriority=c,l.callbackNode=f}}function u2(l,c){if(Wm=-1,Km=0,(re&6)!==0)throw Error(e(327));var f=l.callbackNode;if(uc()&&l.callbackNode!==f)return null;var _=zs(l,l===wn?Dn:0);if(_===0)return null;if((_&30)!==0||(_&l.expiredLanes)!==0||c)c=qm(l,_);else{c=_;var E=re;re|=2;var x=d2();(wn!==l||Dn!==c)&&(eo=null,lc=Ce()+500,_l(l,c));do try{MO();break}catch(G){h2(l,G)}while(!0);By(),Um.current=x,re=E,on!==null?c=0:(wn=null,Dn=0,c=dn)}if(c!==0){if(c===2&&(E=Wh(l),E!==0&&(_=E,c=Av(l,E))),c===1)throw f=Td,_l(l,0),Xo(l,_),Ei(l,Ce()),f;if(c===6)Xo(l,_);else{if(E=l.current.alternate,(_&30)===0&&!PO(E)&&(c=qm(l,_),c===2&&(x=Wh(l),x!==0&&(_=x,c=Av(l,x))),c===1))throw f=Td,_l(l,0),Xo(l,_),Ei(l,Ce()),f;switch(l.finishedWork=E,l.finishedLanes=_,c){case 0:case 1:throw Error(e(345));case 2:yl(l,vi,eo);break;case 3:if(Xo(l,_),(_&130023424)===_&&(c=Tv+500-Ce(),10<c)){if(zs(l,0)!==0)break;if(E=l.suspendedLanes,(E&_)!==_){ai(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=ky(yl.bind(null,l,vi,eo),c);break}yl(l,vi,eo);break;case 4:if(Xo(l,_),(_&4194240)===_)break;for(c=l.eventTimes,E=-1;0<_;){var C=31-Di(_);x=1<<C,C=c[C],C>E&&(E=C),_&=~x}if(_=E,_=Ce()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*RO(_/1960))-_,10<_){l.timeoutHandle=ky(yl.bind(null,l,vi,eo),_);break}yl(l,vi,eo);break;case 5:yl(l,vi,eo);break;default:throw Error(e(329))}}}return Ei(l,Ce()),l.callbackNode===f?u2.bind(null,l):null}function Av(l,c){var f=Sd;return l.current.memoizedState.isDehydrated&&(_l(l,c).flags|=256),l=qm(l,c),l!==2&&(c=vi,vi=f,c!==null&&Rv(c)),l}function Rv(l){vi===null?vi=l:vi.push.apply(vi,l)}function PO(l){for(var c=l;;){if(c.flags&16384){var f=c.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var _=0;_<f.length;_++){var E=f[_],x=E.getSnapshot;E=E.value;try{if(!br(x(),E))return!1}catch{return!1}}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Xo(l,c){for(c&=~xv,c&=~jm,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var f=31-Di(c),_=1<<f;l[f]=-1,c&=~_}}function c2(l){if((re&6)!==0)throw Error(e(327));uc();var c=zs(l,0);if((c&1)===0)return Ei(l,Ce()),null;var f=qm(l,c);if(l.tag!==0&&f===2){var _=Wh(l);_!==0&&(c=_,f=Av(l,_))}if(f===1)throw f=Td,_l(l,0),Xo(l,c),Ei(l,Ce()),f;if(f===6)throw Error(e(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,yl(l,vi,eo),Ei(l,Ce()),null}function Pv(l,c){var f=re;re|=1;try{return l(c)}finally{re=f,re===0&&(lc=Ce()+500,Em&&zo())}}function pl(l){qo!==null&&qo.tag===0&&(re&6)===0&&uc();var c=re;re|=1;var f=hr.transition,_=ee;try{if(hr.transition=null,ee=1,l)return l()}finally{ee=_,hr.transition=f,re=c,(re&6)===0&&zo()}}function Cv(){ji=ac.current,be(ac)}function _l(l,c){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,rO(f)),on!==null)for(f=on.return;f!==null;){var _=f;switch(Fy(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&ym();break;case 3:rc(),be(pi),be(zn),Zy();break;case 5:Xy(_);break;case 4:rc();break;case 13:be(Ue);break;case 19:be(Ue);break;case 10:$y(_.type._context);break;case 22:case 23:Cv()}f=f.return}if(wn=l,on=l=Yo(l.current,null),Dn=ji=c,dn=0,Td=null,xv=jm=ml=0,vi=Sd=null,dl!==null){for(c=0;c<dl.length;c++)if(f=dl[c],_=f.interleaved,_!==null){f.interleaved=null;var E=_.next,x=f.pending;if(x!==null){var C=x.next;x.next=E,_.next=C}f.pending=_}dl=null}return l}function h2(l,c){do{var f=on;try{if(By(),Mm.current=Dm,bm){for(var _=je.memoizedState;_!==null;){var E=_.queue;E!==null&&(E.pending=null),_=_.next}bm=!1}if(gl=0,En=hn=je=null,_d=!1,yd=0,wv.current=null,f===null||f.return===null){dn=1,Td=c,on=null;break}t:{var x=l,C=f.return,G=f,B=c;if(c=Dn,G.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var Z=B,ot=G,lt=ot.tag;if((ot.mode&1)===0&&(lt===0||lt===11||lt===15)){var rt=ot.alternate;rt?(ot.updateQueue=rt.updateQueue,ot.memoizedState=rt.memoizedState,ot.lanes=rt.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var vt=OI(C);if(vt!==null){vt.flags&=-257,VI(vt,C,G,x,c),vt.mode&1&&NI(x,Z,c),c=vt,B=Z;var xt=c.updateQueue;if(xt===null){var St=new Set;St.add(B),c.updateQueue=St}else xt.add(B);break t}else{if((c&1)===0){NI(x,Z,c),Mv();break t}B=Error(e(426))}}else if(Ne&&G.mode&1){var Je=OI(C);if(Je!==null){(Je.flags&65536)===0&&(Je.flags|=256),VI(Je,C,G,x,c),jy(sc(B,G));break t}}x=B=sc(B,G),dn!==4&&(dn=2),Sd===null?Sd=[x]:Sd.push(x),x=C;do{switch(x.tag){case 3:x.flags|=65536,c&=-c,x.lanes|=c;var H=LI(x,B,c);oI(x,H);break t;case 1:G=B;var W=x.type,Y=x.stateNode;if((x.flags&128)===0&&(typeof W.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Ko===null||!Ko.has(Y)))){x.flags|=65536,c&=-c,x.lanes|=c;var ht=DI(x,G,c);oI(x,ht);break t}}x=x.return}while(x!==null)}g2(f)}catch(It){c=It,on===f&&f!==null&&(on=f=f.return);continue}break}while(!0)}function d2(){var l=Um.current;return Um.current=Dm,l===null?Dm:l}function Mv(){(dn===0||dn===3||dn===2)&&(dn=4),wn===null||(ml&268435455)===0&&(jm&268435455)===0||Xo(wn,Dn)}function qm(l,c){var f=re;re|=2;var _=d2();(wn!==l||Dn!==c)&&(eo=null,_l(l,c));do try{CO();break}catch(E){h2(l,E)}while(!0);if(By(),re=f,Um.current=_,on!==null)throw Error(e(261));return wn=null,Dn=0,dn}function CO(){for(;on!==null;)f2(on)}function MO(){for(;on!==null&&!Za();)f2(on)}function f2(l){var c=_2(l.alternate,l,ji);l.memoizedProps=l.pendingProps,c===null?g2(l):on=c,wv.current=null}function g2(l){var c=l;do{var f=c.alternate;if(l=c.return,(c.flags&32768)===0){if(f=xO(f,c,ji),f!==null){on=f;return}}else{if(f=TO(f,c),f!==null){f.flags&=32767,on=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{dn=6,on=null;return}}if(c=c.sibling,c!==null){on=c;return}on=c=l}while(c!==null);dn===0&&(dn=5)}function yl(l,c,f){var _=ee,E=hr.transition;try{hr.transition=null,ee=1,bO(l,c,f,_)}finally{hr.transition=E,ee=_}return null}function bO(l,c,f,_){do uc();while(qo!==null);if((re&6)!==0)throw Error(e(327));f=l.finishedWork;var E=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(e(177));l.callbackNode=null,l.callbackPriority=0;var x=f.lanes|f.childLanes;if(py(l,x),l===wn&&(on=wn=null,Dn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Bm||(Bm=!0,y2(Qa,function(){return uc(),null})),x=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||x){x=hr.transition,hr.transition=null;var C=ee;ee=1;var G=re;re|=4,wv.current=null,IO(l,f),r2(f,l),Z3(My),Ws=!!Cy,My=Cy=null,l.current=f,AO(f),js(),re=G,ee=C,hr.transition=x}else l.current=f;if(Bm&&(Bm=!1,qo=l,$m=E),x=l.pendingLanes,x===0&&(Ko=null),tm(f.stateNode),Ei(l,Ce()),c!==null)for(_=l.onRecoverableError,f=0;f<c.length;f++)E=c[f],_(E.value,{componentStack:E.stack,digest:E.digest});if(zm)throw zm=!1,l=Sv,Sv=null,l;return($m&1)!==0&&l.tag!==0&&uc(),x=l.pendingLanes,(x&1)!==0?l===Iv?Id++:(Id=0,Iv=l):Id=0,zo(),null}function uc(){if(qo!==null){var l=rs($m),c=hr.transition,f=ee;try{if(hr.transition=null,ee=16>l?16:l,qo===null)var _=!1;else{if(l=qo,qo=null,$m=0,(re&6)!==0)throw Error(e(331));var E=re;for(re|=4,Et=l.current;Et!==null;){var x=Et,C=x.child;if((Et.flags&16)!==0){var G=x.deletions;if(G!==null){for(var B=0;B<G.length;B++){var Z=G[B];for(Et=Z;Et!==null;){var ot=Et;switch(ot.tag){case 0:case 11:case 15:xd(8,ot,x)}var lt=ot.child;if(lt!==null)lt.return=ot,Et=lt;else for(;Et!==null;){ot=Et;var rt=ot.sibling,vt=ot.return;if(JI(ot),ot===Z){Et=null;break}if(rt!==null){rt.return=vt,Et=rt;break}Et=vt}}}var xt=x.alternate;if(xt!==null){var St=xt.child;if(St!==null){xt.child=null;do{var Je=St.sibling;St.sibling=null,St=Je}while(St!==null)}}Et=x}}if((x.subtreeFlags&2064)!==0&&C!==null)C.return=x,Et=C;else t:for(;Et!==null;){if(x=Et,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:xd(9,x,x.return)}var H=x.sibling;if(H!==null){H.return=x.return,Et=H;break t}Et=x.return}}var W=l.current;for(Et=W;Et!==null;){C=Et;var Y=C.child;if((C.subtreeFlags&2064)!==0&&Y!==null)Y.return=C,Et=Y;else t:for(C=W;Et!==null;){if(G=Et,(G.flags&2048)!==0)try{switch(G.tag){case 0:case 11:case 15:Gm(9,G)}}catch(It){We(G,G.return,It)}if(G===C){Et=null;break t}var ht=G.sibling;if(ht!==null){ht.return=G.return,Et=ht;break t}Et=G.return}}if(re=E,zo(),Li&&typeof Li.onPostCommitFiberRoot=="function")try{Li.onPostCommitFiberRoot(Ja,l)}catch{}_=!0}return _}finally{ee=f,hr.transition=c}}return!1}function m2(l,c,f){c=sc(f,c),c=LI(l,c,1),l=$o(l,c,1),c=ai(),l!==null&&(il(l,1,c),Ei(l,c))}function We(l,c,f){if(l.tag===3)m2(l,l,f);else for(;c!==null;){if(c.tag===3){m2(c,l,f);break}else if(c.tag===1){var _=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Ko===null||!Ko.has(_))){l=sc(f,l),l=DI(c,l,1),c=$o(c,l,1),l=ai(),c!==null&&(il(c,1,l),Ei(c,l));break}}c=c.return}}function kO(l,c,f){var _=l.pingCache;_!==null&&_.delete(c),c=ai(),l.pingedLanes|=l.suspendedLanes&f,wn===l&&(Dn&f)===f&&(dn===4||dn===3&&(Dn&130023424)===Dn&&500>Ce()-Tv?_l(l,0):xv|=f),Ei(l,c)}function p2(l,c){c===0&&((l.mode&1)===0?c=1:(c=ko,ko<<=1,(ko&130023424)===0&&(ko=4194304)));var f=ai();l=Qs(l,c),l!==null&&(il(l,c,f),Ei(l,f))}function LO(l){var c=l.memoizedState,f=0;c!==null&&(f=c.retryLane),p2(l,f)}function DO(l,c){var f=0;switch(l.tag){case 13:var _=l.stateNode,E=l.memoizedState;E!==null&&(f=E.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(e(314))}_!==null&&_.delete(c),p2(l,f)}var _2;_2=function(l,c,f){if(l!==null)if(l.memoizedProps!==c.pendingProps||pi.current)yi=!0;else{if((l.lanes&f)===0&&(c.flags&128)===0)return yi=!1,wO(l,c,f);yi=(l.flags&131072)!==0}else yi=!1,Ne&&(c.flags&1048576)!==0&&YS(c,xm,c.index);switch(c.lanes=0,c.tag){case 2:var _=c.type;Vm(l,c),l=c.pendingProps;var E=Zu(c,zn.current);ic(c,f),E=tv(null,c,_,l,E,f);var x=ev();return c.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,_i(_)?(x=!0,vm(c)):x=!1,c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,qy(c),E.updater=Nm,c.stateNode=E,E._reactInternals=c,av(c,_,l,f),c=hv(null,c,_,!0,x,f)):(c.tag=0,Ne&&x&&Vy(c),oi(null,c,E,f),c=c.child),c;case 16:_=c.elementType;t:{switch(Vm(l,c),l=c.pendingProps,E=_._init,_=E(_._payload),c.type=_,E=c.tag=OO(_),l=Lr(_,l),E){case 0:c=cv(null,c,_,l,f);break t;case 1:c=BI(null,c,_,l,f);break t;case 11:c=FI(null,c,_,l,f);break t;case 14:c=GI(null,c,_,Lr(_.type,l),f);break t}throw Error(e(306,_,""))}return c;case 0:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Lr(_,E),cv(l,c,_,E,f);case 1:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Lr(_,E),BI(l,c,_,E,f);case 3:t:{if($I(c),l===null)throw Error(e(387));_=c.pendingProps,x=c.memoizedState,E=x.element,sI(l,c),Pm(c,_,null,f);var C=c.memoizedState;if(_=C.element,x.isDehydrated)if(x={element:_,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},c.updateQueue.baseState=x,c.memoizedState=x,c.flags&256){E=sc(Error(e(423)),c),c=WI(l,c,_,f,E);break t}else if(_!==E){E=sc(Error(e(424)),c),c=WI(l,c,_,f,E);break t}else for(Ui=Go(c.stateNode.containerInfo.firstChild),Gi=c,Ne=!0,kr=null,f=iI(c,null,_,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(tc(),_===E){c=to(l,c,f);break t}oi(l,c,_,f)}c=c.child}return c;case 5:return lI(c),l===null&&Uy(c),_=c.type,E=c.pendingProps,x=l!==null?l.memoizedProps:null,C=E.children,by(_,E)?C=null:x!==null&&by(_,x)&&(c.flags|=32),zI(l,c),oi(l,c,C,f),c.child;case 6:return l===null&&Uy(c),null;case 13:return KI(l,c,f);case 4:return Hy(c,c.stateNode.containerInfo),_=c.pendingProps,l===null?c.child=ec(c,null,_,f):oi(l,c,_,f),c.child;case 11:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Lr(_,E),FI(l,c,_,E,f);case 7:return oi(l,c,c.pendingProps,f),c.child;case 8:return oi(l,c,c.pendingProps.children,f),c.child;case 12:return oi(l,c,c.pendingProps.children,f),c.child;case 10:t:{if(_=c.type._context,E=c.pendingProps,x=c.memoizedProps,C=E.value,Pe(Im,_._currentValue),_._currentValue=C,x!==null)if(br(x.value,C)){if(x.children===E.children&&!pi.current){c=to(l,c,f);break t}}else for(x=c.child,x!==null&&(x.return=c);x!==null;){var G=x.dependencies;if(G!==null){C=x.child;for(var B=G.firstContext;B!==null;){if(B.context===_){if(x.tag===1){B=Js(-1,f&-f),B.tag=2;var Z=x.updateQueue;if(Z!==null){Z=Z.shared;var ot=Z.pending;ot===null?B.next=B:(B.next=ot.next,ot.next=B),Z.pending=B}}x.lanes|=f,B=x.alternate,B!==null&&(B.lanes|=f),Wy(x.return,f,c),G.lanes|=f;break}B=B.next}}else if(x.tag===10)C=x.type===c.type?null:x.child;else if(x.tag===18){if(C=x.return,C===null)throw Error(e(341));C.lanes|=f,G=C.alternate,G!==null&&(G.lanes|=f),Wy(C,f,c),C=x.sibling}else C=x.child;if(C!==null)C.return=x;else for(C=x;C!==null;){if(C===c){C=null;break}if(x=C.sibling,x!==null){x.return=C.return,C=x;break}C=C.return}x=C}oi(l,c,E.children,f),c=c.child}return c;case 9:return E=c.type,_=c.pendingProps.children,ic(c,f),E=ur(E),_=_(E),c.flags|=1,oi(l,c,_,f),c.child;case 14:return _=c.type,E=Lr(_,c.pendingProps),E=Lr(_.type,E),GI(l,c,_,E,f);case 15:return UI(l,c,c.type,c.pendingProps,f);case 17:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Lr(_,E),Vm(l,c),c.tag=1,_i(_)?(l=!0,vm(c)):l=!1,ic(c,f),bI(c,_,E),av(c,_,E,f),hv(null,c,_,!0,l,f);case 19:return HI(l,c,f);case 22:return jI(l,c,f)}throw Error(e(156,c.tag))};function y2(l,c){return zh(l,c)}function NO(l,c,f,_){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dr(l,c,f,_){return new NO(l,c,f,_)}function bv(l){return l=l.prototype,!(!l||!l.isReactComponent)}function OO(l){if(typeof l=="function")return bv(l)?1:0;if(l!=null){if(l=l.$$typeof,l===U)return 11;if(l===wt)return 14}return 2}function Yo(l,c){var f=l.alternate;return f===null?(f=dr(l.tag,c,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=c,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,c=l.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function Hm(l,c,f,_,E,x){var C=2;if(_=l,typeof l=="function")bv(l)&&(C=1);else if(typeof l=="string")C=5;else t:switch(l){case b:return vl(f.children,E,x,c);case A:C=8,E|=8;break;case k:return l=dr(12,f,c,E|2),l.elementType=k,l.lanes=x,l;case N:return l=dr(13,f,c,E),l.elementType=N,l.lanes=x,l;case ut:return l=dr(19,f,c,E),l.elementType=ut,l.lanes=x,l;case dt:return Xm(f,E,x,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case V:C=10;break t;case F:C=9;break t;case U:C=11;break t;case wt:C=14;break t;case yt:C=16,_=null;break t}throw Error(e(130,l==null?l:typeof l,""))}return c=dr(C,f,c,E),c.elementType=l,c.type=_,c.lanes=x,c}function vl(l,c,f,_){return l=dr(7,l,_,c),l.lanes=f,l}function Xm(l,c,f,_){return l=dr(22,l,_,c),l.elementType=dt,l.lanes=f,l.stateNode={isHidden:!1},l}function kv(l,c,f){return l=dr(6,l,null,c),l.lanes=f,l}function Lv(l,c,f){return c=dr(4,l.children!==null?l.children:[],l.key,c),c.lanes=f,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function VO(l,c,f,_,E){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qh(0),this.expirationTimes=qh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qh(0),this.identifierPrefix=_,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function Dv(l,c,f,_,E,x,C,G,B){return l=new VO(l,c,f,G,B),c===1?(c=1,x===!0&&(c|=8)):c=0,x=dr(3,null,null,c),l.current=x,x.stateNode=l,x.memoizedState={element:_,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},qy(x),l}function FO(l,c,f){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:_==null?null:""+_,children:l,containerInfo:c,implementation:f}}function v2(l){if(!l)return jo;l=l._reactInternals;t:{if(Cr(l)!==l||l.tag!==1)throw Error(e(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(_i(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(c!==null);throw Error(e(171))}if(l.tag===1){var f=l.type;if(_i(f))return qS(l,f,c)}return c}function E2(l,c,f,_,E,x,C,G,B){return l=Dv(f,_,!0,l,E,x,C,G,B),l.context=v2(null),f=l.current,_=ai(),E=Ho(f),x=Js(_,E),x.callback=c??null,$o(f,x,E),l.current.lanes=E,il(l,E,_),Ei(l,_),l}function Ym(l,c,f,_){var E=c.current,x=ai(),C=Ho(E);return f=v2(f),c.context===null?c.context=f:c.pendingContext=f,c=Js(x,C),c.payload={element:l},_=_===void 0?null:_,_!==null&&(c.callback=_),l=$o(E,c,C),l!==null&&(Or(l,E,C,x),Rm(l,E,C)),C}function Zm(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function w2(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<c?f:c}}function Nv(l,c){w2(l,c),(l=l.alternate)&&w2(l,c)}function GO(){return null}var x2=typeof reportError=="function"?reportError:function(l){console.error(l)};function Ov(l){this._internalRoot=l}Qm.prototype.render=Ov.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(e(409));Ym(l,c,null,null)},Qm.prototype.unmount=Ov.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;pl(function(){Ym(null,l,null,null)}),c[Hs]=null}};function Qm(l){this._internalRoot=l}Qm.prototype.unstable_scheduleHydration=function(l){if(l){var c=Zh();l={blockedOn:null,target:l,priority:c};for(var f=0;f<Ni.length&&c!==0&&c<Ni[f].priority;f++);Ni.splice(f,0,l),f===0&&Nu(l)}};function Vv(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Jm(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function T2(){}function UO(l,c,f,_,E){if(E){if(typeof _=="function"){var x=_;_=function(){var Z=Zm(C);x.call(Z)}}var C=E2(c,_,l,0,null,!1,!1,"",T2);return l._reactRootContainer=C,l[Hs]=C.current,ud(l.nodeType===8?l.parentNode:l),pl(),C}for(;E=l.lastChild;)l.removeChild(E);if(typeof _=="function"){var G=_;_=function(){var Z=Zm(B);G.call(Z)}}var B=Dv(l,0,!1,null,null,!1,!1,"",T2);return l._reactRootContainer=B,l[Hs]=B.current,ud(l.nodeType===8?l.parentNode:l),pl(function(){Ym(c,B,f,_)}),B}function tp(l,c,f,_,E){var x=f._reactRootContainer;if(x){var C=x;if(typeof E=="function"){var G=E;E=function(){var B=Zm(C);G.call(B)}}Ym(c,C,l,E)}else C=UO(f,c,l,E,_);return Zm(C)}Xh=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var f=he(c.pendingLanes);f!==0&&(Hh(c,f|1),Ei(c,Ce()),(re&6)===0&&(lc=Ce()+500,zo()))}break;case 13:pl(function(){var _=Qs(l,1);if(_!==null){var E=ai();Or(_,l,1,E)}}),Nv(l,1)}},Lu=function(l){if(l.tag===13){var c=Qs(l,134217728);if(c!==null){var f=ai();Or(c,l,134217728,f)}Nv(l,134217728)}},Yh=function(l){if(l.tag===13){var c=Ho(l),f=Qs(l,c);if(f!==null){var _=ai();Or(f,l,c,_)}Nv(l,c)}},Zh=function(){return ee},Qh=function(l,c){var f=ee;try{return ee=l,c()}finally{ee=f}},ri=function(l,c,f){switch(c){case"input":if(mi(l,f),c=f.name,f.type==="radio"&&c!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<f.length;c++){var _=f[c];if(_!==l&&_.form===l.form){var E=_m(_);if(!E)throw Error(e(90));Fs(_),mi(_,E)}}}break;case"textarea":Co(l,f);break;case"select":c=f.value,c!=null&&yn(l,!!f.multiple,c,!1)}},ir=Pv,Pn=pl;var jO={usingClientEntryPoint:!1,Events:[dd,Xu,_m,Pr,Ye,Pv]},Ad={findFiberByHostInstance:ll,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zO={bundleType:Ad.bundleType,version:Ad.version,rendererPackageName:Ad.rendererPackageName,rendererConfig:Ad.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Jg(l),l===null?null:l.stateNode},findFiberByHostInstance:Ad.findFiberByHostInstance||GO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ep.isDisabled&&ep.supportsFiber)try{Ja=ep.inject(zO),Li=ep}catch{}}return wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jO,wi.createPortal=function(l,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vv(c))throw Error(e(200));return FO(l,c,null,f)},wi.createRoot=function(l,c){if(!Vv(l))throw Error(e(299));var f=!1,_="",E=x2;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(_=c.identifierPrefix),c.onRecoverableError!==void 0&&(E=c.onRecoverableError)),c=Dv(l,1,!1,null,null,f,!1,_,E),l[Hs]=c.current,ud(l.nodeType===8?l.parentNode:l),new Ov(c)},wi.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(e(188)):(l=Object.keys(l).join(","),Error(e(268,l)));return l=Jg(c),l=l===null?null:l.stateNode,l},wi.flushSync=function(l){return pl(l)},wi.hydrate=function(l,c,f){if(!Jm(c))throw Error(e(200));return tp(null,l,c,!0,f)},wi.hydrateRoot=function(l,c,f){if(!Vv(l))throw Error(e(405));var _=f!=null&&f.hydratedSources||null,E=!1,x="",C=x2;if(f!=null&&(f.unstable_strictMode===!0&&(E=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onRecoverableError!==void 0&&(C=f.onRecoverableError)),c=E2(c,null,l,1,f??null,E,!1,x,C),l[Hs]=c.current,ud(l),_)for(l=0;l<_.length;l++)f=_[l],E=f._getVersion,E=E(f._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[f,E]:c.mutableSourceEagerHydrationData.push(f,E);return new Qm(c)},wi.render=function(l,c,f){if(!Jm(c))throw Error(e(200));return tp(null,l,c,!1,f)},wi.unmountComponentAtNode=function(l){if(!Jm(l))throw Error(e(40));return l._reactRootContainer?(pl(function(){tp(null,null,l,!1,function(){l._reactRootContainer=null,l[Hs]=null})}),!0):!1},wi.unstable_batchedUpdates=Pv,wi.unstable_renderSubtreeIntoContainer=function(l,c,f,_){if(!Jm(f))throw Error(e(200));if(l==null||l._reactInternals===void 0)throw Error(e(38));return tp(l,c,f,!1,_)},wi.version="18.3.1-next-f1338f8080-20240426",wi}var b2;function YO(){if(b2)return Uv.exports;b2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Uv.exports=XO(),Uv.exports}var k2;function ZO(){if(k2)return np;k2=1;var n=YO();return np.createRoot=n.createRoot,np.hydrateRoot=n.hydrateRoot,np}var QO=ZO();const JO=kw(QO);var nt=dg();const t5=kw(nt),Ti={ADD:"add",REMOVE:"remove"},ih={PROPERTYCHANGE:"propertychange"},qt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class d_{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function e5(n,t,e){let i,r;e=e||co;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+e(n[i],t),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function co(n,t){return n>t?1:n<t?-1:0}function n5(n,t){return n<t?1:n>t?-1:0}function Lw(n,t,e){if(n[0]<=t)return 0;const i=n.length;if(t<=n[i-1])return i-1;if(typeof e=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===t)return r;if(s<t)return e(t,n[r-1],s)>0?r-1:r}return i-1}if(e>0){for(let r=1;r<i;++r)if(n[r]<t)return r-1;return i-1}if(e<0){for(let r=1;r<i;++r)if(n[r]<=t)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==t)return r;if(n[r]<t)return n[r-1]-t<t-n[r]?r-1:r}return i-1}function i5(n,t,e){for(;t<e;){const i=n[t];n[t]=n[e],n[e]=i,++t,--e}}function f_(n,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let r=0;r<i;r++)n[n.length]=e[r]}function $a(n,t){const e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function r5(n,t,e){const i=t||co;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Rf(){return!0}function g_(){return!1}function Pf(){}function GM(n){let t,e,i;return function(){const r=Array.prototype.slice.call(arguments);return(!e||this!==i||!$a(r,e))&&(i=this,e=r,t=n.apply(this,arguments)),t}}function UM(n){function t(){let e;try{e=n()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function fg(n){for(const t in n)delete n[t]}function rh(n){let t;for(t in n)return!1;return!t}class So{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class gg extends d_{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),r=i[t]||(i[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=e?new So(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let u;for(let h=0,d=r.length;h<d;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,Pf);delete o[i]}return u}disposeInternal(){this.listeners_&&fg(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const r=i.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[r]=Pf,++this.pendingRemovals_[t]):(i.splice(r,1),i.length===0&&delete this.listeners_[t]))}}function ae(n,t,e,i,r){if(r){const o=e;e=function(a){return n.removeEventListener(t,e),o.call(i??this,a)}}else i&&i!==n&&(e=e.bind(i));const s={target:n,type:t,listener:e};return n.addEventListener(t,e),s}function r0(n,t,e,i){return ae(n,t,e,i,!0)}function Fe(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),fg(n))}class mg extends gg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(qt.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ae(this,t[s],e);return r}return ae(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const r=t.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=r0(this,t[s],e)}else i=r0(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)s5(i);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}mg.prototype.on;mg.prototype.once;mg.prototype.un;function s5(n){if(Array.isArray(n))for(let t=0,e=n.length;t<e;++t)Fe(n[t]);else Fe(n)}function oe(){throw new Error("Unimplemented abstract method.")}let o5=0;function le(n){return n.ol_uid||(n.ol_uid=String(++o5))}class L2 extends So{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}class Ns extends mg{constructor(t){super(),this.on,this.once,this.un,le(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new L2(i,t,e)),i=ih.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new L2(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const r=this.values_||(this.values_={});if(i)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],rh(this.values_)&&(this.values_=null),e||this.notify(t,i)}}}const D2={LENGTH:"length"};class ip extends So{constructor(t,e,i){super(t),this.element=e,this.index=i}}class yr extends Ns{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(D2.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new ip(Ti.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new ip(Ti.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new ip(Ti.REMOVE,r,t)),this.dispatchEvent(new ip(Ti.ADD,e,t))}updateLength_(){this.set(D2.LENGTH,this.array_.length)}assertUnique_(t,e){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===t&&r!==e)throw new Error("Duplicate item added to a unique collection")}}function pe(n,t){if(!n)throw new Error(t)}let s0=class jM extends Ns{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new jM(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Fe(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=ae(t,qt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?a5(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function a5(n){if(typeof n=="function")return n;let t;return Array.isArray(n)?t=n:(pe(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[n]),function(){return t}}const Tn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function N2(n){const t=Hi();for(let e=0,i=n.length;e<i;++e)of(t,n[e]);return t}function Cf(n,t,e){return e?(e[0]=n[0]-t,e[1]=n[1]-t,e[2]=n[2]+t,e[3]=n[3]+t,e):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function zM(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function Dw(n,t,e){let i,r;return t<n[0]?i=n[0]-t:n[2]<t?i=t-n[2]:i=0,e<n[1]?r=n[1]-e:n[3]<e?r=e-n[3]:r=0,i*i+r*r}function sh(n,t){return BM(n,t[0],t[1])}function Ud(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function BM(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Z1(n,t){const e=n[0],i=n[1],r=n[2],s=n[3],o=t[0],a=t[1];let u=Tn.UNKNOWN;return o<e?u=u|Tn.LEFT:o>r&&(u=u|Tn.RIGHT),a<i?u=u|Tn.BELOW:a>s&&(u=u|Tn.ABOVE),u===Tn.UNKNOWN&&(u=Tn.INTERSECTING),u}function Hi(){return[1/0,1/0,-1/0,-1/0]}function ka(n,t,e,i,r){return r?(r[0]=n,r[1]=t,r[2]=e,r[3]=i,r):[n,t,e,i]}function m_(n){return ka(1/0,1/0,-1/0,-1/0,n)}function $M(n,t){const e=n[0],i=n[1];return ka(e,i,e,i,t)}function Nw(n,t,e,i,r){const s=m_(r);return WM(s,n,t,e,i)}function Mf(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function l5(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function of(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function WM(n,t,e,i,r){for(;e<i;e+=r)u5(n,t[e],t[e+1]);return n}function u5(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function KM(n,t){let e;return e=t(p_(n)),e||(e=t(__(n)),e)||(e=t(y_(n)),e)||(e=t(yu(n)),e)?e:!1}function Q1(n){let t=0;return v_(n)||(t=ue(n)*Jn(n)),t}function p_(n){return[n[0],n[1]]}function __(n){return[n[2],n[1]]}function Ql(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function c5(n,t){let e;if(t==="bottom-left")e=p_(n);else if(t==="bottom-right")e=__(n);else if(t==="top-left")e=yu(n);else if(t==="top-right")e=y_(n);else throw new Error("Invalid corner");return e}function J1(n,t,e,i,r){const[s,o,a,u,h,d,g,m]=qM(n,t,e,i);return ka(Math.min(s,a,h,g),Math.min(o,u,d,m),Math.max(s,a,h,g),Math.max(o,u,d,m),r)}function qM(n,t,e,i){const r=t*i[0]/2,s=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),u=r*o,h=r*a,d=s*o,g=s*a,m=n[0],v=n[1];return[m-u+g,v-h-d,m-u-g,v-h+d,m+u-g,v+h+d,m+u+g,v+h-d,m-u+g,v-h-d]}function Jn(n){return n[3]-n[1]}function Kl(n,t,e){const i=e||Hi();return Ai(n,t)?(n[0]>t[0]?i[0]=n[0]:i[0]=t[0],n[1]>t[1]?i[1]=n[1]:i[1]=t[1],n[2]<t[2]?i[2]=n[2]:i[2]=t[2],n[3]<t[3]?i[3]=n[3]:i[3]=t[3]):m_(i),i}function yu(n){return[n[0],n[3]]}function y_(n){return[n[2],n[3]]}function ue(n){return n[2]-n[0]}function Ai(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function v_(n){return n[2]<n[0]||n[3]<n[1]}function h5(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}function d5(n,t,e){let i=!1;const r=Z1(n,t),s=Z1(n,e);if(r===Tn.INTERSECTING||s===Tn.INTERSECTING)i=!0;else{const o=n[0],a=n[1],u=n[2],h=n[3],d=t[0],g=t[1],m=e[0],v=e[1],y=(v-g)/(m-d);let S,w;s&Tn.ABOVE&&!(r&Tn.ABOVE)&&(S=m-(v-h)/y,i=S>=o&&S<=u),!i&&s&Tn.RIGHT&&!(r&Tn.RIGHT)&&(w=v-(m-u)*y,i=w>=a&&w<=h),!i&&s&Tn.BELOW&&!(r&Tn.BELOW)&&(S=m-(v-a)/y,i=S>=o&&S<=u),!i&&s&Tn.LEFT&&!(r&Tn.LEFT)&&(w=v-(m-o)*y,i=w>=a&&w<=h)}return i}function HM(n,t){const e=t.getExtent(),i=Ql(n);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const r=ue(e),o=Math.floor((i[0]-e[0])/r)*r;n[0]-=o,n[2]-=o}return n}function XM(n,t,e){if(t.canWrapX()){const i=t.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];HM(n,t);const r=ue(i);if(ue(n)>r&&!e)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function ke(n,t,e){return Math.min(Math.max(n,t),e)}function f5(n,t,e,i,r,s){const o=r-e,a=s-i;if(o!==0||a!==0){const u=((n-e)*o+(t-i)*a)/(o*o+a*a);u>1?(e=r,i=s):u>0&&(e+=o*u,i+=a*u)}return Wc(n,t,e,i)}function Wc(n,t,e,i){const r=e-n,s=i-t;return r*r+s*s}function g5(n){const t=n.length;for(let i=0;i<t;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<t;a++){const u=Math.abs(n[a][i]);u>s&&(s=u,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<t;a++){const u=-n[a][i]/n[i][i];for(let h=i;h<t+1;h++)i==h?n[a][h]=0:n[a][h]+=u*n[i][h]}}const e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=n[i][t]/n[i][i];for(let r=i-1;r>=0;r--)n[r][t]-=n[r][i]*e[i]}return e}function O2(n){return n*180/Math.PI}function xa(n){return n*Math.PI/180}function Ta(n,t){const e=n%t;return e*t<0?e+t:e}function Bi(n,t,e){return n+e*(t-n)}function pg(n,t){const e=Math.pow(10,t);return Math.round(n*e)/e}function V2(n,t){return Math.round(pg(n,t))}function rp(n,t){return Math.floor(pg(n,t))}function sp(n,t){return Math.ceil(pg(n,t))}function tE(n,t,e){if(n>=t&&n<e)return n;const i=e-t;return((n-t)%i+i)%i+t}function YM(n,t){const e=(""+n).split("."),i=(""+t).split(".");for(let r=0;r<Math.max(e.length,i.length);r++){const s=parseInt(e[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function m5(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function o0(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function Ow(n,t){const e=Math.cos(t),i=Math.sin(t),r=n[0]*e-n[1]*i,s=n[1]*e+n[0]*i;return n[0]=r,n[1]=s,n}function p5(n,t){return n[0]*=t,n[1]*=t,n}function ZM(n,t){if(t.canWrapX()){const e=ue(t.getExtent()),i=QM(n,t,e);i&&(n[0]-=i*e)}return n}function QM(n,t,e){const i=t.getExtent();let r=0;return t.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(e=e||ue(i),r=Math.floor((n[0]-i[0])/e)),r}function JM(...n){console.warn(...n)}const Vw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Fw=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Vw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const _g=6378137,Dc=Math.PI*_g,_5=[-Dc,-Dc,Dc,Dc],y5=[-180,-85,180,85],op=_g*Math.log(Math.tan(Math.PI/2));class cc extends Fw{constructor(t){super({code:t,units:"m",extent:_5,global:!0,worldExtent:y5,getPointResolution:function(e,i){return e/Math.cosh(i[1]/_g)}})}}const F2=[new cc("EPSG:3857"),new cc("EPSG:102100"),new cc("EPSG:102113"),new cc("EPSG:900913"),new cc("http://www.opengis.net/def/crs/EPSG/0/3857"),new cc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function v5(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i){t[s]=Dc*n[s]/180;let o=_g*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>op?o=op:o<-op&&(o=-op),t[s+1]=o}return t}function E5(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i)t[s]=180*n[s]/Dc,t[s+1]=360*Math.atan(Math.exp(n[s+1]/_g))/Math.PI-90;return t}const w5=6378137,G2=[-180,-90,180,90],x5=Math.PI*w5/180;class El extends Fw{constructor(t,e){super({code:t,units:"degrees",extent:G2,axisOrientation:e,global:!0,metersPerUnit:x5,worldExtent:G2})}}const U2=[new El("CRS:84"),new El("EPSG:4326","neu"),new El("urn:ogc:def:crs:OGC:1.3:CRS84"),new El("urn:ogc:def:crs:OGC:2:84"),new El("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new El("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new El("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let eE={};function T5(n){return eE[n]||eE[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function S5(n,t){eE[n]=t}let Kc={};function Jl(n,t,e){const i=n.getCode(),r=t.getCode();i in Kc||(Kc[i]={}),Kc[i][r]=e}function Bv(n,t){return n in Kc&&t in Kc[n]?Kc[n][t]:null}const a0=.9996,xr=.00669438,E_=xr*xr,w_=E_*xr,Gl=xr/(1-xr),j2=Math.sqrt(1-xr),oh=(1-j2)/(1+j2),tb=oh*oh,Gw=tb*oh,Uw=Gw*oh,eb=Uw*oh,nb=1-xr/4-3*E_/64-5*w_/256,I5=3*xr/8+3*E_/32+45*w_/1024,A5=15*E_/256+45*w_/1024,R5=35*w_/3072,P5=3/2*oh-27/32*Gw+269/512*eb,C5=21/16*tb-55/32*Uw,M5=151/96*Gw-417/128*eb,b5=1097/512*Uw,l0=6378137;function k5(n,t,e){const i=n-5e5,o=(e.north?t:t-1e7)/a0/(l0*nb),a=o+P5*Math.sin(2*o)+C5*Math.sin(4*o)+M5*Math.sin(6*o)+b5*Math.sin(8*o),u=Math.sin(a),h=u*u,d=Math.cos(a),g=u/d,m=g*g,v=m*m,y=1-xr*h,S=Math.sqrt(1-xr*h),w=l0/S,R=(1-xr)/y,P=Gl*d**2,M=P*P,L=i/(w*a0),D=L*L,j=D*L,b=j*L,A=b*L,k=A*L,V=a-g/R*(D/2-b/24*(5+3*m+10*P-4*M-9*Gl))+k/720*(61+90*m+298*P+45*v-252*Gl-3*M);let F=(L-j/6*(1+2*m+P)+A/120*(5-2*P+28*m-3*M+8*Gl+24*v))/d;return F=tE(F+xa(ib(e.number)),-Math.PI,Math.PI),[O2(F),O2(V)]}const z2=-80,B2=84,L5=-180,D5=180;function N5(n,t,e){n=tE(n,L5,D5),t<z2?t=z2:t>B2&&(t=B2);const i=xa(t),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,u=a*a,h=xa(n),d=ib(e.number),g=xa(d),m=l0/Math.sqrt(1-xr*r**2),v=Gl*s**2,y=s*tE(h-g,-Math.PI,Math.PI),S=y*y,w=S*y,R=w*y,P=R*y,M=P*y,L=l0*(nb*i-I5*Math.sin(2*i)+A5*Math.sin(4*i)-R5*Math.sin(6*i)),D=a0*m*(y+w/6*(1-a+v)+P/120*(5-18*a+u+72*v-58*Gl))+5e5;let j=a0*(L+m*o*(S/2+R/24*(5-a+9*v+4*v**2)+M/720*(61-58*a+u+600*v-330*Gl)));return e.north||(j+=1e7),[D,j]}function ib(n){return(n-1)*6-180+3}const O5=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function rb(n){let t=0;for(const r of O5){const s=n.match(r);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function $2(n,t){return function(e,i,r,s){const o=e.length;r=r>1?r:2,s=s??r,i||(r>2?i=e.slice():i=new Array(o));for(let a=0;a<o;a+=s){const u=e[a],h=e[a+1],d=n(u,h,t);i[a]=d[0],i[a+1]=d[1]}return i}}function V5(n){return rb(n)?new Fw({code:n,units:"m"}):null}function F5(n){const t=rb(n.getCode());return t?{forward:$2(N5,t),inverse:$2(k5,t)}:null}const G5=63710088e-1;function W2(n,t,e){e=e||G5;const i=xa(n[1]),r=xa(t[1]),s=(r-i)/2,o=xa(t[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const U5=[F5],j5=[V5];let nE=!0;function sb(n){nE=!1}function jw(n,t){if(t!==void 0){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];t=t}else t=n.slice();return t}function iE(n){S5(n.getCode(),n),Jl(n,n,jw)}function z5(n){n.forEach(iE)}function Un(n){if(typeof n!="string")return n;const t=T5(n);if(t)return t;for(const e of j5){const i=e(n);if(i)return i}return null}function K2(n,t,e,i){n=Un(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(t,e);else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=t;else{const a=Bw(n,Un("EPSG:4326"));if(!a&&o!=="degrees")r=t*n.getMetersPerUnit();else{let h=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];h=a(h,h,2);const d=W2(h.slice(0,2),h.slice(2,4)),g=W2(h.slice(4,6),h.slice(6,8));r=(d+g)/2}const u=n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function q2(n){z5(n),n.forEach(function(t){n.forEach(function(e){t!==e&&Jl(t,e,jw)})})}function B5(n,t,e,i){n.forEach(function(r){t.forEach(function(s){Jl(r,s,e),Jl(s,r,i)})})}function zw(n,t){return n?typeof n=="string"?Un(n):n:Un(t)}function rE(n){return(function(t,e,i,r){const s=t.length;i=i!==void 0?i:2,r=r??i,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=r){const a=n(t.slice(o,o+i)),u=a.length;for(let h=0,d=r;h<d;++h)e[o+h]=h>=u?t[o+h]:a[h]}return e})}function Mnt(n,t,e,i){const r=Un(n),s=Un(t);Jl(r,s,rE(e)),Jl(s,r,rE(i))}function tu(n,t){return sb(),yg(n,"EPSG:4326","EPSG:3857")}function kl(n,t){const e=yg(n,"EPSG:3857","EPSG:4326"),i=e[0];return(i<-180||i>180)&&(e[0]=Ta(i+180,360)-180),e}function Lp(n,t){if(n===t)return!0;const e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||Bw(n,t)===jw)&&e}function Bw(n,t){const e=n.getCode(),i=t.getCode();let r=Bv(e,i);if(r)return r;let s=null,o=null;for(const u of U5)s||(s=u(n)),o||(o=u(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=$v(s.inverse,o.forward);else{const u=Bv(e,a);u&&(r=$v(u,o.forward))}else{const u=Bv(a,i);u&&(r=$v(s.inverse,u))}return r&&(iE(n),iE(t),Jl(n,t,r)),r}function $v(n,t){return function(e,i,r,s){return i=n(e,i,r,s),t(i,i,r,s)}}function u0(n,t){const e=Un(n),i=Un(t);return Bw(e,i)}function yg(n,t,e){const i=u0(t,e);if(!i){const r=Un(t).getCode(),s=Un(e).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function sE(n,t){return n}function ro(n,t){return nE&&!o0(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(nE=!1,JM("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function ob(n,t){return n}function _a(n,t){return n}function bnt(n,t,e){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),a=ue(o);i=i.slice(0),s=QM(i,n,a),s&&(i[0]=i[0]-s*a),i[0]=ke(i[0],o[0],o[2]),i[1]=ke(i[1],o[1],o[3]),r=e(i)}else r=e(i);return s&&t.canWrapX()&&(r[0]+=s*ue(t.getExtent())),r}}function $5(){q2(F2),q2(U2),B5(U2,F2,v5,E5)}$5();new Array(6);function qr(){return[1,0,0,1,0,0]}function W5(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function In(n,t){const e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function _o(n,t,e,i,r,s,o,a){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-a*i*u+t,n[5]=o*r*u+a*r*h+e,n}function ab(n,t){const e=K5(t);pe(e!==0,"Transformation matrix cannot be inverted");const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5];return n[0]=o/e,n[1]=-r/e,n[2]=-s/e,n[3]=i/e,n[4]=(s*u-o*a)/e,n[5]=-(i*u-r*a)/e,n}function K5(n){return n[0]*n[3]-n[1]*n[2]}const q5=[1e5,1e5,1e5,1e5,2,2];function H5(n){return"matrix("+n.join(", ")+")"}function oE(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function X5(n,t){const e=oE(n),i=oE(t);for(let r=0;r<6;++r)if(Math.round((e[r]-i[r])*q5[r])!==0)return!1;return!0}function Sa(n,t,e,i,r,s,o){s=s||[],o=o||2;let a=0;for(let u=t;u<e;u+=i){const h=n[u],d=n[u+1];s[a++]=r[0]*h+r[2]*d+r[4],s[a++]=r[1]*h+r[3]*d+r[5];for(let g=2;g<o;g++)s[a++]=n[u+g]}return s&&s.length!=a&&(s.length=a),s}function lb(n,t,e,i,r,s,o){o=o||[];const a=Math.cos(r),u=Math.sin(r),h=s[0],d=s[1];let g=0;for(let m=t;m<e;m+=i){const v=n[m]-h,y=n[m+1]-d;o[g++]=h+v*a-y*u,o[g++]=d+v*u+y*a;for(let S=m+2;S<m+i;++S)o[g++]=n[S]}return o&&o.length!=g&&(o.length=g),o}function Y5(n,t,e,i,r,s,o,a){a=a||[];const u=o[0],h=o[1];let d=0;for(let g=t;g<e;g+=i){const m=n[g]-u,v=n[g+1]-h;a[d++]=u+r*m,a[d++]=h+s*v;for(let y=g+2;y<g+i;++y)a[d++]=n[y]}return a&&a.length!=d&&(a.length=d),a}function Z5(n,t,e,i,r,s,o){o=o||[];let a=0;for(let u=t;u<e;u+=i){o[a++]=n[u]+r,o[a++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[a++]=n[h]}return o&&o.length!=a&&(o.length=a),o}const H2=qr(),Q5=[NaN,NaN];class J5 extends Ns{constructor(){super(),this.extent_=Hi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=GM((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return oe()}closestPointXY(t,e,i,r){return oe()}containsXY(t,e){return this.closestPointXY(t,e,Q5,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return oe()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&m_(e),this.extentRevision_=this.getRevision()}return h5(this.extent_,t)}rotate(t,e){oe()}scale(t,e,i){oe()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return oe()}getType(){return oe()}applyTransform(t){oe()}intersectsExtent(t){return oe()}translate(t,e){oe()}transform(t,e){const i=Un(t),r=i.getUnits()=="tile-pixels"?function(s,o,a){const u=i.getExtent(),h=i.getWorldExtent(),d=Jn(h)/Jn(u);_o(H2,h[0],h[3],d,-d,0,0,0);const g=Sa(s,0,s.length,a,H2,o),m=u0(i,e);return m?m(g,g,a):g}:u0(i,e);return this.applyTransform(r),this}}class x_ extends J5{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Nw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return oe()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=X2(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){oe()}setLayout(t,e,i){let r;if(t)r=X2(t);else{for(let s=0;s<i;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=t6(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();lb(i,0,i.length,r,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=Ql(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Y5(r,0,r.length,s,t,e,i,r),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Z5(i,0,i.length,r,t,e,i),this.changed()}}}function t6(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function X2(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}function e6(n,t,e){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Sa(i,0,i.length,r,t,e)}function Y2(n,t,e,i,r,s,o){const a=n[t],u=n[t+1],h=n[e]-a,d=n[e+1]-u;let g;if(h===0&&d===0)g=t;else{const m=((r-a)*h+(s-u)*d)/(h*h+d*d);if(m>1)g=e;else if(m>0){for(let v=0;v<i;++v)o[v]=Bi(n[t+v],n[e+v],m);o.length=i;return}else g=t}for(let m=0;m<i;++m)o[m]=n[g+m];o.length=i}function $w(n,t,e,i,r){let s=n[t],o=n[t+1];for(t+=i;t<e;t+=i){const a=n[t],u=n[t+1],h=Wc(s,o,a,u);h>r&&(r=h),s=a,o=u}return r}function ub(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=$w(n,t,a,i,r),t=a}return r}function knt(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=ub(n,t,a,i,r),t=a[a.length-1]}return r}function Ww(n,t,e,i,r,s,o,a,u,h,d){if(t==e)return h;let g,m;if(r===0){if(m=Wc(o,a,n[t],n[t+1]),m<h){for(g=0;g<i;++g)u[g]=n[t+g];return u.length=i,m}return h}d=d||[NaN,NaN];let v=t+i;for(;v<e;)if(Y2(n,v-i,v,i,o,a,d),m=Wc(o,a,d[0],d[1]),m<h){for(h=m,g=0;g<i;++g)u[g]=d[g];u.length=i,v+=i}else v+=i*Math.max((Math.sqrt(m)-Math.sqrt(h))/r|0,1);if(s&&(Y2(n,e-i,t,i,o,a,d),m=Wc(o,a,d[0],d[1]),m<h)){for(h=m,g=0;g<i;++g)u[g]=d[g];u.length=i}return h}function cb(n,t,e,i,r,s,o,a,u,h,d){d=d||[NaN,NaN];for(let g=0,m=e.length;g<m;++g){const v=e[g];h=Ww(n,t,v,i,r,s,o,a,u,h,d),t=v}return h}function Lnt(n,t,e,i,r,s,o,a,u,h,d){d=d||[NaN,NaN];for(let g=0,m=e.length;g<m;++g){const v=e[g];h=cb(n,t,v,i,r,s,o,a,u,h,d),t=v[v.length-1]}return h}function n6(n,t,e,i){for(let r=0,s=e.length;r<s;++r)n[t++]=e[r];return t}function Kw(n,t,e,i){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<i;++a)n[t++]=o[a]}return t}function hb(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const u=Kw(n,t,e[o],i);r[s++]=u,t=u}return r.length=s,r}function Dnt(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const u=hb(n,t,e[o],i,r[s]);u.length===0&&(u[0]=t),r[s++]=u,t=u[u.length-1]}return r.length=s,r}function Ul(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=t;o<e;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function c0(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const u=e[o];r[s++]=Ul(n,t,u,i,r[s]),t=u}return r.length=s,r}function Z2(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const u=e[o];r[s++]=u.length===1&&u[0]===t?[]:c0(n,t,u,i,r[s]),t=u[u.length-1]}return r.length=s,r}function aE(n,t,e,i,r,s,o){let a,u;const h=(e-t)/i;if(h===1)a=t;else if(h===2)a=t,u=r;else if(h!==0){let d=n[t],g=n[t+1],m=0;const v=[0];for(let w=t+i;w<e;w+=i){const R=n[w],P=n[w+1];m+=Math.sqrt((R-d)*(R-d)+(P-g)*(P-g)),v.push(m),d=R,g=P}const y=r*m,S=e5(v,y);S<0?(u=(y-v[-S-2])/(v[-S-1]-v[-S-2]),a=t+(-S-2)*i):a=t+S*i}o=o>1?o:2,s=s||new Array(o);for(let d=0;d<o;++d)s[d]=a===void 0?NaN:u===void 0?n[a+d]:Bi(n[a+d],n[a+i+d],u);return s}function lE(n,t,e,i,r,s){if(e==t)return null;let o;if(r<n[t+i-1])return s?(o=n.slice(t,t+i),o[i-1]=r,o):null;if(n[e-1]<r)return s?(o=n.slice(e-i,e),o[i-1]=r,o):null;if(r==n[t+i-1])return n.slice(t,t+i);let a=t/i,u=e/i;for(;a<u;){const m=a+u>>1;r<n[(m+1)*i-1]?u=m:a=m+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const d=n[(a+1)*i-1],g=(r-h)/(d-h);o=[];for(let m=0;m<i-1;++m)o.push(Bi(n[(a-1)*i+m],n[a*i+m],g));return o.push(r),o}function Nnt(n,t,e,i,r,s,o){if(o)return lE(n,t,e[e.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let u=0,h=e.length;u<h;++u){const d=e[u];if(t!=d){if(r<n[t+i-1])return null;if(r<=n[d-1])return lE(n,t,d,i,r,!1);t=d}}return null}function i6(n,t,e,i,r){return!KM(r,function(o){return!jl(n,t,e,i,o[0],o[1])})}function jl(n,t,e,i,r,s){let o=0,a=n[e-i],u=n[e-i+1];for(;t<e;t+=i){const h=n[t],d=n[t+1];u<=s?d>s&&(h-a)*(s-u)-(r-a)*(d-u)>0&&o++:d<=s&&(h-a)*(s-u)-(r-a)*(d-u)<0&&o--,a=h,u=d}return o!==0}function qw(n,t,e,i,r,s){if(e.length===0||!jl(n,t,e[0],i,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(jl(n,e[o-1],e[o],i,r,s))return!1;return!0}function Ont(n,t,e,i,r,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const u=e[o];if(qw(n,t,u,i,r,s))return!0;t=u[u.length-1]}return!1}function db(n,t,e,i,r){let s;for(t+=i;t<e;t+=i)if(s=r(n.slice(t-i,t),n.slice(t,t+i)),s)return s;return!1}function T_(n,t,e,i,r,s){return s=s??WM(Hi(),n,t,e,i),Ai(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:db(n,t,e,i,function(o,a){return d5(r,o,a)}):!1}function Vnt(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){if(T_(n,t,e[s],i,r))return!0;t=e[s]}return!1}function fb(n,t,e,i,r){return!!(T_(n,t,e,i,r)||jl(n,t,e,i,r[0],r[1])||jl(n,t,e,i,r[0],r[3])||jl(n,t,e,i,r[2],r[1])||jl(n,t,e,i,r[2],r[3]))}function gb(n,t,e,i,r){if(!fb(n,t,e[0],i,r))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(i6(n,e[s-1],e[s],i,r)&&!T_(n,e[s-1],e[s],i,r))return!1;return!0}function Fnt(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(gb(n,t,a,i,r))return!0;t=a[a.length-1]}return!1}function mb(n,t,e,i){let r=n[t],s=n[t+1],o=0;for(let a=t+i;a<e;a+=i){const u=n[a],h=n[a+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function S_(n,t,e,i,r,s,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)s[o++]=n[t],s[o++]=n[t+1];return o}const u=new Array(a);u[0]=1,u[a-1]=1;const h=[t,e-i];let d=0;for(;h.length>0;){const g=h.pop(),m=h.pop();let v=0;const y=n[m],S=n[m+1],w=n[g],R=n[g+1];for(let P=m+i;P<g;P+=i){const M=n[P],L=n[P+1],D=f5(M,L,y,S,w,R);D>v&&(d=P,v=D)}v>r&&(u[(d-t)/i]=1,m+i<d&&h.push(m,d),d+i<g&&h.push(d,g))}for(let g=0;g<a;++g)u[g]&&(s[o++]=n[t+g*i],s[o++]=n[t+g*i+1]);return o}function r6(n,t,e,i,r,s,o,a){for(let u=0,h=e.length;u<h;++u){const d=e[u];o=S_(n,t,d,i,r,s,o),a.push(o),t=d}return o}function Sl(n,t){return t*Math.round(n/t)}function s6(n,t,e,i,r,s,o){if(t==e)return o;let a=Sl(n[t],r),u=Sl(n[t+1],r);t+=i,s[o++]=a,s[o++]=u;let h,d;do if(h=Sl(n[t],r),d=Sl(n[t+1],r),t+=i,t==e)return s[o++]=h,s[o++]=d,o;while(h==a&&d==u);for(;t<e;){const g=Sl(n[t],r),m=Sl(n[t+1],r);if(t+=i,g==h&&m==d)continue;const v=h-a,y=d-u,S=g-a,w=m-u;if(v*w==y*S&&(v<0&&S<v||v==S||v>0&&S>v)&&(y<0&&w<y||y==w||y>0&&w>y)){h=g,d=m;continue}s[o++]=h,s[o++]=d,a=h,u=d,h=g,d=m}return s[o++]=h,s[o++]=d,o}function Hw(n,t,e,i,r,s,o,a){for(let u=0,h=e.length;u<h;++u){const d=e[u];o=s6(n,t,d,i,r,s,o),a.push(o),t=d}return o}function Gnt(n,t,e,i,r,s,o,a){for(let u=0,h=e.length;u<h;++u){const d=e[u],g=[];o=Hw(n,t,d,i,r,s,o,g),a.push(g),t=d[d.length-1]}return o}class h0 extends x_{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){f_(this.flatCoordinates,t),this.changed()}clone(){const t=new h0(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Dw(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($w(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))}forEachSegment(t){return db(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,lE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Ul(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return aE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return mb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=S_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new h0(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return T_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Kw(this.flatCoordinates,0,t,this.stride),this.changed()}}let d0=class pb extends x_{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new pb(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const s=this.flatCoordinates,o=Wc(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let u=0;u<a;++u)i[u]=s[u];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return $M(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return BM(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=n6(this.flatCoordinates,0,t,this.stride),this.changed()}};const vr={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},eu=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",o6=eu.includes("safari")&&!eu.includes("chrom");o6&&(eu.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(eu));const a6=eu.includes("webkit")&&!eu.includes("edge"),_b=eu.includes("macintosh"),l6=typeof devicePixelRatio<"u"?devicePixelRatio:1,$i=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Xw=typeof Image<"u"&&Image.prototype.decode,yb=typeof createImageBitmap=="function",vb=(function(){let n=!1;try{const t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n})(),jt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function mn(n,t,e,i){let r;return e&&e.length?r=e.shift():$i?r=new class extends OffscreenCanvas{style={}}(n??300,t??150):r=document.createElement("canvas"),n&&(r.width=n),t&&(r.height=t),r.getContext("2d",i)}let Wv;function f0(){return Wv||(Wv=mn(1,1)),Wv}function I_(n){const t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function Q2(n,t){const e=t.parentNode;e&&e.replaceChild(n,t)}function u6(n){for(;n.lastChild;)n.lastChild.remove()}function c6(n,t){const e=n.childNodes;for(let i=0;;++i){const r=e[i],s=t[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Eb(){return new Proxy({childNodes:[],appendChild:function(t){return this.childNodes.push(t),t},remove:function(){},removeChild:function(t){const e=this.childNodes.indexOf(t);if(e===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(e,1),t},insertBefore:function(t,e){const i=this.childNodes.indexOf(e);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,t),t},style:{}},{get(t,e,i){return e==="firstElementChild"?t.childNodes.length>0?t.childNodes[0]:null:Reflect.get(t,e,i)}})}function ya(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const Yw=[NaN,NaN,NaN,0];let Kv;function h6(){return Kv||(Kv=mn(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Kv}const d6=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,f6=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,g6=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,m6=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ap(n,t){return n.endsWith("%")?Number(n.substring(0,n.length-1))/t:Number(n)}function af(n){throw new Error('failed to parse "'+n+'" as color')}function wb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(f6)||n.match(d6)||n.match(g6);if(s){const o=s[4],a=100/255;return[ke(ap(s[1],a)+.5|0,0,255),ke(ap(s[2],a)+.5|0,0,255),ke(ap(s[3],a)+.5|0,0,255),o!==void 0?ke(ap(o,100),0,1):1]}af(n)}if(n.startsWith("#")){if(m6.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let d=parseInt(s.substring(u,u+o),16);o===1&&(d+=d<<4),a[u/o]=d}return a[3]=a[3]/255,a}af(n)}const t=h6();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=n,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=n,t.fillStyle===e&&af(n));const i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return wb(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const r=Array.from(t.getImageData(0,0,1,1).data);return r[3]=pg(r[3]/255,3),r}function p6(n){return typeof n=="string"?n:Qw(n)}const _6=1024,Pd={};let qv=0;function y6(n){if(n.length===4)return n;const t=n.slice();return t[3]=1,t}function Hv(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function Xv(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function Yv(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function Zv(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function J2(n){const t=Yv(n[0]),e=Yv(n[1]),i=Yv(n[2]),r=Zv(t*.222488403+e*.716873169+i*.06060791),s=500*(Zv(t*.452247074+e*.399439023+i*.148375274)-r),o=200*(r-Zv(t*.016863605+e*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function v6(n){const t=(n[0]+16)/116,e=n[1],i=n[2]*Math.PI/180,r=Xv(t),s=Xv(t+e/500*Math.cos(i)),o=Xv(t-e/200*Math.sin(i)),a=Hv(s*3.021973625-r*1.617392459-o*.404875592),u=Hv(s*-.943766287+r*1.916279586+o*.027607165),h=Hv(s*.069407491-r*.22898585+o*1.159737864);return[ke(a+.5|0,0,255),ke(u+.5|0,0,255),ke(h+.5|0,0,255),n[3]]}function Zw(n){if(n==="none")return Yw;if(Pd.hasOwnProperty(n))return Pd[n];if(qv>=_6){let e=0;for(const i in Pd)(e++&3)===0&&(delete Pd[i],--qv)}const t=wb(n);t.length!==4&&af(n);for(const e of t)isNaN(e)&&af(n);return Pd[n]=t,++qv,t}function ah(n){return Array.isArray(n)?n:Zw(n)}function Qw(n){let t=n[0];t!=(t|0)&&(t=t+.5|0);let e=n[1];e!=(e|0)&&(e=e+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+r+")"}class Unt extends gg{constructor(t,e,i,r){super(),this.extent=t,this.pixelRatio_=i,this.resolution=e,this.state=typeof r=="function"?jt.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(qt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==jt.IDLE&&this.loader){this.state=jt.LOADING,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;UM(()=>this.loader(this.getExtent(),e,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||yb&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=jt.LOADED}).catch(i=>{this.state=jt.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}}function E6(n,t,e){const i=n;let r=!0,s=!1,o=!1;const a=[r0(i,qt.LOAD,function(){o=!0,s||t()})];return i.src&&Xw?(s=!0,i.decode().then(function(){r&&t()}).catch(function(u){r&&(o?t():e())})):a.push(r0(i,qt.ERROR,e)),function(){r=!1,a.forEach(Fe)}}function w6(n,t){return new Promise((e,i)=>{function r(){o(),e(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function xb(n,t){return t&&(n.src=t),n.src&&Xw?new Promise((e,i)=>n.decode().then(()=>e(n)).catch(r=>n.complete&&n.width?e(n):i(r))):w6(n)}function jnt(n,t){return t&&(n.src=t),n.src&&Xw&&yb?n.decode().then(()=>createImageBitmap(n)).catch(e=>{if(n.complete&&n.width)return n;throw e}):xb(n)}class x6{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const r=Qv(t,e,i);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,i){const r=Qv(t,e,i);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,i,r,s){const o=Qv(t,e,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===jt.IDLE&&r.load(),r.getImageState()===jt.LOADING?r.ready().then(()=>{this.patternCache_[o]=f0().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=f0().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Qv(n,t,e){const i=e?ah(e):"null";return t+":"+n+":"+i}const Er=new x6;let Cd=null;class Tb extends gg{constructor(t,e,i,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?jt.IDLE:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===jt.LOADED){Cd||(Cd=mn(1,1,void 0,{willReadFrequently:!0})),Cd.drawImage(this.image_,0,0);try{Cd.getImageData(0,0,1,1),this.tainted_=!1}catch{Cd=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(qt.CHANGE)}handleImageError_(){this.imageState_=jt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=jt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=mn(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===jt.IDLE){this.image_||this.initializeImage_(),this.imageState_=jt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&xb(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==jt.LOADED)return;const e=this.image_,i=mn(Math.ceil(e.width*t),Math.ceil(e.height*t)),r=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=p6(this.color_),i.fillRect(0,0,r.width/t,r.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=r}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===jt.LOADED||this.imageState_===jt.ERROR)t();else{const e=()=>{(this.imageState_===jt.LOADED||this.imageState_===jt.ERROR)&&(this.removeEventListener(qt.CHANGE,e),t())};this.addEventListener(qt.CHANGE,e)}})),this.ready_}}function g0(n,t,e,i,r,s){let o=t===void 0?void 0:Er.get(t,e,r);return o||(o=new Tb(n,n&&"src"in n?n.src||void 0:t,e,i,r),Er.set(t,e,r,o,s)),s&&o&&!Er.getPattern(t,e,r)&&Er.set(t,e,r,o,s),o}function xs(n){return n?Array.isArray(n)?Qw(n):typeof n=="object"&&"src"in n?T6(n):n:null}function T6(n){if(!n.offset||!n.size)return Er.getPattern(n.src,"anonymous",n.color);const t=n.src+":"+n.offset,e=Er.getPattern(t,void 0,n.color);if(e)return e;const i=Er.get(n.src,"anonymous",null);if(i.getImageState()!==jt.LOADED)return null;const r=mn(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),g0(r.canvas,t,void 0,jt.LOADED,n.color,!0),Er.getPattern(t,void 0,n.color)}class Sb{drawCustom(t,e,i,r,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const lp="ol-hidden",A_="ol-unselectable",Jw="ol-control",tA="ol-collapsed",S6=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),eA=["style","variant","weight","size","lineHeight","family"],uE={normal:400,bold:700},cE=function(n){const t=n.match(S6);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=eA.length;i<r;++i){const s=t[i+1];s!==void 0&&(e[eA[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(e.weight))&&e.weight in uE&&(e.weight=uE[e.weight]),e.families=e.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),e},Ib="10px sans-serif",Si="#000",lh="round",ho=[],fo=0,uh="round",bf=10,kf="#000",Lf="center",m0="middle",zl=[0,0,0,0],Df=1,Tc=new Ns;let Md=null,nA;const hE={},I6=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function A6(n,t,e){return`${n} ${t} 16px "${e}"`}const R6=(function(){let t,e;async function i(s){await e.ready;const o=await e.load(s);if(o.length===0)return!1;const a=cE(s),u=a.families[0].toLowerCase(),h=a.weight;return o.some(d=>{const g=d.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=uE[d.weight]||d.weight;return g===u&&d.style===a.style&&m==h})}async function r(){await e.ready;let s=!0;const o=Tc.getProperties(),a=Object.keys(o).filter(u=>o[u]<100);for(let u=a.length-1;u>=0;--u){const h=a[u];let d=o[h];d<100&&(await i(h)?(fg(hE),Tc.set(h,100)):(d+=10,Tc.set(h,d,!0),d<100&&(s=!1)))}t=void 0,s||(t=setTimeout(r,100))}return async function(s){e||(e=$i?self.fonts:document.fonts);const o=cE(s);if(!o)return;const a=o.families;let u=!1;for(const h of a){if(I6.has(h))continue;const d=A6(o.style,o.weight,h);Tc.get(d)===void 0&&(Tc.set(d,0,!0),u=!0)}u&&(clearTimeout(t),t=setTimeout(r,100))}})(),P6=(function(){let n;return function(t){let e=hE[t];if(e==null){if($i){const i=cE(t),r=Ab(t,"g");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=t,document.body.appendChild(n),e=n.offsetHeight,document.body.removeChild(n);hE[t]=e}return e}})();function Ab(n,t){return Md||(Md=mn(1,1)),n!=nA&&(Md.font=n,nA=Md.font),Md.measureText(t)}function Rb(n,t){return Ab(n,t).width}function iA(n,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((r,s)=>Math.max(r,Rb(n,s)),0);return e[t]=i,i}function C6(n,t){const e=[],i=[],r=[];let s=0,o=0,a=0,u=0;for(let h=0,d=t.length;h<=d;h+=2){const g=t[h];if(g===`
`||h===d){s=Math.max(s,o),r.push(o),o=0,a+=u,u=0;continue}const m=t[h+1]||n.font,v=Rb(m,g);e.push(v),o+=v;const y=P6(m);i.push(y),u=Math.max(u,y)}return{width:s,height:a,widths:e,heights:i,lineWidths:r}}function M6(n,t,e,i,r,s,o,a,u,h,d){n.save(),e!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=e:n.globalAlpha*=e),t&&n.transform.apply(n,t),i.contextInstructions?(n.translate(u,h),n.scale(d[0],d[1]),b6(i,n)):d[0]<0||d[1]<0?(n.translate(u,h),n.scale(d[0],d[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,u,h,o*d[0],a*d[1]),n.restore()}function b6(n,t){const e=n.contextInstructions;for(let i=0,r=e.length;i<r;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}class k6 extends Sb{constructor(t,e,i,r,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=r,this.transformRotation_=r?pg(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=qr()}drawImages_(t,e,i,r){if(!this.image_)return;const s=Sa(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let d=0,g=s.length;d<g;d+=2){const m=s[d]-this.imageAnchorX_,v=s[d+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const y=m+this.imageAnchorX_,S=v+this.imageAnchorY_;_o(a,y,S,1,1,h,-y,-S),o.save(),o.transform.apply(o,a),o.translate(y,S),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,v,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(t,e,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Sa(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=r){const u=s[e]+this.textOffsetX_,h=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(t,e,i,r,s){const o=this.context_,a=Sa(t,e,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let u=a.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(t,e,i,r){for(let s=0,o=i.length;s<o;++s)e=this.moveToLineTo_(t,e,i[s],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=e6(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,r=e.length;i<r;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Ai(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,u=s.length;a<u;++a){const h=s[a];r=this.drawRings_(i,r,h,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),$a(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,r=t.textAlign?t.textAlign:Lf;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=r&&(i.textAlign=r,e.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:xs(i||Si)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),u=e.getWidth(),h=e.getMiterLimit(),d=s||ho;this.strokeState_={lineCap:r!==void 0?r:lh,lineDash:this.pixelRatio_===1?d:d.map(g=>g*this.pixelRatio_),lineDashOffset:(o||fo)*this.pixelRatio_,lineJoin:a!==void 0?a:uh,lineWidth:(u!==void 0?u:Df)*this.pixelRatio_,miterLimit:h!==void 0?h:bf,strokeStyle:xs(i||kf)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const v=e.getColor();this.textFillState_={fillStyle:xs(v||Si)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const v=i.getColor(),y=i.getLineCap(),S=i.getLineDash(),w=i.getLineDashOffset(),R=i.getLineJoin(),P=i.getWidth(),M=i.getMiterLimit();this.textStrokeState_={lineCap:y!==void 0?y:lh,lineDash:S||ho,lineDashOffset:w||fo,lineJoin:R!==void 0?R:uh,lineWidth:P!==void 0?P:Df,miterLimit:M!==void 0?M:bf,strokeStyle:xs(v||kf)}}const r=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),u=t.getRotation(),h=t.getScaleArray(),d=t.getText(),g=t.getTextAlign(),m=t.getTextBaseline();this.textState_={font:r!==void 0?r:Ib,textAlign:g!==void 0?g:Lf,textBaseline:m!==void 0?m:m0},this.text_=d!==void 0?Array.isArray(d)?d.reduce((v,y,S)=>v+=S%2?" ":y,""):d:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const L6=.5,Pb={Point:j6,LineString:F6,Polygon:B6,MultiPoint:z6,MultiLineString:G6,MultiPolygon:U6,GeometryCollection:V6,Circle:N6};function D6(n,t){return parseInt(le(n),10)-parseInt(le(t),10)}function rA(n,t){const e=Cb(n,t);return e*e}function Cb(n,t){return L6*n/t}function N6(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const u=n.getBuilder(e.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(t,i,r)}const a=e.getText();if(a&&a.getText()){const u=n.getBuilder(e.getZIndex(),"Text");u.setTextStyle(a),u.drawText(t,i)}}function sA(n,t,e,i,r,s,o,a){const u=[],h=e.getImage();if(h){let m=!0;const v=h.getImageState();v==jt.LOADED||v==jt.ERROR?m=!1:v==jt.IDLE&&h.load(),m&&u.push(h.ready())}const d=e.getFill();d&&d.loading()&&u.push(d.ready());const g=u.length>0;return g&&Promise.all(u).then(()=>r(null)),O6(n,t,e,i,s,o,a),g}function O6(n,t,e,i,r,s,o){const a=e.getGeometryFunction()(t);if(!a)return;const u=a.simplifyTransformed(i,r);if(e.getRenderer())Mb(n,u,e,t,o);else{const d=Pb[u.getType()];d(n,u,e,t,o,s)}}function Mb(n,t,e,i,r){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,u=o.length;a<u;++a)Mb(n,o[a],e,i,r);return}n.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),r)}function V6(n,t,e,i,r,s){const o=t.getGeometriesArray();let a,u;for(a=0,u=o.length;a<u;++a){const h=Pb[o[a].getType()];h(n,o[a],e,i,r,s)}}function F6(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function G6(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function U6(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(o||s){const u=n.getBuilder(e.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const u=n.getBuilder(e.getZIndex(),"Text");u.setTextStyle(a),u.drawText(t,i,r)}}function j6(n,t,e,i,r,s){const o=e.getImage(),a=e.getText(),u=a&&a.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=jt.LOADED)return;const d=n.getBuilder(e.getZIndex(),"Image");d.setImageStyle(o,h),d.drawPoint(t,i,r)}if(u){const d=n.getBuilder(e.getZIndex(),"Text");d.setTextStyle(a,h),d.drawText(t,i,r)}}function z6(n,t,e,i,r,s){const o=e.getImage(),a=o&&o.getOpacity()!==0,u=e.getText(),h=u&&u.getText(),d=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=jt.LOADED)return;const g=n.getBuilder(e.getZIndex(),"Image");g.setImageStyle(o,d),g.drawMultiPoint(t,i,r)}if(h){const g=n.getBuilder(e.getZIndex(),"Text");g.setTextStyle(u,d),g.drawText(t,i,r)}}function B6(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const u=n.getBuilder(e.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const u=n.getBuilder(e.getZIndex(),"Text");u.setTextStyle(a),u.drawText(t,i,r)}}let $6=!1;function W6(n,t,e,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(e,i,r):n,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=$6,a.onload=function(u){if(!a.status||a.status>=200&&a.status<300){const h=t.getType();try{let d;h=="text"||h=="json"?d=a.responseText:h=="xml"?d=a.responseXML||a.responseText:h=="arraybuffer"&&(d=a.response),d?s(t.readFeatures(d,{extent:e,featureProjection:r}),t.readProjection(d)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function oA(n,t){return function(e,i,r,s,o){W6(n,t,e,i,r,(a,u)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function K6(n,t){return[[-1/0,-1/0,1/0,1/0]]}function q6(n,t,e,i){const r=[];let s=Hi();for(let o=0,a=e.length;o<a;++o){const u=e[o];s=Nw(n,t,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=u[u.length-1]}return r}function tx(n,t,e,i,r,s,o){let a,u,h,d,g,m,v;const y=r[s+1],S=[];for(let P=0,M=e.length;P<M;++P){const L=e[P];for(d=n[L-i],m=n[L-i+1],a=t;a<L;a+=i)g=n[a],v=n[a+1],(y<=m&&v<=y||m<=y&&y<=v)&&(h=(y-m)/(v-m)*(g-d)+d,S.push(h)),d=g,m=v}let w=NaN,R=-1/0;for(S.sort(co),d=S[0],a=1,u=S.length;a<u;++a){g=S[a];const P=Math.abs(g-d);P>R&&(h=(d+g)/2,qw(n,t,e,i,h,y)&&(w=h,R=P)),d=g}return isNaN(w)&&(w=r[s]),o?(o.push(w,y,R),o):[w,y,R]}function H6(n,t,e,i,r){let s=[];for(let o=0,a=e.length;o<a;++o){const u=e[o];s=tx(n,t,u,i,r,2*o,s),t=u[u.length-1]}return s}function X6(n,t,e,i){for(;t<e-i;){for(let r=0;r<i;++r){const s=n[t+r];n[t+r]=n[e-i+r],n[e-i+r]=s}t+=i,e-=i}}function ex(n,t,e,i){let r=0,s=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],u=n[t+1];r+=(a-s)*(u+o),s=a,o=u}return r===0?void 0:r>0}function bb(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],u=ex(n,t,a,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;t=a}return!0}function znt(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!bb(n,t,a,i,r))return!1;a.length&&(t=a[a.length-1])}return!0}function dE(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],u=ex(n,t,a,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&X6(n,t,a,i),t=a}return t}function Bnt(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s)t=dE(n,t,e[s],i,r);return t}function Y6(n,t){const e=[];let i=0,r=0,s;for(let o=0,a=t.length;o<a;++o){const u=t[o],h=ex(n,i,u,2);if(s===void 0&&(s=h),h===s)e.push(t.slice(r,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=o+1,i=u}return e}function kb(n,t,e,i){let r=0;const s=n[e-i],o=n[e-i+1];let a=0,u=0;for(;t<e;t+=i){const h=n[t]-s,d=n[t+1]-o;r+=u*h-a*d,a=h,u=d}return r/2}function Lb(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=kb(n,t,a,i),t=a}return r}function $nt(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=Lb(n,t,a,i),t=a[a.length-1]}return r}class Nf extends x_{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Nf(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,r){return r<Dw(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($w(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))}getArea(){return kb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ul(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=S_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Nf(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Kw(this.flatCoordinates,0,t,this.stride),this.changed()}}class Of extends x_{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?f_(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Of(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Dw(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ub(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return qw(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Lb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),dE(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,c0(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Ql(this.getExtent());this.flatInteriorPoint_=tx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new d0(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Nf(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const u=i[o],h=new Nf(e.slice(s,u),t);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;bb(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=dE(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Hw(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Of(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return gb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=hb(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function aA(n){if(v_(n))throw new Error("Cannot create polygon from empty extent");const t=n[0],e=n[1],i=n[2],r=n[3],s=[t,e,t,r,i,r,i,e,t,e];return new Of(s,"XY",[s.length])}const lA=qr();class jr{constructor(t,e,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?$M(this.flatCoordinates_):Nw(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Ql(this.getExtent());this.flatInteriorPoints_=tx(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=Y6(this.flatCoordinates_,this.ends_),e=q6(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=H6(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=aE(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=aE(t,e,o,2,.5);f_(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=Un(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const r=Jn(i)/Jn(e);_o(lA,i[0],i[3],r,-r,0,0,0),Sa(this.flatCoordinates_,0,this.flatCoordinates_.length,2,lA,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new jr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=GM((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=S_(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=r6(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,r);break;case"Polygon":r=[],i.length=Hw(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,r);break}return r&&(this.simplifiedGeometry_=new jr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}jr.prototype.getFlatCoordinates=jr.prototype.getOrientedFlatCoordinates;function Db(n,t,e=0,i=n.length-1,r=Z6){for(;i>e;){if(i-e>600){const u=i-e+1,h=t-e+1,d=Math.log(u),g=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*g*(u-g)/u)*(h-u/2<0?-1:1),v=Math.max(e,Math.floor(t-h*g/u+m)),y=Math.min(i,Math.floor(t+(u-h)*g/u+m));Db(n,t,v,y,r)}const s=n[t];let o=e,a=i;for(bd(n,e,t),r(n[i],s)>0&&bd(n,e,i);o<a;){for(bd(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[e],s)===0?bd(n,e,a):(a++,bd(n,a,i)),a<=t&&(e=a+1),t<=a&&(i=a-1)}}function bd(n,t,e){const i=n[t];n[t]=n[e],n[e]=i}function Z6(n,t){return n<t?-1:n>t?1:0}let Nb=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!cp(t,e))return i;const r=this.toBBox,s=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],u=e.leaf?r(a):a;cp(t,u)&&(e.leaf?i.push(a):t1(t,u)?this._all(a,i):s.push(a))}e=s.pop()}return i}collides(t){let e=this.data;if(!cp(t,e))return!1;const i=[];for(;e;){for(let r=0;r<e.children.length;r++){const s=e.children[r],o=e.leaf?this.toBBox(s):s;if(cp(t,o)){if(e.leaf||t1(t,o))return!0;i.push(s)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Sc([]),this}remove(t,e){if(!t)return this;let i=this.data;const r=this.toBBox(t),s=[],o=[];let a,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],a=o.pop(),h=!0),i.leaf){const d=Q6(t,i.children,e);if(d!==-1)return i.children.splice(d,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&t1(i,r)?(s.push(i),o.push(a),a=0,u=i,i=i.children[0]):u?(a++,i=u.children[a],h=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,r){const s=i-e+1;let o=this._maxEntries,a;if(s<=o)return a=Sc(t.slice(e,i+1)),hc(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Sc([]),a.leaf=!1,a.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));uA(t,e,i,h,this.compareMinX);for(let d=e;d<=i;d+=h){const g=Math.min(d+h-1,i);uA(t,d,g,u,this.compareMinY);for(let m=d;m<=g;m+=u){const v=Math.min(m+u-1,g);a.children.push(this._build(t,m,v,r-1))}}return hc(a,this.toBBox),a}_chooseSubtree(t,e,i,r){for(;r.push(e),!(e.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let u=0;u<e.children.length;u++){const h=e.children[u],d=Jv(h),g=e8(t,h)-d;g<o?(o=g,s=d<s?d:s,a=h):g===o&&d<s&&(s=d,a=h)}e=a||e.children[0]}return e}_insert(t,e,i){const r=i?t:this.toBBox(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),zd(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)}_split(t,e){const i=t[e],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Sc(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,hc(i,this.toBBox),hc(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=Sc([t,e]),this.data.height=t.height+1,this.data.leaf=!1,hc(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let r,s=1/0,o=1/0;for(let a=e;a<=i-e;a++){const u=jd(t,0,a,this.toBBox),h=jd(t,a,i,this.toBBox),d=n8(u,h),g=Jv(u)+Jv(h);d<s?(s=d,r=a,o=g<o?g:o):d===s&&g<o&&(o=g,r=a)}return r||i-e}_chooseSplitAxis(t,e,i){const r=t.leaf?this.compareMinX:J6,s=t.leaf?this.compareMinY:t8,o=this._allDistMargin(t,e,i,r),a=this._allDistMargin(t,e,i,s);o<a&&t.children.sort(r)}_allDistMargin(t,e,i,r){t.children.sort(r);const s=this.toBBox,o=jd(t,0,e,s),a=jd(t,i-e,i,s);let u=up(o)+up(a);for(let h=e;h<i-e;h++){const d=t.children[h];zd(o,t.leaf?s(d):d),u+=up(o)}for(let h=i-e-1;h>=e;h--){const d=t.children[h];zd(a,t.leaf?s(d):d),u+=up(a)}return u}_adjustParentBBoxes(t,e,i){for(let r=i;r>=0;r--)zd(e[r],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():hc(t[e],this.toBBox)}};function Q6(n,t,e){if(!e)return t.indexOf(n);for(let i=0;i<t.length;i++)if(e(n,t[i]))return i;return-1}function hc(n,t){jd(n,0,n.children.length,t,n)}function jd(n,t,e,i,r){r||(r=Sc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=t;s<e;s++){const o=n.children[s];zd(r,n.leaf?i(o):o)}return r}function zd(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function J6(n,t){return n.minX-t.minX}function t8(n,t){return n.minY-t.minY}function Jv(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function up(n){return n.maxX-n.minX+(n.maxY-n.minY)}function e8(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function n8(n,t){const e=Math.max(n.minX,t.minX),i=Math.max(n.minY,t.minY),r=Math.min(n.maxX,t.maxX),s=Math.min(n.maxY,t.maxY);return Math.max(0,r-e)*Math.max(0,s-i)}function t1(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function cp(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function Sc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function uA(n,t,e,i,r){const s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=i)continue;const o=t+Math.ceil((e-t)/i/2)*i;Db(n,o,t,e,r),s.push(t,o,o,e)}}class cA{constructor(t){this.rbush_=new Nb(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[le(e)]=i}load(t,e){const i=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const o=t[r],a=e[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=u,this.items_[le(a)]=u}this.rbush_.load(i)}remove(t){const e=le(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[le(e)],r=[i.minX,i.minY,i.maxX,i.maxY];Mf(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let r=0,s=t.length;r<s;r++)if(i=e(t[r]),i)return i;return i}isEmpty(){return rh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return ka(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class Ob extends Ns{constructor(t){super(),this.projection=Un(t.projection),this.attributions_=hA(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,r){e.viewResolver=i,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=hA(t),this.changed()}setState(t){this.state_=t,this.changed()}}function hA(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),t=>n):null}const fr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Qo extends So{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class Vb extends Ob{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Pf,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(pe(this.format_,"`format` must be set when `url` is set"),this.loader_=oA(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:K6;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new cA:null,this.loadedExtentsRtree_=new cA,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(t.features)?r=t.features:t.features&&(i=t.features,r=i.getArray()),!e&&i===void 0&&(i=new yr(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=le(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Qo(fr.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof jr||(this.featureChangeKeys_[t]=[ae(e,qt.CHANGE,this.handleFeatureChange_,this),ae(e,ih.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const r=String(e.getId());if(!(r in this.idIndex_))this.idIndex_[r]=e;else if(e instanceof jr){const s=this.idIndex_[r];s instanceof jr?Array.isArray(s)?s.push(e):this.idIndex_[r]=[s,e]:i=!1}else i=!1}return i&&(pe(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],u=le(a);this.addToIndex_(u,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],u=le(a);this.setupChangeEvents_(u,a);const h=a.getGeometry();if(h){const d=h.getExtent();e.push(d),r.push(a)}else this.nullGeometryFeatures_[u]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(fr.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Qo(fr.ADDFEATURE,i[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(fr.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(fr.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(Ti.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(Ti.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Fe);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Qo(fr.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof jr||s.intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const r=i.getGeometry();if(r instanceof jr||r.intersectsExtent(t)){const s=e(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),rh(this.nullGeometryFeatures_)||f_(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const r=XM(t,e);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],r=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const u=[-1/0,-1/0,1/0,1/0];return e=e||Rf,this.featuresRtree_.forEachInExtent(u,function(h){if(e(h)){const d=h.getGeometry(),g=a;if(a=d instanceof jr?0:d.closestPointXY(i,r,o,a),a<g){s=h;const m=Math.sqrt(a);u[0]=i-m,u[1]=r-m,u[2]=i+m,u[3]=r+m}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=le(e),r=e.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Qo(fr.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:le(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&rh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let o=0,a=s.length;o<a;++o){const u=s[o];r.forEachInExtent(u,function(d){return Ud(d.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Qo(fr.FEATURESLOADSTART)),this.loader_.call(this,u,e,i,d=>{--this.loadingExtentsCount_,this.dispatchEvent(new Qo(fr.FEATURESLOADEND,void 0,d))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Qo(fr.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(r){if(Mf(r.extent,t))return r});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,r=t.length;i<r;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=le(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.featureChangeKeys_[e]?.forEach(Fe),delete this.featureChangeKeys_[e];const r=t.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===t?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[e],this.hasListener(fr.REMOVEFEATURE)&&this.dispatchEvent(new Qo(fr.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){pe(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(oA(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}}class La{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new La({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=g0(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===jt.IDLE&&e.load(),e.getImageState()===jt.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?le(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:ah(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Ia{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Ia({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}function dA(n){return n[0]>0&&n[1]>0}function i8(n,t,e){return e===void 0&&(e=[0,0]),e[0]=n[0]*t+.5|0,e[1]=n[1]*t+.5|0,e}function Ci(n,t){return Array.isArray(n)?n:(t===void 0?t=[n,n]:(t[0]=n,t[1]=n),t)}class R_{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Ci(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new R_({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return oe()}getImage(t){return oe()}getHitDetectionImage(){return oe()}getPixelRatio(t){return 1}getImageState(){return oe()}getImageSize(){return oe()}getOrigin(){return oe()}getSize(){return oe()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ci(t)}listenImageChange(t){oe()}load(){oe()}unlistenImageChange(t){oe()}ready(){return Promise.resolve()}}class P_ extends R_{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?jt.LOADING:jt.LOADED,this.imageState_===jt.LOADING&&this.ready().then(()=>this.imageState_=jt.LOADED),this.render()}clone(){const t=this.getScale(),e=new P_({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){const e=this.fill_?.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let r=Er.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*t),a=mn(o,o);this.draw_(s,a,t),r=a.canvas,Er.set(i,null,null,new Tb(r,void 0,null,jt.LOADED,null))}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const j=r;r=s,s=j}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,u=s*Math.sin(a),h=Math.sqrt(s*s-u*u),d=r-h,g=Math.sqrt(u*u+d*d),m=g/u;if(t==="miter"&&m<=i)return m*e;const v=e/2/m,y=e/2*(d/g),w=Math.sqrt((r+v)*(r+v)+y*y)-r;if(this.radius2_===void 0||t==="bevel")return w*2;const R=r*Math.sin(a),P=Math.sqrt(r*r-R*R),M=s-P,D=Math.sqrt(R*R+M*M)/R;if(D<=i){const j=D*e/2-s-r;return 2*Math.max(w,j)}return w*2}createRenderOptions(){let t=lh,e=uh,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=xs(this.stroke_.getColor()??kf),a=this.stroke_.getWidth()??Df,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??uh,t=this.stroke_.getLineCap()??lh,i=this.stroke_.getMiterLimit()??bf);const u=this.calculateLineJoinSize_(e,a,i),h=Math.max(this.radius,this.radius2_||0),d=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:a,size:d,lineCap:t,lineDash:r,lineDashOffset:s,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=Si),e.fillStyle=xs(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=ah(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(e=mn(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const u=s+a*o,h=a%2===0?i:r;t.lineTo(h*Math.cos(u),h*Math.sin(u))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Si,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Ch extends P_{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Ch({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class Tr{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=fA,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Tr({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=fA,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function r8(n){let t;if(typeof n=="function")t=n;else{let e;Array.isArray(n)?e=n:(pe(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[n]),t=function(){return e}}return t}let e1=null;function Fb(n,t){if(!e1){const e=new La({color:"rgba(255,255,255,0.4)"}),i=new Ia({color:"#3399CC",width:1.25});e1=[new Tr({image:new Ch({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return e1}function fA(n){return n.getGeometry()}const s8="#333";class nx{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=Ci(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new La({color:s8}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new nx({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof La?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ci(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Xn={ANIMATING:0,INTERACTING:1},bt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},hp=[bt.FILL],va=[bt.STROKE],Bl=[bt.BEGIN_PATH],gA=[bt.CLOSE_PATH];class vg extends Sb{constructor(t,e,i,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,u=t.length;a<u;a+=e)r[0]=t[a],r[1]=t[a+1],sh(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,i,r,s,o){const a=this.coordinates;let u=a.length;const h=this.getBufferedMaxExtent();o&&(e+=r);let d=t[e],g=t[e+1];const m=this.tmpCoordinate_;let v=!0,y,S,w;for(y=e+r;y<i;y+=r)m[0]=t[y],m[1]=t[y+1],w=Z1(h,m),w!==S?(v&&(a[u++]=d,a[u++]=g,v=!1),a[u++]=m[0],a[u++]=m[1]):w===Tn.INTERSECTING?(a[u++]=m[0],a[u++]=m[1],v=!1):v=!0,d=m[0],g=m[1],S=w;return(s&&v||y===e+r)&&(a[u++]=d,a[u++]=g),u}drawCustomCoordinates_(t,e,i,r,s){for(let o=0,a=i.length;o<a;++o){const u=i[o],h=this.appendFlatLineCoordinates(t,e,u,r,!1,!1);s.push(h),e=u}return e}drawCustom(t,e,i,r,s){this.beginGeometry(t,e,s);const o=t.getType(),a=t.getStride(),u=this.coordinates.length;let h,d,g,m,v;switch(o){case"MultiPolygon":h=t.getOrientedFlatCoordinates(),m=[];const y=t.getEndss();v=0;for(let S=0,w=y.length;S<w;++S){const R=[];v=this.drawCustomCoordinates_(h,v,y[S],a,R),m.push(R)}this.instructions.push([bt.CUSTOM,u,m,t,i,Z2,s]),this.hitDetectionInstructions.push([bt.CUSTOM,u,m,t,r||i,Z2,s]);break;case"Polygon":case"MultiLineString":g=[],h=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),v=this.drawCustomCoordinates_(h,0,t.getEnds(),a,g),this.instructions.push([bt.CUSTOM,u,g,t,i,c0,s]),this.hitDetectionInstructions.push([bt.CUSTOM,u,g,t,r||i,c0,s]);break;case"LineString":case"Circle":h=t.getFlatCoordinates(),d=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([bt.CUSTOM,u,d,t,i,Ul,s]),this.hitDetectionInstructions.push([bt.CUSTOM,u,d,t,r||i,Ul,s]);break;case"MultiPoint":h=t.getFlatCoordinates(),d=this.appendFlatPointCoordinates(h,a),d>u&&(this.instructions.push([bt.CUSTOM,u,d,t,i,Ul,s]),this.hitDetectionInstructions.push([bt.CUSTOM,u,d,t,r||i,Ul,s]));break;case"Point":h=t.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),d=this.coordinates.length,this.instructions.push([bt.CUSTOM,u,d,t,i,void 0,s]),this.hitDetectionInstructions.push([bt.CUSTOM,u,d,t,r||i,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[bt.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[bt.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let r,s,o=-1;for(e=0;e<i;++e)r=t[e],s=r[0],s==bt.END_GEOMETRY?o=e:s==bt.BEGIN_GEOMETRY&&(r[2]=e,i5(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const i=t.getColor();e.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,e.fillStyle=xs(i||Si)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const i=t.getColor();e.strokeStyle=xs(i||kf);const r=t.getLineCap();e.lineCap=r!==void 0?r:lh;const s=t.getLineDash();e.lineDash=s?s.slice():ho;const o=t.getLineDashOffset();e.lineDashOffset=o||fo;const a=t.getLineJoin();e.lineJoin=a!==void 0?a:uh;const u=t.getWidth();e.lineWidth=u!==void 0?u:Df;const h=t.getMiterLimit();e.miterLimit=h!==void 0?h:bf,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){const e=t.fillStyle,i=[bt.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[bt.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,r=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,u=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||s!=t.currentLineDash&&!$a(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=u||t.currentMiterLimit!=h)&&(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=u,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[bt.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=zM(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Cf(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class o8 extends vg{constructor(t,e,i,r){super(t,e,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!sh(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([bt.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([bt.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=t.getStride())(!this.maxExtent||sh(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([bt.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([bt.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class a8 extends vg{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinates_(t,e,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,r,!1,!1),a=[bt.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([bt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo],Bl);const a=t.getFlatCoordinates(),u=t.getStride();this.drawFlatCoordinates_(a,0,a.length,u),this.hitDetectionInstructions.push(va),this.endGeometry(e)}drawMultiLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([bt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo],Bl);const a=t.getEnds(),u=t.getFlatCoordinates(),h=t.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinates_(u,d,a[g],h);this.hitDetectionInstructions.push(va),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(va),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(va),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Bl)}}class mA extends vg{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinatess_(t,e,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,u=i.length;this.instructions.push(Bl),this.hitDetectionInstructions.push(Bl);for(let h=0;h<u;++h){const d=i[h],g=this.coordinates.length,m=this.appendFlatLineCoordinates(t,e,d,r,!0,!a),v=[bt.MOVE_TO_LINE_TO,g,m];this.instructions.push(v),this.hitDetectionInstructions.push(v),a&&(this.instructions.push(gA),this.hitDetectionInstructions.push(gA)),e=d}return o&&(this.instructions.push(hp),this.hitDetectionInstructions.push(hp)),a&&(this.instructions.push(va),this.hitDetectionInstructions.push(va)),e}drawCircle(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([bt.SET_FILL_STYLE,Si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([bt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo]);const a=t.getFlatCoordinates(),u=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,u,!1,!1);const d=[bt.CIRCLE,h];this.instructions.push(Bl,d),this.hitDetectionInstructions.push(Bl,d),r.fillStyle!==void 0&&(this.instructions.push(hp),this.hitDetectionInstructions.push(hp)),r.strokeStyle!==void 0&&(this.instructions.push(va),this.hitDetectionInstructions.push(va)),this.endGeometry(e)}drawPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([bt.SET_FILL_STYLE,Si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([bt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo]);const a=t.getEnds(),u=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(u,0,a,h),this.endGeometry(e)}drawMultiPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([bt.SET_FILL_STYLE,Si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([bt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo]);const a=t.getEndss(),u=t.getOrientedFlatCoordinates(),h=t.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinatess_(u,d,a[g],h);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,r=e.length;i<r;++i)e[i]=Sl(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}}function l8(n,t,e,i,r){const s=[];let o=e,a=0,u=t.slice(e,2);for(;a<n&&o+r<i;){const[h,d]=u.slice(-2),g=t[o+r],m=t[o+r+1],v=Math.sqrt((g-h)*(g-h)+(m-d)*(m-d));if(a+=v,a>=n){const y=(n-a+v)/v,S=Bi(h,g,y),w=Bi(d,m,y);u.push(S,w),s.push(u),u=[S,w],a==n&&(o+=r),a=0}else if(a<n)u.push(t[o+r],t[o+r+1]),o+=r;else{const y=v-a,S=Bi(h,g,y/v),w=Bi(d,m,y/v);u.push(S,w),s.push(u),u=[S,w],a=0,o+=r}}return a>0&&s.push(u),s}function u8(n,t,e,i,r){let s=e,o=e,a=0,u=0,h=e,d,g,m,v,y,S,w,R,P,M;for(g=e;g<i;g+=r){const L=t[g],D=t[g+1];y!==void 0&&(P=L-y,M=D-S,v=Math.sqrt(P*P+M*M),w!==void 0&&(u+=m,d=Math.acos((w*P+R*M)/(m*v)),d>n&&(u>a&&(a=u,s=h,o=g),u=0,h=g-r)),m=v,w=P,R=M),y=L,S=D}return u+=v,u>a?[h,g]:[s,o]}const p0={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class c8 extends vg{constructor(t,e,i,r){super(t,e,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Si]={fillStyle:Si},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let u=a.length;const h=t.getType();let d=null,g=t.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ai(this.maxExtent,t.getExtent()))return;let m;if(d=t.getFlatCoordinates(),h=="LineString")m=[d.length];else if(h=="MultiLineString")m=t.getEnds();else if(h=="Polygon")m=t.getEnds().slice(0,1);else if(h=="MultiPolygon"){const w=t.getEndss();m=[];for(let R=0,P=w.length;R<P;++R)m.push(w[R][0])}this.beginGeometry(t,e,i);const v=o.repeat,y=v?void 0:o.textAlign;let S=0;for(let w=0,R=m.length;w<R;++w){let P;v?P=l8(v*this.resolution,d,S,m[w],g):P=[d.slice(S,m[w])];for(let M=0,L=P.length;M<L;++M){const D=P[M];let j=0,b=D.length;if(y==null){const k=u8(o.maxAngle,D,0,D.length,2);j=k[0],b=k[1]}for(let k=j;k<b;k+=g)a.push(D[k],D[k+1]);const A=a.length;S=m[w],this.drawChars_(u,A),u=A}}this.endGeometry(e)}else{let m=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":d=t.getFlatCoordinates();break;case"LineString":d=t.getFlatMidpoint();break;case"Circle":d=t.getCenter();break;case"MultiLineString":d=t.getFlatMidpoints(),g=2;break;case"Polygon":d=t.getFlatInteriorPoint(),o.overflow||m.push(d[2]/this.resolution),g=3;break;case"MultiPolygon":const L=t.getFlatInteriorPoints();d=[];for(let D=0,j=L.length;D<j;D+=3)o.overflow||m.push(L[D+2]/this.resolution),d.push(L[D],L[D+1]);if(d.length===0)return;g=2;break}const v=this.appendFlatPointCoordinates(d,g);if(v===u)return;if(m&&(v-u)/2!==d.length/g){let L=u/2;m=m.filter((D,j)=>{const b=a[(L+j)*2]===d[j*g]&&a[(L+j)*2+1]===d[j*g+1];return b||--L,b})}this.saveTextStates_();const y=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,S=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,i);let w=o.padding;if(w!=zl&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],D=o.padding[1],j=o.padding[2],b=o.padding[3];o.scale[0]<0&&(D=-D,b=-b),o.scale[1]<0&&(L=-L,j=-j),w=[L,D,j,b]}const R=this.pixelRatio;this.instructions.push([bt.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==zl?zl:w.map(function(L){return L*R}),y,S,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const P=1/R,M=y?y.slice(0):null;M&&(M[1]=Si),this.hitDetectionInstructions.push([bt.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,this.declutterMode_,this.declutterImageWithText_,w,M,S,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Si:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Lf,justify:e.justify,textBaseline:e.textBaseline||m0,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=p0[r.textBaseline],d=this.textOffsetY_*u,g=this.text_,m=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([bt.DRAW_CHARS,t,e,h,r.overflow,a,r.maxAngle,u,d,s,m*u,g,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([bt.DRAW_CHARS,t,e,h,r.overflow,a&&Si,r.maxAngle,u,d,s,m*u,g,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,r,s;if(!t)this.text_="";else{const o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=xs(o.getColor()||Si)):(r=null,this.textFillState_=r);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const S=a.getLineDash(),w=a.getLineDashOffset(),R=a.getWidth(),P=a.getMiterLimit();s.lineCap=a.getLineCap()||lh,s.lineDash=S?S.slice():ho,s.lineDashOffset=w===void 0?fo:w,s.lineJoin=a.getLineJoin()||uh,s.lineWidth=R===void 0?Df:R,s.miterLimit=P===void 0?bf:P,s.strokeStyle=xs(a.getColor()||kf)}i=this.textState_;const u=t.getFont()||Ib;R6(u);const h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=u,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||m0,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||zl,i.scale=h===void 0?[1,1]:h;const d=t.getOffsetX(),g=t.getOffsetY(),m=t.getRotateWithView(),v=t.getKeepUpright(),y=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=d===void 0?0:d,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=v===void 0?!0:v,this.textRotation_=y===void 0?0:y,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:le(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+le(r.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const h8={Circle:mA,Default:vg,Image:o8,LineString:a8,Polygon:mA,Text:c8};class d8{constructor(t,e,i,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const r in i){const s=i[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[e];if(s===void 0){const o=h8[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s}return s}}function f8(n,t,e,i,r,s,o,a,u,h,d,g,m=!0){let v=n[t],y=n[t+1],S=0,w=0,R=0,P=0;function M(){S=v,w=y,t+=i,v=n[t],y=n[t+1],P+=R,R=Math.sqrt((v-S)*(v-S)+(y-w)*(y-w))}do M();while(t<e-i&&P+R<s);let L=R===0?0:(s-P)/R;const D=Bi(S,v,L),j=Bi(w,y,L),b=t-i,A=P,k=s+a*u(h,r,d);for(;t<e-i&&P+R<k;)M();L=R===0?0:(k-P)/R;const V=Bi(S,v,L),F=Bi(w,y,L);let U=!1;if(m)if(g){const dt=[D,j,V,F];lb(dt,0,4,2,g,dt,dt),U=dt[0]>dt[2]}else U=D>V;const N=Math.PI,ut=[],wt=b+i===t;t=b,R=0,P=A,v=n[t],y=n[t+1];let yt;if(wt){M(),yt=Math.atan2(y-w,v-S),U&&(yt+=yt>0?-N:N);const dt=(V+D)/2,J=(F+j)/2;return ut[0]=[dt,J,(k-s)/2,yt,r],ut}r=r.replace(/\n/g," ");for(let dt=0,J=r.length;dt<J;){M();let at=Math.atan2(y-w,v-S);if(U&&(at+=at>0?-N:N),yt!==void 0){let Pt=at-yt;if(Pt+=Pt>N?-2*N:Pt<-N?2*N:0,Math.abs(Pt)>o)return null}yt=at;const it=dt;let $=0;for(;dt<J;++dt){const Pt=U?J-dt-1:dt,Nt=a*u(h,r[Pt],d);if(t+i<e&&P+R<s+$+Nt/2)break;$+=Nt}if(dt===it)continue;const K=U?r.substring(J-it,J-dt):r.substring(it,dt);L=R===0?0:(s+$/2-P)/R;const At=Bi(S,v,L),Rt=Bi(w,y,L);ut.push([At,Rt,$/2,at,K]),s+=$}return ut}class Gb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(f0(),{get:(t,e)=>{if(typeof f0()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,r=e.length;i<r;++i){const s=e[i];if(typeof s=="function"){s(t);continue}const o=e[++i];if(typeof t[s]=="function")t[s](...o);else{if(typeof o=="function"){t[s]=o(t);continue}t[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const dc=Hi(),Jo=[],no=[],io=[],ta=[];function pA(n){return n[3].declutterBox}const _A=new RegExp("[-----]");function n1(n,t){return t==="start"?t=_A.test(n)?"right":"left":t==="end"&&(t=_A.test(n)?"left":"right"),p0[t]}function g8(n,t,e){return e>0&&n.push(`
`,""),n.push(t,""),n}function m8(n,t,e){return e%2===0&&(n+=t),n}class p8{constructor(t,e,i,r,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=qr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Gb:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,r){const s=t+e+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,u=this.textStates[e],h=this.pixelRatio,d=[u.scale[0]*h,u.scale[1]*h],g=u.justify?p0[u.justify]:n1(Array.isArray(t)?t[0]:t,u.textAlign||Lf),m=r&&o.lineWidth?o.lineWidth:0,v=Array.isArray(t)?t:String(t).split(`
`).reduce(g8,[]),{width:y,height:S,widths:w,heights:R,lineWidths:P}=C6(u,v),M=y+m,L=[],D=(M+2)*d[0],j=(S+m)*d[1],b={width:D<0?Math.floor(D):Math.ceil(D),height:j<0?Math.floor(j):Math.ceil(j),contextInstructions:L};(d[0]!=1||d[1]!=1)&&L.push("scale",d),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",m),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",a.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const A=.5-g;let k=g*M+A*m;const V=[],F=[];let U=0,N=0,ut=0,wt=0,yt;for(let dt=0,J=v.length;dt<J;dt+=2){const at=v[dt];if(at===`
`){N+=U,U=0,k=g*M+A*m,++wt;continue}const it=v[dt+1]||u.font;it!==yt&&(r&&V.push("font",it),i&&F.push("font",it),yt=it),U=Math.max(U,R[ut]);const $=[at,k+A*w[ut]+g*(w[ut]-P[wt]),.5*(m+U)+N];k+=w[ut],r&&V.push("strokeText",$),i&&F.push("fillText",$),++ut}return Array.prototype.push.apply(L,V),Array.prototype.push.apply(L,F),this.labels_[s]=b,b}replayTextBackground_(t,e,i,r,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,r,s,o,a,u,h,d,g,m,v,y,S,w){a*=m[0],u*=m[1];let R=i-a,P=r-u;const M=s+h>t?t-h:s,L=o+d>e?e-d:o,D=y[3]+M*m[0]+y[1],j=y[0]+L*m[1]+y[2],b=R-y[3],A=P-y[0];(S||g!==0)&&(Jo[0]=b,ta[0]=b,Jo[1]=A,no[1]=A,no[0]=b+D,io[0]=no[0],io[1]=A+j,ta[1]=io[1]);let k;return g!==0?(k=_o(qr(),i,r,1,1,g,-i,-r),In(k,Jo),In(k,no),In(k,io),In(k,ta),ka(Math.min(Jo[0],no[0],io[0],ta[0]),Math.min(Jo[1],no[1],io[1],ta[1]),Math.max(Jo[0],no[0],io[0],ta[0]),Math.max(Jo[1],no[1],io[1],ta[1]),dc)):ka(Math.min(b,b+D),Math.min(A,A+j),Math.max(b,b+D),Math.max(A,A+j),dc),v&&(R=Math.round(R),P=Math.round(P)),{drawImageX:R,drawImageY:P,drawImageW:M,drawImageH:L,originX:h,originY:d,declutterBox:{minX:dc[0],minY:dc[1],maxX:dc[2],maxY:dc[3],value:w},canvasTransform:k,scale:m}}replayImageOrLabel_(t,e,i,r,s,o,a){const u=!!(o||a),h=r.declutterBox,d=a?a[2]*r.scale[0]/2:0;return h.minX-d<=e[0]&&h.maxX+d>=0&&h.minY-d<=e[1]&&h.maxY+d>=0&&(u&&this.replayTextBackground_(t,Jo,no,io,ta,o,a),M6(t,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=In(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(i[0]%r,i[1]%r),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,i,r){const s=this.textStates[e],o=this.createLabel(t,e,r,i),a=this.strokeStates[i],u=this.pixelRatio,h=n1(Array.isArray(t)?t[0]:t,s.textAlign||Lf),d=p0[s.textBaseline||m0],g=a&&a.lineWidth?a.lineWidth:0,m=o.width/u-2*s.scale[0],v=h*m+2*(.5-h)*g,y=d*o.height/u+2*(.5-d)*g;return{label:o,anchorX:v,anchorY:y}}execute_(t,e,i,r,s,o,a,u){const h=this.zIndexContext_;let d;this.pixelCoordinates_&&$a(i,this.renderedTransform_)?d=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),d=Sa(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),W5(this.renderedTransform_,i));let g=0;const m=r.length;let v=0,y,S,w,R,P,M,L,D,j,b,A,k,V,F=0,U=0;const N=this.coordinateCache_,ut=this.viewRotation_,wt=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,yt={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ut},dt=this.instructions!=r||this.overlaps?0:200;let J,at,it,$;for(;g<m;){const K=r[g];switch(K[0]){case bt.BEGIN_GEOMETRY:J=K[1],$=K[3],J.getGeometry()?a!==void 0&&!Ai(a,$.getExtent())?g=K[2]+1:++g:g=K[2],h&&(h.zIndex=K[4]);break;case bt.BEGIN_PATH:F>dt&&(this.fill_(t),F=0),U>dt&&(t.stroke(),U=0),!F&&!U&&(t.beginPath(),P=NaN,M=NaN),++g;break;case bt.CIRCLE:v=K[1];const Rt=d[v],Pt=d[v+1],Nt=d[v+2],Vt=d[v+3],$t=Nt-Rt,Xt=Vt-Pt,ye=Math.sqrt($t*$t+Xt*Xt);t.moveTo(Rt+ye,Pt),t.arc(Rt,Pt,ye,0,2*Math.PI,!0),++g;break;case bt.CLOSE_PATH:t.closePath(),++g;break;case bt.CUSTOM:v=K[1],y=K[2];const Ar=K[3],Fs=K[4],fi=K[5];yt.geometry=Ar,yt.feature=J,g in N||(N[g]=[]);const gi=N[g];fi?fi(d,v,y,2,gi):(gi[0]=d[v],gi[1]=d[v+1],gi.length=2),h&&(h.zIndex=K[6]),Fs(gi,yt),++g;break;case bt.DRAW_IMAGE:v=K[1],y=K[2],j=K[3],S=K[4],w=K[5];let An=K[6];const Rn=K[7],mi=K[8],Ji=K[9],Re=K[10];let ve=K[11];const yn=K[12];let tr=K[13];R=K[14]||"declutter";const De=K[15];if(!j&&K.length>=20){b=K[19],A=K[20],k=K[21],V=K[22];const Ye=this.drawLabelWithPointPlacement_(b,A,k,V);j=Ye.label,K[3]=j;const ir=K[23];S=(Ye.anchorX-ir)*this.pixelRatio,K[4]=S;const Pn=K[24];w=(Ye.anchorY-Pn)*this.pixelRatio,K[5]=w,An=j.height,K[6]=An,tr=j.width,K[13]=tr}let Co;K.length>25&&(Co=K[25]);let er,Yr,Rr;K.length>17?(er=K[16],Yr=K[17],Rr=K[18]):(er=zl,Yr=null,Rr=null),Re&&wt?ve+=ut:!Re&&!wt&&(ve-=ut);let Zr=0;for(;v<y;v+=2){if(Co&&Co[Zr++]<tr/this.pixelRatio)continue;const Ye=this.calculateImageOrLabelDimensions_(j.width,j.height,d[v],d[v+1],tr,An,S,w,mi,Ji,ve,yn,s,er,!!Yr||!!Rr,J),ir=[t,e,j,Ye,Rn,Yr,Rr];if(u){let Pn,Ze,Cn;if(De){const ce=y-v;if(!De[ce]){De[ce]={args:ir,declutterMode:R};continue}const rn=De[ce];Pn=rn.args,Ze=rn.declutterMode,delete De[ce],Cn=pA(Pn)}let Mn,vn;if(Pn&&(Ze!=="declutter"||!u.collides(Cn))&&(Mn=!0),(R!=="declutter"||!u.collides(Ye.declutterBox))&&(vn=!0),Ze==="declutter"&&R==="declutter"){const ce=Mn&&vn;Mn=ce,vn=ce}Mn&&(Ze!=="none"&&u.insert(Cn),this.replayImageOrLabel_.apply(this,Pn)),vn&&(R!=="none"&&u.insert(Ye.declutterBox),this.replayImageOrLabel_.apply(this,ir))}else this.replayImageOrLabel_.apply(this,ir)}++g;break;case bt.DRAW_CHARS:const Xa=K[1],Qr=K[2],nr=K[3],Pu=K[4];V=K[5];const Jr=K[6],Gs=K[7],Mo=K[8];k=K[9];const ii=K[10];b=K[11],Array.isArray(b)&&(b=b.reduce(m8,"")),A=K[12];const Us=[K[13],K[13]];R=K[14]||"declutter";const ts=K[15],es=this.textStates[A],ri=es.font,si=[es.scale[0]*Gs,es.scale[1]*Gs];let Ie;ri in this.widths_?Ie=this.widths_[ri]:(Ie={},this.widths_[ri]=Ie);const bo=mb(d,Xa,Qr,2),Pr=Math.abs(si[0])*iA(ri,b,Ie);if(Pu||Pr<=bo){const Ye=this.textStates[A].textAlign,ir=(bo-Pr)*n1(b,Ye),Pn=f8(d,Xa,Qr,2,b,ir,Jr,Math.abs(si[0]),iA,ri,Ie,wt?0:this.viewRotation_,ts);t:if(Pn){const Ze=[];let Cn,Mn,vn,ce,rn;if(k)for(Cn=0,Mn=Pn.length;Cn<Mn;++Cn){rn=Pn[Cn],vn=rn[4],ce=this.createLabel(vn,A,"",k),S=rn[2]+(si[0]<0?-ii:ii),w=nr*ce.height+(.5-nr)*2*ii*si[1]/si[0]-Mo;const cn=this.calculateImageOrLabelDimensions_(ce.width,ce.height,rn[0],rn[1],ce.width,ce.height,S,w,0,0,rn[3],Us,!1,zl,!1,J);if(u&&R==="declutter"&&u.collides(cn.declutterBox))break t;Ze.push([t,e,ce,cn,1,null,null])}if(V)for(Cn=0,Mn=Pn.length;Cn<Mn;++Cn){rn=Pn[Cn],vn=rn[4],ce=this.createLabel(vn,A,V,""),S=rn[2],w=nr*ce.height-Mo;const cn=this.calculateImageOrLabelDimensions_(ce.width,ce.height,rn[0],rn[1],ce.width,ce.height,S,w,0,0,rn[3],Us,!1,zl,!1,J);if(u&&R==="declutter"&&u.collides(cn.declutterBox))break t;Ze.push([t,e,ce,cn,1,null,null])}u&&R!=="none"&&u.load(Ze.map(pA));for(let cn=0,rr=Ze.length;cn<rr;++cn)this.replayImageOrLabel_.apply(this,Ze[cn])}}++g;break;case bt.END_GEOMETRY:if(o!==void 0){J=K[1];const Ye=o(J,$,R);if(Ye)return Ye}++g;break;case bt.FILL:dt?F++:this.fill_(t),++g;break;case bt.MOVE_TO_LINE_TO:for(v=K[1],y=K[2],at=d[v],it=d[v+1],t.moveTo(at,it),P=at+.5|0,M=it+.5|0,v+=2;v<y;v+=2)at=d[v],it=d[v+1],L=at+.5|0,D=it+.5|0,(v==y-2||L!==P||D!==M)&&(t.lineTo(at,it),P=L,M=D);++g;break;case bt.SET_FILL_STYLE:this.alignAndScaleFill_=K[2],F&&(this.fill_(t),F=0,U&&(t.stroke(),U=0)),t.fillStyle=K[1],++g;break;case bt.SET_STROKE_STYLE:U&&(t.stroke(),U=0),this.setStrokeStyle_(t,K),++g;break;case bt.STROKE:dt?U++:t.stroke(),++g;break;default:++g;break}}F&&this.fill_(t),U&&t.stroke()}execute(t,e,i,r,s,o){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,i,r,s){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,s)}}const Ll=["Polygon","Circle","LineString","Image","Text","Default"],Ub=["Image","Text"],_8=Ll.filter(n=>!Ub.includes(n));class y8{constructor(t,e,i,r,s,o,a){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=qr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=t[i];for(const o in s){const a=s[o];r[o]=new p8(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,r,s,o){r=Math.round(r);const a=r*2+1,u=_o(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=mn(a,a));const d=this.hitDetectionContext_;d.canvas.width!==a||d.canvas.height!==a?(d.canvas.width=a,d.canvas.height=a):h||d.clearRect(0,0,a,a);let g;this.renderBuffer_!==void 0&&(g=Hi(),of(g,t),Cf(g,e*(this.renderBuffer_+r),g));const m=v8(r);let v;function y(D,j,b){const A=d.getImageData(0,0,a,a).data;for(let k=0,V=m.length;k<V;k++)if(A[m[k]]>0){if(!o||b==="none"||v!=="Image"&&v!=="Text"||o.includes(D)){const F=(m[k]-3)/4,U=r-F%a,N=r-(F/a|0),ut=s(D,j,U*U+N*N);if(ut)return ut}d.clearRect(0,0,a,a);break}}const S=Object.keys(this.executorsByZIndex_).map(Number);S.sort(co);let w,R,P,M,L;for(w=S.length-1;w>=0;--w){const D=S[w].toString();for(P=this.executorsByZIndex_[D],R=Ll.length-1;R>=0;--R)if(v=Ll[R],M=P[v],M!==void 0&&(L=M.executeHitDetection(d,u,i,y,g),L))return L}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],r=e[1],s=e[2],o=e[3],a=[i,r,i,o,s,o,s,r];return Sa(a,0,8,2,t,a),a}isEmpty(){return rh(this.executorsByZIndex_)}execute(t,e,i,r,s,o,a){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(a?n5:co),o=o||Ll;const h=Ll.length;for(let d=0,g=u.length;d<g;++d){const m=u[d].toString(),v=this.executorsByZIndex_[m];for(let y=0,S=o.length;y<S;++y){const w=o[y],R=v[w];if(R!==void 0){const P=a===null?void 0:R.getZIndexContext(),M=P?P.getContext():t,L=this.maxExtent_&&w!=="Image"&&w!=="Text";if(L&&(M.save(),this.clip(M,i)),!P||w==="Text"||w==="Image"?R.execute(M,e,i,r,s,a):P.pushFunction(D=>R.execute(D,e,i,r,s,a)),L&&M.restore(),P){P.offset();const D=u[d]*h+Ll.indexOf(w);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(P)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(co);for(let i=0,r=e.length;i<r;++i)t[e[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),t[e[i]].length=0}}const i1={};function v8(n){if(i1[n]!==void 0)return i1[n];const t=n*2+1,e=n*n,i=new Array(e+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>e)break;let u=i[a];u||(u=[],i[a]=u),u.push(((n+s)*t+(n+o))*4+3),s>0&&u.push(((n-s)*t+(n+o))*4+3),o>0&&(u.push(((n+s)*t+(n-o))*4+3),s>0&&u.push(((n-s)*t+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return i1[n]=r,r}function yA(n,t,e,i){return e!==void 0&&i!==void 0?[e/n,i/t]:e!==void 0?e/n:i!==void 0?i/t:1}let ix=class jb extends R_{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;pe(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||le(o)),pe(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),pe(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(t.src!==void 0?u=jt.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?jt.LOADED:jt.IDLE:u=jt.LOADING:u=jt.LOADED),this.color_=t.color!==void 0?ah(t.color):null,this.iconImage_=g0(o,a,this.crossOrigin_,u,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let h,d;if(t.size)[h,d]=t.size;else{const g=this.getImage(1);if(g.width&&g.height)h=g.width,d=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=t;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const v=this.iconImage_.getSize();this.setScale(yA(v[0],v[1],t.width,t.height))};this.listenImageChange(m);return}}h!==void 0&&this.setScale(yA(h,d,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new jb({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(t){this.iconImage_=g0(null,t,this.crossOrigin_,jt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==jt.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==jt.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(qt.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(qt.CHANGE,t)}ready(){return this.iconImage_.ready()}};const Es=.5;function E8(n,t,e,i,r,s,o,a,u){const h=r,d=n[0]*Es,g=n[1]*Es,m=mn(d,g);m.imageSmoothingEnabled=!1;const v=m.canvas,y=new k6(m,Es,r,null,o,a,null),S=e.length,w=Math.floor((256*256*256-1)/S),R={};for(let M=1;M<=S;++M){const L=e[M-1],D=L.getStyleFunction()||i;if(!D)continue;let j=D(L,s);if(!j)continue;Array.isArray(j)||(j=[j]);const A=(M*w).toString(16).padStart(7,"#00000");for(let k=0,V=j.length;k<V;++k){const F=j[k],U=F.getGeometryFunction()(L);if(!U||!Ai(h,U.getExtent()))continue;const N=F.clone(),ut=N.getFill();ut&&ut.setColor(A);const wt=N.getStroke();wt&&(wt.setColor(A),wt.setLineDash(null)),N.setText(void 0);const yt=F.getImage();if(yt){const it=yt.getImageSize();if(!it)continue;const $=mn(it[0],it[1],void 0,{alpha:!1}),K=$.canvas;$.fillStyle=A,$.fillRect(0,0,K.width,K.height),N.setImage(new ix({img:K,anchor:yt.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:yt.getOrigin(),opacity:1,size:yt.getSize(),scale:yt.getScale(),rotation:yt.getRotation(),rotateWithView:yt.getRotateWithView()}))}const dt=N.getZIndex()||0;let J=R[dt];J||(J={},R[dt]=J,J.Polygon=[],J.Circle=[],J.LineString=[],J.Point=[]);const at=U.getType();if(at==="GeometryCollection"){const it=U.getGeometriesArrayRecursive();for(let $=0,K=it.length;$<K;++$){const At=it[$];J[At.getType().replace("Multi","")].push(At,N)}}else J[at.replace("Multi","")].push(U,N)}}const P=Object.keys(R).map(Number).sort(co);for(let M=0,L=P.length;M<L;++M){const D=R[P[M]];for(const j in D){const b=D[j];for(let A=0,k=b.length;A<k;A+=2){y.setStyle(b[A+1]);for(let V=0,F=t.length;V<F;++V)y.setTransform(t[V]),y.drawGeometry(b[A])}}}return m.getImageData(0,0,v.width,v.height)}function w8(n,t,e){const i=[];if(e){const r=Math.floor(Math.round(n[0])*Es),s=Math.floor(Math.round(n[1])*Es),o=(ke(r,0,e.width-1)+ke(s,0,e.height-1)*e.width)*4,a=e.data[o],u=e.data[o+1],d=e.data[o+2]+256*(u+256*a),g=Math.floor((256*256*256-1)/t.length);d&&d%g===0&&i.push(t[d/g-1])}return i}class zb extends So{constructor(t,e,i,r){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=r}}const x8=5;class T8 extends mg{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=x8}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return oe()}getData(t){return null}prepareFrame(t){return oe()}renderFrame(t,e){return oe()}forEachFeatureAtCoordinate(t,e,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===jt.LOADED||e.getState()===jt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=jt.LOADED&&e!=jt.ERROR&&t.addEventListener(qt.CHANGE,this.boundHandleImageChange_),e==jt.IDLE&&(t.load(),e=t.getState()),e==jt.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const vA=[];let Ic=null;function S8(){Ic=mn(1,1,void 0,{willReadFrequently:!0})}class Bb extends T8{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=qr(),this.pixelTransform=qr(),this.inversePixelTransform=qr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){Ic||S8(),Ic.clearRect(0,0,1,1);let r;try{Ic.drawImage(t,e,i,1,1,0,0,1,1),r=Ic.getImageData(0,0,1,1).data}catch{return Ic=null,null}return r}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,e,i){const r=this.getLayer().getClassName();let s,o;if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&$a(ah(t.style.backgroundColor),ah(i)))){const a=t.firstElementChild;ya(a)&&(o=a.getContext("2d"))}if(o&&X5(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=$i?Eb():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=mn();const u=o.canvas;s.appendChild(u),a=u.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const r=yu(i),s=y_(i),o=__(i),a=p_(i);In(e.coordinateToPixelTransform,r),In(e.coordinateToPixelTransform,s),In(e.coordinateToPixelTransform,o),In(e.coordinateToPixelTransform,a);const u=this.inversePixelTransform;In(u,r),In(u,s),In(u,o),In(u,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const i=t.extent,r=t.viewState.resolution,s=t.viewState.rotation,o=t.pixelRatio,a=Math.round(ue(i)/r*o),u=Math.round(Jn(i)/r*o);_o(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,s,-a/2,-u/2),ab(this.inversePixelTransform,this.pixelTransform);const h=H5(this.pixelTransform);if(this.useContainer(e,h,this.getBackground(t)),!this.containerReused){const d=this.context.canvas;d.width!=a||d.height!=u?(d.width=a,d.height=u):this.context.clearRect(0,0,a,u),h!==d.style.transform&&(d.style.transform=h)}}dispatchRenderEvent_(t,e,i){const r=this.getLayer();if(r.hasListener(t)){const s=new zb(t,this.inversePixelTransform,i,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(vr.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(vr.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Gb),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(vr.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(vr.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,r,s,o,a){const u=s/2,h=o/2,d=r/e,g=-d,m=-t[0]+a,v=-t[1];return _o(this.tempTransform,u,h,d,g,-i,m,v)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class I8 extends Bb{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Hi(),this.wrappedRenderedExtent_=Hi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const r=e.extent,s=e.viewState,o=s.center,a=s.resolution,u=s.projection,h=s.rotation,d=u.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),v=e.pixelRatio,y=e.viewHints,S=!(y[Xn.ANIMATING]||y[Xn.INTERACTING]),w=this.context,R=Math.round(ue(r)/a*v),P=Math.round(Jn(r)/a*v),M=g.getWrapX()&&u.canWrapX(),L=M?ue(d):null,D=M?Math.ceil((r[2]-d[2])/L)+1:1;let j=M?Math.floor((r[0]-d[0])/L):0;do{let b=this.getRenderTransform(o,a,0,v,R,P,j*L);e.declutter&&(b=b.slice(0)),t.execute(w,[w.canvas.width,w.canvas.height],b,h,S,i===void 0?Ll:i?Ub:_8,i?m&&e.declutter[m]:void 0)}while(++j<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=mn(this.context.canvas.width,this.context.canvas.height,vA))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,I_(this.context),vA.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const r=t.viewState;this.prepareContainer(t,e);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(vr.PRERENDER)||this.getLayer().hasListener(vr.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,t),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const u=_a(i.extent);a=Ai(u,t.extent),this.clipped_=a&&!Ud(u,t.extent),this.clipped_&&this.clipUnrotated(s,t,u)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&s.restore(),this.postRender(s,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),d=[],g=i[0]*Es,m=i[1]*Es;d.push(this.getRenderTransform(r,s,o,Es,g,m,0).slice());const v=h.getSource(),y=a.getExtent();if(v.getWrapX()&&a.canWrapX()&&!Ud(y,u)){let S=u[0];const w=ue(y);let R=0,P;for(;S<y[0];)--R,P=w*R,d.push(this.getRenderTransform(r,s,o,Es,g,m,P).slice()),S+=w;for(R=0,S=u[2];S>y[2];)++R,P=w*R,d.push(this.getRenderTransform(r,s,o,Es,g,m,P).slice()),S-=w}this.hitDetectionImageData_=E8(i,d,this.renderedFeatures_,h.getStyleFunction(),u,s,o,rA(s,this.renderedPixelRatio_))}e(w8(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,r,s){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,u=this.getLayer(),h={},d=function(m,v,y){const S=le(m),w=h[S];if(w){if(w!==!0&&y<w.distanceSq){if(y===0)return h[S]=!0,s.splice(s.lastIndexOf(w),1),r(m,u,v);w.geometry=v,w.distanceSq=y}}else{if(y===0)return h[S]=!0,r(m,u,v);s.push(h[S]={feature:m,layer:u,geometry:v,distanceSq:y,callback:r})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,d,g?e.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const r=t.viewHints[Xn.ANIMATING],s=t.viewHints[Xn.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=t.extent,h=t.viewState,d=h.projection,g=h.resolution,m=t.pixelRatio,v=e.getRevision(),y=e.getRenderBuffer();let S=e.getRenderOrder();S===void 0&&(S=D6);const w=h.center.slice(),R=Cf(u,y*g),P=R.slice(),M=[R.slice()],L=d.getExtent();if(i.getWrapX()&&d.canWrapX()&&!Ud(L,t.extent)){const ut=ue(L),wt=Math.max(ue(R)/2,ut);R[0]=L[0]-wt,R[2]=L[2]+wt,ZM(w,d);const yt=HM(M[0],d);yt[0]<L[0]&&yt[2]<L[2]?M.push([yt[0]+ut,yt[1],yt[2]+ut,yt[3]]):yt[0]>L[0]&&yt[2]>L[2]&&M.push([yt[0]-ut,yt[1],yt[2]-ut,yt[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==v&&this.renderedRenderOrder_==S&&this.renderedFrameDeclutter_===!!t.declutter&&Ud(this.wrappedRenderedExtent_,R))return $a(this.renderedExtent_,P)||(this.hitDetectionImageData_=null,this.renderedExtent_=P),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new d8(Cb(g,m),R,g,m);let j;for(let ut=0,wt=M.length;ut<wt;++ut)i.loadFeatures(M[ut],g,d);const b=rA(g,m);let A=!0;const k=(ut,wt)=>{let yt;const dt=ut.getStyleFunction()||e.getStyleFunction();if(dt&&(yt=dt(ut,g)),yt){const J=this.renderFeature(ut,b,yt,D,j,this.getLayer().getDeclutter(),wt);A=A&&!J}},V=ob(R),F=i.getFeaturesInExtent(V);S&&F.sort(S);for(let ut=0,wt=F.length;ut<wt;++ut)k(F[ut],ut);this.renderedFeatures_=F,this.ready=A;const U=D.finish(),N=new y8(R,g,m,i.getOverlaps(),U,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=g,this.renderedRevision_=v,this.renderedRenderOrder_=S,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=P,this.wrappedRenderedExtent_=R,this.renderedCenter_=w,this.renderedProjection_=d,this.renderedPixelRatio_=m,this.replayGroup_=N,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,r,s,o,a){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,d=i.length;h<d;++h)u=sA(r,t,i[h],e,this.boundHandleStyleImageChange_,s,o,a)||u;else u=sA(r,t,i,e,this.boundHandleStyleImageChange_,s,o,a);return u}}let vu=0;const li=1<<vu++,ne=1<<vu++,Ii=1<<vu++,zr=1<<vu++,nu=1<<vu++,Bd=1<<vu++,dp=Math.pow(2,vu)-1,rx={[li]:"boolean",[ne]:"number",[Ii]:"string",[zr]:"color",[nu]:"number[]",[Bd]:"size"},A8=Object.keys(rx).map(Number).sort(co);function R8(n){return n in rx}function $d(n){const t=[];for(const e of A8)Wd(n,e)&&t.push(rx[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Wd(n,t){return(n&t)===t}function ea(n,t){return n===t}class fn{constructor(t,e){if(!R8(t))throw new Error(`literal expressions must have a specific type, got ${$d(t)}`);this.type=t,this.value=e}}class P8{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function $b(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Gn(n,t,e){switch(typeof n){case"boolean":{if(ea(t,Ii))return new fn(Ii,n?"true":"false");if(!Wd(t,li))throw new Error(`got a boolean, but expected ${$d(t)}`);return new fn(li,n)}case"number":{if(ea(t,Bd))return new fn(Bd,Ci(n));if(ea(t,li))return new fn(li,!!n);if(ea(t,Ii))return new fn(Ii,n.toString());if(!Wd(t,ne))throw new Error(`got a number, but expected ${$d(t)}`);return new fn(ne,n)}case"string":{if(ea(t,zr))return new fn(zr,Zw(n));if(ea(t,li))return new fn(li,!!n);if(!Wd(t,Ii))throw new Error(`got a string, but expected ${$d(t)}`);return new fn(Ii,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return G8(n,t,e);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(ea(t,Bd)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new fn(Bd,n)}if(ea(t,zr)){if(n.length===3)return new fn(zr,[...n,1]);if(n.length===4)return new fn(zr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Wd(t,nu))throw new Error(`got an array of numbers, but expected ${$d(t)}`);return new fn(nu,n)}const et={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},C8={[et.Get]:Gt(Ht(1,1/0),EA),[et.Var]:Gt(Ht(1,1),M8),[et.Has]:Gt(Ht(1,1/0),EA),[et.Id]:Gt(b8,fc),[et.Concat]:Gt(Ht(2,1/0),de(Ii)),[et.GeometryType]:Gt(k8,fc),[et.LineMetric]:Gt(fc),[et.Resolution]:Gt(r1,fc),[et.Zoom]:Gt(r1,fc),[et.Time]:Gt(r1,fc),[et.Any]:Gt(Ht(2,1/0),de(li)),[et.All]:Gt(Ht(2,1/0),de(li)),[et.Not]:Gt(Ht(1,1),de(li)),[et.Equal]:Gt(Ht(2,2),de(dp)),[et.NotEqual]:Gt(Ht(2,2),de(dp)),[et.GreaterThan]:Gt(Ht(2,2),de(ne)),[et.GreaterThanOrEqualTo]:Gt(Ht(2,2),de(ne)),[et.LessThan]:Gt(Ht(2,2),de(ne)),[et.LessThanOrEqualTo]:Gt(Ht(2,2),de(ne)),[et.Multiply]:Gt(Ht(2,1/0),wA),[et.Coalesce]:Gt(Ht(2,1/0),wA),[et.Divide]:Gt(Ht(2,2),de(ne)),[et.Add]:Gt(Ht(2,1/0),de(ne)),[et.Subtract]:Gt(Ht(2,2),de(ne)),[et.Clamp]:Gt(Ht(3,3),de(ne)),[et.Mod]:Gt(Ht(2,2),de(ne)),[et.Pow]:Gt(Ht(2,2),de(ne)),[et.Abs]:Gt(Ht(1,1),de(ne)),[et.Floor]:Gt(Ht(1,1),de(ne)),[et.Ceil]:Gt(Ht(1,1),de(ne)),[et.Round]:Gt(Ht(1,1),de(ne)),[et.Sin]:Gt(Ht(1,1),de(ne)),[et.Cos]:Gt(Ht(1,1),de(ne)),[et.Atan]:Gt(Ht(1,2),de(ne)),[et.Sqrt]:Gt(Ht(1,1),de(ne)),[et.Match]:Gt(Ht(4,1/0),xA,D8),[et.Between]:Gt(Ht(3,3),de(ne)),[et.Interpolate]:Gt(Ht(6,1/0),xA,N8),[et.Case]:Gt(Ht(3,1/0),L8,O8),[et.In]:Gt(Ht(2,2),V8),[et.Number]:Gt(Ht(1,1/0),de(dp)),[et.String]:Gt(Ht(1,1/0),de(dp)),[et.Array]:Gt(Ht(1,1/0),de(ne)),[et.Color]:Gt(Ht(1,4),de(ne)),[et.Band]:Gt(Ht(1,3),de(ne)),[et.Palette]:Gt(Ht(2,2),F8),[et.ToString]:Gt(Ht(1,1),de(li|ne|Ii|zr))};function EA(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new fn(ne,o);break}case"string":{r[s]=new fn(Ii,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&e.properties.add(String(o))}return r}function M8(n,t,e){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new fn(Ii,i)]}function b8(n,t,e){e.featureId=!0}function k8(n,t,e){e.geometryType=!0}function r1(n,t,e){e.mapState=!0}function fc(n,t,e){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ht(n,t){return function(e,i,r){const s=e[0],o=e.length-1;if(n===t){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>t){const a=t===1/0?`${n} or more`:`${n} to ${t}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function wA(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Gn(n[s+1],t,e);r[s]=o}return r}function de(n){return function(t,e,i){const r=t.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Gn(t[o+1],n,i);s[o]=a}return s}}function L8(n,t,e){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function xA(n,t,e){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function D8(n,t,e){const i=n.length-1,r=Ii|ne|li,s=Gn(n[1],r,e),o=Gn(n[n.length-1],t,e),a=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=Gn(n[u+2],s.type,e);a[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Gn(n[u+3],o.type,e);a[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...a,o]}function N8(n,t,e){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new fn(ne,r);let o;try{o=Gn(n[2],ne,e)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const a=new Array(n.length-3);for(let u=0;u<a.length;u+=2){try{const h=Gn(n[u+3],ne,e);a[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Gn(n[u+4],t,e);a[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...a]}function O8(n,t,e){const i=Gn(n[n.length-1],t,e),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Gn(n[s+1],li,e);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Gn(n[s+2],i.type,e);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function V8(n,t,e){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Ii}else r=ne;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const u=Gn(i[a],r,e);s[a]=u}catch(u){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${u.message}`)}return[Gn(n[1],r,e),...s]}function F8(n,t,e){let i;try{i=Gn(n[1],ne,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Gn(r[o],zr,e)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(a instanceof fn))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function Gt(...n){return function(t,e,i){const r=t[0];let s;for(let o=0;o<n.length;o++){const a=n[o](t,e,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new P8(e,r,...s)}}function G8(n,t,e){const i=n[0],r=C8[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,t,e)}function Wb(n){if(!n)return"";const t=n.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Wb(n.getGeometries()[0]);default:return""}}function Kb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Io(n,t,e){const i=Gn(n,t,e);return Xr(i)}function Xr(n,t){if(n instanceof fn){if(n.type===zr&&typeof n.value=="string"){const i=Zw(n.value);return function(){return i}}return function(){return n.value}}const e=n.operator;switch(e){case et.Number:case et.String:case et.Coalesce:return U8(n);case et.Get:case et.Var:case et.Has:return j8(n);case et.Id:return i=>i.featureId;case et.GeometryType:return i=>i.geometryType;case et.Concat:{const i=n.args.map(r=>Xr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case et.Resolution:return i=>i.resolution;case et.Any:case et.All:case et.Between:case et.In:case et.Not:return B8(n);case et.Equal:case et.NotEqual:case et.LessThan:case et.LessThanOrEqualTo:case et.GreaterThan:case et.GreaterThanOrEqualTo:return z8(n);case et.Multiply:case et.Divide:case et.Add:case et.Subtract:case et.Clamp:case et.Mod:case et.Pow:case et.Abs:case et.Floor:case et.Ceil:case et.Round:case et.Sin:case et.Cos:case et.Atan:case et.Sqrt:return $8(n);case et.Case:return W8(n);case et.Match:return K8(n);case et.Interpolate:return q8(n);case et.ToString:return H8(n);default:throw new Error(`Unsupported operator ${e}`)}}function U8(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Xr(n.args[s]);switch(e){case et.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case et.Number:case et.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function j8(n,t){const i=n.args[0].value;switch(n.operator){case et.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,u=s.length;a<u;++a){const d=s[a].value;o=o[d]}return o};case et.Var:return r=>r.variables[i];case et.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,u=s.length;a<u;++a){const d=s[a].value;if(!o||!Object.hasOwn(o,d))return!1;o=o[d]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function z8(n,t){const e=n.operator,i=Xr(n.args[0]),r=Xr(n.args[1]);switch(e){case et.Equal:return s=>i(s)===r(s);case et.NotEqual:return s=>i(s)!==r(s);case et.LessThan:return s=>i(s)<r(s);case et.LessThanOrEqualTo:return s=>i(s)<=r(s);case et.GreaterThan:return s=>i(s)>r(s);case et.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function B8(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Xr(n.args[s]);switch(e){case et.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case et.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case et.Between:return s=>{const o=r[0](s),a=r[1](s),u=r[2](s);return o>=a&&o<=u};case et.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case et.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function $8(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Xr(n.args[s]);switch(e){case et.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case et.Divide:return s=>r[0](s)/r[1](s);case et.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case et.Subtract:return s=>r[0](s)-r[1](s);case et.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const u=r[2](s);return o>u?u:o};case et.Mod:return s=>r[0](s)%r[1](s);case et.Pow:return s=>Math.pow(r[0](s),r[1](s));case et.Abs:return s=>Math.abs(r[0](s));case et.Floor:return s=>Math.floor(r[0](s));case et.Ceil:return s=>Math.ceil(r[0](s));case et.Round:return s=>Math.round(r[0](s));case et.Sin:return s=>Math.sin(r[0](s));case et.Cos:return s=>Math.cos(r[0](s));case et.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case et.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function W8(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Xr(n.args[r]);return r=>{for(let s=0;s<e-1;s+=2)if(i[s](r))return i[s+1](r);return i[e-1](r)}}function K8(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Xr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<e-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[e-1](r)}}function q8(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Xr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,u;for(let h=2;h<e;h+=2){const d=i[h](r);let g=i[h+1](r);const m=Array.isArray(g);if(m&&(g=y6(g)),d>=o)return h===2?g:m?X8(s,o,a,u,d,g):Kd(s,o,a,u,d,g);a=d,u=g}return u}}function H8(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Xr(n.args[s]);switch(e){case et.ToString:return s=>{const o=r[0](s);return n.args[0].type===zr?Qw(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function Kd(n,t,e,i,r,s){const o=r-e;if(o===0)return i;const a=t-e,u=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function X8(n,t,e,i,r,s){if(r-e===0)return i;const a=J2(i),u=J2(s);let h=u[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const d=[Kd(n,t,e,a[0],r,u[0]),Kd(n,t,e,a[1],r,u[1]),a[2]+Kd(n,t,e,0,r,h),Kd(n,t,e,i[3],r,s[3])];return v6(d)}function Y8(n){return!0}function Z8(n){const t=$b(),e=Q8(n,t),i=Kb();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,t.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return t.geometryType&&(i.geometryType=Wb(r.getGeometry())),e(i)}}function TA(n){const t=$b(),e=n.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=fE(n[o],t);const r=Kb(),s=new Array(e);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,t.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<e;++h){const d=i[h](r);d&&(s[u]=d,u+=1)}return s.length=u,s}}function Q8(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r){const s=n[r],o="filter"in s?Io(s.filter,li,t):Y8;let a;if(Array.isArray(s.style)){const u=s.style.length;a=new Array(u);for(let h=0;h<u;++h)a[h]=fE(s.style[h],t)}else a=[fE(s.style,t)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<e;++a){const u=i[a].filter;if(u(r)&&!(n[a].else&&o)){o=!0;for(const h of i[a].styles){const d=h(r);d&&s.push(d)}}}return s}}function fE(n,t){const e=Vf(n,"",t),i=Ff(n,"",t),r=J8(n,t),s=tV(n,t),o=Ri(n,"z-index",t);if(!e&&!i&&!r&&!s&&!rh(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Tr;return function(u){let h=!0;if(e){const d=e(u);d&&(h=!1),a.setFill(d)}if(i){const d=i(u);d&&(h=!1),a.setStroke(d)}if(r){const d=r(u);d&&(h=!1),a.setText(d)}if(s){const d=s(u);d&&(h=!1),a.setImage(d)}return o&&a.setZIndex(o(u)),h?null:a}}function Vf(n,t,e){let i;if(t+"fill-pattern-src"in n)i=rV(n,t+"fill-",e);else{if(n[t+"fill-color"]==="none")return s=>null;i=sx(n,t+"fill-color",e)}if(!i)return null;const r=new La;return function(s){const o=i(s);return o===Yw?null:(r.setColor(o),r)}}function Ff(n,t,e){const i=Ri(n,t+"stroke-width",e),r=sx(n,t+"stroke-color",e);if(!i&&!r)return null;const s=so(n,t+"stroke-line-cap",e),o=so(n,t+"stroke-line-join",e),a=qb(n,t+"stroke-line-dash",e),u=Ri(n,t+"stroke-line-dash-offset",e),h=Ri(n,t+"stroke-miter-limit",e),d=new Ia;return function(g){if(r){const m=r(g);if(m===Yw)return null;d.setColor(m)}if(i&&d.setWidth(i(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");d.setLineCap(m)}if(o){const m=o(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");d.setLineJoin(m)}return a&&d.setLineDash(a(g)),u&&d.setLineDashOffset(u(g)),h&&d.setMiterLimit(h(g)),d}}function J8(n,t){const e="text-",i=so(n,e+"value",t);if(!i)return null;const r=Vf(n,e,t),s=Vf(n,e+"background-",t),o=Ff(n,e,t),a=Ff(n,e+"background-",t),u=so(n,e+"font",t),h=Ri(n,e+"max-angle",t),d=Ri(n,e+"offset-x",t),g=Ri(n,e+"offset-y",t),m=qc(n,e+"overflow",t),v=so(n,e+"placement",t),y=Ri(n,e+"repeat",t),S=C_(n,e+"scale",t),w=qc(n,e+"rotate-with-view",t),R=Ri(n,e+"rotation",t),P=so(n,e+"align",t),M=so(n,e+"justify",t),L=so(n,e+"baseline",t),D=qc(n,e+"keep-upright",t),j=qb(n,e+"padding",t),b=M_(n,e+"declutter-mode"),A=new nx({declutterMode:b});return function(k){if(A.setText(i(k)),r&&A.setFill(r(k)),s&&A.setBackgroundFill(s(k)),o&&A.setStroke(o(k)),a&&A.setBackgroundStroke(a(k)),u&&A.setFont(u(k)),h&&A.setMaxAngle(h(k)),d&&A.setOffsetX(d(k)),g&&A.setOffsetY(g(k)),m&&A.setOverflow(m(k)),v){const V=v(k);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(V)}if(y&&A.setRepeat(y(k)),S&&A.setScale(S(k)),w&&A.setRotateWithView(w(k)),R&&A.setRotation(R(k)),P){const V=P(k);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(V)}if(M){const V=M(k);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(V)}if(L){const V=L(k);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(V)}return j&&A.setPadding(j(k)),D&&A.setKeepUpright(D(k)),A}}function tV(n,t){return"icon-src"in n?eV(n,t):"shape-points"in n?nV(n,t):"circle-radius"in n?iV(n,t):null}function eV(n,t){const e="icon-",i=e+"src",r=Hb(n[i],i),s=_0(n,e+"anchor",t),o=C_(n,e+"scale",t),a=Ri(n,e+"opacity",t),u=_0(n,e+"displacement",t),h=Ri(n,e+"rotation",t),d=qc(n,e+"rotate-with-view",t),g=IA(n,e+"anchor-origin"),m=AA(n,e+"anchor-x-units"),v=AA(n,e+"anchor-y-units"),y=lV(n,e+"color"),S=oV(n,e+"cross-origin"),w=aV(n,e+"offset"),R=IA(n,e+"offset-origin"),P=y0(n,e+"width"),M=y0(n,e+"height"),L=sV(n,e+"size"),D=M_(n,e+"declutter-mode"),j=new ix({src:r,anchorOrigin:g,anchorXUnits:m,anchorYUnits:v,color:y,crossOrigin:S,offset:w,offsetOrigin:R,height:M,width:P,size:L,declutterMode:D});return function(b){return a&&j.setOpacity(a(b)),u&&j.setDisplacement(u(b)),h&&j.setRotation(h(b)),d&&j.setRotateWithView(d(b)),o&&j.setScale(o(b)),s&&j.setAnchor(s(b)),j}}function nV(n,t){const e="shape-",i=e+"points",r=e+"radius",s=gE(n[i],i),o=gE(n[r],r),a=Vf(n,e,t),u=Ff(n,e,t),h=C_(n,e+"scale",t),d=_0(n,e+"displacement",t),g=Ri(n,e+"rotation",t),m=qc(n,e+"rotate-with-view",t),v=y0(n,e+"radius2"),y=y0(n,e+"angle"),S=M_(n,e+"declutter-mode"),w=new P_({points:s,radius:o,radius2:v,angle:y,declutterMode:S});return function(R){return a&&w.setFill(a(R)),u&&w.setStroke(u(R)),d&&w.setDisplacement(d(R)),g&&w.setRotation(g(R)),m&&w.setRotateWithView(m(R)),h&&w.setScale(h(R)),w}}function iV(n,t){const e="circle-",i=Vf(n,e,t),r=Ff(n,e,t),s=Ri(n,e+"radius",t),o=C_(n,e+"scale",t),a=_0(n,e+"displacement",t),u=Ri(n,e+"rotation",t),h=qc(n,e+"rotate-with-view",t),d=M_(n,e+"declutter-mode"),g=new Ch({radius:5,declutterMode:d});return function(m){return s&&g.setRadius(s(m)),i&&g.setFill(i(m)),r&&g.setStroke(r(m)),a&&g.setDisplacement(a(m)),u&&g.setRotation(u(m)),h&&g.setRotateWithView(h(m)),o&&g.setScale(o(m)),g}}function Ri(n,t,e){if(!(t in n))return;const i=Io(n[t],ne,e);return function(r){return gE(i(r),t)}}function so(n,t,e){if(!(t in n))return null;const i=Io(n[t],Ii,e);return function(r){return Hb(i(r),t)}}function rV(n,t,e){const i=so(n,t+"pattern-src",e),r=SA(n,t+"pattern-offset",e),s=SA(n,t+"pattern-size",e),o=sx(n,t+"color",e);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function qc(n,t,e){if(!(t in n))return null;const i=Io(n[t],li,e);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function sx(n,t,e){if(!(t in n))return null;const i=Io(n[t],zr,e);return function(r){return Xb(i(r),t)}}function qb(n,t,e){if(!(t in n))return null;const i=Io(n[t],nu,e);return function(r){return Eg(i(r),t)}}function _0(n,t,e){if(!(t in n))return null;const i=Io(n[t],nu,e);return function(r){const s=Eg(i(r),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function SA(n,t,e){if(!(t in n))return null;const i=Io(n[t],nu,e);return function(r){return Yb(i(r),t)}}function C_(n,t,e){if(!(t in n))return null;const i=Io(n[t],nu|ne,e);return function(r){return uV(i(r),t)}}function y0(n,t){const e=n[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function sV(n,t){const e=n[t];if(e!==void 0){if(typeof e=="number")return Ci(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function oV(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function IA(n,t){const e=n[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function AA(n,t){const e=n[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function aV(n,t){const e=n[t];if(e!==void 0)return Eg(e,t)}function M_(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function lV(n,t){const e=n[t];if(e!==void 0)return Xb(e,t)}function Eg(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);const e=n.length;for(let i=0;i<e;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return n}function Hb(n,t){if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function gE(n,t){if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function Xb(n,t){if(typeof n=="string")return n;const e=Eg(n,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function Yb(n,t){const e=Eg(n,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function uV(n,t){return typeof n=="number"?n:Yb(n,t)}const Vr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function RA(n,t,e){return(function(i,r,s,o,a){if(!i)return;if(!r&&!t)return i;const u=t?0:s[0]*r,h=t?0:s[1]*r,d=a?a[0]:0,g=a?a[1]:0;let m=n[0]+u/2+d,v=n[2]-u/2+d,y=n[1]+h/2+g,S=n[3]-h/2+g;m>v&&(m=(v+m)/2,v=m),y>S&&(y=(S+y)/2,S=y);let w=ke(i[0],m,v),R=ke(i[1],y,S);if(o&&e&&r){const P=30*r;w+=-P*Math.log(1+Math.max(0,m-i[0])/P)+P*Math.log(1+Math.max(0,i[0]-v)/P),R+=-P*Math.log(1+Math.max(0,y-i[1])/P)+P*Math.log(1+Math.max(0,i[1]-S)/P)}return[w,R]})}function cV(n){return n}function Zb(n){return Math.pow(n,3)}function Mh(n){return 1-Zb(1-n)}function hV(n){return 3*n*n-2*n*n*n}function dV(n){return n}function ox(n,t,e,i){const r=ue(t)/e[0],s=Jn(t)/e[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function ax(n,t,e){let i=Math.min(n,t);const r=50;return i*=Math.log(1+r*Math.max(0,n/t-1))/r+1,e&&(i=Math.max(i,e),i/=Math.log(1+r*Math.max(0,e/n-1))/r+1),ke(i,e/2,t*2)}function fV(n,t,e,i){return t=t!==void 0?t:!0,(function(r,s,o,a){if(r!==void 0){const u=n[0],h=n[n.length-1],d=e?ox(u,e,o,i):u;if(a)return t?ax(r,d,h):ke(r,h,d);const g=Math.min(d,r),m=Math.floor(Lw(n,g,s));return n[m]>d&&m<n.length-1?n[m+1]:n[m]}})}function gV(n,t,e,i,r,s){return i=i!==void 0?i:!0,e=e!==void 0?e:0,(function(o,a,u,h){if(o!==void 0){const d=r?ox(t,r,u,s):t;if(h)return i?ax(o,d,e):ke(o,e,d);const g=1e-9,m=Math.ceil(Math.log(t/d)/Math.log(n)-g),v=-a*(.5-g)+.5,y=Math.min(d,o),S=Math.floor(Math.log(t/y)/Math.log(n)+v),w=Math.max(m,S),R=t/Math.pow(n,w);return ke(R,e,d)}})}function PA(n,t,e,i,r){return e=e!==void 0?e:!0,(function(s,o,a,u){if(s!==void 0){const h=i?ox(n,i,a,r):n;return!e||!u?ke(s,t,h):ax(s,h,t)}})}function lx(n){if(n!==void 0)return 0}function CA(n){if(n!==void 0)return n}function mV(n){const t=2*Math.PI/n;return(function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e})}function pV(n){const t=xa(5);return(function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e})}const _V=42,ux=256,s1=0;class ws extends Ns{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=zw(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&sb(),t.center&&(t.center=ro(t.center,this.projection_)),t.extent&&(t.extent=_a(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in Vr)delete e[a];this.setProperties(e,!0);const i=vV(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const r=yV(t),s=i.constraint,o=EV(t);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-e[3]+e[1]-r[1]),a=s/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=ro(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=ro(r.anchor,this.getProjection())),e[i]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){const d=arguments[r];d.center&&this.setCenterInternal(d.center),d.zoom!==void 0?this.setZoom(d.zoom):d.resolution&&this.setResolution(d.resolution),d.rotation!==void 0&&this.setRotation(d.rotation)}if(r===e){i&&fp(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<e;++r){const d=arguments[r],g={start:s,complete:!1,anchor:d.anchor,duration:d.duration!==void 0?d.duration:1e3,easing:d.easing||hV,callback:i};if(d.center&&(g.sourceCenter=o,g.targetCenter=d.center.slice(),o=g.targetCenter),d.zoom!==void 0?(g.sourceResolution=a,g.targetResolution=this.getResolutionForZoom(d.zoom),a=g.targetResolution):d.resolution&&(g.sourceResolution=a,g.targetResolution=d.resolution,a=g.targetResolution),d.rotation!==void 0){g.sourceRotation=u;const m=Ta(d.rotation-u+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=u+m,u=g.targetRotation}wV(g)?g.complete=!0:s+=g.duration,h.push(g)}this.animations_.push(h),this.setHint(Xn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Xn.ANIMATING]>0}getInteracting(){return this.hints_[Xn.INTERACTING]>0}cancelAnimations(){this.setHint(Xn.ANIMATING,-this.hints_[Xn.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const r=this.animations_[e];if(r[0].callback&&fp(r[0].callback,!1),!t)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u.complete)continue;const h=t-u.start;let d=u.duration>0?h/u.duration:1;d>=1?(u.complete=!0,d=1):s=!1;const g=u.easing(d);if(u.sourceCenter){const m=u.sourceCenter[0],v=u.sourceCenter[1],y=u.targetCenter[0],S=u.targetCenter[1];this.nextCenter_=u.targetCenter;const w=m+g*(y-m),R=v+g*(S-v);this.targetCenter_=[w,R]}if(u.sourceResolution&&u.targetResolution){const m=g===1?u.targetResolution:u.sourceResolution+g*(u.targetResolution-u.sourceResolution);if(u.anchor){const v=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(m,0,v,!0);this.targetCenter_=this.calculateCenterZoom(y,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const m=g===1?Ta(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+g*(u.targetRotation-u.sourceRotation);if(u.anchor){const v=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(v,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),e=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Xn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&fp(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-e[0],r[1]-e[1]],Ow(i,t-this.getRotation()),m5(i,e)),i}calculateCenterZoom(t,e){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-r[0])/s,a=e[1]-t*(e[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],r=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&sE(t,this.getProjection())}getCenterInternal(){return this.get(Vr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return ob(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();pe(e,"The view center is not defined");const i=this.getResolution();pe(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return pe(r!==void 0,"The view rotation is not defined"),J1(e,i,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Vr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(_a(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=ue(t)/e[0],r=Jn(t)/e[1];return Math.max(i,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(e/i)/Math.log(t);return(function(s){return e/Math.pow(t,s*r)})}getRotation(){return this.get(Vr.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/e;return(function(o){return Math.log(i/o)/e/s})}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=o1(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,i)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,r;if(this.resolutions_){const s=Lw(this.resolutions_,t,1);e=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(i/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const e=ke(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,ke(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(pe(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){pe(!v_(t),"Cannot fit empty extent provided as `geometry`");const r=_a(t,this.getProjection());i=aA(r)}else if(t.getType()==="Circle"){const r=_a(t.getExtent(),this.getProjection());i=aA(r),i.rotate(this.getRotation(),Ql(r))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,u=1/0,h=-1/0,d=-1/0;for(let g=0,m=s.length;g<m;g+=o){const v=s[g]*i-s[g+1]*r,y=s[g]*r+s[g+1]*i;a=Math.min(a,v),u=Math.min(u,y),h=Math.max(h,v),d=Math.max(d,y)}return[a,u,h,d]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const r=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let u=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),d=Math.sin(h),g=Math.cos(h),m=Ql(a);m[0]+=(r[1]-r[3])/2*u,m[1]+=(r[0]-r[2])/2*u;const v=m[0]*g-m[1]*d,y=m[1]*g+m[0]*d,S=this.getConstrainedCenter([v,y],u),w=e.callback?e.callback:Pf;e.duration!==void 0?this.animateInternal({resolution:u,center:S,duration:e.duration,easing:e.easing},w):(this.targetResolution_=u,this.targetCenter_=S,this.applyTargetState_(!1,!0),fp(w,!0))}centerOn(t,e,i){this.centerOnInternal(ro(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(o1(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,r){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),u=o1(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,i);s=[t[0]-u[0],t[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=sE(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&ro(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=ro(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&ro(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Vr.ROTATION)!==r&&this.set(Vr.ROTATION,r),this.get(Vr.RESOLUTION)!==o&&(this.set(Vr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Vr.CENTER)||!o0(this.get(Vr.CENTER),a))&&this.set(Vr.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!o0(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:a,duration:t,easing:Mh,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Xn.INTERACTING,1)}endInteraction(t,e,i){i=i&&ro(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(Xn.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function fp(n,t){setTimeout(function(){n(t)},0)}function yV(n){if(n.extent!==void 0){const e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return RA(n.extent,n.constrainOnlyCenter,e)}const t=zw(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,RA(e,!1,!1)}return cV}function vV(n){let t,e,i,o=n.minZoom!==void 0?n.minZoom:s1,a=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,d=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=zw(n.projection,"EPSG:3857"),v=m.getExtent();let y=n.constrainOnlyCenter,S=n.extent;if(!h&&!S&&m.isGlobal()&&(y=!1,S=v),n.resolutions!==void 0){const w=n.resolutions;e=w[o],i=w[a]!==void 0?w[a]:w[w.length-1],n.constrainResolution?t=fV(w,d,!y&&S,g):t=PA(e,i,d,!y&&S,g)}else{const R=(v?Math.max(ue(v),Jn(v)):360*Vw.degrees/m.getMetersPerUnit())/ux/Math.pow(2,s1),P=R/Math.pow(2,28-s1);e=n.maxResolution,e!==void 0?o=0:e=R/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=e/Math.pow(u,a):i=R/Math.pow(u,a):i=P),a=o+Math.floor(Math.log(e/i)/Math.log(u)),i=e/Math.pow(u,a-o),n.constrainResolution?t=gV(u,e,i,d,!y&&S,g):t=PA(e,i,d,!y&&S,g)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:o,zoomFactor:u}}function EV(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const e=n.constrainRotation;return e===void 0||e===!0?pV():e===!1?CA:typeof e=="number"?mV(e):CA}return lx}function wV(n){return!(n.sourceCenter&&n.targetCenter&&!o0(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function o1(n,t,e,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;a+=(t[0]/2-e[0])*i,u+=(e[1]-t[1]/2)*i,o=-o;const h=a*s-u*o,d=u*s+a*o;return[h,d]}const we={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Qb extends Ns{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[we.OPACITY]=t.opacity!==void 0?t.opacity:1,pe(typeof e[we.OPACITY]=="number","Layer opacity must be a number"),e[we.VISIBLE]=t.visible!==void 0?t.visible:!0,e[we.Z_INDEX]=t.zIndex,e[we.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[we.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[we.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[we.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=ke(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return oe()}getLayerStatesArray(t){return oe()}getExtent(){return this.get(we.EXTENT)}getMaxResolution(){return this.get(we.MAX_RESOLUTION)}getMinResolution(){return this.get(we.MIN_RESOLUTION)}getMinZoom(){return this.get(we.MIN_ZOOM)}getMaxZoom(){return this.get(we.MAX_ZOOM)}getOpacity(){return this.get(we.OPACITY)}getSourceState(){return oe()}getVisible(){return this.get(we.VISIBLE)}getZIndex(){return this.get(we.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(we.EXTENT,t)}setMaxResolution(t){this.set(we.MAX_RESOLUTION,t)}setMinResolution(t){this.set(we.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(we.MAX_ZOOM,t)}setMinZoom(t){this.set(we.MIN_ZOOM,t)}setOpacity(t){pe(typeof t=="number","Layer opacity must be a number"),this.set(we.OPACITY,t)}setVisible(t){this.set(we.VISIBLE,t)}setZIndex(t){this.set(we.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class b_ extends Qb{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(we.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(we.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Fe(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=ae(t,qt.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof ws?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(e.layerStatesArray){if(r=e.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return cx(r,e.viewState)&&(!s||Ai(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];const i=t instanceof ws?t.getViewStateAndExtent():t;let r=e(i);return Array.isArray(r)||(r=[r]),r}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(we.MAP,t)}getMapInternal(){return this.get(we.MAP)}setMap(t){this.mapPrecomposeKey_&&(Fe(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Fe(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=ae(t,vr.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=ae(this,qt.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);pe(!e.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(we.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function cx(n,t){if(!n.visible)return!1;const e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;const i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}const MA={RENDER_ORDER:"renderOrder"};class Jb extends b_{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(MA.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new Nb(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(MA.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?Fb:t;const e=xV(t);this.styleFunction_=t===null?void 0:r8(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function xV(n){if(n===void 0)return Fb;if(!n)return null;if(typeof n=="function"||n instanceof Tr)return n;if(!Array.isArray(n))return TA([n]);if(n.length===0)return[];const t=n.length,e=n[0];if(e instanceof Tr){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!(o instanceof Tr))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in e){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return Z8(r)}return TA(n)}class t4 extends Jb{constructor(t){super(t)}createRenderer(){return new I8(this)}}const na={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class ha extends So{constructor(t,e){super(t),this.layer=e}}const a1={LAYERS:"layers"};let k_=class e4 extends Qb{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(a1.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new yr(i.slice(),{unique:!0}):pe(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new yr(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Fe),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(ae(t,Ti.ADD,this.handleLayersAdd_,this),ae(t,Ti.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Fe);fg(this.listenerKeys_);const e=t.getArray();for(let i=0,r=e.length;i<r;i++){const s=e[i];this.registerLayerListeners_(s),this.dispatchEvent(new ha(na.ADDLAYER,s))}this.changed()}registerLayerListeners_(t){const e=[ae(t,ih.PROPERTYCHANGE,this.handleLayerChange_,this),ae(t,qt.CHANGE,this.handleLayerChange_,this)];t instanceof e4&&e.push(ae(t,na.ADDLAYER,this.handleLayerGroupAdd_,this),ae(t,na.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[le(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new ha(na.ADDLAYER,t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new ha(na.REMOVELAYER,t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new ha(na.ADDLAYER,e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=le(e);this.listenerKeys_[i].forEach(Fe),delete this.listenerKeys_[i],this.dispatchEvent(new ha(na.REMOVELAYER,e)),this.changed()}getLayers(){return this.get(a1.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new ha(na.REMOVELAYER,i[r]))}this.set(a1.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&r.zIndex===void 0&&(s=0);for(let o=i,a=e.length;o<a;o++){const u=e[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=Kl(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return e}getSourceState(){return"ready"}};const kt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class hx extends gg{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(qt.CHANGE)}release(){this.setState(kt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==kt.EMPTY){if(this.state!==kt.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){oe()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;const r=e-i+1e3/60;return r>=this.transition_?1:Zb(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function mE(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const TV=new Error("disposed"),SV=[256,256];class bA extends hx{constructor(t){const e=kt.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=mE(this.data_);return t?[t.width,t.height]:SV}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==kt.IDLE&&this.state!==kt.ERROR)return;this.state=kt.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=kt.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=kt.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(TV),this.controller_=null),super.disposeInternal()}}class n4 extends hx{constructor(t,e,i,r,s,o){super(t,e,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,$i?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=kt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=kt.ERROR,this.unlistenImage_(),this.image_=IV(),this.changed()}handleImageLoad_(){if($i)this.state=kt.LOADED;else{const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=kt.LOADED:this.state=kt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==kt.ERROR&&(this.state=kt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==kt.IDLE&&(this.state=kt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=E6(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function IV(){const n=mn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let l1;const Hc=[];function kA(n,t,e,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,i)+1,Math.max(e,r)),n.restore()}function u1(n,t){return Math.abs(n[t*4]-210)>2||Math.abs(n[t*4+3]-.75*255)>2}function AV(){if(l1===void 0){const n=mn(6,6,Hc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",kA(n,4,5,4,0),kA(n,4,5,0,5);const t=n.getImageData(0,0,3,3).data;l1=u1(t,0)||u1(t,4)||u1(t,8),I_(n),Hc.push(n.canvas)}return l1}function pE(n,t,e,i){const r=yg(e,t,n);let s=K2(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const u=n.getExtent();if(!u||sh(u,r)){const h=K2(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function RV(n,t,e,i){const r=Ql(e);let s=pE(n,t,r,i);return(!isFinite(s)||s<=0)&&KM(e,function(o){return s=pE(n,t,o,i),isFinite(s)&&s>0}),s}function PV(n,t,e,i,r,s,o,a,u,h,d,g,m,v){const y=mn(Math.round(e*n),Math.round(e*t),Hc);if(g||(y.imageSmoothingEnabled=!1),u.length===0)return y.canvas;y.scale(e,e);function S(D){return Math.round(D*e)/e}y.globalCompositeOperation="lighter";const w=Hi();u.forEach(function(D,j,b){l5(w,D.extent)});let R;const P=e/i,M=(g?1:1+Math.pow(2,-24))/P;(!m||u.length!==1||h!==0)&&(R=mn(Math.round(ue(w)*P),Math.round(Jn(w)*P),Hc),g||(R.imageSmoothingEnabled=!1),u.forEach(function(D,j,b){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){R.save();const U=(D.clipExtent[0]-w[0])*P,N=-(D.clipExtent[3]-w[3])*P,ut=ue(D.clipExtent)*P,wt=Jn(D.clipExtent)*P;R.rect(g?U:Math.round(U),g?N:Math.round(N),g?ut:Math.round(U+ut)-Math.round(U),g?wt:Math.round(N+wt)-Math.round(N)),R.clip()}const A=(D.extent[0]-w[0])*P,k=-(D.extent[3]-w[3])*P,V=ue(D.extent)*P,F=Jn(D.extent)*P;R.drawImage(D.image,h,h,D.image.width-2*h,D.image.height-2*h,g?A:Math.round(A),g?k:Math.round(k),g?V:Math.round(A+V)-Math.round(A),g?F:Math.round(k+F)-Math.round(k)),D.clipExtent&&R.restore()}}));const L=yu(o);return a.getTriangles().forEach(function(D,j,b){const A=D.source,k=D.target;let V=A[0][0],F=A[0][1],U=A[1][0],N=A[1][1],ut=A[2][0],wt=A[2][1];const yt=S((k[0][0]-L[0])/s),dt=S(-(k[0][1]-L[1])/s),J=S((k[1][0]-L[0])/s),at=S(-(k[1][1]-L[1])/s),it=S((k[2][0]-L[0])/s),$=S(-(k[2][1]-L[1])/s),K=V,At=F;V=0,F=0,U-=K,N-=At,ut-=K,wt-=At;const Rt=[[U,N,0,0,J-yt],[ut,wt,0,0,it-yt],[0,0,U,N,at-dt],[0,0,ut,wt,$-dt]],Pt=g5(Rt);if(!Pt)return;if(y.save(),y.beginPath(),AV()||!g){y.moveTo(J,at);const Vt=4,$t=yt-J,Xt=dt-at;for(let ye=0;ye<Vt;ye++)y.lineTo(J+S((ye+1)*$t/Vt),at+S(ye*Xt/(Vt-1))),ye!=Vt-1&&y.lineTo(J+S((ye+1)*$t/Vt),at+S((ye+1)*Xt/(Vt-1)));y.lineTo(it,$)}else y.moveTo(J,at),y.lineTo(yt,dt),y.lineTo(it,$);y.clip(),y.transform(Pt[0],Pt[2],Pt[1],Pt[3],yt,dt),y.translate(w[0]-K,w[3]-At);let Nt;if(R)Nt=R.canvas,y.scale(M,-M);else{const Vt=u[0],$t=Vt.extent;Nt=Vt.image,y.scale(ue($t)/Nt.width,-Jn($t)/Nt.height)}y.drawImage(Nt,0,0),y.restore()}),R&&(I_(R),Hc.push(R.canvas)),d&&(y.save(),y.globalCompositeOperation="source-over",y.strokeStyle="black",y.lineWidth=1,a.getTriangles().forEach(function(D,j,b){const A=D.target,k=(A[0][0]-L[0])/s,V=-(A[0][1]-L[1])/s,F=(A[1][0]-L[0])/s,U=-(A[1][1]-L[1])/s,N=(A[2][0]-L[0])/s,ut=-(A[2][1]-L[1])/s;y.beginPath(),y.moveTo(F,U),y.lineTo(k,V),y.lineTo(N,ut),y.closePath(),y.stroke()}),y.restore()),y.canvas}const CV=10,LA=.25;class MV{constructor(t,e,i,r,s,o,a){this.sourceProj_=t,this.targetProj_=e;let u={};const h=a?rE(M=>In(a,yg(M,this.targetProj_,this.sourceProj_))):u0(this.targetProj_,this.sourceProj_);this.transformInv_=function(M){const L=M[0]+"/"+M[1];return u[L]||(u[L]=h(M)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ue(r)>=ue(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ue(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ue(this.targetProj_.getExtent()):null;const d=yu(i),g=y_(i),m=__(i),v=p_(i),y=this.transformInv_(d),S=this.transformInv_(g),w=this.transformInv_(m),R=this.transformInv_(v),P=CV+(o?Math.max(0,Math.ceil(Math.log2(Q1(i)/(o*o*256*256)))):0);if(this.addQuad_(d,g,m,v,y,S,w,R,P),this.wrapsXInSource_){let M=1/0;this.triangles_.forEach(function(L,D,j){M=Math.min(M,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-M>this.sourceWorldWidth_/2){const D=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];D[0][0]-M>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-M>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-M>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const j=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-j<this.sourceWorldWidth_/2&&(L.source=D)}})}u={}}addTriangle_(t,e,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[t,e,i]})}addQuad_(t,e,i,r,s,o,a,u,h){const d=N2([s,o,a,u]),g=this.sourceWorldWidth_?ue(d)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&g>.5&&g<1;let y=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=N2([t,e,i,r]);y=ue(w)/this.targetWorldWidth_>LA||y}!v&&this.sourceProj_.isGlobal()&&g&&(y=g>LA||y)}if(!y&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!Ai(d,this.maxSourceExtent_))return;let S=0;if(!y&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)y=!0;else if(S=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),S!=1&&S!=2&&S!=4&&S!=8)return}if(h>0){if(!y){const w=[(t[0]+i[0])/2,(t[1]+i[1])/2],R=this.transformInv_(w);let P;v?P=(Ta(s[0],m)+Ta(a[0],m))/2-Ta(R[0],m):P=(s[0]+a[0])/2-R[0];const M=(s[1]+a[1])/2-R[1];y=P*P+M*M>this.errorThresholdSquared_}if(y){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const w=[(e[0]+i[0])/2,(e[1]+i[1])/2],R=this.transformInv_(w),P=[(r[0]+t[0])/2,(r[1]+t[1])/2],M=this.transformInv_(P);this.addQuad_(t,e,w,P,s,o,R,M,h-1),this.addQuad_(P,w,i,r,M,R,a,u,h-1)}else{const w=[(t[0]+e[0])/2,(t[1]+e[1])/2],R=this.transformInv_(w),P=[(i[0]+r[0])/2,(i[1]+r[1])/2],M=this.transformInv_(P);this.addQuad_(t,w,P,r,s,R,M,u,h-1),this.addQuad_(w,e,i,P,R,o,a,M,h-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(S&11)==0&&this.addTriangle_(t,i,r,s,a,u),(S&14)==0&&this.addTriangle_(t,i,e,s,a,o),S&&((S&13)==0&&this.addTriangle_(e,r,t,o,u,s),(S&7)==0&&this.addTriangle_(e,r,i,o,u,a))}calculateSourceExtent(){const t=Hi();return this.triangles_.forEach(function(e,i,r){const s=e.source;of(t,s[0]),of(t,s[1]),of(t,s[2])}),t}getTriangles(){return this.triangles_}}const bV=.5;class i4 extends hx{constructor(t,e,i,r,s,o,a,u,h,d,g,m){super(s,kt.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=a,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const v=r.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let S=this.sourceTileGrid_.getExtent();const w=y?Kl(v,y):v;if(Q1(w)===0){this.state=kt.EMPTY;return}const R=t.getExtent();R&&(S?S=Kl(S,R):S=R);const P=r.getResolution(this.wrappedTileCoord_[0]),M=RV(t,i,w,P);if(!isFinite(M)||M<=0){this.state=kt.EMPTY;return}const L=d!==void 0?d:bV;if(this.triangulation_=new MV(t,i,w,S,M*L,P),this.triangulation_.getTriangles().length===0){this.state=kt.EMPTY;return}this.sourceZ_=e.getZForResolution(M);let D=this.triangulation_.calculateSourceExtent();if(S&&(t.canWrapX()?(D[1]=ke(D[1],S[1],S[3]),D[3]=ke(D[3],S[1],S[3])):D=Kl(D,S)),!Q1(D))this.state=kt.EMPTY;else{let j=0,b=0;t.canWrapX()&&(j=ue(R),b=Math.floor((D[0]-R[0])/j)),XM(D.slice(),t,!0).forEach(k=>{const V=e.getTileRangeForExtentAndZ(k,this.sourceZ_);for(let F=V.minX;F<=V.maxX;F++)for(let U=V.minY;U<=V.maxY;U++){const N=h(this.sourceZ_,F,U,a);if(N){const ut=b*j;this.sourceTiles_.push({tile:N,offset:ut})}}++b}),this.sourceTiles_.length===0&&(this.state=kt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const i=e.tile;if(i&&i.getState()==kt.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=e.offset,r[2]+=e.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=e.offset,s[2]+=e.offset),t.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=kt.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=PV(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=kt.LOADED}this.changed()}load(){if(this.state==kt.IDLE){this.state=kt.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i==kt.IDLE||i==kt.LOADING){t++;const r=ae(e,qt.CHANGE,s=>{const o=e.getState();(o==kt.LOADED||o==kt.ERROR||o==kt.EMPTY)&&(Fe(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,r){e.getState()==kt.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Fe),this.sourcesListenerKeys_=null}release(){this.canvas_&&(I_(this.canvas_.getContext("2d")),Hc.push(this.canvas_),this.canvas_=null),super.release()}}class dx{constructor(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function gc(n,t,e,i,r){return r!==void 0?(r.minX=n,r.maxX=t,r.minY=e,r.maxY=i,r):new dx(n,t,e,i)}class DA{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof d_&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return pe(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return pe(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){pe(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}}function v0(n,t,e,i){return i!==void 0?(i[0]=n,i[1]=t,i[2]=e,i):[n,t,e]}function kV(n,t,e){return n+"/"+t+"/"+e}function Dp(n,t,e,i,r){return`${le(n)},${t},${kV(e,i,r)}`}function r4(n){return LV(n[0],n[1],n[2])}function LV(n,t,e){return(t<<n)+e}function DV(n,t){const e=n[0],i=n[1],r=n[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(i,r):!0}function c1(n,t,e){if(!(e in n))return n[e]=new Set([t]),!0;const i=n[e],r=i.has(t);return r||i.add(t),!r}function NV(n,t,e){const i=n[e];return i?i.delete(t):!1}function NA(n,t){const e=n.layerStatesArray[n.layerIndex];e.extent&&(t=Kl(t,_a(e.extent,n.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(t=Kl(t,r))}return t}class OV extends Bb{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Hi(),this.tempTileRange_=new dx(0,0,0,0),this.tempTileCoord_=v0(0,0,0);const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new DA(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new DA(512)),this.sourceTileCache_}getOrCreateTile(t,e,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),u=Dp(a,a.getKey(),t,e,i);let h;if(s.containsKey(u))h=s.get(u);else{const d=r.viewState.projection,g=a.getProjection();if(h=a.getTile(t,e,i,r.pixelRatio,d,!g||Lp(g,d)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(t,e,i,r){const s=this.getOrCreateTile(t,e,i,r);return s||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),r=In(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!sh(s,r))return null;const o=e.viewState,a=i.getRenderSource(),u=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(e.pixelRatio);for(let d=u.getZForResolution(o.resolution);d>=u.getMinZoom();--d){const g=u.getTileCoordForCoordAndZ(r,d),m=this.getTile(d,g[1],g[2],e);if(!m||m.getState()!==kt.LOADED)continue;const v=u.getOrigin(d),y=Ci(u.getTileSize(d)),S=u.getResolution(d);let w;if(m instanceof n4||m instanceof i4)w=m.getImage();else if(m instanceof bA){if(w=mE(m.getData()),!w)continue}else continue;const R=Math.floor(h*((r[0]-v[0])/S-g[1]*y[0])),P=Math.floor(h*((v[1]-r[1])/S-g[2]*y[1])),M=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(w,R+M,P+M)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===e.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(t,e,i,r,s){const o=t.viewState,a=this.getLayer(),u=a.getRenderSource(),h=u.getTileGridForProjection(o.projection),d=le(u);d in t.wantedTiles||(t.wantedTiles[d]={});const g=t.wantedTiles[d],m=a.getMapInternal(),v=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),y=o.rotation,S=y?qM(o.center,o.resolution,y,t.size):void 0;for(let w=i;w>=v;--w){const R=h.getTileRangeForExtentAndZ(e,w,this.tempTileRange_),P=h.getResolution(w);for(let M=R.minX;M<=R.maxX;++M)for(let L=R.minY;L<=R.maxY;++L){if(y&&!h.tileCoordIntersectsViewport([w,M,L],S))continue;const D=this.getTile(w,M,L,t);if(!D||!c1(r,D,w))continue;const b=D.getKey();if(g[b]=!0,D.getState()===kt.IDLE&&!t.tileQueue.isKeyQueued(b)){const A=v0(w,M,L,this.tempTileCoord_);t.tileQueue.enqueue([D,d,h.getTileCoordCenter(A),P])}}}}findStaleTile_(t,e){const i=this.tileCache_,r=t[0],s=t[1],o=t[2],a=this.getStaleKeys();for(let u=0;u<a.length;++u){const h=Dp(this.getLayer().getSource(),a[u],r,s,o);if(i.containsKey(h)){const d=i.peek(h);if(d.getState()===kt.LOADED)return d.endTransition(le(this)),c1(e,d,r),!0}}return!1}findAltTiles_(t,e,i,r){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let d=s.minX;d<=s.maxX;++d)for(let g=s.minY;g<=s.maxY;++g){const m=Dp(u,h,i,d,g);let v=!1;if(a.containsKey(m)){const y=a.peek(m);y.getState()===kt.LOADED&&(c1(r,y,i),v=!0)}v||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,o=r.resolution,a=r.center,u=t.pixelRatio,h=this.getLayer(),d=h.getSource(),g=d.getTileGridForProjection(s),m=g.getZForResolution(o,d.zDirection),v=g.getResolution(m),y=d.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==y&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=y):this.renderedSourceKey_=y;let S=t.extent;const w=d.getTilePixelRatio(u);this.prepareContainer(t,e);const R=this.context.canvas.width,P=this.context.canvas.height,M=i.extent&&_a(i.extent);M&&(S=Kl(S,_a(i.extent)));const L=v*R/2/w,D=v*P/2/w,j=[a[0]-L,a[1]-D,a[0]+L,a[1]+D],b={};this.renderedTiles.length=0;const A=h.getPreload();if(t.nextExtent&&this.enqueueTilesForNextExtent()){const J=g.getZForResolution(r.nextResolution,d.zDirection),at=NA(t,t.nextExtent);this.enqueueTiles(t,at,J,b,A)}const k=NA(t,S);if(this.enqueueTiles(t,k,m,b,0),A>0&&setTimeout(()=>{this.enqueueTiles(t,k,m-1,b,A-1)},0),!(m in b))return this.container;const V=le(this),F=t.time;for(const J of b[m]){const at=J.getState();if(at===kt.EMPTY)continue;const it=J.tileCoord;if(at===kt.LOADED&&J.getAlpha(V,F)===1){J.endTransition(V);continue}if(at!==kt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(it,b)){NV(b,J,m),t.animate=!0;continue}if(this.findAltTiles_(g,it,m+1,b))continue;const At=g.getMinZoom();for(let Rt=m-1;Rt>=At&&!this.findAltTiles_(g,it,Rt,b);--Rt);}const U=v/o*u/w,N=this.getRenderContext(t);_o(this.tempTransform,R/2,P/2,U,U,0,-R/2,-P/2),i.extent&&this.clipUnrotated(N,t,M),d.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,t);const ut=Object.keys(b).map(Number);ut.sort(co);let wt;const yt=[],dt=[];for(let J=ut.length-1;J>=0;--J){const at=ut[J],it=d.getTilePixelSize(at,u,s),K=g.getResolution(at)/v,At=it[0]*K*U,Rt=it[1]*K*U,Pt=g.getTileCoordForCoordAndZ(yu(j),at),Nt=g.getTileCoordExtent(Pt),Vt=In(this.tempTransform,[w*(Nt[0]-j[0])/v,w*(j[3]-Nt[3])/v]),$t=w*d.getGutterForProjection(s);for(const Xt of b[at]){if(Xt.getState()!==kt.LOADED)continue;const ye=Xt.tileCoord,Ar=Pt[1]-ye[1],Fs=Math.round(Vt[0]-(Ar-1)*At),fi=Pt[2]-ye[2],gi=Math.round(Vt[1]-(fi-1)*Rt),An=Math.round(Vt[0]-Ar*At),Rn=Math.round(Vt[1]-fi*Rt),mi=Fs-An,Ji=gi-Rn,Re=ut.length===1;let ve=!1;wt=[An,Rn,An+mi,Rn,An+mi,Rn+Ji,An,Rn+Ji];for(let yn=0,tr=yt.length;yn<tr;++yn)if(!Re&&at<dt[yn]){const De=yt[yn];Ai([An,Rn,An+mi,Rn+Ji],[De[0],De[3],De[4],De[7]])&&(ve||(N.save(),ve=!0),N.beginPath(),N.moveTo(wt[0],wt[1]),N.lineTo(wt[2],wt[3]),N.lineTo(wt[4],wt[5]),N.lineTo(wt[6],wt[7]),N.moveTo(De[6],De[7]),N.lineTo(De[4],De[5]),N.lineTo(De[2],De[3]),N.lineTo(De[0],De[1]),N.clip())}yt.push(wt),dt.push(at),this.drawTile(Xt,t,An,Rn,mi,Ji,$t,Re),ve&&N.restore(),this.renderedTiles.unshift(Xt),this.updateUsedTiles(t.usedTiles,d,Xt)}}if(this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!Mf(this.renderedExtent_,j),this.renderedExtent_=j,this.renderedPixelRatio=u,this.postRender(this.context,t),i.extent&&N.restore(),N.imageSmoothingEnabled=!0,this.renderComplete){const J=(at,it)=>{const $=le(d),K=it.wantedTiles[$],At=K?Object.keys(K).length:0;this.updateCacheSize(At),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};t.postRenderFunctions.push(J)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,r,s,o,a,u){let h;if(t instanceof bA){if(h=mE(t.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(t);if(!h)return;const d=this.getRenderContext(e),g=le(this),m=e.layerStatesArray[e.layerIndex],v=m.opacity*(u?t.getAlpha(g,e.time):1),y=v!==d.globalAlpha;y&&(d.save(),d.globalAlpha=v),d.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),y&&d.restore(),v!==m.opacity?e.animate=!0:u&&t.endTransition(g)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const r=le(e);r in t||(t[r]={}),t[r][i.getKey()]=!0}}const gp={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class VV extends b_{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(gp.PRELOAD)}setPreload(t){this.set(gp.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(gp.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(gp.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class Ac extends VV{constructor(t){super(t)}createRenderer(){return new OV(this,{cacheSize:this.getCacheSize()})}}const mc=[0,0,0],ia=5;class s4{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,pe(r5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,pe(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=yu(i)),pe(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,pe(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:ux,pe(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,s)=>{const o=new dx(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,u=r.maxY;a<=u;++a)i([e,s,a])}forEachTileCoordParentTileRange(t,e,i,r){let s,o,a,u=null,h=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):u=this.getTileCoordExtent(t,r);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=gc(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(u,h,i),e(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,o=t[2]*2;return gc(s,s+1,o,o+1,e)}const r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],o=t[2];if(e===r)return gc(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,e-r),h=Math.floor(s*u),d=Math.floor(o*u);if(e<r)return gc(h,h,d,d,i);const g=Math.floor(u*(s+1))-1,m=Math.floor(u*(o+1))-1;return gc(h,g,d,m,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,mc);const r=mc[1],s=mc[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,mc);const o=mc[1],a=mc[2];return gc(r,o,s,a,i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=Ci(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]-(t[2]+.5)*r[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=Ci(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*s[0]*r,a=i[1]-(t[2]+1)*s[1]*r,u=o+s[0]*r,h=a+s[1]*r;return ka(o,a,u,h,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),u=this.getOrigin(o),h=Ci(this.getTileSize(o),this.tmpSize_);let d=a*(t-u[0])/i/h[0],g=a*(u[1]-e)/i/h[1];return r?(d=sp(d,ia)-1,g=sp(g,ia)-1):(d=rp(d,ia),g=rp(g,ia)),v0(o,d,g,s)}getTileCoordForXYAndZ_(t,e,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),u=Ci(this.getTileSize(i),this.tmpSize_);let h=(t-o[0])/a/u[0],d=(o[1]-e)/a/u[1];return r?(h=sp(h,ia)-1,d=sp(d,ia)-1):(h=rp(h,ia),d=rp(d,ia)),v0(i,h,d,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const i=Lw(this.resolutions_,t,e||0);return ke(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return fb(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i}}function o4(n){let t=n.getDefaultTileGrid();return t||(t=jV(n),n.setDefaultTileGrid(t)),t}function FV(n,t,e){const i=t[0],r=n.getTileCoordCenter(t),s=fx(e);if(!sh(s,r)){const o=ue(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return t}function GV(n,t,e,i){i=i!==void 0?i:"top-left";const r=a4(n,t,e);return new s4({extent:n,origin:c5(n,i),resolutions:r,tileSize:e})}function UV(n){const t=n||{},e=t.extent||Un("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:a4(e,t.maxZoom,t.tileSize,t.maxResolution)};return new s4(i)}function a4(n,t,e,i){t=t!==void 0?t:_V,e=Ci(e!==void 0?e:ux);const r=Jn(n),s=ue(n);i=i>0?i:Math.max(s/e[0],r/e[1]);const o=t+1,a=new Array(o);for(let u=0;u<o;++u)a[u]=i/Math.pow(2,u);return a}function jV(n,t,e,i){const r=fx(n);return GV(r,t,e,i)}function fx(n){n=Un(n);let t=n.getExtent();if(!t){const e=180*Vw.degrees/n.getMetersPerUnit();t=ka(-e,-e,e,e)}return t}function l4(n,t){const e=[];Object.keys(t).forEach(function(r){t[r]!==null&&t[r]!==void 0&&e.push(r+"="+encodeURIComponent(t[r]))});const i=e.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const zV=/\{z\}/g,BV=/\{x\}/g,$V=/\{y\}/g,WV=/\{-y\}/g;function KV(n,t,e,i,r){return n.replace(zV,t.toString()).replace(BV,e.toString()).replace($V,i.toString()).replace(WV,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function qV(n){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(n);if(e){const i=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=i;s<=r;++s)t.push(n.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){const i=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=i;r++)t.push(n.replace(e[0],r.toString()));return t}return t.push(n),t}function HV(n,t){return(function(e,i,r){if(!e)return;let s;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(s=a.getHeight()-1)}return KV(n,o,e[1],e[2],s)})}function XV(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=HV(n[r],t);return YV(i)}function YV(n){return n.length===1?n[0]:(function(t,e,i){if(!t)return;const r=r4(t),s=Ta(r,n.length);return n[s](t,e,i)})}class ZV extends Ob{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&Ci(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||le(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,r,s,o){return oe()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:o4(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),o=Ci(r.getTileSize(t),this.tmpSize);return s==1?o:i8(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const i=e!==void 0?e:this.getProjection(),r=e!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=FV(r,t,i)),DV(t,r)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class QV extends So{constructor(t,e){super(t),this.tile=e}}const h1={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class gx extends ZV{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===gx.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=le(e),r=e.getState();let s;r==kt.LOADING?(this.tileLoadingKeys_[i]=!0,s=h1.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==kt.ERROR?h1.TILELOADERROR:r==kt.LOADED?h1.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new QV(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=qV(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(XV(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}}class u4 extends gx{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:c4,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:n4,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!Lp(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Lp(e,t)))return this.tileGrid;const i=le(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=o4(t)),this.tileGridForProjection[i]}createTile_(t,e,i,r,s,o){const a=[t,e,i],u=this.getTileCoordForTileUrlFunction(a,s),h=u?this.tileUrlFunction(u,r,s):void 0,d=new this.tileClass(a,h!==void 0?kt.IDLE:kt.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=o,d.addEventListener(qt.CHANGE,this.handleTileChange.bind(this)),d}getTile(t,e,i,r,s,o){const a=this.getProjection();if(!a||!s||Lp(a,s))return this.getTileInternal(t,e,i,r,a||s);const u=[t,e,i],h=this.getKey(),d=this.getTileGridForProjection(a),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(u,s),v=new i4(a,d,s,g,u,m,this.getTilePixelRatio(r),this.getGutter(),(y,S,w,R)=>this.getTileInternal(y,S,w,R,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=h,v}getTileInternal(t,e,i,r,s,o){const a=this.getKey(),u=Dp(this,a,t,e,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(t,e,i,r,s,a);return o?.set(u,h),h}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const i=Un(t);if(i){const r=le(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}}function c4(n,t){if($i){const e=n.getCrossOrigin();let i="same-origin",r="same-origin";e==="anonymous"||e===""?(i="cors",r="omit"):e==="use-credentials"&&(i="cors",r="include"),fetch(t,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=t}class qd extends u4{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",i=t.tileGrid!==void 0?t.tileGrid:UV({extent:fx(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const JV="modulepreload",tF=function(n){return"/detectorapp-nl/"+n},OA={},Qt=function(t,e,i){let r=Promise.resolve();if(e&&e.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=u(e.map(h=>{if(h=tF(h),h in OA)return;OA[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":JV,d||(m.as="script"),m.crossOrigin="",m.href=h,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((v,y)=>{m.addEventListener("load",v),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})},VA=4,_E="1.3.0";function eF(n,t,e,i,r){r.WIDTH=e[0],r.HEIGHT=e[1];const s=i.getAxisOrientation(),o=YM(r.VERSION,"1.3")>=0;r[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return r.BBOX=a.join(","),l4(n,r)}function nF(n,t,e,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=t/e,u=[V2(ue(n)/a,VA),V2(Jn(n)/a,VA)];if(e!=1)switch(o){case"geoserver":const d=90*e+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+d:s.FORMAT_OPTIONS="dpi:"+d;break;case"mapserver":s.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":s.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return eF(r,n,u,i,s)}function FA(n,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:_E,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const iF='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class rF extends qd{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[iF];const i=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!$i&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(t.tileLoadFunction||c4)(s,o)},transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}}const E0=1/0;class sF{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,fg(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(t){pe(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=E0?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,r=e.length,s=e[t],o=i[t],a=t;for(;t<r>>1;){const u=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),d=h<r&&i[h]<i[u]?h:u;e[t]=e[d],i[t]=i[d],t=d}e[t]=s,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,r=this.priorities_,s=i[e],o=r[e];for(;e>t;){const a=this.getParentIndex_(e);if(r[a]>o)i[e]=i[a],r[e]=r[a],e=a;else break}i[e]=s,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let r=0;const s=e.length;let o,a,u;for(a=0;a<s;++a)o=e[a],u=t(o),u==E0?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,e[r++]=o);e.length=r,i.length=r,this.heapify_()}}class oF extends sF{constructor(t,e){super(i=>t.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(qt.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===kt.LOADED||i===kt.ERROR||i===kt.EMPTY){i!==kt.ERROR&&e.removeEventListener(qt.CHANGE,this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===kt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function aF(n,t,e,i,r){if(!n||!(e in n.wantedTiles)||!n.wantedTiles[e][t.getKey()])return E0;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class lF extends u4{constructor(t){t=t||{};const e=Object.assign({},t.params);super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.tmpExtent_=Hi(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,i,r){const s=Un(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const u=yg(t,s,o),h=pE(o,s,t,e),d=a.getZForResolution(h,this.zDirection),g=a.getResolution(d),m=a.getTileCoordForCoordAndZ(u,d);if(a.getResolutions().length<=m[0])return;let v=a.getTileCoordExtent(m,this.tmpExtent_);const y=this.gutter_;y!==0&&(v=Cf(v,g*y,v));const S={QUERY_LAYERS:this.params_.LAYERS};Object.assign(S,FA(this.params_,"GetFeatureInfo"),r);const w=Math.floor((u[0]-v[0])/g),R=Math.floor((v[3]-u[1])/g);return S[this.v13_?"I":"X"]=w,S[this.v13_?"J":"Y"]=R,this.getRequestUrl_(m,v,1,o||s,S)}getLegendUrl(t,e){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:_E,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(t!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=t*r/s}return Object.assign(i,e),l4(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,i,r,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const u=Ta(r4(t),o.length);a=o[u]}return nF(e,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(t[0]),i,r,a,s,this.serverType_)}getTilePixelRatio(t){return!this.hidpi_||this.serverType_===void 0?1:t}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}setParams_(t){this.params_=t,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(t){this.setParams_(Object.assign({},t))}updateParams(t){this.setParams_(Object.assign(this.params_,t))}updateV13_(){const t=this.params_.VERSION||_E;this.v13_=YM(t,"1.3")>=0}tileUrlFunction(t,e,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=t[0])return;e!=1&&(!this.hidpi_||this.serverType_===void 0)&&(e=1);const s=r.getResolution(t[0]);let o=r.getTileCoordExtent(t,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Cf(o,s*a,o));const u=Object.assign({},FA(this.params_,"GetMap"));return this.getRequestUrl_(t,o,e,i,u)}}class Rc extends So{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}}class la extends Rc{constructor(t,e,i,r,s,o){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Ke={SINGLECLICK:"singleclick",CLICK:qt.CLICK,DBLCLICK:qt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},yE={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class uF extends gg{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=ae(i,yE.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=ae(i,yE.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(qt.TOUCHMOVE,this.boundHandleTouchMove_,vb?{passive:!1}:!1)}emulateClick_(t){let e=new la(Ke.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new la(Ke.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new la(Ke.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Ke.POINTERUP||e.type==Ke.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==Ke.POINTERDOWN||e.type==Ke.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new la(Ke.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Fe),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new la(Ke.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(ae(i,Ke.POINTERMOVE,this.handlePointerMove_,this),ae(i,Ke.POINTERUP,this.handlePointerUp_,this),ae(this.element_,Ke.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(ae(this.element_.getRootNode(),Ke.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new la(Ke.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new la(Ke.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Fe(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(qt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Fe(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Fe),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ua={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},qn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class mx extends Ns{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let e=0,i=this.listenerKeys.length;e<i;++e)Fe(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=t,t){const e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==Pf&&this.listenerKeys.push(ae(t,ua.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class cF extends mx{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(qt.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+A_+" "+Jw+(this.collapsed_&&this.collapsible_?" "+tA:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=h,d.appendChild(this.toggleButton_),d.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap(r=>r.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!e.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(r=>UM(()=>r))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!$a(e,this.renderedAttributions_)){u6(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(tA),this.collapsed_?Q2(this.collapseLabel_,this.label_):Q2(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class hF extends mx{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(qt.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+A_+" "+Jw,u=this.element;u.className=a,u.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(lp)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const i=e.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Mh}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(lp);!s&&i===0?this.element.classList.add(lp):s&&i!==0&&this.element.classList.remove(lp)}this.label_.style.transform=r}this.rotation_=i}}class dF extends mx{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"",u=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",h=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=r,d.setAttribute("type","button"),d.title=u,d.appendChild(typeof o=="string"?document.createTextNode(o):o),d.addEventListener(qt.CLICK,this.handleClick_.bind(this,i),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=h,g.appendChild(typeof a=="string"?document.createTextNode(a):a),g.addEventListener(qt.CLICK,this.handleClick_.bind(this,-i),!1);const m=e+" "+A_+" "+Jw,v=this.element;v.className=m,v.appendChild(d),v.appendChild(g),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Mh})):i.setZoom(s)}}}function fF(n){n=n||{};const t=new yr;return(n.zoom===void 0||n.zoom)&&t.push(new dF(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&t.push(new hF(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&t.push(new cF(n.attributionOptions)),t}class gF{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const r=this.points_[e+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const GA={ACTIVE:"active"};class wg extends Ns{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(GA.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(GA.ACTIVE,t)}setMap(t){this.map_=t}}function mF(n,t,e){const i=n.getCenterInternal();if(i){const r=[i[0]+t[0],i[1]+t[1]];n.animateInternal({duration:e!==void 0?e:250,easing:dV,center:n.getConstrainedCenter(r)})}}function px(n,t,e,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+t),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:Mh})}class pF extends wg{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==Ke.DBLCLICK){const i=t.originalEvent,r=t.map,s=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();px(a,o,s,this.duration_),i.preventDefault(),e=!0}return!e}}function vE(n){const t=arguments;return function(e){let i=!0;for(let r=0,s=t.length;r<s&&(i=i&&t[r](e),!!i);++r);return i}}const _F=function(n){const t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},yF=function(n){const t=n.map.getTargetElement(),e=t.getRootNode(),i=n.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},h4=function(n){const t=n.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?yF(n):!0},vF=Rf,d4=function(n){const t=n.originalEvent;return"pointerId"in t&&t.button==0&&!(a6&&_b&&t.ctrlKey)},f4=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},EF=function(n){const t=n.originalEvent;return _b?t.metaKey:t.ctrlKey},wF=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},g4=function(n){const t=n.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},d1=function(n){const t=n.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"},xF=function(n){const t=n.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0};class xg extends wg{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Ke.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Ke.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Ke.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Ke.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function _x(n){const t=n.length;let e=0,i=0;for(let r=0;r<t;r++)e+=n[r].clientX,i+=n[r].clientY;return{clientX:e/t,clientY:i/t}}class TF extends xg{constructor(t){super({stopDown:g_}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:vE(f4,xF);this.condition_=t.onFocusOnly?vE(h4,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,r=e.getEventPixel(_x(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();p5(s,a.getResolution()),Ow(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),u=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Mh})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class SF extends xg{constructor(t){t=t||{},super({stopDown:g_}),this.condition_=t.condition?t.condition:_F,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!d1(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===lx)return;const r=e.getSize(),s=t.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return d1(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return d1(t)&&d4(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class IF extends d_{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+i,r.top=Math.min(t[1],e[1])+i,r.width=Math.abs(e[0]-t[0])+i,r.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Of([r])}getGeometry(){return this.geometry_}}const pc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class kd extends So{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class AF extends xg{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new IF(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??d4,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const r=i[0]-e[0],s=i[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new kd(pc.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new kd(e?pc.BOXEND:pc.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new kd(pc.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new kd(pc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new kd(pc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class RF extends AF{constructor(t){t=t||{};const e=t.condition?t.condition:wF;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Mh})}}const wl={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class PF extends wg{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return f4(e)&&g4(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==qt.KEYDOWN){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==wl.DOWN||r==wl.LEFT||r==wl.RIGHT||r==wl.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==wl.DOWN?h=-a:r==wl.LEFT?u=-a:r==wl.RIGHT?u=a:h=a;const d=[u,h];Ow(d,o.getRotation()),mF(o,d,this.duration_),i.preventDefault(),e=!0}}return!e}}class CF extends wg{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!EF(e)&&g4(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==qt.KEYDOWN||t.type==qt.KEYPRESS){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==="+"||r==="-")){const s=t.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();px(a,o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}const MF=40,bF=300;class kF extends wg{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:vF;this.condition_=t.onFocusOnly?vE(h4,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==qt.WHEEL)return!0;const i=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=MF;break;case WheelEvent.DOM_DELTA_PAGE:s*=bF;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-ke(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),px(e,i,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class LF extends xg{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=g_),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=u}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==lx&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(_x(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class DF extends xg{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=g_),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const u=t.map,h=u.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(_x(this.targetPointers))),u.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const i=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function NF(n){n=n||{};const t=new yr,e=new gF(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&t.push(new SF),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&t.push(new pF({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&t.push(new TF({onFocusOnly:n.onFocusOnly,kinetic:e})),(n.pinchRotate===void 0||n.pinchRotate)&&t.push(new LF),(n.pinchZoom===void 0||n.pinchZoom)&&t.push(new DF({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(t.push(new PF),t.push(new CF({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&t.push(new kF({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&t.push(new RF({duration:n.zoomDuration})),t}class OF extends d_{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){oe()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;_o(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),ab(r,i)}forEachFeatureAtCoordinate(t,e,i,r,s,o,a,u){let h;const d=e.viewState;function g(L,D,j,b){return s.call(o,D,L?j:null,b)}const m=d.projection,v=ZM(t.slice(),m),y=[[0,0]];if(m.canWrapX()&&r){const L=m.getExtent(),D=ue(L);y.push([-D,0],[D,0])}const S=e.layerStatesArray,w=S.length,R=[],P=[];for(let L=0;L<y.length;L++)for(let D=w-1;D>=0;--D){const j=S[D],b=j.layer;if(b.hasRenderer()&&cx(j,d)&&a.call(u,b)){const A=b.getRenderer(),k=b.getSource();if(A&&k){const V=k.getWrapX()?v:t,F=g.bind(null,j.managed);P[0]=V[0]+y[L][0],P[1]=V[1]+y[L][1],h=A.forEachFeatureAtCoordinate(P,e,i,F,R)}if(h)return h}}if(R.length===0)return;const M=1/R.length;return R.forEach((L,D)=>L.distanceSq+=D*M),R.sort((L,D)=>L.distanceSq-D.distanceSq),R.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(t,e,i,r,s,o){return this.forEachFeatureAtCoordinate(t,e,i,r,Rf,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(t){oe()}scheduleExpireIconCache(t){Er.canExpireCache()&&t.postRenderFunctions.push(VF)}}function VF(n,t){Er.expire()}class FF extends OF{constructor(t){super(t),this.fontChangeListenerKey_=ae(Tc,ih.PROPERTYCHANGE,t.redrawText,t),this.element_=$i?Eb():document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=A_+" ol-layers";const i=t.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const r=new zb(t,void 0,e);i.dispatchEvent(r)}}disposeInternal(){Fe(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(vr.PRECOMPOSE,t);const e=t.layerStatesArray.sort((h,d)=>h.zIndex-d.zIndex);e.some(h=>h.layer instanceof Jb&&h.layer.getDeclutter())&&(t.declutter={});const r=t.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,d=e.length;h<d;++h){const g=e[h];t.layerIndex=h;const m=g.layer,v=m.getSourceState();if(!cx(g,r)||v!="ready"&&v!="undefined"){m.unrender();continue}const y=m.render(t,o);y&&(y!==o&&(this.children_.push(y),o=y),s.push(g))}this.declutter(t,s),c6(this.element_,this.children_);const u=this.getMap().getTargetElement();if(ya(u)){const h=u.getContext("2d");for(const d of this.children_){const g=d.firstElementChild||d,m=d.style.backgroundColor;if(m&&(!ya(g)||g.width>0)&&(h.fillStyle=m,h.fillRect(0,0,u.width,u.height)),ya(g)&&g.width>0){const v=d.style.opacity||g.style.opacity;h.globalAlpha=v===""?1:Number(v);const y=g.style.transform;if(y)h.setTransform(...oE(y));else{const S=parseFloat(g.style.width)/g.width,w=parseFloat(g.style.height)/g.height;h.setTransform(S,0,0,w,0,0)}h.drawImage(g,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(vr.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const r=e[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(t,r)}e.forEach(i=>i.layer.renderDeferred(t))}}}function m4(n){if(n instanceof b_){n.setMapInternal(null);return}n instanceof k_&&n.getLayers().forEach(m4)}function p4(n,t){if(n instanceof b_){n.setMapInternal(t);return}if(n instanceof k_){const e=n.getLayers().getArray();for(let i=0,r=e.length;i<r;++i)p4(e[i],t)}}let GF=class extends Ns{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=UF(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:l6,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=qr(),this.pixelToCoordinateTransform_=qr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,$i||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,$i||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=e.controls||($i?new yr:fF()),this.interactions=e.interactions||($i?new yr:NF({onFocusOnly:!0})),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new oF(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(qn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(qn.VIEW,this.handleViewChanged_),this.addChangeListener(qn.SIZE,this.handleSizeChanged_),this.addChangeListener(qn.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof ws)&&t.view.then(function(r){i.setView(new ws(r))}),this.controls.addEventListener(Ti.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Ti.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Ti.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Ti.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Ti.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Ti.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){p4(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Rf,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(r){i.push(r)},e),i}getAllLayers(){const t=[];function e(i){i.forEach(function(r){r instanceof k_?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const r=e.layerFilter!==void 0?e.layerFilter:Rf,s=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(qn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return sE(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?In(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(qn.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof yr){e.setLayers(t);return}const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=ro(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?In(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(qn.SIZE)}getView(){return this.get(qn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,r){return aF(this.frameState_,t,e,i,r)}handleBrowserEvent(t,e){e=e||t.type;const i=new la(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===yE.POINTERDOWN||i===qt.WHEEL||i===qt.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const o=t.viewHints;if(o[Xn.ANIMATING]||o[Xn.INTERACTING]){const a=Date.now()-t.time>8;r=a?0:8,s=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(vr.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(vr.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Rc(ua.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Rc(ua.LOADSTART,this,t))));const i=this.postRenderFunctions_;if(t)for(let r=0,s=i.length;r<s;++r)i[r](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Fe(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(qt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(qt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!ya(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(ya(e)||e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new FF(this)),!ya(e)){this.mapBrowserEventHandler_=new uF(this,this.moveTolerance_);for(const r in Ke)this.mapBrowserEventHandler_.addEventListener(Ke[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(qt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(qt.WHEEL,this.boundHandleBrowserEvent_,vb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=e.getRootNode();i=r instanceof ShadowRoot?r.host:e}if(this.targetChangeHandlerKeys_=[ae(i,qt.KEYDOWN,this.handleBrowserEvent,this),ae(i,qt.KEYPRESS,this.handleBrowserEvent,this)],e instanceof HTMLElement){const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(e)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Fe(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Fe(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=ae(t,ih.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=ae(t,qt.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Fe),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new ha("addlayer",t)),this.layerGroupPropertyListenerKeys_=[ae(t,ih.PROPERTYCHANGE,this.render,this),ae(t,qt.CHANGE,this.render,this),ae(t,"addlayer",this.handleLayerAdd_,this),ae(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const t=this.frameState_.layerStatesArray;for(let e=0,i=t.length;e<i;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){m4(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(e!==void 0&&dA(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:J1(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:le(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const u=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=J1(a.nextCenter,a.nextResolution,u,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!v_(this.previousExtent_)&&!Mf(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Rc(ua.MOVESTART,this,r)),this.previousExtent_=m_(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Xn.ANIMATING]&&!s.viewHints[Xn.INTERACTING]&&!Mf(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Rc(ua.MOVEEND,this,s)),zM(s.extent,this.previousExtent_))),this.dispatchEvent(new Rc(ua.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(ua.LOADSTART)||this.hasListener(ua.LOADEND)||this.hasListener(vr.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new ha("removelayer",e)),this.set(qn.LAYERGROUP,t)}setSize(t){this.set(qn.SIZE,t)}setTarget(t){this.set(qn.TARGET,t)}setView(t){if(!t||t instanceof ws){this.set(qn.VIEW,t);return}this.set(qn.VIEW,new ws);const e=this;t.then(function(i){e.setView(new ws(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){let r,s;if(ya(t))r=t.width,s=t.height;else{const o=getComputedStyle(t);r=t.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=t.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(e=[Math.max(0,r),Math.max(0,s)],!dA(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&JM("No map visible because the map container's width or height are 0."))}const i=this.getSize();e&&(!i||!$a(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function UF(n){let t=null;n.keyboardEventTarget!==void 0&&(t=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const e={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new k_({layers:n.layers});e[qn.LAYERGROUP]=i,e[qn.TARGET]=n.target,e[qn.VIEW]=n.view instanceof ws?n.view:new ws;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new yr(n.controls.slice()):(pe(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new yr(n.interactions.slice()):(pe(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new yr(n.overlays.slice()):(pe(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new yr,{controls:r,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}const jF={},UA=n=>{let t;const e=new Set,i=(d,g)=>{const m=typeof d=="function"?d(t):d;if(!Object.is(m,t)){const v=t;t=g??(typeof m!="object"||m===null)?m:Object.assign({},t,m),e.forEach(y=>y(t,v))}},r=()=>t,u={setState:i,getState:r,getInitialState:()=>h,subscribe:d=>(e.add(d),()=>e.delete(d)),destroy:()=>{(jF?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),e.clear()}},h=t=n(i,r,u);return u},zF=n=>n?UA(n):UA;var f1={exports:{}},g1={},m1={exports:{}},p1={};var jA;function BF(){if(jA)return p1;jA=1;var n=dg();function t(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var e=typeof Object.is=="function"?Object.is:t,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function a(g,m){var v=m(),y=i({inst:{value:v,getSnapshot:m}}),S=y[0].inst,w=y[1];return s(function(){S.value=v,S.getSnapshot=m,u(S)&&w({inst:S})},[g,v,m]),r(function(){return u(S)&&w({inst:S}),g(function(){u(S)&&w({inst:S})})},[g]),o(v),v}function u(g){var m=g.getSnapshot;g=g.value;try{var v=m();return!e(g,v)}catch{return!0}}function h(g,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:a;return p1.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,p1}var zA;function $F(){return zA||(zA=1,m1.exports=BF()),m1.exports}var BA;function WF(){if(BA)return g1;BA=1;var n=dg(),t=$F();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var i=typeof Object.is=="function"?Object.is:e,r=t.useSyncExternalStore,s=n.useRef,o=n.useEffect,a=n.useMemo,u=n.useDebugValue;return g1.useSyncExternalStoreWithSelector=function(h,d,g,m,v){var y=s(null);if(y.current===null){var S={hasValue:!1,value:null};y.current=S}else S=y.current;y=a(function(){function R(j){if(!P){if(P=!0,M=j,j=m(j),v!==void 0&&S.hasValue){var b=S.value;if(v(b,j))return L=b}return L=j}if(b=L,i(M,j))return b;var A=m(j);return v!==void 0&&v(b,A)?(M=j,b):(M=j,L=A)}var P=!1,M,L,D=g===void 0?null:g;return[function(){return R(d())},D===null?void 0:function(){return R(D())}]},[d,g,m,v]);var w=r(h,y[0],y[1]);return o(function(){S.hasValue=!0,S.value=w},[w]),u(w),w},g1}var $A;function KF(){return $A||($A=1,f1.exports=WF()),f1.exports}var qF=KF();const HF=kw(qF),_4={},{useDebugValue:XF}=t5,{useSyncExternalStoreWithSelector:YF}=HF;let WA=!1;const ZF=n=>n;function QF(n,t=ZF,e){(_4?"production":void 0)!=="production"&&e&&!WA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),WA=!0);const i=YF(n.subscribe,n.getState,n.getServerState||n.getInitialState,t,e);return XF(i),i}const JF=n=>{(_4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof n=="function"?zF(n):n,e=(i,r)=>QF(t,i,r);return Object.assign(e,t),e},Eu=n=>JF;var y4=Symbol.for("immer-nothing"),KA=Symbol.for("immer-draftable"),Xi=Symbol.for("immer-state");function Br(n,...t){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Gf=Object.getPrototypeOf;function ch(n){return!!n&&!!n[Xi]}function iu(n){return n?v4(n)||Array.isArray(n)||!!n[KA]||!!n.constructor?.[KA]||Tg(n)||D_(n):!1}var t9=Object.prototype.constructor.toString(),qA=new WeakMap;function v4(n){if(!n||typeof n!="object")return!1;const t=Object.getPrototypeOf(n);if(t===null||t===Object.prototype)return!0;const e=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(e===Object)return!0;if(typeof e!="function")return!1;let i=qA.get(e);return i===void 0&&(i=Function.toString.call(e),qA.set(e,i)),i===t9}function w0(n,t,e=!0){L_(n)===0?(e?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{t(r,n[r],n)}):n.forEach((i,r)=>t(r,i,n))}function L_(n){const t=n[Xi];return t?t.type_:Array.isArray(n)?1:Tg(n)?2:D_(n)?3:0}function EE(n,t){return L_(n)===2?n.has(t):Object.prototype.hasOwnProperty.call(n,t)}function E4(n,t,e){const i=L_(n);i===2?n.set(t,e):i===3?n.add(e):n[t]=e}function e9(n,t){return n===t?n!==0||1/n===1/t:n!==n&&t!==t}function Tg(n){return n instanceof Map}function D_(n){return n instanceof Set}function Il(n){return n.copy_||n.base_}function wE(n,t){if(Tg(n))return new Map(n);if(D_(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const e=v4(n);if(t===!0||t==="class_only"&&!e){const i=Object.getOwnPropertyDescriptors(n);delete i[Xi];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],a=i[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(i[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(Gf(n),i)}else{const i=Gf(n);if(i!==null&&e)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function yx(n,t=!1){return N_(n)||ch(n)||!iu(n)||(L_(n)>1&&Object.defineProperties(n,{set:mp,add:mp,clear:mp,delete:mp}),Object.freeze(n),t&&Object.values(n).forEach(e=>yx(e,!0))),n}function n9(){Br(2)}var mp={value:n9};function N_(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var i9={};function ru(n){const t=i9[n];return t||Br(0,n),t}var Uf;function w4(){return Uf}function r9(n,t){return{drafts_:[],parent_:n,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function HA(n,t){t&&(ru("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=t)}function xE(n){TE(n),n.drafts_.forEach(s9),n.drafts_=null}function TE(n){n===Uf&&(Uf=n.parent_)}function XA(n){return Uf=r9(Uf,n)}function s9(n){const t=n[Xi];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function YA(n,t){t.unfinalizedDrafts_=t.drafts_.length;const e=t.drafts_[0];return n!==void 0&&n!==e?(e[Xi].modified_&&(xE(t),Br(4)),iu(n)&&(n=x0(t,n),t.parent_||T0(t,n)),t.patches_&&ru("Patches").generateReplacementPatches_(e[Xi].base_,n,t.patches_,t.inversePatches_)):n=x0(t,e,[]),xE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),n!==y4?n:void 0}function x0(n,t,e){if(N_(t))return t;const i=n.immer_.shouldUseStrictIteration(),r=t[Xi];if(!r)return w0(t,(s,o)=>ZA(n,r,t,s,o,e),i),t;if(r.scope_!==n)return t;if(!r.modified_)return T0(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),w0(o,(u,h)=>ZA(n,r,s,u,h,e,a),i),T0(n,s,!1),e&&n.patches_&&ru("Patches").generatePatches_(r,e,n.patches_,n.inversePatches_)}return r.copy_}function ZA(n,t,e,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const a=N_(r);if(!(a&&!o)){if(ch(r)){const u=s&&t&&t.type_!==3&&!EE(t.assigned_,i)?s.concat(i):void 0,h=x0(n,r,u);if(E4(e,i,h),ch(h))n.canAutoFreeze_=!1;else return}else o&&e.add(r);if(iu(r)&&!a){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||t&&t.base_&&t.base_[i]===r&&a)return;x0(n,r),(!t||!t.scope_.parent_)&&typeof i!="symbol"&&(Tg(e)?e.has(i):Object.prototype.propertyIsEnumerable.call(e,i))&&T0(n,r)}}}function T0(n,t,e=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&yx(t,e)}function o9(n,t){const e=Array.isArray(n),i={type_:e?1:0,scope_:t?t.scope_:w4(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=vx;e&&(r=[i],s=jf);const{revoke:o,proxy:a}=Proxy.revocable(r,s);return i.draft_=a,i.revoke_=o,a}var vx={get(n,t){if(t===Xi)return n;const e=Il(n);if(!EE(e,t))return a9(n,e,t);const i=e[t];return n.finalized_||!iu(i)?i:i===_1(n.base_,t)?(y1(n),n.copy_[t]=IE(i,n)):i},has(n,t){return t in Il(n)},ownKeys(n){return Reflect.ownKeys(Il(n))},set(n,t,e){const i=x4(Il(n),t);if(i?.set)return i.set.call(n.draft_,e),!0;if(!n.modified_){const r=_1(Il(n),t),s=r?.[Xi];if(s&&s.base_===e)return n.copy_[t]=e,n.assigned_[t]=!1,!0;if(e9(e,r)&&(e!==void 0||EE(n.base_,t)))return!0;y1(n),SE(n)}return n.copy_[t]===e&&(e!==void 0||t in n.copy_)||Number.isNaN(e)&&Number.isNaN(n.copy_[t])||(n.copy_[t]=e,n.assigned_[t]=!0),!0},deleteProperty(n,t){return _1(n.base_,t)!==void 0||t in n.base_?(n.assigned_[t]=!1,y1(n),SE(n)):delete n.assigned_[t],n.copy_&&delete n.copy_[t],!0},getOwnPropertyDescriptor(n,t){const e=Il(n),i=Reflect.getOwnPropertyDescriptor(e,t);return i&&{writable:!0,configurable:n.type_!==1||t!=="length",enumerable:i.enumerable,value:e[t]}},defineProperty(){Br(11)},getPrototypeOf(n){return Gf(n.base_)},setPrototypeOf(){Br(12)}},jf={};w0(vx,(n,t)=>{jf[n]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});jf.deleteProperty=function(n,t){return jf.set.call(this,n,t,void 0)};jf.set=function(n,t,e){return vx.set.call(this,n[0],t,e,n[0])};function _1(n,t){const e=n[Xi];return(e?Il(e):n)[t]}function a9(n,t,e){const i=x4(t,e);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function x4(n,t){if(!(t in n))return;let e=Gf(n);for(;e;){const i=Object.getOwnPropertyDescriptor(e,t);if(i)return i;e=Gf(e)}}function SE(n){n.modified_||(n.modified_=!0,n.parent_&&SE(n.parent_))}function y1(n){n.copy_||(n.copy_=wE(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var l9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,e,i)=>{if(typeof t=="function"&&typeof e!="function"){const s=e;e=t;const o=this;return function(u=s,...h){return o.produce(u,d=>e.call(this,d,...h))}}typeof e!="function"&&Br(6),i!==void 0&&typeof i!="function"&&Br(7);let r;if(iu(t)){const s=XA(this),o=IE(t,void 0);let a=!0;try{r=e(o),a=!1}finally{a?xE(s):TE(s)}return HA(s,i),YA(r,s)}else if(!t||typeof t!="object"){if(r=e(t),r===void 0&&(r=t),r===y4&&(r=void 0),this.autoFreeze_&&yx(r,!0),i){const s=[],o=[];ru("Patches").generateReplacementPatches_(t,r,s,o),i(s,o)}return r}else Br(1,t)},this.produceWithPatches=(t,e)=>{if(typeof t=="function")return(o,...a)=>this.produceWithPatches(o,u=>t(u,...a));let i,r;return[this.produce(t,e,(o,a)=>{i=o,r=a}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){iu(n)||Br(8),ch(n)&&(n=u9(n));const t=XA(this),e=IE(n,void 0);return e[Xi].isManual_=!0,TE(t),e}finishDraft(n,t){const e=n&&n[Xi];(!e||!e.isManual_)&&Br(9);const{scope_:i}=e;return HA(i,t),YA(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,t){let e;for(e=t.length-1;e>=0;e--){const r=t[e];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}e>-1&&(t=t.slice(e+1));const i=ru("Patches").applyPatches_;return ch(n)?i(n,t):this.produce(n,r=>i(r,t))}};function IE(n,t){const e=Tg(n)?ru("MapSet").proxyMap_(n,t):D_(n)?ru("MapSet").proxySet_(n,t):o9(n,t);return(t?t.scope_:w4()).drafts_.push(e),e}function u9(n){return ch(n)||Br(10,n),T4(n)}function T4(n){if(!iu(n)||N_(n))return n;const t=n[Xi];let e,i=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,e=wE(n,t.scope_.immer_.useStrictShallowCopy_),i=t.scope_.immer_.shouldUseStrictIteration()}else e=wE(n,!0);return w0(e,(r,s)=>{E4(e,r,T4(s))},i),t&&(t.finalized_=!1),e}var c9=new l9,h9=c9.produce;const d9=n=>(t,e,i)=>(i.setState=(r,s,...o)=>{const a=typeof r=="function"?h9(r):r;return t(a,s,...o)},n(i.setState,e,i)),wu=d9,Oe=Eu()(wu((n,t)=>({tracking:!0,navigationMode:"free",position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.4,minRotationSpeed:5,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(e=>{e.tracking=!0})},stopTracking:()=>{n(e=>{const{watchId:i}=t();i!==null&&navigator.geolocation.clearWatch(i),e.tracking=!1,e.speed=null,e.headingSource=null,e.watchId=null})},toggleMode:()=>{n(e=>{e.navigationMode=e.navigationMode==="free"?"drive":"free",console.log(` Navigation mode: ${e.navigationMode}`)})},updatePosition:e=>{n(i=>{i.position={lat:e.coords.latitude,lng:e.coords.longitude},i.accuracy=e.coords.accuracy,i.speed=e.coords.speed;const r=15,s=.5;if(!(e.coords.accuracy!==null&&e.coords.accuracy<r)){i.headingSource=null;return}if(e.coords.heading!==null&&e.coords.speed!==null&&e.coords.speed>s){i.headingSource="gps";const a=e.coords.heading;t().updateHeading(a,"gps")}else i.headingSource="compass"})},updateHeading:(e,i="compass")=>{n(r=>{const{smoothHeading:s,config:o}=t();if(s===null){r.smoothHeading=e,r.heading=e;return}let a=e-s;a>180&&(a-=360),a<-180&&(a+=360);const u=i==="compass"?3:o.minRotationSpeed;if(Math.abs(a)<u)return;const h=s+a*o.smoothingFactor;r.smoothHeading=(h+360)%360,r.heading=e})},setWatchId:e=>{n(i=>{i.watchId=e})},resetFirstFix:()=>{n(e=>{e.firstFix=!1})}}))),S4={"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await Qt(async()=>{const{createAHNLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createAHNLayerOL:t}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await Qt(async()=>{const{createGeomorfologieLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createGeomorfologieLayerOL:t}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await Qt(async()=>{const{createBodemkaartLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createBodemkaartLayerOL:t}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await Qt(async()=>{const{createIKAWLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createIKAWLayerOL:t}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await Qt(async()=>{const{createFAMKESteentijdLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createFAMKESteentijdLayerOL:t}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await Qt(async()=>{const{createArcheoLandschappenLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createArcheoLandschappenLayerOL:t}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await Qt(async()=>{const{createRijksmonumentenLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createRijksmonumentenLayerOL:t}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await Qt(async()=>{const{createArcheoOnderzoekenLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createArcheoOnderzoekenLayerOL:t}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await Qt(async()=>{const{createWerelderfgoedLayerOL:t}=await import("./pdokWMSLayers-DTWINMt-.js");return{createWerelderfgoedLayerOL:t}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await Qt(async()=>{const{createTerpenLayerOL:t}=await import("./terpenOL-C7zueMPQ.js");return{createTerpenLayerOL:t}},[]);return n()},immediateLoad:!0},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await Qt(async()=>{const{createLiniesLayerOL:t}=await import("./verdedigingswerkenOL-BOCtf3G8.js");return{createLiniesLayerOL:t}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await Qt(async()=>{const{createInundatiesLayerOL:t}=await import("./verdedigingswerkenOL-BOCtf3G8.js");return{createInundatiesLayerOL:t}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await Qt(async()=>{const{createMilitaireObjectenLayerOL:t}=await import("./verdedigingswerkenOL-BOCtf3G8.js");return{createMilitaireObjectenLayerOL:t}},[]);return n()},immediateLoad:!0},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await Qt(async()=>{const{createAHN4HillshadeLayerOL:t}=await import("./hillshadeLayers-BmFKIQeU.js");return{createAHN4HillshadeLayerOL:t}},[]);return n()},immediateLoad:!0},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await Qt(async()=>{const{createAHN4MultiHillshadeLayerOL:t}=await import("./hillshadeLayers-BmFKIQeU.js");return{createAHN4MultiHillshadeLayerOL:t}},[]);return n()},immediateLoad:!0},"AHN4 Helling NL":{name:"AHN4 Helling NL",factory:async()=>{const{createAHN4SlopeLayerOL:n}=await Qt(async()=>{const{createAHN4SlopeLayerOL:t}=await import("./hillshadeLayers-BmFKIQeU.js");return{createAHN4SlopeLayerOL:t}},[]);return n()},immediateLoad:!0},"World Hillshade":{name:"World Hillshade",factory:async()=>{const{createWorldHillshadeLayerOL:n}=await Qt(async()=>{const{createWorldHillshadeLayerOL:t}=await import("./hillshadeLayers-BmFKIQeU.js");return{createWorldHillshadeLayerOL:t}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await Qt(async()=>{const{createAMKLayerOL:t}=await import("./amkOL-CvnJoHr-.js");return{createAMKLayerOL:t}},__vite__mapDeps([0,1,2]));return n()},immediateLoad:!1},"Romeinse wegen":{name:"Romeinse wegen",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await Qt(async()=>{const{createRomeinseWegenLayerOL:t}=await import("./romeinsOL-BPRLEMA-.js");return{createRomeinseWegenLayerOL:t}},__vite__mapDeps([3,1,2]));return n()},immediateLoad:!1},"Castella (punten)":{name:"Castella (punten)",factory:async()=>{const{createCastellaPuntenLayerOL:n}=await Qt(async()=>{const{createCastellaPuntenLayerOL:t}=await import("./castellaPuntenOL-Cbl-KAvL.js");return{createCastellaPuntenLayerOL:t}},__vite__mapDeps([4,2,5]));return n()},immediateLoad:!1},"Castella (lijnen)":{name:"Castella (lijnen)",factory:async()=>{const{createCastellaLijnenLayerOL:n}=await Qt(async()=>{const{createCastellaLijnenLayerOL:t}=await import("./castellaLijnenOL-r0dxOzVh.js");return{createCastellaLijnenLayerOL:t}},__vite__mapDeps([6,2]));return n()},immediateLoad:!1},Oppida:{name:"Oppida",factory:async()=>{const{createOppidaLayerOL:n}=await Qt(async()=>{const{createOppidaLayerOL:t}=await import("./oppidaOL-CrgJsLHM.js");return{createOppidaLayerOL:t}},__vite__mapDeps([7,2,5]));return n()},immediateLoad:!1},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await Qt(async()=>{const{createKastelenLayerOL:t}=await import("./kastelenOL-Bwx9CyfT.js");return{createKastelenLayerOL:t}},__vite__mapDeps([8,2,5]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await Qt(async()=>{const{createVeengebiedenLayerOL:t}=await import("./veengebiedenOL-BHdNseVt.js");return{createVeengebiedenLayerOL:t}},__vite__mapDeps([9,2]));return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await Qt(async()=>{const{createHunebeddenLayerOL:t}=await import("./hunebeddenOL-CjBKsTP4.js");return{createHunebeddenLayerOL:t}},__vite__mapDeps([10,2,5]));return n()},immediateLoad:!1},"EUROEVOL Sites":{name:"EUROEVOL Sites",factory:async()=>{const{createEuroevolLayerOL:n}=await Qt(async()=>{const{createEuroevolLayerOL:t}=await import("./euroevolOL-D00kBV09.js");return{createEuroevolLayerOL:t}},__vite__mapDeps([11,2,5]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await Qt(async()=>{const{createUIKAVArcheoPuntenLayerOL:t}=await import("./uikavArcheoPuntenOL-bGdBlEZg.js");return{createUIKAVArcheoPuntenLayerOL:t}},__vite__mapDeps([12,2,13,1,5]));return n()},immediateLoad:!1},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await Qt(async()=>{const{createUIKAVVlakkenLayerOL:t}=await import("./uikavVlakkenOL-Cy1K8DJK.js");return{createUIKAVVlakkenLayerOL:t}},__vite__mapDeps([14,2,13,1]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await Qt(async()=>{const{createUIKAVBufferlaagLayerOL:t}=await import("./uikavBufferlaagOL-CEBpYVc-.js");return{createUIKAVBufferlaagLayerOL:t}},__vite__mapDeps([15,2,13,1]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await Qt(async()=>{const{createUIKAVExpertLayerOL:t}=await import("./uikavExpertOL-BADSr80x.js");return{createUIKAVExpertLayerOL:t}},__vite__mapDeps([16,2,13,1]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await Qt(async()=>{const{createUIKAVUiterwaardenLayerOL:t}=await import("./uikavUiterwaardenOL-YQOmu04g.js");return{createUIKAVUiterwaardenLayerOL:t}},__vite__mapDeps([17,2,13,1]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await Qt(async()=>{const{createSpeeltuinenLayerOL:t}=await import("./speeltuinenOL-C8v2anin.js");return{createSpeeltuinenLayerOL:t}},__vite__mapDeps([18,2,13,1,5]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await Qt(async()=>{const{createMuseaLayerOL:t}=await import("./museaOL-BCTR1P1N.js");return{createMuseaLayerOL:t}},__vite__mapDeps([19,2,13,1,5]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await Qt(async()=>{const{createStrandjesLayerOL:t}=await import("./strandjesOL-B6mS4AMD.js");return{createStrandjesLayerOL:t}},__vite__mapDeps([20,2,13,1]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await Qt(async()=>{const{createParkenLayerOL:t}=await import("./parkenOL-CR29JWZA.js");return{createParkenLayerOL:t}},__vite__mapDeps([21,2,13,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await Qt(async()=>{const{createFossielenLayerOL:t}=await import("./fossielenOL-OFMQusCb.js");return{createFossielenLayerOL:t}},__vite__mapDeps([22,5]));return n()},immediateLoad:!1},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await Qt(async()=>{const{createBunkersLayerOL:t}=await import("./bunkersOL-23i1oAUR.js");return{createBunkersLayerOL:t}},__vite__mapDeps([23,2,5]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await Qt(async()=>{const{createGrafheuvelsLayerOL:t}=await import("./grafheuvelsOL-B1UvCWF3.js");return{createGrafheuvelsLayerOL:t}},__vite__mapDeps([24,2,5]));return n()},immediateLoad:!1}};function f9(){return Object.values(S4).filter(n=>n.immediateLoad)}const Ki=Eu()(wu((n,t)=>({map:null,rotation:0,rotationEnabled:!0,setMap:e=>{n(i=>{i.map=e})},setRotation:e=>{n(i=>{if(i.rotation=e,i.map&&i.rotationEnabled){const r=e*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(e=>{e.rotationEnabled=!0})},disableRotation:()=>{n(e=>{e.rotationEnabled=!1,e.rotation=0,e.map&&e.map.getView().animate({rotation:0,duration:500})})}}))),oo=Eu()(wu((n,t)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,"Google Hybride":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"EUROEVOL Sites":!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"Romeinse wegen":!1,"Castella (punten)":!1,"Castella (lijnen)":!1,Oppida:!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,"Archeo Onderzoeken":!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN4 Helling NL":!1,"AHN 0.5m":!1,"World Hillshade":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1},opacity:{"AHN 0.5m":.7,Geomorfologie:.5,Bodemkaart:.6,IKAW:.5,"Archeo Landschappen":.5,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN4 Helling NL":.6,"World Hillshade":.7,Terpen:.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8},loadingState:{},layers:{},toggleLayer:e=>{const i=t(),r=!i.visible[e];n(s=>{s.visible[e]=r}),r&&!i.layers[e]?t().loadLayer(e):i.layers[e]&&i.layers[e].setVisible(r)},setLayerVisibility:(e,i)=>{const r=t();n(s=>{s.visible[e]=i;const o=s.layers[e];o&&o.setVisible(i)}),i&&!r.layers[e]&&t().loadLayer(e)},setLayerOpacity:(e,i)=>{n(r=>{r.opacity[e]=i;const s=r.layers[e];s&&s.setOpacity(i)})},registerLayer:(e,i)=>{n(r=>{r.layers[e]=i,r.loadingState[e]="loaded",r.visible[e]!==void 0&&i.setVisible(r.visible[e]),r.opacity[e]!==void 0&&i.setOpacity(r.opacity[e])})},unregisterLayer:e=>{n(i=>{delete i.layers[e],delete i.loadingState[e]})},loadLayer:async e=>{const i=t();if(i.loadingState[e]==="loading"||i.layers[e])return;const r=S4[e];if(!r){console.warn(` Layer "${e}" not found in registry`);return}const s=Ki.getState().map;if(!s){console.warn(` Cannot load layer "${e}": map not initialized`);return}n(o=>{o.loadingState[e]="loading"}),console.log(` Loading layer: ${e}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const a=t();o.setVisible(a.visible[e]??!1),a.opacity[e]!==void 0&&o.setOpacity(a.opacity[e]),s.addLayer(o),n(u=>{u.layers[e]=o,u.loadingState[e]="loaded"}),console.log(` Layer loaded: ${e}`)}catch(o){console.error(` Failed to load layer "${e}":`,o),n(a=>{a.loadingState[e]="error"})}}}))),AE=Eu()(wu((n,t)=>({layerControlOpen:!1,legendOpen:!1,collapsedCategories:new Set,toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleLegend:()=>{n(e=>{e.legendOpen=!e.legendOpen})},toggleCategory:e=>{n(i=>{i.collapsedCategories.has(e)?i.collapsedCategories.delete(e):i.collapsedCategories.add(e)})},setLayerControlOpen:e=>{n(i=>{i.layerControlOpen=e})},setLegendOpen:e=>{n(i=>{i.legendOpen=e})}})));Eu()(wu(n=>({user:null,loading:!0,error:null,setUser:t=>{n(e=>{e.user=t,e.loading=!1})},setLoading:t=>{n(e=>{e.loading=t})},setError:t=>{n(e=>{e.error=t})}})));const g9=()=>{};var QA={};const I4=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?t[e++]=r:r<2048?(t[e++]=r>>6|192,t[e++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=r>>18|240,t[e++]=r>>12&63|128,t[e++]=r>>6&63|128,t[e++]=r&63|128):(t[e++]=r>>12|224,t[e++]=r>>6&63|128,t[e++]=r&63|128)}return t},m9=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const r=n[e++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[e++];t[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[e++],o=n[e++],a=n[e++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(u>>10)),t[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[e++],o=n[e++];t[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return t.join("")},A4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,d=s>>2,g=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,v=h&63;u||(v=64,o||(m=64)),i.push(e[d],e[g],e[m],e[v])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(I4(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):m9(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=e[n.charAt(r++)],a=r<n.length?e[n.charAt(r)]:0;++r;const h=r<n.length?e[n.charAt(r)]:64;++r;const g=r<n.length?e[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||g==null)throw new p9;const m=s<<2|a>>4;if(i.push(m),h!==64){const v=a<<4&240|h>>2;if(i.push(v),g!==64){const y=h<<6&192|g;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class p9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _9=function(n){const t=I4(n);return A4.encodeByteArray(t,!0)},S0=function(n){return _9(n).replace(/\./g,"")},R4=function(n){try{return A4.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function P4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const y9=()=>P4().__FIREBASE_DEFAULTS__,v9=()=>{if(typeof process>"u"||typeof QA>"u")return;const n=QA.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},E9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&R4(n[1]);return t&&JSON.parse(t)},O_=()=>{try{return g9()||y9()||v9()||E9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},C4=n=>O_()?.emulatorHosts?.[n],M4=n=>{const t=C4(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},b4=()=>O_()?.config,k4=n=>O_()?.[`_${n}`];class w9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function xu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ex(n){return(await fetch(n,{credentials:"include"})).ok}function L4(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[S0(JSON.stringify(e)),S0(JSON.stringify(o)),""].join(".")}const lf={};function x9(){const n={prod:[],emulator:[]};for(const t of Object.keys(lf))lf[t]?n.emulator.push(t):n.prod.push(t);return n}function T9(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let JA=!1;function wx(n,t){if(typeof window>"u"||typeof document>"u"||!xu(window.location.host)||lf[n]===t||lf[n]||JA)return;lf[n]=t;function e(m){return`__firebase__banner__${m}`}const i="__firebase__banner",s=x9().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{JA=!0,o()},m}function d(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=T9(i),v=e("text"),y=document.getElementById(v)||document.createElement("span"),S=e("learnmore"),w=document.getElementById(S)||document.createElement("a"),R=e("preprendIcon"),P=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const M=m.element;a(M),d(w,S);const L=h();u(P,R),M.append(P,y,w,L),document.body.appendChild(M)}s?(y.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function S9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function D4(){const n=O_()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function I9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function A9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function R9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function P9(){const n=pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function N4(){return!D4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function O4(){return!D4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function V4(){try{return typeof indexedDB=="object"}catch{return!1}}function C9(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{t(r.error?.message||"")}}catch(e){t(e)}})}const M9="FirebaseError";class Os extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=M9,Object.setPrototypeOf(this,Os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sg.prototype.create)}}class Sg{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},r=`${this.service}/${t}`,s=this.errors[t],o=s?b9(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Os(r,a,i)}}function b9(n,t){return n.replace(k9,(e,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const k9=/\{\$([^}]+)}/g;function L9(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function su(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const r of e){if(!i.includes(r))return!1;const s=n[r],o=t[r];if(tR(s)&&tR(o)){if(!su(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!e.includes(r))return!1;return!0}function tR(n){return n!==null&&typeof n=="object"}function Ig(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function D9(n,t){const e=new N9(n,t);return e.subscribe.bind(e)}class N9{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,i){let r;if(t===void 0&&e===void 0&&i===void 0)throw new Error("Missing Observer.");O9(t,["next","error","complete"])?r=t:r={next:t,error:e,complete:i},r.next===void 0&&(r.next=v1),r.error===void 0&&(r.error=v1),r.complete===void 0&&(r.complete=v1);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function O9(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function v1(){}function ni(n){return n&&n._delegate?n._delegate:n}class Da{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Al="[DEFAULT]";class V9{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new w9;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),i=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(G9(t))try{this.getOrInitializeService({instanceIdentifier:Al})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=Al){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Al){return this.instances.has(t)}getOptions(t=Al){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(t,e){const i=this.normalizeInstanceIdentifier(e),r=this.onInitCallbacks.get(i)??new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const r of i)try{r(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:F9(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Al){return this.component?this.component.multipleInstances?t:Al:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function F9(n){return n===Al?void 0:n}function G9(n){return n.instantiationMode==="EAGER"}class U9{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new V9(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Jt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Jt||(Jt={}));const j9={debug:Jt.DEBUG,verbose:Jt.VERBOSE,info:Jt.INFO,warn:Jt.WARN,error:Jt.ERROR,silent:Jt.SILENT},z9=Jt.INFO,B9={[Jt.DEBUG]:"log",[Jt.VERBOSE]:"log",[Jt.INFO]:"info",[Jt.WARN]:"warn",[Jt.ERROR]:"error"},$9=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),r=B9[t];if(r)console[r](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class xx{constructor(t){this.name=t,this._logLevel=z9,this._logHandler=$9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Jt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?j9[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Jt.DEBUG,...t),this._logHandler(this,Jt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Jt.VERBOSE,...t),this._logHandler(this,Jt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Jt.INFO,...t),this._logHandler(this,Jt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Jt.WARN,...t),this._logHandler(this,Jt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Jt.ERROR,...t),this._logHandler(this,Jt.ERROR,...t)}}const W9=(n,t)=>t.some(e=>n instanceof e);let eR,nR;function K9(){return eR||(eR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function q9(){return nR||(nR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const F4=new WeakMap,RE=new WeakMap,G4=new WeakMap,E1=new WeakMap,Tx=new WeakMap;function H9(n){const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{e(Aa(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&F4.set(e,n)}).catch(()=>{}),Tx.set(t,n),t}function X9(n){if(RE.has(n))return;const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{e(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});RE.set(n,t)}let PE={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return RE.get(n);if(t==="objectStoreNames")return n.objectStoreNames||G4.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Aa(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function Y9(n){PE=n(PE)}function Z9(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(w1(this),t,...e);return G4.set(i,t.sort?t.sort():[t]),Aa(i)}:q9().includes(n)?function(...t){return n.apply(w1(this),t),Aa(F4.get(this))}:function(...t){return Aa(n.apply(w1(this),t))}}function Q9(n){return typeof n=="function"?Z9(n):(n instanceof IDBTransaction&&X9(n),W9(n,K9())?new Proxy(n,PE):n)}function Aa(n){if(n instanceof IDBRequest)return H9(n);if(E1.has(n))return E1.get(n);const t=Q9(n);return t!==n&&(E1.set(n,t),Tx.set(t,n)),t}const w1=n=>Tx.get(n);function J9(n,t,{blocked:e,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,t),a=Aa(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Aa(o.result),u.oldVersion,u.newVersion,Aa(o.transaction),u)}),e&&o.addEventListener("blocked",u=>e(u.oldVersion,u.newVersion,u)),a.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const t7=["get","getKey","getAll","getAllKeys","count"],e7=["put","add","delete","clear"],x1=new Map;function iR(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(x1.get(t))return x1.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,r=e7.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(r||t7.includes(e)))return;const s=async function(o,...a){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[e](...a),r&&u.done]))[0]};return x1.set(t,s),s}Y9(n=>({...n,get:(t,e,i)=>iR(t,e)||n.get(t,e,i),has:(t,e)=>!!iR(t,e)||n.has(t,e)}));class n7{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(i7(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function i7(n){return n.getComponent()?.type==="VERSION"}const CE="@firebase/app",rR="0.14.6";const yo=new xx("@firebase/app"),r7="@firebase/app-compat",s7="@firebase/analytics-compat",o7="@firebase/analytics",a7="@firebase/app-check-compat",l7="@firebase/app-check",u7="@firebase/auth",c7="@firebase/auth-compat",h7="@firebase/database",d7="@firebase/data-connect",f7="@firebase/database-compat",g7="@firebase/functions",m7="@firebase/functions-compat",p7="@firebase/installations",_7="@firebase/installations-compat",y7="@firebase/messaging",v7="@firebase/messaging-compat",E7="@firebase/performance",w7="@firebase/performance-compat",x7="@firebase/remote-config",T7="@firebase/remote-config-compat",S7="@firebase/storage",I7="@firebase/storage-compat",A7="@firebase/firestore",R7="@firebase/ai",P7="@firebase/firestore-compat",C7="firebase",M7="12.6.0";const ME="[DEFAULT]",b7={[CE]:"fire-core",[r7]:"fire-core-compat",[o7]:"fire-analytics",[s7]:"fire-analytics-compat",[l7]:"fire-app-check",[a7]:"fire-app-check-compat",[u7]:"fire-auth",[c7]:"fire-auth-compat",[h7]:"fire-rtdb",[d7]:"fire-data-connect",[f7]:"fire-rtdb-compat",[g7]:"fire-fn",[m7]:"fire-fn-compat",[p7]:"fire-iid",[_7]:"fire-iid-compat",[y7]:"fire-fcm",[v7]:"fire-fcm-compat",[E7]:"fire-perf",[w7]:"fire-perf-compat",[x7]:"fire-rc",[T7]:"fire-rc-compat",[S7]:"fire-gcs",[I7]:"fire-gcs-compat",[A7]:"fire-fst",[P7]:"fire-fst-compat",[R7]:"fire-vertex","fire-js":"fire-js",[C7]:"fire-js-all"};const I0=new Map,k7=new Map,bE=new Map;function sR(n,t){try{n.container.addComponent(t)}catch(e){yo.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function ou(n){const t=n.name;if(bE.has(t))return yo.debug(`There were multiple attempts to register component ${t}.`),!1;bE.set(t,n);for(const e of I0.values())sR(e,n);for(const e of k7.values())sR(e,n);return!0}function V_(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function $r(n){return n==null?!1:n.settings!==void 0}const L7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ra=new Sg("app","Firebase",L7);class D7{constructor(t,e,i){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Da("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ra.create("app-deleted",{appName:this._name})}}const Tu=M7;function U4(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i={name:ME,automaticDataCollectionEnabled:!0,...t},r=i.name;if(typeof r!="string"||!r)throw Ra.create("bad-app-name",{appName:String(r)});if(e||(e=b4()),!e)throw Ra.create("no-options");const s=I0.get(r);if(s){if(su(e,s.options)&&su(i,s.config))return s;throw Ra.create("duplicate-app",{appName:r})}const o=new U9(r);for(const u of bE.values())o.addComponent(u);const a=new D7(e,i,o);return I0.set(r,a),a}function Sx(n=ME){const t=I0.get(n);if(!t&&n===ME&&b4())return U4();if(!t)throw Ra.create("no-app",{appName:n});return t}function Is(n,t,e){let i=b7[n]??n;e&&(i+=`-${e}`);const r=i.match(/\s|\//),s=t.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${t}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),yo.warn(o.join(" "));return}ou(new Da(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const N7="firebase-heartbeat-database",O7=1,zf="firebase-heartbeat-store";let T1=null;function j4(){return T1||(T1=J9(N7,O7,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(zf)}catch(e){console.warn(e)}}}}).catch(n=>{throw Ra.create("idb-open",{originalErrorMessage:n.message})})),T1}async function V7(n){try{const e=(await j4()).transaction(zf),i=await e.objectStore(zf).get(z4(n));return await e.done,i}catch(t){if(t instanceof Os)yo.warn(t.message);else{const e=Ra.create("idb-get",{originalErrorMessage:t?.message});yo.warn(e.message)}}}async function oR(n,t){try{const i=(await j4()).transaction(zf,"readwrite");await i.objectStore(zf).put(t,z4(n)),await i.done}catch(e){if(e instanceof Os)yo.warn(e.message);else{const i=Ra.create("idb-set",{originalErrorMessage:e?.message});yo.warn(i.message)}}}function z4(n){return`${n.name}!${n.options.appId}`}const F7=1024,G7=30;class U7{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new z7(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=aR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:e}),this._heartbeatsCache.heartbeats.length>G7){const r=B7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){yo.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=aR(),{heartbeatsToSend:e,unsentEntries:i}=j7(this._heartbeatsCache.heartbeats),r=S0(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return yo.warn(t),""}}}function aR(){return new Date().toISOString().substring(0,10)}function j7(n,t=F7){const e=[];let i=n.slice();for(const r of n){const s=e.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),lR(e)>t){s.dates.pop();break}}else if(e.push({agent:r.agent,dates:[r.date]}),lR(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class z7{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return V4()?C9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await V7(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return oR(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return oR(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function lR(n){return S0(JSON.stringify({version:2,heartbeats:n})).length}function B7(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let i=1;i<n.length;i++)n[i].date<e&&(e=n[i].date,t=i);return t}function $7(n){ou(new Da("platform-logger",t=>new n7(t),"PRIVATE")),ou(new Da("heartbeat",t=>new U7(t),"PRIVATE")),Is(CE,rR,n),Is(CE,rR,"esm2020"),Is("fire-js","")}$7("");var uR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Pa,B4;(function(){var n;function t(b,A){function k(){}k.prototype=A.prototype,b.F=A.prototype,b.prototype=new k,b.prototype.constructor=b,b.D=function(V,F,U){for(var N=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)N[ut-2]=arguments[ut];return A.prototype[F].apply(V,N)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,e),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(b,A,k){k||(k=0);const V=Array(16);if(typeof A=="string")for(var F=0;F<16;++F)V[F]=A.charCodeAt(k++)|A.charCodeAt(k++)<<8|A.charCodeAt(k++)<<16|A.charCodeAt(k++)<<24;else for(F=0;F<16;++F)V[F]=A[k++]|A[k++]<<8|A[k++]<<16|A[k++]<<24;A=b.g[0],k=b.g[1],F=b.g[2];let U=b.g[3],N;N=A+(U^k&(F^U))+V[0]+3614090360&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(F^A&(k^F))+V[1]+3905402710&4294967295,U=A+(N<<12&4294967295|N>>>20),N=F+(k^U&(A^k))+V[2]+606105819&4294967295,F=U+(N<<17&4294967295|N>>>15),N=k+(A^F&(U^A))+V[3]+3250441966&4294967295,k=F+(N<<22&4294967295|N>>>10),N=A+(U^k&(F^U))+V[4]+4118548399&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(F^A&(k^F))+V[5]+1200080426&4294967295,U=A+(N<<12&4294967295|N>>>20),N=F+(k^U&(A^k))+V[6]+2821735955&4294967295,F=U+(N<<17&4294967295|N>>>15),N=k+(A^F&(U^A))+V[7]+4249261313&4294967295,k=F+(N<<22&4294967295|N>>>10),N=A+(U^k&(F^U))+V[8]+1770035416&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(F^A&(k^F))+V[9]+2336552879&4294967295,U=A+(N<<12&4294967295|N>>>20),N=F+(k^U&(A^k))+V[10]+4294925233&4294967295,F=U+(N<<17&4294967295|N>>>15),N=k+(A^F&(U^A))+V[11]+2304563134&4294967295,k=F+(N<<22&4294967295|N>>>10),N=A+(U^k&(F^U))+V[12]+1804603682&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(F^A&(k^F))+V[13]+4254626195&4294967295,U=A+(N<<12&4294967295|N>>>20),N=F+(k^U&(A^k))+V[14]+2792965006&4294967295,F=U+(N<<17&4294967295|N>>>15),N=k+(A^F&(U^A))+V[15]+1236535329&4294967295,k=F+(N<<22&4294967295|N>>>10),N=A+(F^U&(k^F))+V[1]+4129170786&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^F&(A^k))+V[6]+3225465664&4294967295,U=A+(N<<9&4294967295|N>>>23),N=F+(A^k&(U^A))+V[11]+643717713&4294967295,F=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(F^U))+V[0]+3921069994&4294967295,k=F+(N<<20&4294967295|N>>>12),N=A+(F^U&(k^F))+V[5]+3593408605&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^F&(A^k))+V[10]+38016083&4294967295,U=A+(N<<9&4294967295|N>>>23),N=F+(A^k&(U^A))+V[15]+3634488961&4294967295,F=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(F^U))+V[4]+3889429448&4294967295,k=F+(N<<20&4294967295|N>>>12),N=A+(F^U&(k^F))+V[9]+568446438&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^F&(A^k))+V[14]+3275163606&4294967295,U=A+(N<<9&4294967295|N>>>23),N=F+(A^k&(U^A))+V[3]+4107603335&4294967295,F=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(F^U))+V[8]+1163531501&4294967295,k=F+(N<<20&4294967295|N>>>12),N=A+(F^U&(k^F))+V[13]+2850285829&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^F&(A^k))+V[2]+4243563512&4294967295,U=A+(N<<9&4294967295|N>>>23),N=F+(A^k&(U^A))+V[7]+1735328473&4294967295,F=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(F^U))+V[12]+2368359562&4294967295,k=F+(N<<20&4294967295|N>>>12),N=A+(k^F^U)+V[5]+4294588738&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^F)+V[8]+2272392833&4294967295,U=A+(N<<11&4294967295|N>>>21),N=F+(U^A^k)+V[11]+1839030562&4294967295,F=U+(N<<16&4294967295|N>>>16),N=k+(F^U^A)+V[14]+4259657740&4294967295,k=F+(N<<23&4294967295|N>>>9),N=A+(k^F^U)+V[1]+2763975236&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^F)+V[4]+1272893353&4294967295,U=A+(N<<11&4294967295|N>>>21),N=F+(U^A^k)+V[7]+4139469664&4294967295,F=U+(N<<16&4294967295|N>>>16),N=k+(F^U^A)+V[10]+3200236656&4294967295,k=F+(N<<23&4294967295|N>>>9),N=A+(k^F^U)+V[13]+681279174&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^F)+V[0]+3936430074&4294967295,U=A+(N<<11&4294967295|N>>>21),N=F+(U^A^k)+V[3]+3572445317&4294967295,F=U+(N<<16&4294967295|N>>>16),N=k+(F^U^A)+V[6]+76029189&4294967295,k=F+(N<<23&4294967295|N>>>9),N=A+(k^F^U)+V[9]+3654602809&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^F)+V[12]+3873151461&4294967295,U=A+(N<<11&4294967295|N>>>21),N=F+(U^A^k)+V[15]+530742520&4294967295,F=U+(N<<16&4294967295|N>>>16),N=k+(F^U^A)+V[2]+3299628645&4294967295,k=F+(N<<23&4294967295|N>>>9),N=A+(F^(k|~U))+V[0]+4096336452&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~F))+V[7]+1126891415&4294967295,U=A+(N<<10&4294967295|N>>>22),N=F+(A^(U|~k))+V[14]+2878612391&4294967295,F=U+(N<<15&4294967295|N>>>17),N=k+(U^(F|~A))+V[5]+4237533241&4294967295,k=F+(N<<21&4294967295|N>>>11),N=A+(F^(k|~U))+V[12]+1700485571&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~F))+V[3]+2399980690&4294967295,U=A+(N<<10&4294967295|N>>>22),N=F+(A^(U|~k))+V[10]+4293915773&4294967295,F=U+(N<<15&4294967295|N>>>17),N=k+(U^(F|~A))+V[1]+2240044497&4294967295,k=F+(N<<21&4294967295|N>>>11),N=A+(F^(k|~U))+V[8]+1873313359&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~F))+V[15]+4264355552&4294967295,U=A+(N<<10&4294967295|N>>>22),N=F+(A^(U|~k))+V[6]+2734768916&4294967295,F=U+(N<<15&4294967295|N>>>17),N=k+(U^(F|~A))+V[13]+1309151649&4294967295,k=F+(N<<21&4294967295|N>>>11),N=A+(F^(k|~U))+V[4]+4149444226&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~F))+V[11]+3174756917&4294967295,U=A+(N<<10&4294967295|N>>>22),N=F+(A^(U|~k))+V[2]+718787259&4294967295,F=U+(N<<15&4294967295|N>>>17),N=k+(U^(F|~A))+V[9]+3951481745&4294967295,b.g[0]=b.g[0]+A&4294967295,b.g[1]=b.g[1]+(F+(N<<21&4294967295|N>>>11))&4294967295,b.g[2]=b.g[2]+F&4294967295,b.g[3]=b.g[3]+U&4294967295}i.prototype.v=function(b,A){A===void 0&&(A=b.length);const k=A-this.blockSize,V=this.C;let F=this.h,U=0;for(;U<A;){if(F==0)for(;U<=k;)r(this,b,U),U+=this.blockSize;if(typeof b=="string"){for(;U<A;)if(V[F++]=b.charCodeAt(U++),F==this.blockSize){r(this,V),F=0;break}}else for(;U<A;)if(V[F++]=b[U++],F==this.blockSize){r(this,V),F=0;break}}this.h=F,this.o+=A},i.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var A=1;A<b.length-8;++A)b[A]=0;A=this.o*8;for(var k=b.length-8;k<b.length;++k)b[k]=A&255,A/=256;for(this.v(b),b=Array(16),A=0,k=0;k<4;++k)for(let V=0;V<32;V+=8)b[A++]=this.g[k]>>>V&255;return b};function s(b,A){var k=a;return Object.prototype.hasOwnProperty.call(k,b)?k[b]:k[b]=A(b)}function o(b,A){this.h=A;const k=[];let V=!0;for(let F=b.length-1;F>=0;F--){const U=b[F]|0;V&&U==A||(k[F]=U,V=!1)}this.g=k}var a={};function u(b){return-128<=b&&b<128?s(b,function(A){return new o([A|0],A<0?-1:0)}):new o([b|0],b<0?-1:0)}function h(b){if(isNaN(b)||!isFinite(b))return g;if(b<0)return w(h(-b));const A=[];let k=1;for(let V=0;b>=k;V++)A[V]=b/k|0,k*=4294967296;return new o(A,0)}function d(b,A){if(b.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(b.charAt(0)=="-")return w(d(b.substring(1),A));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=h(Math.pow(A,8));let V=g;for(let U=0;U<b.length;U+=8){var F=Math.min(8,b.length-U);const N=parseInt(b.substring(U,U+F),A);F<8?(F=h(Math.pow(A,F)),V=V.j(F).add(h(N))):(V=V.j(k),V=V.add(h(N)))}return V}var g=u(0),m=u(1),v=u(16777216);n=o.prototype,n.m=function(){if(S(this))return-w(this).m();let b=0,A=1;for(let k=0;k<this.g.length;k++){const V=this.i(k);b+=(V>=0?V:4294967296+V)*A,A*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(y(this))return"0";if(S(this))return"-"+w(this).toString(b);const A=h(Math.pow(b,6));var k=this;let V="";for(;;){const F=L(k,A).g;k=R(k,F.j(A));let U=((k.g.length>0?k.g[0]:k.h)>>>0).toString(b);if(k=F,y(k))return U+V;for(;U.length<6;)U="0"+U;V=U+V}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function y(b){if(b.h!=0)return!1;for(let A=0;A<b.g.length;A++)if(b.g[A]!=0)return!1;return!0}function S(b){return b.h==-1}n.l=function(b){return b=R(this,b),S(b)?-1:y(b)?0:1};function w(b){const A=b.g.length,k=[];for(let V=0;V<A;V++)k[V]=~b.g[V];return new o(k,~b.h).add(m)}n.abs=function(){return S(this)?w(this):this},n.add=function(b){const A=Math.max(this.g.length,b.g.length),k=[];let V=0;for(let F=0;F<=A;F++){let U=V+(this.i(F)&65535)+(b.i(F)&65535),N=(U>>>16)+(this.i(F)>>>16)+(b.i(F)>>>16);V=N>>>16,U&=65535,N&=65535,k[F]=N<<16|U}return new o(k,k[k.length-1]&-2147483648?-1:0)};function R(b,A){return b.add(w(A))}n.j=function(b){if(y(this)||y(b))return g;if(S(this))return S(b)?w(this).j(w(b)):w(w(this).j(b));if(S(b))return w(this.j(w(b)));if(this.l(v)<0&&b.l(v)<0)return h(this.m()*b.m());const A=this.g.length+b.g.length,k=[];for(var V=0;V<2*A;V++)k[V]=0;for(V=0;V<this.g.length;V++)for(let F=0;F<b.g.length;F++){const U=this.i(V)>>>16,N=this.i(V)&65535,ut=b.i(F)>>>16,wt=b.i(F)&65535;k[2*V+2*F]+=N*wt,P(k,2*V+2*F),k[2*V+2*F+1]+=U*wt,P(k,2*V+2*F+1),k[2*V+2*F+1]+=N*ut,P(k,2*V+2*F+1),k[2*V+2*F+2]+=U*ut,P(k,2*V+2*F+2)}for(b=0;b<A;b++)k[b]=k[2*b+1]<<16|k[2*b];for(b=A;b<2*A;b++)k[b]=0;return new o(k,0)};function P(b,A){for(;(b[A]&65535)!=b[A];)b[A+1]+=b[A]>>>16,b[A]&=65535,A++}function M(b,A){this.g=b,this.h=A}function L(b,A){if(y(A))throw Error("division by zero");if(y(b))return new M(g,g);if(S(b))return A=L(w(b),A),new M(w(A.g),w(A.h));if(S(A))return A=L(b,w(A)),new M(w(A.g),A.h);if(b.g.length>30){if(S(b)||S(A))throw Error("slowDivide_ only works with positive integers.");for(var k=m,V=A;V.l(b)<=0;)k=D(k),V=D(V);var F=j(k,1),U=j(V,1);for(V=j(V,2),k=j(k,2);!y(V);){var N=U.add(V);N.l(b)<=0&&(F=F.add(k),U=N),V=j(V,1),k=j(k,1)}return A=R(b,F.j(A)),new M(F,A)}for(F=g;b.l(A)>=0;){for(k=Math.max(1,Math.floor(b.m()/A.m())),V=Math.ceil(Math.log(k)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),U=h(k),N=U.j(A);S(N)||N.l(b)>0;)k-=V,U=h(k),N=U.j(A);y(U)&&(U=m),F=F.add(U),b=R(b,N)}return new M(F,b)}n.B=function(b){return L(this,b).h},n.and=function(b){const A=Math.max(this.g.length,b.g.length),k=[];for(let V=0;V<A;V++)k[V]=this.i(V)&b.i(V);return new o(k,this.h&b.h)},n.or=function(b){const A=Math.max(this.g.length,b.g.length),k=[];for(let V=0;V<A;V++)k[V]=this.i(V)|b.i(V);return new o(k,this.h|b.h)},n.xor=function(b){const A=Math.max(this.g.length,b.g.length),k=[];for(let V=0;V<A;V++)k[V]=this.i(V)^b.i(V);return new o(k,this.h^b.h)};function D(b){const A=b.g.length+1,k=[];for(let V=0;V<A;V++)k[V]=b.i(V)<<1|b.i(V-1)>>>31;return new o(k,b.h)}function j(b,A){const k=A>>5;A%=32;const V=b.g.length-k,F=[];for(let U=0;U<V;U++)F[U]=A>0?b.i(U+k)>>>A|b.i(U+k+1)<<32-A:b.i(U+k);return new o(F,b.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,B4=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,Pa=o}).apply(typeof uR<"u"?uR:typeof self<"u"?self:typeof window<"u"?window:{});var pp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $4,Hd,W4,Np,kE,K4,q4,H4;(function(){var n,t=Object.defineProperty;function e(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof pp=="object"&&pp];for(var T=0;T<p.length;++T){var I=p[T];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=e(this);function r(p,T){if(T)t:{var I=i;p=p.split(".");for(var O=0;O<p.length-1;O++){var X=p[O];if(!(X in I))break t;I=I[X]}p=p[p.length-1],O=I[p],T=T(O),T!=O&&T!=null&&t(I,p,{configurable:!0,writable:!0,value:T})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(T){var I=[],O;for(O in T)Object.prototype.hasOwnProperty.call(T,O)&&I.push([O,T[O]]);return I}});var s=s||{},o=this||self;function a(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function u(p,T,I){return p.call.apply(p.bind,arguments)}function h(p,T,I){return h=u,h.apply(null,arguments)}function d(p,T){var I=Array.prototype.slice.call(arguments,1);return function(){var O=I.slice();return O.push.apply(O,arguments),p.apply(this,O)}}function g(p,T){function I(){}I.prototype=T.prototype,p.Z=T.prototype,p.prototype=new I,p.prototype.constructor=p,p.Ob=function(O,X,Q){for(var ft=Array(arguments.length-2),Wt=2;Wt<arguments.length;Wt++)ft[Wt-2]=arguments[Wt];return T.prototype[X].apply(O,ft)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const T=p.length;if(T>0){const I=Array(T);for(let O=0;O<T;O++)I[O]=p[O];return I}return[]}function y(p,T){for(let O=1;O<arguments.length;O++){const X=arguments[O];var I=typeof X;if(I=I!="object"?I:X?Array.isArray(X)?"array":I:"null",I=="array"||I=="object"&&typeof X.length=="number"){I=p.length||0;const Q=X.length||0;p.length=I+Q;for(let ft=0;ft<Q;ft++)p[I+ft]=X[ft]}else p.push(X)}}class S{constructor(T,I){this.i=T,this.j=I,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function w(p){o.setTimeout(()=>{throw p},0)}function R(){var p=b;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class P{constructor(){this.h=this.g=null}add(T,I){const O=M.get();O.set(T,I),this.h?this.h.next=O:this.g=O,this.h=O}}var M=new S(()=>new L,p=>p.reset());class L{constructor(){this.next=this.g=this.h=null}set(T,I){this.h=T,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let D,j=!1,b=new P,A=()=>{const p=Promise.resolve(void 0);D=()=>{p.then(k)}};function k(){for(var p;p=R();){try{p.h.call(p.g)}catch(I){w(I)}var T=M;T.j(p),T.h<100&&(T.h++,p.next=T.g,T.g=p)}j=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};o.addEventListener("test",I,T),o.removeEventListener("test",I,T)}catch{}return p})();function N(p){return/^[\s\xa0]*$/.test(p)}function ut(p,T){F.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,T)}g(ut,F),ut.prototype.init=function(p,T){const I=this.type=p.type,O=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget,T||(I=="mouseover"?T=p.fromElement:I=="mouseout"&&(T=p.toElement)),this.relatedTarget=T,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&ut.Z.h.call(this)},ut.prototype.h=function(){ut.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var wt="closure_listenable_"+(Math.random()*1e6|0),yt=0;function dt(p,T,I,O,X){this.listener=p,this.proxy=null,this.src=T,this.type=I,this.capture=!!O,this.ha=X,this.key=++yt,this.da=this.fa=!1}function J(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function at(p,T,I){for(const O in p)T.call(I,p[O],O,p)}function it(p,T){for(const I in p)T.call(void 0,p[I],I,p)}function $(p){const T={};for(const I in p)T[I]=p[I];return T}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function At(p,T){let I,O;for(let X=1;X<arguments.length;X++){O=arguments[X];for(I in O)p[I]=O[I];for(let Q=0;Q<K.length;Q++)I=K[Q],Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}}function Rt(p){this.src=p,this.g={},this.h=0}Rt.prototype.add=function(p,T,I,O,X){const Q=p.toString();p=this.g[Q],p||(p=this.g[Q]=[],this.h++);const ft=Nt(p,T,O,X);return ft>-1?(T=p[ft],I||(T.fa=!1)):(T=new dt(T,this.src,Q,!!O,X),T.fa=I,p.push(T)),T};function Pt(p,T){const I=T.type;if(I in p.g){var O=p.g[I],X=Array.prototype.indexOf.call(O,T,void 0),Q;(Q=X>=0)&&Array.prototype.splice.call(O,X,1),Q&&(J(T),p.g[I].length==0&&(delete p.g[I],p.h--))}}function Nt(p,T,I,O){for(let X=0;X<p.length;++X){const Q=p[X];if(!Q.da&&Q.listener==T&&Q.capture==!!I&&Q.ha==O)return X}return-1}var Vt="closure_lm_"+(Math.random()*1e6|0),$t={};function Xt(p,T,I,O,X){if(Array.isArray(T)){for(let Q=0;Q<T.length;Q++)Xt(p,T[Q],I,O,X);return null}return I=Ji(I),p&&p[wt]?p.J(T,I,a(O)?!!O.capture:!1,X):ye(p,T,I,!1,O,X)}function ye(p,T,I,O,X,Q){if(!T)throw Error("Invalid event type");const ft=a(X)?!!X.capture:!!X;let Wt=Rn(p);if(Wt||(p[Vt]=Wt=new Rt(p)),I=Wt.add(T,I,O,ft,Q),I.proxy)return I;if(O=Ar(),I.proxy=O,O.src=p,O.listener=I,p.addEventListener)U||(X=ft),X===void 0&&(X=!1),p.addEventListener(T.toString(),O,X);else if(p.attachEvent)p.attachEvent(gi(T.toString()),O);else if(p.addListener&&p.removeListener)p.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Ar(){function p(I){return T.call(p.src,p.listener,I)}const T=An;return p}function Fs(p,T,I,O,X){if(Array.isArray(T))for(var Q=0;Q<T.length;Q++)Fs(p,T[Q],I,O,X);else O=a(O)?!!O.capture:!!O,I=Ji(I),p&&p[wt]?(p=p.i,Q=String(T).toString(),Q in p.g&&(T=p.g[Q],I=Nt(T,I,O,X),I>-1&&(J(T[I]),Array.prototype.splice.call(T,I,1),T.length==0&&(delete p.g[Q],p.h--)))):p&&(p=Rn(p))&&(T=p.g[T.toString()],p=-1,T&&(p=Nt(T,I,O,X)),(I=p>-1?T[p]:null)&&fi(I))}function fi(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[wt])Pt(T.i,p);else{var I=p.type,O=p.proxy;T.removeEventListener?T.removeEventListener(I,O,p.capture):T.detachEvent?T.detachEvent(gi(I),O):T.addListener&&T.removeListener&&T.removeListener(O),(I=Rn(T))?(Pt(I,p),I.h==0&&(I.src=null,T[Vt]=null)):J(p)}}}function gi(p){return p in $t?$t[p]:$t[p]="on"+p}function An(p,T){if(p.da)p=!0;else{T=new ut(T,this);const I=p.listener,O=p.ha||p.src;p.fa&&fi(p),p=I.call(O,T)}return p}function Rn(p){return p=p[Vt],p instanceof Rt?p:null}var mi="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ji(p){return typeof p=="function"?p:(p[mi]||(p[mi]=function(T){return p.handleEvent(T)}),p[mi])}function Re(){V.call(this),this.i=new Rt(this),this.M=this,this.G=null}g(Re,V),Re.prototype[wt]=!0,Re.prototype.removeEventListener=function(p,T,I,O){Fs(this,p,T,I,O)};function ve(p,T){var I,O=p.G;if(O)for(I=[];O;O=O.G)I.push(O);if(p=p.M,O=T.type||T,typeof T=="string")T=new F(T,p);else if(T instanceof F)T.target=T.target||p;else{var X=T;T=new F(O,p),At(T,X)}X=!0;let Q,ft;if(I)for(ft=I.length-1;ft>=0;ft--)Q=T.g=I[ft],X=yn(Q,O,!0,T)&&X;if(Q=T.g=p,X=yn(Q,O,!0,T)&&X,X=yn(Q,O,!1,T)&&X,I)for(ft=0;ft<I.length;ft++)Q=T.g=I[ft],X=yn(Q,O,!1,T)&&X}Re.prototype.N=function(){if(Re.Z.N.call(this),this.i){var p=this.i;for(const T in p.g){const I=p.g[T];for(let O=0;O<I.length;O++)J(I[O]);delete p.g[T],p.h--}}this.G=null},Re.prototype.J=function(p,T,I,O){return this.i.add(String(p),T,!1,I,O)},Re.prototype.K=function(p,T,I,O){return this.i.add(String(p),T,!0,I,O)};function yn(p,T,I,O){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();let X=!0;for(let Q=0;Q<T.length;++Q){const ft=T[Q];if(ft&&!ft.da&&ft.capture==I){const Wt=ft.listener,Qe=ft.ha||ft.src;ft.fa&&Pt(p.i,ft),X=Wt.call(Qe,O)!==!1&&X}}return X&&!O.defaultPrevented}function tr(p,T){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:o.setTimeout(p,T||0)}function De(p){p.g=tr(()=>{p.g=null,p.i&&(p.i=!1,De(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class Co extends V{constructor(T,I){super(),this.m=T,this.l=I,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:De(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function er(p){V.call(this),this.h=p,this.g={}}g(er,V);var Yr=[];function Rr(p){at(p.g,function(T,I){this.g.hasOwnProperty(I)&&fi(T)},p),p.g={}}er.prototype.N=function(){er.Z.N.call(this),Rr(this)},er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zr=o.JSON.stringify,Xa=o.JSON.parse,Qr=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function nr(){}function Pu(){}var Jr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Gs(){F.call(this,"d")}g(Gs,F);function Mo(){F.call(this,"c")}g(Mo,F);var ii={},Us=null;function ts(){return Us=Us||new Re}ii.Ia="serverreachability";function es(p){F.call(this,ii.Ia,p)}g(es,F);function ri(p){const T=ts();ve(T,new es(T))}ii.STAT_EVENT="statevent";function si(p,T){F.call(this,ii.STAT_EVENT,p),this.stat=T}g(si,F);function Ie(p){const T=ts();ve(T,new si(T,p))}ii.Ja="timingevent";function bo(p,T){F.call(this,ii.Ja,p),this.size=T}g(bo,F);function Pr(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},T)}function Ye(){this.g=!0}Ye.prototype.ua=function(){this.g=!1};function ir(p,T,I,O,X,Q){p.info(function(){if(p.g)if(Q){var ft="",Wt=Q.split("&");for(let Ee=0;Ee<Wt.length;Ee++){var Qe=Wt[Ee].split("=");if(Qe.length>1){const sn=Qe[0];Qe=Qe[1];const Fi=sn.split("_");ft=Fi.length>=2&&Fi[1]=="type"?ft+(sn+"="+Qe+"&"):ft+(sn+"=redacted&")}}}else ft=null;else ft=Q;return"XMLHTTP REQ ("+O+") [attempt "+X+"]: "+T+`
`+I+`
`+ft})}function Pn(p,T,I,O,X,Q,ft){p.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+X+"]: "+T+`
`+I+`
`+Q+" "+ft})}function Ze(p,T,I,O){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+Mn(p,I)+(O?" "+O:"")})}function Cn(p,T){p.info(function(){return"TIMEOUT: "+T})}Ye.prototype.info=function(){};function Mn(p,T){if(!p.g)return T;if(!T)return null;try{const Q=JSON.parse(T);if(Q){for(p=0;p<Q.length;p++)if(Array.isArray(Q[p])){var I=Q[p];if(!(I.length<2)){var O=I[1];if(Array.isArray(O)&&!(O.length<1)){var X=O[0];if(X!="noop"&&X!="stop"&&X!="close")for(let ft=1;ft<O.length;ft++)O[ft]=""}}}}return Zr(Q)}catch{return T}}var vn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ce={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rn;function cn(){}g(cn,nr),cn.prototype.g=function(){return new XMLHttpRequest},rn=new cn;function rr(p){return encodeURIComponent(String(p))}function Cu(p){var T=1;p=p.split(":");const I=[];for(;T>0&&p.length;)I.push(p.shift()),T--;return p.length&&I.push(p.join(":")),I}function sr(p,T,I,O){this.j=p,this.i=T,this.l=I,this.S=O||1,this.V=new er(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Xg}function Xg(){this.i=null,this.g="",this.h=!1}var Yg={},Uh={};function Cr(p,T,I){p.M=1,p.A=zs(or(T)),p.u=I,p.R=!0,jh(p,null)}function jh(p,T){p.F=Date.now(),Ya(p),p.B=or(p.A);var I=p.B,O=p.S;Array.isArray(O)||(O=[String(O)]),Zh(I.i,"t",O),p.C=0,I=p.j.L,p.h=new Xg,p.g=om(p.j,I?T:null,!p.u),p.P>0&&(p.O=new Co(h(p.Y,p,p.g),p.P)),T=p.V,I=p.g,O=p.ba;var X="readystatechange";Array.isArray(X)||(X&&(Yr[0]=X.toString()),X=Yr);for(let Q=0;Q<X.length;Q++){const ft=Xt(I,X[Q],O||T.handleEvent,!1,T.h||T);if(!ft)break;T.g[ft.key]=ft}T=p.J?$(p.J):{},p.u?(p.v||(p.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,T)):(p.v="GET",p.g.ea(p.B,p.v,null,T)),ri(),ir(p.i,p.v,p.B,p.l,p.S,p.u)}sr.prototype.ba=function(p){p=p.target;const T=this.O;T&&ls(p)==3?T.j():this.Y(p)},sr.prototype.Y=function(p){try{if(p==this.g)t:{const Wt=ls(this.g),Qe=this.g.ya(),Ee=this.g.ca();if(!(Wt<3)&&(Wt!=3||this.g&&(this.h.h||this.g.la()||rm(this.g)))){this.K||Wt!=4||Qe==7||(Qe==8||Ee<=0?ri(3):ri(2)),Mu(this);var T=this.g.ca();this.X=T;var I=Zg(this);if(this.o=T==200,Pn(this.i,this.v,this.B,this.l,this.S,Wt,T),this.o){if(this.U&&!this.L){e:{if(this.g){var O,X=this.g;if((O=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(O)){var Q=O;break e}}Q=null}if(p=Q)Ze(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ce(this,p);else{this.o=!1,this.m=3,Ie(12),js(this),Za(this);break t}}if(this.R){p=!0;let sn;for(;!this.K&&this.C<I.length;)if(sn=Jg(this,I),sn==Uh){Wt==4&&(this.m=4,Ie(14),p=!1),Ze(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==Yg){this.m=4,Ie(15),Ze(this.i,this.l,I,"[Invalid Chunk]"),p=!1;break}else Ze(this.i,this.l,sn,null),Ce(this,sn);if(Qg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Wt!=4||I.length!=0||this.h.h||(this.m=1,Ie(16),p=!1),this.o=this.o&&p,!p)Ze(this.i,this.l,I,"[Invalid Chunked Response]"),js(this),Za(this);else if(I.length>0&&!this.W){this.W=!0;var ft=this.j;ft.g==this&&ft.aa&&!ft.P&&(ft.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),ol(ft),ft.P=!0,Ie(11))}}else Ze(this.i,this.l,I,null),Ce(this,I);Wt==4&&js(this),this.o&&!this.K&&(Wt==4?Uu(this.j,this):(this.o=!1,Ya(this)))}else Jh(this.g),T==400&&I.indexOf("Unknown SID")>0?(this.m=3,Ie(12)):(this.m=0,Ie(13)),js(this),Za(this)}}}catch{}};function Zg(p){if(!Qg(p))return p.g.la();const T=rm(p.g);if(T==="")return"";let I="";const O=T.length,X=ls(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return js(p),Za(p),"";p.h.i=new o.TextDecoder}for(let Q=0;Q<O;Q++)p.h.h=!0,I+=p.h.i.decode(T[Q],{stream:!(X&&Q==O-1)});return T.length=0,p.h.g+=I,p.C=0,p.h.g}function Qg(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Jg(p,T){var I=p.C,O=T.indexOf(`
`,I);return O==-1?Uh:(I=Number(T.substring(I,O)),isNaN(I)?Yg:(O+=1,O+I>T.length?Uh:(T=T.slice(O,O+I),p.C=O+I,T)))}sr.prototype.cancel=function(){this.K=!0,js(this)};function Ya(p){p.T=Date.now()+p.H,zh(p,p.H)}function zh(p,T){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Pr(h(p.aa,p),T)}function Mu(p){p.D&&(o.clearTimeout(p.D),p.D=null)}sr.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Cn(this.i,this.B),this.M!=2&&(ri(),Ie(17)),js(this),this.m=2,Za(this)):zh(this,this.T-p)};function Za(p){p.j.I==0||p.K||Uu(p.j,p)}function js(p){Mu(p);var T=p.O;T&&typeof T.dispose=="function"&&T.dispose(),p.O=null,Rr(p.V),p.g&&(T=p.g,p.g=null,T.abort(),T.dispose())}function Ce(p,T){try{var I=p.j;if(I.I!=0&&(I.g==p||$h(I.h,p))){if(!p.L&&$h(I.h,p)&&I.I==3){try{var O=I.Ba.g.parse(T)}catch{O=null}if(Array.isArray(O)&&O.length==3){var X=O;if(X[0]==0){t:if(!I.v){if(I.g)if(I.g.F+3e3<p.F)Gu(I),Oi(I);else break t;hs(I),Ie(18)}}else I.xa=X[1],0<I.xa-I.K&&X[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Pr(h(I.Va,I),6e3));Qa(I.h)<=1&&I.ta&&(I.ta=void 0)}else Vi(I,11)}else if((p.L||I.g==p)&&Gu(I),!N(T))for(X=I.Ba.g.parse(T),T=0;T<X.length;T++){let Ee=X[T];const sn=Ee[0];if(!(sn<=I.K))if(I.K=sn,Ee=Ee[1],I.I==2)if(Ee[0]=="c"){I.M=Ee[1],I.ba=Ee[2];const Fi=Ee[3];Fi!=null&&(I.ka=Fi,I.j.info("VER="+I.ka));const qs=Ee[4];qs!=null&&(I.za=qs,I.j.info("SVER="+I.za));const ds=Ee[5];ds!=null&&typeof ds=="number"&&ds>0&&(O=1.5*ds,I.O=O,I.j.info("backChannelRequestTimeoutMs_="+O)),O=I;const fs=p.g;if(fs){const Bu=fs.g?fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bu){var Q=O.h;Q.g||Bu.indexOf("spdy")==-1&&Bu.indexOf("quic")==-1&&Bu.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(ku(Q,Q.h),Q.h=null))}if(O.G){const nd=fs.g?fs.g.getResponseHeader("X-HTTP-Session-Id"):null;nd&&(O.wa=nd,he(O.J,O.G,nd))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-p.F,I.j.info("Handshake RTT: "+I.T+"ms")),O=I;var ft=p;if(O.na=ed(O,O.L?O.ba:null,O.W),ft.L){Ja(O.h,ft);var Wt=ft,Qe=O.O;Qe&&(Wt.H=Qe),Wt.D&&(Mu(Wt),Ya(Wt)),O.g=ft}else jn(O);I.i.length>0&&Ks(I)}else Ee[0]!="stop"&&Ee[0]!="close"||Vi(I,7);else I.I==3&&(Ee[0]=="stop"||Ee[0]=="close"?Ee[0]=="stop"?Vi(I,7):Vu(I):Ee[0]!="noop"&&I.l&&I.l.qa(Ee),I.A=0)}}ri(4)}catch{}}var my=class{constructor(p,T){this.g=p,this.map=T}};function bu(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Bh(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Qa(p){return p.h?1:p.g?p.g.size:0}function $h(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function ku(p,T){p.g?p.g.add(T):p.h=T}function Ja(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}bu.prototype.cancel=function(){if(this.i=Li(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Li(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const I of p.g.values())T=T.concat(I.G);return T}return v(p.i)}var tm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Di(p,T){if(p){p=p.split("&");for(let I=0;I<p.length;I++){const O=p[I].indexOf("=");let X,Q=null;O>=0?(X=p[I].substring(0,O),Q=p[I].substring(O+1)):X=p[I],T(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function ns(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;p instanceof ns?(this.l=p.l,tl(this,p.j),this.o=p.o,this.g=p.g,is(this,p.u),this.h=p.h,ko(this,Qh(p.i)),this.m=p.m):p&&(T=String(p).match(tm))?(this.l=!1,tl(this,T[1]||"",!0),this.o=el(T[2]||""),this.g=el(T[3]||"",!0),is(this,T[4]),this.h=el(T[5]||"",!0),ko(this,T[6]||"",!0),this.m=el(T[7]||"")):(this.l=!1,this.i=new ee(null,this.l))}ns.prototype.toString=function(){const p=[];var T=this.j;T&&p.push(nl(T,Kh,!0),":");var I=this.g;return(I||T=="file")&&(p.push("//"),(T=this.o)&&p.push(nl(T,Kh,!0),"@"),p.push(rr(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&p.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(nl(I,I.charAt(0)=="/"?il:qh,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",nl(I,Hh)),p.join("")},ns.prototype.resolve=function(p){const T=or(this);let I=!!p.j;I?tl(T,p.j):I=!!p.o,I?T.o=p.o:I=!!p.g,I?T.g=p.g:I=p.u!=null;var O=p.h;if(I)is(T,p.u);else if(I=!!p.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var X=T.h.lastIndexOf("/");X!=-1&&(O=T.h.slice(0,X+1)+O)}if(X=O,X==".."||X==".")O="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){O=X.lastIndexOf("/",0)==0,X=X.split("/");const Q=[];for(let ft=0;ft<X.length;){const Wt=X[ft++];Wt=="."?O&&ft==X.length&&Q.push(""):Wt==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),O&&ft==X.length&&Q.push("")):(Q.push(Wt),O=!0)}O=Q.join("/")}else O=X}return I?T.h=O:I=p.i.toString()!=="",I?ko(T,Qh(p.i)):I=!!p.m,I&&(T.m=p.m),T};function or(p){return new ns(p)}function tl(p,T,I){p.j=I?el(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function is(p,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);p.u=T}else p.u=null}function ko(p,T,I){T instanceof ee?(p.i=T,Du(p.i,p.l)):(I||(T=nl(T,py)),p.i=new ee(T,p.l))}function he(p,T,I){p.i.set(T,I)}function zs(p){return he(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function el(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function nl(p,T,I){return typeof p=="string"?(p=encodeURI(p).replace(T,Wh),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Wh(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Kh=/[#\/\?@]/g,qh=/[#\?:]/g,il=/[#\?]/g,py=/[#\?@]/g,Hh=/#/g;function ee(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function rs(p){p.g||(p.g=new Map,p.h=0,p.i&&Di(p.i,function(T,I){p.add(decodeURIComponent(T.replace(/\+/g," ")),I)}))}n=ee.prototype,n.add=function(p,T){rs(this),this.i=null,p=ss(this,p);let I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(T),this.h+=1,this};function Xh(p,T){rs(p),T=ss(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function Lu(p,T){return rs(p),T=ss(p,T),p.g.has(T)}n.forEach=function(p,T){rs(this),this.g.forEach(function(I,O){I.forEach(function(X){p.call(T,X,O,this)},this)},this)};function Yh(p,T){rs(p);let I=[];if(typeof T=="string")Lu(p,T)&&(I=I.concat(p.g.get(ss(p,T))));else for(p=Array.from(p.g.values()),T=0;T<p.length;T++)I=I.concat(p[T]);return I}n.set=function(p,T){return rs(this),this.i=null,p=ss(this,p),Lu(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},n.get=function(p,T){return p?(p=Yh(this,p),p.length>0?String(p[0]):T):T};function Zh(p,T,I){Xh(p,T),I.length>0&&(p.i=null,p.g.set(ss(p,T),v(I)),p.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(let O=0;O<T.length;O++){var I=T[O];const X=rr(I);I=Yh(this,I);for(let Q=0;Q<I.length;Q++){let ft=X;I[Q]!==""&&(ft+="="+rr(I[Q])),p.push(ft)}}return this.i=p.join("&")};function Qh(p){const T=new ee;return T.i=p.i,p.g&&(T.g=new Map(p.g),T.h=p.h),T}function ss(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function Du(p,T){T&&!p.j&&(rs(p),p.i=null,p.g.forEach(function(I,O){const X=O.toLowerCase();O!=X&&(Xh(this,O),Zh(this,X,I))},p)),p.j=T}function os(p,T){const I=new Ye;if(o.Image){const O=new Image;O.onload=d(bn,I,"TestLoadImage: loaded",!0,T,O),O.onerror=d(bn,I,"TestLoadImage: error",!1,T,O),O.onabort=d(bn,I,"TestLoadImage: abort",!1,T,O),O.ontimeout=d(bn,I,"TestLoadImage: timeout",!1,T,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=p}else T(!1)}function as(p,T){const I=new Ye,O=new AbortController,X=setTimeout(()=>{O.abort(),bn(I,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:O.signal}).then(Q=>{clearTimeout(X),Q.ok?bn(I,"TestPingServer: ok",!0,T):bn(I,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(X),bn(I,"TestPingServer: error",!1,T)})}function bn(p,T,I,O,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),O(I)}catch{}}function rl(){this.g=new Qr}function Bs(p){this.i=p.Sb||null,this.h=p.ab||!1}g(Bs,nr),Bs.prototype.g=function(){return new Ni(this.i,this.h)};function Ni(p,T){Re.call(this),this.H=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Ni,Re),n=Ni.prototype,n.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=T,this.readyState=1,Mr(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(T.body=p),(this.H||o).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Lo(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Mr(this)),this.g&&(this.readyState=3,Mr(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;em(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function em(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?Lo(this):Mr(this),this.readyState==3&&em(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Lo(this))},n.Na=function(p){this.g&&(this.response=p,Lo(this))},n.ga=function(){this.g&&Lo(this)};function Lo(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Mr(p)}n.setRequestHeader=function(p,T){this.A.append(p,T)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var I=T.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=T.next();return p.join(`\r
`)};function Mr(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Ni.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function nm(p){let T="";return at(p,function(I,O){T+=O,T+=":",T+=I,T+=`\r
`}),T}function Nu(p,T,I){t:{for(O in I){var O=!1;break t}O=!0}O||(I=nm(I),typeof p=="string"?I!=null&&rr(I):he(p,T,I))}function Ae(p){Re.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(Ae,Re);var im=/^https?$/i,_y=["POST","PUT"];n=Ae.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,T,I,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rn.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(Q){Do(this,Q);return}if(p=I||"",I=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var X in O)I.set(X,O[X]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const Q of O.keys())I.set(Q,O.get(Q));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(I.keys()).find(Q=>Q.toLowerCase()=="content-type"),X=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(_y,T,void 0)>=0)||O||X||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,ft]of I)this.g.setRequestHeader(Q,ft);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Q){Do(this,Q)}};function Do(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.o=5,No(p),Ws(p)}function No(p){p.A||(p.A=!0,ve(p,"complete"),ve(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,ve(this,"complete"),ve(this,"abort"),Ws(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ws(this,!0)),Ae.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?$s(this):this.Xa())},n.Xa=function(){$s(this)};function $s(p){if(p.h&&typeof s<"u"){if(p.v&&ls(p)==4)setTimeout(p.Ca.bind(p),0);else if(ve(p,"readystatechange"),ls(p)==4){p.h=!1;try{const Q=p.ca();t:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break t;default:T=!1}var I;if(!(I=T)){var O;if(O=Q===0){let ft=String(p.D).match(tm)[1]||null;!ft&&o.self&&o.self.location&&(ft=o.self.location.protocol.slice(0,-1)),O=!im.test(ft?ft.toLowerCase():"")}I=O}if(I)ve(p,"complete"),ve(p,"success");else{p.o=6;try{var X=ls(p)>2?p.g.statusText:""}catch{X=""}p.l=X+" ["+p.ca()+"]",No(p)}}finally{Ws(p)}}}}function Ws(p,T){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const I=p.g;p.g=null,T||ve(p,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ls(p){return p.g?p.g.readyState:0}n.ca=function(){try{return ls(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),Xa(T)}};function rm(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Jh(p){const T={};p=(p.g&&ls(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<p.length;O++){if(N(p[O]))continue;var I=Cu(p[O]);const X=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const Q=T[X]||[];T[X]=Q,Q.push(I)}it(T,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function us(p,T,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||T}function Ou(p){this.za=0,this.i=[],this.j=new Ye,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=us("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=us("baseRetryDelayMs",5e3,p),this.Za=us("retryDelaySeedMs",1e4,p),this.Ta=us("forwardChannelMaxRetries",2,p),this.va=us("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new bu(p&&p.concurrentRequestLimit),this.Ba=new rl,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ou.prototype,n.ka=8,n.I=1,n.connect=function(p,T,I,O){Ie(0),this.W=p,this.H=T||{},I&&O!==void 0&&(this.H.OSID=I,this.H.OAID=O),this.F=this.X,this.J=ed(this,null,this.W),Ks(this)};function Vu(p){if(Fu(p),p.I==3){var T=p.V++,I=or(p.J);if(he(I,"SID",p.M),he(I,"RID",T),he(I,"TYPE","terminate"),cs(p,I),T=new sr(p,p.j,T),T.M=2,T.A=zs(or(I)),I=!1,o.navigator&&o.navigator.sendBeacon)try{I=o.navigator.sendBeacon(T.A.toString(),"")}catch{}!I&&o.Image&&(new Image().src=T.A,I=!0),I||(T.g=om(T.j,null),T.g.ea(T.A)),T.F=Date.now(),Ya(T)}al(p)}function Oi(p){p.g&&(ol(p),p.g.cancel(),p.g=null)}function Fu(p){Oi(p),p.v&&(o.clearTimeout(p.v),p.v=null),Gu(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function Ks(p){if(!Bh(p.h)&&!p.m){p.m=!0;var T=p.Ea;D||A(),j||(D(),j=!0),b.add(T,p),p.D=0}}function sm(p,T){return Qa(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=T.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Pr(h(p.Ea,p,T),ju(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const X=new sr(this,this.j,p);let Q=this.o;if(this.U&&(Q?(Q=$(Q),At(Q,this.U)):Q=this.U),this.u!==null||this.R||(X.J=Q,Q=null),this.S)t:{for(var T=0,I=0;I<this.i.length;I++){e:{var O=this.i[I];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break e}O=void 0}if(O===void 0)break;if(T+=O,T>4096){T=I;break t}if(T===4096||I===this.i.length-1){T=I+1;break t}}T=1e3}else T=1e3;T=td(this,X,T),I=or(this.J),he(I,"RID",p),he(I,"CVER",22),this.G&&he(I,"X-HTTP-Session-Id",this.G),cs(this,I),Q&&(this.R?T="headers="+rr(nm(Q))+"&"+T:this.u&&Nu(I,this.u,Q)),ku(this.h,X),this.Ra&&he(I,"TYPE","init"),this.S?(he(I,"$req",T),he(I,"SID","null"),X.U=!0,Cr(X,I,null)):Cr(X,I,T),this.I=2}}else this.I==3&&(p?sl(this,p):this.i.length==0||Bh(this.h)||sl(this))};function sl(p,T){var I;T?I=T.l:I=p.V++;const O=or(p.J);he(O,"SID",p.M),he(O,"RID",I),he(O,"AID",p.K),cs(p,O),p.u&&p.o&&Nu(O,p.u,p.o),I=new sr(p,p.j,I,p.D+1),p.u===null&&(I.J=p.o),T&&(p.i=T.G.concat(p.i)),T=td(p,I,1e3),I.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ku(p.h,I),Cr(I,O,T)}function cs(p,T){p.H&&at(p.H,function(I,O){he(T,O,I)}),p.l&&at({},function(I,O){he(T,O,I)})}function td(p,T,I){I=Math.min(p.i.length,I);const O=p.l?h(p.l.Ka,p.l,p):null;t:{var X=p.i;let Wt=-1;for(;;){const Qe=["count="+I];Wt==-1?I>0?(Wt=X[0].g,Qe.push("ofs="+Wt)):Wt=0:Qe.push("ofs="+Wt);let Ee=!0;for(let sn=0;sn<I;sn++){var Q=X[sn].g;const Fi=X[sn].map;if(Q-=Wt,Q<0)Wt=Math.max(0,X[sn].g-100),Ee=!1;else try{Q="req"+Q+"_"||"";try{var ft=Fi instanceof Map?Fi:Object.entries(Fi);for(const[qs,ds]of ft){let fs=ds;a(ds)&&(fs=Zr(ds)),Qe.push(Q+qs+"="+encodeURIComponent(fs))}}catch(qs){throw Qe.push(Q+"type="+encodeURIComponent("_badmap")),qs}}catch{O&&O(Fi)}}if(Ee){ft=Qe.join("&");break t}}ft=void 0}return p=p.i.splice(0,I),T.G=p,ft}function jn(p){if(!p.g&&!p.v){p.Y=1;var T=p.Da;D||A(),j||(D(),j=!0),b.add(T,p),p.A=0}}function hs(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Pr(h(p.Da,p),ju(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Oo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Pr(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ie(10),Oi(this),Oo(this))};function ol(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Oo(p){p.g=new sr(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var T=or(p.na);he(T,"RID","rpc"),he(T,"SID",p.M),he(T,"AID",p.K),he(T,"CI",p.F?"0":"1"),!p.F&&p.ia&&he(T,"TO",p.ia),he(T,"TYPE","xmlhttp"),cs(p,T),p.u&&p.o&&Nu(T,p.u,p.o),p.O&&(p.g.H=p.O);var I=p.g;p=p.ba,I.M=1,I.A=zs(or(T)),I.u=null,I.R=!0,jh(I,p)}n.Va=function(){this.C!=null&&(this.C=null,Oi(this),hs(this),Ie(19))};function Gu(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function Uu(p,T){var I=null;if(p.g==T){Gu(p),ol(p),p.g=null;var O=2}else if($h(p.h,T))I=T.G,Ja(p.h,T),O=1;else return;if(p.I!=0){if(T.o)if(O==1){I=T.u?T.u.length:0,T=Date.now()-T.F;var X=p.D;O=ts(),ve(O,new bo(O,I)),Ks(p)}else jn(p);else if(X=T.m,X==3||X==0&&T.X>0||!(O==1&&sm(p,T)||O==2&&hs(p)))switch(I&&I.length>0&&(T=p.h,T.i=T.i.concat(I)),X){case 1:Vi(p,5);break;case 4:Vi(p,10);break;case 3:Vi(p,6);break;default:Vi(p,2)}}}function ju(p,T){let I=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(I*=2),I*T}function Vi(p,T){if(p.j.info("Error code "+T),T==2){var I=h(p.bb,p),O=p.Ua;const X=!O;O=new ns(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||tl(O,"https"),zs(O),X?os(O.toString(),I):as(O.toString(),I)}else Ie(2);p.I=0,p.l&&p.l.pa(T),al(p),Fu(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Ie(2)):(this.j.info("Failed to ping google.com"),Ie(1))};function al(p){if(p.I=0,p.ja=[],p.l){const T=Li(p.h);(T.length!=0||p.i.length!=0)&&(y(p.ja,T),y(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function ed(p,T,I){var O=I instanceof ns?or(I):new ns(I);if(O.g!="")T&&(O.g=T+"."+O.g),is(O,O.u);else{var X=o.location;O=X.protocol,T=T?T+"."+X.hostname:X.hostname,X=+X.port;const Q=new ns(null);O&&tl(Q,O),T&&(Q.g=T),X&&is(Q,X),I&&(Q.h=I),O=Q}return I=p.G,T=p.wa,I&&T&&he(O,I,T),he(O,"VER",p.ka),cs(p,O),O}function om(p,T,I){if(T&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Aa&&!p.ma?new Ae(new Bs({ab:I})):new Ae(p.ma),T.Fa(p.L),T}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function am(){}n=am.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function zu(){}zu.prototype.g=function(p,T){return new kn(p,T)};function kn(p,T){Re.call(this),this.g=new Ou(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(p?p["X-WebChannel-Client-Profile"]=T.sa:p={"X-WebChannel-Client-Profile":T.sa}),this.g.U=p,(p=T&&T.Qb)&&!N(p)&&(this.g.u=p),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!N(T)&&(this.g.G=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new Vo(this)}g(kn,Re),kn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){Vu(this.g)},kn.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.v&&(I={},I.__data__=Zr(p),p=I);T.i.push(new my(T.Ya++,p)),T.I==3&&Ks(T)},kn.prototype.N=function(){this.g.l=null,delete this.j,Vu(this.g),delete this.g,kn.Z.N.call(this)};function lm(p){Gs.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){t:{for(const I in T){p=I;break t}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}g(lm,Gs);function um(){Mo.call(this),this.status=1}g(um,Mo);function Vo(p){this.g=p}g(Vo,am),Vo.prototype.ra=function(){ve(this.g,"a")},Vo.prototype.qa=function(p){ve(this.g,new lm(p))},Vo.prototype.pa=function(p){ve(this.g,new um)},Vo.prototype.oa=function(){ve(this.g,"b")},zu.prototype.createWebChannel=zu.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,H4=function(){return new zu},q4=function(){return ts()},K4=ii,kE={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},vn.NO_ERROR=0,vn.TIMEOUT=8,vn.HTTP_ERROR=6,Np=vn,ce.COMPLETE="complete",W4=ce,Pu.EventType=Jr,Jr.OPEN="a",Jr.CLOSE="b",Jr.ERROR="c",Jr.MESSAGE="d",Re.prototype.listen=Re.prototype.J,Hd=Pu,Ae.prototype.listenOnce=Ae.prototype.K,Ae.prototype.getLastError=Ae.prototype.Ha,Ae.prototype.getLastErrorCode=Ae.prototype.ya,Ae.prototype.getStatus=Ae.prototype.ca,Ae.prototype.getResponseJson=Ae.prototype.La,Ae.prototype.getResponseText=Ae.prototype.la,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Fa,$4=Ae}).apply(typeof pp<"u"?pp:typeof self<"u"?self:typeof window<"u"?window:{});const cR="@firebase/firestore",hR="4.9.3";class Vn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Vn.UNAUTHENTICATED=new Vn(null),Vn.GOOGLE_CREDENTIALS=new Vn("google-credentials-uid"),Vn.FIRST_PARTY=new Vn("first-party-uid"),Vn.MOCK_USER=new Vn("mock-user");let bh="12.7.0";const au=new xx("@firebase/firestore");function Pc(){return au.logLevel}function ct(n,...t){if(au.logLevel<=Jt.DEBUG){const e=t.map(Ix);au.debug(`Firestore (${bh}): ${n}`,...e)}}function ui(n,...t){if(au.logLevel<=Jt.ERROR){const e=t.map(Ix);au.error(`Firestore (${bh}): ${n}`,...e)}}function lu(n,...t){if(au.logLevel<=Jt.WARN){const e=t.map(Ix);au.warn(`Firestore (${bh}): ${n}`,...e)}}function Ix(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function Tt(n,t,e){let i="Unexpected state";typeof t=="string"?i=t:e=t,X4(n,i,e)}function X4(n,t,e){let i=`FIRESTORE (${bh}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{i+=" CONTEXT: "+JSON.stringify(e)}catch{i+=" CONTEXT: "+e}throw ui(i),new Error(i)}function Ct(n,t,e,i){let r="Unexpected state";typeof e=="string"?r=e:i=e,n||X4(t,r,i)}function Bt(n,t){return n}const tt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class mt extends Os{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class go{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Y4{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class W7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Vn.UNAUTHENTICATED)))}shutdown(){}}class K7{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class q7{constructor(t){this.t=t,this.currentUser=Vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){Ct(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,e(u)):Promise.resolve();let s=new go;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new go,t.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;t.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},a=u=>{ct("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>a(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(ct("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new go)}}),0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((i=>this.i!==t?(ct("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ct(typeof i.accessToken=="string",31837,{l:i}),new Y4(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Ct(t===null||typeof t=="string",2055,{h:t}),new Vn(t)}}class H7{constructor(t,e,i){this.P=t,this.T=e,this.I=i,this.type="FirstParty",this.user=Vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class X7{constructor(t,e,i){this.P=t,this.T=e,this.I=i}getToken(){return Promise.resolve(new H7(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Vn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dR{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Y7{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$r(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){Ct(this.o===void 0,3512);const i=s=>{s.error!=null&&ct("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ct("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable((()=>i(s)))};const r=s=>{ct("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ct("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dR(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(Ct(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new dR(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Z7(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}class Ax{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=Z7(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<e&&(i+=t.charAt(r[s]%62))}return i}}function zt(n,t){return n<t?-1:n>t?1:0}function LE(n,t){const e=Math.min(n.length,t.length);for(let i=0;i<e;i++){const r=n.charAt(i),s=t.charAt(i);if(r!==s)return S1(r)===S1(s)?zt(r,s):S1(r)?1:-1}return zt(n.length,t.length)}const Q7=55296,J7=57343;function S1(n){const t=n.charCodeAt(0);return t>=Q7&&t<=J7}function hh(n,t,e){return n.length===t.length&&n.every(((i,r)=>e(i,t[r])))}function Z4(n){return n+"\0"}const fR="__name__";class vs{constructor(t,e,i){e===void 0?e=0:e>t.length&&Tt(637,{offset:e,range:t.length}),i===void 0?i=t.length-e:i>t.length-e&&Tt(1746,{length:i,range:t.length-e}),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return vs.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof vs?t.forEach((i=>{e.push(i)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let r=0;r<i;r++){const s=vs.compareSegments(t.get(r),e.get(r));if(s!==0)return s}return zt(t.length,e.length)}static compareSegments(t,e){const i=vs.isNumericId(t),r=vs.isNumericId(e);return i&&!r?-1:!i&&r?1:i&&r?vs.extractNumericId(t).compare(vs.extractNumericId(e)):LE(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Pa.fromString(t.substring(4,t.length-2))}}class fe extends vs{construct(t,e,i){return new fe(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new mt(tt.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((r=>r.length>0)))}return new fe(e)}static emptyPath(){return new fe([])}}const tG=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Be extends vs{construct(t,e,i){return new Be(t,e,i)}static isValidIdentifier(t){return tG.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Be.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fR}static keyField(){return new Be([fR])}static fromServerFormat(t){const e=[];let i="",r=0;const s=()=>{if(i.length===0)throw new mt(tt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let o=!1;for(;r<t.length;){const a=t[r];if(a==="\\"){if(r+1===t.length)throw new mt(tt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new mt(tt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=u,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new mt(tt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Be(e)}static emptyPath(){return new Be([])}}class pt{constructor(t){this.path=t}static fromPath(t){return new pt(fe.fromString(t))}static fromName(t){return new pt(fe.fromString(t).popFirst(5))}static empty(){return new pt(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&fe.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return fe.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new pt(new fe(t.slice()))}}function Q4(n,t,e){if(!e)throw new mt(tt.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function eG(n,t,e,i){if(t===!0&&i===!0)throw new mt(tt.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function gR(n){if(!pt.isDocumentKey(n))throw new mt(tt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mR(n){if(pt.isDocumentKey(n))throw new mt(tt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function J4(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function F_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(i){return i.constructor?i.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":Tt(12329,{type:typeof n})}function Na(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new mt(tt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=F_(n);throw new mt(tt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function ln(n,t){const e={typeString:n};return t&&(e.value=t),e}function Ag(n,t){if(!J4(n))throw new mt(tt.INVALID_ARGUMENT,"JSON must be an object");let e;for(const i in t)if(t[i]){const r=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in n)){e=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){e=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){e=`Expected '${i}' field to equal '${s.value}'`;break}}if(e)throw new mt(tt.INVALID_ARGUMENT,e);return!0}const pR=-62135596800,_R=1e6;class xe{static now(){return xe.fromMillis(Date.now())}static fromDate(t){return xe.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor((t-1e3*e)*_R);return new xe(e,i)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new mt(tt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new mt(tt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<pR)throw new mt(tt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new mt(tt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_R}_compareTo(t){return this.seconds===t.seconds?zt(this.nanoseconds,t.nanoseconds):zt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Ag(t,xe._jsonSchema))return new xe(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-pR;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xe._jsonSchemaVersion="firestore/timestamp/1.0",xe._jsonSchema={type:ln("string",xe._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};class Mt{static fromTimestamp(t){return new Mt(t)}static min(){return new Mt(new xe(0,0))}static max(){return new Mt(new xe(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Bf=-1;class A0{constructor(t,e,i,r){this.indexId=t,this.collectionGroup=e,this.fields=i,this.indexState=r}}function DE(n){return n.fields.find((t=>t.kind===2))}function Rl(n){return n.fields.filter((t=>t.kind!==2))}A0.UNKNOWN_ID=-1;class Op{constructor(t,e){this.fieldPath=t,this.kind=e}}class $f{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new $f(0,Yi.min())}}function nG(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Mt.fromTimestamp(i===1e9?new xe(e+1,0):new xe(e,i));return new Yi(r,pt.empty(),t)}function tk(n){return new Yi(n.readTime,n.key,Bf)}class Yi{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new Yi(Mt.min(),pt.empty(),Bf)}static max(){return new Yi(Mt.max(),pt.empty(),Bf)}}function Rx(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=pt.comparator(n.documentKey,t.documentKey),e!==0?e:zt(n.largestBatchId,t.largestBatchId))}const ek="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Su(n){if(n.code!==tt.FAILED_PRECONDITION||n.message!==ek)throw n;ct("LocalStore","Unexpectedly lost primary lease")}class q{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Tt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new q(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(e,s).next(i,r)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof q?e:q.resolve(e)}catch(e){return q.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):q.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):q.reject(e)}static resolve(t){return new q(((e,i)=>{e(t)}))}static reject(t){return new q(((e,i)=>{i(t)}))}static waitFor(t){return new q(((e,i)=>{let r=0,s=0,o=!1;t.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&e()}),(u=>i(u)))})),o=!0,s===r&&e()}))}static or(t){let e=q.resolve(!1);for(const i of t)e=e.next((r=>r?q.resolve(r):i()));return e}static forEach(t,e){const i=[];return t.forEach(((r,s)=>{i.push(e.call(this,r,s))})),this.waitFor(i)}static mapArray(t,e){return new q(((i,r)=>{const s=t.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const h=u;e(t[h]).next((d=>{o[h]=d,++a,a===s&&i(o)}),(d=>r(d)))}}))}static doWhile(t,e){return new q(((i,r)=>{const s=()=>{t()===!0?e().next((()=>{s()}),r):i()};s()}))}}const zi="SimpleDb";class G_{static open(t,e,i,r){try{return new G_(e,t.transaction(r,i))}catch(s){throw new uf(e,s)}}constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.S=new go,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{e.error?this.S.reject(new uf(t,e.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=Px(i.target.error);this.S.reject(new uf(t,r))}}get D(){return this.S.promise}abort(t){t&&this.S.reject(t),this.aborted||(ct(zi,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){const e=this.transaction.objectStore(t);return new rG(e)}}class Ca{static delete(t){return ct(zi,"Removing database:",t),Dl(P4().indexedDB.deleteDatabase(t)).toPromise()}static v(){if(!V4())return!1;if(Ca.F())return!0;const t=pn(),e=Ca.M(t),i=0<e&&e<10,r=ik(t),s=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(t,e){return t.store(e)}static M(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(t,e,i){this.name=t,this.version=e,this.N=i,this.B=null,Ca.M(pn())===12.2&&ui("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(t){return this.db||(ct(zi,"Opening database:",this.name),this.db=await new Promise(((e,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;e(o)},r.onblocked=()=>{i(new uf(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new mt(tt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new mt(tt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new uf(t,o))},r.onupgradeneeded=s=>{ct(zi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{ct(zi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=e=>this.q(e)),this.db}$(t){this.q=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,i,r){const s=e==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(t);const a=G_.open(this.db,t,s?"readonly":"readwrite",i),u=r(a).next((h=>(a.C(),h))).catch((h=>(a.abort(h),q.reject(h)))).toPromise();return u.catch((()=>{})),await a.D,u}catch(a){const u=a,h=u.name!=="FirebaseError"&&o<3;if(ct(zi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function ik(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}class iG{constructor(t){this.U=t,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(t){this.U=t}done(){this.K=!0}j(t){this.W=t}delete(){return Dl(this.U.delete())}}class uf extends mt{constructor(t,e){super(tt.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Wa(n){return n.name==="IndexedDbTransactionError"}class rG{constructor(t){this.store=t}put(t,e){let i;return e!==void 0?(ct(zi,"PUT",this.store.name,t,e),i=this.store.put(e,t)):(ct(zi,"PUT",this.store.name,"<auto-key>",t),i=this.store.put(t)),Dl(i)}add(t){return ct(zi,"ADD",this.store.name,t,t),Dl(this.store.add(t))}get(t){return Dl(this.store.get(t)).next((e=>(e===void 0&&(e=null),ct(zi,"GET",this.store.name,t,e),e)))}delete(t){return ct(zi,"DELETE",this.store.name,t),Dl(this.store.delete(t))}count(){return ct(zi,"COUNT",this.store.name),Dl(this.store.count())}J(t,e){const i=this.options(t,e),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new q(((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((a,u)=>{o.push(u)})).next((()=>o))}}Y(t,e){const i=this.store.getAll(t,e===null?void 0:e);return new q(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(t,e){ct(zi,"DELETE ALL",this.store.name);const i=this.options(t,e);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,a)=>a.delete()))}ee(t,e){let i;e?i=t:(i={},e=t);const r=this.cursor(i);return this.H(r,e)}te(t){const e=this.cursor({});return new q(((i,r)=>{e.onerror=s=>{const o=Px(s.target.error);r(o)},e.onsuccess=s=>{const o=s.target.result;o?t(o.primaryKey,o.value).next((a=>{a?o.continue():i()})):i()}}))}H(t,e){const i=[];return new q(((r,s)=>{t.onerror=o=>{s(o.target.error)},t.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const u=new iG(a),h=e(a.primaryKey,a.value,u);if(h instanceof q){const d=h.catch((g=>(u.done(),q.reject(g))));i.push(d)}u.isDone?r():u.G===null?a.continue():a.continue(u.G)}})).next((()=>q.waitFor(i)))}options(t,e){let i;return t!==void 0&&(typeof t=="string"?i=t:e=t),{index:i,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const i=this.store.index(t.index);return t.X?i.openKeyCursor(t.range,e):i.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Dl(n){return new q(((t,e)=>{n.onsuccess=i=>{const r=i.target.result;t(r)},n.onerror=i=>{const r=Px(i.target.error);e(r)}}))}let yR=!1;function Px(n){const t=Ca.M(pn());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){const i=new mt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yR||(yR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const cf="IndexBackfiller";class sG{constructor(t,e){this.asyncQueue=t,this.ne=e,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(t){ct(cf,`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,(async()=>{this.task=null;try{const e=await this.ne.ie();ct(cf,`Documents written: ${e}`)}catch(e){Wa(e)?ct(cf,"Ignoring IndexedDB error during index backfill: ",e):await Su(e)}await this.re(6e4)}))}}class oG{constructor(t,e){this.localStore=t,this.persistence=e}async ie(t=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(e=>this.se(e,t)))}se(t,e){const i=new Set;let r=e,s=!0;return q.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next((o=>{if(o!==null&&!i.has(o))return ct(cf,`Processing collection: ${o}`),this.oe(t,o,r).next((a=>{r-=a,i.add(o)}));s=!1})))).next((()=>e-r))}oe(t,e,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next((r=>this.localStore.localDocuments.getNextDocuments(t,e,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(t,o).next((()=>this._e(r,s))).next((a=>(ct(cf,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(t,e,a)))).next((()=>o.size))}))))}_e(t,e){let i=t;return e.changes.forEach(((r,s)=>{const o=tk(s);Rx(o,i)>0&&(i=o)})),new Yi(i.readTime,i.documentKey,Math.max(e.batchId,t.largestBatchId))}}class wr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>e.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}wr.ce=-1;const ql=-1;function U_(n){return n==null}function Wf(n){return n===0&&1/n==-1/0}function aG(n){return typeof n=="number"&&Number.isInteger(n)&&!Wf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const R0="";function ei(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=vR(t)),t=lG(n.get(e),t);return vR(t)}function lG(n,t){let e=t;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":e+="";break;case R0:e+="";break;default:e+=s}}return e}function vR(n){return n+R0+""}function Ts(n){const t=n.length;if(Ct(t>=2,64408,{path:n}),t===2)return Ct(n.charAt(0)===R0&&n.charAt(1)==="",56145,{path:n}),fe.emptyPath();const e=t-2,i=[];let r="";for(let s=0;s<t;){const o=n.indexOf(R0,s);switch((o<0||o>e)&&Tt(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let u;r.length===0?u=a:(r+=a,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Tt(61167,{path:n})}s=o+2}return new fe(i)}const Pl="remoteDocuments",Rg="owner",_c="owner",Kf="mutationQueues",uG="userId",Ur="mutations",ER="batchId",$l="userMutationsIndex",wR=["userId","batchId"];function Vp(n,t){return[n,ei(t)]}function rk(n,t,e){return[n,ei(t),e]}const cG={},dh="documentMutations",P0="remoteDocumentsV14",hG=["prefixPath","collectionGroup","readTime","documentId"],Fp="documentKeyIndex",dG=["prefixPath","collectionGroup","documentId"],sk="collectionGroupIndex",fG=["collectionGroup","readTime","prefixPath","documentId"],qf="remoteDocumentGlobal",NE="remoteDocumentGlobalKey",fh="targets",ok="queryTargetsIndex",gG=["canonicalId","targetId"],gh="targetDocuments",mG=["targetId","path"],Cx="documentTargetsIndex",pG=["path","targetId"],C0="targetGlobalKey",Hl="targetGlobal",Hf="collectionParents",_G=["collectionId","parent"],mh="clientMetadata",yG="clientId",j_="bundles",vG="bundleId",z_="namedQueries",EG="name",Mx="indexConfiguration",wG="indexId",OE="collectionGroupIndex",xG="collectionGroup",hf="indexState",TG=["indexId","uid"],ak="sequenceNumberIndex",SG=["uid","sequenceNumber"],df="indexEntries",IG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],lk="documentKeyIndex",AG=["indexId","uid","orderedDocumentKey"],B_="documentOverlays",RG=["userId","collectionPath","documentId"],VE="collectionPathOverlayIndex",PG=["userId","collectionPath","largestBatchId"],uk="collectionGroupOverlayIndex",CG=["userId","collectionGroup","largestBatchId"],bx="globals",MG="name",ck=[Kf,Ur,dh,Pl,fh,Rg,Hl,gh,mh,qf,Hf,j_,z_],bG=[...ck,B_],hk=[Kf,Ur,dh,P0,fh,Rg,Hl,gh,mh,qf,Hf,j_,z_,B_],dk=hk,kx=[...dk,Mx,hf,df],kG=kx,fk=[...kx,bx],LG=fk;class FE extends nk{constructor(t,e){super(),this.le=t,this.currentSequenceNumber=e}}function _n(n,t){const e=Bt(n);return Ca.O(e.le,t)}function xR(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Ka(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function gk(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class Ge{constructor(t,e){this.comparator=t,this.root=e||Fn.EMPTY}insert(t,e){return new Ge(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(t){return new Ge(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return e+i.left.size;r<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,i)=>(t(e,i),!1)))}toString(){const t=[];return this.inorderTraversal(((e,i)=>(t.push(`${e}:${i}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new _p(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new _p(this.root,t,this.comparator,!1)}getReverseIterator(){return new _p(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new _p(this.root,t,this.comparator,!0)}}class _p{constructor(t,e,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?i(t.key,e):1,e&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Fn{constructor(t,e,i,r,s){this.key=t,this.value=e,this.color=i??Fn.RED,this.left=r??Fn.EMPTY,this.right=s??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,r,s){return new Fn(t??this.key,e??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let r=this;const s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,e,i),null):s===0?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),e(t,r.key)===0){if(r.right.isEmpty())return Fn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Tt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Tt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Tt(27949);return t+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw Tt(57766)}get value(){throw Tt(16141)}get color(){throw Tt(16727)}get left(){throw Tt(29726)}get right(){throw Tt(36894)}copy(t,e,i,r,s){return this}insert(t,e,i){return new Fn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Se{constructor(t){this.comparator=t,this.data=new Ge(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,i)=>(t(e),!1)))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new TR(this.data.getIterator())}getIteratorFrom(t){return new TR(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((i=>{e=e.add(i)})),e}isEqual(t){if(!(t instanceof Se)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const r=e.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Se(this.comparator);return e.data=t,e}}class TR{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function yc(n){return n.hasNext()?n.getNext():void 0}class Mi{constructor(t){this.fields=t,t.sort(Be.comparator)}static empty(){return new Mi([])}unionWith(t){let e=new Se(Be.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new Mi(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return hh(this.fields,t.fields,((e,i)=>e.isEqual(i)))}}class mk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class un{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new mk("Invalid base64 string: "+s):s}})(t);return new un(e)}static fromUint8Array(t){const e=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(t);return new un(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return zt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}un.EMPTY_BYTE_STRING=new un("");const DG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(n){if(Ct(!!n,39018),typeof n=="string"){let t=0;const e=DG.exec(n);if(Ct(!!e,46558,{timestamp:n}),e[1]){let r=e[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Ve(n.seconds),nanos:Ve(n.nanos)}}function Ve(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Eo(n){return typeof n=="string"?un.fromBase64String(n):un.fromUint8Array(n)}const pk="server_timestamp",_k="__type__",yk="__previous_value__",vk="__local_write_time__";function Lx(n){return(n?.mapValue?.fields||{})[_k]?.stringValue===pk}function $_(n){const t=n.mapValue.fields[yk];return Lx(t)?$_(t):t}function Xf(n){const t=vo(n.mapValue.fields[vk].timestampValue);return new xe(t.seconds,t.nanos)}class NG{constructor(t,e,i,r,s,o,a,u,h,d){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d}}const M0="(default)";class uu{constructor(t,e){this.projectId=t,this.database=e||M0}static empty(){return new uu("","")}get isDefaultDatabase(){return this.database===M0}isEqual(t){return t instanceof uu&&t.projectId===this.projectId&&t.database===this.database}}const Dx="__type__",Ek="__max__",Ea={mapValue:{fields:{__type__:{stringValue:Ek}}}},Nx="__vector__",ph="value",Gp={nullValue:"NULL_VALUE"};function Oa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Lx(n)?4:wk(n)?9007199254740991:W_(n)?10:11:Tt(28295,{value:n})}function ks(n,t){if(n===t)return!0;const e=Oa(n);if(e!==Oa(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Xf(n).isEqual(Xf(t));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=vo(r.timestampValue),a=vo(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(r,s){return Eo(r.bytesValue).isEqual(Eo(s.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(r,s){return Ve(r.geoPointValue.latitude)===Ve(s.geoPointValue.latitude)&&Ve(r.geoPointValue.longitude)===Ve(s.geoPointValue.longitude)})(n,t);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Ve(r.integerValue)===Ve(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Ve(r.doubleValue),a=Ve(s.doubleValue);return o===a?Wf(o)===Wf(a):isNaN(o)&&isNaN(a)}return!1})(n,t);case 9:return hh(n.arrayValue.values||[],t.arrayValue.values||[],ks);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(xR(o)!==xR(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!ks(o[u],a[u])))return!1;return!0})(n,t);default:return Tt(52216,{left:n})}}function Yf(n,t){return(n.values||[]).find((e=>ks(e,t)))!==void 0}function Va(n,t){if(n===t)return 0;const e=Oa(n),i=Oa(t);if(e!==i)return zt(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return zt(n.booleanValue,t.booleanValue);case 2:return(function(s,o){const a=Ve(s.integerValue||s.doubleValue),u=Ve(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1})(n,t);case 3:return SR(n.timestampValue,t.timestampValue);case 4:return SR(Xf(n),Xf(t));case 5:return LE(n.stringValue,t.stringValue);case 6:return(function(s,o){const a=Eo(s),u=Eo(o);return a.compareTo(u)})(n.bytesValue,t.bytesValue);case 7:return(function(s,o){const a=s.split("/"),u=o.split("/");for(let h=0;h<a.length&&h<u.length;h++){const d=zt(a[h],u[h]);if(d!==0)return d}return zt(a.length,u.length)})(n.referenceValue,t.referenceValue);case 8:return(function(s,o){const a=zt(Ve(s.latitude),Ve(o.latitude));return a!==0?a:zt(Ve(s.longitude),Ve(o.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return IR(n.arrayValue,t.arrayValue);case 10:return(function(s,o){const a=s.fields||{},u=o.fields||{},h=a[ph]?.arrayValue,d=u[ph]?.arrayValue,g=zt(h?.values?.length||0,d?.values?.length||0);return g!==0?g:IR(h,d)})(n.mapValue,t.mapValue);case 11:return(function(s,o){if(s===Ea.mapValue&&o===Ea.mapValue)return 0;if(s===Ea.mapValue)return 1;if(o===Ea.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const m=LE(u[g],d[g]);if(m!==0)return m;const v=Va(a[u[g]],h[d[g]]);if(v!==0)return v}return zt(u.length,d.length)})(n.mapValue,t.mapValue);default:throw Tt(23264,{he:e})}}function SR(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return zt(n,t);const e=vo(n),i=vo(t),r=zt(e.seconds,i.seconds);return r!==0?r:zt(e.nanos,i.nanos)}function IR(n,t){const e=n.values||[],i=t.values||[];for(let r=0;r<e.length&&r<i.length;++r){const s=Va(e[r],i[r]);if(s)return s}return zt(e.length,i.length)}function _h(n){return GE(n)}function GE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const i=vo(e);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return Eo(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return pt.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let i="[",r=!0;for(const s of e.values||[])r?r=!1:i+=",",i+=GE(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(e){const i=Object.keys(e.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${GE(e.fields[o])}`;return r+"}"})(n.mapValue):Tt(61005,{value:n})}function Up(n){switch(Oa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=$_(n);return t?16+Up(t):16;case 5:return 2*n.stringValue.length;case 6:return Eo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+Up(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ka(i.fields,((s,o)=>{r+=s.length+Up(o)})),r})(n.mapValue);default:throw Tt(13486,{value:n})}}function Zf(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function UE(n){return!!n&&"integerValue"in n}function Qf(n){return!!n&&"arrayValue"in n}function AR(n){return!!n&&"nullValue"in n}function RR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jp(n){return!!n&&"mapValue"in n}function W_(n){return(n?.mapValue?.fields||{})[Dx]?.stringValue===Nx}function ff(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return Ka(n.mapValue.fields,((e,i)=>t.mapValue.fields[e]=ff(i))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ff(n.arrayValue.values[e]);return t}return{...n}}function wk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Ek}const xk={mapValue:{fields:{[Dx]:{stringValue:Nx},[ph]:{arrayValue:{}}}}};function OG(n){return"nullValue"in n?Gp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Zf(uu.empty(),pt.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?W_(n)?xk:{mapValue:{}}:Tt(35942,{value:n})}function VG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Zf(uu.empty(),pt.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?xk:"mapValue"in n?W_(n)?{mapValue:{}}:Ea:Tt(61959,{value:n})}function PR(n,t){const e=Va(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function CR(n,t){const e=Va(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}class Qn{constructor(t){this.value=t}static empty(){return new Qn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!jp(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ff(e)}setAll(t){let e=Be.emptyPath(),i={},r=[];t.forEach(((o,a)=>{if(!e.isImmediateParentOf(a)){const u=this.getFieldsMap(e);this.applyChanges(u,i,r),i={},r=[],e=a.popLast()}o?i[a.lastSegment()]=ff(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,i,r)}delete(t){const e=this.field(t.popLast());jp(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ks(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=e.mapValue.fields[t.get(i)];jp(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,i){Ka(e,((r,s)=>t[r]=s));for(const r of i)delete t[r]}clone(){return new Qn(ff(this.value))}}function Tk(n){const t=[];return Ka(n.fields,((e,i)=>{const r=new Be([e]);if(jp(i)){const s=Tk(i.mapValue).fields;if(s.length===0)t.push(r);else for(const o of s)t.push(r.child(o))}else t.push(r)})),new Mi(t)}class Xe{constructor(t,e,i,r,s,o,a){this.key=t,this.documentType=e,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Xe(t,0,Mt.min(),Mt.min(),Mt.min(),Qn.empty(),0)}static newFoundDocument(t,e,i,r){return new Xe(t,1,e,Mt.min(),i,r,0)}static newNoDocument(t,e){return new Xe(t,2,e,Mt.min(),Mt.min(),Qn.empty(),0)}static newUnknownDocument(t,e){return new Xe(t,3,e,Mt.min(),Mt.min(),Qn.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Qn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Xe&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class yh{constructor(t,e){this.position=t,this.inclusive=e}}function MR(n,t,e){let i=0;for(let r=0;r<n.position.length;r++){const s=t[r],o=n.position[r];if(s.field.isKeyField()?i=pt.comparator(pt.fromName(o.referenceValue),e.key):i=Va(o,e.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function bR(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!ks(n.position[e],t.position[e]))return!1;return!0}class b0{constructor(t,e="asc"){this.field=t,this.dir=e}}function FG(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class Sk{}class te extends Sk{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new GG(t,e,i):e==="array-contains"?new zG(t,i):e==="in"?new Mk(t,i):e==="not-in"?new BG(t,i):e==="array-contains-any"?new $G(t,i):new te(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new UG(t,i):new jG(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Va(e,this.value)):e!==null&&Oa(this.value)===Oa(e)&&this.matchesComparison(Va(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Tt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Te extends Sk{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new Te(t,e)}matches(t){return vh(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vh(n){return n.op==="and"}function jE(n){return n.op==="or"}function Ox(n){return Ik(n)&&vh(n)}function Ik(n){for(const t of n.filters)if(t instanceof Te)return!1;return!0}function zE(n){if(n instanceof te)return n.field.canonicalString()+n.op.toString()+_h(n.value);if(Ox(n))return n.filters.map((t=>zE(t))).join(",");{const t=n.filters.map((e=>zE(e))).join(",");return`${n.op}(${t})`}}function Ak(n,t){return n instanceof te?(function(i,r){return r instanceof te&&i.op===r.op&&i.field.isEqual(r.field)&&ks(i.value,r.value)})(n,t):n instanceof Te?(function(i,r){return r instanceof Te&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&Ak(o,r.filters[a])),!0):!1})(n,t):void Tt(19439)}function Rk(n,t){const e=n.filters.concat(t);return Te.create(e,n.op)}function Pk(n){return n instanceof te?(function(e){return`${e.field.canonicalString()} ${e.op} ${_h(e.value)}`})(n):n instanceof Te?(function(e){return e.op.toString()+" {"+e.getFilters().map(Pk).join(" ,")+"}"})(n):"Filter"}class GG extends te{constructor(t,e,i){super(t,e,i),this.key=pt.fromName(i.referenceValue)}matches(t){const e=pt.comparator(t.key,this.key);return this.matchesComparison(e)}}class UG extends te{constructor(t,e){super(t,"in",e),this.keys=Ck("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class jG extends te{constructor(t,e){super(t,"not-in",e),this.keys=Ck("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Ck(n,t){return(t.arrayValue?.values||[]).map((e=>pt.fromName(e.referenceValue)))}class zG extends te{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Qf(e)&&Yf(e.arrayValue,this.value)}}class Mk extends te{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Yf(this.value.arrayValue,e)}}class BG extends te{constructor(t,e){super(t,"not-in",e)}matches(t){if(Yf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Yf(this.value.arrayValue,e)}}class $G extends te{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Qf(e)||!e.arrayValue.values)&&e.arrayValue.values.some((i=>Yf(this.value.arrayValue,i)))}}class WG{constructor(t,e=null,i=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function BE(n,t=null,e=[],i=[],r=null,s=null,o=null){return new WG(n,t,e,i,r,s,o)}function cu(n){const t=Bt(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((i=>zE(i))).join(","),e+="|ob:",e+=t.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),U_(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((i=>_h(i))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((i=>_h(i))).join(",")),t.Te=e}return t.Te}function Pg(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!FG(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Ak(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!bR(n.startAt,t.startAt)&&bR(n.endAt,t.endAt)}function k0(n){return pt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function L0(n,t){return n.filters.filter((e=>e instanceof te&&e.field.isEqual(t)))}function kR(n,t,e){let i=Gp,r=!0;for(const s of L0(n,t)){let o=Gp,a=!0;switch(s.op){case"<":case"<=":o=OG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Gp}PR({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(e!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){const o=e.position[s];PR({value:i,inclusive:r},{value:o,inclusive:e.inclusive})<0&&(i=o,r=e.inclusive);break}}return{value:i,inclusive:r}}function LR(n,t,e){let i=Ea,r=!0;for(const s of L0(n,t)){let o=Ea,a=!0;switch(s.op){case">=":case">":o=VG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ea}CR({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(e!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){const o=e.position[s];CR({value:i,inclusive:r},{value:o,inclusive:e.inclusive})>0&&(i=o,r=e.inclusive);break}}return{value:i,inclusive:r}}class Cg{constructor(t,e=null,i=[],r=[],s=null,o="F",a=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function KG(n,t,e,i,r,s,o,a){return new Cg(n,t,e,i,r,s,o,a)}function Vx(n){return new Cg(n)}function DR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function bk(n){return n.collectionGroup!==null}function gf(n){const t=Bt(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),e.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Se(Be.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(t).forEach((s=>{e.has(s.canonicalString())||s.isKeyField()||t.Ie.push(new b0(s,i))})),e.has(Be.keyField().canonicalString())||t.Ie.push(new b0(Be.keyField(),i))}return t.Ie}function Sr(n){const t=Bt(n);return t.Ee||(t.Ee=qG(t,gf(n))),t.Ee}function qG(n,t){if(n.limitType==="F")return BE(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new b0(r.field,s)}));const e=n.endAt?new yh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new yh(n.startAt.position,n.startAt.inclusive):null;return BE(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function $E(n,t){const e=n.filters.concat([t]);return new Cg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function WE(n,t,e){return new Cg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function K_(n,t){return Pg(Sr(n),Sr(t))&&n.limitType===t.limitType}function kk(n){return`${cu(Sr(n))}|lt:${n.limitType}`}function Cc(n){return`Query(target=${(function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map((r=>Pk(r))).join(", ")}]`),U_(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map((r=>_h(r))).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map((r=>_h(r))).join(",")),`Target(${i})`})(Sr(n))}; limitType=${n.limitType})`}function Mg(n,t){return t.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):pt.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,t)&&(function(i,r){for(const s of gf(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,t)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,t)&&(function(i,r){return!(i.startAt&&!(function(o,a,u){const h=MR(o,a,u);return o.inclusive?h<=0:h<0})(i.startAt,gf(i),r)||i.endAt&&!(function(o,a,u){const h=MR(o,a,u);return o.inclusive?h>=0:h>0})(i.endAt,gf(i),r))})(n,t)}function HG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Lk(n){return(t,e)=>{let i=!1;for(const r of gf(n)){const s=XG(r,t,e);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function XG(n,t,e){const i=n.field.isKeyField()?pt.comparator(t.key,e.key):(function(s,o,a){const u=o.data.field(s),h=a.data.field(s);return u!==null&&h!==null?Va(u,h):Tt(42886)})(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Tt(19790,{direction:n.dir})}}class Ao{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,t))return s}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return void(r[s]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[e]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Ka(this.inner,((e,i)=>{for(const[r,s]of i)t(r,s)}))}isEmpty(){return gk(this.inner)}size(){return this.innerSize}}const YG=new Ge(pt.comparator);function Wi(){return YG}const Dk=new Ge(pt.comparator);function Xd(...n){let t=Dk;for(const e of n)t=t.insert(e.key,e);return t}function Nk(n){let t=Dk;return n.forEach(((e,i)=>t=t.insert(e,i.overlayedDocument))),t}function Ss(){return mf()}function Ok(){return mf()}function mf(){return new Ao((n=>n.toString()),((n,t)=>n.isEqual(t)))}const ZG=new Ge(pt.comparator),QG=new Se(pt.comparator);function Yt(...n){let t=QG;for(const e of n)t=t.add(e);return t}const JG=new Se(zt);function tU(){return JG}function Fx(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wf(t)?"-0":t}}function Vk(n){return{integerValue:""+n}}function eU(n,t){return aG(t)?Vk(t):Fx(n,t)}class q_{constructor(){this._=void 0}}function nU(n,t,e){return n instanceof Jf?(function(r,s){const o={fields:{[_k]:{stringValue:pk},[vk]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Lx(s)&&(s=$_(s)),s&&(o.fields[yk]=s),{mapValue:o}})(e,t):n instanceof Eh?Gk(n,t):n instanceof wh?Uk(n,t):(function(r,s){const o=Fk(r,s),a=NR(o)+NR(r.Ae);return UE(o)&&UE(r.Ae)?Vk(a):Fx(r.serializer,a)})(n,t)}function iU(n,t,e){return n instanceof Eh?Gk(n,t):n instanceof wh?Uk(n,t):e}function Fk(n,t){return n instanceof tg?(function(i){return UE(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(t)?t:{integerValue:0}:null}class Jf extends q_{}class Eh extends q_{constructor(t){super(),this.elements=t}}function Gk(n,t){const e=jk(t);for(const i of n.elements)e.some((r=>ks(r,i)))||e.push(i);return{arrayValue:{values:e}}}class wh extends q_{constructor(t){super(),this.elements=t}}function Uk(n,t){let e=jk(t);for(const i of n.elements)e=e.filter((r=>!ks(r,i)));return{arrayValue:{values:e}}}class tg extends q_{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function NR(n){return Ve(n.integerValue||n.doubleValue)}function jk(n){return Qf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class rU{constructor(t,e){this.field=t,this.transform=e}}function sU(n,t){return n.field.isEqual(t.field)&&(function(i,r){return i instanceof Eh&&r instanceof Eh||i instanceof wh&&r instanceof wh?hh(i.elements,r.elements,ks):i instanceof tg&&r instanceof tg?ks(i.Ae,r.Ae):i instanceof Jf&&r instanceof Jf})(n.transform,t.transform)}class oU{constructor(t,e){this.version=t,this.transformResults=e}}class ci{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ci}static exists(t){return new ci(void 0,t)}static updateTime(t){return new ci(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function zp(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class H_{}function zk(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new X_(n.key,ci.none()):new kh(n.key,n.data,ci.none());{const e=n.data,i=Qn.empty();let r=new Se(Be.comparator);for(let s of t.fields)if(!r.has(s)){let o=e.field(s);o===null&&s.length>1&&(s=s.popLast(),o=e.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Ro(n.key,i,new Mi(r.toArray()),ci.none())}}function aU(n,t,e){n instanceof kh?(function(r,s,o){const a=r.value.clone(),u=VR(r.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,t,e):n instanceof Ro?(function(r,s,o){if(!zp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=VR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(Bk(r)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,t,e):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,t,e)}function pf(n,t,e,i){return n instanceof kh?(function(s,o,a,u){if(!zp(s.precondition,o))return a;const h=s.value.clone(),d=FR(s.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,t,e,i):n instanceof Ro?(function(s,o,a,u){if(!zp(s.precondition,o))return a;const h=FR(s.fieldTransforms,u,o),d=o.data;return d.setAll(Bk(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,t,e,i):(function(s,o,a){return zp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,t,e)}function lU(n,t){let e=null;for(const i of n.fieldTransforms){const r=t.data.field(i.field),s=Fk(i.transform,r||null);s!=null&&(e===null&&(e=Qn.empty()),e.set(i.field,s))}return e||null}function OR(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&hh(i,r,((s,o)=>sU(s,o)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class kh extends H_{constructor(t,e,i,r=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ro extends H_{constructor(t,e,i,r,s=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Bk(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}})),t}function VR(n,t,e){const i=new Map;Ct(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let r=0;r<e.length;r++){const s=n[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,iU(o,a,e[r]))}return i}function FR(n,t,e){const i=new Map;for(const r of n){const s=r.transform,o=e.data.field(r.field);i.set(r.field,nU(s,o,t))}return i}class X_ extends H_{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $k extends H_{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Gx{constructor(t,e,i,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(t.key)&&aU(s,t,i[r])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=pf(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=pf(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=Ok();return this.mutations.forEach((r=>{const s=t.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=e.has(r.key)?null:a;const u=zk(o,a);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Mt.min())})),i}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Yt())}isEqual(t){return this.batchId===t.batchId&&hh(this.mutations,t.mutations,((e,i)=>OR(e,i)))&&hh(this.baseMutations,t.baseMutations,((e,i)=>OR(e,i)))}}class Ux{constructor(t,e,i,r){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=r}static from(t,e,i){Ct(t.mutations.length===i.length,58842,{me:t.mutations.length,fe:i.length});let r=(function(){return ZG})();const s=t.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Ux(t,e,i,r)}}class jx{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class uU{constructor(t,e){this.count=t,this.unchangedNames=e}}var an,ie;function cU(n){switch(n){case tt.OK:return Tt(64938);case tt.CANCELLED:case tt.UNKNOWN:case tt.DEADLINE_EXCEEDED:case tt.RESOURCE_EXHAUSTED:case tt.INTERNAL:case tt.UNAVAILABLE:case tt.UNAUTHENTICATED:return!1;case tt.INVALID_ARGUMENT:case tt.NOT_FOUND:case tt.ALREADY_EXISTS:case tt.PERMISSION_DENIED:case tt.FAILED_PRECONDITION:case tt.ABORTED:case tt.OUT_OF_RANGE:case tt.UNIMPLEMENTED:case tt.DATA_LOSS:return!0;default:return Tt(15467,{code:n})}}function Wk(n){if(n===void 0)return ui("GRPC error has no .code"),tt.UNKNOWN;switch(n){case an.OK:return tt.OK;case an.CANCELLED:return tt.CANCELLED;case an.UNKNOWN:return tt.UNKNOWN;case an.DEADLINE_EXCEEDED:return tt.DEADLINE_EXCEEDED;case an.RESOURCE_EXHAUSTED:return tt.RESOURCE_EXHAUSTED;case an.INTERNAL:return tt.INTERNAL;case an.UNAVAILABLE:return tt.UNAVAILABLE;case an.UNAUTHENTICATED:return tt.UNAUTHENTICATED;case an.INVALID_ARGUMENT:return tt.INVALID_ARGUMENT;case an.NOT_FOUND:return tt.NOT_FOUND;case an.ALREADY_EXISTS:return tt.ALREADY_EXISTS;case an.PERMISSION_DENIED:return tt.PERMISSION_DENIED;case an.FAILED_PRECONDITION:return tt.FAILED_PRECONDITION;case an.ABORTED:return tt.ABORTED;case an.OUT_OF_RANGE:return tt.OUT_OF_RANGE;case an.UNIMPLEMENTED:return tt.UNIMPLEMENTED;case an.DATA_LOSS:return tt.DATA_LOSS;default:return Tt(39323,{code:n})}}(ie=an||(an={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";function hU(){return new TextEncoder}const dU=new Pa([4294967295,4294967295],0);function GR(n){const t=hU().encode(n),e=new B4;return e.update(t),new Uint8Array(e.digest())}function UR(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Pa([e,i],0),new Pa([r,s],0)]}class zx{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new Yd(`Invalid padding: ${e}`);if(i<0)throw new Yd(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Yd(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new Yd(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=Pa.fromNumber(this.ge)}ye(t,e,i){let r=t.add(e.multiply(Pa.fromNumber(i)));return r.compare(dU)===1&&(r=new Pa([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=GR(t),[i,r]=UR(e);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(t,e,i){const r=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new zx(s,r,e);return i.forEach((a=>o.insert(a))),o}insert(t){if(this.ge===0)return;const e=GR(t),[i,r]=UR(e);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.Se(o)}}Se(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class Yd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Y_{constructor(t,e,i,r,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const r=new Map;return r.set(t,bg.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new Y_(Mt.min(),r,new Ge(zt),Wi(),Yt())}}class bg{constructor(t,e,i,r,s){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new bg(i,e,Yt(),Yt(),Yt())}}class Bp{constructor(t,e,i,r){this.be=t,this.removedTargetIds=e,this.key=i,this.De=r}}class Kk{constructor(t,e){this.targetId=t,this.Ce=e}}class qk{constructor(t,e,i=un.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=r}}class jR{constructor(){this.ve=0,this.Fe=zR(),this.Me=un.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Yt(),e=Yt(),i=Yt();return this.Fe.forEach(((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:i=i.add(r);break;default:Tt(38017,{changeType:s})}})),new bg(this.Me,this.xe,t,e,i)}qe(){this.Oe=!1,this.Fe=zR()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ct(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class fU{constructor(t){this.Ge=t,this.ze=new Map,this.je=Wi(),this.Je=yp(),this.He=yp(),this.Ye=new Ge(zt)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const i=this.nt(e);switch(t.state){case 0:this.rt(e)&&i.Le(t.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(t.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(i.We(),i.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),i.Le(t.resumeToken));break;default:Tt(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((i,r)=>{this.rt(r)&&e(r)}))}st(t){const e=t.targetId,i=t.Ce.count,r=this.ot(e);if(r){const s=r.target;if(k0(s))if(i===0){const o=new pt(s.path);this.et(e,o,Xe.newNoDocument(o,Mt.min()))}else Ct(i===1,20013,{expectedCount:i});else{const o=this._t(e);if(o!==i){const a=this.ut(t),u=a?this.ct(a,t,o):1;if(u!==0){this.it(e);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,h)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=e;let o,a;try{o=Eo(i).toUint8Array()}catch(u){if(u instanceof mk)return lu("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new zx(o,r,s)}catch(u){return lu(u instanceof Yd?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.ge===0?null:a}ct(t,e,i){return e.Ce.count===i-this.Pt(t,e.targetId)?0:2}Pt(t,e){const i=this.Ge.getRemoteKeysForTarget(e);let r=0;return i.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(a)||(this.et(e,s,null),r++)})),r}Tt(t){const e=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&k0(a.target)){const u=new pt(a.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Xe.newNoDocument(u,t))}s.Be&&(e.set(o,s.ke()),s.qe())}}));let i=Yt();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(t)));const r=new Y_(t,e,this.Ye,this.je,i);return this.je=Wi(),this.Je=yp(),this.He=yp(),this.Ye=new Ge(zt),r}Xe(t,e){if(!this.rt(t))return;const i=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,i),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,i){if(!this.rt(t))return;const r=this.nt(t);this.Et(t,e)?r.Qe(e,1):r.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),i&&(this.je=this.je.insert(e,i))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new jR,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new Se(zt),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new Se(zt),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||ct("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new jR),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function yp(){return new Ge(pt.comparator)}function zR(){return new Ge(pt.comparator)}const gU={asc:"ASCENDING",desc:"DESCENDING"},mU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pU={and:"AND",or:"OR"};class _U{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function KE(n,t){return n.useProto3Json||U_(t)?t:{value:t}}function xh(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Hk(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function yU(n,t){return xh(n,t.toTimestamp())}function di(n){return Ct(!!n,49232),Mt.fromTimestamp((function(e){const i=vo(e);return new xe(i.seconds,i.nanos)})(n))}function Bx(n,t){return qE(n,t).canonicalString()}function qE(n,t){const e=(function(r){return new fe(["projects",r.projectId,"databases",r.database])})(n).child("documents");return t===void 0?e:e.child(t)}function Xk(n){const t=fe.fromString(n);return Ct(rL(t),10190,{key:t.toString()}),t}function D0(n,t){return Bx(n.databaseId,t.path)}function Xl(n,t){const e=Xk(t);if(e.get(1)!==n.databaseId.projectId)throw new mt(tt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new mt(tt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new pt(Qk(e))}function Yk(n,t){return Bx(n.databaseId,t)}function Zk(n){const t=Xk(n);return t.length===4?fe.emptyPath():Qk(t)}function HE(n){return new fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Qk(n){return Ct(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function BR(n,t,e){return{name:D0(n,t),fields:e.value.mapValue.fields}}function vU(n,t,e){const i=Xl(n,t.name),r=di(t.updateTime),s=t.createTime?di(t.createTime):Mt.min(),o=new Qn({mapValue:{fields:t.fields}}),a=Xe.newFoundDocument(i,r,s,o);return e&&a.setHasCommittedMutations(),e?a.setHasCommittedMutations():a}function EU(n,t){let e;if("targetChange"in t){t.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Tt(39313,{state:h})})(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(Ct(d===void 0||typeof d=="string",58123),un.fromBase64String(d||"")):(Ct(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),un.fromUint8Array(d||new Uint8Array))})(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&(function(h){const d=h.code===void 0?tt.UNKNOWN:Wk(h.code);return new mt(d,h.message||"")})(o);e=new qk(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=Xl(n,i.document.name),s=di(i.document.updateTime),o=i.document.createTime?di(i.document.createTime):Mt.min(),a=new Qn({mapValue:{fields:i.document.fields}}),u=Xe.newFoundDocument(r,s,o,a),h=i.targetIds||[],d=i.removedTargetIds||[];e=new Bp(h,d,u.key,u)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=Xl(n,i.document),s=i.readTime?di(i.readTime):Mt.min(),o=Xe.newNoDocument(r,s),a=i.removedTargetIds||[];e=new Bp([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=Xl(n,i.document),s=i.removedTargetIds||[];e=new Bp([],s,r,null)}else{if(!("filter"in t))return Tt(11601,{Rt:t});{t.filter;const i=t.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new uU(r,s),a=i.targetId;e=new Kk(a,o)}}return e}function N0(n,t){let e;if(t instanceof kh)e={update:BR(n,t.key,t.value)};else if(t instanceof X_)e={delete:D0(n,t.key)};else if(t instanceof Ro)e={update:BR(n,t.key,t.data),updateMask:AU(t.fieldMask)};else{if(!(t instanceof $k))return Tt(16599,{Vt:t.type});e={verify:D0(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof Jf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Eh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof wh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof tg)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Tt(20930,{transform:o.transform})})(0,i)))),t.precondition.isNone||(e.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:yU(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Tt(27497)})(n,t.precondition)),e}function XE(n,t){const e=t.currentDocument?(function(s){return s.updateTime!==void 0?ci.updateTime(di(s.updateTime)):s.exists!==void 0?ci.exists(s.exists):ci.none()})(t.currentDocument):ci.none(),i=t.updateTransforms?t.updateTransforms.map((r=>(function(o,a){let u=null;if("setToServerValue"in a)Ct(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),u=new Jf;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new Eh(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new wh(d)}else"increment"in a?u=new tg(o,a.increment):Tt(16584,{proto:a});const h=Be.fromServerFormat(a.fieldPath);return new rU(h,u)})(n,r))):[];if(t.update){t.update.name;const r=Xl(n,t.update.name),s=new Qn({mapValue:{fields:t.update.fields}});if(t.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new Mi(h.map((d=>Be.fromServerFormat(d))))})(t.updateMask);return new Ro(r,s,o,e,i)}return new kh(r,s,e,i)}if(t.delete){const r=Xl(n,t.delete);return new X_(r,e)}if(t.verify){const r=Xl(n,t.verify);return new $k(r,e)}return Tt(1463,{proto:t})}function wU(n,t){return n&&n.length>0?(Ct(t!==void 0,14353),n.map((e=>(function(r,s){let o=r.updateTime?di(r.updateTime):di(s);return o.isEqual(Mt.min())&&(o=di(s)),new oU(o,r.transformResults||[])})(e,t)))):[]}function Jk(n,t){return{documents:[Yk(n,t.path)]}}function tL(n,t){const e={structuredQuery:{}},i=t.path;let r;t.collectionGroup!==null?(r=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=Yk(n,r);const s=(function(h){if(h.length!==0)return iL(Te.create(h,"and"))})(t.filters);s&&(e.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:Mc(m.field),direction:TU(m.dir)}})(d)))})(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=KE(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(t.endAt)),{ft:e,parent:r}}function eL(n){let t=Zk(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let r=null;if(i>0){Ct(i===1,65062);const d=e.from[0];d.allDescendants?r=d.collectionId:t=t.child(d.collectionId)}let s=[];e.where&&(s=(function(g){const m=nL(g);return m instanceof Te&&Ox(m)?m.getFilters():[m]})(e.where));let o=[];e.orderBy&&(o=(function(g){return g.map((m=>(function(y){return new b0(bc(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(e.orderBy));let a=null;e.limit&&(a=(function(g){let m;return m=typeof g=="object"?g.value:g,U_(m)?null:m})(e.limit));let u=null;e.startAt&&(u=(function(g){const m=!!g.before,v=g.values||[];return new yh(v,m)})(e.startAt));let h=null;return e.endAt&&(h=(function(g){const m=!g.before,v=g.values||[];return new yh(v,m)})(e.endAt)),KG(t,r,o,s,a,"F",u,h)}function xU(n,t){const e=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Tt(28987,{purpose:r})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function nL(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=bc(e.unaryFilter.field);return te.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=bc(e.unaryFilter.field);return te.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bc(e.unaryFilter.field);return te.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bc(e.unaryFilter.field);return te.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Tt(61313);default:return Tt(60726)}})(n):n.fieldFilter!==void 0?(function(e){return te.create(bc(e.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Tt(58110);default:return Tt(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return Te.create(e.compositeFilter.filters.map((i=>nL(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Tt(1026)}})(e.compositeFilter.op))})(n):Tt(30097,{filter:n})}function TU(n){return gU[n]}function SU(n){return mU[n]}function IU(n){return pU[n]}function Mc(n){return{fieldPath:n.canonicalString()}}function bc(n){return Be.fromServerFormat(n.fieldPath)}function iL(n){return n instanceof te?(function(e){if(e.op==="=="){if(RR(e.value))return{unaryFilter:{field:Mc(e.field),op:"IS_NAN"}};if(AR(e.value))return{unaryFilter:{field:Mc(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(RR(e.value))return{unaryFilter:{field:Mc(e.field),op:"IS_NOT_NAN"}};if(AR(e.value))return{unaryFilter:{field:Mc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mc(e.field),op:SU(e.op),value:e.value}}})(n):n instanceof Te?(function(e){const i=e.getFilters().map((r=>iL(r)));return i.length===1?i[0]:{compositeFilter:{op:IU(e.op),filters:i}}})(n):Tt(54877,{filter:n})}function AU(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function rL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ao{constructor(t,e,i,r,s=Mt.min(),o=Mt.min(),a=un.EMPTY_BYTE_STRING,u=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(t){return new ao(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class sL{constructor(t){this.yt=t}}function RU(n,t){let e;if(t.document)e=vU(n.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const i=pt.fromSegments(t.noDocument.path),r=du(t.noDocument.readTime);e=Xe.newNoDocument(i,r),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return Tt(56709);{const i=pt.fromSegments(t.unknownDocument.path),r=du(t.unknownDocument.version);e=Xe.newUnknownDocument(i,r)}}return t.readTime&&e.setReadTime((function(r){const s=new xe(r[0],r[1]);return Mt.fromTimestamp(s)})(t.readTime)),e}function $R(n,t){const e=t.key,i={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:O0(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document=(function(s,o){return{name:D0(s,o.key),fields:o.data.value.mapValue.fields,updateTime:xh(s,o.version.toTimestamp()),createTime:xh(s,o.createTime.toTimestamp())}})(n.yt,t);else if(t.isNoDocument())i.noDocument={path:e.path.toArray(),readTime:hu(t.version)};else{if(!t.isUnknownDocument())return Tt(57904,{document:t});i.unknownDocument={path:e.path.toArray(),version:hu(t.version)}}return i}function O0(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function hu(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function du(n){const t=new xe(n.seconds,n.nanoseconds);return Mt.fromTimestamp(t)}function Nl(n,t){const e=(t.baseMutations||[]).map((s=>XE(n.yt,s)));for(let s=0;s<t.mutations.length-1;++s){const o=t.mutations[s];if(s+1<t.mutations.length&&t.mutations[s+1].transform!==void 0){const a=t.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const i=t.mutations.map((s=>XE(n.yt,s))),r=xe.fromMillis(t.localWriteTimeMs);return new Gx(t.batchId,r,e,i)}function Zd(n){const t=du(n.readTime),e=n.lastLimboFreeSnapshotVersion!==void 0?du(n.lastLimboFreeSnapshotVersion):Mt.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Ct(o===1,1966,{count:o}),Sr(Vx(Zk(s.documents[0])))})(n.query):(function(s){return Sr(eL(s))})(n.query),new ao(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,e,un.fromBase64String(n.resumeToken))}function oL(n,t){const e=hu(t.snapshotVersion),i=hu(t.lastLimboFreeSnapshotVersion);let r;r=k0(t.target)?Jk(n.yt,t.target):tL(n.yt,t.target).ft;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:cu(t.target),readTime:e,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function aL(n){const t=eL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?WE(t,t.limit,"L"):t}function I1(n,t){return new jx(t.largestBatchId,XE(n.yt,t.overlayMutation))}function WR(n,t){const e=t.path.lastSegment();return[n,ei(t.path.popLast()),e]}function KR(n,t,e,i){return{indexId:n,uid:t,sequenceNumber:e,readTime:hu(i.readTime),documentKey:ei(i.documentKey.path),largestBatchId:i.largestBatchId}}class PU{getBundleMetadata(t,e){return qR(t).get(e).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:du(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(t,e){return qR(t).put((function(r){return{bundleId:r.id,createTime:hu(di(r.createTime)),version:r.version}})(e))}getNamedQuery(t,e){return HR(t).get(e).next((i=>{if(i)return(function(s){return{name:s.name,query:aL(s.bundledQuery),readTime:du(s.readTime)}})(i)}))}saveNamedQuery(t,e){return HR(t).put((function(r){return{name:r.name,readTime:hu(di(r.readTime)),bundledQuery:r.bundledQuery}})(e))}}function qR(n){return _n(n,j_)}function HR(n){return _n(n,z_)}class Z_{constructor(t,e){this.serializer=t,this.userId=e}static wt(t,e){const i=e.uid||"";return new Z_(t,i)}getOverlay(t,e){return Ld(t).get(WR(this.userId,e)).next((i=>i?I1(this.serializer,i):null))}getOverlays(t,e){const i=Ss();return q.forEach(e,(r=>this.getOverlay(t,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(t,e,i){const r=[];return i.forEach(((s,o)=>{const a=new jx(e,o);r.push(this.St(t,a))})),q.waitFor(r)}removeOverlaysForBatchId(t,e,i){const r=new Set;e.forEach((o=>r.add(ei(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Ld(t).Z(VE,a))})),q.waitFor(s)}getOverlaysForCollection(t,e,i){const r=Ss(),s=ei(e),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ld(t).J(VE,o).next((a=>{for(const u of a){const h=I1(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(t,e,i,r){const s=Ss();let o;const a=IDBKeyRange.bound([this.userId,e,i],[this.userId,e,Number.POSITIVE_INFINITY],!0);return Ld(t).ee({index:uk,range:a},((u,h,d)=>{const g=I1(this.serializer,h);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):d.done()})).next((()=>s))}St(t,e){return Ld(t).put((function(r,s,o){const[a,u,h]=WR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:N0(r.yt,o.mutation)}})(this.serializer,this.userId,e))}}function Ld(n){return _n(n,B_)}class CU{bt(t){return _n(t,bx)}getSessionToken(t){return this.bt(t).get("sessionToken").next((e=>{const i=e?.value;return i?un.fromUint8Array(i):un.EMPTY_BYTE_STRING}))}setSessionToken(t,e){return this.bt(t).put({name:"sessionToken",value:e.toUint8Array()})}}class Ol{constructor(){}Dt(t,e){this.Ct(t,e),e.vt()}Ct(t,e){if("nullValue"in t)this.Ft(e,5);else if("booleanValue"in t)this.Ft(e,10),e.Mt(t.booleanValue?1:0);else if("integerValue"in t)this.Ft(e,15),e.Mt(Ve(t.integerValue));else if("doubleValue"in t){const i=Ve(t.doubleValue);isNaN(i)?this.Ft(e,13):(this.Ft(e,15),Wf(i)?e.Mt(0):e.Mt(i))}else if("timestampValue"in t){let i=t.timestampValue;this.Ft(e,20),typeof i=="string"&&(i=vo(i)),e.xt(`${i.seconds||""}`),e.Mt(i.nanos||0)}else if("stringValue"in t)this.Ot(t.stringValue,e),this.Nt(e);else if("bytesValue"in t)this.Ft(e,30),e.Bt(Eo(t.bytesValue)),this.Nt(e);else if("referenceValue"in t)this.Lt(t.referenceValue,e);else if("geoPointValue"in t){const i=t.geoPointValue;this.Ft(e,45),e.Mt(i.latitude||0),e.Mt(i.longitude||0)}else"mapValue"in t?wk(t)?this.Ft(e,Number.MAX_SAFE_INTEGER):W_(t)?this.kt(t.mapValue,e):(this.qt(t.mapValue,e),this.Nt(e)):"arrayValue"in t?(this.Qt(t.arrayValue,e),this.Nt(e)):Tt(19022,{$t:t})}Ot(t,e){this.Ft(e,25),this.Ut(t,e)}Ut(t,e){e.xt(t)}qt(t,e){const i=t.fields||{};this.Ft(e,55);for(const r of Object.keys(i))this.Ot(r,e),this.Ct(i[r],e)}kt(t,e){const i=t.fields||{};this.Ft(e,53);const r=ph,s=i[r].arrayValue?.values?.length||0;this.Ft(e,15),e.Mt(Ve(s)),this.Ot(r,e),this.Ct(i[r],e)}Qt(t,e){const i=t.values||[];this.Ft(e,50);for(const r of i)this.Ct(r,e)}Lt(t,e){this.Ft(e,37),pt.fromName(t).path.forEach((i=>{this.Ft(e,60),this.Ut(i,e)}))}Ft(t,e){t.Mt(e)}Nt(t){t.Mt(2)}}Ol.Kt=new Ol;const vc=255;function MU(n){if(n===0)return 8;let t=0;return n>>4||(t+=4,n<<=4),n>>6||(t+=2,n<<=2),n>>7||(t+=1),t}function XR(n){const t=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=MU(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(t/8)}class bU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.Gt(i.value),i=e.next();this.zt()}jt(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.Jt(i.value),i=e.next();this.Ht()}Yt(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(e<"\uD800"||"\uDBFF"<e)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=e.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(e<"\uD800"||"\uDBFF"<e)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=e.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(t){const e=this.en(t),i=XR(e);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=255&e[r]}nn(t){const e=this.en(t),i=XR(e);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=~(255&e[r])}rn(){this.sn(vc),this.sn(255)}_n(){this.an(vc),this.an(255)}reset(){this.position=0}seed(t){this.tn(t.length),this.buffer.set(t,this.position),this.position+=t.length}un(){return this.buffer.slice(0,this.position)}en(t){const e=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(t),i=!!(128&e[0]);e[0]^=i?255:128;for(let r=1;r<e.length;++r)e[r]^=i?255:0;return e}Gt(t){const e=255&t;e===0?(this.sn(0),this.sn(255)):e===vc?(this.sn(vc),this.sn(0)):this.sn(e)}Jt(t){const e=255&t;e===0?(this.an(0),this.an(255)):e===vc?(this.an(vc),this.an(0)):this.an(t)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(t){this.tn(1),this.buffer[this.position++]=t}an(t){this.tn(1),this.buffer[this.position++]=~t}tn(t){const e=t+this.position;if(e<=this.buffer.length)return;let i=2*this.buffer.length;i<e&&(i=e);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class kU{constructor(t){this.cn=t}Bt(t){this.cn.Wt(t)}xt(t){this.cn.Yt(t)}Mt(t){this.cn.Xt(t)}vt(){this.cn.rn()}}class LU{constructor(t){this.cn=t}Bt(t){this.cn.jt(t)}xt(t){this.cn.Zt(t)}Mt(t){this.cn.nn(t)}vt(){this.cn._n()}}class Dd{constructor(){this.cn=new bU,this.ln=new kU(this.cn),this.hn=new LU(this.cn)}seed(t){this.cn.seed(t)}Pn(t){return t===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Vl{constructor(t,e,i,r){this.Tn=t,this.In=e,this.En=i,this.dn=r}An(){const t=this.dn.length,e=t===0||this.dn[t-1]===255?t+1:t,i=new Uint8Array(e);return i.set(this.dn,0),e!==t?i.set([0],this.dn.length):++i[i.length-1],new Vl(this.Tn,this.In,this.En,i)}Rn(t,e,i){return{indexId:this.Tn,uid:t,arrayValue:$p(this.En),directionalValue:$p(this.dn),orderedDocumentKey:$p(e),documentKey:i.path.toArray()}}Vn(t,e,i){const r=this.Rn(t,e,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function ra(n,t){let e=n.Tn-t.Tn;return e!==0?e:(e=YR(n.En,t.En),e!==0?e:(e=YR(n.dn,t.dn),e!==0?e:pt.comparator(n.In,t.In)))}function YR(n,t){for(let e=0;e<n.length&&e<t.length;++e){const i=n[e]-t[e];if(i!==0)return i}return n.length-t.length}function $p(n){return O4()?(function(e){let i="";for(let r=0;r<e.length;r++)i+=String.fromCharCode(e[r]);return i})(n):n}function ZR(n){return typeof n!="string"?n:(function(e){const i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i})(n)}class QR{constructor(t){this.mn=new Se(((e,i)=>Be.comparator(e.field,i.field))),this.collectionId=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment(),this.fn=t.orderBy,this.gn=[];for(const e of t.filters){const i=e;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(t){if(Ct(t.collectionGroup===this.collectionId,49279),this.pn)return!1;const e=DE(t);if(e!==void 0&&!this.wn(e))return!1;const i=Rl(t);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!r.has(a.field.canonicalString())){const u=i[s];if(!this.Sn(a,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let t=new Se(Be.comparator);const e=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")e.push(new Op(i.field,2));else{if(t.has(i.field))continue;t=t.add(i.field),e.push(new Op(i.field,0))}for(const i of this.fn)i.field.isKeyField()||t.has(i.field)||(t=t.add(i.field),e.push(new Op(i.field,i.dir==="asc"?0:1)));return new A0(A0.UNKNOWN_ID,this.collectionId,e,$f.empty())}wn(t){for(const e of this.gn)if(this.Sn(e,t))return!0;return!1}Sn(t,e){if(t===void 0||!t.field.isEqual(e.fieldPath))return!1;const i=t.op==="array-contains"||t.op==="array-contains-any";return e.kind===2===i}bn(t,e){return!!t.field.isEqual(e.fieldPath)&&(e.kind===0&&t.dir==="asc"||e.kind===1&&t.dir==="desc")}}function lL(n){if(Ct(n instanceof te||n instanceof Te,20012),n instanceof te){if(n instanceof Mk){const e=n.value.arrayValue?.values?.map((i=>te.create(n.field,"==",i)))||[];return Te.create(e,"or")}return n}const t=n.filters.map((e=>lL(e)));return Te.create(t,n.op)}function DU(n){if(n.getFilters().length===0)return[];const t=QE(lL(n));return Ct(uL(t),7391),YE(t)||ZE(t)?[t]:t.getFilters()}function YE(n){return n instanceof te}function ZE(n){return n instanceof Te&&Ox(n)}function uL(n){return YE(n)||ZE(n)||(function(e){if(e instanceof Te&&jE(e)){for(const i of e.getFilters())if(!YE(i)&&!ZE(i))return!1;return!0}return!1})(n)}function QE(n){if(Ct(n instanceof te||n instanceof Te,34018),n instanceof te)return n;if(n.filters.length===1)return QE(n.filters[0]);const t=n.filters.map((i=>QE(i)));let e=Te.create(t,n.op);return e=V0(e),uL(e)?e:(Ct(e instanceof Te,64498),Ct(vh(e),40251),Ct(e.filters.length>1,57927),e.filters.reduce(((i,r)=>$x(i,r))))}function $x(n,t){let e;return Ct(n instanceof te||n instanceof Te,38388),Ct(t instanceof te||t instanceof Te,25473),e=n instanceof te?t instanceof te?(function(r,s){return Te.create([r,s],"and")})(n,t):JR(n,t):t instanceof te?JR(t,n):(function(r,s){if(Ct(r.filters.length>0&&s.filters.length>0,48005),vh(r)&&vh(s))return Rk(r,s.getFilters());const o=jE(r)?r:s,a=jE(r)?s:r,u=o.filters.map((h=>$x(h,a)));return Te.create(u,"or")})(n,t),V0(e)}function JR(n,t){if(vh(t))return Rk(t,n.getFilters());{const e=t.filters.map((i=>$x(n,i)));return Te.create(e,"or")}}function V0(n){if(Ct(n instanceof te||n instanceof Te,11850),n instanceof te)return n;const t=n.getFilters();if(t.length===1)return V0(t[0]);if(Ik(n))return n;const e=t.map((r=>V0(r))),i=[];return e.forEach((r=>{r instanceof te?i.push(r):r instanceof Te&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:Te.create(i,n.op)}class NU{constructor(){this.Cn=new Wx}addToCollectionParentIndex(t,e){return this.Cn.add(e),q.resolve()}getCollectionParents(t,e){return q.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return q.resolve()}deleteFieldIndex(t,e){return q.resolve()}deleteAllFieldIndexes(t){return q.resolve()}createTargetIndexes(t,e){return q.resolve()}getDocumentsMatchingTarget(t,e){return q.resolve(null)}getIndexType(t,e){return q.resolve(0)}getFieldIndexes(t,e){return q.resolve([])}getNextCollectionGroupToUpdate(t){return q.resolve(null)}getMinOffset(t,e){return q.resolve(Yi.min())}getMinOffsetFromCollectionGroup(t,e){return q.resolve(Yi.min())}updateCollectionGroup(t,e,i){return q.resolve()}updateIndexEntries(t,e){return q.resolve()}}class Wx{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e]||new Se(fe.comparator),s=!r.has(i);return this.index[e]=r.add(i),s}has(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e];return r&&r.has(i)}getEntries(t){return(this.index[t]||new Se(fe.comparator)).toArray()}}const tP="IndexedDbIndexManager",vp=new Uint8Array(0);class OU{constructor(t,e){this.databaseId=e,this.vn=new Wx,this.Fn=new Ao((i=>cu(i)),((i,r)=>Pg(i,r))),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.vn.has(e)){const i=e.lastSegment(),r=e.popLast();t.addOnCommittedListener((()=>{this.vn.add(e)}));const s={collectionId:i,parent:ei(r)};return eP(t).put(s)}return q.resolve()}getCollectionParents(t,e){const i=[],r=IDBKeyRange.bound([e,""],[Z4(e),""],!1,!0);return eP(t).J(r).next((s=>{for(const o of s){if(o.collectionId!==e)break;i.push(Ts(o.parent))}return i}))}addFieldIndex(t,e){const i=Nd(t),r=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(e);delete r.indexId;const s=i.add(r);if(e.indexState){const o=wc(t);return s.next((a=>{o.put(KR(a,this.uid,e.indexState.sequenceNumber,e.indexState.offset))}))}return s.next()}deleteFieldIndex(t,e){const i=Nd(t),r=wc(t),s=Ec(t);return i.delete(e.indexId).next((()=>r.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))))}deleteAllFieldIndexes(t){const e=Nd(t),i=Ec(t),r=wc(t);return e.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(t,e){return q.forEach(this.Mn(e),(i=>this.getIndexType(t,i).next((r=>{if(r===0||r===1){const s=new QR(i).Dn();if(s!=null)return this.addFieldIndex(t,s)}}))))}getDocumentsMatchingTarget(t,e){const i=Ec(t);let r=!0;const s=new Map;return q.forEach(this.Mn(e),(o=>this.xn(t,o).next((a=>{r&&(r=!!a),s.set(o,a)})))).next((()=>{if(r){let o=Yt();const a=[];return q.forEach(s,((u,h)=>{ct(tP,`Using index ${(function(M){return`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${cu(e)}`);const d=(function(M,L){const D=DE(L);if(D===void 0)return null;for(const j of L0(M,D.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null})(h,u),g=(function(M,L){const D=new Map;for(const j of Rl(L))for(const b of L0(M,j.fieldPath))switch(b.op){case"==":case"in":D.set(j.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return D.set(j.fieldPath.canonicalString(),b.value),Array.from(D.values())}return null})(h,u),m=(function(M,L){const D=[];let j=!0;for(const b of Rl(L)){const A=b.kind===0?kR(M,b.fieldPath,M.startAt):LR(M,b.fieldPath,M.startAt);D.push(A.value),j&&(j=A.inclusive)}return new yh(D,j)})(h,u),v=(function(M,L){const D=[];let j=!0;for(const b of Rl(L)){const A=b.kind===0?LR(M,b.fieldPath,M.endAt):kR(M,b.fieldPath,M.endAt);D.push(A.value),j&&(j=A.inclusive)}return new yh(D,j)})(h,u),y=this.On(u,h,m),S=this.On(u,h,v),w=this.Nn(u,h,g),R=this.Bn(u.indexId,d,y,m.inclusive,S,v.inclusive,w);return q.forEach(R,(P=>i.Y(P,e.limit).next((M=>{M.forEach((L=>{const D=pt.fromSegments(L.documentKey);o.has(D)||(o=o.add(D),a.push(D))}))}))))})).next((()=>a))}return q.resolve(null)}))}Mn(t){let e=this.Fn.get(t);return e||(t.filters.length===0?e=[t]:e=DU(Te.create(t.filters,"and")).map((i=>BE(t.path,t.collectionGroup,t.orderBy,i.getFilters(),t.limit,t.startAt,t.endAt))),this.Fn.set(t,e),e)}Bn(t,e,i,r,s,o,a){const u=(e!=null?e.length:1)*Math.max(i.length,s.length),h=u/(e!=null?e.length:1),d=[];for(let g=0;g<u;++g){const m=e?this.Ln(e[g/h]):vp,v=this.kn(t,m,i[g%h],r),y=this.qn(t,m,s[g%h],o),S=a.map((w=>this.kn(t,m,w,!0)));d.push(...this.createRange(v,y,S))}return d}kn(t,e,i,r){const s=new Vl(t,pt.empty(),e,i);return r?s:s.An()}qn(t,e,i,r){const s=new Vl(t,pt.empty(),e,i);return r?s.An():s}xn(t,e){const i=new QR(e),r=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,r).next((s=>{let o=null;for(const a of s)i.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(t,e){let i=2;const r=this.Mn(e);return q.forEach(r,(s=>this.xn(t,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new Se(Be.comparator),d=!1;for(const g of u.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const g of u.orderBy)g.field.isKeyField()||(h=h.add(g.field));return h.size+(d?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(e)&&r.length>1&&i===2?1:i))}Qn(t,e){const i=new Dd;for(const r of Rl(t)){const s=e.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Ol.Kt.Dt(s,o)}return i.un()}Ln(t){const e=new Dd;return Ol.Kt.Dt(t,e.Pn(0)),e.un()}$n(t,e){const i=new Dd;return Ol.Kt.Dt(Zf(this.databaseId,e),i.Pn((function(s){const o=Rl(s);return o.length===0?0:o[o.length-1].kind})(t))),i.un()}Nn(t,e,i){if(i===null)return[];let r=[];r.push(new Dd);let s=0;for(const o of Rl(t)){const a=i[s++];for(const u of r)if(this.Un(e,o.fieldPath)&&Qf(a))r=this.Kn(r,o,a);else{const h=u.Pn(o.kind);Ol.Kt.Dt(a,h)}}return this.Wn(r)}On(t,e,i){return this.Nn(t,e,i.position)}Wn(t){const e=[];for(let i=0;i<t.length;++i)e[i]=t[i].un();return e}Kn(t,e,i){const r=[...t],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const u=new Dd;u.seed(a.un()),Ol.Kt.Dt(o,u.Pn(e.kind)),s.push(u)}return s}Un(t,e){return!!t.filters.find((i=>i instanceof te&&i.field.isEqual(e)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(t,e){const i=Nd(t),r=wc(t);return(e?i.J(OE,IDBKeyRange.bound(e,e)):i.J()).next((s=>{const o=[];return q.forEach(s,(a=>r.get([a.indexId,this.uid]).next((u=>{o.push((function(d,g){const m=g?new $f(g.sequenceNumber,new Yi(du(g.readTime),new pt(Ts(g.documentKey)),g.largestBatchId)):$f.empty(),v=d.fields.map((([y,S])=>new Op(Be.fromServerFormat(y),S)));return new A0(d.indexId,d.collectionGroup,v,m)})(a,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next((e=>e.length===0?null:(e.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:zt(i.collectionGroup,r.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(t,e,i){const r=Nd(t),s=wc(t);return this.Gn(t).next((o=>r.J(OE,IDBKeyRange.bound(e,e)).next((a=>q.forEach(a,(u=>s.put(KR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(t,e){const i=new Map;return q.forEach(e,((r,s)=>{const o=i.get(r.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(t,r.collectionGroup)).next((a=>(i.set(r.collectionGroup,a),q.forEach(a,(u=>this.zn(t,r,u).next((h=>{const d=this.jn(s,u);return h.isEqual(d)?q.resolve():this.Jn(t,s,u,h,d)})))))))}))}Hn(t,e,i,r){return Ec(t).put(r.Rn(this.uid,this.$n(i,e.key),e.key))}Yn(t,e,i,r){return Ec(t).delete(r.Vn(this.uid,this.$n(i,e.key),e.key))}zn(t,e,i){const r=Ec(t);let s=new Se(ra);return r.ee({index:lk,range:IDBKeyRange.only([i.indexId,this.uid,$p(this.$n(i,e))])},((o,a)=>{s=s.add(new Vl(i.indexId,e,ZR(a.arrayValue),ZR(a.directionalValue)))})).next((()=>s))}jn(t,e){let i=new Se(ra);const r=this.Qn(e,t);if(r==null)return i;const s=DE(e);if(s!=null){const o=t.data.field(s.fieldPath);if(Qf(o))for(const a of o.arrayValue.values||[])i=i.add(new Vl(e.indexId,t.key,this.Ln(a),r))}else i=i.add(new Vl(e.indexId,t.key,vp,r));return i}Jn(t,e,i,r,s){ct(tP,"Updating index entries for document '%s'",e.key);const o=[];return(function(u,h,d,g,m){const v=u.getIterator(),y=h.getIterator();let S=yc(v),w=yc(y);for(;S||w;){let R=!1,P=!1;if(S&&w){const M=d(S,w);M<0?P=!0:M>0&&(R=!0)}else S!=null?P=!0:R=!0;R?(g(w),w=yc(y)):P?(m(S),S=yc(v)):(S=yc(v),w=yc(y))}})(r,s,ra,(a=>{o.push(this.Hn(t,e,i,a))}),(a=>{o.push(this.Yn(t,e,i,a))})),q.waitFor(o)}Gn(t){let e=1;return wc(t).ee({index:ak,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),e=r.sequenceNumber+1})).next((()=>e))}createRange(t,e,i){i=i.sort(((o,a)=>ra(o,a))).filter(((o,a,u)=>!a||ra(o,u[a-1])!==0));const r=[];r.push(t);for(const o of i){const a=ra(o,t),u=ra(o,e);if(a===0)r[0]=t.An();else if(a>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(e);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const a=r[o].Vn(this.uid,vp,pt.empty()),u=r[o+1].Vn(this.uid,vp,pt.empty());s.push(IDBKeyRange.bound(a,u))}return s}Zn(t,e){return ra(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(nP)}getMinOffset(t,e){return q.mapArray(this.Mn(e),(i=>this.xn(t,i).next((r=>r||Tt(44426))))).next(nP)}}function eP(n){return _n(n,Hf)}function Ec(n){return _n(n,df)}function Nd(n){return _n(n,Mx)}function wc(n){return _n(n,hf)}function nP(n){Ct(n.length!==0,28825);let t=n[0].indexState.offset,e=t.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Rx(r,t)<0&&(t=r),e<r.largestBatchId&&(e=r.largestBatchId)}return new Yi(t.readTime,t.documentKey,e)}const iP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cL=41943040;class Yn{static withCacheSize(t){return new Yn(t,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}}function hL(n,t,e){const i=n.store(Ur),r=n.store(dh),s=[],o=IDBKeyRange.only(e.batchId);let a=0;const u=i.ee({range:o},((d,g,m)=>(a++,m.delete())));s.push(u.next((()=>{Ct(a===1,47070,{batchId:e.batchId})})));const h=[];for(const d of e.mutations){const g=rk(t,d.key.path,e.batchId);s.push(r.delete(g)),h.push(d.key)}return q.waitFor(s).next((()=>h))}function F0(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw Tt(14731);t=n.noDocument}return JSON.stringify(t).length}Yn.DEFAULT_COLLECTION_PERCENTILE=10,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yn.DEFAULT=new Yn(cL,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yn.DISABLED=new Yn(-1,0,0);class Q_{constructor(t,e,i,r){this.userId=t,this.serializer=e,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(t,e,i,r){Ct(t.uid!=="",64387);const s=t.isAuthenticated()?t.uid:"";return new Q_(s,e,i,r)}checkEmpty(t){let e=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sa(t).ee({index:$l,range:i},((r,s,o)=>{e=!1,o.done()})).next((()=>e))}addMutationBatch(t,e,i,r){const s=kc(t),o=sa(t);return o.add({}).next((a=>{Ct(typeof a=="number",49019);const u=new Gx(a,e,i,r),h=(function(v,y,S){const w=S.baseMutations.map((P=>N0(v.yt,P))),R=S.mutations.map((P=>N0(v.yt,P)));return{userId:y,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:w,mutations:R}})(this.serializer,this.userId,u),d=[];let g=new Se(((m,v)=>zt(m.canonicalString(),v.canonicalString())));for(const m of r){const v=rk(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),d.push(o.put(h)),d.push(s.put(v,cG))}return g.forEach((m=>{d.push(this.indexManager.addToCollectionParentIndex(t,m))})),t.addOnCommittedListener((()=>{this.Xn[a]=u.keys()})),q.waitFor(d).next((()=>u))}))}lookupMutationBatch(t,e){return sa(t).get(e).next((i=>i?(Ct(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:e}),Nl(this.serializer,i)):null))}er(t,e){return this.Xn[e]?q.resolve(this.Xn[e]):this.lookupMutationBatch(t,e).next((i=>{if(i){const r=i.keys();return this.Xn[e]=r,r}return null}))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return sa(t).ee({index:$l,range:r},((o,a,u)=>{a.userId===this.userId&&(Ct(a.batchId>=i,47524,{tr:i}),s=Nl(this.serializer,a)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ql;return sa(t).ee({index:$l,range:e,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,ql],[this.userId,Number.POSITIVE_INFINITY]);return sa(t).J($l,e).next((i=>i.map((r=>Nl(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(t,e){const i=Vp(this.userId,e.path),r=IDBKeyRange.lowerBound(i),s=[];return kc(t).ee({range:r},((o,a,u)=>{const[h,d,g]=o,m=Ts(d);if(h===this.userId&&e.path.isEqual(m))return sa(t).get(g).next((v=>{if(!v)throw Tt(61480,{nr:o,batchId:g});Ct(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:g}),s.push(Nl(this.serializer,v))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Se(zt);const r=[];return e.forEach((s=>{const o=Vp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=kc(t).ee({range:a},((h,d,g)=>{const[m,v,y]=h,S=Ts(v);m===this.userId&&s.path.isEqual(S)?i=i.add(y):g.done()}));r.push(u)})),q.waitFor(r).next((()=>this.rr(t,i)))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1,s=Vp(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new Se(zt);return kc(t).ee({range:o},((u,h,d)=>{const[g,m,v]=u,y=Ts(m);g===this.userId&&i.isPrefixOf(y)?y.length===r&&(a=a.add(v)):d.done()})).next((()=>this.rr(t,a)))}rr(t,e){const i=[],r=[];return e.forEach((s=>{r.push(sa(t).get(s).next((o=>{if(o===null)throw Tt(35274,{batchId:s});Ct(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Nl(this.serializer,o))})))})),q.waitFor(r).next((()=>i))}removeMutationBatch(t,e){return hL(t.le,this.userId,e).next((i=>(t.addOnCommittedListener((()=>{this.ir(e.batchId)})),q.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(t,r))))))}ir(t){delete this.Xn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next((e=>{if(!e)return q.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return kc(t).ee({range:i},((s,o,a)=>{if(s[0]===this.userId){const u=Ts(s[1]);r.push(u)}else a.done()})).next((()=>{Ct(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(t,e){return dL(t,this.userId,e)}_r(t){return fL(t).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:ql,lastStreamToken:""}))}}function dL(n,t,e){const i=Vp(t,e.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return kc(n).ee({range:s,X:!0},((a,u,h)=>{const[d,g,m]=a;d===t&&g===r&&(o=!0),h.done()})).next((()=>o))}function sa(n){return _n(n,Ur)}function kc(n){return _n(n,dh)}function fL(n){return _n(n,Kf)}class fu{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new fu(0)}static cr(){return new fu(-1)}}class VU{constructor(t,e){this.referenceDelegate=t,this.serializer=e}allocateTargetId(t){return this.lr(t).next((e=>{const i=new fu(e.highestTargetId);return e.highestTargetId=i.next(),this.hr(t,e).next((()=>e.highestTargetId))}))}getLastRemoteSnapshotVersion(t){return this.lr(t).next((e=>Mt.fromTimestamp(new xe(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(t){return this.lr(t).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(t,e,i){return this.lr(t).next((r=>(r.highestListenSequenceNumber=e,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),this.hr(t,r))))}addTargetData(t,e){return this.Pr(t,e).next((()=>this.lr(t).next((i=>(i.targetCount+=1,this.Tr(e,i),this.hr(t,i))))))}updateTargetData(t,e){return this.Pr(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next((()=>xc(t).delete(e.targetId))).next((()=>this.lr(t))).next((i=>(Ct(i.targetCount>0,8065),i.targetCount-=1,this.hr(t,i))))}removeTargets(t,e,i){let r=0;const s=[];return xc(t).ee(((o,a)=>{const u=Zd(a);u.sequenceNumber<=e&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(t,u)))})).next((()=>q.waitFor(s))).next((()=>r))}forEachTarget(t,e){return xc(t).ee(((i,r)=>{const s=Zd(r);e(s)}))}lr(t){return rP(t).get(C0).next((e=>(Ct(e!==null,2888),e)))}hr(t,e){return rP(t).put(C0,e)}Pr(t,e){return xc(t).put(oL(this.serializer,e))}Tr(t,e){let i=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,i=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,i=!0),i}getTargetCount(t){return this.lr(t).next((e=>e.targetCount))}getTargetData(t,e){const i=cu(e),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return xc(t).ee({range:r,index:ok},((o,a,u)=>{const h=Zd(a);Pg(e,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(t,e,i){const r=[],s=da(t);return e.forEach((o=>{const a=ei(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(t,i,o))})),q.waitFor(r)}removeMatchingKeys(t,e,i){const r=da(t);return q.forEach(e,(s=>{const o=ei(s.path);return q.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(t,i,s)])}))}removeMatchingKeysForTargetId(t,e){const i=da(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(t,e){const i=IDBKeyRange.bound([e],[e+1],!1,!0),r=da(t);let s=Yt();return r.ee({range:i,X:!0},((o,a,u)=>{const h=Ts(o[1]),d=new pt(h);s=s.add(d)})).next((()=>s))}containsKey(t,e){const i=ei(e.path),r=IDBKeyRange.bound([i],[Z4(i)],!1,!0);let s=0;return da(t).ee({index:Cx,X:!0,range:r},(([o,a],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(t,e){return xc(t).get(e).next((i=>i?Zd(i):null))}}function xc(n){return _n(n,fh)}function rP(n){return _n(n,Hl)}function da(n){return _n(n,gh)}const sP="LruGarbageCollector",FU=1048576;function oP([n,t],[e,i]){const r=zt(n,e);return r===0?zt(t,i):r}class GU{constructor(t){this.Ir=t,this.buffer=new Se(oP),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();oP(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class gL{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){ct(sP,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Wa(e)?ct(sP,"Ignoring IndexedDB error during garbage collection: ",e):await Su(e)}await this.Vr(3e5)}))}}class UU{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((i=>Math.floor(e/100*i)))}nthSequenceNumber(t,e){if(e===0)return q.resolve(wr.ce);const i=new GU(e);return this.mr.forEachTarget(t,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(t,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(t,e,i){return this.mr.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(ct("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(iP)):this.getCacheSize(t).next((i=>i<this.params.cacheSizeCollectionThreshold?(ct("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iP):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let i,r,s,o,a,u,h;const d=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(ct("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(t,r)))).next((g=>(i=g,a=Date.now(),this.removeTargets(t,i,e)))).next((g=>(s=g,u=Date.now(),this.removeOrphanedDocuments(t,i)))).next((g=>(h=Date.now(),Pc()<=Jt.DEBUG&&ct("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g}))))}}function mL(n,t){return new UU(n,t)}class jU{constructor(t,e){this.db=t,this.garbageCollector=mL(this,e)}gr(t){const e=this.wr(t);return this.db.getTargetCache().getTargetCount(t).next((i=>e.next((r=>i+r))))}wr(t){let e=0;return this.pr(t,(i=>{e++})).next((()=>e))}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}pr(t,e){return this.Sr(t,((i,r)=>e(r)))}addReference(t,e,i){return Ep(t,i)}removeReference(t,e,i){return Ep(t,i)}removeTargets(t,e,i){return this.db.getTargetCache().removeTargets(t,e,i)}markPotentiallyOrphaned(t,e){return Ep(t,e)}br(t,e){return(function(r,s){let o=!1;return fL(r).te((a=>dL(r,a,s).next((u=>(u&&(o=!0),q.resolve(!u)))))).next((()=>o))})(t,e)}removeOrphanedDocuments(t,e){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(t,((o,a)=>{if(a<=e){const u=this.br(t,o).next((h=>{if(!h)return s++,i.getEntry(t,o).next((()=>(i.removeEntry(o,Mt.min()),da(t).delete((function(g){return[0,ei(g.path)]})(o)))))}));r.push(u)}})).next((()=>q.waitFor(r))).next((()=>i.apply(t))).next((()=>s))}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,i)}updateLimboDocument(t,e){return Ep(t,e)}Sr(t,e){const i=da(t);let r,s=wr.ce;return i.ee({index:Cx},(([o,a],{path:u,sequenceNumber:h})=>{o===0?(s!==wr.ce&&e(new pt(Ts(r)),s),s=h,r=u):s=wr.ce})).next((()=>{s!==wr.ce&&e(new pt(Ts(r)),s)}))}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function Ep(n,t){return da(n).put((function(i,r){return{targetId:0,path:ei(i.path),sequenceNumber:r}})(t,n.currentSequenceNumber))}class pL{constructor(){this.changes=new Ao((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Xe.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?q.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class zU{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,i){return xl(t).put(i)}removeEntry(t,e,i){return xl(t).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],O0(o),a[a.length-1]]})(e,i))}updateMetadata(t,e){return this.getMetadata(t).next((i=>(i.byteSize+=e,this.Dr(t,i))))}getEntry(t,e){let i=Xe.newInvalidDocument(e);return xl(t).ee({index:Fp,range:IDBKeyRange.only(Od(e))},((r,s)=>{i=this.Cr(e,s)})).next((()=>i))}vr(t,e){let i={size:0,document:Xe.newInvalidDocument(e)};return xl(t).ee({index:Fp,range:IDBKeyRange.only(Od(e))},((r,s)=>{i={document:this.Cr(e,s),size:F0(s)}})).next((()=>i))}getEntries(t,e){let i=Wi();return this.Fr(t,e,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(t,e){let i=Wi(),r=new Ge(pt.comparator);return this.Fr(t,e,((s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a),r=r.insert(s,F0(o))})).next((()=>({documents:i,Or:r})))}Fr(t,e,i){if(e.isEmpty())return q.resolve();let r=new Se(uP);e.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Od(r.first()),Od(r.last())),o=r.getIterator();let a=o.getNext();return xl(t).ee({index:Fp,range:s},((u,h,d)=>{const g=pt.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&uP(a,g)<0;)i(a,null),a=o.getNext();a&&a.isEqual(g)&&(i(a,h),a=o.hasNext()?o.getNext():null),a?d.j(Od(a)):d.done()})).next((()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(t,e,i,r,s){const o=e.path,a=[o.popLast().toArray(),o.lastSegment(),O0(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xl(t).J(IDBKeyRange.bound(a,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let d=Wi();for(const g of h){const m=this.Cr(pt.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(Mg(e,m)||r.has(m.key))&&(d=d.insert(m.key,m))}return d}))}getAllFromCollectionGroup(t,e,i,r){let s=Wi();const o=lP(e,i),a=lP(e,Yi.max());return xl(t).ee({index:sk,range:IDBKeyRange.bound(o,a,!0)},((u,h,d)=>{const g=this.Cr(pt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(g.key,g),s.size===r&&d.done()})).next((()=>s))}newChangeBuffer(t){return new BU(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next((e=>e.byteSize))}getMetadata(t){return aP(t).get(NE).next((e=>(Ct(!!e,20021),e)))}Dr(t,e){return aP(t).put(NE,e)}Cr(t,e){if(e){const i=RU(this.serializer,e);if(!(i.isNoDocument()&&i.version.isEqual(Mt.min())))return i}return Xe.newInvalidDocument(t)}}function _L(n){return new zU(n)}class BU extends pL{constructor(t,e){super(),this.Nr=t,this.trackRemovals=e,this.Br=new Ao((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(t){const e=[];let i=0,r=new Se(((s,o)=>zt(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(e.push(this.Nr.removeEntry(t,s,a.readTime)),o.isValidDocument()){const u=$R(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=F0(u);i+=h-a.size,e.push(this.Nr.addEntry(t,s,u))}else if(i-=a.size,this.trackRemovals){const u=$R(this.Nr.serializer,o.convertToNoDocument(Mt.min()));e.push(this.Nr.addEntry(t,s,u))}})),r.forEach((s=>{e.push(this.Nr.indexManager.addToCollectionParentIndex(t,s))})),e.push(this.Nr.updateMetadata(t,i)),q.waitFor(e)}getFromCache(t,e){return this.Nr.vr(t,e).next((i=>(this.Br.set(e,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(t,e){return this.Nr.Mr(t,e).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function aP(n){return _n(n,qf)}function xl(n){return _n(n,P0)}function Od(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function lP(n,t){const e=t.documentKey.path.toArray();return[n,O0(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function uP(n,t){const e=n.path.toArray(),i=t.path.toArray();let r=0;for(let s=0;s<e.length-2&&s<i.length-2;++s)if(r=zt(e[s],i[s]),r)return r;return r=zt(e.length,i.length),r||(r=zt(e[e.length-2],i[i.length-2]),r||zt(e[e.length-1],i[i.length-1]))}class $U{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class yL{constructor(t,e,i,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next((r=>(i=r,this.remoteDocumentCache.getEntry(t,e)))).next((r=>(i!==null&&pf(i.mutation,r,Mi.empty(),xe.now()),r)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.getLocalViewOfDocuments(t,i,Yt()).next((()=>i))))}getLocalViewOfDocuments(t,e,i=Yt()){const r=Ss();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,i).next((s=>{let o=Xd();return s.forEach(((a,u)=>{o=o.insert(a,u.overlayedDocument)})),o}))))}getOverlayedDocuments(t,e){const i=Ss();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,Yt())))}populateOverlays(t,e,i){const r=[];return i.forEach((s=>{e.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(t,r).next((s=>{s.forEach(((o,a)=>{e.set(o,a)}))}))}computeViews(t,e,i,r){let s=Wi();const o=mf(),a=(function(){return mf()})();return e.forEach(((u,h)=>{const d=i.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof Ro)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),pf(d.mutation,h,d.mutation.getFieldMask(),xe.now())):o.set(h.key,Mi.empty())})),this.recalculateAndSaveOverlays(t,s).next((u=>(u.forEach(((h,d)=>o.set(h,d))),e.forEach(((h,d)=>a.set(h,new $U(d,o.get(h)??null)))),a)))}recalculateAndSaveOverlays(t,e){const i=mf();let r=new Ge(((o,a)=>o-a)),s=Yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((o=>{for(const a of o)a.keys().forEach((u=>{const h=e.get(u);if(h===null)return;let d=i.get(u)||Mi.empty();d=a.applyToLocalView(h,d),i.set(u,d);const g=(r.get(a.batchId)||Yt()).add(u);r=r.insert(a.batchId,g)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),h=u.key,d=u.value,g=Ok();d.forEach((m=>{if(!s.has(m)){const v=zk(e.get(m),i.get(m));v!==null&&g.set(m,v),s=s.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(t,h,g))}return q.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.recalculateAndSaveOverlays(t,i)))}getDocumentsMatchingQuery(t,e,i,r){return(function(o){return pt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):bk(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,r):this.getDocumentsMatchingCollectionQuery(t,e,i,r)}getNextDocuments(t,e,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,r-s.size):q.resolve(Ss());let a=Bf,u=s;return o.next((h=>q.forEach(h,((d,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(d)?q.resolve():this.remoteDocumentCache.getEntry(t,d).next((m=>{u=u.insert(d,m)}))))).next((()=>this.populateOverlays(t,h,s))).next((()=>this.computeViews(t,u,h,Yt()))).next((d=>({batchId:a,changes:Nk(d)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new pt(e)).next((i=>{let r=Xd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(t,e,i,r){const s=e.collectionGroup;let o=Xd();return this.indexManager.getCollectionParents(t,s).next((a=>q.forEach(a,(u=>{const h=(function(g,m){return new Cg(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(e,u.child(s));return this.getDocumentsMatchingCollectionQuery(t,h,i,r).next((d=>{d.forEach(((g,m)=>{o=o.insert(g,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(t,e,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Xe.newInvalidDocument(d)))}));let a=Xd();return o.forEach(((u,h)=>{const d=s.get(u);d!==void 0&&pf(d.mutation,h,Mi.empty(),xe.now()),Mg(e,h)&&(a=a.insert(u,h))})),a}))}}class WU{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return q.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(r){return{id:r.id,version:r.version,createTime:di(r.createTime)}})(e)),q.resolve()}getNamedQuery(t,e){return q.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(r){return{name:r.name,query:aL(r.bundledQuery),readTime:di(r.readTime)}})(e)),q.resolve()}}class KU{constructor(){this.overlays=new Ge(pt.comparator),this.qr=new Map}getOverlay(t,e){return q.resolve(this.overlays.get(e))}getOverlays(t,e){const i=Ss();return q.forEach(e,(r=>this.getOverlay(t,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(t,e,i){return i.forEach(((r,s)=>{this.St(t,e,s)})),q.resolve()}removeOverlaysForBatchId(t,e,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),q.resolve()}getOverlaysForCollection(t,e,i){const r=Ss(),s=e.length+1,o=new pt(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return q.resolve(r)}getOverlaysForCollectionGroup(t,e,i,r){let s=new Ge(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>i){let d=s.get(h.largestBatchId);d===null&&(d=Ss(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=Ss(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,d)=>a.set(h,d))),!(a.size()>=r)););return q.resolve(a)}St(t,e,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new jx(e,i));let s=this.qr.get(e);s===void 0&&(s=Yt(),this.qr.set(e,s)),this.qr.set(e,s.add(i.key))}}class qU{constructor(){this.sessionToken=un.EMPTY_BYTE_STRING}getSessionToken(t){return q.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,q.resolve()}}class Kx{constructor(){this.Qr=new Se(Sn.$r),this.Ur=new Se(Sn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const i=new Sn(t,e);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(t,e){t.forEach((i=>this.addReference(i,e)))}removeReference(t,e){this.Gr(new Sn(t,e))}zr(t,e){t.forEach((i=>this.removeReference(i,e)))}jr(t){const e=new pt(new fe([])),i=new Sn(e,t),r=new Sn(e,t+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new pt(new fe([])),i=new Sn(e,t),r=new Sn(e,t+1);let s=Yt();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(t){const e=new Sn(t,0),i=this.Qr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class Sn{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return pt.comparator(t.key,e.key)||zt(t.Yr,e.Yr)}static Kr(t,e){return zt(t.Yr,e.Yr)||pt.comparator(t.key,e.key)}}class HU{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new Se(Sn.$r)}checkEmpty(t){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Gx(s,e,i,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Sn(a.key,s)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(t,e){return q.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,r=this.ei(i),s=r<0?0:r;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?ql:this.tr-1)}getAllMutationBatches(t){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new Sn(e,0),r=new Sn(e,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const a=this.Xr(o.Yr);s.push(a)})),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Se(zt);return e.forEach((r=>{const s=new Sn(r,0),o=new Sn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{i=i.add(a.Yr)}))})),q.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1;let s=i;pt.isDocumentKey(s)||(s=s.child(""));const o=new Sn(new pt(s),0);let a=new Se(zt);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(u.Yr)),!0)}),o),q.resolve(this.ti(a))}ti(t){const e=[];return t.forEach((i=>{const r=this.Xr(i);r!==null&&e.push(r)})),e}removeMutationBatch(t,e){Ct(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return q.forEach(e.mutations,(r=>{const s=new Sn(r.key,e.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((()=>{this.Zr=i}))}ir(t){}containsKey(t,e){const i=new Sn(e,0),r=this.Zr.firstAfterOrEqual(i);return q.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,q.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class XU{constructor(t){this.ri=t,this.docs=(function(){return new Ge(pt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return q.resolve(i?i.document.mutableCopy():Xe.newInvalidDocument(e))}getEntries(t,e){let i=Wi();return e.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Xe.newInvalidDocument(r))})),q.resolve(i)}getDocumentsMatchingQuery(t,e,i,r){let s=Wi();const o=e.path,a=new pt(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Rx(tk(d),i)<=0||(r.has(d.key)||Mg(e,d))&&(s=s.insert(d.key,d.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(t,e,i,r){Tt(9500)}ii(t,e){return q.forEach(this.docs,(i=>e(i)))}newChangeBuffer(t){return new YU(this)}getSize(t){return q.resolve(this.size)}}class YU extends pL{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?e.push(this.Nr.addEntry(t,r)):this.Nr.removeEntry(i)})),q.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class ZU{constructor(t){this.persistence=t,this.si=new Ao((e=>cu(e)),Pg),this.lastRemoteSnapshotVersion=Mt.min(),this.highestTargetId=0,this.oi=0,this._i=new Kx,this.targetCount=0,this.ai=fu.ur()}forEachTarget(t,e){return this.si.forEach(((i,r)=>e(r))),q.resolve()}getLastRemoteSnapshotVersion(t){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return q.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.oi&&(this.oi=e),q.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new fu(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,q.resolve()}updateTargetData(t,e){return this.Pr(e),q.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,q.resolve()}removeTargets(t,e,i){let r=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=e&&i.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),r++)})),q.waitFor(s).next((()=>r))}getTargetCount(t){return q.resolve(this.targetCount)}getTargetData(t,e){const i=this.si.get(e)||null;return q.resolve(i)}addMatchingKeys(t,e,i){return this._i.Wr(e,i),q.resolve()}removeMatchingKeys(t,e,i){this._i.zr(e,i);const r=this.persistence.referenceDelegate,s=[];return r&&e.forEach((o=>{s.push(r.markPotentiallyOrphaned(t,o))})),q.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),q.resolve()}getMatchingKeysForTargetId(t,e){const i=this._i.Hr(e);return q.resolve(i)}containsKey(t,e){return q.resolve(this._i.containsKey(e))}}class qx{constructor(t,e){this.ui={},this.overlays={},this.ci=new wr(0),this.li=!1,this.li=!0,this.hi=new qU,this.referenceDelegate=t(this),this.Pi=new ZU(this),this.indexManager=new NU,this.remoteDocumentCache=(function(r){return new XU(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new sL(e),this.Ii=new WU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new KU,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.ui[t.toKey()];return i||(i=new HU(e,this.referenceDelegate),this.ui[t.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,i){ct("MemoryPersistence","Starting transaction:",t);const r=new QU(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(t,e){return q.or(Object.values(this.ui).map((i=>()=>i.containsKey(t,e))))}}class QU extends nk{constructor(t){super(),this.currentSequenceNumber=t}}class J_{constructor(t){this.persistence=t,this.Ri=new Kx,this.Vi=null}static mi(t){return new J_(t)}get fi(){if(this.Vi)return this.Vi;throw Tt(60996)}addReference(t,e,i){return this.Ri.addReference(i,e),this.fi.delete(i.toString()),q.resolve()}removeReference(t,e,i){return this.Ri.removeReference(i,e),this.fi.add(i.toString()),q.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),q.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,(i=>{const r=pt.fromPath(i);return this.gi(t,r).next((s=>{s||e.removeEntry(r,Mt.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((i=>{i?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return q.or([()=>q.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class G0{constructor(t,e){this.persistence=t,this.pi=new Ao((i=>ei(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=mL(this,e)}static mi(t,e){return new G0(t,e)}Ei(){}di(t){return q.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((i=>e.next((r=>i+r))))}wr(t){let e=0;return this.pr(t,(i=>{e++})).next((()=>e))}pr(t,e){return q.forEach(this.pi,((i,r)=>this.br(t,i,r).next((s=>s?q.resolve():e(r)))))}removeTargets(t,e,i){return this.persistence.getTargetCache().removeTargets(t,e,i)}removeOrphanedDocuments(t,e){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(t,(o=>this.br(t,o,e).next((a=>{a||(i++,s.removeEntry(o,Mt.min()))})))).next((()=>s.apply(t))).next((()=>i))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),q.resolve()}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),q.resolve()}removeReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),q.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),q.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Up(t.data.value)),e}br(t,e,i){return q.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const r=this.pi.get(e);return q.resolve(r!==void 0&&r>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class JU{constructor(t){this.serializer=t}k(t,e,i,r){const s=new G_("createOrUpgrade",e);i<1&&r>=1&&((function(u){u.createObjectStore(Rg)})(t),(function(u){u.createObjectStore(Kf,{keyPath:uG}),u.createObjectStore(Ur,{keyPath:ER,autoIncrement:!0}).createIndex($l,wR,{unique:!0}),u.createObjectStore(dh)})(t),cP(t),(function(u){u.createObjectStore(Pl)})(t));let o=q.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(gh),u.deleteObjectStore(fh),u.deleteObjectStore(Hl)})(t),cP(t)),o=o.next((()=>(function(u){const h=u.store(Hl),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Mt.min().toTimestamp(),targetCount:0};return h.put(C0,d)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(Ur).J().next((g=>{u.deleteObjectStore(Ur),u.createObjectStore(Ur,{keyPath:ER,autoIncrement:!0}).createIndex($l,wR,{unique:!0});const m=h.store(Ur),v=g.map((y=>m.put(y)));return q.waitFor(v)}))})(t,s)))),o=o.next((()=>{(function(u){u.createObjectStore(mh,{keyPath:yG})})(t)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(qf)})(t),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(t,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(t)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(j_,{keyPath:vG})})(t),(function(u){u.createObjectStore(z_,{keyPath:EG})})(t)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(B_,{keyPath:RG});h.createIndex(VE,PG,{unique:!1}),h.createIndex(uk,CG,{unique:!1})})(t)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(P0,{keyPath:hG});h.createIndex(Fp,dG),h.createIndex(sk,fG)})(t))).next((()=>this.Ci(t,s))).next((()=>t.deleteObjectStore(Pl)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(t,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Mx,{keyPath:wG,autoIncrement:!0}).createIndex(OE,xG,{unique:!1}),u.createObjectStore(hf,{keyPath:TG}).createIndex(ak,SG,{unique:!1}),u.createObjectStore(df,{keyPath:IG}).createIndex(lk,AG,{unique:!1})})(t)))),i<16&&r>=16&&(o=o.next((()=>{e.objectStore(hf).clear()})).next((()=>{e.objectStore(df).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(bx,{keyPath:MG})})(t)}))),i<18&&r>=18&&O4()&&(o=o.next((()=>{e.objectStore(hf).clear()})).next((()=>{e.objectStore(df).clear()}))),o}wi(t){let e=0;return t.store(Pl).ee(((i,r)=>{e+=F0(r)})).next((()=>{const i={byteSize:e};return t.store(qf).put(NE,i)}))}yi(t){const e=t.store(Kf),i=t.store(Ur);return e.J().next((r=>q.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ql],[s.userId,s.lastAcknowledgedBatchId]);return i.J($l,o).next((a=>q.forEach(a,(u=>{Ct(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Nl(this.serializer,u);return hL(t,s.userId,h).next((()=>{}))}))))}))))}Si(t){const e=t.store(gh),i=t.store(Pl);return t.store(Hl).get(C0).next((r=>{const s=[];return i.ee(((o,a)=>{const u=new fe(o),h=(function(g){return[0,ei(g)]})(u);s.push(e.get(h).next((d=>d?q.resolve():(g=>e.put({targetId:0,path:ei(g),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>q.waitFor(s)))}))}bi(t,e){t.createObjectStore(Hf,{keyPath:_G});const i=e.store(Hf),r=new Wx,s=o=>{if(r.add(o)){const a=o.lastSegment(),u=o.popLast();return i.put({collectionId:a,parent:ei(u)})}};return e.store(Pl).ee({X:!0},((o,a)=>{const u=new fe(o);return s(u.popLast())})).next((()=>e.store(dh).ee({X:!0},(([o,a,u],h)=>{const d=Ts(a);return s(d.popLast())}))))}Di(t){const e=t.store(fh);return e.ee(((i,r)=>{const s=Zd(r),o=oL(this.serializer,s);return e.put(o)}))}Ci(t,e){const i=e.store(Pl),r=[];return i.ee(((s,o)=>{const a=e.store(P0),u=(function(g){return g.document?new pt(fe.fromString(g.document.name).popFirst(5)):g.noDocument?pt.fromSegments(g.noDocument.path):g.unknownDocument?pt.fromSegments(g.unknownDocument.path):Tt(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(h))})).next((()=>q.waitFor(r)))}Fi(t,e){const i=e.store(Ur),r=_L(this.serializer),s=new qx(J_.mi,this.serializer.yt);return i.J().next((o=>{const a=new Map;return o.forEach((u=>{let h=a.get(u.userId)??Yt();Nl(this.serializer,u).keys().forEach((d=>h=h.add(d))),a.set(u.userId,h)})),q.forEach(a,((u,h)=>{const d=new Vn(h),g=Z_.wt(this.serializer,d),m=s.getIndexManager(d),v=Q_.wt(d,this.serializer,m,s.referenceDelegate);return new yL(r,v,g,m).recalculateAndSaveOverlaysForDocumentKeys(new FE(e,wr.ce),u).next()}))}))}}function cP(n){n.createObjectStore(gh,{keyPath:mG}).createIndex(Cx,pG,{unique:!0}),n.createObjectStore(fh,{keyPath:"targetId"}).createIndex(ok,gG,{unique:!0}),n.createObjectStore(Hl)}const oa="IndexedDbPersistence",A1=18e5,R1=5e3,P1="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",tj="main";class Hx{constructor(t,e,i,r,s,o,a,u,h,d,g=18){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=i,this.Mi=s,this.window=o,this.document=a,this.xi=h,this.Oi=d,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Hx.v())throw new mt(tt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new jU(this,r),this.$i=e+tj,this.serializer=new sL(u),this.Ui=new Ca(this.$i,this.Ni,new JU(this.serializer)),this.hi=new CU,this.Pi=new VU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_L(this.serializer),this.Ii=new PU,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&ui(oa,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new mt(tt.FAILED_PRECONDITION,P1);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(t=>this.Pi.getHighestSequenceNumber(t)))})).then((t=>{this.ci=new wr(t,this.xi)})).then((()=>{this.li=!0})).catch((t=>(this.Ui&&this.Ui.close(),Promise.reject(t))))}Ji(t){return this.Qi=async e=>{if(this.started)return t(e)},t(this.isPrimary)}setDatabaseDeletedListener(t){this.Ui.$((async e=>{e.newVersion===null&&await t()}))}setNetworkEnabled(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(t=>wp(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(t).next((e=>{e||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(t))).next((e=>this.isPrimary&&!e?this.Zi(t).next((()=>!1)):!!e&&this.Xi(t).next((()=>!0)))))).catch((t=>{if(Wa(t))return ct(oa,"Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return ct(oa,"Releasing owner lease after error during lease refresh",t),!1})).then((t=>{this.isPrimary!==t&&this.Mi.enqueueRetryable((()=>this.Qi(t))),this.isPrimary=t}))}Hi(t){return Vd(t).get(_c).next((e=>q.resolve(this.es(e))))}ts(t){return wp(t).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,A1)){this.qi=Date.now();const t=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const i=_n(e,mh);return i.J().next((r=>{const s=this.ss(r,A1),o=r.filter((a=>s.indexOf(a)===-1));return q.forEach(o,(a=>i.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const e of t)this.Ki.removeItem(this._s(e.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(t){return!!t&&t.ownerId===this.clientId}Yi(t){return this.Oi?q.resolve(!0):Vd(t).get(_c).next((e=>{if(e!==null&&this.rs(e.leaseTimestampMs,R1)&&!this.us(e.ownerId)){if(this.es(e)&&this.networkEnabled)return!0;if(!this.es(e)){if(!e.allowTabSynchronization)throw new mt(tt.FAILED_PRECONDITION,P1);return!1}}return!(!this.networkEnabled||!this.inForeground)||wp(t).J().next((i=>this.ss(i,R1).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((e=>(this.isPrimary!==e&&ct(oa,`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Rg,mh],(t=>{const e=new FE(t,wr.ce);return this.Zi(e).next((()=>this.ts(e)))})),this.Ui.close(),this.Ps()}ss(t,e){return t.filter((i=>this.rs(i.updateTimeMs,e)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(t=>wp(t).J().next((e=>this.ss(e,A1).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(t,e){return Q_.wt(t,this.serializer,e,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new OU(t,this.serializer.yt.databaseId)}getDocumentOverlayCache(t){return Z_.wt(this.serializer,t)}getBundleCache(){return this.Ii}runTransaction(t,e,i){ct(oa,"Starting transaction:",t);const r=e==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?LG:u===17?fk:u===16?kG:u===15?kx:u===14?dk:u===13?hk:u===12?bG:u===11?ck:void Tt(60245)})(this.Ni);let o;return this.Ui.runTransaction(t,r,s,(a=>(o=new FE(a,this.ci?this.ci.next():wr.ce),e==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw ui(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new mt(tt.FAILED_PRECONDITION,ek);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(t){return Vd(t).get(_c).next((e=>{if(e!==null&&this.rs(e.leaseTimestampMs,R1)&&!this.us(e.ownerId)&&!this.es(e)&&!(this.Oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new mt(tt.FAILED_PRECONDITION,P1)}))}Xi(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vd(t).put(_c,e)}static v(){return Ca.v()}Zi(t){const e=Vd(t);return e.get(_c).next((i=>this.es(i)?(ct(oa,"Releasing primary lease."),e.delete(_c)):q.resolve()))}rs(t,e){const i=Date.now();return!(t<i-e)&&(!(t>i)||(ui(`Detected an update time that is in the future: ${t} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;N4()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(t){try{const e=this.Ki?.getItem(this._s(t))!==null;return ct(oa,`Client '${t}' ${e?"is":"is not"} zombied in LocalStorage`),e}catch(e){return ui(oa,"Failed to get zombied client id.",e),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(t){ui("Failed to set zombie client id.",t)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function Vd(n){return _n(n,Rg)}function wp(n){return _n(n,mh)}function ej(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}class Xx{constructor(t,e,i,r){this.targetId=t,this.fromCache=e,this.Es=i,this.ds=r}static As(t,e){let i=Yt(),r=Yt();for(const s of e.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Xx(t,e.fromCache,i,r)}}class nj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class vL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return N4()?8:ik(pn())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,i,r){const s={result:null};return this.ys(t,e).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(t,e,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new nj;return this.Ss(t,e,o).next((a=>{if(s.result=a,this.Vs)return this.bs(t,e,o,a.size)}))})).next((()=>s.result))}bs(t,e,i,r){return i.documentReadCount<this.fs?(Pc()<=Jt.DEBUG&&ct("QueryEngine","SDK will not create cache indexes for query:",Cc(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(Pc()<=Jt.DEBUG&&ct("QueryEngine","Query:",Cc(e),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Pc()<=Jt.DEBUG&&ct("QueryEngine","The SDK decides to create cache indexes for query:",Cc(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Sr(e))):q.resolve())}ys(t,e){if(DR(e))return q.resolve(null);let i=Sr(e);return this.indexManager.getIndexType(t,i).next((r=>r===0?null:(e.limit!==null&&r===1&&(e=WE(e,null,"F"),i=Sr(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next((s=>{const o=Yt(...s);return this.ps.getDocuments(t,o).next((a=>this.indexManager.getMinOffset(t,i).next((u=>{const h=this.Ds(e,a);return this.Cs(e,h,o,u.readTime)?this.ys(t,WE(e,null,"F")):this.vs(t,h,e,u)}))))})))))}ws(t,e,i,r){return DR(e)||r.isEqual(Mt.min())?q.resolve(null):this.ps.getDocuments(t,i).next((s=>{const o=this.Ds(e,s);return this.Cs(e,o,i,r)?q.resolve(null):(Pc()<=Jt.DEBUG&&ct("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Cc(e)),this.vs(t,o,e,nG(r,Bf)).next((a=>a)))}))}Ds(t,e){let i=new Se(Lk(t));return e.forEach(((r,s)=>{Mg(t,s)&&(i=i.add(s))})),i}Cs(t,e,i,r){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const s=t.limitType==="F"?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(t,e,i){return Pc()<=Jt.DEBUG&&ct("QueryEngine","Using full collection scan to execute query:",Cc(e)),this.ps.getDocumentsMatchingQuery(t,e,Yi.min(),i)}vs(t,e,i,r){return this.ps.getDocumentsMatchingQuery(t,i,r).next((s=>(e.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const Yx="LocalStore",ij=3e8;class rj{constructor(t,e,i,r){this.persistence=t,this.Fs=e,this.serializer=r,this.Ms=new Ge(zt),this.xs=new Ao((s=>cu(s)),Pg),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(i)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new yL(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function EL(n,t,e,i){return new rj(n,t,e,i)}async function wL(n,t){const e=Bt(n);return await e.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return e.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,e.Bs(t),e.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let u=Yt();for(const h of r){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of s){a.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return e.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function sj(n,t){const e=Bt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=t.batch.keys(),s=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,u,h,d){const g=h.batch,m=g.keys();let v=q.resolve();return m.forEach((y=>{v=v.next((()=>d.getEntry(u,y))).next((S=>{const w=h.docVersions.get(y);Ct(w!==null,48541),S.version.compareTo(w)<0&&(g.applyToRemoteDocument(S,h),S.isValidDocument()&&(S.setReadTime(h.commitVersion),d.addEntry(S)))}))})),v.next((()=>a.mutationQueue.removeMutationBatch(u,g)))})(e,i,t,s).next((()=>s.apply(i))).next((()=>e.mutationQueue.performConsistencyCheck(i))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let u=Yt();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(u=u.add(a.batch.mutations[h].key));return u})(t)))).next((()=>e.localDocuments.getDocuments(i,r)))}))}function xL(n){const t=Bt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function oj(n,t){const e=Bt(n),i=t.snapshotVersion;let r=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=e.Ns.newChangeBuffer({trackRemovals:!0});r=e.Ms;const a=[];t.targetChanges.forEach(((d,g)=>{const m=r.get(g);if(!m)return;a.push(e.Pi.removeMatchingKeys(s,d.removedDocuments,g).next((()=>e.Pi.addMatchingKeys(s,d.addedDocuments,g))));let v=m.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(g)!==null?v=v.withResumeToken(un.EMPTY_BYTE_STRING,Mt.min()).withLastLimboFreeSnapshotVersion(Mt.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,i)),r=r.insert(g,v),(function(S,w,R){return S.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=ij?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0})(m,v,d)&&a.push(e.Pi.updateTargetData(s,v))}));let u=Wi(),h=Yt();if(t.documentUpdates.forEach((d=>{t.resolvedLimboDocuments.has(d)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(s,d))})),a.push(aj(s,o,t.documentUpdates).next((d=>{u=d.ks,h=d.qs}))),!i.isEqual(Mt.min())){const d=e.Pi.getLastRemoteSnapshotVersion(s).next((g=>e.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(d)}return q.waitFor(a).next((()=>o.apply(s))).next((()=>e.localDocuments.getLocalViewOfDocuments(s,u,h))).next((()=>u))})).then((s=>(e.Ms=r,s)))}function aj(n,t,e){let i=Yt(),r=Yt();return e.forEach((s=>i=i.add(s))),t.getEntries(n,i).next((s=>{let o=Wi();return e.forEach(((a,u)=>{const h=s.get(a);u.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),u.isNoDocument()&&u.version.isEqual(Mt.min())?(t.removeEntry(a,u.readTime),o=o.insert(a,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(a,u)):ct(Yx,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",u.version)})),{ks:o,qs:r}}))}function lj(n,t){const e=Bt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(i=>(t===void 0&&(t=ql),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t))))}function uj(n,t){const e=Bt(n);return e.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return e.Pi.getTargetData(i,t).next((s=>s?(r=s,q.resolve(r)):e.Pi.allocateTargetId(i).next((o=>(r=new ao(t,o,"TargetPurposeListen",i.currentSequenceNumber),e.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=e.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(i.targetId,i),e.xs.set(t,i.targetId)),i}))}async function JE(n,t,e){const i=Bt(n),r=i.Ms.get(t),s=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Wa(o))throw o;ct(Yx,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ms=i.Ms.remove(t),i.xs.delete(r.target)}function hP(n,t,e){const i=Bt(n);let r=Mt.min(),s=Yt();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,d){const g=Bt(u),m=g.xs.get(d);return m!==void 0?q.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(i,o,Sr(t)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((u=>{s=u}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,t,e?r:Mt.min(),e?s:Yt()))).next((a=>(cj(i,HG(t),a),{documents:a,Qs:s})))))}function cj(n,t,e){let i=n.Os.get(t)||Mt.min();e.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.Os.set(t,i)}class dP{constructor(){this.activeTargetIds=tU()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class TL{constructor(){this.Mo=new dP,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,i){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new dP,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class hj{Oo(t){}shutdown(){}}const fP="ConnectivityMonitor";class gP{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ct(fP,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){ct(fP,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let xp=null;function tw(){return xp===null?xp=(function(){return 268435456+Math.round(2147483648*Math.random())})():xp++,"0x"+xp.toString(16)}const C1="RestConnection",dj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fj{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===M0?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(t,e,i,r,s){const o=tw(),a=this.zo(t,e.toUriEncodedString());ct(C1,`Sending RPC '${t}' ${o}:`,a,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(a),d=xu(h);return this.Jo(t,a,u,i,d).then((g=>(ct(C1,`Received RPC '${t}' ${o}: `,g),g)),(g=>{throw lu(C1,`RPC '${t}' ${o} failed with error: `,g,"url: ",a,"request:",i),g}))}Ho(t,e,i,r,s,o){return this.Go(t,e,i,r,s)}jo(t,e,i){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+bh})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((r,s)=>t[s]=r)),i&&i.headers.forEach(((r,s)=>t[s]=r))}zo(t,e){const i=dj[t];return`${this.Uo}/v1/${e}:${i}`}terminate(){}}class gj{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const Kn="WebChannelConnection";class mj extends fj{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,i,r,s){const o=tw();return new Promise(((a,u)=>{const h=new $4;h.setWithCredentials(!0),h.listenOnce(W4.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Np.NO_ERROR:const g=h.getResponseJson();ct(Kn,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(g)),a(g);break;case Np.TIMEOUT:ct(Kn,`RPC '${t}' ${o} timed out`),u(new mt(tt.DEADLINE_EXCEEDED,"Request time out"));break;case Np.HTTP_ERROR:const m=h.getStatus();if(ct(Kn,`RPC '${t}' ${o} failed with status:`,m,"response text:",h.getResponseText()),m>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v?.error;if(y&&y.status&&y.message){const S=(function(R){const P=R.toLowerCase().replace(/_/g,"-");return Object.values(tt).indexOf(P)>=0?P:tt.UNKNOWN})(y.status);u(new mt(S,y.message))}else u(new mt(tt.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new mt(tt.UNAVAILABLE,"Connection failed."));break;default:Tt(9055,{l_:t,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ct(Kn,`RPC '${t}' ${o} completed.`)}}));const d=JSON.stringify(r);ct(Kn,`RPC '${t}' ${o} sending request:`,r),h.send(e,"POST",d,i,15)}))}T_(t,e,i){const r=tw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=H4(),a=q4(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,e,i),u.encodeInitMessageHeaders=!0;const d=s.join("");ct(Kn,`Creating RPC '${t}' stream ${r}: ${d}`,u);const g=o.createWebChannel(d,u);this.I_(g);let m=!1,v=!1;const y=new gj({Yo:w=>{v?ct(Kn,`Not sending because RPC '${t}' stream ${r} is closed:`,w):(m||(ct(Kn,`Opening RPC '${t}' stream ${r} transport.`),g.open(),m=!0),ct(Kn,`RPC '${t}' stream ${r} sending:`,w),g.send(w))},Zo:()=>g.close()}),S=(w,R,P)=>{w.listen(R,(M=>{try{P(M)}catch(L){setTimeout((()=>{throw L}),0)}}))};return S(g,Hd.EventType.OPEN,(()=>{v||(ct(Kn,`RPC '${t}' stream ${r} transport opened.`),y.o_())})),S(g,Hd.EventType.CLOSE,(()=>{v||(v=!0,ct(Kn,`RPC '${t}' stream ${r} transport closed`),y.a_(),this.E_(g))})),S(g,Hd.EventType.ERROR,(w=>{v||(v=!0,lu(Kn,`RPC '${t}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new mt(tt.UNAVAILABLE,"The operation could not be completed")))})),S(g,Hd.EventType.MESSAGE,(w=>{if(!v){const R=w.data[0];Ct(!!R,16349);const P=R,M=P?.error||P[0]?.error;if(M){ct(Kn,`RPC '${t}' stream ${r} received error:`,M);const L=M.status;let D=(function(A){const k=an[A];if(k!==void 0)return Wk(k)})(L),j=M.message;D===void 0&&(D=tt.INTERNAL,j="Unknown error status: "+L+" with message "+M.message),v=!0,y.a_(new mt(D,j)),g.close()}else ct(Kn,`RPC '${t}' stream ${r} received:`,R),y.u_(R)}})),S(a,K4.STAT_EVENT,(w=>{w.stat===kE.PROXY?ct(Kn,`RPC '${t}' stream ${r} detected buffering proxy`):w.stat===kE.NOPROXY&&ct(Kn,`RPC '${t}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function pj(){return typeof window<"u"?window:null}function Wp(){return typeof document<"u"?document:null}function ty(n){return new _U(n,!0)}class SL{constructor(t,e,i=1e3,r=1.5,s=6e4){this.Mi=t,this.timerId=e,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,e-i);r>0&&ct("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const mP="PersistentStream";class IL{constructor(t,e,i,r,s,o,a,u){this.Mi=t,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new SL(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===tt.RESOURCE_EXHAUSTED?(ui(e.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===tt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===e&&this.G_(i,r)}),(i=>{t((()=>{const r=new mt(tt.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(t,e){const i=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return ct(mP,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(ct(mP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class _j extends IL{constructor(t,e,i,r,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,r,o),this.serializer=s}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=EU(this.serializer,t),i=(function(s){if(!("targetChange"in s))return Mt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Mt.min():o.readTime?di(o.readTime):Mt.min()})(t);return this.listener.H_(e,i)}Y_(t){const e={};e.database=HE(this.serializer),e.addTarget=(function(s,o){let a;const u=o.target;if(a=k0(u)?{documents:Jk(s,u)}:{query:tL(s,u).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Hk(s,o.resumeToken);const h=KE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Mt.min())>0){a.readTime=xh(s,o.snapshotVersion.toTimestamp());const h=KE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,t);const i=xU(this.serializer,t);i&&(e.labels=i),this.q_(e)}Z_(t){const e={};e.database=HE(this.serializer),e.removeTarget=t,this.q_(e)}}class yj extends IL{constructor(t,e,i,r,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return Ct(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,Ct(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){Ct(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=wU(t.writeResults,t.commitTime),i=di(t.commitTime);return this.listener.na(i,e)}ra(){const t={};t.database=HE(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((i=>N0(this.serializer,i)))};this.q_(e)}}class vj{}class Ej extends vj{constructor(t,e,i,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new mt(tt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(t,qE(e,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===tt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new mt(tt.UNKNOWN,s.toString())}))}Ho(t,e,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(t,qE(e,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===tt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new mt(tt.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class wj{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(e),this.aa=!1):ct("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const gu="RemoteStore";class xj{constructor(t,e,i,r,s){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Iu(this)&&(ct(gu,"Restarting streams for network reachability change."),await(async function(u){const h=Bt(u);h.Ea.add(4),await kg(h),h.Ra.set("Unknown"),h.Ea.delete(4),await ey(h)})(this))}))})),this.Ra=new wj(i,r)}}async function ey(n){if(Iu(n))for(const t of n.da)await t(!0)}async function kg(n){for(const t of n.da)await t(!1)}function AL(n,t){const e=Bt(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),tT(e)?Jx(e):Lh(e).O_()&&Qx(e,t))}function Zx(n,t){const e=Bt(n),i=Lh(e);e.Ia.delete(t),i.O_()&&RL(e,t),e.Ia.size===0&&(i.O_()?i.L_():Iu(e)&&e.Ra.set("Unknown"))}function Qx(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Mt.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Lh(n).Y_(t)}function RL(n,t){n.Va.Ue(t),Lh(n).Z_(t)}function Jx(n){n.Va=new fU({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),Lh(n).start(),n.Ra.ua()}function tT(n){return Iu(n)&&!Lh(n).x_()&&n.Ia.size>0}function Iu(n){return Bt(n).Ea.size===0}function PL(n){n.Va=void 0}async function Tj(n){n.Ra.set("Online")}async function Sj(n){n.Ia.forEach(((t,e)=>{Qx(n,t)}))}async function Ij(n,t){PL(n),tT(n)?(n.Ra.ha(t),Jx(n)):n.Ra.set("Unknown")}async function Aj(n,t,e){if(n.Ra.set("Online"),t instanceof qk&&t.state===2&&t.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))})(n,t)}catch(i){ct(gu,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await U0(n,i)}else if(t instanceof Bp?n.Va.Ze(t):t instanceof Kk?n.Va.st(t):n.Va.tt(t),!e.isEqual(Mt.min()))try{const i=await xL(n.localStore);e.compareTo(i)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(u.resumeToken,o))}})),a.targetMismatches.forEach(((u,h)=>{const d=s.Ia.get(u);if(!d)return;s.Ia.set(u,d.withResumeToken(un.EMPTY_BYTE_STRING,d.snapshotVersion)),RL(s,u);const g=new ao(d.target,u,h,d.sequenceNumber);Qx(s,g)})),s.remoteSyncer.applyRemoteEvent(a)})(n,e)}catch(i){ct(gu,"Failed to raise snapshot:",i),await U0(n,i)}}async function U0(n,t,e){if(!Wa(t))throw t;n.Ea.add(1),await kg(n),n.Ra.set("Offline"),e||(e=()=>xL(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ct(gu,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await ey(n)}))}function CL(n,t){return t().catch((e=>U0(n,e,t)))}async function Lg(n){const t=Bt(n),e=Fa(t);let i=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:ql;for(;Rj(t);)try{const r=await lj(t.localStore,i);if(r===null){t.Ta.length===0&&e.L_();break}i=r.batchId,Pj(t,r)}catch(r){await U0(t,r)}ML(t)&&bL(t)}function Rj(n){return Iu(n)&&n.Ta.length<10}function Pj(n,t){n.Ta.push(t);const e=Fa(n);e.O_()&&e.X_&&e.ea(t.mutations)}function ML(n){return Iu(n)&&!Fa(n).x_()&&n.Ta.length>0}function bL(n){Fa(n).start()}async function Cj(n){Fa(n).ra()}async function Mj(n){const t=Fa(n);for(const e of n.Ta)t.ea(e.mutations)}async function bj(n,t,e){const i=n.Ta.shift(),r=Ux.from(i,t,e);await CL(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Lg(n)}async function kj(n,t){t&&Fa(n).X_&&await(async function(i,r){if((function(o){return cU(o)&&o!==tt.ABORTED})(r.code)){const s=i.Ta.shift();Fa(i).B_(),await CL(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Lg(i)}})(n,t),ML(n)&&bL(n)}async function pP(n,t){const e=Bt(n);e.asyncQueue.verifyOperationInProgress(),ct(gu,"RemoteStore received new credentials");const i=Iu(e);e.Ea.add(3),await kg(e),i&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await ey(e)}async function Lj(n,t){const e=Bt(n);t?(e.Ea.delete(2),await ey(e)):t||(e.Ea.add(2),await kg(e),e.Ra.set("Unknown"))}function Lh(n){return n.ma||(n.ma=(function(e,i,r){const s=Bt(e);return s.sa(),new _j(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:Tj.bind(null,n),t_:Sj.bind(null,n),r_:Ij.bind(null,n),H_:Aj.bind(null,n)}),n.da.push((async t=>{t?(n.ma.B_(),tT(n)?Jx(n):n.Ra.set("Unknown")):(await n.ma.stop(),PL(n))}))),n.ma}function Fa(n){return n.fa||(n.fa=(function(e,i,r){const s=Bt(e);return s.sa(),new yj(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Cj.bind(null,n),r_:kj.bind(null,n),ta:Mj.bind(null,n),na:bj.bind(null,n)}),n.da.push((async t=>{t?(n.fa.B_(),await Lg(n)):(await n.fa.stop(),n.Ta.length>0&&(ct(gu,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class eT{constructor(t,e,i,r,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new go,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,r,s){const o=Date.now()+i,a=new eT(t,e,o,r,s);return a.start(i),a}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new mt(tt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function nT(n,t){if(ui("AsyncQueue",`${t}: ${n}`),Wa(n))return new mt(tt.UNAVAILABLE,`${t}: ${n}`);throw n}class Xc{static emptySet(t){return new Xc(t.comparator)}constructor(t){this.comparator=t?(e,i)=>t(e,i)||pt.comparator(e.key,i.key):(e,i)=>pt.comparator(e.key,i.key),this.keyedMap=Xd(),this.sortedSet=new Ge(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,i)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Xc)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const r=e.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new Xc;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}class _P{constructor(){this.ga=new Ge(pt.comparator)}track(t){const e=t.doc.key,i=this.ga.get(e);i?t.type!==0&&i.type===3?this.ga=this.ga.insert(e,t):t.type===3&&i.type!==1?this.ga=this.ga.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.ga=this.ga.remove(e):t.type===1&&i.type===2?this.ga=this.ga.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Tt(63341,{Rt:t,pa:i}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,i)=>{t.push(i)})),t}}class Th{constructor(t,e,i,r,s,o,a,u,h){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,i,r,s){const o=[];return e.forEach((a=>{o.push({type:0,doc:a})})),new Th(t,e,Xc.emptySet(e),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&K_(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==i[r].type||!e[r].doc.isEqual(i[r].doc))return!1;return!0}}class Dj{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class Nj{constructor(){this.queries=yP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,i){const r=Bt(e),s=r.queries;r.queries=yP(),s.forEach(((o,a)=>{for(const u of a.Sa)u.onError(i)}))})(this,new mt(tt.ABORTED,"Firestore shutting down"))}}function yP(){return new Ao((n=>kk(n)),K_)}async function Oj(n,t){const e=Bt(n);let i=3;const r=t.query;let s=e.queries.get(r);s?!s.ba()&&t.Da()&&(i=2):(s=new Dj,i=t.Da()?0:1);try{switch(i){case 0:s.wa=await e.onListen(r,!0);break;case 1:s.wa=await e.onListen(r,!1);break;case 2:await e.onFirstRemoteStoreListen(r)}}catch(o){const a=nT(o,`Initialization of query '${Cc(t.query)}' failed`);return void t.onError(a)}e.queries.set(r,s),s.Sa.push(t),t.va(e.onlineState),s.wa&&t.Fa(s.wa)&&iT(e)}async function Vj(n,t){const e=Bt(n),i=t.query;let r=3;const s=e.queries.get(i);if(s){const o=s.Sa.indexOf(t);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=t.Da()?0:1:!s.ba()&&t.Da()&&(r=2))}switch(r){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}}function Fj(n,t){const e=Bt(n);let i=!1;for(const r of t){const s=r.query,o=e.queries.get(s);if(o){for(const a of o.Sa)a.Fa(r)&&(i=!0);o.wa=r}}i&&iT(e)}function Gj(n,t,e){const i=Bt(n),r=i.queries.get(t);if(r)for(const s of r.Sa)s.onError(e);i.queries.delete(t)}function iT(n){n.Ca.forEach((t=>{t.next()}))}var ew,vP;(vP=ew||(ew={})).Ma="default",vP.Cache="cache";class Uj{constructor(t,e,i){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)r.type!==3&&i.push(r);t=new Th(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const i=e!=="Offline";return(!this.options.qa||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Th.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==ew.Cache}}class kL{constructor(t){this.key=t}}class LL{constructor(t){this.key=t}}class jj{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Yt(),this.mutatedKeys=Yt(),this.eu=Lk(t),this.tu=new Xc(this.eu)}get nu(){return this.Ya}ru(t,e){const i=e?e.iu:new _P,r=e?e.tu:this.tu;let s=e?e.mutatedKeys:this.mutatedKeys,o=r,a=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal(((d,g)=>{const m=r.get(d),v=Mg(this.query,g)?g:null,y=!!m&&this.mutatedKeys.has(m.key),S=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;m&&v?m.data.isEqual(v.data)?y!==S&&(i.track({type:3,doc:v}),w=!0):this.su(m,v)||(i.track({type:2,doc:v}),w=!0,(u&&this.eu(v,u)>0||h&&this.eu(v,h)<0)&&(a=!0)):!m&&v?(i.track({type:0,doc:v}),w=!0):m&&!v&&(i.track({type:1,doc:m}),w=!0,(u||h)&&(a=!0)),w&&(v?(o=o.add(v),s=S?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{tu:o,iu:i,Cs:a,mutatedKeys:s}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,r){const s=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort(((d,g)=>(function(v,y){const S=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tt(20277,{Rt:w})}};return S(v)-S(y)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(i),r=r??!1;const a=e&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,h=u!==this.Za;return this.Za=u,o.length!==0||h?{snapshot:new Th(this.query,t.tu,s,o,t.mutatedKeys,u===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new _P,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=Yt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const e=[];return t.forEach((i=>{this.Xa.has(i)||e.push(new LL(i))})),this.Xa.forEach((i=>{t.has(i)||e.push(new kL(i))})),e}cu(t){this.Ya=t.Qs,this.Xa=Yt();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Th.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const rT="SyncEngine";class zj{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class Bj{constructor(t){this.key=t,this.hu=!1}}class $j{constructor(t,e,i,r,s,o){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ao((a=>kk(a)),K_),this.Iu=new Map,this.Eu=new Set,this.du=new Ge(pt.comparator),this.Au=new Map,this.Ru=new Kx,this.Vu={},this.mu=new Map,this.fu=fu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Wj(n,t,e=!0){const i=GL(n);let r;const s=i.Tu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await DL(i,t,e,!0),r}async function Kj(n,t){const e=GL(n);await DL(e,t,!0,!1)}async function DL(n,t,e,i){const r=await uj(n.localStore,Sr(t)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,e);let a;return i&&(a=await qj(n,t,s,o==="current",r.resumeToken)),n.isPrimaryClient&&e&&AL(n.remoteStore,r),a}async function qj(n,t,e,i,r){n.pu=(g,m,v)=>(async function(S,w,R,P){let M=w.view.ru(R);M.Cs&&(M=await hP(S.localStore,w.query,!1).then((({documents:b})=>w.view.ru(b,M))));const L=P&&P.targetChanges.get(w.targetId),D=P&&P.targetMismatches.get(w.targetId)!=null,j=w.view.applyChanges(M,S.isPrimaryClient,L,D);return wP(S,w.targetId,j.au),j.snapshot})(n,g,m,v);const s=await hP(n.localStore,t,!0),o=new jj(t,s.Qs),a=o.ru(s.documents),u=bg.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,u);wP(n,e,h.au);const d=new zj(t,e,o);return n.Tu.set(t,d),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),h.snapshot}async function Hj(n,t,e){const i=Bt(n),r=i.Tu.get(t),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter((o=>!K_(o,t)))),void i.Tu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await JE(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),e&&Zx(i.remoteStore,r.targetId),nw(i,r.targetId)})).catch(Su)):(nw(i,r.targetId),await JE(i.localStore,r.targetId,!0))}async function Xj(n,t){const e=Bt(n),i=e.Tu.get(t),r=e.Iu.get(i.targetId);e.isPrimaryClient&&r.length===1&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),Zx(e.remoteStore,i.targetId))}async function Yj(n,t,e){const i=UL(n);try{const r=await(function(o,a){const u=Bt(o),h=xe.now(),d=a.reduce(((v,y)=>v.add(y.key)),Yt());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let y=Wi(),S=Yt();return u.Ns.getEntries(v,d).next((w=>{y=w,y.forEach(((R,P)=>{P.isValidDocument()||(S=S.add(R))}))})).next((()=>u.localDocuments.getOverlayedDocuments(v,y))).next((w=>{g=w;const R=[];for(const P of a){const M=lU(P,g.get(P.key).overlayedDocument);M!=null&&R.push(new Ro(P.key,M,Tk(M.value.mapValue),ci.exists(!0)))}return u.mutationQueue.addMutationBatch(v,h,R,a)})).next((w=>{m=w;const R=w.applyToLocalDocumentSet(g,S);return u.documentOverlayCache.saveOverlays(v,w.batchId,R)}))})).then((()=>({batchId:m.batchId,changes:Nk(g)})))})(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,u){let h=o.Vu[o.currentUser.toKey()];h||(h=new Ge(zt)),h=h.insert(a,u),o.Vu[o.currentUser.toKey()]=h})(i,r.batchId,e),await Dg(i,r.changes),await Lg(i.remoteStore)}catch(r){const s=nT(r,"Failed to persist write");e.reject(s)}}async function NL(n,t){const e=Bt(n);try{const i=await oj(e.localStore,t);t.targetChanges.forEach(((r,s)=>{const o=e.Au.get(s);o&&(Ct(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ct(o.hu,14607):r.removedDocuments.size>0&&(Ct(o.hu,42227),o.hu=!1))})),await Dg(e,i,t)}catch(i){await Su(i)}}function EP(n,t,e){const i=Bt(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const r=[];i.Tu.forEach(((s,o)=>{const a=o.view.va(t);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const u=Bt(o);u.onlineState=a;let h=!1;u.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(a)&&(h=!0)})),h&&iT(u)})(i.eventManager,t),r.length&&i.Pu.H_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Zj(n,t,e){const i=Bt(n);i.sharedClientState.updateQueryState(t,"rejected",e);const r=i.Au.get(t),s=r&&r.key;if(s){let o=new Ge(pt.comparator);o=o.insert(s,Xe.newNoDocument(s,Mt.min()));const a=Yt().add(s),u=new Y_(Mt.min(),new Map,new Ge(zt),o,a);await NL(i,u),i.du=i.du.remove(s),i.Au.delete(t),sT(i)}else await JE(i.localStore,t,!1).then((()=>nw(i,t,e))).catch(Su)}async function Qj(n,t){const e=Bt(n),i=t.batch.batchId;try{const r=await sj(e.localStore,t);VL(e,i,null),OL(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await Dg(e,r)}catch(r){await Su(r)}}async function Jj(n,t,e){const i=Bt(n);try{const r=await(function(o,a){const u=Bt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return u.mutationQueue.lookupMutationBatch(h,a).next((g=>(Ct(g!==null,37113),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,a))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>u.localDocuments.getDocuments(h,d)))}))})(i.localStore,t);VL(i,t,e),OL(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await Dg(i,r)}catch(r){await Su(r)}}function OL(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function VL(n,t,e){const i=Bt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(t);s&&(e?s.reject(e):s.resolve(),r=r.remove(t)),i.Vu[i.currentUser.toKey()]=r}}function nw(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.Iu.get(t))n.Tu.delete(i),e&&n.Pu.yu(i,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach((i=>{n.Ru.containsKey(i)||FL(n,i)}))}function FL(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(Zx(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),sT(n))}function wP(n,t,e){for(const i of e)i instanceof kL?(n.Ru.addReference(i.key,t),tz(n,i)):i instanceof LL?(ct(rT,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,t),n.Ru.containsKey(i.key)||FL(n,i.key)):Tt(19791,{wu:i})}function tz(n,t){const e=t.key,i=e.path.canonicalString();n.du.get(e)||n.Eu.has(i)||(ct(rT,"New document in limbo: "+e),n.Eu.add(i),sT(n))}function sT(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new pt(fe.fromString(t)),i=n.fu.next();n.Au.set(i,new Bj(e)),n.du=n.du.insert(e,i),AL(n.remoteStore,new ao(Sr(Vx(e.path)),i,"TargetPurposeLimboResolution",wr.ce))}}async function Dg(n,t,e){const i=Bt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,u)=>{o.push(i.pu(u,t,e).then((h=>{if((h||e)&&i.isPrimaryClient){const d=h?!h.fromCache:e?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(h){r.push(h);const d=Xx.As(u.targetId,h);s.push(d)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const d=Bt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>q.forEach(h,(m=>q.forEach(m.Es,(v=>d.persistence.referenceDelegate.addReference(g,m.targetId,v))).next((()=>q.forEach(m.ds,(v=>d.persistence.referenceDelegate.removeReference(g,m.targetId,v)))))))))}catch(g){if(!Wa(g))throw g;ct(Yx,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const v=d.Ms.get(m),y=v.snapshotVersion,S=v.withLastLimboFreeSnapshotVersion(y);d.Ms=d.Ms.insert(m,S)}}})(i.localStore,s))}async function ez(n,t){const e=Bt(n);if(!e.currentUser.isEqual(t)){ct(rT,"User change. New user:",t.toKey());const i=await wL(e.localStore,t);e.currentUser=t,(function(s,o){s.mu.forEach((a=>{a.forEach((u=>{u.reject(new mt(tt.CANCELLED,o))}))})),s.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await Dg(e,i.Ls)}}function nz(n,t){const e=Bt(n),i=e.Au.get(t);if(i&&i.hu)return Yt().add(i.key);{let r=Yt();const s=e.Iu.get(t);if(!s)return r;for(const o of s){const a=e.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function GL(n){const t=Bt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=NL.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=nz.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Zj.bind(null,t),t.Pu.H_=Fj.bind(null,t.eventManager),t.Pu.yu=Gj.bind(null,t.eventManager),t}function UL(n){const t=Bt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Qj.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Jj.bind(null,t),t}class eg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ty(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return EL(this.persistence,new vL,t.initialUser,this.serializer)}Cu(t){return new qx(J_.mi,this.serializer)}Du(t){return new TL}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eg.provider={build:()=>new eg};class iz extends eg{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){Ct(this.persistence.referenceDelegate instanceof G0,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new gL(i,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new qx((i=>G0.mi(i,e)),this.serializer)}}class rz extends eg{constructor(t,e,i){super(),this.xu=t,this.cacheSizeBytes=e,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(t){await super.initialize(t),await this.xu.initialize(this,t),await UL(this.xu.syncEngine),await Lg(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(t){return EL(this.persistence,new vL,t.initialUser,this.serializer)}Fu(t,e){const i=this.persistence.referenceDelegate.garbageCollector;return new gL(i,t.asyncQueue,e)}Mu(t,e){const i=new oG(e,this.persistence);return new sG(t.asyncQueue,i)}Cu(t){const e=ej(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new Hx(this.synchronizeTabs,e,t.clientId,i,t.asyncQueue,pj(),Wp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(t){return new TL}}class j0{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>EP(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=ez.bind(null,this.syncEngine),await Lj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Nj})()}createDatastore(t){const e=ty(t.databaseInfo.databaseId),i=(function(s){return new mj(s)})(t.databaseInfo);return(function(s,o,a,u){return new Ej(s,o,a,u)})(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return(function(i,r,s,o,a){return new xj(i,r,s,o,a)})(this.localStore,this.datastore,t.asyncQueue,(e=>EP(this.syncEngine,e,0)),(function(){return gP.v()?new gP:new hj})())}createSyncEngine(t,e){return(function(r,s,o,a,u,h,d){const g=new $j(r,s,o,a,u,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const i=Bt(e);ct(gu,"RemoteStore shutting down."),i.Ea.add(5),await kg(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}j0.provider={build:()=>new j0};class sz{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):ui("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const Ga="FirestoreClient";class oz{constructor(t,e,i,r,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=r,this.user=Vn.UNAUTHENTICATED,this.clientId=Ax.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{ct(Ga,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(ct(Ga,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new go;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=nT(e,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}async function M1(n,t){n.asyncQueue.verifyOperationInProgress(),ct(Ga,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await wL(t.localStore,r),i=r)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function xP(n,t){n.asyncQueue.verifyOperationInProgress();const e=await az(n);ct(Ga,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((i=>pP(t.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>pP(t.remoteStore,r))),n._onlineComponents=t}async function az(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ct(Ga,"Using user provided OfflineComponentProvider");try{await M1(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(r){return r.name==="FirebaseError"?r.code===tt.FAILED_PRECONDITION||r.code===tt.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(e))throw e;lu("Error using user provided cache. Falling back to memory cache: "+e),await M1(n,new eg)}}else ct(Ga,"Using default OfflineComponentProvider"),await M1(n,new iz(void 0));return n._offlineComponents}async function jL(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ct(Ga,"Using user provided OnlineComponentProvider"),await xP(n,n._uninitializedComponentsProvider._online)):(ct(Ga,"Using default OnlineComponentProvider"),await xP(n,new j0))),n._onlineComponents}function lz(n){return jL(n).then((t=>t.syncEngine))}async function uz(n){const t=await jL(n),e=t.eventManager;return e.onListen=Wj.bind(null,t.syncEngine),e.onUnlisten=Hj.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=Kj.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=Xj.bind(null,t.syncEngine),e}function cz(n,t,e={}){const i=new go;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,u,h){const d=new sz({next:m=>{d.Nu(),o.enqueueAndForget((()=>Vj(s,g))),m.fromCache&&u.source==="server"?h.reject(new mt(tt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new Uj(a,d,{includeMetadataChanges:!0,qa:!0});return Oj(s,g)})(await uz(n),n.asyncQueue,t,e,i))),i.promise}function zL(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const TP=new Map;const BL="firestore.googleapis.com",SP=!0;class IP{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new mt(tt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=BL,this.ssl=SP}else this.host=t.host,this.ssl=t.ssl??SP;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=cL;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<FU)throw new mt(tt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}eG("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zL(t.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new mt(tt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new mt(tt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new mt(tt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ny{constructor(t,e,i,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new IP({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new mt(tt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new mt(tt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new IP(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new W7;switch(i.type){case"firstParty":return new X7(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new mt(tt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const i=TP.get(e);i&&(ct("ComponentProvider","Removing Datastore"),TP.delete(e),i.terminate())})(this),Promise.resolve()}}function hz(n,t,e,i={}){n=Na(n,ny);const r=xu(t),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${t}:${e}`;r&&(Ex(`https://${a}`),wx("Firestore",!0)),s.host!==BL&&s.host!==a&&lu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:a,ssl:r,emulatorOptions:i};if(!su(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Vn.MOCK_USER;else{h=L4(i.mockUserToken,n._app?.options.projectId);const g=i.mockUserToken.sub||i.mockUserToken.user_id;if(!g)throw new mt(tt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Vn(g)}n._authCredentials=new K7(new Y4(h,d))}}class Dh{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Dh(this.firestore,t,this._query)}}class gn{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new gn(this.firestore,t,this._key)}toJSON(){return{type:gn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,i){if(Ag(e,gn._jsonSchema))return new gn(t,i||null,new pt(fe.fromString(e.referencePath)))}}gn._jsonSchemaVersion="firestore/documentReference/1.0",gn._jsonSchema={type:ln("string",gn._jsonSchemaVersion),referencePath:ln("string")};class Ma extends Dh{constructor(t,e,i){super(t,e,Vx(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new gn(this.firestore,null,new pt(t))}withConverter(t){return new Ma(this.firestore,t,this._path)}}function AP(n,t,...e){if(n=ni(n),Q4("collection","path",t),n instanceof ny){const i=fe.fromString(t,...e);return mR(i),new Ma(n,null,i)}{if(!(n instanceof gn||n instanceof Ma))throw new mt(tt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(fe.fromString(t,...e));return mR(i),new Ma(n.firestore,null,i)}}function iw(n,t,...e){if(n=ni(n),arguments.length===1&&(t=Ax.newId()),Q4("doc","path",t),n instanceof ny){const i=fe.fromString(t,...e);return gR(i),new gn(n,null,new pt(i))}{if(!(n instanceof gn||n instanceof Ma))throw new mt(tt.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(fe.fromString(t,...e));return gR(i),new gn(n.firestore,n instanceof Ma?n.converter:null,new pt(i))}}const RP="AsyncQueue";class PP{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new SL(this,"async_queue_retry"),this._c=()=>{const i=Wp();i&&ct(RP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=t;const e=Wp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Wp();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new go;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Wa(t))throw t;ct(RP,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((i=>{throw this.nc=i,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",CP(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=e,e}enqueueAfterDelay(t,e,i){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const r=eT.createAndSchedule(this,t,e,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Tt(47125,{Pc:CP(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,i)=>e.targetTimeMs-i.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function CP(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class Nh extends ny{constructor(t,e,i,r){super(t,e,i,r),this.type="firestore",this._queue=new PP,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new PP(t),this._firestoreClient=void 0,await t}}}function dz(n,t){const e=typeof n=="object"?n:Sx(),i=typeof n=="string"?n:M0,r=V_(e,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=M4("firestore");s&&hz(r,...s)}return r}function $L(n){if(n._terminated)throw new mt(tt.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||WL(n),n._firestoreClient}function WL(n){const t=n._freezeSettings(),e=(function(r,s,o,a){return new NG(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,zL(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new oz(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function fz(n,t){lu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();return gz(n,j0.provider,{build:i=>new rz(i,e.cacheSizeBytes,t?.forceOwnership)}),Promise.resolve()}function gz(n,t,e){if((n=Na(n,Nh))._firestoreClient||n._terminated)throw new mt(tt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new mt(tt.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:t,_offline:e},WL(n)}class _r{constructor(t){this._byteString=t}static fromBase64String(t){try{return new _r(un.fromBase64String(t))}catch(e){throw new mt(tt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new _r(un.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:_r._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Ag(t,_r._jsonSchema))return _r.fromBase64String(t.bytes)}}_r._jsonSchemaVersion="firestore/bytes/1.0",_r._jsonSchema={type:ln("string",_r._jsonSchemaVersion),bytes:ln("string")};class iy{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new mt(tt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class oT{constructor(t){this._methodName=t}}class As{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new mt(tt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new mt(tt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return zt(this._lat,t._lat)||zt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:As._jsonSchemaVersion}}static fromJSON(t){if(Ag(t,As._jsonSchema))return new As(t.latitude,t.longitude)}}As._jsonSchemaVersion="firestore/geoPoint/1.0",As._jsonSchema={type:ln("string",As._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};class Rs{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Rs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Ag(t,Rs._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Rs(t.vectorValues);throw new mt(tt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Rs._jsonSchemaVersion="firestore/vectorValue/1.0",Rs._jsonSchema={type:ln("string",Rs._jsonSchemaVersion),vectorValues:ln("object")};const mz=/^__.*__$/;class pz{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new Ro(t,this.data,this.fieldMask,e,this.fieldTransforms):new kh(t,this.data,e,this.fieldTransforms)}}class KL{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return new Ro(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function qL(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Tt(40011,{Ac:n})}}class aT{constructor(t,e,i,r,s,o){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new aT({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.gc(t),i}yc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.Rc(),i}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return z0(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(qL(this.Ac)&&mz.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class _z{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||ty(t)}Cc(t,e,i,r=!1){return new aT({Ac:t,methodName:e,Dc:i,path:Be.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lT(n){const t=n._freezeSettings(),e=ty(n._databaseId);return new _z(n._databaseId,!!t.ignoreUndefinedProperties,e)}function yz(n,t,e,i,r,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,t,e,r);uT("Data must be an object, but it was:",o,i);const a=HL(i,o);let u,h;if(s.merge)u=new Mi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const g of s.mergeFields){const m=rw(t,g,e);if(!o.contains(m))throw new mt(tt.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);YL(d,m)||d.push(m)}u=new Mi(d),h=o.fieldTransforms.filter((g=>u.covers(g.field)))}else u=null,h=o.fieldTransforms;return new pz(new Qn(a),u,h)}class ry extends oT{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ry}}function vz(n,t,e,i){const r=n.Cc(1,t,e);uT("Data must be an object, but it was:",r,i);const s=[],o=Qn.empty();Ka(i,((u,h)=>{const d=cT(t,u,e);h=ni(h);const g=r.yc(d);if(h instanceof ry)s.push(d);else{const m=Ng(h,g);m!=null&&(s.push(d),o.set(d,m))}}));const a=new Mi(s);return new KL(o,a,r.fieldTransforms)}function Ez(n,t,e,i,r,s){const o=n.Cc(1,t,e),a=[rw(t,i,e)],u=[r];if(s.length%2!=0)throw new mt(tt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(rw(t,s[m])),u.push(s[m+1]);const h=[],d=Qn.empty();for(let m=a.length-1;m>=0;--m)if(!YL(h,a[m])){const v=a[m];let y=u[m];y=ni(y);const S=o.yc(v);if(y instanceof ry)h.push(v);else{const w=Ng(y,S);w!=null&&(h.push(v),d.set(v,w))}}const g=new Mi(h);return new KL(d,g,o.fieldTransforms)}function wz(n,t,e,i=!1){return Ng(e,n.Cc(i?4:3,t))}function Ng(n,t){if(XL(n=ni(n)))return uT("Unsupported field value:",t,n),HL(n,t);if(n instanceof oT)return(function(i,r){if(!qL(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let u=Ng(a,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,t)}return(function(i,r){if((i=ni(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return eU(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=xe.fromDate(i);return{timestampValue:xh(r.serializer,s)}}if(i instanceof xe){const s=new xe(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:xh(r.serializer,s)}}if(i instanceof As)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof _r)return{bytesValue:Hk(r.serializer,i._byteString)};if(i instanceof gn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Bx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Rs)return(function(o,a){return{mapValue:{fields:{[Dx]:{stringValue:Nx},[ph]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return Fx(a.serializer,h)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${F_(i)}`)})(n,t)}function HL(n,t){const e={};return gk(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ka(n,((i,r)=>{const s=Ng(r,t.mc(i));s!=null&&(e[i]=s)})),{mapValue:{fields:e}}}function XL(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xe||n instanceof As||n instanceof _r||n instanceof gn||n instanceof oT||n instanceof Rs)}function uT(n,t,e){if(!XL(e)||!J4(e)){const i=F_(e);throw i==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+i)}}function rw(n,t,e){if((t=ni(t))instanceof iy)return t._internalPath;if(typeof t=="string")return cT(n,t);throw z0("Field path arguments must be of type string or ",n,!1,void 0,e)}const xz=new RegExp("[~\\*/\\[\\]]");function cT(n,t,e){if(t.search(xz)>=0)throw z0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new iy(...t.split("."))._internalPath}catch{throw z0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function z0(n,t,e,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${i}`),o&&(u+=` in document ${r}`),u+=")"),new mt(tt.INVALID_ARGUMENT,a+n+u)}function YL(n,t){return n.some((e=>e.isEqual(t)))}class ZL{constructor(t,e,i,r,s){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Tz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(hT("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class Tz extends ZL{data(){return super.data()}}function hT(n,t){return typeof t=="string"?cT(n,t):t instanceof iy?t._internalPath:t._delegate._internalPath}function Sz(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new mt(tt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dT{}class Iz extends dT{}function Az(n,t,...e){let i=[];t instanceof dT&&i.push(t),i=i.concat(e),(function(s){const o=s.filter((u=>u instanceof fT)).length,a=s.filter((u=>u instanceof sy)).length;if(o>1||o>0&&a>0)throw new mt(tt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class sy extends Iz{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new sy(t,e,i)}_apply(t){const e=this._parse(t);return QL(t._query,e),new Dh(t.firestore,t.converter,$E(t._query,e))}_parse(t){const e=lT(t.firestore);return(function(s,o,a,u,h,d,g){let m;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new mt(tt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){bP(g,d);const y=[];for(const S of g)y.push(MP(u,s,S));m={arrayValue:{values:y}}}else m=MP(u,s,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||bP(g,d),m=wz(a,o,g,d==="in"||d==="not-in");return te.create(h,d,m)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function Rz(n,t,e){const i=t,r=hT("where",n);return sy._create(r,i,e)}class fT extends dT{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new fT(t,e)}_parse(t){const e=this._queryConstraints.map((i=>i._parse(t))).filter((i=>i.getFilters().length>0));return e.length===1?e[0]:Te.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const u of a)QL(o,u),o=$E(o,u)})(t._query,e),new Dh(t.firestore,t.converter,$E(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function MP(n,t,e){if(typeof(e=ni(e))=="string"){if(e==="")throw new mt(tt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!bk(t)&&e.indexOf("/")!==-1)throw new mt(tt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(fe.fromString(e));if(!pt.isDocumentKey(i))throw new mt(tt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Zf(n,new pt(i))}if(e instanceof gn)return Zf(n,e._key);throw new mt(tt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${F_(e)}.`)}function bP(n,t){if(!Array.isArray(n)||n.length===0)throw new mt(tt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function QL(n,t){const e=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new mt(tt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new mt(tt.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class Pz{convertValue(t,e="none"){switch(Oa(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ve(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Eo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Tt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return Ka(t,((r,s)=>{i[r]=this.convertValue(s,e)})),i}convertVectorValue(t){const e=t.fields?.[ph].arrayValue?.values?.map((i=>Ve(i.doubleValue)));return new Rs(e)}convertGeoPoint(t){return new As(Ve(t.latitude),Ve(t.longitude))}convertArray(t,e){return(t.values||[]).map((i=>this.convertValue(i,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const i=$_(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Xf(t));default:return null}}convertTimestamp(t){const e=vo(t);return new xe(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=fe.fromString(t);Ct(rL(i),9688,{name:t});const r=new uu(i.get(1),i.get(3)),s=new pt(i.popFirst(5));return r.isEqual(e)||ui(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}function Cz(n,t,e){let i;return i=n?n.toFirestore(t):t,i}class Tp{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Yc extends ZL{constructor(t,e,i,r,s,o){super(t,e,i,r,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Kp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(hT("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new mt(tt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Yc._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Yc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Yc._jsonSchema={type:ln("string",Yc._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};class Kp extends Yc{data(t={}){return super.data(t)}}class Zc{constructor(t,e,i,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Tp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((i=>{t.call(e,new Kp(this._firestore,this._userDataWriter,i.key,i,new Tp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new mt(tt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const u=new Kp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Tp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const u=new Kp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Tp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:Mz(a.type),doc:u,oldIndex:h,newIndex:d}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new mt(tt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Zc._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Ax.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(e.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function Mz(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tt(61501,{type:n})}}Zc._jsonSchemaVersion="firestore/querySnapshot/1.0",Zc._jsonSchema={type:ln("string",Zc._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};class bz extends Pz{constructor(t){super(),this.firestore=t}convertBytes(t){return new _r(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new gn(this.firestore,null,e)}}function kz(n){n=Na(n,Dh);const t=Na(n.firestore,Nh),e=$L(t),i=new bz(t);return Sz(n._query),cz(e,n._query).then((r=>new Zc(t,i,n,r)))}function Lz(n,t,e,...i){n=Na(n,gn);const r=Na(n.firestore,Nh),s=lT(r);let o;return o=typeof(t=ni(t))=="string"||t instanceof iy?Ez(s,"updateDoc",n._key,t,e,i):vz(s,"updateDoc",n._key,t),gT(r,[o.toMutation(n._key,ci.exists(!0))])}function Dz(n){return gT(Na(n.firestore,Nh),[new X_(n._key,ci.none())])}function Nz(n,t){const e=Na(n.firestore,Nh),i=iw(n),r=Cz(n.converter,t);return gT(e,[yz(lT(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,ci.exists(!1))]).then((()=>i))}function gT(n,t){return(function(i,r){const s=new go;return i.asyncQueue.enqueueAndForget((async()=>Yj(await lz(i),r,s))),s.promise})($L(n),t)}(function(t,e=!0){(function(r){bh=r})(Tu),ou(new Da("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Nh(new q7(i.getProvider("auth-internal")),new Y7(o,i.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new mt(tt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new uu(h.options.projectId,d)})(o,r),o);return s={useFetchStreams:e,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),Is(cR,hR,t),Is(cR,hR,"esm2020")})();var Oz="firebase",Vz="12.7.0";Is(Oz,Vz,"app");function JL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Fz=JL,tD=new Sg("auth","Firebase",JL());const B0=new xx("@firebase/auth");function Gz(n,...t){B0.logLevel<=Jt.WARN&&B0.warn(`Auth (${Tu}): ${n}`,...t)}function qp(n,...t){B0.logLevel<=Jt.ERROR&&B0.error(`Auth (${Tu}): ${n}`,...t)}function wo(n,...t){throw mT(n,...t)}function Ps(n,...t){return mT(n,...t)}function eD(n,t,e){const i={...Fz(),[t]:e};return new Sg("auth","Firebase",i).create(t,{appName:n.name})}function Yl(n){return eD(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mT(n,...t){if(typeof n!="string"){const e=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(e,...i)}return tD.create(n,...t)}function Ut(n,t,...e){if(!n)throw mT(t,...e)}function lo(n){const t="INTERNAL ASSERTION FAILED: "+n;throw qp(t),new Error(t)}function xo(n,t){n||lo(t)}function sw(){return typeof self<"u"&&self.location?.href||""}function Uz(){return kP()==="http:"||kP()==="https:"}function kP(){return typeof self<"u"&&self.location?.protocol||null}function jz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Uz()||A9()||"connection"in navigator)?navigator.onLine:!0}function zz(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Og{constructor(t,e){this.shortDelay=t,this.longDelay=e,xo(e>t,"Short delay should be less than long delay!"),this.isMobile=S9()||R9()}get(){return jz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function pT(n,t){xo(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class nD{static initialize(t,e,i){this.fetchImpl=t,e&&(this.headersImpl=e),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;lo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;lo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;lo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Bz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const $z=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Wz=new Og(3e4,6e4);function _T(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Oh(n,t,e,i,r={}){return iD(n,r,async()=>{let s={},o={};i&&(t==="GET"?o=i:s={body:JSON.stringify(i)});const a=Ig({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:t,headers:u,...s};return I9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&xu(n.emulatorConfig.host)&&(h.credentials="include"),nD.fetch()(await rD(n,n.config.apiHost,e,a),h)})}async function iD(n,t,e){n._canInitEmulator=!1;const i={...Bz,...t};try{const r=new qz(n),s=await Promise.race([e(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Sp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[u,h]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sp(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Sp(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Sp(n,"user-disabled",o);const d=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw eD(n,d,h);wo(n,d)}}catch(r){if(r instanceof Os)throw r;wo(n,"network-request-failed",{message:String(r)})}}async function Kz(n,t,e,i,r={}){const s=await Oh(n,t,e,i,r);return"mfaPendingCredential"in s&&wo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function rD(n,t,e,i){const r=`${t}${e}?${i}`,s=n,o=s.config.emulator?pT(n.config,r):`${n.config.apiScheme}://${r}`;return $z.includes(e)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class qz{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,i)=>{this.timer=setTimeout(()=>i(Ps(this.auth,"network-request-failed")),Wz.get())})}}function Sp(n,t,e){const i={appName:n.name};e.email&&(i.email=e.email),e.phoneNumber&&(i.phoneNumber=e.phoneNumber);const r=Ps(n,t,i);return r.customData._tokenResponse=e,r}async function Hz(n,t){return Oh(n,"POST","/v1/accounts:delete",t)}async function $0(n,t){return Oh(n,"POST","/v1/accounts:lookup",t)}function _f(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function Xz(n,t=!1){const e=ni(n),i=await e.getIdToken(t),r=yT(i);Ut(r&&r.exp&&r.auth_time&&r.iat,e.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:_f(b1(r.auth_time)),issuedAtTime:_f(b1(r.iat)),expirationTime:_f(b1(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function b1(n){return Number(n)*1e3}function yT(n){const[t,e,i]=n.split(".");if(t===void 0||e===void 0||i===void 0)return qp("JWT malformed, contained fewer than 3 sections"),null;try{const r=R4(e);return r?JSON.parse(r):(qp("Failed to decode base64 JWT payload"),null)}catch(r){return qp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function LP(n){const t=yT(n);return Ut(t,"internal-error"),Ut(typeof t.exp<"u","internal-error"),Ut(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function ng(n,t,e=!1){if(e)return t;try{return await t}catch(i){throw i instanceof Os&&Yz(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Yz({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Zz{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ow{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=_f(this.lastLoginAt),this.creationTime=_f(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function W0(n){const t=n.auth,e=await n.getIdToken(),i=await ng(n,$0(t,{idToken:e}));Ut(i?.users.length,t,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?sD(r.providerUserInfo):[],o=Jz(n.providerData,s),a=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=a?u:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new ow(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function Qz(n){const t=ni(n);await W0(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function Jz(n,t){return[...n.filter(i=>!t.some(r=>r.providerId===i.providerId)),...t]}function sD(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function tB(n,t){const e=await iD(n,{},async()=>{const i=Ig({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await rD(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:i};return n.emulatorConfig&&xu(n.emulatorConfig.host)&&(u.credentials="include"),nD.fetch()(o,u)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function eB(n,t){return Oh(n,"POST","/v2/accounts:revokeToken",_T(n,t))}class Qc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Ut(t.idToken,"internal-error"),Ut(typeof t.idToken<"u","internal-error"),Ut(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):LP(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Ut(t.length!==0,"internal-error");const e=LP(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(Ut(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:i,refreshToken:r,expiresIn:s}=await tB(t,e);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(t,e,i){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,e){const{refreshToken:i,accessToken:r,expirationTime:s}=e,o=new Qc;return i&&(Ut(typeof i=="string","internal-error",{appName:t}),o.refreshToken=i),r&&(Ut(typeof r=="string","internal-error",{appName:t}),o.accessToken=r),s&&(Ut(typeof s=="number","internal-error",{appName:t}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Qc,this.toJSON())}_performRefresh(){return lo("not implemented")}}function aa(n,t){Ut(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class Wr{constructor({uid:t,auth:e,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new Zz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ow(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await ng(this,this.stsTokenManager.getToken(this.auth,t));return Ut(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return Xz(this,t)}reload(){return Qz(this)}_assign(t){this!==t&&(Ut(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Wr({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){Ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),e&&await W0(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($r(this.auth.app))return Promise.reject(Yl(this.auth));const t=await this.getIdToken();return await ng(this,Hz(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const i=e.displayName??void 0,r=e.email??void 0,s=e.phoneNumber??void 0,o=e.photoURL??void 0,a=e.tenantId??void 0,u=e._redirectEventId??void 0,h=e.createdAt??void 0,d=e.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:v,providerData:y,stsTokenManager:S}=e;Ut(g&&S,t,"internal-error");const w=Qc.fromJSON(this.name,S);Ut(typeof g=="string",t,"internal-error"),aa(i,t.name),aa(r,t.name),Ut(typeof m=="boolean",t,"internal-error"),Ut(typeof v=="boolean",t,"internal-error"),aa(s,t.name),aa(o,t.name),aa(a,t.name),aa(u,t.name),aa(h,t.name),aa(d,t.name);const R=new Wr({uid:g,auth:t,email:r,emailVerified:m,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:w,createdAt:h,lastLoginAt:d});return y&&Array.isArray(y)&&(R.providerData=y.map(P=>({...P}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(t,e,i=!1){const r=new Qc;r.updateFromServerResponse(e);const s=new Wr({uid:e.localId,auth:t,stsTokenManager:r,isAnonymous:i});return await W0(s),s}static async _fromGetAccountInfoResponse(t,e,i){const r=e.users[0];Ut(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?sD(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new Qc;a.updateFromIdToken(i);const u=new Wr({uid:r.localId,auth:t,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new ow(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const DP=new Map;function uo(n){xo(n instanceof Function,"Expected a class definition");let t=DP.get(n);return t?(xo(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,DP.set(n,t),t)}class oD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}oD.type="NONE";const NP=oD;function Hp(n,t,e){return`firebase:${n}:${t}:${e}`}class Jc{constructor(t,e,i){this.persistence=t,this.auth=e,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Hp(this.userKey,r.apiKey,s),this.fullPersistenceKey=Hp("persistence",r.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await $0(this.auth,{idToken:t}).catch(()=>{});return e?Wr._fromGetAccountInfoResponse(this.auth,e,t):null}return Wr._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,i="authUser"){if(!e.length)return new Jc(uo(NP),t,i);const r=(await Promise.all(e.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||uo(NP);const o=Hp(i,t.config.apiKey,t.name);let a=null;for(const h of e)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const m=await $0(t,{idToken:d}).catch(()=>{});if(!m)break;g=await Wr._fromGetAccountInfoResponse(t,m,d)}else g=Wr._fromJSON(t,d);h!==s&&(a=g),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Jc(s,t,i):(s=u[0],a&&await s._set(o,a.toJSON()),await Promise.all(e.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Jc(s,t,i))}}function OP(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(cD(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(aD(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(dD(t))return"Blackberry";if(fD(t))return"Webos";if(lD(t))return"Safari";if((t.includes("chrome/")||uD(t))&&!t.includes("edge/"))return"Chrome";if(hD(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(e);if(i?.length===2)return i[1]}return"Other"}function aD(n=pn()){return/firefox\//i.test(n)}function lD(n=pn()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function uD(n=pn()){return/crios\//i.test(n)}function cD(n=pn()){return/iemobile/i.test(n)}function hD(n=pn()){return/android/i.test(n)}function dD(n=pn()){return/blackberry/i.test(n)}function fD(n=pn()){return/webos/i.test(n)}function vT(n=pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nB(n=pn()){return vT(n)&&!!window.navigator?.standalone}function iB(){return P9()&&document.documentMode===10}function gD(n=pn()){return vT(n)||hD(n)||fD(n)||dD(n)||/windows phone/i.test(n)||cD(n)}function mD(n,t=[]){let e;switch(n){case"Browser":e=OP(pn());break;case"Worker":e=`${OP(pn())}-${n}`;break;default:e=n}const i=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Tu}/${i}`}class rB{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const i=s=>new Promise((o,a)=>{try{const u=t(s);o(u)}catch(u){a(u)}});i.onAbort=e,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const i of this.queue)await i(t),i.onAbort&&e.push(i.onAbort)}catch(i){e.reverse();for(const r of e)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function sB(n,t={}){return Oh(n,"GET","/v2/passwordPolicy",_T(n,t))}const oB=6;class aB{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??oB,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(e.meetsMinPasswordLength=t.length>=i),r&&(e.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let i;for(let r=0;r<t.length;r++)i=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(e,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,e,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}class lB{constructor(t,e,i,r){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new VP(this),this.idTokenSubscription=new VP(this),this.beforeStateQueue=new rB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=uo(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Jc.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await $0(this,{idToken:t}),i=await Wr._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if($r(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let i=e,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(t);(!s||s===o)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await W0(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=zz()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if($r(this.app))return Promise.reject(Yl(this));const e=t?ni(t):null;return e&&Ut(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Ut(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return $r(this.app)?Promise.reject(Yl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return $r(this.app)?Promise.reject(Yl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(uo(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await sB(this),e=new aB(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new Sg("auth","Firebase",t())}onAuthStateChanged(t,e,i){return this.registerStateListener(this.authStateSubscription,t,e,i)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,i){return this.registerStateListener(this.idTokenSubscription,t,e,i)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(i.tenantId=this.tenantId),await eB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const i=await this.getOrInitRedirectPersistenceManager(e);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&uo(t)||this._popupRedirectResolver;Ut(e,this,"argument-error"),this.redirectPersistenceManager=await Jc.create(this,[uo(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,i,r){if(this._deleted)return()=>{};const s=typeof e=="function"?e:e.next.bind(e);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ut(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof e=="function"){const u=t.addObserver(e,i,r);return()=>{o=!0,u()}}else{const u=t.addObserver(e);return()=>{o=!0,u()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=mD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&Gz(`Error while retrieving App Check token: ${t.error}`),t?.token}}function ET(n){return ni(n)}class VP{constructor(t){this.auth=t,this.observer=null,this.addObserver=D9(e=>this.observer=e)}get next(){return Ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let wT={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uB(n){wT=n}function cB(n){return wT.loadJS(n)}function hB(){return wT.gapiScript}function dB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function fB(n,t){const e=V_(n,"auth");if(e.isInitialized()){const r=e.getImmediate(),s=e.getOptions();if(su(s,t??{}))return r;wo(r,"already-initialized")}return e.initialize({options:t})}function gB(n,t){const e=t?.persistence||[],i=(Array.isArray(e)?e:[e]).map(uo);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(i,t?.popupRedirectResolver)}function mB(n,t,e){const i=ET(n);Ut(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!1,s=pD(t),{host:o,port:a}=pB(t),u=a===null?"":`:${a}`,h={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Ut(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ut(su(h,i.config.emulator)&&su(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,xu(o)?(Ex(`${s}//${o}${u}`),wx("Auth",!0)):_B()}function pD(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function pB(n){const t=pD(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const i=e[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:FP(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:FP(o)}}}function FP(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function _B(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class _D{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return lo("not implemented")}_getIdTokenResponse(t){return lo("not implemented")}_linkToIdToken(t,e){return lo("not implemented")}_getReauthenticationResolver(t){return lo("not implemented")}}async function th(n,t){return Kz(n,"POST","/v1/accounts:signInWithIdp",_T(n,t))}const yB="http://localhost";class mu extends _D{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new mu(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):wo("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:r,...s}=e;if(!i||!r)return null;const o=new mu(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return th(t,e)}_linkToIdToken(t,e){const i=this.buildRequest();return i.idToken=e,th(t,i)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,th(t,e)}buildRequest(){const t={requestUri:yB,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Ig(e)}return t}}class yD{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Vg extends yD{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class fa extends Vg{constructor(){super("facebook.com")}static credential(t){return mu._fromParams({providerId:fa.PROVIDER_ID,signInMethod:fa.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return fa.credentialFromTaggedObject(t)}static credentialFromError(t){return fa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return fa.credential(t.oauthAccessToken)}catch{return null}}}fa.FACEBOOK_SIGN_IN_METHOD="facebook.com";fa.PROVIDER_ID="facebook.com";class ga extends Vg{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return mu._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return ga.credentialFromTaggedObject(t)}static credentialFromError(t){return ga.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:i}=t;if(!e&&!i)return null;try{return ga.credential(e,i)}catch{return null}}}ga.GOOGLE_SIGN_IN_METHOD="google.com";ga.PROVIDER_ID="google.com";class ma extends Vg{constructor(){super("github.com")}static credential(t){return mu._fromParams({providerId:ma.PROVIDER_ID,signInMethod:ma.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ma.credentialFromTaggedObject(t)}static credentialFromError(t){return ma.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ma.credential(t.oauthAccessToken)}catch{return null}}}ma.GITHUB_SIGN_IN_METHOD="github.com";ma.PROVIDER_ID="github.com";class pa extends Vg{constructor(){super("twitter.com")}static credential(t,e){return mu._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return pa.credentialFromTaggedObject(t)}static credentialFromError(t){return pa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:i}=t;if(!e||!i)return null;try{return pa.credential(e,i)}catch{return null}}}pa.TWITTER_SIGN_IN_METHOD="twitter.com";pa.PROVIDER_ID="twitter.com";class Sh{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,i,r=!1){const s=await Wr._fromIdTokenResponse(t,i,r),o=GP(i);return new Sh({user:s,providerId:o,_tokenResponse:i,operationType:e})}static async _forOperation(t,e,i){await t._updateTokensIfNecessary(i,!0);const r=GP(i);return new Sh({user:t,providerId:r,_tokenResponse:i,operationType:e})}}function GP(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class K0 extends Os{constructor(t,e,i,r){super(e.code,e.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,K0.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,e,i,r){return new K0(t,e,i,r)}}function vD(n,t,e,i){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?K0._fromErrorAndOperation(n,s,t,i):s})}async function vB(n,t,e=!1){const i=await ng(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return Sh._forOperation(n,"link",i)}async function EB(n,t,e=!1){const{auth:i}=n;if($r(i.app))return Promise.reject(Yl(i));const r="reauthenticate";try{const s=await ng(n,vD(i,r,t,n),e);Ut(s.idToken,i,"internal-error");const o=yT(s.idToken);Ut(o,i,"internal-error");const{sub:a}=o;return Ut(n.uid===a,i,"user-mismatch"),Sh._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&wo(i,"user-mismatch"),s}}async function wB(n,t,e=!1){if($r(n.app))return Promise.reject(Yl(n));const i="signIn",r=await vD(n,i,t),s=await Sh._fromIdTokenResponse(n,i,r);return e||await n._updateCurrentUser(s.user),s}function xB(n,t,e,i){return ni(n).onIdTokenChanged(t,e,i)}function TB(n,t,e){return ni(n).beforeAuthStateChanged(t,e)}const q0="__sak";class ED{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(q0,"1"),this.storage.removeItem(q0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const SB=1e3,IB=10;class wD extends ED{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gD(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const i=this.storage.getItem(e),r=this.localCache[e];i!==r&&t(e,r,i)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const i=t.key;e?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!e&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);iB()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,IB):r()}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:i}),!0)})},SB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}wD.type="LOCAL";const AB=wD;class xD extends ED{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}xD.type="SESSION";const TD=xD;function RB(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class oy{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(r=>r.isListeningto(t));if(e)return e;const i=new oy(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:i,eventType:r,data:s}=e.data,o=this.handlersMap[r];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(e.origin,s)),u=await RB(a);e.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}oy.receivers=[];function xT(n="",t=10){let e="";for(let i=0;i<t;i++)e+=Math.floor(Math.random()*10);return n+e}class PB{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,u)=>{const h=xT("",20);r.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:h,data:e},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Cs(){return window}function CB(n){Cs().location.href=n}function SD(){return typeof Cs().WorkerGlobalScope<"u"&&typeof Cs().importScripts=="function"}async function MB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bB(){return navigator?.serviceWorker?.controller||null}function kB(){return SD()?self:null}const ID="firebaseLocalStorageDb",LB=1,H0="firebaseLocalStorage",AD="fbase_key";class Fg{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function ay(n,t){return n.transaction([H0],t?"readwrite":"readonly").objectStore(H0)}function DB(){const n=indexedDB.deleteDatabase(ID);return new Fg(n).toPromise()}function aw(){const n=indexedDB.open(ID,LB);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(H0,{keyPath:AD})}catch(r){e(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(H0)?t(i):(i.close(),await DB(),t(await aw()))})})}async function UP(n,t,e){const i=ay(n,!0).put({[AD]:t,value:e});return new Fg(i).toPromise()}async function NB(n,t){const e=ay(n,!1).get(t),i=await new Fg(e).toPromise();return i===void 0?null:i.value}function jP(n,t){const e=ay(n,!0).delete(t);return new Fg(e).toPromise()}const OB=800,VB=3;class RD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await aw(),this.db)}async _withRetries(t){let e=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(e++>VB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=oy._getInstance(kB()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await MB(),!this.activeServiceWorker)return;this.sender=new PB(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||bB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await aw();return await UP(t,q0,"1"),await jP(t,q0),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(i=>UP(i,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(i=>NB(i,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>jP(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(r=>{const s=ay(r,!1).getAll();return new Fg(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],i=new Set;if(t.length!==0)for(const{fbase_key:r,value:s}of t)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),e.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),e.push(r));return e}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),OB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}RD.type="LOCAL";const FB=RD;new Og(3e4,6e4);function GB(n,t){return t?uo(t):(Ut(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class TT extends _D{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return th(t,this._buildIdpRequest())}_linkToIdToken(t,e){return th(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return th(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function UB(n){return wB(n.auth,new TT(n),n.bypassAuthState)}function jB(n){const{auth:t,user:e}=n;return Ut(e,t,"internal-error"),EB(e,new TT(n),n.bypassAuthState)}async function zB(n){const{auth:t,user:e}=n;return Ut(e,t,"internal-error"),vB(e,new TT(n),n.bypassAuthState)}class PD{constructor(t,e,i,r,s=!1){this.auth=t,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=t;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:e,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(h){this.reject(h)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return UB;case"linkViaPopup":case"linkViaRedirect":return zB;case"reauthViaPopup":case"reauthViaRedirect":return jB;default:wo(this.auth,"internal-error")}}resolve(t){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const BB=new Og(2e3,1e4);class Nc extends PD{constructor(t,e,i,r,s){super(t,e,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Nc.currentPopupAction&&Nc.currentPopupAction.cancel(),Nc.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Ut(t,this.auth,"internal-error"),t}async onExecution(){xo(this.filter.length===1,"Popup operations only handle one event");const t=xT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Ps(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ps(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nc.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ps(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,BB.get())};t()}}Nc.currentPopupAction=null;const $B="pendingRedirect",Xp=new Map;class WB extends PD{constructor(t,e,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,i),this.eventId=null}async execute(){let t=Xp.get(this.auth._key());if(!t){try{const i=await KB(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(e){t=()=>Promise.reject(e)}Xp.set(this.auth._key(),t)}return this.bypassAuthState||Xp.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function KB(n,t){const e=XB(t),i=HB(n);if(!await i._isAvailable())return!1;const r=await i._get(e)==="true";return await i._remove(e),r}function qB(n,t){Xp.set(n._key(),t)}function HB(n){return uo(n._redirectPersistence)}function XB(n){return Hp($B,n.config.apiKey,n.name)}async function YB(n,t,e=!1){if($r(n.app))return Promise.reject(Yl(n));const i=ET(n),r=GB(i,t),o=await new WB(i,r,e).execute();return o&&!e&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}const ZB=600*1e3;class QB{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(e=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!JB(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!CD(t)){const i=t.error.code?.split("auth/")[1]||"internal-error";e.onError(Ps(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const i=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=ZB&&this.cachedEventUids.clear(),this.cachedEventUids.has(zP(t))}saveEventToCache(t){this.cachedEventUids.add(zP(t)),this.lastProcessedEventTime=Date.now()}}function zP(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function CD({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function JB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CD(n);default:return!1}}async function t$(n,t={}){return Oh(n,"GET","/v1/projects",t)}const e$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n$=/^https?/;async function i$(n){if(n.config.emulator)return;const{authorizedDomains:t}=await t$(n);for(const e of t)try{if(r$(e))return}catch{}wo(n,"unauthorized-domain")}function r$(n){const t=sw(),{protocol:e,hostname:i}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===i}if(!n$.test(e))return!1;if(e$.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const s$=new Og(3e4,6e4);function BP(){const n=Cs().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function o$(n){return new Promise((t,e)=>{function i(){BP(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{BP(),e(Ps(n,"network-request-failed"))},timeout:s$.get()})}if(Cs().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Cs().gapi?.load)i();else{const r=dB("iframefcb");return Cs()[r]=()=>{gapi.load?i():e(Ps(n,"network-request-failed"))},cB(`${hB()}?onload=${r}`).catch(s=>e(s))}}).catch(t=>{throw Yp=null,t})}let Yp=null;function a$(n){return Yp=Yp||o$(n),Yp}const l$=new Og(5e3,15e3),u$="__/auth/iframe",c$="emulator/auth/iframe",h$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f$(n){const t=n.config;Ut(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?pT(t,c$):`https://${n.config.authDomain}/${u$}`,i={apiKey:t.apiKey,appName:n.name,v:Tu},r=d$.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${e}?${Ig(i).slice(1)}`}async function g$(n){const t=await a$(n),e=Cs().gapi;return Ut(e,n,"internal-error"),t.open({where:document.body,url:f$(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h$,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Ps(n,"network-request-failed"),a=Cs().setTimeout(()=>{s(o)},l$.get());function u(){Cs().clearTimeout(a),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const m$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},p$=500,_$=600,y$="_blank",v$="http://localhost";class $P{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function E$(n,t,e,i=p$,r=_$){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const u={...m$,width:i.toString(),height:r.toString(),top:s,left:o},h=pn().toLowerCase();e&&(a=uD(h)?y$:e),aD(h)&&(t=t||v$,u.scrollbars="yes");const d=Object.entries(u).reduce((m,[v,y])=>`${m}${v}=${y},`,"");if(nB(h)&&a!=="_self")return w$(t||"",a),new $P(null);const g=window.open(t||"",a,d);Ut(g,n,"popup-blocked");try{g.focus()}catch{}return new $P(g)}function w$(n,t){const e=document.createElement("a");e.href=n,e.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(i)}const x$="__/auth/handler",T$="emulator/auth/handler",S$=encodeURIComponent("fac");async function WP(n,t,e,i,r,s){Ut(n.config.authDomain,n,"auth-domain-config-required"),Ut(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:i,v:Tu,eventId:r};if(t instanceof yD){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",L9(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(t instanceof Vg){const d=t.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const u=await n._getAppCheckToken(),h=u?`#${S$}=${encodeURIComponent(u)}`:"";return`${I$(n)}?${Ig(a).slice(1)}${h}`}function I$({config:n}){return n.emulator?pT(n,T$):`https://${n.authDomain}/${x$}`}const k1="webStorageSupport";class A${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=TD,this._completeRedirectFn=YB,this._overrideRedirectResult=qB}async _openPopup(t,e,i,r){xo(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const s=await WP(t,e,i,sw(),r);return E$(t,s,xT())}async _openRedirect(t,e,i,r){await this._originValidation(t);const s=await WP(t,e,i,sw(),r);return CB(s),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:r,promise:s}=this.eventManagers[e];return r?Promise.resolve(r):(xo(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(t);return this.eventManagers[e]={promise:i},i.catch(()=>{delete this.eventManagers[e]}),i}async initAndGetManager(t){const e=await g$(t),i=new QB(t);return e.register("authEvent",r=>(Ut(r?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=e,i}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(k1,{type:k1},r=>{const s=r?.[0]?.[k1];s!==void 0&&e(!!s),wo(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=i$(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return gD()||lD()||vT()}}const R$=A$;var KP="@firebase/auth",qP="1.12.0";class P${constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(i=>{t(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function C$(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function M$(n){ou(new Da("auth",(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Ut(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mD(n)},h=new lB(i,r,s,u);return gB(h,e),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,i)=>{t.getProvider("auth-internal").initialize()})),ou(new Da("auth-internal",t=>{const e=ET(t.getProvider("auth").getImmediate());return(i=>new P$(i))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Is(KP,qP,C$(n)),Is(KP,qP,"esm2020")}const b$=300,k$=k4("authIdTokenMaxAge")||b$;let HP=null;const L$=n=>async t=>{const e=t&&await t.getIdTokenResult(),i=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(i&&i>k$)return;const r=e?.token;HP!==r&&(HP=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function D$(n=Sx()){const t=V_(n,"auth");if(t.isInitialized())return t.getImmediate();const e=fB(n,{popupRedirectResolver:R$,persistence:[FB,AB,TD]}),i=k4("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=L$(s.toString());TB(e,o,()=>o(e.currentUser)),xB(e,a=>o(a))}}const r=C4("auth");return r&&mB(e,`http://${r}`),e}function N$(){return document.getElementsByTagName("head")?.[0]??document}uB({loadJS(n){return new Promise((t,e)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=t,i.onerror=r=>{const s=Ps("internal-error");s.customData=r,e(s)},i.type="text/javascript",i.charset="UTF-8",N$().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});M$("Browser");const MD="firebasestorage.googleapis.com",O$="storageBucket",V$=120*1e3,F$=600*1e3;class Vs extends Os{constructor(t,e,i=0){super(L1(t),`Firebase Storage: ${e} (${L1(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Vs.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return L1(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ls;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ls||(Ls={}));function L1(n){return"storage/"+n}function G$(){const n="An unknown error occurred, please check the error payload for server response.";return new Vs(Ls.UNKNOWN,n)}function U$(){return new Vs(Ls.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function j$(){return new Vs(Ls.CANCELED,"User canceled the upload/download.")}function z$(n){return new Vs(Ls.INVALID_URL,"Invalid URL '"+n+"'.")}function B$(n){return new Vs(Ls.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function XP(n){return new Vs(Ls.INVALID_ARGUMENT,n)}function bD(){return new Vs(Ls.APP_DELETED,"The Firebase app was deleted.")}function $$(n){return new Vs(Ls.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Kr{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let i;try{i=Kr.makeFromUrl(t,e)}catch{return new Kr(t,"")}if(i.path==="")return i;throw B$(t)}static makeFromUrl(t,e){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const d="v[A-Za-z0-9_]+",g=e.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${g}/${d}/b/${r}/o${m}`,"i"),y={bucket:1,path:3},S=e===MD?"(?:storage.googleapis.com|storage.cloud.google.com)":e,w="([^?#]*)",R=new RegExp(`^https?://${S}/${r}/${w}`,"i"),M=[{regex:a,indices:u,postModify:s},{regex:v,indices:y,postModify:h},{regex:R,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<M.length;L++){const D=M[L],j=D.regex.exec(t);if(j){const b=j[D.indices.bucket];let A=j[D.indices.path];A||(A=""),i=new Kr(b,A),D.postModify(i);break}}if(i==null)throw z$(t);return i}}class W${constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function K$(n,t,e){let i=1,r=null,s=null,o=!1,a=0;function u(){return a===2}let h=!1;function d(...w){h||(h=!0,t.apply(null,w))}function g(w){r=setTimeout(()=>{r=null,n(v,u())},w)}function m(){s&&clearTimeout(s)}function v(w,...R){if(h){m();return}if(w){m(),d.call(null,w,...R);return}if(u()||o){m(),d.call(null,w,...R);return}i<64&&(i*=2);let M;a===1?(a=2,M=0):M=(i+Math.random())*1e3,g(M)}let y=!1;function S(w){y||(y=!0,m(),!h&&(r!==null?(w||(a=2),clearTimeout(r),g(0)):w||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,S(!0)},e),S}function q$(n){n(!1)}function H$(n){return n!==void 0}function YP(n,t,e,i){if(i<t)throw XP(`Invalid value for '${n}'. Expected ${t} or greater.`);if(i>e)throw XP(`Invalid value for '${n}'. Expected ${e} or less.`)}function X$(n){const t=encodeURIComponent;let e="?";for(const i in n)if(n.hasOwnProperty(i)){const r=t(i)+"="+t(n[i]);e=e+r+"&"}return e=e.slice(0,-1),e}var X0;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(X0||(X0={}));function Y$(n,t){const e=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=t.indexOf(n)!==-1;return e||r||s}class Z${constructor(t,e,i,r,s,o,a,u,h,d,g,m=!0,v=!1){this.url_=t,this.method_=e,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,S)=>{this.resolve_=y,this.reject_=S,this.start_()})}start_(){const t=(i,r)=>{if(r){i(!1,new Ip(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const u=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===X0.NO_ERROR,u=s.getStatus();if(!a||Y$(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===X0.ABORT;i(!1,new Ip(!1,null,d));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new Ip(h,s))})},e=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());H$(u)?s(u):s()}catch(u){o(u)}else if(a!==null){const u=G$();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(r.canceled){const u=this.appDelete_?bD():j$();o(u)}else{const u=U$();o(u)}};this.canceled_?e(!1,new Ip(!1,null,!0)):this.backoffId_=K$(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&q$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ip{constructor(t,e,i){this.wasSuccessCode=t,this.connection=e,this.canceled=!!i}}function Q$(n,t){t!==null&&t.length>0&&(n.Authorization="Firebase "+t)}function J$(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function tW(n,t){t&&(n["X-Firebase-GMPID"]=t)}function eW(n,t){t!==null&&(n["X-Firebase-AppCheck"]=t)}function nW(n,t,e,i,r,s,o=!0,a=!1){const u=X$(n.urlParams),h=n.url+u,d=Object.assign({},n.headers);return tW(d,t),Q$(d,e),J$(d,s),eW(d,i),new Z$(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}function iW(n){if(n.length===0)return null;const t=n.lastIndexOf("/");return t===-1?"":n.slice(0,t)}function rW(n){const t=n.lastIndexOf("/",n.length-2);return t===-1?n:n.slice(t+1)}class Y0{constructor(t,e){this._service=t,e instanceof Kr?this._location=e:this._location=Kr.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Y0(t,e)}get root(){const t=new Kr(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rW(this._location.path)}get storage(){return this._service}get parent(){const t=iW(this._location.path);if(t===null)return null;const e=new Kr(this._location.bucket,t);return new Y0(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw $$(t)}}function ZP(n,t){const e=t?.[O$];return e==null?null:Kr.makeFromBucketSpec(e,n)}function sW(n,t,e,i={}){n.host=`${t}:${e}`;const r=xu(t);r&&(Ex(`https://${n.host}/b`),wx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:L4(s,n.app.options.projectId))}class oW{constructor(t,e,i,r,s,o=!1){this.app=t,this._authProvider=e,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=MD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=V$,this._maxUploadRetryTime=F$,this._requests=new Set,r!=null?this._bucket=Kr.makeFromBucketSpec(r,this._host):this._bucket=ZP(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Kr.makeFromBucketSpec(this._url,t):this._bucket=ZP(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){YP("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){YP("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Y0(this,t)}_makeRequest(t,e,i,r,s=!0){if(this._deleted)return new W$(bD());{const o=nW(t,this._appId,i,r,e,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,e){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,i,r).getPromise()}}const QP="@firebase/storage",JP="0.14.0";const kD="storage";function aW(n=Sx(),t){n=ni(n);const i=V_(n,kD).getImmediate({identifier:t}),r=M4("storage");return r&&lW(i,...r),i}function lW(n,t,e,i={}){sW(n,t,e,i)}function uW(n,{instanceIdentifier:t}){const e=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new oW(e,i,r,t,Tu)}function cW(){ou(new Da(kD,uW,"PUBLIC").setMultipleInstances(!0)),Is(QP,JP,""),Is(QP,JP,"esm2020")}cW();const hW={apiKey:"REPLACE_WITH_YOUR_API_KEY",authDomain:"your-project.firebaseapp.com",projectId:"your-project-id",storageBucket:"your-project.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef"},ST=U4(hW);D$(ST);const Qd=dz(ST);aW(ST);fz(Qd).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});Eu()(wu((n,t)=>({vondsten:[],loading:!1,error:null,loadVondsten:async e=>{n(i=>{i.loading=!0});try{const i=Az(AP(Qd,"vondsten"),Rz("userId","==",e)),s=(await kz(i)).docs.map(o=>({id:o.id,...o.data()}));n(o=>{o.vondsten=s,o.loading=!1})}catch(i){n(r=>{r.error=i.message,r.loading=!1})}},addVondst:async e=>{const i=new Date().toISOString(),r={...e,createdAt:i,updatedAt:i},s=await Nz(AP(Qd,"vondsten"),r);return n(o=>{o.vondsten.push({...r,id:s.id})}),s.id},updateVondst:async(e,i)=>{const r=iw(Qd,"vondsten",e);await Lz(r,{...i,updatedAt:new Date().toISOString()}),n(s=>{const o=s.vondsten.findIndex(a=>a.id===e);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...i})})},deleteVondst:async e=>{await Dz(iw(Qd,"vondsten",e)),n(i=>{i.vondsten=i.vondsten.filter(r=>r.id!==e)})}})));function dW({target:n,viewOptions:t}){const e=nt.useRef(null),i=Ki(r=>r.setMap);return nt.useEffect(()=>{if(!e.current){const r={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...t},s=new GF({target:n,view:new ws({center:tu(r.center),zoom:r.zoom,rotation:r.rotation,minZoom:r.minZoom,maxZoom:r.maxZoom})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,t,i]),e.current}const fW="https://router.project-osrm.org/route/v1/driving";function gW(n,t){const e={depart:"Start de route",arrive:"U bent aangekomen","turn-left":"Sla linksaf","turn-right":"Sla rechtsaf","turn-slight-left":"Houd links aan","turn-slight-right":"Houd rechts aan","turn-sharp-left":"Sla scherp linksaf","turn-sharp-right":"Sla scherp rechtsaf",uturn:"Keer om",straight:"Ga rechtdoor",merge:"Voeg in","on-ramp":"Neem de oprit","off-ramp":"Neem de afrit","fork-left":"Houd links aan bij de splitsing","fork-right":"Houd rechts aan bij de splitsing","end-of-road-left":"Sla linksaf aan het einde van de weg","end-of-road-right":"Sla rechtsaf aan het einde van de weg",roundabout:"Neem de rotonde",rotary:"Neem de rotonde",continue:"Blijf de weg volgen",notification:"Let op"},i=t?`${n}-${t}`:n;return e[i]||e[n]||"Volg de route"}function tC(n,t){const i=(t.lat-n.lat)*Math.PI/180,r=(t.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}const en=Eu()(wu((n,t)=>({isNavigating:!1,destination:null,destinationName:null,routeCoordinates:null,distance:null,duration:null,loading:!1,error:null,steps:[],currentStepIndex:0,voiceEnabled:!0,lastSpokenStep:-1,lastSpokenTime:0,lastSpokenDistance:-1,startNavigation:async(e,i,r)=>{n(s=>{s.loading=!0,s.error=null});try{const s=`${fW}/${r.lng},${r.lat};${e.lng},${e.lat}?overview=full&geometries=geojson&steps=true`,o=await fetch(s);if(!o.ok)throw new Error("Route berekening mislukt");const a=await o.json();if(a.code==="Ok"&&a.routes&&a.routes.length>0){const u=a.routes[0],h=u.geometry.coordinates.map(g=>({lng:g[0],lat:g[1]})),d=[];if(u.legs&&u.legs[0]&&u.legs[0].steps)for(const g of u.legs[0].steps){const m=g.maneuver?.type||"continue",v=g.maneuver?.modifier;d.push({instruction:gW(m,v),maneuver:v?`${m}-${v}`:m,distance:g.distance||0,duration:g.duration||0,location:{lng:g.maneuver?.location?.[0]||r.lng,lat:g.maneuver?.location?.[1]||r.lat}})}if(n(g=>{g.isNavigating=!0,g.destination=e,g.destinationName=i,g.routeCoordinates=h,g.distance=u.distance,g.duration=u.duration,g.steps=d,g.currentStepIndex=0,g.lastSpokenStep=-1,g.loading=!1}),d.length>0){const g=d[0],m=g.distance>1e3?`${(g.distance/1e3).toFixed(1)} kilometer`:`${Math.round(g.distance)} meter`;t().speakInstruction(`${g.instruction}. Over ${m}.`)}console.log(` Navigation started to ${i}`),console.log(` Distance: ${(u.distance/1e3).toFixed(1)} km`),console.log(` Duration: ${Math.round(u.duration/60)} min`),console.log(` Steps: ${d.length}`)}else throw new Error(a.message||"Geen route gevonden")}catch(s){console.error("Navigation error:",s),n(o=>{o.loading=!1,o.error=s.message||"Navigatie fout"})}},stopNavigation:()=>{"speechSynthesis"in window&&window.speechSynthesis.cancel(),n(e=>{e.isNavigating=!1,e.destination=null,e.destinationName=null,e.routeCoordinates=null,e.distance=null,e.duration=null,e.error=null,e.steps=[],e.currentStepIndex=0,e.lastSpokenStep=-1,e.lastSpokenTime=0,e.lastSpokenDistance=-1}),console.log(" Navigation stopped")},clearError:()=>{n(e=>{e.error=null})},updateCurrentStep:e=>{const{steps:i,currentStepIndex:r,lastSpokenStep:s,lastSpokenTime:o,lastSpokenDistance:a,voiceEnabled:u}=t();if(i.length===0)return;const h=Date.now(),d=5e3;let g=r;for(let m=r;m<i.length;m++){const v=i[m].location;tC(e,v)<30&&(g=Math.min(m+1,i.length-1))}if(g!==r&&(n(m=>{m.currentStepIndex=g}),u&&g!==s&&g<i.length&&h-o>d)){const m=i[g],v=m.distance>1e3?`${(m.distance/1e3).toFixed(1)} kilometer`:`${Math.round(m.distance)} meter`;t().speakInstruction(`${m.instruction}. Over ${v}.`),n(y=>{y.lastSpokenStep=g,y.lastSpokenTime=h,y.lastSpokenDistance=-1})}if(u&&r<i.length){const m=i[r],v=tC(e,m.location);if(h-o<d)return;const y=[200,100,50];for(const S of y)if(v<=S&&v>S-30&&(a===-1||Math.abs(a-S)>30)&&m.maneuver!=="depart"&&m.maneuver!=="arrive"){t().speakInstruction(`Over ${S} meter, ${m.instruction.toLowerCase()}.`),n(w=>{w.lastSpokenTime=h,w.lastSpokenDistance=S});break}}},setVoiceEnabled:e=>{n(i=>{i.voiceEnabled=e}),!e&&"speechSynthesis"in window&&window.speechSynthesis.cancel()},speakInstruction:e=>{if(t().voiceEnabled&&"speechSynthesis"in window){window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(e);i.lang="nl-NL",i.rate=1,i.pitch=1,i.volume=1;const s=window.speechSynthesis.getVoices().find(o=>o.lang.startsWith("nl"));s&&(i.voice=s),window.speechSynthesis.speak(i),console.log(` Speaking: ${e}`)}}})));function mW(){const n=nt.useRef(null);dW({target:"map"});const t=Ki(o=>o.map),e=oo(o=>o.registerLayer),i=en(o=>o.isNavigating);nt.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const o=new Ac({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new rF}),a=new Ac({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new qd({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),u=new Ac({properties:{title:"Google Hybride",type:"base"},visible:!1,source:new qd({url:"https://mt{0-3}.google.com/vt/lyrs=y&x={x}&y={y}&z={z}",attributions:" Google"})}),h=new Ac({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new qd({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),d=new Ac({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new qd({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(o),t.addLayer(a),t.addLayer(u),t.addLayer(h),t.addLayer(d),console.log(" Base layers added:",{osm:o.getVisible(),cartodb:a.getVisible(),satellite:u.getVisible()}),e("OpenStreetMap",o),e("CartoDB (licht)",a),e("Google Hybride",u),e("TMK 1850",h),e("Bonnebladen 1900",d),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),r()},[t,e]);async function r(){if(!t){console.error(" Cannot load layers: map is null");return}const o=f9();console.log(` Loading ${o.length} immediate-load layers (WMS/Tile)...`);const a=await Promise.allSettled(o.map(async h=>{try{const d=await h.factory();return d?{name:h.name,layer:d}:null}catch(d){return console.warn(` Failed to create ${h.name}:`,d),null}}));let u=0;a.forEach(h=>{if(h.status==="fulfilled"&&h.value){const{name:d,layer:g}=h.value;t.addLayer(g),e(d,g),u++,console.log(`   ${d}`)}}),console.log(` Immediate layers loaded: ${u}/${o.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}const s={width:"100%",height:"100vh",transition:"transform 0.5s ease-out",transformOrigin:"center bottom",...i?{transform:"perspective(1000px) rotateX(25deg) scale(1.1)"}:{}};return z.jsx("div",{id:"map",ref:n,style:s})}const IT=nt.createContext({});function AT(n){const t=nt.useRef(null);return t.current===null&&(t.current=n()),t.current}const ly=nt.createContext(null),RT=nt.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class pW extends nt.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=e.offsetHeight||0,i.width=e.offsetWidth||0,i.top=e.offsetTop,i.left=e.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function _W({children:n,isPresent:t}){const e=nt.useId(),i=nt.useRef(null),r=nt.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=nt.useContext(RT);return nt.useInsertionEffect(()=>{const{width:o,height:a,top:u,left:h}=r.current;if(t||!i.current||!o||!a)return;i.current.dataset.motionPopId=e;const d=document.createElement("style");return s&&(d.nonce=s),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${e}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),z.jsx(pW,{isPresent:t,childRef:i,sizeRef:r,children:nt.cloneElement(n,{ref:i})})}const yW=({children:n,initial:t,isPresent:e,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const a=AT(vW),u=nt.useId(),h=nt.useCallback(g=>{a.set(g,!0);for(const m of a.values())if(!m)return;i&&i()},[a,i]),d=nt.useMemo(()=>({id:u,initial:t,isPresent:e,custom:r,onExitComplete:h,register:g=>(a.set(g,!1),()=>a.delete(g))}),s?[Math.random(),h]:[e,h]);return nt.useMemo(()=>{a.forEach((g,m)=>a.set(m,!1))},[e]),nt.useEffect(()=>{!e&&!a.size&&i&&i()},[e]),o==="popLayout"&&(n=z.jsx(_W,{isPresent:e,children:n})),z.jsx(ly.Provider,{value:d,children:n})};function vW(){return new Map}function LD(n=!0){const t=nt.useContext(ly);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:i,register:r}=t,s=nt.useId();nt.useEffect(()=>{n&&r(s)},[n]);const o=nt.useCallback(()=>n&&i&&i(s),[s,i,n]);return!e&&i?[!1,o]:[!0]}const Ap=n=>n.key||"";function eC(n){const t=[];return nt.Children.forEach(n,e=>{nt.isValidElement(e)&&t.push(e)}),t}const PT=typeof window<"u",DD=PT?nt.useLayoutEffect:nt.useEffect,Au=({children:n,custom:t,initial:e=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[a,u]=LD(o),h=nt.useMemo(()=>eC(n),[n]),d=o&&!a?[]:h.map(Ap),g=nt.useRef(!0),m=nt.useRef(h),v=AT(()=>new Map),[y,S]=nt.useState(h),[w,R]=nt.useState(h);DD(()=>{g.current=!1,m.current=h;for(let L=0;L<w.length;L++){const D=Ap(w[L]);d.includes(D)?v.delete(D):v.get(D)!==!0&&v.set(D,!1)}},[w,d.length,d.join("-")]);const P=[];if(h!==y){let L=[...h];for(let D=0;D<w.length;D++){const j=w[D],b=Ap(j);d.includes(b)||(L.splice(D,0,j),P.push(j))}s==="wait"&&P.length&&(L=P),R(eC(L)),S(h);return}const{forceRender:M}=nt.useContext(IT);return z.jsx(z.Fragment,{children:w.map(L=>{const D=Ap(L),j=o&&!a?!1:h===w||d.includes(D),b=()=>{if(v.has(D))v.set(D,!0);else return;let A=!0;v.forEach(k=>{k||(A=!1)}),A&&(M?.(),R(m.current),o&&u?.(),i&&i())};return z.jsx(yW,{isPresent:j,initial:!g.current||e?void 0:!1,custom:j?void 0:t,presenceAffectsLayout:r,mode:s,onExitComplete:j?void 0:b,children:L},D)})})},qi=n=>n;let ND=qi;function CT(n){let t;return()=>(t===void 0&&(t=n()),t)}const Ih=(n,t,e)=>{const i=t-n;return i===0?1:(e-n)/i},mo=n=>n*1e3,po=n=>n/1e3,EW={useManualTiming:!1};function wW(n){let t=new Set,e=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,d=!1,g=!1)=>{const v=g&&i?t:e;return d&&s.add(h),v.has(h)||v.add(h),h},cancel:h=>{e.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[t,e]=[e,t],t.forEach(a),t.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Rp=["read","resolveKeyframes","update","preRender","render","postRender"],xW=40;function OD(n,t){let e=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>e=!0,o=Rp.reduce((R,P)=>(R[P]=wW(s),R),{}),{read:a,resolveKeyframes:u,update:h,preRender:d,render:g,postRender:m}=o,v=()=>{const R=performance.now();e=!1,r.delta=i?1e3/60:Math.max(Math.min(R-r.timestamp,xW),1),r.timestamp=R,r.isProcessing=!0,a.process(r),u.process(r),h.process(r),d.process(r),g.process(r),m.process(r),r.isProcessing=!1,e&&t&&(i=!1,n(v))},y=()=>{e=!0,i=!0,r.isProcessing||n(v)};return{schedule:Rp.reduce((R,P)=>{const M=o[P];return R[P]=(L,D=!1,j=!1)=>(e||y(),M.schedule(L,D,j)),R},{}),cancel:R=>{for(let P=0;P<Rp.length;P++)o[Rp[P]].cancel(R)},state:r,steps:o}}const{schedule:Le,cancel:Ua,state:On,steps:D1}=OD(typeof requestAnimationFrame<"u"?requestAnimationFrame:qi,!0),VD=nt.createContext({strict:!1}),nC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ah={};for(const n in nC)Ah[n]={isEnabled:t=>nC[n].some(e=>!!t[e])};function TW(n){for(const t in n)Ah[t]={...Ah[t],...n[t]}}const SW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Z0(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||SW.has(n)}let FD=n=>!Z0(n);function IW(n){n&&(FD=t=>t.startsWith("on")?!Z0(t):n(t))}try{IW(require("@emotion/is-prop-valid").default)}catch{}function AW(n,t,e){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(FD(r)||e===!0&&Z0(r)||!t&&!Z0(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function RW(n){if(typeof Proxy>"u")return n;const t=new Map,e=(...i)=>n(...i);return new Proxy(e,{get:(i,r)=>r==="create"?n:(t.has(r)||t.set(r,n(r)),t.get(r))})}const uy=nt.createContext({});function ig(n){return typeof n=="string"||Array.isArray(n)}function cy(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const MT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bT=["initial",...MT];function hy(n){return cy(n.animate)||bT.some(t=>ig(n[t]))}function GD(n){return!!(hy(n)||n.variants)}function PW(n,t){if(hy(n)){const{initial:e,animate:i}=n;return{initial:e===!1||ig(e)?e:void 0,animate:ig(i)?i:void 0}}return n.inherit!==!1?t:{}}function CW(n){const{initial:t,animate:e}=PW(n,nt.useContext(uy));return nt.useMemo(()=>({initial:t,animate:e}),[iC(t),iC(e)])}function iC(n){return Array.isArray(n)?n.join(" "):n}const MW=Symbol.for("motionComponentSymbol");function Oc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function bW(n,t,e){return nt.useCallback(i=>{i&&n.onMount&&n.onMount(i),t&&(i?t.mount(i):t.unmount()),e&&(typeof e=="function"?e(i):Oc(e)&&(e.current=i))},[t])}const kT=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),kW="framerAppearId",UD="data-"+kT(kW),{schedule:LT}=OD(queueMicrotask,!1),jD=nt.createContext({});function LW(n,t,e,i,r){var s,o;const{visualElement:a}=nt.useContext(uy),u=nt.useContext(VD),h=nt.useContext(ly),d=nt.useContext(RT).reducedMotion,g=nt.useRef(null);i=i||u.renderer,!g.current&&i&&(g.current=i(n,{visualState:t,parent:a,props:e,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:d}));const m=g.current,v=nt.useContext(jD);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&DW(g.current,e,r,v);const y=nt.useRef(!1);nt.useInsertionEffect(()=>{m&&y.current&&m.update(e,h)});const S=e[UD],w=nt.useRef(!!S&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,S))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,S)));return DD(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),LT.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),nt.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var R;(R=window.MotionHandoffMarkAsComplete)===null||R===void 0||R.call(window,S)}),w.current=!1))}),m}function DW(n,t,e,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:u,layoutRoot:h}=t;n.projection=new e(n.latestValues,t["data-framer-portal-id"]?void 0:zD(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Oc(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function zD(n){if(n)return n.options.allowProjection!==!1?n.projection:zD(n.parent)}function NW({preloadedFeatures:n,createVisualElement:t,useRender:e,useVisualState:i,Component:r}){var s,o;n&&TW(n);function a(h,d){let g;const m={...nt.useContext(RT),...h,layoutId:OW(h)},{isStatic:v}=m,y=CW(h),S=i(h,v);if(!v&&PT){VW();const w=FW(m);g=w.MeasureLayout,y.visualElement=LW(r,S,m,t,w.ProjectionNode)}return z.jsxs(uy.Provider,{value:y,children:[g&&y.visualElement?z.jsx(g,{visualElement:y.visualElement,...m}):null,e(r,h,bW(S,y.visualElement,d),S,v,y.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=nt.forwardRef(a);return u[MW]=r,u}function OW({layoutId:n}){const t=nt.useContext(IT).id;return t&&n!==void 0?t+"-"+n:n}function VW(n,t){nt.useContext(VD).strict}function FW(n){const{drag:t,layout:e}=Ah;if(!t&&!e)return{};const i={...t,...e};return{MeasureLayout:t?.isEnabled(n)||e?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const GW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function DT(n){return typeof n!="string"||n.includes("-")?!1:!!(GW.indexOf(n)>-1||/[A-Z]/u.test(n))}function rC(n){const t=[{},{}];return n?.values.forEach((e,i)=>{t[0][i]=e.get(),t[1][i]=e.getVelocity()}),t}function NT(n,t,e,i){if(typeof t=="function"){const[r,s]=rC(i);t=t(e!==void 0?e:n.custom,r,s)}if(typeof t=="string"&&(t=n.variants&&n.variants[t]),typeof t=="function"){const[r,s]=rC(i);t=t(e!==void 0?e:n.custom,r,s)}return t}const lw=n=>Array.isArray(n),UW=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),jW=n=>lw(n)?n[n.length-1]||0:n,ti=n=>!!(n&&n.getVelocity);function Zp(n){const t=ti(n)?n.get():n;return UW(t)?t.toValue():t}function zW({scrapeMotionValuesFromProps:n,createRenderState:t,onUpdate:e},i,r,s){const o={latestValues:BW(i,r,s,n),renderState:t()};return e&&(o.onMount=a=>e({props:i,current:a,...o}),o.onUpdate=a=>e(a)),o}const BD=n=>(t,e)=>{const i=nt.useContext(uy),r=nt.useContext(ly),s=()=>zW(n,t,i,r);return e?s():AT(s)};function BW(n,t,e,i){const r={},s=i(n,{});for(const m in s)r[m]=Zp(s[m]);let{initial:o,animate:a}=n;const u=hy(n),h=GD(n);t&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=t.initial),a===void 0&&(a=t.animate));let d=e?e.initial===!1:!1;d=d||o===!1;const g=d?a:o;if(g&&typeof g!="boolean"&&!cy(g)){const m=Array.isArray(g)?g:[g];for(let v=0;v<m.length;v++){const y=NT(n,m[v]);if(y){const{transitionEnd:S,transition:w,...R}=y;for(const P in R){let M=R[P];if(Array.isArray(M)){const L=d?M.length-1:0;M=M[L]}M!==null&&(r[P]=M)}for(const P in S)r[P]=S[P]}}}return r}const Vh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ru=new Set(Vh),$D=n=>t=>typeof t=="string"&&t.startsWith(n),WD=$D("--"),$W=$D("var(--"),OT=n=>$W(n)?WW.test(n.split("/*")[0].trim()):!1,WW=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,KD=(n,t)=>t&&typeof n=="number"?t.transform(n):n,To=(n,t,e)=>e>t?t:e<n?n:e,Fh={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},rg={...Fh,transform:n=>To(0,1,n)},Pp={...Fh,default:1},Gg=n=>({test:t=>typeof t=="string"&&t.endsWith(n)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${n}`}),ca=Gg("deg"),Ms=Gg("%"),Ot=Gg("px"),KW=Gg("vh"),qW=Gg("vw"),sC={...Ms,parse:n=>Ms.parse(n)/100,transform:n=>Ms.transform(n*100)},HW={borderWidth:Ot,borderTopWidth:Ot,borderRightWidth:Ot,borderBottomWidth:Ot,borderLeftWidth:Ot,borderRadius:Ot,radius:Ot,borderTopLeftRadius:Ot,borderTopRightRadius:Ot,borderBottomRightRadius:Ot,borderBottomLeftRadius:Ot,width:Ot,maxWidth:Ot,height:Ot,maxHeight:Ot,top:Ot,right:Ot,bottom:Ot,left:Ot,padding:Ot,paddingTop:Ot,paddingRight:Ot,paddingBottom:Ot,paddingLeft:Ot,margin:Ot,marginTop:Ot,marginRight:Ot,marginBottom:Ot,marginLeft:Ot,backgroundPositionX:Ot,backgroundPositionY:Ot},XW={rotate:ca,rotateX:ca,rotateY:ca,rotateZ:ca,scale:Pp,scaleX:Pp,scaleY:Pp,scaleZ:Pp,skew:ca,skewX:ca,skewY:ca,distance:Ot,translateX:Ot,translateY:Ot,translateZ:Ot,x:Ot,y:Ot,z:Ot,perspective:Ot,transformPerspective:Ot,opacity:rg,originX:sC,originY:sC,originZ:Ot},oC={...Fh,transform:Math.round},VT={...HW,...XW,zIndex:oC,size:Ot,fillOpacity:rg,strokeOpacity:rg,numOctaves:oC},YW={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ZW=Vh.length;function QW(n,t,e){let i="",r=!0;for(let s=0;s<ZW;s++){const o=Vh[s],a=n[o];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(o.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||e){const h=KD(a,VT[o]);if(!u){r=!1;const d=YW[o]||o;i+=`${d}(${h}) `}e&&(t[o]=h)}}return i=i.trim(),e?i=e(t,r?"":i):r&&(i="none"),i}function FT(n,t,e){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const u in t){const h=t[u];if(Ru.has(u)){o=!0;continue}else if(WD(u)){r[u]=h;continue}else{const d=KD(h,VT[u]);u.startsWith("origin")?(a=!0,s[u]=d):i[u]=d}}if(t.transform||(o||e?i.transform=QW(t,n.transform,e):i.transform&&(i.transform="none")),a){const{originX:u="50%",originY:h="50%",originZ:d=0}=s;i.transformOrigin=`${u} ${h} ${d}`}}const JW={offset:"stroke-dashoffset",array:"stroke-dasharray"},tK={offset:"strokeDashoffset",array:"strokeDasharray"};function eK(n,t,e=1,i=0,r=!0){n.pathLength=1;const s=r?JW:tK;n[s.offset]=Ot.transform(-i);const o=Ot.transform(t),a=Ot.transform(e);n[s.array]=`${o} ${a}`}function aC(n,t,e){return typeof n=="string"?n:Ot.transform(t+e*n)}function nK(n,t,e){const i=aC(t,n.x,n.width),r=aC(e,n.y,n.height);return`${i} ${r}`}function GT(n,{attrX:t,attrY:e,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:u=0,...h},d,g){if(FT(n,h,g),d){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:v,dimensions:y}=n;m.transform&&(y&&(v.transform=m.transform),delete m.transform),y&&(r!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=nK(y,r!==void 0?r:.5,s!==void 0?s:.5)),t!==void 0&&(m.x=t),e!==void 0&&(m.y=e),i!==void 0&&(m.scale=i),o!==void 0&&eK(m,o,a,u,!1)}const UT=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),qD=()=>({...UT(),attrs:{}}),jT=n=>typeof n=="string"&&n.toLowerCase()==="svg";function HD(n,{style:t,vars:e},i,r){Object.assign(n.style,t,r&&r.getProjectionStyles(i));for(const s in e)n.style.setProperty(s,e[s])}const XD=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function YD(n,t,e,i){HD(n,t,void 0,i);for(const r in t.attrs)n.setAttribute(XD.has(r)?r:kT(r),t.attrs[r])}const Q0={};function iK(n){Object.assign(Q0,n)}function ZD(n,{layout:t,layoutId:e}){return Ru.has(n)||n.startsWith("origin")||(t||e!==void 0)&&(!!Q0[n]||n==="opacity")}function zT(n,t,e){var i;const{style:r}=n,s={};for(const o in r)(ti(r[o])||t.style&&ti(t.style[o])||ZD(o,n)||((i=e?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function QD(n,t,e){const i=zT(n,t,e);for(const r in n)if(ti(n[r])||ti(t[r])){const s=Vh.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function rK(n,t){try{t.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const lC=["x","y","width","height","cx","cy","r"],sK={useVisualState:BD({scrapeMotionValuesFromProps:QD,createRenderState:qD,onUpdate:({props:n,prevProps:t,current:e,renderState:i,latestValues:r})=>{if(!e)return;let s=!!n.drag;if(!s){for(const a in r)if(Ru.has(a)){s=!0;break}}if(!s)return;let o=!t;if(t)for(let a=0;a<lC.length;a++){const u=lC[a];n[u]!==t[u]&&(o=!0)}o&&Le.read(()=>{rK(e,i),Le.render(()=>{GT(i,r,jT(e.tagName),n.transformTemplate),YD(e,i)})})}})},oK={useVisualState:BD({scrapeMotionValuesFromProps:zT,createRenderState:UT})};function JD(n,t,e){for(const i in t)!ti(t[i])&&!ZD(i,e)&&(n[i]=t[i])}function aK({transformTemplate:n},t){return nt.useMemo(()=>{const e=UT();return FT(e,t,n),Object.assign({},e.vars,e.style)},[t])}function lK(n,t){const e=n.style||{},i={};return JD(i,e,n),Object.assign(i,aK(n,t)),i}function uK(n,t){const e={},i=lK(n,t);return n.drag&&n.dragListener!==!1&&(e.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(e.tabIndex=0),e.style=i,e}function cK(n,t,e,i){const r=nt.useMemo(()=>{const s=qD();return GT(s,t,jT(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(n.style){const s={};JD(s,n.style,n),r.style={...s,...r.style}}return r}function hK(n=!1){return(e,i,r,{latestValues:s},o)=>{const u=(DT(e)?cK:uK)(i,s,o,e),h=AW(i,typeof e=="string",n),d=e!==nt.Fragment?{...h,...u,ref:r}:{},{children:g}=i,m=nt.useMemo(()=>ti(g)?g.get():g,[g]);return nt.createElement(e,{...d,children:m})}}function dK(n,t){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...DT(i)?sK:oK,preloadedFeatures:n,useRender:hK(r),createVisualElement:t,Component:i};return NW(o)}}function tN(n,t){if(!Array.isArray(t))return!1;const e=t.length;if(e!==n.length)return!1;for(let i=0;i<e;i++)if(t[i]!==n[i])return!1;return!0}function dy(n,t,e){const i=n.getProps();return NT(i,t,e!==void 0?e:i.custom,n)}const fK=CT(()=>window.ScrollTimeline!==void 0);class gK{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,e){for(let i=0;i<this.animations.length;i++)this.animations[i][t]=e}attachTimeline(t,e){const i=this.animations.map(r=>{if(fK()&&r.attachTimeline)return r.attachTimeline(t);if(typeof e=="function")return e(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let e=0;e<this.animations.length;e++)t=Math.max(t,this.animations[e].duration);return t}runAll(t){this.animations.forEach(e=>e[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class mK extends gK{then(t,e){return Promise.all(this.animations).then(t).catch(e)}}function BT(n,t){return n?n[t]||n.default||n:void 0}const uw=2e4;function eN(n){let t=0;const e=50;let i=n.next(t);for(;!i.done&&t<uw;)t+=e,i=n.next(t);return t>=uw?1/0:t}function $T(n){return typeof n=="function"}function uC(n,t){n.timeline=t,n.onfinish=null}const WT=n=>Array.isArray(n)&&typeof n[0]=="number",pK={linearEasing:void 0};function _K(n,t){const e=CT(n);return()=>{var i;return(i=pK[t])!==null&&i!==void 0?i:e()}}const J0=_K(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nN=(n,t,e=10)=>{let i="";const r=Math.max(Math.round(t/e),2);for(let s=0;s<r;s++)i+=n(Ih(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function iN(n){return!!(typeof n=="function"&&J0()||!n||typeof n=="string"&&(n in cw||J0())||WT(n)||Array.isArray(n)&&n.every(iN))}const Jd=([n,t,e,i])=>`cubic-bezier(${n}, ${t}, ${e}, ${i})`,cw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Jd([0,.65,.55,1]),circOut:Jd([.55,0,1,.45]),backIn:Jd([.31,.01,.66,-.59]),backOut:Jd([.33,1.53,.69,.99])};function rN(n,t){if(n)return typeof n=="function"&&J0()?nN(n,t):WT(n)?Jd(n):Array.isArray(n)?n.map(e=>rN(e,t)||cw.easeOut):cw[n]}const Fr={x:!1,y:!1};function sN(){return Fr.x||Fr.y}function yK(n,t,e){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function oN(n,t){const e=yK(n),i=new AbortController,r={passive:!0,...t,signal:i.signal};return[e,r,()=>i.abort()]}function cC(n){return t=>{t.pointerType==="touch"||sN()||n(t)}}function vK(n,t,e={}){const[i,r,s]=oN(n,e),o=cC(a=>{const{target:u}=a,h=t(a);if(typeof h!="function"||!u)return;const d=cC(g=>{h(g),u.removeEventListener("pointerleave",d)});u.addEventListener("pointerleave",d,r)});return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const aN=(n,t)=>t?n===t?!0:aN(n,t.parentElement):!1,KT=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,EK=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function wK(n){return EK.has(n.tagName)||n.tabIndex!==-1}const tf=new WeakSet;function hC(n){return t=>{t.key==="Enter"&&n(t)}}function N1(n,t){n.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const xK=(n,t)=>{const e=n.currentTarget;if(!e)return;const i=hC(()=>{if(tf.has(e))return;N1(e,"down");const r=hC(()=>{N1(e,"up")}),s=()=>N1(e,"cancel");e.addEventListener("keyup",r,t),e.addEventListener("blur",s,t)});e.addEventListener("keydown",i,t),e.addEventListener("blur",()=>e.removeEventListener("keydown",i),t)};function dC(n){return KT(n)&&!sN()}function TK(n,t,e={}){const[i,r,s]=oN(n,e),o=a=>{const u=a.currentTarget;if(!dC(a)||tf.has(u))return;tf.add(u);const h=t(a),d=(v,y)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!dC(v)||!tf.has(u))&&(tf.delete(u),typeof h=="function"&&h(v,{success:y}))},g=v=>{d(v,e.useGlobalTarget||aN(u,v.target))},m=v=>{d(v,!1)};window.addEventListener("pointerup",g,r),window.addEventListener("pointercancel",m,r)};return i.forEach(a=>{!wK(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(e.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",h=>xK(h,r),r)}),s}function SK(n){return n==="x"||n==="y"?Fr[n]?null:(Fr[n]=!0,()=>{Fr[n]=!1}):Fr.x||Fr.y?null:(Fr.x=Fr.y=!0,()=>{Fr.x=Fr.y=!1})}const lN=new Set(["width","height","top","left","right","bottom",...Vh]);let Qp;function IK(){Qp=void 0}const bs={now:()=>(Qp===void 0&&bs.set(On.isProcessing||EW.useManualTiming?On.timestamp:performance.now()),Qp),set:n=>{Qp=n,queueMicrotask(IK)}};function qT(n,t){n.indexOf(t)===-1&&n.push(t)}function HT(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}class XT{constructor(){this.subscriptions=[]}add(t){return qT(this.subscriptions,t),()=>HT(this.subscriptions,t)}notify(t,e,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,e,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(t,e,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function uN(n,t){return t?n*(1e3/t):0}const fC=30,AK=n=>!isNaN(parseFloat(n));class RK{constructor(t,e={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=bs.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=bs.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=AK(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new XT);const i=this.events[t].add(e);return t==="change"?()=>{i(),Le.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t,e=!0){!e||!this.passiveEffect?this.updateAndNotify(t,e):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,e,i){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=bs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>fC)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,fC);return uN(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function sg(n,t){return new RK(n,t)}function PK(n,t,e){n.hasValue(t)?n.getValue(t).set(e):n.addValue(t,sg(e))}function CK(n,t){const e=dy(n,t);let{transitionEnd:i={},transition:r={},...s}=e||{};s={...s,...i};for(const o in s){const a=jW(s[o]);PK(n,o,a)}}function MK(n){return!!(ti(n)&&n.add)}function hw(n,t){const e=n.getValue("willChange");if(MK(e))return e.add(t)}function cN(n){return n.props[UD]}const hN=(n,t,e)=>(((1-3*e+3*t)*n+(3*e-6*t))*n+3*t)*n,bK=1e-7,kK=12;function LK(n,t,e,i,r){let s,o,a=0;do o=t+(e-t)/2,s=hN(o,i,r)-n,s>0?e=o:t=o;while(Math.abs(s)>bK&&++a<kK);return o}function Ug(n,t,e,i){if(n===t&&e===i)return qi;const r=s=>LK(s,0,1,n,e);return s=>s===0||s===1?s:hN(r(s),t,i)}const dN=n=>t=>t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2,fN=n=>t=>1-n(1-t),gN=Ug(.33,1.53,.69,.99),YT=fN(gN),mN=dN(YT),pN=n=>(n*=2)<1?.5*YT(n):.5*(2-Math.pow(2,-10*(n-1))),ZT=n=>1-Math.sin(Math.acos(n)),_N=fN(ZT),yN=dN(ZT),vN=n=>/^0[^.\s]+$/u.test(n);function DK(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||vN(n):!0}const yf=n=>Math.round(n*1e5)/1e5,QT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function NK(n){return n==null}const OK=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,JT=(n,t)=>e=>!!(typeof e=="string"&&OK.test(e)&&e.startsWith(n)||t&&!NK(e)&&Object.prototype.hasOwnProperty.call(e,t)),EN=(n,t,e)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(QT);return{[n]:parseFloat(r),[t]:parseFloat(s),[e]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},VK=n=>To(0,255,n),O1={...Fh,transform:n=>Math.round(VK(n))},Wl={test:JT("rgb","red"),parse:EN("red","green","blue"),transform:({red:n,green:t,blue:e,alpha:i=1})=>"rgba("+O1.transform(n)+", "+O1.transform(t)+", "+O1.transform(e)+", "+yf(rg.transform(i))+")"};function FK(n){let t="",e="",i="",r="";return n.length>5?(t=n.substring(1,3),e=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(t=n.substring(1,2),e=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),t+=t,e+=e,i+=i,r+=r),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const dw={test:JT("#"),parse:FK,transform:Wl.transform},Vc={test:JT("hsl","hue"),parse:EN("hue","saturation","lightness"),transform:({hue:n,saturation:t,lightness:e,alpha:i=1})=>"hsla("+Math.round(n)+", "+Ms.transform(yf(t))+", "+Ms.transform(yf(e))+", "+yf(rg.transform(i))+")"},Hn={test:n=>Wl.test(n)||dw.test(n)||Vc.test(n),parse:n=>Wl.test(n)?Wl.parse(n):Vc.test(n)?Vc.parse(n):dw.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Wl.transform(n):Vc.transform(n)},GK=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function UK(n){var t,e;return isNaN(n)&&typeof n=="string"&&(((t=n.match(QT))===null||t===void 0?void 0:t.length)||0)+(((e=n.match(GK))===null||e===void 0?void 0:e.length)||0)>0}const wN="number",xN="color",jK="var",zK="var(",gC="${}",BK=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function og(n){const t=n.toString(),e=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=t.replace(BK,u=>(Hn.test(u)?(i.color.push(s),r.push(xN),e.push(Hn.parse(u))):u.startsWith(zK)?(i.var.push(s),r.push(jK),e.push(u)):(i.number.push(s),r.push(wN),e.push(parseFloat(u))),++s,gC)).split(gC);return{values:e,split:a,indexes:i,types:r}}function TN(n){return og(n).values}function SN(n){const{split:t,types:e}=og(n),i=t.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=t[o],r[o]!==void 0){const a=e[o];a===wN?s+=yf(r[o]):a===xN?s+=Hn.transform(r[o]):s+=r[o]}return s}}const $K=n=>typeof n=="number"?0:n;function WK(n){const t=TN(n);return SN(n)(t.map($K))}const ja={test:UK,parse:TN,createTransformer:SN,getAnimatableNone:WK},KK=new Set(["brightness","contrast","saturate","opacity"]);function qK(n){const[t,e]=n.slice(0,-1).split("(");if(t==="drop-shadow")return n;const[i]=e.match(QT)||[];if(!i)return n;const r=e.replace(i,"");let s=KK.has(t)?1:0;return i!==e&&(s*=100),t+"("+s+r+")"}const HK=/\b([a-z-]*)\(.*?\)/gu,fw={...ja,getAnimatableNone:n=>{const t=n.match(HK);return t?t.map(qK).join(" "):n}},XK={...VT,color:Hn,backgroundColor:Hn,outlineColor:Hn,fill:Hn,stroke:Hn,borderColor:Hn,borderTopColor:Hn,borderRightColor:Hn,borderBottomColor:Hn,borderLeftColor:Hn,filter:fw,WebkitFilter:fw},tS=n=>XK[n];function IN(n,t){let e=tS(n);return e!==fw&&(e=ja),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const YK=new Set(["auto","none","0"]);function ZK(n,t,e){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!YK.has(s)&&og(s).values.length&&(r=n[i]),i++}if(r&&e)for(const s of t)n[s]=IN(e,r)}const mC=n=>n===Fh||n===Ot,pC=(n,t)=>parseFloat(n.split(", ")[t]),_C=(n,t)=>(e,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return pC(r[1],t);{const s=i.match(/^matrix\((.+)\)$/u);return s?pC(s[1],n):0}},QK=new Set(["x","y","z"]),JK=Vh.filter(n=>!QK.has(n));function tq(n){const t=[];return JK.forEach(e=>{const i=n.getValue(e);i!==void 0&&(t.push([e,i.get()]),i.set(e.startsWith("scale")?1:0))}),t}const Rh={width:({x:n},{paddingLeft:t="0",paddingRight:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),height:({y:n},{paddingTop:t="0",paddingBottom:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),top:(n,{top:t})=>parseFloat(t),left:(n,{left:t})=>parseFloat(t),bottom:({y:n},{top:t})=>parseFloat(t)+(n.max-n.min),right:({x:n},{left:t})=>parseFloat(t)+(n.max-n.min),x:_C(4,13),y:_C(5,14)};Rh.translateX=Rh.x;Rh.translateY=Rh.y;const Zl=new Set;let gw=!1,mw=!1;function AN(){if(mw){const n=Array.from(Zl).filter(i=>i.needsMeasurement),t=new Set(n.map(i=>i.element)),e=new Map;t.forEach(i=>{const r=tq(i);r.length&&(e.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const r=e.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))===null||a===void 0||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}mw=!1,gw=!1,Zl.forEach(n=>n.complete()),Zl.clear()}function RN(){Zl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(mw=!0)})}function eq(){RN(),AN()}class eS{constructor(t,e,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Zl.add(this),gw||(gw=!0,Le.read(RN),Le.resolveKeyframes(AN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:i,motionValue:r}=this;for(let s=0;s<t.length;s++)if(t[s]===null)if(s===0){const o=r?.get(),a=t[t.length-1];if(o!==void 0)t[0]=o;else if(i&&e){const u=i.readValue(e,a);u!=null&&(t[0]=u)}t[0]===void 0&&(t[0]=a),r&&o===void 0&&r.set(t[0])}else t[s]=t[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Zl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Zl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const PN=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),nq=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function iq(n){const t=nq.exec(n);if(!t)return[,];const[,e,i,r]=t;return[`--${e??i}`,r]}function CN(n,t,e=1){const[i,r]=iq(n);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const o=s.trim();return PN(o)?parseFloat(o):o}return OT(r)?CN(r,t,e+1):r}const MN=n=>t=>t.test(n),rq={test:n=>n==="auto",parse:n=>n},bN=[Fh,Ot,Ms,ca,qW,KW,rq],yC=n=>bN.find(MN(n));class kN extends eS{constructor(t,e,i,r,s){super(t,e,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:i}=this;if(!e||!e.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let h=t[u];if(typeof h=="string"&&(h=h.trim(),OT(h))){const d=CN(h,e.current);d!==void 0&&(t[u]=d),u===t.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!lN.has(i)||t.length!==2)return;const[r,s]=t,o=yC(r),a=yC(s);if(o!==a)if(mC(o)&&mC(a))for(let u=0;u<t.length;u++){const h=t[u];typeof h=="string"&&(t[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,i=[];for(let r=0;r<t.length;r++)DK(t[r])&&i.push(r);i.length&&ZK(t,i,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Rh[i](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const r=e[e.length-1];r!==void 0&&t.getValue(i,r).jump(r,!1)}measureEndState(){var t;const{element:e,name:i,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Rh[i](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([u,h])=>{e.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const vC=(n,t)=>t==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ja.test(n)||n==="0")&&!n.startsWith("url("));function sq(n){const t=n[0];if(n.length===1)return!0;for(let e=0;e<n.length;e++)if(n[e]!==t)return!0}function oq(n,t,e,i){const r=n[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const s=n[n.length-1],o=vC(r,t),a=vC(s,t);return!o||!a?!1:sq(n)||(e==="spring"||$T(e))&&i}const aq=n=>n!==null;function fy(n,{repeat:t,repeatType:e="loop"},i){const r=n.filter(aq),s=t&&e!=="loop"&&t%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const lq=40;class LN{constructor({autoplay:t=!0,delay:e=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=bs.now(),this.options={autoplay:t,delay:e,type:i,repeat:r,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>lq?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&eq(),this._resolved}onKeyframesResolved(t,e){this.resolvedAt=bs.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:a,onUpdate:u,isGenerator:h}=this.options;if(!h&&!oq(t,i,r,s))if(o)this.options.duration=0;else{u&&u(fy(t,this.options,e)),a&&a(),this.resolveFinishedPromise();return}const d=this.initPlayback(t,e);d!==!1&&(this._resolved={keyframes:t,finalKeyframe:e,...d},this.onPostResolved())}onPostResolved(){}then(t,e){return this.currentFinishedPromise.then(t,e)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const $e=(n,t,e)=>n+(t-n)*e;function V1(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*(2/3-e)*6:n}function uq({hue:n,saturation:t,lightness:e,alpha:i}){n/=360,t/=100,e/=100;let r=0,s=0,o=0;if(!t)r=s=o=e;else{const a=e<.5?e*(1+t):e+t-e*t,u=2*e-a;r=V1(u,a,n+1/3),s=V1(u,a,n),o=V1(u,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function t_(n,t){return e=>e>0?t:n}const F1=(n,t,e)=>{const i=n*n,r=e*(t*t-i)+i;return r<0?0:Math.sqrt(r)},cq=[dw,Wl,Vc],hq=n=>cq.find(t=>t.test(n));function EC(n){const t=hq(n);if(!t)return!1;let e=t.parse(n);return t===Vc&&(e=uq(e)),e}const wC=(n,t)=>{const e=EC(n),i=EC(t);if(!e||!i)return t_(n,t);const r={...e};return s=>(r.red=F1(e.red,i.red,s),r.green=F1(e.green,i.green,s),r.blue=F1(e.blue,i.blue,s),r.alpha=$e(e.alpha,i.alpha,s),Wl.transform(r))},dq=(n,t)=>e=>t(n(e)),jg=(...n)=>n.reduce(dq),pw=new Set(["none","hidden"]);function fq(n,t){return pw.has(n)?e=>e<=0?n:t:e=>e>=1?t:n}function gq(n,t){return e=>$e(n,t,e)}function nS(n){return typeof n=="number"?gq:typeof n=="string"?OT(n)?t_:Hn.test(n)?wC:_q:Array.isArray(n)?DN:typeof n=="object"?Hn.test(n)?wC:mq:t_}function DN(n,t){const e=[...n],i=e.length,r=n.map((s,o)=>nS(s)(s,t[o]));return s=>{for(let o=0;o<i;o++)e[o]=r[o](s);return e}}function mq(n,t){const e={...n,...t},i={};for(const r in e)n[r]!==void 0&&t[r]!==void 0&&(i[r]=nS(n[r])(n[r],t[r]));return r=>{for(const s in i)e[s]=i[s](r);return e}}function pq(n,t){var e;const i=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const o=t.types[s],a=n.indexes[o][r[o]],u=(e=n.values[a])!==null&&e!==void 0?e:0;i[s]=u,r[o]++}return i}const _q=(n,t)=>{const e=ja.createTransformer(t),i=og(n),r=og(t);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?pw.has(n)&&!r.values.length||pw.has(t)&&!i.values.length?fq(n,t):jg(DN(pq(i,r),r.values),e):t_(n,t)};function NN(n,t,e){return typeof n=="number"&&typeof t=="number"&&typeof e=="number"?$e(n,t,e):nS(n)(n,t)}const yq=5;function ON(n,t,e){const i=Math.max(t-yq,0);return uN(e-n(i),t-i)}const He={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},G1=.001;function vq({duration:n=He.duration,bounce:t=He.bounce,velocity:e=He.velocity,mass:i=He.mass}){let r,s,o=1-t;o=To(He.minDamping,He.maxDamping,o),n=To(He.minDuration,He.maxDuration,po(n)),o<1?(r=h=>{const d=h*o,g=d*n,m=d-e,v=_w(h,o),y=Math.exp(-g);return G1-m/v*y},s=h=>{const g=h*o*n,m=g*e+e,v=Math.pow(o,2)*Math.pow(h,2)*n,y=Math.exp(-g),S=_w(Math.pow(h,2),o);return(-r(h)+G1>0?-1:1)*((m-v)*y)/S}):(r=h=>{const d=Math.exp(-h*n),g=(h-e)*n+1;return-G1+d*g},s=h=>{const d=Math.exp(-h*n),g=(e-h)*(n*n);return d*g});const a=5/n,u=wq(r,s,a);if(n=mo(n),isNaN(u))return{stiffness:He.stiffness,damping:He.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const Eq=12;function wq(n,t,e){let i=e;for(let r=1;r<Eq;r++)i=i-n(i)/t(i);return i}function _w(n,t){return n*Math.sqrt(1-t*t)}const xq=["duration","bounce"],Tq=["stiffness","damping","mass"];function xC(n,t){return t.some(e=>n[e]!==void 0)}function Sq(n){let t={velocity:He.velocity,stiffness:He.stiffness,damping:He.damping,mass:He.mass,isResolvedFromDuration:!1,...n};if(!xC(n,Tq)&&xC(n,xq))if(n.visualDuration){const e=n.visualDuration,i=2*Math.PI/(e*1.2),r=i*i,s=2*To(.05,1,1-(n.bounce||0))*Math.sqrt(r);t={...t,mass:He.mass,stiffness:r,damping:s}}else{const e=vq(n);t={...t,...e,mass:He.mass},t.isResolvedFromDuration=!0}return t}function VN(n=He.visualDuration,t=He.bounce){const e=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:t}:n;let{restSpeed:i,restDelta:r}=e;const s=e.keyframes[0],o=e.keyframes[e.keyframes.length-1],a={done:!1,value:s},{stiffness:u,damping:h,mass:d,duration:g,velocity:m,isResolvedFromDuration:v}=Sq({...e,velocity:-po(e.velocity||0)}),y=m||0,S=h/(2*Math.sqrt(u*d)),w=o-s,R=po(Math.sqrt(u/d)),P=Math.abs(w)<5;i||(i=P?He.restSpeed.granular:He.restSpeed.default),r||(r=P?He.restDelta.granular:He.restDelta.default);let M;if(S<1){const D=_w(R,S);M=j=>{const b=Math.exp(-S*R*j);return o-b*((y+S*R*w)/D*Math.sin(D*j)+w*Math.cos(D*j))}}else if(S===1)M=D=>o-Math.exp(-R*D)*(w+(y+R*w)*D);else{const D=R*Math.sqrt(S*S-1);M=j=>{const b=Math.exp(-S*R*j),A=Math.min(D*j,300);return o-b*((y+S*R*w)*Math.sinh(A)+D*w*Math.cosh(A))/D}}const L={calculatedDuration:v&&g||null,next:D=>{const j=M(D);if(v)a.done=D>=g;else{let b=0;S<1&&(b=D===0?mo(y):ON(M,D,j));const A=Math.abs(b)<=i,k=Math.abs(o-j)<=r;a.done=A&&k}return a.value=a.done?o:j,a},toString:()=>{const D=Math.min(eN(L),uw),j=nN(b=>L.next(D*b).value,D,30);return D+"ms "+j}};return L}function TC({keyframes:n,velocity:t=0,power:e=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:u,restDelta:h=.5,restSpeed:d}){const g=n[0],m={done:!1,value:g},v=A=>a!==void 0&&A<a||u!==void 0&&A>u,y=A=>a===void 0?u:u===void 0||Math.abs(a-A)<Math.abs(u-A)?a:u;let S=e*t;const w=g+S,R=o===void 0?w:o(w);R!==w&&(S=R-g);const P=A=>-S*Math.exp(-A/i),M=A=>R+P(A),L=A=>{const k=P(A),V=M(A);m.done=Math.abs(k)<=h,m.value=m.done?R:V};let D,j;const b=A=>{v(m.value)&&(D=A,j=VN({keyframes:[m.value,y(m.value)],velocity:ON(M,A,m.value),damping:r,stiffness:s,restDelta:h,restSpeed:d}))};return b(0),{calculatedDuration:null,next:A=>{let k=!1;return!j&&D===void 0&&(k=!0,L(A),b(A)),D!==void 0&&A>=D?j.next(A-D):(!k&&L(A),m)}}}const Iq=Ug(.42,0,1,1),Aq=Ug(0,0,.58,1),FN=Ug(.42,0,.58,1),Rq=n=>Array.isArray(n)&&typeof n[0]!="number",Pq={linear:qi,easeIn:Iq,easeInOut:FN,easeOut:Aq,circIn:ZT,circInOut:yN,circOut:_N,backIn:YT,backInOut:mN,backOut:gN,anticipate:pN},SC=n=>{if(WT(n)){ND(n.length===4);const[t,e,i,r]=n;return Ug(t,e,i,r)}else if(typeof n=="string")return Pq[n];return n};function Cq(n,t,e){const i=[],r=e||NN,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(t){const u=Array.isArray(t)?t[o]||qi:t;a=jg(u,a)}i.push(a)}return i}function Mq(n,t,{clamp:e=!0,ease:i,mixer:r}={}){const s=n.length;if(ND(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),t=[...t].reverse());const a=Cq(t,i,r),u=a.length,h=d=>{if(o&&d<n[0])return t[0];let g=0;if(u>1)for(;g<n.length-2&&!(d<n[g+1]);g++);const m=Ih(n[g],n[g+1],d);return a[g](m)};return e?d=>h(To(n[0],n[s-1],d)):h}function bq(n,t){const e=n[n.length-1];for(let i=1;i<=t;i++){const r=Ih(0,t,i);n.push($e(e,1,r))}}function kq(n){const t=[0];return bq(t,n.length-1),t}function Lq(n,t){return n.map(e=>e*t)}function Dq(n,t){return n.map(()=>t||FN).splice(0,n.length-1)}function e_({duration:n=300,keyframes:t,times:e,ease:i="easeInOut"}){const r=Rq(i)?i.map(SC):SC(i),s={done:!1,value:t[0]},o=Lq(e&&e.length===t.length?e:kq(t),n),a=Mq(o,t,{ease:Array.isArray(r)?r:Dq(t,r)});return{calculatedDuration:n,next:u=>(s.value=a(u),s.done=u>=n,s)}}const Nq=n=>{const t=({timestamp:e})=>n(e);return{start:()=>Le.update(t,!0),stop:()=>Ua(t),now:()=>On.isProcessing?On.timestamp:bs.now()}},Oq={decay:TC,inertia:TC,tween:e_,keyframes:e_,spring:VN},Vq=n=>n/100;class iS extends LN{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:e,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||eS,a=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,a,e,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:e="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,a=$T(e)?e:Oq[e]||e_;let u,h;a!==e_&&typeof t[0]!="number"&&(u=jg(Vq,NN(t[0],t[1])),t=[0,100]);const d=a({...this.options,keyframes:t});s==="mirror"&&(h=a({...this.options,keyframes:[...t].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=eN(d));const{calculatedDuration:g}=d,m=g+r,v=m*(i+1)-r;return{generator:d,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:g,resolvedDuration:m,totalDuration:v}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,e=!1){const{resolved:i}=this;if(!i){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:u,calculatedDuration:h,totalDuration:d,resolvedDuration:g}=i;if(this.startTime===null)return s.next(0);const{delay:m,repeat:v,repeatType:y,repeatDelay:S,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-d/this.speed,this.startTime)),e?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const R=this.currentTime-m*(this.speed>=0?1:-1),P=this.speed>=0?R<0:R>d;this.currentTime=Math.max(R,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let M=this.currentTime,L=s;if(v){const A=Math.min(this.currentTime,d)/g;let k=Math.floor(A),V=A%1;!V&&A>=1&&(V=1),V===1&&k--,k=Math.min(k,v+1),k%2&&(y==="reverse"?(V=1-V,S&&(V-=S/g)):y==="mirror"&&(L=o)),M=To(0,1,V)*g}const D=P?{done:!1,value:u[0]}:L.next(M);a&&(D.value=a(D.value));let{done:j}=D;!P&&h!==null&&(j=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const b=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return b&&r!==void 0&&(D.value=fy(u,this.options,r)),w&&w(D.value),b&&this.finish(),D}get duration(){const{resolved:t}=this;return t?po(t.calculatedDuration):0}get time(){return po(this.currentTime)}set time(t){t=mo(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=po(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=Nq,onPlay:e,startTime:i}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),e&&e();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Fq=new Set(["opacity","clipPath","filter","transform"]);function Gq(n,t,e,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:u}={}){const h={[t]:e};u&&(h.offset=u);const d=rN(a,r);return Array.isArray(d)&&(h.easing=d),n.animate(h,{delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const Uq=CT(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),n_=10,jq=2e4;function zq(n){return $T(n.type)||n.type==="spring"||!iN(n.ease)}function Bq(n,t){const e=new iS({...t,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<jq;)i=e.sample(s),r.push(i.value),s+=n_;return{times:void 0,keyframes:r,duration:s-n_,ease:"linear"}}const GN={anticipate:pN,backInOut:mN,circInOut:yN};function $q(n){return n in GN}class IC extends LN{constructor(t){super(t);const{name:e,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new kN(s,(o,a)=>this.onKeyframesResolved(o,a),e,i,r),this.resolver.scheduleResolve()}initPlayback(t,e){let{duration:i=300,times:r,ease:s,type:o,motionValue:a,name:u,startTime:h}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&J0()&&$q(s)&&(s=GN[s]),zq(this.options)){const{onComplete:g,onUpdate:m,motionValue:v,element:y,...S}=this.options,w=Bq(t,S);t=w.keyframes,t.length===1&&(t[1]=t[0]),i=w.duration,r=w.times,s=w.ease,o="keyframes"}const d=Gq(a.owner.current,u,t,{...this.options,duration:i,times:r,ease:s});return d.startTime=h??this.calcStartTime(),this.pendingTimeline?(uC(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:g}=this.options;a.set(fy(t,this.options,e)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:i,times:r,type:o,ease:s,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:e}=t;return po(e)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:e}=t;return po(e.currentTime||0)}set time(t){const{resolved:e}=this;if(!e)return;const{animation:i}=e;i.currentTime=mo(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:e}=t;return e.playbackRate}set speed(t){const{resolved:e}=this;if(!e)return;const{animation:i}=e;i.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:e}=t;return e.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:e}=t;return e.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:e}=this;if(!e)return qi;const{animation:i}=e;uC(i,t)}return qi}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:e}=t;e.playState==="finished"&&this.updateFinishedPromise(),e.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:e}=t;e.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:e,keyframes:i,duration:r,type:s,ease:o,times:a}=t;if(e.playState==="idle"||e.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:d,onComplete:g,element:m,...v}=this.options,y=new iS({...v,keyframes:i,duration:r,type:s,ease:o,times:a,isGenerator:!0}),S=mo(this.time);h.setWithVelocity(y.sample(S-n_).value,y.sample(S).value,n_)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:e,name:i,repeatDelay:r,repeatType:s,damping:o,type:a}=t;if(!e||!e.owner||!(e.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=e.owner.getProps();return Uq()&&i&&Fq.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&a!=="inertia"}}const Wq={type:"spring",stiffness:500,damping:25,restSpeed:10},Kq=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),qq={type:"keyframes",duration:.8},Hq={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Xq=(n,{keyframes:t})=>t.length>2?qq:Ru.has(n)?n.startsWith("scale")?Kq(t[1]):Wq:Hq;function Yq({when:n,delay:t,delayChildren:e,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:u,elapsed:h,...d}){return!!Object.keys(d).length}const rS=(n,t,e,i={},r,s)=>o=>{const a=BT(i,n)||{},u=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-mo(u);let d={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-h,onUpdate:m=>{t.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:t,element:s?void 0:r};Yq(a)||(d={...d,...Xq(n,d)}),d.duration&&(d.duration=mo(d.duration)),d.repeatDelay&&(d.repeatDelay=mo(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(g=!0)),g&&!s&&t.get()!==void 0){const m=fy(d.keyframes,a);if(m!==void 0)return Le.update(()=>{d.onUpdate(m),d.onComplete()}),new mK([])}return!s&&IC.supports(d)?new IC(d):new iS(d)};function Zq({protectedKeys:n,needsAnimating:t},e){const i=n.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,i}function UN(n,t,{delay:e=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:a,...u}=t;i&&(o=i);const h=[],d=r&&n.animationState&&n.animationState.getState()[r];for(const g in u){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),v=u[g];if(v===void 0||d&&Zq(d,g))continue;const y={delay:e,...BT(o||{},g)};let S=!1;if(window.MotionHandoffAnimation){const R=cN(n);if(R){const P=window.MotionHandoffAnimation(R,g,Le);P!==null&&(y.startTime=P,S=!0)}}hw(n,g),m.start(rS(g,m,v,n.shouldReduceMotion&&lN.has(g)?{type:!1}:y,n,S));const w=m.animation;w&&h.push(w)}return a&&Promise.all(h).then(()=>{Le.update(()=>{a&&CK(n,a)})}),h}function yw(n,t,e={}){var i;const r=dy(n,t,e.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};e.transitionOverride&&(s=e.transitionOverride);const o=r?()=>Promise.all(UN(n,r,e)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:m}=s;return Qq(n,t,d+h,g,m,e)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,d]=u==="beforeChildren"?[o,a]:[a,o];return h().then(()=>d())}else return Promise.all([o(),a(e.delay)])}function Qq(n,t,e=0,i=0,r=1,s){const o=[],a=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>a-h*i;return Array.from(n.variantChildren).sort(Jq).forEach((h,d)=>{h.notify("AnimationStart",t),o.push(yw(h,t,{...s,delay:e+u(d)}).then(()=>h.notify("AnimationComplete",t)))}),Promise.all(o)}function Jq(n,t){return n.sortNodePosition(t)}function tH(n,t,e={}){n.notify("AnimationStart",t);let i;if(Array.isArray(t)){const r=t.map(s=>yw(n,s,e));i=Promise.all(r)}else if(typeof t=="string")i=yw(n,t,e);else{const r=typeof t=="function"?dy(n,t,e.custom):t;i=Promise.all(UN(n,r,e))}return i.then(()=>{n.notify("AnimationComplete",t)})}const eH=bT.length;function jN(n){if(!n)return;if(!n.isControllingVariants){const e=n.parent?jN(n.parent)||{}:{};return n.props.initial!==void 0&&(e.initial=n.props.initial),e}const t={};for(let e=0;e<eH;e++){const i=bT[e],r=n.props[i];(ig(r)||r===!1)&&(t[i]=r)}return t}const nH=[...MT].reverse(),iH=MT.length;function rH(n){return t=>Promise.all(t.map(({animation:e,options:i})=>tH(n,e,i)))}function sH(n){let t=rH(n),e=AC(),i=!0;const r=u=>(h,d)=>{var g;const m=dy(n,d,u==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:v,transitionEnd:y,...S}=m;h={...h,...S,...y}}return h};function s(u){t=u(n)}function o(u){const{props:h}=n,d=jN(n.parent)||{},g=[],m=new Set;let v={},y=1/0;for(let w=0;w<iH;w++){const R=nH[w],P=e[R],M=h[R]!==void 0?h[R]:d[R],L=ig(M),D=R===u?P.isActive:null;D===!1&&(y=w);let j=M===d[R]&&M!==h[R]&&L;if(j&&i&&n.manuallyAnimateOnMount&&(j=!1),P.protectedKeys={...v},!P.isActive&&D===null||!M&&!P.prevProp||cy(M)||typeof M=="boolean")continue;const b=oH(P.prevProp,M);let A=b||R===u&&P.isActive&&!j&&L||w>y&&L,k=!1;const V=Array.isArray(M)?M:[M];let F=V.reduce(r(R),{});D===!1&&(F={});const{prevResolvedValues:U={}}=P,N={...U,...F},ut=dt=>{A=!0,m.has(dt)&&(k=!0,m.delete(dt)),P.needsAnimating[dt]=!0;const J=n.getValue(dt);J&&(J.liveStyle=!1)};for(const dt in N){const J=F[dt],at=U[dt];if(v.hasOwnProperty(dt))continue;let it=!1;lw(J)&&lw(at)?it=!tN(J,at):it=J!==at,it?J!=null?ut(dt):m.add(dt):J!==void 0&&m.has(dt)?ut(dt):P.protectedKeys[dt]=!0}P.prevProp=M,P.prevResolvedValues=F,P.isActive&&(v={...v,...F}),i&&n.blockInitialAnimation&&(A=!1),A&&(!(j&&b)||k)&&g.push(...V.map(dt=>({animation:dt,options:{type:R}})))}if(m.size){const w={};m.forEach(R=>{const P=n.getBaseTarget(R),M=n.getValue(R);M&&(M.liveStyle=!0),w[R]=P??null}),g.push({animation:w})}let S=!!g.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(S=!1),i=!1,S?t(g):Promise.resolve()}function a(u,h){var d;if(e[u].isActive===h)return Promise.resolve();(d=n.variantChildren)===null||d===void 0||d.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(u,h)}),e[u].isActive=h;const g=o(u);for(const m in e)e[m].protectedKeys={};return g}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>e,reset:()=>{e=AC(),i=!0}}}function oH(n,t){return typeof t=="string"?t!==n:Array.isArray(t)?!tN(t,n):!1}function Tl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function AC(){return{animate:Tl(!0),whileInView:Tl(),whileHover:Tl(),whileTap:Tl(),whileDrag:Tl(),whileFocus:Tl(),exit:Tl()}}class qa{constructor(t){this.isMounted=!1,this.node=t}update(){}}class aH extends qa{constructor(t){super(t),t.animationState||(t.animationState=sH(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();cy(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let lH=0;class uH extends qa{constructor(){super(...arguments),this.id=lH++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const r=this.node.animationState.setActive("exit",!t);e&&!t&&r.then(()=>e(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const cH={animation:{Feature:aH},exit:{Feature:uH}};function ag(n,t,e,i={passive:!0}){return n.addEventListener(t,e,i),()=>n.removeEventListener(t,e)}function zg(n){return{point:{x:n.pageX,y:n.pageY}}}const hH=n=>t=>KT(t)&&n(t,zg(t));function vf(n,t,e,i){return ag(n,t,hH(e),i)}const RC=(n,t)=>Math.abs(n-t);function dH(n,t){const e=RC(n.x,t.x),i=RC(n.y,t.y);return Math.sqrt(e**2+i**2)}class zN{constructor(t,e,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=j1(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=dH(g.offset,{x:0,y:0})>=3;if(!m&&!v)return;const{point:y}=g,{timestamp:S}=On;this.history.push({...y,timestamp:S});const{onStart:w,onMove:R}=this.handlers;m||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),R&&R(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=U1(m,this.transformPagePoint),Le.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:v,onSessionEnd:y,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=j1(g.type==="pointercancel"?this.lastMoveEventInfo:U1(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,w),y&&y(g,w)},!KT(t))return;this.dragSnapToOrigin=s,this.handlers=e,this.transformPagePoint=i,this.contextWindow=r||window;const o=zg(t),a=U1(o,this.transformPagePoint),{point:u}=a,{timestamp:h}=On;this.history=[{...u,timestamp:h}];const{onSessionStart:d}=e;d&&d(t,j1(a,this.history)),this.removeListeners=jg(vf(this.contextWindow,"pointermove",this.handlePointerMove),vf(this.contextWindow,"pointerup",this.handlePointerUp),vf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ua(this.updatePoint)}}function U1(n,t){return t?{point:t(n.point)}:n}function PC(n,t){return{x:n.x-t.x,y:n.y-t.y}}function j1({point:n},t){return{point:n,delta:PC(n,BN(t)),offset:PC(n,fH(t)),velocity:gH(t,.1)}}function fH(n){return n[0]}function BN(n){return n[n.length-1]}function gH(n,t){if(n.length<2)return{x:0,y:0};let e=n.length-1,i=null;const r=BN(n);for(;e>=0&&(i=n[e],!(r.timestamp-i.timestamp>mo(t)));)e--;if(!i)return{x:0,y:0};const s=po(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const $N=1e-4,mH=1-$N,pH=1+$N,WN=.01,_H=0-WN,yH=0+WN;function Zi(n){return n.max-n.min}function vH(n,t,e){return Math.abs(n-t)<=e}function CC(n,t,e,i=.5){n.origin=i,n.originPoint=$e(t.min,t.max,n.origin),n.scale=Zi(e)/Zi(t),n.translate=$e(e.min,e.max,n.origin)-n.originPoint,(n.scale>=mH&&n.scale<=pH||isNaN(n.scale))&&(n.scale=1),(n.translate>=_H&&n.translate<=yH||isNaN(n.translate))&&(n.translate=0)}function Ef(n,t,e,i){CC(n.x,t.x,e.x,i?i.originX:void 0),CC(n.y,t.y,e.y,i?i.originY:void 0)}function MC(n,t,e){n.min=e.min+t.min,n.max=n.min+Zi(t)}function EH(n,t,e){MC(n.x,t.x,e.x),MC(n.y,t.y,e.y)}function bC(n,t,e){n.min=t.min-e.min,n.max=n.min+Zi(t)}function wf(n,t,e){bC(n.x,t.x,e.x),bC(n.y,t.y,e.y)}function wH(n,{min:t,max:e},i){return t!==void 0&&n<t?n=i?$e(t,n,i.min):Math.max(n,t):e!==void 0&&n>e&&(n=i?$e(e,n,i.max):Math.min(n,e)),n}function kC(n,t,e){return{min:t!==void 0?n.min+t:void 0,max:e!==void 0?n.max+e-(n.max-n.min):void 0}}function xH(n,{top:t,left:e,bottom:i,right:r}){return{x:kC(n.x,e,r),y:kC(n.y,t,i)}}function LC(n,t){let e=t.min-n.min,i=t.max-n.max;return t.max-t.min<n.max-n.min&&([e,i]=[i,e]),{min:e,max:i}}function TH(n,t){return{x:LC(n.x,t.x),y:LC(n.y,t.y)}}function SH(n,t){let e=.5;const i=Zi(n),r=Zi(t);return r>i?e=Ih(t.min,t.max-i,n.min):i>r&&(e=Ih(n.min,n.max-r,t.min)),To(0,1,e)}function IH(n,t){const e={};return t.min!==void 0&&(e.min=t.min-n.min),t.max!==void 0&&(e.max=t.max-n.min),e}const vw=.35;function AH(n=vw){return n===!1?n=0:n===!0&&(n=vw),{x:DC(n,"left","right"),y:DC(n,"top","bottom")}}function DC(n,t,e){return{min:NC(n,t),max:NC(n,e)}}function NC(n,t){return typeof n=="number"?n:n[t]||0}const OC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Fc=()=>({x:OC(),y:OC()}),VC=()=>({min:0,max:0}),tn=()=>({x:VC(),y:VC()});function mr(n){return[n("x"),n("y")]}function KN({top:n,left:t,right:e,bottom:i}){return{x:{min:t,max:e},y:{min:n,max:i}}}function RH({x:n,y:t}){return{top:t.min,right:n.max,bottom:t.max,left:n.min}}function PH(n,t){if(!t)return n;const e=t({x:n.left,y:n.top}),i=t({x:n.right,y:n.bottom});return{top:e.y,left:e.x,bottom:i.y,right:i.x}}function z1(n){return n===void 0||n===1}function Ew({scale:n,scaleX:t,scaleY:e}){return!z1(n)||!z1(t)||!z1(e)}function Cl(n){return Ew(n)||qN(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function qN(n){return FC(n.x)||FC(n.y)}function FC(n){return n&&n!=="0%"}function i_(n,t,e){const i=n-e,r=t*i;return e+r}function GC(n,t,e,i,r){return r!==void 0&&(n=i_(n,r,i)),i_(n,e,i)+t}function ww(n,t=0,e=1,i,r){n.min=GC(n.min,t,e,i,r),n.max=GC(n.max,t,e,i,r)}function HN(n,{x:t,y:e}){ww(n.x,t.translate,t.scale,t.originPoint),ww(n.y,e.translate,e.scale,e.originPoint)}const UC=.999999999999,jC=1.0000000000001;function CH(n,t,e,i=!1){const r=e.length;if(!r)return;t.x=t.y=1;let s,o;for(let a=0;a<r;a++){s=e[a],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Uc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,HN(n,o)),i&&Cl(s.latestValues)&&Uc(n,s.latestValues))}t.x<jC&&t.x>UC&&(t.x=1),t.y<jC&&t.y>UC&&(t.y=1)}function Gc(n,t){n.min=n.min+t,n.max=n.max+t}function zC(n,t,e,i,r=.5){const s=$e(n.min,n.max,r);ww(n,t,e,s,i)}function Uc(n,t){zC(n.x,t.x,t.scaleX,t.scale,t.originX),zC(n.y,t.y,t.scaleY,t.scale,t.originY)}function XN(n,t){return KN(PH(n.getBoundingClientRect(),t))}function MH(n,t,e){const i=XN(n,e),{scroll:r}=t;return r&&(Gc(i.x,r.offset.x),Gc(i.y,r.offset.y)),i}const YN=({current:n})=>n?n.ownerDocument.defaultView:null,bH=new WeakMap;class kH{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=tn(),this.visualElement=t}start(t,{snapToCursor:e=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),e&&this.snapToCursor(zg(d).point)},s=(d,g)=>{const{drag:m,dragPropagation:v,onDragStart:y}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=SK(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),mr(w=>{let R=this.getAxisMotionValue(w).get()||0;if(Ms.test(R)){const{projection:P}=this.visualElement;if(P&&P.layout){const M=P.layout.layoutBox[w];M&&(R=Zi(M)*(parseFloat(R)/100))}}this.originPoint[w]=R}),y&&Le.postRender(()=>y(d,g)),hw(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},o=(d,g)=>{const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:y,onDrag:S}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=g;if(v&&this.currentDirection===null){this.currentDirection=LH(w),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),S&&S(d,g)},a=(d,g)=>this.stop(d,g),u=()=>mr(d=>{var g;return this.getAnimationState(d)==="paused"&&((g=this.getAxisMotionValue(d).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new zN(t,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:YN(this.visualElement)})}stop(t,e){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=e;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Le.postRender(()=>s(t,e))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),e&&e.setActive("whileDrag",!1)}updateAxis(t,e,i){const{drag:r}=this.getProps();if(!i||!Cp(t,r,this.currentDirection))return;const s=this.getAxisMotionValue(t);let o=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(o=wH(o,this.constraints[t],this.elastic[t])),s.set(o)}resolveConstraints(){var t;const{dragConstraints:e,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,s=this.constraints;e&&Oc(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=xH(r.layoutBox,e):this.constraints=!1,this.elastic=AH(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&mr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=IH(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!Oc(t))return!1;const i=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=MH(i,r.root,this.visualElement.getTransformPagePoint());let o=TH(r.layout.layoutBox,s);if(e){const a=e(RH(o));this.hasMutatedConstraints=!!a,a&&(o=KN(a))}return o}startAnimation(t){const{drag:e,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),u=this.constraints||{},h=mr(d=>{if(!Cp(d,e,this.currentDirection))return;let g=u&&u[d]||{};o&&(g={min:0,max:0});const m=r?200:1e6,v=r?40:1e7,y={type:"inertia",velocity:i?t[d]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(d,y)});return Promise.all(h).then(a)}startAxisValueAnimation(t,e){const i=this.getAxisMotionValue(t);return hw(this.visualElement,t),i.start(rS(t,i,0,e,this.visualElement,!1))}stopAnimation(){mr(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){mr(t=>{var e;return(e=this.getAxisMotionValue(t).animation)===null||e===void 0?void 0:e.pause()})}getAnimationState(t){var e;return(e=this.getAxisMotionValue(t).animation)===null||e===void 0?void 0:e.state}getAxisMotionValue(t){const e=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),r=i[e];return r||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){mr(e=>{const{drag:i}=this.getProps();if(!Cp(e,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(e);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[e];s.set(t[e]-$e(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:i}=this.visualElement;if(!Oc(e)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};mr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const u=a.get();r[o]=SH({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),mr(o=>{if(!Cp(o,t,null))return;const a=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];a.set($e(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;bH.set(this.visualElement,this);const t=this.visualElement.current,e=vf(t,"pointerdown",u=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();Oc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Le.read(i);const o=ag(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(mr(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=u[d].translate,g.set(g.get()+u[d].translate))}),this.visualElement.render())}));return()=>{o(),e(),s(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=vw,dragMomentum:a=!0}=t;return{...t,drag:e,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Cp(n,t,e){return(t===!0||t===n)&&(e===null||e===n)}function LH(n,t=10){let e=null;return Math.abs(n.y)>t?e="y":Math.abs(n.x)>t&&(e="x"),e}class DH extends qa{constructor(t){super(t),this.removeGroupControls=qi,this.removeListeners=qi,this.controls=new kH(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||qi}unmount(){this.removeGroupControls(),this.removeListeners()}}const BC=n=>(t,e)=>{n&&Le.postRender(()=>n(t,e))};class NH extends qa{constructor(){super(...arguments),this.removePointerDownListener=qi}onPointerDown(t){this.session=new zN(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:YN(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:BC(t),onStart:BC(e),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Le.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=vf(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Jp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $C(n,t){return t.max===t.min?0:n/(t.max-t.min)*100}const Fd={correct:(n,t)=>{if(!t.target)return n;if(typeof n=="string")if(Ot.test(n))n=parseFloat(n);else return n;const e=$C(n,t.target.x),i=$C(n,t.target.y);return`${e}% ${i}%`}},OH={correct:(n,{treeScale:t,projectionDelta:e})=>{const i=n,r=ja.parse(n);if(r.length>5)return i;const s=ja.createTransformer(n),o=typeof r[0]!="number"?1:0,a=e.x.scale*t.x,u=e.y.scale*t.y;r[0+o]/=a,r[1+o]/=u;const h=$e(a,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class VH extends nt.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=t;iK(FH),s&&(e.group&&e.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Jp.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||t.layoutDependency!==e||e===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?o.promote():o.relegate()||Le.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),LT.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:i}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function ZN(n){const[t,e]=LD(),i=nt.useContext(IT);return z.jsx(VH,{...n,layoutGroup:i,switchLayoutGroup:nt.useContext(jD),isPresent:t,safeToRemove:e})}const FH={borderRadius:{...Fd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Fd,borderTopRightRadius:Fd,borderBottomLeftRadius:Fd,borderBottomRightRadius:Fd,boxShadow:OH};function GH(n,t,e){const i=ti(n)?n:sg(n);return i.start(rS("",i,t,e)),i.animation}function UH(n){return n instanceof SVGElement&&n.tagName!=="svg"}const jH=(n,t)=>n.depth-t.depth;class zH{constructor(){this.children=[],this.isDirty=!1}add(t){qT(this.children,t),this.isDirty=!0}remove(t){HT(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(jH),this.isDirty=!1,this.children.forEach(t)}}function BH(n,t){const e=bs.now(),i=({timestamp:r})=>{const s=r-e;s>=t&&(Ua(i),n(s-t))};return Le.read(i,!0),()=>Ua(i)}const QN=["TopLeft","TopRight","BottomLeft","BottomRight"],$H=QN.length,WC=n=>typeof n=="string"?parseFloat(n):n,KC=n=>typeof n=="number"||Ot.test(n);function WH(n,t,e,i,r,s){r?(n.opacity=$e(0,e.opacity!==void 0?e.opacity:1,KH(i)),n.opacityExit=$e(t.opacity!==void 0?t.opacity:1,0,qH(i))):s&&(n.opacity=$e(t.opacity!==void 0?t.opacity:1,e.opacity!==void 0?e.opacity:1,i));for(let o=0;o<$H;o++){const a=`border${QN[o]}Radius`;let u=qC(t,a),h=qC(e,a);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||KC(u)===KC(h)?(n[a]=Math.max($e(WC(u),WC(h),i),0),(Ms.test(h)||Ms.test(u))&&(n[a]+="%")):n[a]=h}(t.rotate||e.rotate)&&(n.rotate=$e(t.rotate||0,e.rotate||0,i))}function qC(n,t){return n[t]!==void 0?n[t]:n.borderRadius}const KH=JN(0,.5,_N),qH=JN(.5,.95,qi);function JN(n,t,e){return i=>i<n?0:i>t?1:e(Ih(n,t,i))}function HC(n,t){n.min=t.min,n.max=t.max}function gr(n,t){HC(n.x,t.x),HC(n.y,t.y)}function XC(n,t){n.translate=t.translate,n.scale=t.scale,n.originPoint=t.originPoint,n.origin=t.origin}function YC(n,t,e,i,r){return n-=t,n=i_(n,1/e,i),r!==void 0&&(n=i_(n,1/r,i)),n}function HH(n,t=0,e=1,i=.5,r,s=n,o=n){if(Ms.test(t)&&(t=parseFloat(t),t=$e(o.min,o.max,t/100)-o.min),typeof t!="number")return;let a=$e(s.min,s.max,i);n===s&&(a-=t),n.min=YC(n.min,t,e,a,r),n.max=YC(n.max,t,e,a,r)}function ZC(n,t,[e,i,r],s,o){HH(n,t[e],t[i],t[r],t.scale,s,o)}const XH=["x","scaleX","originX"],YH=["y","scaleY","originY"];function QC(n,t,e,i){ZC(n.x,t,XH,e?e.x:void 0,i?i.x:void 0),ZC(n.y,t,YH,e?e.y:void 0,i?i.y:void 0)}function JC(n){return n.translate===0&&n.scale===1}function t3(n){return JC(n.x)&&JC(n.y)}function tM(n,t){return n.min===t.min&&n.max===t.max}function ZH(n,t){return tM(n.x,t.x)&&tM(n.y,t.y)}function eM(n,t){return Math.round(n.min)===Math.round(t.min)&&Math.round(n.max)===Math.round(t.max)}function e3(n,t){return eM(n.x,t.x)&&eM(n.y,t.y)}function nM(n){return Zi(n.x)/Zi(n.y)}function iM(n,t){return n.translate===t.translate&&n.scale===t.scale&&n.originPoint===t.originPoint}class QH{constructor(){this.members=[]}add(t){qT(this.members,t),t.scheduleRender()}remove(t){if(HT(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(t){const e=this.members.findIndex(r=>t===r);if(e===0)return!1;let i;for(let r=e;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(t,e){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,e&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:e,resumingFrom:i}=t;e.onExitComplete&&e.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function JH(n,t,e){let i="";const r=n.x.translate/t.x,s=n.y.translate/t.y,o=e?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),e){const{transformPerspective:h,rotate:d,rotateX:g,rotateY:m,skewX:v,skewY:y}=e;h&&(i=`perspective(${h}px) ${i}`),d&&(i+=`rotate(${d}deg) `),g&&(i+=`rotateX(${g}deg) `),m&&(i+=`rotateY(${m}deg) `),v&&(i+=`skewX(${v}deg) `),y&&(i+=`skewY(${y}deg) `)}const a=n.x.scale*t.x,u=n.y.scale*t.y;return(a!==1||u!==1)&&(i+=`scale(${a}, ${u})`),i||"none"}const Ml={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},ef=typeof window<"u"&&window.MotionDebug!==void 0,B1=["","X","Y","Z"],tX={visibility:"hidden"},rM=1e3;let eX=0;function $1(n,t,e,i){const{latestValues:r}=t;r[n]&&(e[n]=r[n],t.setStaticValue(n,0),i&&(i[n]=0))}function n3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:t}=n.options;if(!t)return;const e=cN(t);if(window.MotionHasOptimisedAnimation(e,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(e,"transform",Le,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&n3(i)}function i3({attachResizeListener:n,defaultParent:t,measureScroll:e,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=t?.()){this.id=eX++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ef&&(Ml.totalNodes=Ml.resolvedTargetDeltas=Ml.recalculatedProjection=0),this.nodes.forEach(rX),this.nodes.forEach(uX),this.nodes.forEach(cX),this.nodes.forEach(sX),ef&&window.MotionDebug.record(Ml)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new zH)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new XT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const u=this.eventHandlers.get(o);u&&u.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=UH(o),this.instance=o;const{layoutId:u,layout:h,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(h||u)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=BH(m,250),Jp.hasAnimatedSinceResize&&(Jp.hasAnimatedSinceResize=!1,this.nodes.forEach(oM))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&d&&(u||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:v,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const S=this.options.transition||d.getDefaultTransition()||mX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:R}=d.getProps(),P=!this.targetLayout||!e3(this.targetLayout,y)||v,M=!m&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||M||m&&(P||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,M);const L={...BT(S,"layout"),onPlay:w,onComplete:R};(d.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else m||oM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ua(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(hX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&n3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:a,layout:u}=this.options;if(a===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(sM);return}this.isUpdating||this.nodes.forEach(aX),this.isUpdating=!1,this.nodes.forEach(lX),this.nodes.forEach(nX),this.nodes.forEach(iX),this.clearAllSnapshots();const a=bs.now();On.delta=To(0,1e3/60,a-On.timestamp),On.timestamp=a,On.isProcessing=!0,D1.update.process(On),D1.preRender.process(On),D1.render.process(On),On.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,LT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(oX),this.sharedNodes.forEach(dX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Le.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Le.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=tn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:e(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!t3(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&(a||Cl(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let u=this.removeElementScroll(a);return o&&(u=this.removeTransform(u)),pX(u),{animationId:this.root.animationId,measuredBox:a,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return tn();const u=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(_X))){const{scroll:d}=this.root;d&&(Gc(u.x,d.offset.x),Gc(u.y,d.offset.y))}return u}removeElementScroll(o){var a;const u=tn();if(gr(u,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return u;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:g,options:m}=d;d!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&gr(u,o),Gc(u.x,g.offset.x),Gc(u.y,g.offset.y))}return u}applyTransform(o,a=!1){const u=tn();gr(u,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Uc(u,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Cl(d.latestValues)&&Uc(u,d.latestValues)}return Cl(this.latestValues)&&Uc(u,this.latestValues),u}removeTransform(o){const a=tn();gr(a,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Cl(h.latestValues))continue;Ew(h.latestValues)&&h.updateSnapshot();const d=tn(),g=h.measurePageBox();gr(d,g),QC(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Cl(this.latestValues)&&QC(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==On.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=On.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=tn(),this.relativeTargetOrigin=tn(),wf(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),gr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=tn(),this.targetWithTransforms=tn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),EH(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gr(this.target,this.layout.layoutBox),HN(this.target,this.targetDelta)):gr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=tn(),this.relativeTargetOrigin=tn(),wf(this.relativeTargetOrigin,this.target,v.target),gr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ef&&Ml.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Ew(this.parent.latestValues)||qN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),u=!!this.resumingFrom||this!==a;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===On.timestamp&&(h=!1),h)return;const{layout:d,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||g))return;gr(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;CH(this.layoutCorrected,this.treeScale,this.path,u),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=tn());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(XC(this.prevProjectionDelta.x,this.projectionDelta.x),XC(this.prevProjectionDelta.y,this.projectionDelta.y)),Ef(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==v||!iM(this.projectionDelta.x,this.prevProjectionDelta.x)||!iM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),ef&&Ml.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Fc(),this.projectionDelta=Fc(),this.projectionDeltaWithTransform=Fc()}setAnimationOrigin(o,a=!1){const u=this.snapshot,h=u?u.latestValues:{},d={...this.latestValues},g=Fc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=tn(),v=u?u.source:void 0,y=this.layout?this.layout.source:void 0,S=v!==y,w=this.getStack(),R=!w||w.members.length<=1,P=!!(S&&!R&&this.options.crossfade===!0&&!this.path.some(gX));this.animationProgress=0;let M;this.mixTargetDelta=L=>{const D=L/1e3;aM(g.x,o.x,D),aM(g.y,o.y,D),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(wf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),fX(this.relativeTarget,this.relativeTargetOrigin,m,D),M&&ZH(this.relativeTarget,M)&&(this.isProjectionDirty=!1),M||(M=tn()),gr(M,this.relativeTarget)),S&&(this.animationValues=d,WH(d,h,this.latestValues,D,P,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ua(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Le.update(()=>{Jp.hasAnimatedSinceResize=!0,this.currentAnimation=GH(0,rM,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:u,layout:h,latestValues:d}=o;if(!(!a||!u||!h)){if(this!==o&&this.layout&&h&&r3(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||tn();const g=Zi(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+g;const m=Zi(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}gr(a,u),Uc(a,d),Ef(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new QH),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(a=!0),!a)return;const h={};u.z&&$1("z",o,h,this.animationValues);for(let d=0;d<B1.length;d++)$1(`rotate${B1[d]}`,o,h,this.animationValues),$1(`skew${B1[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}getProjectionStyles(o){var a,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return tX;const h={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=Zp(o?.pointerEvents)||"",h.transform=d?d(this.latestValues,""):"none",h;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const S={};return this.options.layoutId&&(S.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,S.pointerEvents=Zp(o?.pointerEvents)||""),this.hasProjected&&!Cl(this.latestValues)&&(S.transform=d?d({},""):"none",this.hasProjected=!1),S}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),h.transform=JH(this.projectionDeltaWithTransform,this.treeScale,m),d&&(h.transform=d(m,h.transform));const{x:v,y}=this.projectionDelta;h.transformOrigin=`${v.origin*100}% ${y.origin*100}% 0`,g.animationValues?h.opacity=g===this?(u=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:h.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const S in Q0){if(m[S]===void 0)continue;const{correct:w,applyTo:R}=Q0[S],P=h.transform==="none"?m[S]:w(m[S],g);if(R){const M=R.length;for(let L=0;L<M;L++)h[R[L]]=P}else h[S]=P}return this.options.layoutId&&(h.pointerEvents=g===this?Zp(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(sM),this.root.sharedNodes.clear()}}}function nX(n){n.updateLayout()}function iX(n){var t;const e=((t=n.resumeFrom)===null||t===void 0?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=e.source!==n.layout.source;s==="size"?mr(g=>{const m=o?e.measuredBox[g]:e.layoutBox[g],v=Zi(m);m.min=i[g].min,m.max=m.min+v}):r3(s,e.layoutBox,i)&&mr(g=>{const m=o?e.measuredBox[g]:e.layoutBox[g],v=Zi(i[g]);m.max=m.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+v)});const a=Fc();Ef(a,i,e.layoutBox);const u=Fc();o?Ef(u,n.applyTransform(r,!0),e.measuredBox):Ef(u,i,e.layoutBox);const h=!t3(a);let d=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:v}=g;if(m&&v){const y=tn();wf(y,e.layoutBox,m.layoutBox);const S=tn();wf(S,i,v.layoutBox),e3(y,S)||(d=!0),g.options.layoutRoot&&(n.relativeTarget=S,n.relativeTargetOrigin=y,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:e,delta:u,layoutDelta:a,hasLayoutChanged:h,hasRelativeTargetChanged:d})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function rX(n){ef&&Ml.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function sX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function oX(n){n.clearSnapshot()}function sM(n){n.clearMeasurements()}function aX(n){n.isLayoutDirty=!1}function lX(n){const{visualElement:t}=n.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),n.resetTransform()}function oM(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function uX(n){n.resolveTargetDelta()}function cX(n){n.calcProjection()}function hX(n){n.resetSkewAndRotation()}function dX(n){n.removeLeadSnapshot()}function aM(n,t,e){n.translate=$e(t.translate,0,e),n.scale=$e(t.scale,1,e),n.origin=t.origin,n.originPoint=t.originPoint}function lM(n,t,e,i){n.min=$e(t.min,e.min,i),n.max=$e(t.max,e.max,i)}function fX(n,t,e,i){lM(n.x,t.x,e.x,i),lM(n.y,t.y,e.y,i)}function gX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const mX={duration:.45,ease:[.4,0,.1,1]},uM=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),cM=uM("applewebkit/")&&!uM("chrome/")?Math.round:qi;function hM(n){n.min=cM(n.min),n.max=cM(n.max)}function pX(n){hM(n.x),hM(n.y)}function r3(n,t,e){return n==="position"||n==="preserve-aspect"&&!vH(nM(t),nM(e),.2)}function _X(n){var t;return n!==n.root&&((t=n.scroll)===null||t===void 0?void 0:t.wasRoot)}const yX=i3({attachResizeListener:(n,t)=>ag(n,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),W1={current:void 0},s3=i3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!W1.current){const n=new yX({});n.mount(window),n.setOptions({layoutScroll:!0}),W1.current=n}return W1.current},resetTransform:(n,t)=>{n.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),vX={pan:{Feature:NH},drag:{Feature:DH,ProjectionNode:s3,MeasureLayout:ZN}};function dM(n,t,e){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",e==="Start");const r="onHover"+e,s=i[r];s&&Le.postRender(()=>s(t,zg(t)))}class EX extends qa{mount(){const{current:t}=this.node;t&&(this.unmount=vK(t,e=>(dM(this.node,e,"Start"),i=>dM(this.node,i,"End"))))}unmount(){}}class wX extends qa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=jg(ag(this.node.current,"focus",()=>this.onFocus()),ag(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function fM(n,t,e){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",e==="Start");const r="onTap"+(e==="End"?"":e),s=i[r];s&&Le.postRender(()=>s(t,zg(t)))}class xX extends qa{mount(){const{current:t}=this.node;t&&(this.unmount=TK(t,e=>(fM(this.node,e,"Start"),(i,{success:r})=>fM(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const xw=new WeakMap,K1=new WeakMap,TX=n=>{const t=xw.get(n.target);t&&t(n)},SX=n=>{n.forEach(TX)};function IX({root:n,...t}){const e=n||document;K1.has(e)||K1.set(e,{});const i=K1.get(e),r=JSON.stringify(t);return i[r]||(i[r]=new IntersectionObserver(SX,{root:n,...t})),i[r]}function AX(n,t,e){const i=IX(t);return xw.set(n,e),i.observe(n),()=>{xw.delete(n),i.unobserve(n)}}const RX={some:0,all:1};class PX extends qa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:i,amount:r="some",once:s}=t,o={root:e?e.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:RX[r]},a=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),m=h?d:g;m&&m(u)};return AX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:e}=this.node;["amount","margin","root"].some(CX(t,e))&&this.startObserver()}unmount(){}}function CX({viewport:n={}},{viewport:t={}}={}){return e=>n[e]!==t[e]}const MX={inView:{Feature:PX},tap:{Feature:xX},focus:{Feature:wX},hover:{Feature:EX}},bX={layout:{ProjectionNode:s3,MeasureLayout:ZN}},Tw={current:null},o3={current:!1};function kX(){if(o3.current=!0,!!PT)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),t=()=>Tw.current=n.matches;n.addListener(t),t()}else Tw.current=!1}const LX=[...bN,Hn,ja],DX=n=>LX.find(MN(n)),gM=new WeakMap;function NX(n,t,e){for(const i in t){const r=t[i],s=e[i];if(ti(r))n.addValue(i,r);else if(ti(s))n.addValue(i,sg(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,sg(o!==void 0?o:r,{owner:n}))}}for(const i in e)t[i]===void 0&&n.removeValue(i);return t}const mM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class OX{scrapeMotionValuesFromProps(t,e,i){return{}}constructor({parent:t,props:e,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=eS,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=bs.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Le.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:d}=o;this.onUpdate=d,this.latestValues=u,this.baseTarget={...u},this.initialValues=e.initial?{...u}:{},this.renderState=h,this.parent=t,this.props=e,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=hy(e),this.isVariantNode=GD(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(e,{},this);for(const v in m){const y=m[v];u[v]!==void 0&&ti(y)&&y.set(u[v],!1)}}mount(t){this.current=t,gM.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,i)=>this.bindToMotionValue(i,e)),o3.current||kX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Tw.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){gM.delete(this.current),this.projection&&this.projection.unmount(),Ua(this.notifyUpdate),Ua(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}bindToMotionValue(t,e){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=Ru.has(t),r=e.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&Le.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=e.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{r(),s(),o&&o(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ah){const e=Ah[t];if(!e)continue;const{isEnabled:i,Feature:r}=e;if(!this.features[t]&&r&&i(this.props)&&(this.features[t]=new r(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):tn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let i=0;i<mM.length;i++){const r=mM[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=t[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=NX(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const i=this.values.get(t);e!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&e!==void 0&&(i=sg(e===null?void 0:e,{owner:this}),this.addValue(t,i)),i}readValue(t,e){var i;let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(i=this.getBaseTargetFromProps(this.props,t))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(PN(r)||vN(r))?r=parseFloat(r):!DX(r)&&ja.test(e)&&(r=IN(t,e)),this.setBaseTarget(t,ti(r)?r.get():r)),ti(r)?r.get():r}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var e;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=NT(this.props,i,(e=this.presenceContext)===null||e===void 0?void 0:e.custom);o&&(r=o[t])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!ti(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new XT),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}}class a3 extends OX{constructor(){super(...arguments),this.KeyframeResolver=kN}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,{vars:e,style:i}){delete e[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ti(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function VX(n){return window.getComputedStyle(n)}class FX extends a3{constructor(){super(...arguments),this.type="html",this.renderInstance=HD}readValueFromInstance(t,e){if(Ru.has(e)){const i=tS(e);return i&&i.default||0}else{const i=VX(t),r=(WD(e)?i.getPropertyValue(e):i[e])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:e}){return XN(t,e)}build(t,e,i){FT(t,e,i.transformTemplate)}scrapeMotionValuesFromProps(t,e,i){return zT(t,e,i)}}class GX extends a3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=tn}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(Ru.has(e)){const i=tS(e);return i&&i.default||0}return e=XD.has(e)?e:kT(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,i){return QD(t,e,i)}build(t,e,i){GT(t,e,this.isSVGTag,i.transformTemplate)}renderInstance(t,e,i,r){YD(t,e,i,r)}mount(t){this.isSVGTag=jT(t.tagName),super.mount(t)}}const UX=(n,t)=>DT(n)?new GX(t):new FX(t,{allowProjection:n!==nt.Fragment}),jX=dK({...cH,...MX,...vX,...bX},UX),Qi=RW(jX);const zX=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),BX=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase()),pM=n=>{const t=BX(n);return t.charAt(0).toUpperCase()+t.slice(1)},l3=(...n)=>n.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim(),$X=n=>{for(const t in n)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var WX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const KX=nt.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},u)=>nt.createElement("svg",{ref:u,...WX,width:t,height:t,stroke:n,strokeWidth:i?Number(e)*24/Number(t):e,className:l3("lucide",r),...!s&&!$X(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,d])=>nt.createElement(h,d)),...Array.isArray(s)?s:[s]]));const _e=(n,t)=>{const e=nt.forwardRef(({className:i,...r},s)=>nt.createElement(KX,{ref:s,iconNode:t,className:l3(`lucide-${zX(pM(n))}`,`lucide-${n}`,i),...r}));return e.displayName=pM(n),e};const qX=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],HX=_e("arrow-left",qX);const XX=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],YX=_e("arrow-right",XX);const ZX=[["path",{d:"M7 17V7h10",key:"11bw93"}],["path",{d:"M17 17 7 7",key:"2786uv"}]],QX=_e("arrow-up-left",ZX);const JX=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],tY=_e("arrow-up-right",JX);const eY=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],nY=_e("arrow-up",eY);const iY=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],rY=_e("check",iY);const sY=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],oY=_e("chevron-down",sY);const aY=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],lY=_e("chevron-right",aY);const uY=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],u3=_e("chevron-up",uY);const cY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],hY=_e("circle-alert",cY);const dY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],fY=_e("circle",dY);const gY=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],mY=_e("compass",gY);const pY=[["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}],["path",{d:"M9 14 4 9l5-5",key:"102s5s"}]],_Y=_e("corner-up-left",pY);const yY=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]],vY=_e("corner-up-right",yY);const EY=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],wY=_e("folder-open",EY);const xY=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],TY=_e("folder",xY);const SY=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],c3=_e("layers",SY);const IY=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],AY=_e("loader-circle",IY);const RY=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],PY=_e("locate-fixed",RY);const CY=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],h3=_e("map-pin",CY);const MY=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],bY=_e("mountain",MY);const kY=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],sS=_e("navigation",kY);const LY=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Sw=_e("rotate-ccw",LY);const DY=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],d3=_e("search",DY);const NY=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],OY=_e("sliders-horizontal",NY);const VY=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],FY=_e("tree-palm",VY);const GY=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],UY=_e("volume-2",GY);const jY=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],zY=_e("volume-x",jY);const BY=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],$Y=_e("waves",BY);const WY=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Bg=_e("x",WY);function KY(){const{tracking:n,startTracking:t,stopTracking:e,updatePosition:i,setWatchId:r,resetFirstFix:s}=Oe(),o=nt.useCallback(u=>{i(u)},[i]),a=nt.useCallback(u=>{console.error("GPS error:",u),alert(`GPS fout: ${u.message}`),e()},[e]);return nt.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),e();return}const u=navigator.geolocation.watchPosition(o,a,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(u),()=>{navigator.geolocation.clearWatch(u)}},[n,o,a,r,e]),{tracking:n,start:t,stop:e,toggle:()=>n?e():t()}}function qY(){const{tracking:n,toggle:t}=KY();return z.jsx(Qi.button,{className:`
        fixed bottom-[30px] md:bottom-10 right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:z.jsx(PY,{size:22,strokeWidth:2})})}function HY(n="#4285F4"){const t=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
    <polygon points="20,4 32,32 20,26 8,32" fill="${n}" stroke="white" stroke-width="2.5" stroke-linejoin="round"/>
  </svg>`;return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t)}function XY(){const n=Ki(y=>y.map),t=Ki(y=>y.rotation),e=Oe(y=>y.position),i=Oe(y=>y.accuracy),r=Oe(y=>y.tracking),s=Oe(y=>y.navigationMode),o=Oe(y=>y.smoothHeading),a=Oe(y=>y.firstFix),u=Oe(y=>y.resetFirstFix),h=Oe(y=>y.config.centerOnUser),d=Oe(y=>y.config.animationDuration),g=nt.useRef(null),m=nt.useRef(null),v=nt.useRef(null);return nt.useEffect(()=>{if(!n||!r&&!e)return;const y=tu([5.1214,52.0907]);return g.current=new s0({geometry:new d0(y)}),m.current=new s0({geometry:new d0(y)}),v.current=new t4({source:new Vb({features:[m.current,g.current]}),zIndex:1e3}),n.addLayer(v.current),()=>{v.current&&n&&n.removeLayer(v.current)}},[n,r,e]),nt.useEffect(()=>{if(!n||!e||!g.current||!m.current)return;const y=tu([e.lng,e.lat]);if(g.current.getGeometry()?.setCoordinates(y),m.current.getGeometry()?.setCoordinates(y),i){const S=n.getView().getResolution()||1,w=i/S;m.current.setStyle(new Tr({image:new Ch({radius:Math.min(w,100),fill:new La({color:"rgba(66, 133, 244, 0.15)"}),stroke:new Ia({color:"#4285f4",width:2})})}))}a&&r&&(n.getView().setCenter(y),n.getView().setZoom(17),u(),console.log(" GPS locked - jumped to position + street level")),r&&h&&!a&&n.getView().animate({center:y,duration:d})},[n,r,e,i,a,u,h,d]),nt.useEffect(()=>{if(!n||!g.current)return;const S=n.getView().getRotation();let w;s==="free"?w=o!==null?o*Math.PI/180:0:w=-S,g.current.setStyle(new Tr({image:new ix({src:HY("#4285F4"),scale:1,rotation:w,rotateWithView:!1,anchor:[.5,.5]})}))},[n,s,o,t]),null}function YY(){const n=AE(e=>e.layerControlOpen),t=AE(e=>e.toggleLayerControl);return z.jsx(Qi.button,{className:`
        fixed bottom-[85px] md:bottom-[95px] right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:n?"Kaartlagen sluiten":"Kaartlagen openen",children:z.jsx(c3,{size:22,strokeWidth:2})})}function ys({title:n,children:t,defaultExpanded:e=!0}){const[i,r]=nt.useState(e);return z.jsxs("div",{className:"mb-0.5",children:[z.jsxs("button",{onClick:()=>r(!i),className:"w-full flex items-center gap-1 py-1 px-1 bg-transparent border-0 outline-none hover:bg-blue-100 transition-colors text-left",children:[z.jsx(Qi.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:z.jsx(lY,{size:14})}),i?z.jsx(wY,{size:16,className:"text-blue-500"}):z.jsx(TY,{size:16,className:"text-blue-500"}),z.jsx("span",{className:"text-sm text-gray-700 font-medium",children:n})]}),z.jsx(Au,{initial:!1,children:i&&z.jsx(Qi.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:t})})]})}function Kt({name:n,type:t}){const e=oo(d=>d.visible[n]),i=oo(d=>d.loadingState[n]),r=oo(d=>d.toggleLayer),s=oo(d=>d.setLayerVisibility),o=i==="loading",a=i==="error",u=()=>{o||(t==="overlay"?r(n):["CartoDB (licht)","OpenStreetMap","Google Hybride","TMK 1850","Bonnebladen 1900"].forEach(g=>{s(g,g===n)}))},h=e??!1;return z.jsxs("button",{onClick:u,disabled:o,className:`w-full flex items-center justify-between py-1 pl-3 pr-2 bg-transparent border-0 outline-none transition-colors text-left ${o?"opacity-70 cursor-wait":"hover:bg-blue-100"}`,children:[z.jsxs("span",{className:`text-sm ${a?"text-red-500":"text-gray-600"}`,children:[n,a&&z.jsx(hY,{size:12,className:"inline ml-1 text-red-500"})]}),z.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:o?"#93c5fd":h?"#3b82f6":"white",border:o?"2px solid #93c5fd":h?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:o?z.jsx(AY,{size:10,strokeWidth:3,className:"animate-spin"}):h?z.jsx(rY,{size:12,strokeWidth:3}):null})]})}function ZY(){const{layerControlOpen:n,toggleLayerControl:t}=AE();return z.jsx(Au,{children:n&&z.jsxs(Qi.div,{className:"fixed top-2.5 right-2.5 z-[999] bg-white rounded-lg shadow-lg overflow-hidden w-[280px] max-h-[calc(100vh-220px)] flex flex-col",initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},children:[z.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[z.jsx("span",{className:"font-medium text-sm",children:"Kaartlagen"}),z.jsx("button",{onClick:t,className:"p-0.5 rounded border-0 outline-none hover:bg-white/20 transition-colors",children:z.jsx(Bg,{size:16})})]}),z.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[z.jsxs(ys,{title:"Achtergrond",defaultExpanded:!1,children:[z.jsx(Kt,{name:"CartoDB (licht)",type:"base"}),z.jsx(Kt,{name:"OpenStreetMap",type:"base"}),z.jsx(Kt,{name:"Google Hybride",type:"base"}),z.jsx(Kt,{name:"TMK 1850",type:"base"}),z.jsx(Kt,{name:"Bonnebladen 1900",type:"base"})]}),z.jsxs(ys,{title:"Steentijd & Prehistorie",defaultExpanded:!1,children:[z.jsx(Kt,{name:"Hunebedden",type:"overlay"}),z.jsx(Kt,{name:"EUROEVOL Sites",type:"overlay"}),z.jsx(Kt,{name:"FAMKE Steentijd",type:"overlay"}),z.jsx(Kt,{name:"Grafheuvels",type:"overlay"}),z.jsx(Kt,{name:"Terpen",type:"overlay"})]}),z.jsxs(ys,{title:"Archeologische lagen",defaultExpanded:!1,children:[z.jsx(Kt,{name:"AMK Monumenten",type:"overlay"}),z.jsx(Kt,{name:"Romeinse wegen",type:"overlay"}),z.jsx(Kt,{name:"Castella (punten)",type:"overlay"}),z.jsx(Kt,{name:"Castella (lijnen)",type:"overlay"}),z.jsx(Kt,{name:"Oppida",type:"overlay"}),z.jsx(Kt,{name:"Kastelen",type:"overlay"}),z.jsx(Kt,{name:"IKAW",type:"overlay"}),z.jsx(Kt,{name:"Archeo Landschappen",type:"overlay"}),z.jsx(Kt,{name:"Archeo Onderzoeken",type:"overlay"})]}),z.jsxs(ys,{title:"Erfgoed & Monumenten",defaultExpanded:!1,children:[z.jsx(Kt,{name:"Rijksmonumenten",type:"overlay"}),z.jsx(Kt,{name:"Werelderfgoed",type:"overlay"}),z.jsx(Kt,{name:"WWII Bunkers",type:"overlay"})]}),z.jsxs(ys,{title:"Verdedigingswerken",defaultExpanded:!1,children:[z.jsx(Kt,{name:"Verdedigingslinies",type:"overlay"}),z.jsx(Kt,{name:"Militaire Objecten",type:"overlay"}),z.jsx(Kt,{name:"Inundatiegebieden",type:"overlay"})]}),z.jsxs(ys,{title:"Uiterwaarden (UIKAV)",defaultExpanded:!1,children:[z.jsx(Kt,{name:"UIKAV Punten",type:"overlay"}),z.jsx(Kt,{name:"UIKAV Vlakken",type:"overlay"}),z.jsx(Kt,{name:"UIKAV Expert",type:"overlay"}),z.jsx(Kt,{name:"UIKAV Buffer",type:"overlay"}),z.jsx(Kt,{name:"UIKAV Indeling",type:"overlay"})]}),z.jsxs(ys,{title:"Hillshade & LiDAR",defaultExpanded:!1,children:[z.jsx(Kt,{name:"AHN4 Hillshade NL",type:"overlay"}),z.jsx(Kt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),z.jsx(Kt,{name:"AHN4 Helling NL",type:"overlay"}),z.jsx(Kt,{name:"AHN 0.5m",type:"overlay"}),z.jsx(Kt,{name:"World Hillshade",type:"overlay"})]}),z.jsxs(ys,{title:"Terrein & Bodem",defaultExpanded:!1,children:[z.jsx(Kt,{name:"Veengebieden",type:"overlay"}),z.jsx(Kt,{name:"Geomorfologie",type:"overlay"}),z.jsx(Kt,{name:"Bodemkaart",type:"overlay"})]}),z.jsx(ys,{title:"Fossielen (vondsten)",defaultExpanded:!1,children:z.jsx(Kt,{name:"Fossielen Nederland",type:"overlay"})}),z.jsxs(ys,{title:"Recreatie",defaultExpanded:!1,children:[z.jsx(Kt,{name:"Parken",type:"overlay"}),z.jsx(Kt,{name:"Speeltuinen",type:"overlay"}),z.jsx(Kt,{name:"Musea",type:"overlay"}),z.jsx(Kt,{name:"Strandjes",type:"overlay"})]})]})]})})}function QY(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)n("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var pu=1,_u=2,eh=3,JY=4,Iw=5,_M=6378137,tZ=6356752314e-3,yM=.0066943799901413165,xf=484813681109536e-20,st=Math.PI/2,eZ=.16666666666666666,nZ=.04722222222222222,iZ=.022156084656084655,gt=1e-10,qe=.017453292519943295,bi=57.29577951308232,ge=Math.PI/4,lg=Math.PI*2,nn=3.14159265359,ki={};ki.greenwich=0;ki.lisbon=-9.131906111111;ki.paris=2.337229166667;ki.bogota=-74.080916666667;ki.madrid=-3.687938888889;ki.rome=12.452333333333;ki.bern=7.439583333333;ki.jakarta=106.807719444444;ki.ferro=-17.666666666667;ki.brussels=4.367975;ki.stockholm=18.058277777778;ki.athens=23.7163375;ki.oslo=10.722916666667;const rZ={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var vM=/[\s_\-\/\(\)]/g;function za(n,t){if(n[t])return n[t];for(var e=Object.keys(n),i=t.toLowerCase().replace(vM,""),r=-1,s,o;++r<e.length;)if(s=e[r],o=s.toLowerCase().replace(vM,""),o===i)return n[s]}function Aw(n){var t={},e=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,u){var h=u.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),i,r,s,o={proj:"projName",datum:"datumCode",rf:function(a){t.rf=parseFloat(a)},lat_0:function(a){t.lat0=a*qe},lat_1:function(a){t.lat1=a*qe},lat_2:function(a){t.lat2=a*qe},lat_ts:function(a){t.lat_ts=a*qe},lon_0:function(a){t.long0=a*qe},lon_1:function(a){t.long1=a*qe},lon_2:function(a){t.long2=a*qe},alpha:function(a){t.alpha=parseFloat(a)*qe},gamma:function(a){t.rectified_grid_angle=parseFloat(a)*qe},lonc:function(a){t.longc=a*qe},x_0:function(a){t.x0=parseFloat(a)},y_0:function(a){t.y0=parseFloat(a)},k_0:function(a){t.k0=parseFloat(a)},k:function(a){t.k0=parseFloat(a)},a:function(a){t.a=parseFloat(a)},b:function(a){t.b=parseFloat(a)},r:function(a){t.a=t.b=parseFloat(a)},r_a:function(){t.R_A=!0},zone:function(a){t.zone=parseInt(a,10)},south:function(){t.utmSouth=!0},towgs84:function(a){t.datum_params=a.split(",").map(function(u){return parseFloat(u)})},to_meter:function(a){t.to_meter=parseFloat(a)},units:function(a){t.units=a;var u=za(rZ,a);u&&(t.to_meter=u.to_meter)},from_greenwich:function(a){t.from_greenwich=a*qe},pm:function(a){var u=za(ki,a);t.from_greenwich=(u||parseFloat(a))*qe},nadgrids:function(a){a==="@null"?t.datumCode="none":t.nadgrids=a},axis:function(a){var u="ewnsud";a.length===3&&u.indexOf(a.substr(0,1))!==-1&&u.indexOf(a.substr(1,1))!==-1&&u.indexOf(a.substr(2,1))!==-1&&(t.axis=a)},approx:function(){t.approx=!0},over:function(){t.over=!0}};for(i in e)r=e[i],i in o?(s=o[i],typeof s=="function"?s(r):t[s]=r):t[i]=r;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t.projStr=n,t}class f3{static getId(t){const e=t.find(i=>Array.isArray(i)&&i[0]==="ID");return e&&e.length>=3?{authority:e[1],code:parseInt(e[2],10)}:null}static convertUnit(t,e="unit"){if(!t||t.length<3)return{type:e,name:"unknown",conversion_factor:null};const i=t[1],r=parseFloat(t[2])||null,s=t.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:e,name:i,conversion_factor:r,id:o}}static convertAxis(t){const e=t[1]||"Unknown";let i;const r=e.match(/^\((.)\)$/);if(r){const h=r[1].toUpperCase();if(h==="E")i="east";else if(h==="N")i="north";else if(h==="U")i="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else i=t[2]?t[2].toLowerCase():"unknown";const s=t.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=t.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),u=this.convertUnit(a);return{name:e,direction:i,unit:u,order:o}}static extractAxes(t){return t.filter(e=>Array.isArray(e)&&e[0]==="AXIS").map(e=>this.convertAxis(e)).sort((e,i)=>(e.order||0)-(i.order||0))}static convert(t,e={}){switch(t[0]){case"PROJCRS":e.type="ProjectedCRS",e.name=t[1],e.base_crs=t.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(t.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,e.conversion=t.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(t.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const i=t.find(m=>Array.isArray(m)&&m[0]==="CS");i&&(e.coordinate_system={type:i[1],axis:this.extractAxes(t)});const r=t.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(r){const m=this.convertUnit(r);e.coordinate_system.unit=m}e.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":e.type="GeographicCRS",e.name=t[1];const s=t.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?e.datum_ensemble=m:e.datum=m;const v=t.find(y=>Array.isArray(y)&&y[0]==="PRIMEM");v&&v[1]!=="Greenwich"&&(m.prime_meridian={name:v[1],longitude:parseFloat(v[2])})}e.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},e.id=this.getId(t);break;case"DATUM":e.type="GeodeticReferenceFrame",e.name=t[1],e.ellipsoid=t.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(t.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":e.type="DatumEnsemble",e.name=t[1],e.members=t.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const o=t.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");o&&(e.accuracy=parseFloat(o[1]));const a=t.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");a&&(e.ellipsoid=this.convert(a)),e.id=this.getId(t);break;case"ELLIPSOID":e.type="Ellipsoid",e.name=t[1],e.semi_major_axis=parseFloat(t[2]),e.inverse_flattening=parseFloat(t[3]),t.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(t.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),e);break;case"CONVERSION":e.type="Conversion",e.name=t[1],e.method=t.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(t.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,e.parameters=t.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":e.type="Method",e.name=t[1],e.id=this.getId(t);break;case"PARAMETER":e.type="Parameter",e.name=t[1],e.value=parseFloat(t[2]),e.unit=this.convertUnit(t.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),e.id=this.getId(t);break;case"BOUNDCRS":e.type="BoundCRS";const u=t.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(u){const m=u.find(v=>Array.isArray(v));e.source_crs=m?this.convert(m):null}const h=t.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(h){const m=h.find(v=>Array.isArray(v));e.target_crs=m?this.convert(m):null}const d=t.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");d?e.transformation=this.convert(d):e.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(e.type="Transformation",e.name=t[1],e.method=t.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(t.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,e.parameters=t.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),e.parameters.length===7){const m=e.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}e.id=this.getId(t);break;case"AXIS":e.coordinate_system||(e.coordinate_system={type:"unspecified",axis:[]}),e.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":const g=this.convertUnit(t,"LinearUnit");e.coordinate_system&&e.coordinate_system.axis&&e.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&e.semi_major_axis&&(e.semi_major_axis={value:e.semi_major_axis,unit:g});break;default:e.keyword=t[0];break}return e}}class sZ extends f3{static convert(t,e={}){return super.convert(t,e),e.coordinate_system&&e.coordinate_system.subtype==="Cartesian"&&delete e.coordinate_system,e.usage&&delete e.usage,e}}class oZ extends f3{static convert(t,e={}){super.convert(t,e);const i=t.find(s=>Array.isArray(s)&&s[0]==="CS");i&&(e.coordinate_system={subtype:i[1],axis:this.extractAxes(t)});const r=t.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(r){const s=r.find(u=>Array.isArray(u)&&u[0]==="SCOPE"),o=r.find(u=>Array.isArray(u)&&u[0]==="AREA"),a=r.find(u=>Array.isArray(u)&&u[0]==="BBOX");e.usage={},s&&(e.usage.scope=s[1]),o&&(e.usage.area=o[1]),a&&(e.usage.bbox=a.slice(1))}return e}}function aZ(n){return n.find(t=>Array.isArray(t)&&t[0]==="USAGE")?"2019":(n.find(t=>Array.isArray(t)&&t[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function lZ(n){return(aZ(n)==="2019"?oZ:sZ).convert(n)}function uZ(n){const t=n.toUpperCase();return t.includes("PROJCRS")||t.includes("GEOGCRS")||t.includes("BOUNDCRS")||t.includes("VERTCRS")||t.includes("LENGTHUNIT")||t.includes("ANGLEUNIT")||t.includes("SCALEUNIT")?"WKT2":(t.includes("PROJCS")||t.includes("GEOGCS")||t.includes("LOCAL_CS")||t.includes("VERT_CS")||t.includes("UNIT"),"WKT1")}var ug=1,g3=2,m3=3,r_=4,p3=5,oS=-1,cZ=/\s/,hZ=/[A-Za-z]/,dZ=/[A-Za-z84_]/,gy=/[,\]]/,_3=/[\d\.E\-\+]/;function Po(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=ug}Po.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==r_)for(;cZ.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case ug:return this.neutral(n);case g3:return this.keyword(n);case r_:return this.quoted(n);case p3:return this.afterquote(n);case m3:return this.number(n);case oS:return}};Po.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=r_;return}if(gy.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Po.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=ug;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=ug,this.currentObject=this.stack.pop(),this.currentObject||(this.state=oS);return}};Po.prototype.number=function(n){if(_3.test(n)){this.word+=n;return}if(gy.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Po.prototype.quoted=function(n){if(n==='"'){this.state=p3;return}this.word+=n};Po.prototype.keyword=function(n){if(dZ.test(n)){this.word+=n;return}if(n==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=ug;return}if(gy.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Po.prototype.neutral=function(n){if(hZ.test(n)){this.word=n,this.state=g3;return}if(n==='"'){this.word="",this.state=r_;return}if(_3.test(n)){this.word=n,this.state=m3;return}if(gy.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Po.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===oS)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function fZ(n){var t=new Po(n);return t.output()}function q1(n,t,e){Array.isArray(t)&&(e.unshift(t),t=null);var i=t?{}:n,r=e.reduce(function(s,o){return jc(o,s),s},i);t&&(n[t]=r)}function jc(n,t){if(!Array.isArray(n)){t[n]=!0;return}var e=n.shift();if(e==="PARAMETER"&&(e=n.shift()),n.length===1){if(Array.isArray(n[0])){t[e]={},jc(n[0],t[e]);return}t[e]=n[0];return}if(!n.length){t[e]=!0;return}if(e==="TOWGS84"){t[e]=n;return}if(e==="AXIS"){e in t||(t[e]=[]),t[e].push(n);return}Array.isArray(e)||(t[e]={});var i;switch(e){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[e]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&jc(n[2],t[e]);return;case"SPHEROID":case"ELLIPSOID":t[e]={name:n[0],a:n[1],rf:n[2]},n.length===4&&jc(n[3],t[e]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],q1(t,e,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],q1(t,e,n),t[e].type=e;return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return jc(n,t[e]);return q1(t,e,n)}}var gZ=.017453292519943295;function Gr(n){return n*gZ}function y3(n){const t=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(t==="albers conic equal area"||t==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(t==="stereographic south pole"||t==="polar stereographic (variant b)")?(n.lat0=Gr(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(t==="polar stereographic"||t==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Gr(n.lat0>0?90:-90),delete n.lat1)}function EM(n){let t={units:null,to_meter:void 0};return typeof n=="string"?(t.units=n.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.units==="meter"&&(t.to_meter=1)):n&&n.name&&(t.units=n.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.to_meter=n.conversion_factor),t}function wM(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function xM(n,t){n.ellipsoid.radius?(t.a=n.ellipsoid.radius,t.rf=0):(t.a=wM(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?t.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(t.rf=t.a/(t.a-wM(n.ellipsoid.semi_minor_axis))))}function s_(n,t={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(s_(n.source_crs,t),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?t.nadgrids=n.transformation.parameters[0].value:t.datum_params=n.transformation.parameters.map(e=>e.value)),t):(Object.keys(n).forEach(e=>{const i=n[e];if(i!==null)switch(e){case"name":if(t.srsCode)break;t.name=i,t.srsCode=i;break;case"type":i==="GeographicCRS"?t.projName="longlat":i==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(t.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(t.ellps=i.ellipsoid.name,xM(i,t)),i.prime_meridian&&(t.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":t.ellps=i.name,xM(i,t);break;case"prime_meridian":t.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis){if(t.axis=i.axis.map(r=>{const s=r.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",i.unit){const{units:r,to_meter:s}=EM(i.unit);t.units=r,t.to_meter=s}else if(i.axis[0]&&i.axis[0].unit){const{units:r,to_meter:s}=EM(i.axis[0].unit);t.units=r,t.to_meter=s}}break;case"id":i.authority&&i.code&&(t.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(t.projName=i.method.name),i.parameters&&i.parameters.forEach(r=>{const s=r.name.toLowerCase().replace(/\s+/g,"_"),o=r.value;r.unit&&r.unit.conversion_factor?t[s]=o*r.unit.conversion_factor:r.unit==="degree"?t[s]=o*Math.PI/180:t[s]=o});break;case"unit":i.name&&(t.units=i.name.toLowerCase(),t.units==="metre"&&(t.units="meter")),i.conversion_factor&&(t.to_meter=i.conversion_factor);break;case"base_crs":s_(i,t),t.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name;break}}),t.latitude_of_false_origin!==void 0&&(t.lat0=t.latitude_of_false_origin),t.longitude_of_false_origin!==void 0&&(t.long0=t.longitude_of_false_origin),t.latitude_of_standard_parallel!==void 0&&(t.lat0=t.latitude_of_standard_parallel,t.lat1=t.latitude_of_standard_parallel),t.latitude_of_1st_standard_parallel!==void 0&&(t.lat1=t.latitude_of_1st_standard_parallel),t.latitude_of_2nd_standard_parallel!==void 0&&(t.lat2=t.latitude_of_2nd_standard_parallel),t.latitude_of_projection_centre!==void 0&&(t.lat0=t.latitude_of_projection_centre),t.longitude_of_projection_centre!==void 0&&(t.longc=t.longitude_of_projection_centre),t.easting_at_false_origin!==void 0&&(t.x0=t.easting_at_false_origin),t.northing_at_false_origin!==void 0&&(t.y0=t.northing_at_false_origin),t.latitude_of_natural_origin!==void 0&&(t.lat0=t.latitude_of_natural_origin),t.longitude_of_natural_origin!==void 0&&(t.long0=t.longitude_of_natural_origin),t.longitude_of_origin!==void 0&&(t.long0=t.longitude_of_origin),t.false_easting!==void 0&&(t.x0=t.false_easting),t.easting_at_projection_centre&&(t.x0=t.easting_at_projection_centre),t.false_northing!==void 0&&(t.y0=t.false_northing),t.northing_at_projection_centre&&(t.y0=t.northing_at_projection_centre),t.standard_parallel_1!==void 0&&(t.lat1=t.standard_parallel_1),t.standard_parallel_2!==void 0&&(t.lat2=t.standard_parallel_2),t.scale_factor_at_natural_origin!==void 0&&(t.k0=t.scale_factor_at_natural_origin),t.scale_factor_at_projection_centre!==void 0&&(t.k0=t.scale_factor_at_projection_centre),t.scale_factor_on_pseudo_standard_parallel!==void 0&&(t.k0=t.scale_factor_on_pseudo_standard_parallel),t.azimuth!==void 0&&(t.alpha=t.azimuth),t.azimuth_at_projection_centre!==void 0&&(t.alpha=t.azimuth_at_projection_centre),t.angle_from_rectified_to_skew_grid&&(t.rectified_grid_angle=t.angle_from_rectified_to_skew_grid),y3(t),t)}var mZ=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function pZ(n,t){var e=t[0],i=t[1];!(e in n)&&i in n&&(n[e]=n[i],t.length===3&&(n[e]=t[2](n[e])))}function v3(n){for(var t=Object.keys(n),e=0,i=t.length;e<i;++e){var r=t[e];mZ.indexOf(r)!==-1&&_Z(n[r]),typeof n[r]=="object"&&v3(n[r])}}function _Z(n){if(n.AUTHORITY){var t=Object.keys(n.AUTHORITY)[0];t&&t in n.AUTHORITY&&(n.title=t+":"+n.AUTHORITY[t])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var e="",i=0,r=n.AXIS.length;i<r;++i){var s=[n.AXIS[i][0].toLowerCase(),n.AXIS[i][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?e+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?e+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?e+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(n.axis=e)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var o=n.GEOGCS;n.type==="GEOGCS"&&(o=n),o&&(o.DATUM?n.datumCode=o.DATUM.name.toLowerCase():n.datumCode=o.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(n.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=o.DATUM.SPHEROID.a,n.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(n.datum_params=o.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Gr(n.rectified_grid_angle));function a(d){var g=n.to_meter||1;return d*g}var u=function(d){return pZ(n,d)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Gr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Gr],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Gr],["lat0","latitude_of_origin",Gr],["lat0","standard_parallel_1",Gr],["lat1","standard_parallel_1",Gr],["lat2","standard_parallel_2",Gr],["azimuth","Azimuth"],["alpha","azimuth",Gr],["srsCode","name"]];h.forEach(u),y3(n)}function o_(n){if(typeof n=="object")return s_(n);const t=uZ(n);var e=fZ(n);if(t==="WKT2"){const s=lZ(e);return s_(s)}var i=e[0],r={};return jc(e,r),v3(r),r[i]}function Nn(n){var t=this;if(arguments.length===2){var e=arguments[1];typeof e=="string"?e.charAt(0)==="+"?Nn[n]=Aw(arguments[1]):Nn[n]=o_(arguments[1]):e&&typeof e=="object"&&!("projName"in e)?Nn[n]=o_(arguments[1]):(Nn[n]=e,e||delete Nn[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){return Array.isArray(i)?Nn.apply(t,i):Nn(i)});if(typeof n=="string"){if(n in Nn)return Nn[n]}else"EPSG"in n?Nn["EPSG:"+n.EPSG]=n:"ESRI"in n?Nn["ESRI:"+n.ESRI]=n:"IAU2000"in n?Nn["IAU2000:"+n.IAU2000]=n:console.log(n);return}}QY(Nn);function yZ(n){return typeof n=="string"}function vZ(n){return n in Nn}function EZ(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var wZ=["3857","900913","3785","102113"];function xZ(n){var t=za(n,"authority");if(t){var e=za(t,"epsg");return e&&wZ.indexOf(e)>-1}}function TZ(n){var t=za(n,"extension");if(t)return za(t,"proj4")}function SZ(n){return n[0]==="+"}function IZ(n){if(yZ(n)){if(vZ(n))return Nn[n];if(EZ(n)){var t=o_(n);if(xZ(t))return Nn["EPSG:3857"];var e=TZ(t);return e?Aw(e):t}if(SZ(n))return Aw(n)}else return"projName"in n?n:o_(n)}function TM(n,t){n=n||{};var e,i;if(!t)return n;for(i in t)e=t[i],e!==void 0&&(n[i]=e);return n}function Ds(n,t,e){var i=n*t;return e/Math.sqrt(1-i*i)}function $g(n){return n<0?-1:1}function _t(n,t){return t||Math.abs(n)<=nn?n:n-$g(n)*lg}function Hr(n,t,e){var i=n*e,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(st-t))/i}function cg(n,t){for(var e=.5*n,i,r,s=st-2*Math.atan(t),o=0;o<=15;o++)if(i=n*Math.sin(s),r=st-2*Math.atan(t*Math.pow((1-i)/(1+i),e))-s,s+=r,Math.abs(r)<=1e-10)return s;return-9999}function AZ(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function RZ(n){var t=n.x,e=n.y;if(e*bi>90&&e*bi<-90&&t*bi>180&&t*bi<-180)return null;var i,r;if(Math.abs(Math.abs(e)-st)<=gt)return null;if(this.sphere)i=this.x0+this.a*this.k0*_t(t-this.long0,this.over),r=this.y0+this.a*this.k0*Math.log(Math.tan(ge+.5*e));else{var s=Math.sin(e),o=Hr(this.e,e,s);i=this.x0+this.a*this.k0*_t(t-this.long0,this.over),r=this.y0-this.a*this.k0*Math.log(o)}return n.x=i,n.y=r,n}function PZ(n){var t=n.x-this.x0,e=n.y-this.y0,i,r;if(this.sphere)r=st-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else{var s=Math.exp(-e/(this.a*this.k0));if(r=cg(this.e,s),r===-9999)return null}return i=_t(this.long0+t/(this.a*this.k0),this.over),n.x=i,n.y=r,n}var CZ=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const MZ={init:AZ,forward:RZ,inverse:PZ,names:CZ};function bZ(){}function SM(n){return n}var E3=["longlat","identity"];const kZ={init:bZ,forward:SM,inverse:SM,names:E3};var LZ=[MZ,kZ],bl={},zc=[];function w3(n,t){var e=zc.length;return n.names?(zc[e]=n,n.names.forEach(function(i){bl[i.toLowerCase()]=e}),this):(console.log(t),!0)}function x3(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function DZ(n){if(!n)return!1;var t=n.toLowerCase();if(typeof bl[t]<"u"&&zc[bl[t]]||(t=x3(t),t in bl&&zc[bl[t]]))return zc[bl[t]]}function NZ(){LZ.forEach(w3)}const OZ={start:NZ,add:w3,get:DZ};var T3={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const VZ=T3.WGS84;function FZ(n,t,e,i){var r=n*n,s=t*t,o=(r-s)/r,a=0;i?(n*=1-o*(eZ+o*(nZ+o*iZ)),r=n*n,o=0):a=Math.sqrt(o);var u=(r-s)/s;return{es:o,e:a,ep2:u}}function GZ(n,t,e,i,r){if(!n){var s=za(T3,i);s||(s=VZ),n=s.a,t=s.b,e=s.rf}return e&&!t&&(t=(1-1/e)*n),(e===0||Math.abs(n-t)<gt)&&(r=!0,t=n),{a:n,b:t,rf:e,sphere:r}}var t0={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var UZ in t0){var H1=t0[UZ];H1.datumName&&(t0[H1.datumName]=H1)}function jZ(n,t,e,i,r,s,o){var a={};return n===void 0||n==="none"?a.datum_type=Iw:a.datum_type=JY,t&&(a.datum_params=t.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=pu),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=_u,a.datum_params[3]*=xf,a.datum_params[4]*=xf,a.datum_params[5]*=xf,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=eh,a.grids=o),a.a=e,a.b=i,a.es=r,a.ep2=s,a}var aS={};function zZ(n,t,e){return t instanceof ArrayBuffer?BZ(n,t,e):{ready:$Z(n,t)}}function BZ(n,t,e){var i=!0;e!==void 0&&e.includeErrorFields===!1&&(i=!1);var r=new DataView(t),s=qZ(r),o=HZ(r,s),a=XZ(r,o,s,i),u={header:o,subgrids:a};return aS[n]=u,u}async function $Z(n,t){for(var e=[],i=await t.getImageCount(),r=i-1;r>=0;r--){var s=await t.getImage(r),o=await s.readRasters(),a=o,u=[s.getWidth(),s.getHeight()],h=s.getBoundingBox().map(IM),d=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(IM),g=h[0]+(u[0]-1)*d[0],m=h[3]-(u[1]-1)*d[1],v=a[0],y=a[1],S=[];for(let P=u[1]-1;P>=0;P--)for(let M=u[0]-1;M>=0;M--){var w=P*u[0]+M;S.push([-wa(y[w]),wa(v[w])])}e.push({del:d,lim:u,ll:[-g,m],cvs:S})}var R={header:{nSubgrids:i},subgrids:e};return aS[n]=R,R}function WZ(n){if(n===void 0)return null;var t=n.split(",");return t.map(KZ)}function KZ(n){if(n.length===0)return null;var t=n[0]==="@";return t&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:n,mandatory:!t,grid:aS[n]||null,isNull:!1}}function IM(n){return n*Math.PI/180}function wa(n){return n/3600*Math.PI/180}function qZ(n){var t=n.getInt32(8,!1);return t===11?!1:(t=n.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function HZ(n,t){return{nFields:n.getInt32(8,t),nSubgridFields:n.getInt32(24,t),nSubgrids:n.getInt32(40,t),shiftType:Rw(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,t),fromSemiMinorAxis:n.getFloat64(136,t),toSemiMajorAxis:n.getFloat64(152,t),toSemiMinorAxis:n.getFloat64(168,t)}}function Rw(n,t,e){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(t,e)))}function XZ(n,t,e,i){for(var r=176,s=[],o=0;o<t.nSubgrids;o++){var a=ZZ(n,r,e),u=QZ(n,r,a,e,i),h=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),d=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[wa(a.lowerLongitude),wa(a.lowerLatitude)],del:[wa(a.longitudeInterval),wa(a.latitudeInterval)],lim:[h,d],count:a.gridNodeCount,cvs:YZ(u)});var g=16;i===!1&&(g=8),r+=176+a.gridNodeCount*g}return s}function YZ(n){return n.map(function(t){return[wa(t.longitudeShift),wa(t.latitudeShift)]})}function ZZ(n,t,e){return{name:Rw(n,t+8,t+16).trim(),parent:Rw(n,t+24,t+24+8).trim(),lowerLatitude:n.getFloat64(t+72,e),upperLatitude:n.getFloat64(t+88,e),lowerLongitude:n.getFloat64(t+104,e),upperLongitude:n.getFloat64(t+120,e),latitudeInterval:n.getFloat64(t+136,e),longitudeInterval:n.getFloat64(t+152,e),gridNodeCount:n.getInt32(t+168,e)}}function QZ(n,t,e,i,r){var s=t+176,o=16;r===!1&&(o=8);for(var a=[],u=0;u<e.gridNodeCount;u++){var h={latitudeShift:n.getFloat32(s+u*o,i),longitudeShift:n.getFloat32(s+u*o+4,i)};r!==!1&&(h.latitudeAccuracy=n.getFloat32(s+u*o+8,i),h.longitudeAccuracy=n.getFloat32(s+u*o+12,i)),a.push(h)}return a}function Ir(n,t){if(!(this instanceof Ir))return new Ir(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,t=t||function(h){if(h)throw h};var e=IZ(n);if(typeof e!="object"){t("Could not parse to valid json: "+n);return}var i=Ir.projections.get(e.projName);if(!i){t("Could not get projection name from: "+n);return}if(e.datumCode&&e.datumCode!=="none"){var r=za(t0,e.datumCode);r&&(e.datum_params=e.datum_params||(r.towgs84?r.towgs84.split(","):null),e.ellps=r.ellipse,e.datumName=r.datumName?r.datumName:e.datumCode)}e.k0=e.k0||1,e.axis=e.axis||"enu",e.ellps=e.ellps||"wgs84",e.lat1=e.lat1||e.lat0;var s=GZ(e.a,e.b,e.rf,e.ellps,e.sphere),o=FZ(s.a,s.b,s.rf,e.R_A),a=WZ(e.nadgrids),u=e.datum||jZ(e.datumCode,e.datum_params,s.a,s.b,o.es,o.ep2,a);TM(this,e),TM(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=u,"init"in this&&typeof this.init=="function"&&this.init(),t(null,this)}Ir.projections=OZ;Ir.projections.start();function JZ(n,t){return n.datum_type!==t.datum_type||n.a!==t.a||Math.abs(n.es-t.es)>5e-11?!1:n.datum_type===pu?n.datum_params[0]===t.datum_params[0]&&n.datum_params[1]===t.datum_params[1]&&n.datum_params[2]===t.datum_params[2]:n.datum_type===_u?n.datum_params[0]===t.datum_params[0]&&n.datum_params[1]===t.datum_params[1]&&n.datum_params[2]===t.datum_params[2]&&n.datum_params[3]===t.datum_params[3]&&n.datum_params[4]===t.datum_params[4]&&n.datum_params[5]===t.datum_params[5]&&n.datum_params[6]===t.datum_params[6]:!0}function S3(n,t,e){var i=n.x,r=n.y,s=n.z?n.z:0,o,a,u,h;if(r<-st&&r>-1.001*st)r=-st;else if(r>st&&r<1.001*st)r=st;else{if(r<-st)return{x:-1/0,y:-1/0,z:n.z};if(r>st)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(r),h=Math.cos(r),u=a*a,o=e/Math.sqrt(1-t*u),{x:(o+s)*h*Math.cos(i),y:(o+s)*h*Math.sin(i),z:(o*(1-t)+s)*a}}function I3(n,t,e,i){var r=1e-12,s=r*r,o=30,a,u,h,d,g,m,v,y,S,w,R,P,M,L=n.x,D=n.y,j=n.z?n.z:0,b,A,k;if(a=Math.sqrt(L*L+D*D),u=Math.sqrt(L*L+D*D+j*j),a/e<r){if(b=0,u/e<r)return A=st,k=-i,{x:n.x,y:n.y,z:n.z}}else b=Math.atan2(D,L);h=j/u,d=a/u,g=1/Math.sqrt(1-t*(2-t)*d*d),y=d*(1-t)*g,S=h*g,M=0;do M++,v=e/Math.sqrt(1-t*S*S),k=a*y+j*S-v*(1-t*S*S),m=t*v/(v+k),g=1/Math.sqrt(1-m*(2-m)*d*d),w=d*(1-m)*g,R=h*g,P=R*y-w*S,y=w,S=R;while(P*P>s&&M<o);return A=Math.atan(R/Math.abs(w)),{x:b,y:A,z:k}}function tQ(n,t,e){if(t===pu)return{x:n.x+e[0],y:n.y+e[1],z:n.z+e[2]};if(t===_u){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5],h=e[6];return{x:h*(n.x-u*n.y+a*n.z)+i,y:h*(u*n.x+n.y-o*n.z)+r,z:h*(-a*n.x+o*n.y+n.z)+s}}}function eQ(n,t,e){if(t===pu)return{x:n.x-e[0],y:n.y-e[1],z:n.z-e[2]};if(t===_u){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5],h=e[6],d=(n.x-i)/h,g=(n.y-r)/h,m=(n.z-s)/h;return{x:d+u*g-a*m,y:-u*d+g+o*m,z:a*d-o*g+m}}}function Mp(n){return n===pu||n===_u}function nQ(n,t,e){if(JZ(n,t)||n.datum_type===Iw||t.datum_type===Iw)return e;var i=n.a,r=n.es;if(n.datum_type===eh){var s=AM(n,!1,e);if(s!==0)return;i=_M,r=yM}var o=t.a,a=t.b,u=t.es;if(t.datum_type===eh&&(o=_M,a=tZ,u=yM),r===u&&i===o&&!Mp(n.datum_type)&&!Mp(t.datum_type))return e;if(e=S3(e,r,i),Mp(n.datum_type)&&(e=tQ(e,n.datum_type,n.datum_params)),Mp(t.datum_type)&&(e=eQ(e,t.datum_type,t.datum_params)),e=I3(e,u,o,a),t.datum_type===eh){var h=AM(t,!0,e);if(h!==0)return}return e}function AM(n,t,e){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-e.x,y:e.y},r={x:Number.NaN,y:Number.NaN},s=[];t:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var u=a.grid.subgrids,h=0,d=u.length;h<d;h++){var g=u[h],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,v=g.ll[0]-m,y=g.ll[1]-m,S=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,w=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(y>i.y||v>i.x||w<i.y||S<i.x)&&(r=iQ(i,t,g),!isNaN(r.x)))break t}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*bi+" "+i.y*bi+" tried: '"+s+"'"),-1):(e.x=-r.x,e.y=r.y,0)}function iQ(n,t,e){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=e.ll[0],r.y-=e.ll[1],r.x=_t(r.x-Math.PI)+Math.PI;var s=RM(r,e);if(t){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o=9,a=1e-12,u,h;do{if(h=RM(s,e),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}u={x:r.x-(h.x+s.x),y:r.y-(h.y+s.y)},s.x+=u.x,s.y+=u.y}while(o--&&Math.abs(u.x)>a&&Math.abs(u.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=_t(s.x+e.ll[0]),i.y=s.y+e.ll[1]}else isNaN(s.x)||(i.x=n.x+s.x,i.y=n.y+s.y);return i}function RM(n,t){var e={x:n.x/t.del[0],y:n.y/t.del[1]},i={x:Math.floor(e.x),y:Math.floor(e.y)},r={x:e.x-1*i.x,y:e.y-1*i.y},s={x:Number.NaN,y:Number.NaN},o;if(i.x<0||i.x>=t.lim[0]||i.y<0||i.y>=t.lim[1])return s;o=i.y*t.lim[0]+i.x;var a={x:t.cvs[o][0],y:t.cvs[o][1]};o++;var u={x:t.cvs[o][0],y:t.cvs[o][1]};o+=t.lim[0];var h={x:t.cvs[o][0],y:t.cvs[o][1]};o--;var d={x:t.cvs[o][0],y:t.cvs[o][1]},g=r.x*r.y,m=r.x*(1-r.y),v=(1-r.x)*(1-r.y),y=(1-r.x)*r.y;return s.x=v*a.x+m*u.x+y*d.x+g*h.x,s.y=v*a.y+m*u.y+y*d.y+g*h.y,s}function PM(n,t,e){var i=e.x,r=e.y,s=e.z||0,o,a,u,h={};for(u=0;u<3;u++)if(!(t&&u===2&&e.z===void 0))switch(u===0?(o=i,"ew".indexOf(n.axis[u])!==-1?a="x":a="y"):u===1?(o=r,"ns".indexOf(n.axis[u])!==-1?a="y":a="x"):(o=s,a="z"),n.axis[u]){case"e":h[a]=o;break;case"w":h[a]=-o;break;case"n":h[a]=o;break;case"s":h[a]=-o;break;case"u":e[a]!==void 0&&(h.z=o);break;case"d":e[a]!==void 0&&(h.z=-o);break;default:return null}return h}function A3(n){var t={x:n[0],y:n[1]};return n.length>2&&(t.z=n[2]),n.length>3&&(t.m=n[3]),t}function rQ(n){CM(n.x),CM(n.y)}function CM(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function sQ(n,t){return(n.datum.datum_type===pu||n.datum.datum_type===_u||n.datum.datum_type===eh)&&t.datumCode!=="WGS84"||(t.datum.datum_type===pu||t.datum.datum_type===_u||t.datum.datum_type===eh)&&n.datumCode!=="WGS84"}function a_(n,t,e,i){var r;Array.isArray(e)?e=A3(e):e={x:e.x,y:e.y,z:e.z,m:e.m};var s=e.z!==void 0;if(rQ(e),n.datum&&t.datum&&sQ(n,t)&&(r=new Ir("WGS84"),e=a_(n,r,e,i),n=r),i&&n.axis!=="enu"&&(e=PM(n,!1,e)),n.projName==="longlat")e={x:e.x*qe,y:e.y*qe,z:e.z||0};else if(n.to_meter&&(e={x:e.x*n.to_meter,y:e.y*n.to_meter,z:e.z||0}),e=n.inverse(e),!e)return;if(n.from_greenwich&&(e.x+=n.from_greenwich),e=nQ(n.datum,t.datum,e),!!e)return e=e,t.from_greenwich&&(e={x:e.x-t.from_greenwich,y:e.y,z:e.z||0}),t.projName==="longlat"?e={x:e.x*bi,y:e.y*bi,z:e.z||0}:(e=t.forward(e),t.to_meter&&(e={x:e.x/t.to_meter,y:e.y/t.to_meter,z:e.z||0})),i&&t.axis!=="enu"?PM(t,!0,e):(e&&!s&&delete e.z,e)}var MM=Ir("WGS84");function X1(n,t,e,i){var r,s,o;return Array.isArray(e)?(r=a_(n,t,e,i)||{x:NaN,y:NaN},e.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(e.slice(3)):[r.x,r.y,e[2]].concat(e.slice(3)):[r.x,r.y].concat(e.slice(2)):[r.x,r.y]):(s=a_(n,t,e,i),o=Object.keys(e),o.length===2||o.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=e[a]}),s)}function bp(n){return n instanceof Ir?n:typeof n=="object"&&"oProj"in n?n.oProj:Ir(n)}function oQ(n,t,e){var i,r,s=!1,o;return typeof t>"u"?(r=bp(n),i=MM,s=!0):(typeof t.x<"u"||Array.isArray(t))&&(e=t,r=bp(n),i=MM,s=!0),i||(i=bp(n)),r||(r=bp(t)),e?X1(i,r,e):(o={forward:function(a,u){return X1(i,r,a,u)},inverse:function(a,u){return X1(r,i,a,u)}},s&&(o.oProj=r),o)}var bM=6,R3="AJSAJS",P3="AFAFAF",Bc=65,xi=73,pr=79,nf=86,rf=90;const aQ={forward:C3,inverse:lQ,toPoint:M3};function C3(n,t){return t=t||5,hQ(uQ({lat:n[1],lon:n[0]}),t)}function lQ(n){var t=lS(k3(n.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function M3(n){var t=lS(k3(n.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function Y1(n){return n*(Math.PI/180)}function kM(n){return 180*(n/Math.PI)}function uQ(n){var t=n.lat,e=n.lon,i=6378137,r=.00669438,s=.9996,o,a,u,h,d,g,m,v=Y1(t),y=Y1(e),S,w;w=Math.floor((e+180)/6)+1,e===180&&(w=60),t>=56&&t<64&&e>=3&&e<12&&(w=32),t>=72&&t<84&&(e>=0&&e<9?w=31:e>=9&&e<21?w=33:e>=21&&e<33?w=35:e>=33&&e<42&&(w=37)),o=(w-1)*6-180+3,S=Y1(o),a=r/(1-r),u=i/Math.sqrt(1-r*Math.sin(v)*Math.sin(v)),h=Math.tan(v)*Math.tan(v),d=a*Math.cos(v)*Math.cos(v),g=Math.cos(v)*(y-S),m=i*((1-r/4-3*r*r/64-5*r*r*r/256)*v-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*v)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*v)-35*r*r*r/3072*Math.sin(6*v));var R=s*u*(g+(1-h+d)*g*g*g/6+(5-18*h+h*h+72*d-58*a)*g*g*g*g*g/120)+5e5,P=s*(m+u*Math.tan(v)*(g*g/2+(5-h+9*d+4*d*d)*g*g*g*g/24+(61-58*h+h*h+600*d-330*a)*g*g*g*g*g*g/720));return t<0&&(P+=1e7),{northing:Math.round(P),easting:Math.round(R),zoneNumber:w,zoneLetter:cQ(t)}}function lS(n){var t=n.northing,e=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var s=.9996,o=6378137,a=.00669438,u,h=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),d,g,m,v,y,S,w,R,P,M=e-5e5,L=t;i<"N"&&(L-=1e7),w=(r-1)*6-180+3,u=a/(1-a),S=L/s,R=S/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),P=R+(3*h/2-27*h*h*h/32)*Math.sin(2*R)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*R)+151*h*h*h/96*Math.sin(6*R),d=o/Math.sqrt(1-a*Math.sin(P)*Math.sin(P)),g=Math.tan(P)*Math.tan(P),m=u*Math.cos(P)*Math.cos(P),v=o*(1-a)/Math.pow(1-a*Math.sin(P)*Math.sin(P),1.5),y=M/(d*s);var D=P-d*Math.tan(P)/v*(y*y/2-(5+3*g+10*m-4*m*m-9*u)*y*y*y*y/24+(61+90*g+298*m+45*g*g-252*u-3*m*m)*y*y*y*y*y*y/720);D=kM(D);var j=(y-(1+2*g+m)*y*y*y/6+(5-2*m+28*g-3*m*m+8*u+24*g*g)*y*y*y*y*y/120)/Math.cos(P);j=w+kM(j);var b;if(n.accuracy){var A=lS({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});b={top:A.lat,right:A.lon,bottom:D,left:j}}else b={lat:D,lon:j};return b}function cQ(n){var t="Z";return 84>=n&&n>=72?t="X":72>n&&n>=64?t="W":64>n&&n>=56?t="V":56>n&&n>=48?t="U":48>n&&n>=40?t="T":40>n&&n>=32?t="S":32>n&&n>=24?t="R":24>n&&n>=16?t="Q":16>n&&n>=8?t="P":8>n&&n>=0?t="N":0>n&&n>=-8?t="M":-8>n&&n>=-16?t="L":-16>n&&n>=-24?t="K":-24>n&&n>=-32?t="J":-32>n&&n>=-40?t="H":-40>n&&n>=-48?t="G":-48>n&&n>=-56?t="F":-56>n&&n>=-64?t="E":-64>n&&n>=-72?t="D":-72>n&&n>=-80&&(t="C"),t}function hQ(n,t){var e="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+dQ(n.easting,n.northing,n.zoneNumber)+e.substr(e.length-5,t)+i.substr(i.length-5,t)}function dQ(n,t,e){var i=b3(e),r=Math.floor(n/1e5),s=Math.floor(t/1e5)%20;return fQ(r,s,i)}function b3(n){var t=n%bM;return t===0&&(t=bM),t}function fQ(n,t,e){var i=e-1,r=R3.charCodeAt(i),s=P3.charCodeAt(i),o=r+n-1,a=s+t,u=!1;o>rf&&(o=o-rf+Bc-1,u=!0),(o===xi||r<xi&&o>xi||(o>xi||r<xi)&&u)&&o++,(o===pr||r<pr&&o>pr||(o>pr||r<pr)&&u)&&(o++,o===xi&&o++),o>rf&&(o=o-rf+Bc-1),a>nf?(a=a-nf+Bc-1,u=!0):u=!1,(a===xi||s<xi&&a>xi||(a>xi||s<xi)&&u)&&a++,(a===pr||s<pr&&a>pr||(a>pr||s<pr)&&u)&&(a++,a===xi&&a++),a>nf&&(a=a-nf+Bc-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function k3(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var t=n.length,e=null,i="",r,s=0;!/[A-Z]/.test(r=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,s++}var o=parseInt(i,10);if(s===0||s+3>t)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;e=n.substring(s,s+=2);for(var u=b3(o),h=gQ(e.charAt(0),u),d=mQ(e.charAt(1),u);d<pQ(a);)d+=2e6;var g=t-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,v=0,y=0,S,w,R,P,M;return m>0&&(S=1e5/Math.pow(10,m),w=n.substring(s,s+m),v=parseFloat(w)*S,R=n.substring(s+m),y=parseFloat(R)*S),P=v+h,M=y+d,{easting:P,northing:M,zoneLetter:a,zoneNumber:o,accuracy:S}}function gQ(n,t){for(var e=R3.charCodeAt(t-1),i=1e5,r=!1;e!==n.charCodeAt(0);){if(e++,e===xi&&e++,e===pr&&e++,e>rf){if(r)throw"Bad character: "+n;e=Bc,r=!0}i+=1e5}return i}function mQ(n,t){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var e=P3.charCodeAt(t-1),i=0,r=!1;e!==n.charCodeAt(0);){if(e++,e===xi&&e++,e===pr&&e++,e>nf){if(r)throw"Bad character: "+n;e=Bc,r=!0}i+=1e5}return i}function pQ(n){var t;switch(n){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+n}function Ph(n,t,e){if(!(this instanceof Ph))return new Ph(n,t,e);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof t>"u"){var i=n.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=n,this.y=t,this.z=e||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ph.fromMGRS=function(n){return new Ph(M3(n))};Ph.prototype.toMGRS=function(n){return C3([this.x,this.y],n)};var _Q=1,yQ=.25,LM=.046875,DM=.01953125,NM=.01068115234375,vQ=.75,EQ=.46875,wQ=.013020833333333334,xQ=.007120768229166667,TQ=.3645833333333333,SQ=.005696614583333333,IQ=.3076171875;function uS(n){var t=[];t[0]=_Q-n*(yQ+n*(LM+n*(DM+n*NM))),t[1]=n*(vQ-n*(LM+n*(DM+n*NM)));var e=n*n;return t[2]=e*(EQ-n*(wQ+n*xQ)),e*=n,t[3]=e*(TQ-n*SQ),t[4]=e*n*IQ,t}function Gh(n,t,e,i){return e*=t,t*=t,i[0]*n-e*(i[1]+t*(i[2]+t*(i[3]+t*i[4])))}var AQ=20;function cS(n,t,e){for(var i=1/(1-t),r=n,s=AQ;s;--s){var o=Math.sin(r),a=1-t*o*o;if(a=(Gh(r,o,Math.cos(r),e)-n)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<gt)return r}return r}function RQ(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=uS(this.es),this.ml0=Gh(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function PQ(n){var t=n.x,e=n.y,i=_t(t-this.long0,this.over),r,s,o,a=Math.sin(e),u=Math.cos(e);if(this.es){var d=u*i,g=Math.pow(d,2),m=this.ep2*Math.pow(u,2),v=Math.pow(m,2),y=Math.abs(u)>gt?Math.tan(e):0,S=Math.pow(y,2),w=Math.pow(S,2);r=1-this.es*Math.pow(a,2),d=d/Math.sqrt(r);var R=Gh(e,a,u,this.en);s=this.a*(this.k0*d*(1+g/6*(1-S+m+g/20*(5-18*S+w+14*m-58*S*m+g/42*(61+179*w-w*S-479*S)))))+this.x0,o=this.a*(this.k0*(R-this.ml0+a*i*d/2*(1+g/12*(5-S+9*m+4*v+g/30*(61+w-58*S+270*m-330*S*m+g/56*(1385+543*w-w*S-3111*S))))))+this.y0}else{var h=u*Math.sin(i);if(Math.abs(Math.abs(h)-1)<gt)return 93;if(s=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=u*Math.cos(i)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>gt)return 93;o=0}else o=Math.acos(o);e<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return n.x=s,n.y=o,n}function CQ(n){var t,e,i,r,s=(n.x-this.x0)*(1/this.a),o=(n.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+o/this.k0,e=cS(t,this.es,this.en),Math.abs(e)<st){var g=Math.sin(e),m=Math.cos(e),v=Math.abs(m)>gt?Math.tan(e):0,y=this.ep2*Math.pow(m,2),S=Math.pow(y,2),w=Math.pow(v,2),R=Math.pow(w,2);t=1-this.es*Math.pow(g,2);var P=s*Math.sqrt(t)/this.k0,M=Math.pow(P,2);t=t*v,i=e-t*M/(1-this.es)*.5*(1-M/12*(5+3*w-9*y*w+y-4*S-M/30*(61+90*w-252*y*w+45*R+46*y-M/56*(1385+3633*w+4095*R+1574*R*w)))),r=_t(this.long0+P*(1-M/6*(1+2*w+y-M/20*(5+28*w+24*R+8*y*w+6*y-M/42*(61+662*w+1320*R+720*R*w))))/m,this.over)}else i=st*$g(o),r=0;else{var a=Math.exp(s/this.k0),u=.5*(a-1/a),h=this.lat0+o/this.k0,d=Math.cos(h);t=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(u,2))),i=Math.asin(t),o<0&&(i=-i),u===0&&d===0?r=0:r=_t(Math.atan2(u,d)+this.long0,this.over)}return n.x=r,n.y=i,n}var MQ=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const e0={init:RQ,forward:PQ,inverse:CQ,names:MQ};function L3(n){var t=Math.exp(n);return t=(t-1/t)/2,t}function Pi(n,t){n=Math.abs(n),t=Math.abs(t);var e=Math.max(n,t),i=Math.min(n,t)/(e||1);return e*Math.sqrt(1+Math.pow(i,2))}function bQ(n){var t=1+n,e=t-1;return e===0?n:n*Math.log(t)/e}function kQ(n){var t=Math.abs(n);return t=bQ(t*(1+t/(Pi(1,t)+1))),n<0?-t:t}function hS(n,t){for(var e=2*Math.cos(2*t),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+e*r+n[i],s=r,r=o;return t+o*Math.sin(2*t)}function LQ(n,t){for(var e=2*Math.cos(t),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+e*r+n[i],s=r,r=o;return Math.sin(t)*o}function DQ(n){var t=Math.exp(n);return t=(t+1/t)/2,t}function D3(n,t,e){for(var i=Math.sin(t),r=Math.cos(t),s=L3(e),o=DQ(e),a=2*r*o,u=-2*i*s,h=n.length-1,d=n[h],g=0,m=0,v=0,y,S;--h>=0;)y=m,S=g,m=d,g=v,d=-y+a*m-u*g+n[h],v=-S+u*m+a*g;return a=i*o,u=r*s,[a*d-u*v,a*v+u*d]}function NQ(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(e0.init.apply(this),this.forward=e0.forward,this.inverse=e0.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),t=n/(2-n),e=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),e=e*t,this.cgb[1]=e*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=e*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),e=e*t,this.cgb[2]=e*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=e*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),e=e*t,this.cgb[3]=e*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=e*(1237/630+t*(-12/5+t*(-24832/14175))),e=e*t,this.cgb[4]=e*(4174/315+t*(-144838/6237)),this.cbg[4]=e*(-734/315+t*(109598/31185)),e=e*t,this.cgb[5]=e*(601676/22275),this.cbg[5]=e*(444337/155925),e=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+e*(1/4+e*(1/64+e/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=e*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=e*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),e=e*t,this.utg[2]=e*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=e*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),e=e*t,this.utg[3]=e*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=e*(49561/161280+t*(-179/168+t*(6601661/7257600))),e=e*t,this.utg[4]=e*(-4583/161280+t*(108847/3991680)),this.gtu[4]=e*(34729/80640+t*(-3418889/1995840)),e=e*t,this.utg[5]=e*(-20648693/638668800),this.gtu[5]=e*(212378941/319334400);var i=hS(this.cbg,this.lat0);this.Zb=-this.Qn*(i+LQ(this.gtu,2*i))}function OQ(n){var t=_t(n.x-this.long0,this.over),e=n.y;e=hS(this.cbg,e);var i=Math.sin(e),r=Math.cos(e),s=Math.sin(t),o=Math.cos(t);e=Math.atan2(i,o*r),t=Math.atan2(s*r,Pi(i,r*o)),t=kQ(Math.tan(t));var a=D3(this.gtu,2*e,2*t);e=e+a[0],t=t+a[1];var u,h;return Math.abs(t)<=2.623395162778?(u=this.a*(this.Qn*t)+this.x0,h=this.a*(this.Qn*e+this.Zb)+this.y0):(u=1/0,h=1/0),n.x=u,n.y=h,n}function VQ(n){var t=(n.x-this.x0)*(1/this.a),e=(n.y-this.y0)*(1/this.a);e=(e-this.Zb)/this.Qn,t=t/this.Qn;var i,r;if(Math.abs(t)<=2.623395162778){var s=D3(this.utg,2*e,2*t);e=e+s[0],t=t+s[1],t=Math.atan(L3(t));var o=Math.sin(e),a=Math.cos(e),u=Math.sin(t),h=Math.cos(t);e=Math.atan2(o*h,Pi(u,h*a)),t=Math.atan2(u,h*a),i=_t(t+this.long0,this.over),r=hS(this.cgb,e)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var FQ=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const n0={init:NQ,forward:OQ,inverse:VQ,names:FQ};function GQ(n,t){if(n===void 0){if(n=Math.floor((_t(t)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var UQ="etmerc";function jQ(){var n=GQ(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*qe,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,n0.init.apply(this),this.forward=n0.forward,this.inverse=n0.inverse}var zQ=["Universal Transverse Mercator System","utm"];const BQ={init:jQ,names:zQ,dependsOn:UQ};function dS(n,t){return Math.pow((1-n)/(1+n),t)}var $Q=20;function WQ(){var n=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ge)/(Math.pow(Math.tan(.5*this.lat0+ge),this.C)*dS(this.e*n,this.ratexp))}function KQ(n){var t=n.x,e=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*e+ge),this.C)*dS(this.e*Math.sin(e),this.ratexp))-st,n.x=this.C*t,n}function qQ(n){for(var t=1e-14,e=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+ge)/this.K,1/this.C),s=$Q;s>0&&(i=2*Math.atan(r*dS(this.e*Math.sin(n.y),-.5*this.e))-st,!(Math.abs(i-n.y)<t));--s)n.y=i;return s?(n.x=e,n.y=i,n):null}const fS={init:WQ,forward:KQ,inverse:qQ};function HQ(){fS.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function XQ(n){var t,e,i,r;return n.x=_t(n.x-this.long0,this.over),fS.forward.apply(this,[n]),t=Math.sin(n.y),e=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*e*i),n.x=r*e*Math.sin(n.x),n.y=r*(this.cosc0*t-this.sinc0*e*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function YQ(n){var t,e,i,r,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Pi(n.x,n.y)){var o=2*Math.atan2(s,this.R2);t=Math.sin(o),e=Math.cos(o),r=Math.asin(e*this.sinc0+n.y*t*this.cosc0/s),i=Math.atan2(n.x*t,s*this.cosc0*e-n.y*this.sinc0*t)}else r=this.phic0,i=0;return n.x=i,n.y=r,fS.inverse.apply(this,[n]),n.x=_t(n.x+this.long0,this.over),n}var ZQ=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const QQ={init:HQ,forward:XQ,inverse:YQ,names:ZQ};function gS(n,t,e){return t*=e,Math.tan(.5*(st+n))*Math.pow((1-t)/(1+t),.5*e)}function JQ(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=gt&&(this.k0=.5*(1+$g(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=gt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=gt&&Math.abs(Math.cos(this.lat_ts))>gt&&(this.k0=.5*this.cons*Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Hr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ds(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(gS(this.lat0,this.sinlat0,this.e))-st,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function tJ(n){var t=n.x,e=n.y,i=Math.sin(e),r=Math.cos(e),s,o,a,u,h,d,g=_t(t-this.long0,this.over);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=gt&&Math.abs(e+this.lat0)<=gt?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(g)),n.x=this.a*s*r*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*i-this.sinlat0*r*Math.cos(g))+this.y0,n):(o=2*Math.atan(gS(e,i,this.e))-st,u=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=gt?(h=Hr(this.e,e*this.con,this.con*i),d=2*this.a*this.k0*h/this.cons,n.x=this.x0+d*Math.sin(t-this.long0),n.y=this.y0-this.con*d*Math.cos(t-this.long0),n):(Math.abs(this.sinlat0)<gt?(s=2*this.a*this.k0/(1+u*Math.cos(g)),n.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*u*Math.cos(g))),n.y=s*(this.cosX0*a-this.sinX0*u*Math.cos(g))+this.y0),n.x=s*u*Math.sin(g)+this.x0,n))}function eJ(n){n.x-=this.x0,n.y-=this.y0;var t,e,i,r,s,o=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return t=this.long0,e=this.lat0,o<=gt?(n.x=t,n.y=e,n):(e=Math.asin(Math.cos(a)*this.sinlat0+n.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<gt?this.lat0>0?t=_t(this.long0+Math.atan2(n.x,-1*n.y),this.over):t=_t(this.long0+Math.atan2(n.x,n.y),this.over):t=_t(this.long0+Math.atan2(n.x*Math.sin(a),o*this.coslat0*Math.cos(a)-n.y*this.sinlat0*Math.sin(a)),this.over),n.x=t,n.y=e,n)}else if(Math.abs(this.coslat0)<=gt){if(o<=gt)return e=this.lat0,t=this.long0,n.x=t,n.y=e,n;n.x*=this.con,n.y*=this.con,i=o*this.cons/(2*this.a*this.k0),e=this.con*cg(this.e,i),t=this.con*_t(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,o<=gt?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/o),t=_t(this.long0+Math.atan2(n.x*Math.sin(r),o*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)),this.over)),e=-1*cg(this.e,Math.tan(.5*(st+s)));return n.x=t,n.y=e,n}var nJ=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const iJ={init:JQ,forward:tJ,inverse:eJ,names:nJ,ssfn_:gS};function rJ(){var n=this.lat0;this.lambda0=this.long0;var t=Math.sin(n),e=this.a,i=this.rf,r=1/i,s=2*r-Math.pow(r,2),o=this.e=Math.sqrt(s);this.R=this.k0*e*Math.sqrt(1-s)/(1-s*Math.pow(t,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(t/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+n/2)),h=Math.log((1+o*t)/(1-o*t));this.K=a-this.alpha*u+this.alpha*o/2*h}function sJ(n){var t=Math.log(Math.tan(Math.PI/4-n.y/2)),e=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(t+e)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,n.x=this.R*o+this.x0,n}function oJ(n){for(var t=n.x-this.x0,e=n.y-this.y0,i=t/this.R,r=2*(Math.atan(Math.exp(e/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,u=0,h=s,d=-1e3,g=0;Math.abs(h-d)>1e-7;){if(++g>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),d=h,h=2*Math.atan(Math.exp(u))-Math.PI/2}return n.x=a,n.y=h,n}var aJ=["somerc"];const lJ={init:rJ,forward:sJ,inverse:oJ,names:aJ};var Lc=1e-7;function uJ(n){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],e=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||t.indexOf(e)!==-1||t.indexOf(x3(e))!==-1}function cJ(){var n,t,e,i,r,s,o,a,u,h,d=0,g,m=0,v=0,y=0,S=0,w=0,R=0;this.no_off=uJ(this),this.no_rot="no_rot"in this;var P=!1;"alpha"in this&&(P=!0);var M=!1;if("rectified_grid_angle"in this&&(M=!0),P&&(R=this.alpha),M&&(d=this.rectified_grid_angle),P||M)m=this.longc;else if(v=this.long1,S=this.lat1,y=this.long2,w=this.lat2,Math.abs(S-w)<=Lc||(n=Math.abs(S))<=Lc||Math.abs(n-st)<=Lc||Math.abs(Math.abs(this.lat0)-st)<=Lc||Math.abs(Math.abs(w)-st)<=Lc)throw new Error;var L=1-this.es;t=Math.sqrt(L),Math.abs(this.lat0)>gt?(a=Math.sin(this.lat0),e=Math.cos(this.lat0),n=1-this.es*a*a,this.B=e*e,this.B=Math.sqrt(1+this.es*this.B*this.B/L),this.A=this.B*this.k0*t/n,i=this.B*t/(e*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Hr(this.e,this.lat0,a),this.B)):(this.B=1/t,this.A=this.k0,this.E=i=r=1),P||M?(P?(g=Math.asin(Math.sin(R)/i),M||(d=R)):(g=d,R=Math.asin(i*Math.sin(g))),this.lam0=m-Math.asin(.5*(r-1/r)*Math.tan(g))/this.B):(s=Math.pow(Hr(this.e,S,Math.sin(S)),this.B),o=Math.pow(Hr(this.e,w,Math.sin(w)),this.B),r=this.E/s,u=(o-s)/(o+s),h=this.E*this.E,h=(h-o*s)/(h+o*s),n=v-y,n<-Math.PI?y-=lg:n>Math.PI&&(y+=lg),this.lam0=_t(.5*(v+y)-Math.atan(h*Math.tan(.5*this.B*(v-y))/u)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*_t(v-this.lam0,this.over))/(r-1/r)),d=R=Math.asin(i*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(R))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(ge-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(ge+r))}function hJ(n){var t={},e,i,r,s,o,a,u,h;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-st)>gt){if(o=this.E/Math.pow(Hr(this.e,n.y,Math.sin(n.y)),this.B),a=1/o,e=.5*(o-a),i=.5*(o+a),s=Math.sin(this.B*n.x),r=(e*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(r)-1)<gt)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),a=Math.cos(this.B*n.x),Math.abs(a)<Lc?u=this.A*n.x:u=this.ArB*Math.atan2(e*this.cosgam+s*this.singam,a)}else h=n.y>0?this.v_pole_n:this.v_pole_s,u=this.ArB*n.y;return this.no_rot?(t.x=u,t.y=h):(u-=this.u_0,t.x=h*this.cosrot+u*this.sinrot,t.y=u*this.cosrot-h*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function dJ(n){var t,e,i,r,s,o,a,u={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(e=n.y,t=n.x):(e=n.x*this.cosrot-n.y*this.sinrot,t=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*e),r=.5*(i-1/i),s=.5*(i+1/i),o=Math.sin(this.BrA*t),a=(o*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<gt)u.x=0,u.y=a<0?-st:st;else{if(u.y=this.E/Math.sqrt((1+a)/(1-a)),u.y=cg(this.e,Math.pow(u.y,1/this.B)),u.y===1/0)throw new Error;u.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*t))}return u.x+=this.lam0,u}var fJ=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const gJ={init:cJ,forward:hJ,inverse:dJ,names:fJ};function mJ(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<gt)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var t=Math.sin(this.lat1),e=Math.cos(this.lat1),i=Ds(this.e,t,e),r=Hr(this.e,this.lat1,t),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Ds(this.e,s,o),u=Hr(this.e,this.lat2,s),h=Math.abs(Math.abs(this.lat0)-st)<gt?0:Hr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>gt?this.ns=Math.log(i/a)/Math.log(r/u):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function pJ(n){var t=n.x,e=n.y;Math.abs(2*Math.abs(e)-Math.PI)<=gt&&(e=$g(e)*(st-2*gt));var i=Math.abs(Math.abs(e)-st),r,s;if(i>gt)r=Hr(this.e,e,Math.sin(e)),s=this.a*this.f0*Math.pow(r,this.ns);else{if(i=e*this.ns,i<=0)return null;s=0}var o=this.ns*_t(t-this.long0,this.over);return n.x=this.k0*(s*Math.sin(o))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,n}function _J(n){var t,e,i,r,s,o=(n.x-this.x0)/this.k0,a=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(o*o+a*a),e=1):(t=-Math.sqrt(o*o+a*a),e=-1);var u=0;if(t!==0&&(u=Math.atan2(e*o,e*a)),t!==0||this.ns>0){if(e=1/this.ns,i=Math.pow(t/(this.a*this.f0),e),r=cg(this.e,i),r===-9999)return null}else r=-st;return s=_t(u/this.ns+this.long0,this.over),n.x=s,n.y=r,n}var yJ=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const vJ={init:mJ,forward:pJ,inverse:_J,names:yJ};function EJ(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function wJ(n){var t,e,i,r,s,o,a,u=n.x,h=n.y,d=_t(u-this.long0,this.over);return t=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),e=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/t)-this.s45),i=-d*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(e)+Math.sin(this.ad)*Math.cos(e)*Math.cos(i)),s=Math.asin(Math.cos(e)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=a*Math.cos(o)/1,n.x=a*Math.sin(o)/1,this.czech||(n.y*=-1,n.x*=-1),n}function xJ(n){var t,e,i,r,s,o,a,u,h=n.x;n.x=n.y,n.y=h,this.czech||(n.y*=-1,n.x*=-1),o=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),r=s/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),e=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(t)),n.x=this.long0-e/this.alfa,a=t,u=0;var d=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-n.y)<1e-10&&(u=1),a=n.y,d+=1;while(u===0&&d<15);return d>=15?null:n}var TJ=["Krovak","krovak"];const SJ={init:EJ,forward:wJ,inverse:xJ,names:TJ};function hi(n,t,e,i,r){return n*r-t*Math.sin(2*r)+e*Math.sin(4*r)-i*Math.sin(6*r)}function Wg(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Kg(n){return .375*n*(1+.25*n*(1+.46875*n))}function qg(n){return .05859375*n*n*(1+.75*n)}function Hg(n){return n*n*n*(35/3072)}function mS(n,t,e){var i=t*e;return n/Math.sqrt(1-i*i)}function Ha(n){return Math.abs(n)<st?n:n-$g(n)*Math.PI}function l_(n,t,e,i,r){var s,o;s=n/t;for(var a=0;a<15;a++)if(o=(n-(t*s-e*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(t-2*e*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function IJ(){this.sphere||(this.e0=Wg(this.es),this.e1=Kg(this.es),this.e2=qg(this.es),this.e3=Hg(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0))}function AJ(n){var t,e,i=n.x,r=n.y;if(i=_t(i-this.long0,this.over),this.sphere)t=this.a*Math.asin(Math.cos(r)*Math.sin(i)),e=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=mS(this.a,this.e,s),u=Math.tan(r)*Math.tan(r),h=i*Math.cos(r),d=h*h,g=this.es*o*o/(1-this.es),m=this.a*hi(this.e0,this.e1,this.e2,this.e3,r);t=a*h*(1-d*u*(1/6-(8-u+8*g)*d/120)),e=m-this.ml0+a*s/o*d*(.5+(5-u+6*g)*d/24)}return n.x=t+this.x0,n.y=e+this.y0,n}function RJ(n){n.x-=this.x0,n.y-=this.y0;var t=n.x/this.a,e=n.y/this.a,i,r;if(this.sphere){var s=e+this.lat0;i=Math.asin(Math.sin(s)*Math.cos(t)),r=Math.atan2(Math.tan(t),Math.cos(s))}else{var o=this.ml0/this.a+e,a=l_(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-st)<=gt)return n.x=this.long0,n.y=st,e<0&&(n.y*=-1),n;var u=mS(this.a,this.e,Math.sin(a)),h=u*u*u/this.a/this.a*(1-this.es),d=Math.pow(Math.tan(a),2),g=t*this.a/u,m=g*g;i=a-u*Math.tan(a)/h*g*g*(.5-(1+3*d)*g*g/24),r=g*(1-m*(d/3+(1+3*d)*d*m/15))/Math.cos(a)}return n.x=_t(r+this.long0,this.over),n.y=Ha(i),n}var PJ=["Cassini","Cassini_Soldner","cass"];const CJ={init:IJ,forward:AJ,inverse:RJ,names:PJ};function ba(n,t){var e;return n>1e-7?(e=n*t,(1-n*n)*(t/(1-e*e)-.5/n*Math.log((1-e)/(1+e)))):2*t}var Pw=1,Cw=2,Mw=3,i0=4;function MJ(){var n=Math.abs(this.lat0);if(Math.abs(n-st)<gt?this.mode=this.lat0<0?Pw:Cw:Math.abs(n)<gt?this.mode=Mw:this.mode=i0,this.es>0){var t;switch(this.qp=ba(this.e,1),this.mmf=.5/(1-this.es),this.apa=GJ(this.es),this.mode){case Cw:this.dd=1;break;case Pw:this.dd=1;break;case Mw:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case i0:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=ba(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===i0&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function bJ(n){var t,e,i,r,s,o,a,u,h,d,g=n.x,m=n.y;if(g=_t(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),d=Math.cos(m),i=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e=this.mode===this.EQUIT?1+d*i:1+this.sinph0*s+this.cosph0*d*i,e<=gt)return null;e=Math.sqrt(2/e),t=e*d*Math.sin(g),e*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*d*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(m+this.lat0)<gt)return null;e=ge-m*.5,e=2*(this.mode===this.S_POLE?Math.cos(e):Math.sin(e)),t=e*Math.sin(g),e*=i}}else{switch(a=0,u=0,h=0,i=Math.cos(g),r=Math.sin(g),s=Math.sin(m),o=ba(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,u=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*u*i;break;case this.EQUIT:h=1+u*i;break;case this.N_POLE:h=st+m,o=this.qp-o;break;case this.S_POLE:h=m-st,o=this.qp+o;break}if(Math.abs(h)<gt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?e=this.ymf*h*(this.cosb1*a-this.sinb1*u*i):e=(h=Math.sqrt(2/(1+u*i)))*a*this.ymf,t=this.xmf*h*u*r;break;case this.N_POLE:case this.S_POLE:o>=0?(t=(h=Math.sqrt(o))*r,e=i*(this.mode===this.S_POLE?h:-h)):t=e=0;break}}return n.x=this.a*t+this.x0,n.y=this.a*e+this.y0,n}function kJ(n){n.x-=this.x0,n.y-=this.y0;var t=n.x/this.a,e=n.y/this.a,i,r,s,o,a,u,h;if(this.sphere){var d=0,g,m=0;if(g=Math.sqrt(t*t+e*e),r=g*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(g)<=gt?0:Math.asin(e*m/g),t*=m,e=d*g;break;case this.OBLIQ:r=Math.abs(g)<=gt?this.lat0:Math.asin(d*this.sinph0+e*m*this.cosph0/g),t*=m*this.cosph0,e=(d-Math.sin(r)*this.sinph0)*g;break;case this.N_POLE:e=-e,r=st-r;break;case this.S_POLE:r-=st;break}i=e===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,e)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,e*=this.dd,u=Math.sqrt(t*t+e*e),u<gt)return n.x=this.long0,n.y=this.lat0,n;o=2*Math.asin(.5*u/this.rq),s=Math.cos(o),t*=o=Math.sin(o),this.mode===this.OBLIQ?(h=s*this.sinb1+e*o*this.cosb1/u,a=this.qp*h,e=u*this.cosb1*s-e*this.sinb1*o):(h=e*o/u,a=this.qp*h,e=u*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(e=-e),a=t*t+e*e,!a)return n.x=this.long0,n.y=this.lat0,n;h=1-a/this.qp,this.mode===this.S_POLE&&(h=-h)}i=Math.atan2(t,e),r=UJ(Math.asin(h),this.apa)}return n.x=_t(this.long0+i,this.over),n.y=r,n}var LJ=.3333333333333333,DJ=.17222222222222222,NJ=.10257936507936508,OJ=.06388888888888888,VJ=.0664021164021164,FJ=.016415012942191543;function GJ(n){var t,e=[];return e[0]=n*LJ,t=n*n,e[0]+=t*DJ,e[1]=t*OJ,t*=n,e[0]+=t*NJ,e[1]+=t*VJ,e[2]=t*FJ,e}function UJ(n,t){var e=n+n;return n+t[0]*Math.sin(e)+t[1]*Math.sin(e+e)+t[2]*Math.sin(e+e+e)}var jJ=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const zJ={init:MJ,forward:bJ,inverse:kJ,names:jJ,S_POLE:Pw,N_POLE:Cw,EQUIT:Mw,OBLIQ:i0};function Ba(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function BJ(){Math.abs(this.lat1+this.lat2)<gt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ds(this.e3,this.sin_po,this.cos_po),this.qs1=ba(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ds(this.e3,this.sin_po,this.cos_po),this.qs2=ba(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ba(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>gt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function $J(n){var t=n.x,e=n.y;this.sin_phi=Math.sin(e),this.cos_phi=Math.cos(e);var i=ba(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*_t(t-this.long0,this.over),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return n.x=o,n.y=a,n}function WJ(n){var t,e,i,r,s,o;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,t!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=t*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(e=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,e)),s=_t(r/this.ns0+this.long0,this.over),n.x=s,n.y=o,n}function KJ(n,t){var e,i,r,s,o,a=Ba(.5*t);if(n<gt)return a;for(var u=n*n,h=1;h<=25;h++)if(e=Math.sin(a),i=Math.cos(a),r=n*e,s=1-r*r,o=.5*s*s/i*(t/(1-u)-e/s+.5/n*Math.log((1-r)/(1+r))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var qJ=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const HJ={init:BJ,forward:$J,inverse:WJ,names:qJ,phi1z:KJ};function XJ(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function YJ(n){var t,e,i,r,s,o,a,u,h=n.x,d=n.y;return i=_t(h-this.long0,this.over),t=Math.sin(d),e=Math.cos(d),r=Math.cos(i),o=this.sin_p14*t+this.cos_p14*e*r,s=1,o>0||Math.abs(o)<=gt?(a=this.x0+this.a*s*e*Math.sin(i)/o,u=this.y0+this.a*s*(this.cos_p14*t-this.sin_p14*e*r)/o):(a=this.x0+this.infinity_dist*e*Math.sin(i),u=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*e*r)),n.x=a,n.y=u,n}function ZJ(n){var t,e,i,r,s,o;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(t=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(t,this.rc),e=Math.sin(r),i=Math.cos(r),o=Ba(i*this.sin_p14+n.y*e*this.cos_p14/t),s=Math.atan2(n.x*e,t*this.cos_p14*i-n.y*this.sin_p14*e),s=_t(this.long0+s,this.over)):(o=this.phic0,s=0),n.x=s,n.y=o,n}var QJ=["gnom"];const JJ={init:XJ,forward:YJ,inverse:ZJ,names:QJ};function ttt(n,t){var e=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(t)-e)<1e-6)return t<0?-1*st:st;for(var i=Math.asin(.5*t),r,s,o,a,u=0;u<30;u++)if(s=Math.sin(i),o=Math.cos(i),a=n*s,r=Math.pow(1-a*a,2)/(2*o)*(t/(1-n*n)-s/(1-a*a)+.5/n*Math.log((1-a)/(1+a))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function ett(){this.sphere||(this.k0=Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function ntt(n){var t=n.x,e=n.y,i,r,s=_t(t-this.long0,this.over);if(this.sphere)i=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(e)/Math.cos(this.lat_ts);else{var o=ba(this.e,Math.sin(e));i=this.x0+this.a*this.k0*s,r=this.y0+this.a*o*.5/this.k0}return n.x=i,n.y=r,n}function itt(n){n.x-=this.x0,n.y-=this.y0;var t,e;return this.sphere?(t=_t(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),e=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(e=ttt(this.e,2*n.y*this.k0/this.a),t=_t(this.long0+n.x/(this.a*this.k0),this.over)),n.x=t,n.y=e,n}var rtt=["cea"];const stt={init:ett,forward:ntt,inverse:itt,names:rtt};function ott(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function att(n){var t=n.x,e=n.y,i=_t(t-this.long0,this.over),r=Ha(e-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function ltt(n){var t=n.x,e=n.y;return n.x=_t(this.long0+(t-this.x0)/(this.a*this.rc),this.over),n.y=Ha(this.lat0+(e-this.y0)/this.a),n}var utt=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const ctt={init:ott,forward:att,inverse:ltt,names:utt};var OM=20;function htt(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Wg(this.es),this.e1=Kg(this.es),this.e2=qg(this.es),this.e3=Hg(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0)}function dtt(n){var t=n.x,e=n.y,i,r,s,o=_t(t-this.long0,this.over);if(s=o*Math.sin(e),this.sphere)Math.abs(e)<=gt?(i=this.a*o,r=-1*this.a*this.lat0):(i=this.a*Math.sin(s)/Math.tan(e),r=this.a*(Ha(e-this.lat0)+(1-Math.cos(s))/Math.tan(e)));else if(Math.abs(e)<=gt)i=this.a*o,r=-1*this.ml0;else{var a=mS(this.a,this.e,Math.sin(e))/Math.tan(e);i=a*Math.sin(s),r=this.a*hi(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+a*(1-Math.cos(s))}return n.x=i+this.x0,n.y=r+this.y0,n}function ftt(n){var t,e,i,r,s,o,a,u,h;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=gt)t=_t(i/this.a+this.long0,this.over),e=0;else{o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,u=o;var d;for(s=OM;s;--s)if(d=Math.tan(u),h=-1*(o*(u*d+1)-u-.5*(u*u+a)*d)/((u-o)/d-1),u+=h,Math.abs(h)<=gt){e=u;break}t=_t(this.long0+Math.asin(i*Math.tan(u)/this.a)/Math.sin(e),this.over)}else if(Math.abs(r+this.ml0)<=gt)e=0,t=_t(this.long0+i/this.a,this.over);else{o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,u=o;var g,m,v,y,S;for(s=OM;s;--s)if(S=this.e*Math.sin(u),g=Math.sqrt(1-S*S)*Math.tan(u),m=this.a*hi(this.e0,this.e1,this.e2,this.e3,u),v=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),y=m/this.a,h=(o*(g*y+1)-y-.5*g*(y*y+a))/(this.es*Math.sin(2*u)*(y*y+a-2*o*y)/(4*g)+(o-y)*(g*v-2/Math.sin(2*u))-v),u-=h,Math.abs(h)<=gt){e=u;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(e),2))*Math.tan(e),t=_t(this.long0+Math.asin(i*g/this.a)/Math.sin(e),this.over)}return n.x=t,n.y=e,n}var gtt=["Polyconic","American_Polyconic","poly"];const mtt={init:htt,forward:dtt,inverse:ftt,names:gtt};function ptt(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function _tt(n){var t,e=n.x,i=n.y,r=i-this.lat0,s=e-this.long0,o=r/xf*1e-5,a=s,u=1,h=0;for(t=1;t<=10;t++)u=u*o,h=h+this.A[t]*u;var d=h,g=a,m=1,v=0,y,S,w=0,R=0;for(t=1;t<=6;t++)y=m*d-v*g,S=v*d+m*g,m=y,v=S,w=w+this.B_re[t]*m-this.B_im[t]*v,R=R+this.B_im[t]*m+this.B_re[t]*v;return n.x=R*this.a+this.x0,n.y=w*this.a+this.y0,n}function ytt(n){var t,e=n.x,i=n.y,r=e-this.x0,s=i-this.y0,o=s/this.a,a=r/this.a,u=1,h=0,d,g,m=0,v=0;for(t=1;t<=6;t++)d=u*o-h*a,g=h*o+u*a,u=d,h=g,m=m+this.C_re[t]*u-this.C_im[t]*h,v=v+this.C_im[t]*u+this.C_re[t]*h;for(var y=0;y<this.iterations;y++){var S=m,w=v,R,P,M=o,L=a;for(t=2;t<=6;t++)R=S*m-w*v,P=w*m+S*v,S=R,w=P,M=M+(t-1)*(this.B_re[t]*S-this.B_im[t]*w),L=L+(t-1)*(this.B_im[t]*S+this.B_re[t]*w);S=1,w=0;var D=this.B_re[1],j=this.B_im[1];for(t=2;t<=6;t++)R=S*m-w*v,P=w*m+S*v,S=R,w=P,D=D+t*(this.B_re[t]*S-this.B_im[t]*w),j=j+t*(this.B_im[t]*S+this.B_re[t]*w);var b=D*D+j*j;m=(M*D+L*j)/b,v=(L*D-M*j)/b}var A=m,k=v,V=1,F=0;for(t=1;t<=9;t++)V=V*A,F=F+this.D[t]*V;var U=this.lat0+F*xf*1e5,N=this.long0+k;return n.x=N,n.y=U,n}var vtt=["New_Zealand_Map_Grid","nzmg"];const Ett={init:ptt,forward:_tt,inverse:ytt,names:vtt};function wtt(){}function xtt(n){var t=n.x,e=n.y,i=_t(t-this.long0,this.over),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return n.x=r,n.y=s,n}function Ttt(n){n.x-=this.x0,n.y-=this.y0;var t=_t(this.long0+n.x/this.a,this.over),e=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=t,n.y=e,n}var Stt=["Miller_Cylindrical","mill"];const Itt={init:wtt,forward:xtt,inverse:Ttt,names:Stt};var Att=20;function Rtt(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=uS(this.es)}function Ptt(n){var t,e,i=n.x,r=n.y;if(i=_t(i-this.long0,this.over),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var s=this.n*Math.sin(r),o=Att;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<gt)break}t=this.a*this.C_x*i*(this.m+Math.cos(r)),e=this.a*this.C_y*r}else{var u=Math.sin(r),h=Math.cos(r);e=this.a*Gh(r,u,h,this.en),t=this.a*i*h/Math.sqrt(1-this.es*u*u)}return n.x=t,n.y=e,n}function Ctt(n){var t,e,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,t=n.y/this.a,this.sphere?(t/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(t))),this.m?t=Ba((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=Ba(Math.sin(t)/this.n)),i=_t(i+this.long0,this.over),t=Ha(t)):(t=cS(n.y/this.a,this.es,this.en),r=Math.abs(t),r<st?(r=Math.sin(t),e=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(t)),i=_t(e,this.over)):r-gt<st&&(i=this.long0)),n.x=i,n.y=t,n}var Mtt=["Sinusoidal","sinu"];const btt={init:Rtt,forward:Ptt,inverse:Ctt,names:Mtt};function ktt(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Ltt(n){for(var t=n.x,e=n.y,i=_t(t-this.long0,this.over),r=e,s=Math.PI*Math.sin(e);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<gt)break}r/=2,Math.PI/2-Math.abs(e)<gt&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,u=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=a,n.y=u,n}function Dtt(n){var t,e;n.x-=this.x0,n.y-=this.y0,e=n.y/(1.4142135623731*this.a),Math.abs(e)>.999999999999&&(e=.999999999999),t=Math.asin(e);var i=_t(this.long0+n.x/(.900316316158*this.a*Math.cos(t)),this.over);i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),e=(2*t+Math.sin(2*t))/Math.PI,Math.abs(e)>1&&(e=1);var r=Math.asin(e);return n.x=i,n.y=r,n}var Ntt=["Mollweide","moll"];const Ott={init:ktt,forward:Ltt,inverse:Dtt,names:Ntt};function Vtt(){Math.abs(this.lat1+this.lat2)<gt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Wg(this.es),this.e1=Kg(this.es),this.e2=qg(this.es),this.e3=Hg(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Ds(this.e,this.sin_phi,this.cos_phi),this.ml1=hi(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<gt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Ds(this.e,this.sin_phi,this.cos_phi),this.ml2=hi(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=hi(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Ftt(n){var t=n.x,e=n.y,i;if(this.sphere)i=this.a*(this.g-e);else{var r=hi(this.e0,this.e1,this.e2,this.e3,e);i=this.a*(this.g-r)}var s=this.ns*_t(t-this.long0,this.over),o=this.x0+i*Math.sin(s),a=this.y0+this.rh-i*Math.cos(s);return n.x=o,n.y=a,n}function Gtt(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var t,e,i,r;this.ns>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),t=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),t=-1);var s=0;if(e!==0&&(s=Math.atan2(t*n.x,t*n.y)),this.sphere)return r=_t(this.long0+s/this.ns,this.over),i=Ha(this.g-e/this.a),n.x=r,n.y=i,n;var o=this.g-e/this.a;return i=l_(o,this.e0,this.e1,this.e2,this.e3),r=_t(this.long0+s/this.ns,this.over),n.x=r,n.y=i,n}var Utt=["Equidistant_Conic","eqdc"];const jtt={init:Vtt,forward:Ftt,inverse:Gtt,names:Utt};function ztt(){this.R=this.a}function Btt(n){var t=n.x,e=n.y,i=_t(t-this.long0,this.over),r,s;Math.abs(e)<=gt&&(r=this.x0+this.R*i,s=this.y0);var o=Ba(2*Math.abs(e/Math.PI));(Math.abs(i)<=gt||Math.abs(Math.abs(e)-st)<=gt)&&(r=this.x0,e>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/i-i/Math.PI),u=a*a,h=Math.sin(o),d=Math.cos(o),g=d/(h+d-1),m=g*g,v=g*(2/h-1),y=v*v,S=Math.PI*this.R*(a*(g-y)+Math.sqrt(u*(g-y)*(g-y)-(y+u)*(m-y)))/(y+u);i<0&&(S=-S),r=this.x0+S;var w=u+g;return S=Math.PI*this.R*(v*w-a*Math.sqrt((y+u)*(u+1)-w*w))/(y+u),e>=0?s=this.y0+S:s=this.y0-S,n.x=r,n.y=s,n}function $tt(n){var t,e,i,r,s,o,a,u,h,d,g,m,v;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,i=n.x/g,r=n.y/g,s=i*i+r*r,o=-Math.abs(r)*(1+s),a=o-2*r*r+i*i,u=-2*o+1+2*r*r+s*s,v=r*r/u+(2*a*a*a/u/u/u-9*o*a/u/u)/27,h=(o-a*a/3/u)/u,d=2*Math.sqrt(-h/3),g=3*v/h/d,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?e=(-d*Math.cos(m+Math.PI/3)-a/3/u)*Math.PI:e=-(-d*Math.cos(m+Math.PI/3)-a/3/u)*Math.PI,Math.abs(i)<gt?t=this.long0:t=_t(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i,this.over),n.x=t,n.y=e,n}var Wtt=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Ktt={init:ztt,forward:Btt,inverse:$tt,names:Wtt};function qtt(n,t,e,i,r,s){const o=i-t,a=Math.atan((1-s)*Math.tan(n)),u=Math.atan((1-s)*Math.tan(e)),h=Math.sin(a),d=Math.cos(a),g=Math.sin(u),m=Math.cos(u);let v=o,y,S=100,w,R,P,M,L,D,j,b,A,k,V,F,U,N;do{if(w=Math.sin(v),R=Math.cos(v),P=Math.sqrt(m*w*(m*w)+(d*g-h*m*R)*(d*g-h*m*R)),P===0)return{azi1:0,s12:0};M=h*g+d*m*R,L=Math.atan2(P,M),D=d*m*w/P,j=1-D*D,b=j!==0?M-2*h*g/j:0,A=s/16*j*(4+s*(4-3*j)),y=v,v=o+(1-A)*s*D*(L+A*P*(b+A*M*(-1+2*b*b)))}while(Math.abs(v-y)>1e-12&&--S>0);return S===0?{azi1:NaN,s12:NaN}:(k=j*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),V=1+k/16384*(4096+k*(-768+k*(320-175*k))),F=k/1024*(256+k*(-128+k*(74-47*k))),U=F*P*(b+F/4*(M*(-1+2*b*b)-F/6*b*(-3+4*P*P)*(-3+4*b*b))),N=r*(1-s)*V*(L-U),{azi1:Math.atan2(m*w,d*g-h*m*R),s12:N})}function Htt(n,t,e,i,r,s){const o=Math.atan((1-s)*Math.tan(n)),a=Math.sin(o),u=Math.cos(o),h=Math.sin(e),d=Math.cos(e),g=Math.atan2(a,u*d),m=u*h,v=1-m*m,y=v*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),S=1+y/16384*(4096+y*(-768+y*(320-175*y))),w=y/1024*(256+y*(-128+y*(74-47*y)));let R=i/(r*(1-s)*S),P,M=100,L,D,j,b;do L=Math.cos(2*g+R),D=Math.sin(R),j=Math.cos(R),b=w*D*(L+w/4*(j*(-1+2*L*L)-w/6*L*(-3+4*D*D)*(-3+4*L*L))),P=R,R=i/(r*(1-s)*S)+b;while(Math.abs(R-P)>1e-12&&--M>0);if(M===0)return{lat2:NaN,lon2:NaN};const A=a*D-u*j*d,k=Math.atan2(a*j+u*D*d,(1-s)*Math.sqrt(m*m+A*A)),V=Math.atan2(D*h,u*j-a*D*d),F=s/16*v*(4+s*(4-3*v)),U=V-(1-F)*s*m*(R+F*D*(L+F*j*(-1+2*L*L))),N=t+U;return{lat2:k,lon2:N}}function Xtt(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Ytt(n){var t=n.x,e=n.y,i=Math.sin(n.y),r=Math.cos(n.y),s=_t(t-this.long0,this.over),o,a,u,h,d,g,m,v,y,S,w;return this.sphere?Math.abs(this.sin_p12-1)<=gt?(n.x=this.x0+this.a*(st-e)*Math.sin(s),n.y=this.y0-this.a*(st-e)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=gt?(n.x=this.x0+this.a*(st+e)*Math.sin(s),n.y=this.y0+this.a*(st+e)*Math.cos(s),n):(y=this.sin_p12*i+this.cos_p12*r*Math.cos(s),m=Math.acos(y),v=m?m/Math.sin(m):1,n.x=this.x0+this.a*v*r*Math.sin(s),n.y=this.y0+this.a*v*(this.cos_p12*i-this.sin_p12*r*Math.cos(s)),n):(o=Wg(this.es),a=Kg(this.es),u=qg(this.es),h=Hg(this.es),Math.abs(this.sin_p12-1)<=gt?(d=this.a*hi(o,a,u,h,st),g=this.a*hi(o,a,u,h,e),n.x=this.x0+(d-g)*Math.sin(s),n.y=this.y0-(d-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=gt?(d=this.a*hi(o,a,u,h,st),g=this.a*hi(o,a,u,h,e),n.x=this.x0+(d+g)*Math.sin(s),n.y=this.y0+(d+g)*Math.cos(s),n):Math.abs(t)<gt&&Math.abs(e-this.lat0)<gt?(n.x=n.y=0,n):(S=qtt(this.lat0,this.long0,e,t,this.a,this.f),w=S.azi1,n.x=S.s12*Math.sin(w),n.y=S.s12*Math.cos(w),n))}function Ztt(n){n.x-=this.x0,n.y-=this.y0;var t,e,i,r,s,o,a,u,h,d,g,m,v,y,S,w;return this.sphere?(t=Math.sqrt(n.x*n.x+n.y*n.y),t>2*st*this.a?void 0:(e=t/this.a,i=Math.sin(e),r=Math.cos(e),s=this.long0,Math.abs(t)<=gt?o=this.lat0:(o=Ba(r*this.sin_p12+n.y*i*this.cos_p12/t),a=Math.abs(this.lat0)-st,Math.abs(a)<=gt?this.lat0>=0?s=_t(this.long0+Math.atan2(n.x,-n.y),this.over):s=_t(this.long0-Math.atan2(-n.x,n.y),this.over):s=_t(this.long0+Math.atan2(n.x*i,t*this.cos_p12*r-n.y*this.sin_p12*i),this.over)),n.x=s,n.y=o,n)):(u=Wg(this.es),h=Kg(this.es),d=qg(this.es),g=Hg(this.es),Math.abs(this.sin_p12-1)<=gt?(m=this.a*hi(u,h,d,g,st),t=Math.sqrt(n.x*n.x+n.y*n.y),v=m-t,o=l_(v/this.a,u,h,d,g),s=_t(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=o,n):Math.abs(this.sin_p12+1)<=gt?(m=this.a*hi(u,h,d,g,st),t=Math.sqrt(n.x*n.x+n.y*n.y),v=t-m,o=l_(v/this.a,u,h,d,g),s=_t(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=o,n):(y=Math.atan2(n.x,n.y),S=Math.sqrt(n.x*n.x+n.y*n.y),w=Htt(this.lat0,this.long0,y,S,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var Qtt=["Azimuthal_Equidistant","aeqd"];const Jtt={init:Xtt,forward:Ytt,inverse:Ztt,names:Qtt};function tet(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function eet(n){var t,e,i,r,s,o,a,u,h=n.x,d=n.y;return i=_t(h-this.long0,this.over),t=Math.sin(d),e=Math.cos(d),r=Math.cos(i),o=this.sin_p14*t+this.cos_p14*e*r,s=1,(o>0||Math.abs(o)<=gt)&&(a=this.a*s*e*Math.sin(i),u=this.y0+this.a*s*(this.cos_p14*t-this.sin_p14*e*r)),n.x=a,n.y=u,n}function net(n){var t,e,i,r,s,o,a;return n.x-=this.x0,n.y-=this.y0,t=Math.sqrt(n.x*n.x+n.y*n.y),e=Ba(t/this.a),i=Math.sin(e),r=Math.cos(e),o=this.long0,Math.abs(t)<=gt?(a=this.lat0,n.x=o,n.y=a,n):(a=Ba(r*this.sin_p14+n.y*i*this.cos_p14/t),s=Math.abs(this.lat0)-st,Math.abs(s)<=gt?(this.lat0>=0?o=_t(this.long0+Math.atan2(n.x,-n.y),this.over):o=_t(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=o,n.y=a,n):(o=_t(this.long0+Math.atan2(n.x*i,t*this.cos_p14*r-n.y*this.sin_p14*i),this.over),n.x=o,n.y=a,n))}var iet=["ortho"];const ret={init:tet,forward:eet,inverse:net,names:iet};var ze={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},me={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function set(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=st-ge/2?this.face=ze.TOP:this.lat0<=-(st-ge/2)?this.face=ze.BOTTOM:Math.abs(this.long0)<=ge?this.face=ze.FRONT:Math.abs(this.long0)<=st+ge?this.face=this.long0>0?ze.RIGHT:ze.LEFT:this.face=ze.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function oet(n){var t={x:0,y:0},e,i,r,s,o,a,u={value:0};if(n.x-=this.long0,this.es!==0?e=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):e=n.y,i=n.x,this.face===ze.TOP)s=st-e,i>=ge&&i<=st+ge?(u.value=me.AREA_0,r=i-st):i>st+ge||i<=-(st+ge)?(u.value=me.AREA_1,r=i>0?i-nn:i+nn):i>-(st+ge)&&i<=-ge?(u.value=me.AREA_2,r=i+st):(u.value=me.AREA_3,r=i);else if(this.face===ze.BOTTOM)s=st+e,i>=ge&&i<=st+ge?(u.value=me.AREA_0,r=-i+st):i<ge&&i>=-ge?(u.value=me.AREA_1,r=-i):i<-ge&&i>=-(st+ge)?(u.value=me.AREA_2,r=-i-st):(u.value=me.AREA_3,r=i>0?-i+nn:-i-nn);else{var h,d,g,m,v,y,S;this.face===ze.RIGHT?i=nh(i,+st):this.face===ze.BACK?i=nh(i,+nn):this.face===ze.LEFT&&(i=nh(i,-st)),m=Math.sin(e),v=Math.cos(e),y=Math.sin(i),S=Math.cos(i),h=v*S,d=v*y,g=m,this.face===ze.FRONT?(s=Math.acos(h),r=kp(s,g,d,u)):this.face===ze.RIGHT?(s=Math.acos(d),r=kp(s,g,-h,u)):this.face===ze.BACK?(s=Math.acos(-h),r=kp(s,g,-d,u)):this.face===ze.LEFT?(s=Math.acos(-d),r=kp(s,g,h,u)):(s=r=0,u.value=me.AREA_0)}return a=Math.atan(12/nn*(r+Math.acos(Math.sin(r)*Math.cos(ge))-st)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),u.value===me.AREA_1?a+=st:u.value===me.AREA_2?a+=nn:u.value===me.AREA_3&&(a+=1.5*nn),t.x=o*Math.cos(a),t.y=o*Math.sin(a),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,n.x=t.x,n.y=t.y,n}function aet(n){var t={lam:0,phi:0},e,i,r,s,o,a,u,h,d,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),e=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=me.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=me.AREA_1,e-=st):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=me.AREA_2,e=e<0?e+nn:e-nn):(g.value=me.AREA_3,e+=st),d=nn/12*Math.tan(e),o=Math.sin(d)/(Math.cos(d)-1/Math.sqrt(2)),a=Math.atan(o),r=Math.cos(e),s=Math.tan(i),u=1-r*r*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),u<-1?u=-1:u>1&&(u=1),this.face===ze.TOP)h=Math.acos(u),t.phi=st-h,g.value===me.AREA_0?t.lam=a+st:g.value===me.AREA_1?t.lam=a<0?a+nn:a-nn:g.value===me.AREA_2?t.lam=a-st:t.lam=a;else if(this.face===ze.BOTTOM)h=Math.acos(u),t.phi=h-st,g.value===me.AREA_0?t.lam=-a+st:g.value===me.AREA_1?t.lam=-a:g.value===me.AREA_2?t.lam=-a-st:t.lam=a<0?-a-nn:-a+nn;else{var m,v,y;m=u,d=m*m,d>=1?y=0:y=Math.sqrt(1-d)*Math.sin(a),d+=y*y,d>=1?v=0:v=Math.sqrt(1-d),g.value===me.AREA_1?(d=v,v=-y,y=d):g.value===me.AREA_2?(v=-v,y=-y):g.value===me.AREA_3&&(d=v,v=y,y=-d),this.face===ze.RIGHT?(d=m,m=-v,v=d):this.face===ze.BACK?(m=-m,v=-v):this.face===ze.LEFT&&(d=m,m=v,v=-d),t.phi=Math.acos(-y)-st,t.lam=Math.atan2(v,m),this.face===ze.RIGHT?t.lam=nh(t.lam,-st):this.face===ze.BACK?t.lam=nh(t.lam,-nn):this.face===ze.LEFT&&(t.lam=nh(t.lam,+st))}if(this.es!==0){var S,w,R;S=t.phi<0?1:0,w=Math.tan(t.phi),R=this.b/Math.sqrt(w*w+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-R*R)/(this.one_minus_f*R)),S&&(t.phi=-t.phi)}return t.lam+=this.long0,n.x=t.lam,n.y=t.phi,n}function kp(n,t,e,i){var r;return n<gt?(i.value=me.AREA_0,r=0):(r=Math.atan2(t,e),Math.abs(r)<=ge?i.value=me.AREA_0:r>ge&&r<=st+ge?(i.value=me.AREA_1,r-=st):r>st+ge||r<=-(st+ge)?(i.value=me.AREA_2,r=r>=0?r-nn:r+nn):(i.value=me.AREA_3,r+=st)),r}function nh(n,t){var e=n+t;return e<-nn?e+=lg:e>+nn&&(e-=lg),e}var uet=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const cet={init:set,forward:oet,inverse:aet,names:uet};var bw=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],sf=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],N3=.8487,O3=1.3523,V3=bi/5,het=1/V3,$c=18,u_=function(n,t){return n[0]+t*(n[1]+t*(n[2]+t*n[3]))},det=function(n,t){return n[1]+t*(2*n[2]+t*3*n[3])};function fet(n,t,e,i){for(var r=t;i;--i){var s=n(r);if(r-=s,Math.abs(s)<e)break}return r}function get(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function met(n){var t=_t(n.x-this.long0,this.over),e=Math.abs(n.y),i=Math.floor(e*V3);i<0?i=0:i>=$c&&(i=$c-1),e=bi*(e-het*i);var r={x:u_(bw[i],e)*t,y:u_(sf[i],e)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*N3+this.x0,r.y=r.y*this.a*O3+this.y0,r}function pet(n){var t={x:(n.x-this.x0)/(this.a*N3),y:Math.abs(n.y-this.y0)/(this.a*O3)};if(t.y>=1)t.x/=bw[$c][0],t.y=n.y<0?-st:st;else{var e=Math.floor(t.y*$c);for(e<0?e=0:e>=$c&&(e=$c-1);;)if(sf[e][0]>t.y)--e;else if(sf[e+1][0]<=t.y)++e;else break;var i=sf[e],r=5*(t.y-i[0])/(sf[e+1][0]-i[0]);r=fet(function(s){return(u_(i,s)-t.y)/det(i,s)},r,gt,100),t.x/=u_(bw[e],r),t.y=(5*e+r)*qe,n.y<0&&(t.y=-t.y)}return t.x=_t(t.x+this.long0,this.over),t}var _et=["Robinson","robin"];const yet={init:get,forward:met,inverse:pet,names:_et};function vet(){this.name="geocent"}function Eet(n){var t=S3(n,this.es,this.a);return t}function wet(n){var t=I3(n,this.es,this.a,this.b);return t}var xet=["Geocentric","geocentric","geocent","Geocent"];const Tet={init:vet,forward:Eet,inverse:wet,names:xet};var Zn={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Gd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Iet(){if(Object.keys(Gd).forEach((function(e){if(typeof this[e]>"u")this[e]=Gd[e].def;else{if(Gd[e].num&&isNaN(this[e]))throw new Error("Invalid parameter value, must be numeric "+e+" = "+this[e]);Gd[e].num&&(this[e]=parseFloat(this[e]))}Gd[e].degrees&&(this[e]=this[e]*qe)}).bind(this)),Math.abs(Math.abs(this.lat0)-st)<gt?this.mode=this.lat0<0?Zn.S_POLE:Zn.N_POLE:Math.abs(this.lat0)<gt?this.mode=Zn.EQUIT:(this.mode=Zn.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Aet(n){n.x-=this.long0;var t=Math.sin(n.y),e=Math.cos(n.y),i=Math.cos(n.x),r,s;switch(this.mode){case Zn.OBLIQ:s=this.sinph0*t+this.cosph0*e*i;break;case Zn.EQUIT:s=e*i;break;case Zn.S_POLE:s=-t;break;case Zn.N_POLE:s=t;break}switch(s=this.pn1/(this.p-s),r=s*e*Math.sin(n.x),this.mode){case Zn.OBLIQ:s*=this.cosph0*t-this.sinph0*e*i;break;case Zn.EQUIT:s*=t;break;case Zn.N_POLE:s*=-(e*i);break;case Zn.S_POLE:s*=e*i;break}var o,a;return o=s*this.cg+r*this.sg,a=1/(o*this.sw*this.h1+this.cw),r=(r*this.cg-s*this.sg)*this.cw*a,s=o*a,n.x=r*this.a,n.y=s*this.a,n}function Ret(n){n.x/=this.a,n.y/=this.a;var t={x:n.x,y:n.y},e,i,r;r=1/(this.pn1-n.y*this.sw),e=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=e*this.cg+i*this.sg,n.y=i*this.cg-e*this.sg;var s=Pi(n.x,n.y);if(Math.abs(s)<gt)t.x=0,t.y=n.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case Zn.OBLIQ:t.y=Math.asin(o*this.sinph0+n.y*a*this.cosph0/s),n.y=(o-this.sinph0*Math.sin(t.y))*s,n.x*=a*this.cosph0;break;case Zn.EQUIT:t.y=Math.asin(n.y*a/s),n.y=o*s,n.x*=a;break;case Zn.N_POLE:t.y=Math.asin(o),n.y=-n.y;break;case Zn.S_POLE:t.y=-Math.asin(o);break}t.x=Math.atan2(n.x,n.y)}return n.x=t.x+this.long0,n.y=t.y,n}var Pet=["Tilted_Perspective","tpers"];const Cet={init:Iet,forward:Aet,inverse:Ret,names:Pet};function Met(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,t=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function bet(n){var t=n.x,e=n.y,i,r,s,o;if(t=t-this.long0,this.shape==="ellipse"){e=Math.atan(this.radius_p2*Math.tan(e));var a=this.radius_p/Pi(this.radius_p*Math.cos(e),Math.sin(e));if(r=a*Math.cos(t)*Math.cos(e),s=a*Math.sin(t)*Math.cos(e),o=a*Math.sin(e),(this.radius_g-r)*r-s*s-o*o*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Pi(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Pi(s,i)))}else this.shape==="sphere"&&(i=Math.cos(e),r=Math.cos(t)*i,s=Math.sin(t)*i,o=Math.sin(e),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Pi(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Pi(s,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function ket(n){var t=-1,e=0,i=0,r,s,o,a;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),e=Math.tan(n.x/this.radius_g_1)*Pi(1,i)):(e=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Pi(1,e));var u=i/this.radius_p;if(r=e*e+u*u+t*t,s=2*this.radius_g*t,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),t=this.radius_g+a*t,e*=a,i*=a,n.x=Math.atan2(e,t),n.y=Math.atan(i*Math.cos(n.x)/t),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),e=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(e=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+e*e)),r=e*e+i*i+t*t,s=2*this.radius_g*t,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),t=this.radius_g+a*t,e*=a,i*=a,n.x=Math.atan2(e,t),n.y=Math.atan(i*Math.cos(n.x)/t)}return n.x=n.x+this.long0,n}var Let=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Det={init:Met,forward:bet,inverse:ket,names:Let};var Tf=1.340264,Sf=-.081106,If=893e-6,Af=.003796,c_=Math.sqrt(3)/2;function Net(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Oet(n){var t=_t(n.x-this.long0,this.over),e=n.y,i=Math.asin(c_*Math.sin(e)),r=i*i,s=r*r*r;return n.x=t*Math.cos(i)/(c_*(Tf+3*Sf*r+s*(7*If+9*Af*r))),n.y=i*(Tf+Sf*r+s*(If+Af*r)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Vet(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var t=1e-9,e=12,i=n.y,r,s,o,a,u,h;for(h=0;h<e&&(r=i*i,s=r*r*r,o=i*(Tf+Sf*r+s*(If+Af*r))-n.y,a=Tf+3*Sf*r+s*(7*If+9*Af*r),i-=u=o/a,!(Math.abs(u)<t));++h);return r=i*i,s=r*r*r,n.x=c_*n.x*(Tf+3*Sf*r+s*(7*If+9*Af*r))/Math.cos(i),n.y=Math.asin(Math.sin(i)/c_),n.x=_t(n.x+this.long0,this.over),n}var Fet=["eqearth","Equal Earth","Equal_Earth"];const Get={init:Net,forward:Oet,inverse:Vet,names:Fet};var hg=1e-10;function Uet(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<hg)throw new Error;this.es?(this.en=uS(this.es),this.m1=Gh(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=zet,this.forward=jet):(Math.abs(this.phi1)+hg>=st?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=$et,this.forward=Bet)}function jet(n){var t=_t(n.x-(this.long0||0),this.over),e=n.y,i,r,s;return i=this.am1+this.m1-Gh(e,r=Math.sin(e),s=Math.cos(e),this.en),r=s*t/(i*Math.sqrt(1-this.es*r*r)),n.x=i*Math.sin(r),n.y=this.am1-i*Math.cos(r),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function zet(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var t,e,i,r;if(e=Pi(n.x,n.y=this.am1-n.y),r=cS(this.am1+this.m1-e,this.es,this.en),(t=Math.abs(r))<st)t=Math.sin(r),i=e*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*t*t)/Math.cos(r);else if(Math.abs(t-st)<=hg)i=0;else throw new Error;return n.x=_t(i+(this.long0||0),this.over),n.y=Ha(r),n}function Bet(n){var t=_t(n.x-(this.long0||0),this.over),e=n.y,i,r;return r=this.cphi1+this.phi1-e,Math.abs(r)>hg?(n.x=r*Math.sin(i=t*Math.cos(e)/r),n.y=this.cphi1-r*Math.cos(i)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function $et(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var t,e,i=Pi(n.x,n.y=this.cphi1-n.y);if(e=this.cphi1+this.phi1-i,Math.abs(e)>st)throw new Error;return Math.abs(Math.abs(e)-st)<=hg?t=0:t=i*Math.atan2(n.x,n.y)/Math.cos(e),n.x=_t(t+(this.long0||0),this.over),n.y=Ha(e),n}var Wet=["bonne","Bonne (Werner lat_1=90)"];const Ket={init:Uet,names:Wet},VM={OBLIQUE:{forward:Zet,inverse:Jet},TRANSVERSE:{forward:Qet,inverse:tnt}},h_={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function qet(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=E3.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),t=Ir(n);if(!t)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);t.long0=0,this.obliqueProjection=t;let e;const i=Object.keys(h_),r=a=>{if(typeof this[a]>"u")return;const u=parseFloat(this[a])*qe;if(isNaN(u))throw new Error("Invalid value for "+a+": "+this[a]);return u};for(let a=0;a<i.length;a++){const u=i[a],h=h_[u],d=Object.entries(h);if(d.some(([m])=>typeof this[m]<"u")){e=h;for(let m=0;m<d.length;m++){const[v,y]=d[m],S=r(v);if(typeof S>"u")throw new Error("Missing parameter: "+v+".");this[y]=S}break}}if(!e)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=Yet(this,e);this.lamp=s,Math.abs(o)>gt?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=VM.OBLIQUE):this.projectionType=VM.TRANSVERSE}function Het(n){return this.projectionType.forward(this,n)}function Xet(n){return this.projectionType.inverse(this,n)}function Yet(n,t){let e,i;if(t===h_.ROTATE){let r=n.oLongC,s=n.oLatC,o=n.oAlpha;if(Math.abs(Math.abs(s)-st)<=gt)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");i=r+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),e=Math.asin(Math.cos(s)*Math.sin(o))}else if(t===h_.NEW_POLE)i=n.oLongP,e=n.oLatP;else{let r=n.oLong1,s=n.oLat1,o=n.oLong2,a=n.oLat2,u=Math.abs(s);if(Math.abs(s)>st-gt)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(a)>st-gt)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-a)<gt)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(u<gt)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");i=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(r)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(r)),e=Math.atan(-1*Math.cos(i-r)/Math.tan(s))}return{lamp:i,phip:e}}function Zet(n,t){let{x:e,y:i}=t;e+=n.long0;const r=Math.cos(e),s=Math.sin(i),o=Math.cos(i);t.x=_t(Math.atan2(o*Math.sin(e),n.sphip*o*r+n.cphip*s)+n.lamp),t.y=Math.asin(n.sphip*s-n.cphip*o*r);const a=n.obliqueProjection.forward(t);return n.isIdentity&&(a.x*=bi,a.y*=bi),a}function Qet(n,t){let{x:e,y:i}=t;e+=n.long0;const r=Math.cos(i),s=Math.cos(e);t.x=_t(Math.atan2(r*Math.sin(e),Math.sin(i))+n.lamp),t.y=Math.asin(-1*r*s);const o=n.obliqueProjection.forward(t);return n.isIdentity&&(o.x*=bi,o.y*=bi),o}function Jet(n,t){n.isIdentity&&(t.x*=qe,t.y*=qe);const e=n.obliqueProjection.inverse(t);let{x:i,y:r}=e;if(i<Number.MAX_VALUE){i-=n.lamp;const s=Math.cos(i),o=Math.sin(r),a=Math.cos(r);t.x=Math.atan2(a*Math.sin(i),n.sphip*a*s-n.cphip*o),t.y=Math.asin(n.sphip*o+n.cphip*a*s)}return t.x=_t(t.x+n.long0),t}function tnt(n,t){n.isIdentity&&(t.x*=qe,t.y*=qe);const e=n.obliqueProjection.inverse(t);let{x:i,y:r}=e;if(i<Number.MAX_VALUE){const s=Math.cos(r);i-=n.lamp,t.x=Math.atan2(s*Math.sin(i),-1*Math.sin(r)),t.y=Math.asin(s*Math.cos(i))}return t.x=_t(t.x+n.long0),t}var ent=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const nnt={init:qet,forward:Het,inverse:Xet,names:ent};function int(n){n.Proj.projections.add(e0),n.Proj.projections.add(n0),n.Proj.projections.add(BQ),n.Proj.projections.add(QQ),n.Proj.projections.add(iJ),n.Proj.projections.add(lJ),n.Proj.projections.add(gJ),n.Proj.projections.add(vJ),n.Proj.projections.add(SJ),n.Proj.projections.add(CJ),n.Proj.projections.add(zJ),n.Proj.projections.add(HJ),n.Proj.projections.add(JJ),n.Proj.projections.add(stt),n.Proj.projections.add(ctt),n.Proj.projections.add(mtt),n.Proj.projections.add(Ett),n.Proj.projections.add(Itt),n.Proj.projections.add(btt),n.Proj.projections.add(Ott),n.Proj.projections.add(jtt),n.Proj.projections.add(Ktt),n.Proj.projections.add(Jtt),n.Proj.projections.add(ret),n.Proj.projections.add(cet),n.Proj.projections.add(yet),n.Proj.projections.add(Tet),n.Proj.projections.add(Cet),n.Proj.projections.add(Det),n.Proj.projections.add(Get),n.Proj.projections.add(Ket),n.Proj.projections.add(nnt)}const Fl=Object.assign(oQ,{defaultDatum:"WGS84",Proj:Ir,WGS84:new Ir("WGS84"),Point:Ph,toPoint:A3,defs:Nn,nadgrid:zZ,transform:a_,mgrs:aQ,version:"__VERSION__"});int(Fl);Fl.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");const rnt={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function snt(){const n=Ki(a=>a.map),[t,e]=nt.useState(""),[i,r]=nt.useState(!1);nt.useEffect(()=>{if(!n)return;const a=async d=>{try{const g=kl(d),m=Fl("EPSG:4326","EPSG:28992",g),v=50,S=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Archeologische_Monumentenkaart_2014&QUERY_LAYERS=Archeologische_Monumentenkaart_2014&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${m[0]-v},${m[1]-v},${m[0]+v},${m[1]+v}`}`,R=await(await fetch(S)).json();if(R.features&&R.features.length>0){const P=R.features[0].properties;let M='<strong class="text-purple-800">AMK Monument</strong>';if(P.toponiem&&(M+=`<br/><span class="text-sm font-semibold">${P.toponiem}</span>`),P.kwaliteitswaarde&&(M+=`<br/><span class="text-sm text-purple-700">${P.kwaliteitswaarde}</span>`),P.omschrijving&&(M+=`<br/><span class="text-xs text-gray-600 mt-1 block">${P.omschrijving}</span>`),P.txt_label){const L=P.txt_label.split(", ").slice(0,3).join(", ");M+=`<br/><span class="text-xs text-gray-500 italic">${L}${P.txt_label.split(", ").length>3?"...":""}</span>`}return M}}catch(g){console.warn("AMK WMS query failed:",g)}return null},u=async(d,g)=>{const m=n.getLayers().getArray().filter(v=>v instanceof Ac&&v.getVisible()?v.getSource()instanceof lF:!1);for(const v of m){const y=v.getSource();if(!y)continue;const S=v.get("title")||"";if(S==="Archeo Landschappen"){try{const R=kl(d),P=Fl("EPSG:4326","EPSG:28992",R),M=100,D=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-M},${P[1]-M},${P[0]+M},${P[1]+M}`}`,b=await(await fetch(D)).json();if(b.features&&b.features.length>0){const A=b.features[0].properties;let k='<strong class="text-green-800">Archeologisch Landschap</strong>';return(A.landschapsnaam||A.naam)&&(k+=`<br/><span class="text-sm font-semibold">${A.landschapsnaam||A.naam}</span>`),A.omschrijving&&(k+=`<br/><span class="text-xs text-gray-600">${A.omschrijving}</span>`),k}}catch(R){console.warn("Archeo Landschappen WMS query failed:",R)}continue}if(S==="FAMKE Steentijd"){try{const R=kl(d),P=Fl("EPSG:4326","EPSG:28992",R),M=100,D=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-M},${P[1]-M},${P[0]+M},${P[1]+M}`}`,b=await(await fetch(D)).json();if(b.features&&b.features.length>0){const A=b.features[0].properties;let k='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';return(A.advies||A.Advies)&&(k+=`<br/><span class="text-sm text-amber-700">${A.advies||A.Advies}</span>`),k}}catch(R){console.warn("FAMKE WMS query failed:",R)}continue}if(S==="Archeo Onderzoeken"){try{const R=kl(d),P=Fl("EPSG:4326","EPSG:28992",R),M=100,D=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-M},${P[1]-M},${P[0]+M},${P[1]+M}`}`,b=await(await fetch(D)).json();if(b.features&&b.features.length>0){const A=b.features[0].properties;let k='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';if(A.type_onderzoek&&(k+=`<br/><span class="text-sm font-semibold">${A.type_onderzoek}</span>`),A.onderzoeksmeldingnummer&&(k+=`<br/><span class="text-xs text-gray-500">Melding: ${A.onderzoeksmeldingnummer}</span>`),A.uitvoerder&&(k+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${A.uitvoerder}</span>`),A.startdatum||A.einddatum){const V=[A.startdatum,A.einddatum].filter(Boolean).join(" - ");k+=`<br/><span class="text-xs text-gray-600">Periode: ${V}</span>`}if(A.gemeente&&(k+=`<br/><span class="text-xs text-gray-500">${A.gemeente}</span>`),A.type_uri){const V=A.type_uri.replace("type_uri:","").trim();V.startsWith("http")&&(k+=`<br/><a href="${V}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">Meer informatie </a>`)}for(const[V,F]of Object.entries(A))if(V.toLowerCase().includes("uri")&&typeof F=="string"&&V!=="type_uri"){const U=F.replace(/^[a-z_]+:/i,"").trim();U.startsWith("http")&&(k+=`<br/><a href="${U}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">${V.replace("_uri","")} </a>`)}return k}}catch(R){console.warn("Archeo Onderzoeken WMS query failed:",R)}continue}if(S==="IKAW"){try{const R=kl(d),P=Fl("EPSG:4326","EPSG:28992",R),M=500,D=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-M},${P[1]-M},${P[0]+M},${P[1]+M}`}`,b=await(await fetch(D)).json();if(b.features&&b.features.length>0){const A=b.features[0].properties,k=Math.round(A.PALETTE_INDEX||A.palette_index||0),V=rnt[k]||`Trefkans onbekend (${k})`;let F='<strong class="text-orange-800">IKAW (2008)</strong>';return F+=`<br/><span class="text-sm text-orange-700">${V}</span>`,F}}catch(R){console.warn("IKAW WMS query failed:",R)}continue}const w=y.getFeatureInfoUrl(d,g,"EPSG:3857",{INFO_FORMAT:"application/json"});if(w)try{const P=await(await fetch(w)).json();if(P.features&&P.features.length>0){const M=P.features[0].properties;let L=`<strong>${S}</strong>`;if((M.first_soilname||M.soilname)&&(L+=`<br/><span class="text-sm text-amber-700">${M.first_soilname||M.soilname}</span>`),(M.soilcode||M.first_soilcode)&&(L+=`<br/><span class="text-xs text-gray-500">Code: ${M.soilcode||M.first_soilcode}</span>`),M.soilslope&&M.soilslope!=="Niet opgenomen"&&(L+=`<br/><span class="text-xs text-gray-500">Helling: ${M.soilslope}</span>`),M.geomorphological_area_name&&(L+=`<br/><span class="text-sm text-green-700">${M.geomorphological_area_name}</span>`),M.relief&&(L+=`<br/><span class="text-xs text-gray-500">Relief: ${M.relief}</span>`),!M.first_soilname&&!M.soilname&&!M.geomorphological_area_name){const D=["geometry","id","fid","gml_id"];for(const[j,b]of Object.entries(M))!D.includes(j)&&b&&b!=="Niet opgenomen"&&(L+=`<br/><span class="text-xs text-gray-600">${j}: ${b}</span>`)}return L}}catch(R){console.warn("WMS GetFeatureInfo failed:",R)}}return null},h=async d=>{const g=n.forEachFeatureAtPixel(d.pixel,m=>m);if(g){const m=g.getProperties(),{geometry:v,...y}=m;if(y.WAARDE&&(y.WAARDE.includes("archeologische waarde")||y.WAARDE.includes("Terrein"))){const P=await a(d.coordinate);if(P){e(P),r(!0);return}}const S=y.name||y.naam||y.title||y.NAAM||y.NAME||y.label||y.route_name||y.road_name||"Info";let w=`<strong>${S}</strong>`;if(y.WAARDE&&(w+=`<br/><span class="text-sm text-gray-700">${y.WAARDE}</span>`),y.category&&(w+=`<br/><span class="text-sm text-gray-600">Categorie: ${y.category}</span>`),y.from_to&&y.from_to!==S&&(w+=`<br/><span class="text-sm text-gray-600">${y.from_to}</span>`),y.route&&y.route!==S&&(w+=`<br/><span class="text-sm text-gray-600">${y.route}</span>`),y.TOPONIEM&&(w+=`<br/><span class="text-sm font-semibold text-gray-800">${y.TOPONIEM}</span>`,y.PLAATS&&(w+=`<br/><span class="text-xs text-gray-500">${y.PLAATS}</span>`)),(y.AARD_VINDP||y.Aard_vindp)&&(w+=`<br/><span class="text-sm text-gray-700">Aard: ${y.AARD_VINDP||y.Aard_vindp}</span>`),y.BEGIN_PER&&y.EIND_PER&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.BEGIN_PER} - ${y.EIND_PER}</span>`),(y.AARD_OPM||y.Aard_opmer)&&(w+=`<br/><span class="text-xs text-gray-600 italic">${y.AARD_OPM||y.Aard_opmer}</span>`),y.Gemeente&&(w+=`<br/><span class="text-sm text-gray-600">Gemeente: ${y.Gemeente}</span>`),y.Bron&&(w+=`<br/><span class="text-xs text-gray-500">Bron: ${y.Bron}</span>`),y.Bron_besch&&(w+=`<br/><span class="text-xs text-gray-500">${y.Bron_besch}</span>`),y.Dat_st_z&&y.Dat_ei_z&&(w+=`<br/><span class="text-sm text-purple-700">Datering: ${y.Dat_st_z} - ${y.Dat_ei_z}</span>`),y.Begin&&y.Einde&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.Begin} - ${y.Einde}</span>`),y.Uiterwaard&&(w+=`<br/><span class="text-sm font-semibold">${y.Uiterwaard}</span>`),y.rivier&&(w+=`<br/><span class="text-sm text-blue-600">Rivier: ${y.rivier}</span>`),y.Beschrijvi&&(w+=`<br/><span class="text-sm text-gray-700">${y.Beschrijvi}</span>`),y.leisure){const P=y.leisure==="playground"?"Speeltuin":"Park";w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}if((y.tourism==="museum"||y.museum)&&(w+='<br/><span class="text-xs text-purple-600">Museum</span>'),(y.leisure==="swimming_area"||y.sport==="swimming")&&(w+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),y.osm_id&&y.address!==void 0&&(w+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',y.address&&(w+=`<br/><span class="text-xs text-gray-500">${y.address}</span>`),y.phone&&(w+=`<br/><span class="text-xs text-gray-600">${y.phone}</span>`)),(y.historic==="castle"||y.castle_type)&&(w+='<br/><span class="text-xs text-purple-600">Kasteel</span>',y.castle_type&&(w+=`<br/><span class="text-xs text-gray-500">Type: ${y.castle_type}</span>`),y.start_date&&(w+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${y.start_date}</span>`),y.heritage&&(w+='<br/><span class="text-xs text-amber-600">Rijksmonument</span>')),y.bron==="Paleobiology Database"&&(y.taxonomie&&y.taxonomie!=="Onbekend"&&(w+=`<br/><span class="text-xs text-amber-700">${y.taxonomie}</span>`),y.periode&&y.periode!=="Onbekend"&&(w+=`<br/><span class="text-sm text-purple-700">${y.periode}</span>`),y.ouderdom&&y.ouderdom!=="Onbekend"&&(w+=`<br/><span class="text-xs text-gray-600">Ouderdom: ${y.ouderdom}</span>`),y.aantal_fossielen&&(w+=`<br/><span class="text-xs text-green-700">Aantal fossielen: ${y.aantal_fossielen}</span>`),y.formatie&&(w+=`<br/><span class="text-xs text-gray-500">Formatie: ${y.formatie}</span>`),y.lid&&(w+=`<br/><span class="text-xs text-gray-500">Lid: ${y.lid}</span>`),y.gesteente&&(w+=`<br/><span class="text-xs text-gray-500">Gesteente: ${y.gesteente}</span>`),y.milieu&&(w+=`<br/><span class="text-xs text-blue-600">Milieu: ${y.milieu}</span>`),y.vindplaats&&(w+=`<br/><span class="text-xs text-gray-500 italic">${y.vindplaats}</span>`)),(y.inventarisnummer||y.locatie_naam)&&(y.locatie_naam&&(w+=`<br/><span class="text-sm font-semibold">${y.locatie_naam}</span>`),y.inventarisnummer&&(w+=`<br/><span class="text-xs text-gray-500">CAI: ${y.inventarisnummer}</span>`),y.datering_tekst&&(w+=`<br/><span class="text-sm text-purple-700">${y.datering_tekst}</span>`)),(y.veensoort||y.dikte)&&(y.veensoort&&(w+=`<br/><span class="text-sm text-amber-700">${y.veensoort}</span>`),y.dikte&&(w+=`<br/><span class="text-xs text-gray-600">Dikte: ${y.dikte}</span>`)),y.id&&y.id.startsWith("S")&&(y.country==="Nederland"||y.country==="Belgi")&&(w+=`<br/><span class="text-xs text-amber-800">EUROEVOL ${y.id}</span>`,y.culture&&(w+=`<br/><span class="text-sm text-purple-700">${y.culture}</span>`),y.period&&(w+=`<br/><span class="text-sm text-gray-700">${y.period}</span>`),y.type&&(w+=`<br/><span class="text-xs text-gray-600">Type: ${y.type}</span>`),w+=`<br/><span class="text-xs text-gray-500">${y.country}</span>`,w+='<br/><a href="https://discovery.ucl.ac.uk/id/eprint/1469811/" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">EUROEVOL Database </a>'),(y.type_site||y.dating)&&(y.type_site&&(w+=`<br/><span class="text-sm text-red-700">${y.type_site}</span>`),y.dating&&(w+=`<br/><span class="text-xs text-purple-600">${y.dating}</span>`),y.culture&&(w+=`<br/><span class="text-xs text-gray-500">${y.culture}</span>`)),y.nature&&y.debut){w+=`<br/><span class="text-sm text-purple-700">${y.nature}</span>`;const P=y.debut===y.fin?y.debut:`${y.debut} - ${y.fin}`;P&&(w+=`<br/><span class="text-sm text-gray-700">Periode: ${P}</span>`),y.structure&&(w+=`<br/><span class="text-xs text-gray-600">${y.structure}</span>`),y.commune&&(w+=`<br/><span class="text-xs text-gray-500">${y.commune}</span>`),y.decouvert&&(w+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${y.decouvert}</span>`),y.numero&&(w+=`<br/><span class="text-xs text-gray-400">${y.numero}</span>`)}if((y.NATURE_OPE||y.CODE_OPERA)&&(y.TITRE&&(w+=`<br/><span class="text-sm font-semibold">${y.TITRE}</span>`),y.NATURE_OPE&&(w+=`<br/><span class="text-sm text-amber-700">${y.NATURE_OPE}</span>`),y.AUTEUR&&(w+=`<br/><span class="text-xs text-gray-600">Auteur: ${y.AUTEUR}</span>`),y.DATE&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.DATE}</span>`),y.COMMUNE&&(w+=`<br/><span class="text-xs text-gray-500">${y.COMMUNE}</span>`)),y.type_protection&&(y.n_site||y.t_site)){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.n_site&&(w+=`<br/><span class="text-sm font-semibold">${y.n_site}</span>`),y.t_site&&(w+=`<br/><span class="text-xs text-gray-600">${y.t_site}</span>`),y.c_site&&(w+=`<br/><span class="text-xs text-gray-500">Code: ${y.c_site}</span>`),y.d_creation&&(w+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${y.d_creation}</span>`)}if(y.type_protection&&y.cod_diren){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.proced&&(w+=`<br/><span class="text-xs text-gray-600">${y.proced}</span>`),y.d_proced&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.d_proced}</span>`),y.comment){const M=String(y.comment).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${M}${String(y.comment).length>150?"...":""}</span>`}}if(y.type_protection&&y.nomsite){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.caractere&&(w+=`<br/><span class="text-xs text-gray-600">${y.caractere}</span>`),y.datedecis&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.datedecis}</span>`),y.descriptio){const M=String(y.descriptio).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${M}${String(y.descriptio).length>150?"...":""}</span>`}}if(y.secteur&&y.style){if(w+=`<br/><span class="text-sm text-gray-700">${y.secteur}</span>`,y["sous-secteur"]&&(w+=`<br/><span class="text-xs text-gray-600">${y["sous-secteur"]}</span>`),y.description){const P=String(y.description).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${P}${String(y.description).length>150?"...":""}</span>`}y.url&&(w+=`<br/><a href="${y.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(y.nature_operation||y.synthese){y.nature_operation&&(w+=`<br/><span class="text-sm text-red-700">${y.nature_operation}</span>`),y.responsable_operation&&(w+=`<br/><span class="text-xs text-gray-600">Responsable: ${y.responsable_operation}</span>`),y.date_operation&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.date_operation}</span>`);const P=[];if(y.prehistoire==="Oui"&&P.push("Prehistorie"),y.protohistoire==="Oui"&&P.push("Protohistorie"),y.antiquite==="Oui"&&P.push("Romeins"),y.moyen_age==="Oui"&&P.push("Middeleeuwen"),y.temps_modernes==="Oui"&&P.push("Moderne tijd"),P.length>0&&(w+=`<br/><span class="text-sm text-purple-700">${P.join(", ")}</span>`),y.adresse&&(w+=`<br/><span class="text-xs text-gray-500">${y.adresse}</span>`),y.synthese){const M=String(y.synthese).slice(0,200);w+=`<br/><span class="text-xs text-gray-600 italic">${M}${String(y.synthese).length>200?"...":""}</span>`}}if(y.operator&&(w+=`<br/><span class="text-sm text-gray-600">${y.operator}</span>`),y.opening_hours&&(w+=`<br/><span class="text-xs text-green-600">Open: ${y.opening_hours}</span>`),y.website&&(w+=`<br/><a href="${y.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),y.addr_street){const P=[y.addr_street,y.addr_housenumber,y.addr_postcode].filter(Boolean).join(" ");w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}const R=y.description||y.omschrijving||y.descr||y.info;R&&R!==S&&(w+=`<br/><span class="text-sm text-gray-600">${R}</span>`),e(w),r(!0)}else{const m=n.getView().getResolution()||1,v=await u(d.coordinate,m);v&&(e(v),r(!0))}};return n.on("click",h),()=>{n.un("click",h)}},[n]);const s=()=>{r(!1)},o=(a,u)=>{u.offset.y>100&&r(!1)};return z.jsx(Au,{children:i&&z.jsxs(z.Fragment,{children:[z.jsx(Qi.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s}),z.jsxs(Qi.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:o,children:[z.jsx("div",{className:"flex justify-center pt-3 pb-2",children:z.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),z.jsx("button",{onClick:s,className:"absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Sluiten",children:z.jsx(Bg,{size:20})}),z.jsx("div",{className:"px-4 pb-6 max-h-[50vh] overflow-y-auto",dangerouslySetInnerHTML:{__html:t}})]})]})})}function ont(){const n=Ki(w=>w.map),t=Oe(w=>w.position),e=en(w=>w.startNavigation),i=en(w=>w.isNavigating),[r,s]=nt.useState(null),[o,a]=nt.useState(!1),[u,h]=nt.useState(!1),d=nt.useRef(null),g=nt.useRef(null);nt.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const w=n.getViewport();if(!w){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",w);const R=600,P=15,M=V=>{if(console.log(" Touch start, touches:",V.touches.length),V.touches.length!==1)return;const F=V.touches[0];g.current={x:F.clientX,y:F.clientY},console.log(" Starting long press timer at:",g.current),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",g.current),!g.current)return;const U=window.__olMap;if(!U){console.log(" Map not available (global)");return}const N=w.getBoundingClientRect(),ut=[g.current.x-N.left,g.current.y-N.top],wt=U.getCoordinateFromPixel(ut);if(wt){const yt=kl(wt);V.preventDefault(),s({pixel:[g.current.x,g.current.y],coordinate:yt}),a(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",yt)}},R)},L=V=>{if(!d.current||!g.current)return;const F=V.touches[0],U=F.clientX-g.current.x,N=F.clientY-g.current.y,ut=Math.sqrt(U*U+N*N);ut>P&&(console.log(" Touch moved too much, cancelling. Distance:",ut),clearTimeout(d.current),d.current=null)},D=()=>{console.log(" Touch end, timer active:",!!d.current),d.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(d.current),d.current=null),g.current=null},j=V=>{o&&V.preventDefault()},b=V=>{V.button===0&&(console.log(" Mouse down"),g.current={x:V.clientX,y:V.clientY},d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!g.current)return;const F=window.__olMap;if(console.log(" __olMap:",F),console.log(" __olMap constructor:",F?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof F?.getCoordinateAtPixel),!F){console.log(" Map not available (global)");return}const U=w.getBoundingClientRect(),N=[g.current.x-U.left,g.current.y-U.top];console.log(" Pixel:",N);const ut=F.getCoordinateFromPixel(N);if(console.log(" Coordinate:",ut),ut){const wt=kl(ut);s({pixel:[g.current.x,g.current.y],coordinate:wt}),a(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",wt)}},R))},A=V=>{if(!d.current||!g.current)return;const F=V.clientX-g.current.x,U=V.clientY-g.current.y;Math.sqrt(F*F+U*U)>P&&(console.log(" Mouse moved, cancelling"),clearTimeout(d.current),d.current=null)},k=()=>{console.log(" Mouse up"),d.current&&(clearTimeout(d.current),d.current=null),g.current=null};return w.addEventListener("touchstart",M,{passive:!1}),w.addEventListener("touchmove",L,{passive:!0}),w.addEventListener("touchend",D),w.addEventListener("touchcancel",D),w.addEventListener("contextmenu",j),w.addEventListener("mousedown",b),w.addEventListener("mousemove",A),w.addEventListener("mouseup",k),w.addEventListener("mouseleave",k),()=>{w.removeEventListener("touchstart",M),w.removeEventListener("touchmove",L),w.removeEventListener("touchend",D),w.removeEventListener("touchcancel",D),w.removeEventListener("contextmenu",j),w.removeEventListener("mousedown",b),w.removeEventListener("mousemove",A),w.removeEventListener("mouseup",k),w.removeEventListener("mouseleave",k),d.current&&clearTimeout(d.current)}},[n,o]);const m=()=>{u&&(a(!1),s(null),h(!1))},v=async()=>{if(!r||!t)return;const[w,R]=r.coordinate,P=`${R.toFixed(4)}, ${w.toFixed(4)}`;await e({lng:w,lat:R},P,{lng:t.lng,lat:t.lat}),a(!1),s(null),h(!1)},y=()=>{a(!1),s(null),h(!1)},S=w=>{const[R,P]=w;return`${P.toFixed(5)}N, ${R.toFixed(5)}E`};return z.jsx(Au,{children:o&&r&&z.jsxs(z.Fragment,{children:[z.jsx(Qi.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),z.jsxs(Qi.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden min-w-[200px]",style:{left:Math.min(r.pixel[0],window.innerWidth-220),top:Math.min(r.pixel[1],window.innerHeight-180)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[z.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100",children:z.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[z.jsx(h3,{size:16}),z.jsx("span",{className:"text-xs font-mono",children:S(r.coordinate)})]})}),z.jsxs("div",{className:"py-1",children:[z.jsxs("button",{onClick:v,disabled:!t||i,className:`w-full px-4 py-3 flex items-center gap-3 transition-colors ${t&&!i?"hover:bg-blue-50 text-gray-700":"text-gray-400 cursor-not-allowed"}`,children:[z.jsx(sS,{size:20,className:t&&!i?"text-blue-500":"text-gray-300"}),z.jsx("span",{className:"font-medium",children:"Navigeer hierheen"})]}),!t&&z.jsx("div",{className:"px-4 py-2 text-xs text-amber-600 bg-amber-50",children:"GPS positie niet beschikbaar"}),i&&z.jsx("div",{className:"px-4 py-2 text-xs text-blue-600 bg-blue-50",children:"Navigatie al actief"})]}),z.jsx("div",{className:"border-t border-gray-100",children:z.jsxs("button",{onClick:y,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-gray-50 transition-colors",children:[z.jsx(Bg,{size:18}),z.jsx("span",{children:"Annuleren"})]})})]})]})})}function ant(){return z.jsx("div",{className:"fixed bottom-2.5 left-2.5 z-[800] px-2 py-1 bg-white/90 rounded shadow-sm text-xs font-mono text-gray-600",children:"bvd v1.6.0"})}const lnt=["AMK Monumenten","Romeinse wegen","Castella (punten)","Castella (lijnen)"],unt=["Parken","Speeltuinen","Strandjes"],cnt=["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],hnt=["AHN 0.5m","Geomorfologie","AHN4 Multi-Hillshade NL"],dnt=["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AMK Monumenten"],FM=["Hunebedden","EUROEVOL Sites","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","Romeinse wegen","Castella (punten)","Castella (lijnen)","Oppida","Kastelen","IKAW","Archeo Landschappen","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","WWII Bunkers","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Veengebieden","AHN 0.5m","Geomorfologie","Bodemkaart","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Helling NL","World Hillshade","Fossielen Nederland","Parken","Speeltuinen","Musea","Strandjes"],fnt=["CartoDB (licht)","OpenStreetMap","Google Hybride","TMK 1850","Bonnebladen 1900"];function gnt(){const[n,t]=nt.useState(!1),e=oo(o=>o.setLayerVisibility),i=Oe(o=>o.stopTracking),r=()=>{FM.forEach(o=>e(o,!1)),fnt.forEach(o=>{e(o,o==="CartoDB (licht)")}),i(),console.log(" Reset: CartoDB (licht), alle lagen uit, GPS uit")},s=o=>{FM.forEach(a=>e(a,!1)),o.forEach(a=>e(a,!0)),t(!1)};return z.jsxs("div",{className:"fixed bottom-12 left-2.5 z-[800]",children:[z.jsxs("div",{className:"flex gap-1",children:[z.jsx("button",{onClick:()=>t(!n),className:"w-8 h-8 flex items-center justify-center bg-white/90 hover:bg-blue-50 rounded shadow-sm border-0 outline-none transition-colors",title:"Presets",children:n?z.jsx(u3,{size:16,className:"text-blue-600"}):z.jsx(c3,{size:16,className:"text-blue-600"})}),z.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center bg-white/90 hover:bg-gray-100 rounded shadow-sm border-0 outline-none transition-colors",title:"Reset - CartoDB, alle lagen uit, GPS uit",children:z.jsx(Sw,{size:16,className:"text-gray-600"})})]}),z.jsx(Au,{children:n&&z.jsxs(Qi.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"absolute bottom-10 left-0 bg-white/95 rounded-lg shadow-lg p-1.5 min-w-[140px]",children:[z.jsxs("button",{onClick:()=>s(lnt),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-purple-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[z.jsx(mY,{size:14,className:"text-purple-600"}),z.jsx("span",{className:"text-xs text-gray-700",children:"Detectie"})]}),z.jsxs("button",{onClick:()=>s(cnt),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-cyan-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[z.jsx($Y,{size:14,className:"text-cyan-600"}),z.jsx("span",{className:"text-xs text-gray-700",children:"Uiterwaarden"})]}),z.jsxs("button",{onClick:()=>s(unt),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-green-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[z.jsx(FY,{size:14,className:"text-green-600"}),z.jsx("span",{className:"text-xs text-gray-700",children:"Recreatie"})]}),z.jsxs("button",{onClick:()=>s(hnt),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-stone-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[z.jsx(bY,{size:14,className:"text-stone-600"}),z.jsx("span",{className:"text-xs text-gray-700",children:"Hillshade"})]}),z.jsxs("button",{onClick:()=>s(dnt),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-amber-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[z.jsx(d3,{size:14,className:"text-amber-600"}),z.jsx("span",{className:"text-xs text-gray-700",children:"Analyse"})]})]})})]})}const mnt=[{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN4 Helling NL",color:"blue",default:.6},{name:"AHN 0.5m",color:"blue",default:.7},{name:"World Hillshade",color:"blue",default:.7},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"AMK Monumenten",color:"purple",default:.8}],pnt={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function _nt(){const[n,t]=nt.useState(!1),[e,i]=nt.useState(!1),r=oo(d=>d.visible),s=oo(d=>d.opacity),o=oo(d=>d.setLayerOpacity),a=mnt.filter(d=>r[d.name]);if(a.length===0)return null;const u=e?a:a.slice(0,3),h=a.length>3;return z.jsxs("div",{className:"fixed bottom-[140px] md:bottom-[150px] right-2.5 z-[900]",children:[z.jsxs(Qi.button,{onClick:()=>t(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[z.jsx(OY,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&z.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),z.jsx(Au,{children:n&&z.jsxs(Qi.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[z.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),z.jsx("div",{className:"space-y-3",children:u.map(d=>{const g=s[d.name]??d.default;return z.jsxs("div",{children:[z.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:d.name,children:d.name}),z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>o(d.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${pnt[d.color]}`}),z.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right",children:[Math.round(g*100),"%"]})]})]},d.name)})}),h&&z.jsx("button",{onClick:()=>i(!e),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:e?z.jsxs(z.Fragment,{children:[z.jsx(u3,{size:14}),"Minder tonen"]}):z.jsxs(z.Fragment,{children:[z.jsx(oY,{size:14}),a.length-3," meer..."]})})]})})]})}function ynt(){const n=Ki(M=>M.map),t=Oe(M=>M.position),e=en(M=>M.startNavigation);en(M=>M.isNavigating);const i=en(M=>M.loading),[r,s]=nt.useState(""),[o,a]=nt.useState([]),[u,h]=nt.useState(!1),[d,g]=nt.useState(!1),m=nt.useRef(null),v=nt.useRef();nt.useEffect(()=>{if(v.current&&clearTimeout(v.current),r.length<2){a([]);return}return v.current=window.setTimeout(async()=>{g(!0);try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();L.response?.docs&&a(L.response.docs)}catch(M){console.error("Search error:",M),a([])}finally{g(!1)}},300),()=>{v.current&&clearTimeout(v.current)}},[r]);const y=async M=>{try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(M)}`)).json();if(D.response?.docs?.[0]?.centroide_ll){const b=D.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(b)return{lng:parseFloat(b[1]),lat:parseFloat(b[2])}}}catch(L){console.error("Lookup error:",L)}return null},S=async M=>{if(!n)return;const L=await y(M.id);L&&n.getView().animate({center:tu([L.lng,L.lat]),zoom:16,duration:1e3}),s(""),a([]),h(!1)},w=async(M,L)=>{if(L.stopPropagation(),!t){alert("GPS positie niet beschikbaar. Zet GPS aan.");return}const D=await y(M.id);D&&await e(D,M.weergavenaam,{lng:t.lng,lat:t.lat}),s(""),a([]),h(!1)},R=()=>{s(""),a([]),m.current?.focus()},P=M=>{switch(M){case"adres":return"";case"weg":return"";case"woonplaats":return"";case"gemeente":return"";case"provincie":return"";case"postcode":return"";default:return""}};return z.jsxs("div",{className:"search-box",children:[z.jsxs("div",{className:"search-input-wrapper",children:[z.jsx(d3,{size:18,className:"search-icon"}),z.jsx("input",{ref:m,type:"text",value:r,onChange:M=>{s(M.target.value),h(!0)},onFocus:()=>h(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),r&&z.jsx("button",{onClick:R,className:"search-clear",children:z.jsx(Bg,{size:16})})]}),u&&o.length>0&&z.jsx("ul",{className:"search-results",children:o.map(M=>z.jsxs("li",{className:"search-result-item",children:[z.jsxs("div",{className:"search-result-content",onClick:()=>S(M),children:[z.jsx("span",{className:"search-result-icon",children:P(M.type)}),z.jsx("span",{className:"search-result-text",children:M.weergavenaam})]}),z.jsx("button",{className:"search-navigate-btn",onClick:L=>w(M,L),disabled:i||!t,title:t?"Navigeer hierheen":"GPS niet actief",children:z.jsx(sS,{size:16})})]},M.id))}),u&&d&&z.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function vnt(n,t){const i=(t.lat-n.lat)*Math.PI/180,r=(t.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function Ent(n,t){let e=1/0,i=0;for(let r=0;r<t.length;r++){const s=vnt(n,t[r]);s<e&&(e=s,i=r)}return i}function wnt(){const n=Ki(a=>a.map),t=en(a=>a.routeCoordinates),e=en(a=>a.destination),i=en(a=>a.isNavigating),r=Oe(a=>a.position),s=nt.useRef(null),o=nt.useRef(0);return nt.useEffect(()=>{if(!n)return;const a=new Vb;return s.current=new t4({source:a,zIndex:500}),n.addLayer(s.current),()=>{s.current&&n&&n.removeLayer(s.current)}},[n]),nt.useEffect(()=>{i||(o.current=0)},[i]),nt.useEffect(()=>{if(!s.current)return;const a=s.current.getSource();if(!a||(a.clear(),!i||!t||t.length===0))return;let u=0;if(r&&t.length>2){const m={lng:r.lng,lat:r.lat},v=Ent(m,t);v>o.current&&(o.current=v),u=o.current,u>t.length-2&&(u=t.length-2)}const d=t.slice(u).map(m=>tu([m.lng,m.lat])),g=new s0({geometry:new h0(d)});if(g.setStyle([new Tr({stroke:new Ia({color:"white",width:8,lineCap:"round",lineJoin:"round"})}),new Tr({stroke:new Ia({color:"#4285F4",width:5,lineCap:"round",lineJoin:"round"})})]),a.addFeature(g),e){const m=new s0({geometry:new d0(tu([e.lng,e.lat]))});m.setStyle(new Tr({image:new Ch({radius:12,fill:new La({color:"#EA4335"}),stroke:new Ia({color:"white",width:3})})})),a.addFeature(m)}if(n&&u===0){const m=a.getExtent();n.getView().fit(m,{padding:[80,80,80,80],duration:500})}},[n,i,t,e,r]),null}function xnt(n){const t={size:24,className:"text-white"};return n.includes("left")?n.includes("sharp")?z.jsx(_Y,{...t}):n.includes("slight")?z.jsx(QX,{...t}):z.jsx(HX,{...t}):n.includes("right")?n.includes("sharp")?z.jsx(vY,{...t}):n.includes("slight")?z.jsx(tY,{...t}):z.jsx(YX,{...t}):n.includes("uturn")?z.jsx(Sw,{...t}):n.includes("arrive")?z.jsx(fY,{...t}):n.includes("roundabout")||n.includes("rotary")?z.jsx(Sw,{...t}):z.jsx(nY,{...t})}function Tnt(){const n=en(m=>m.isNavigating),t=en(m=>m.destinationName),e=en(m=>m.distance),i=en(m=>m.duration),r=en(m=>m.steps),s=en(m=>m.currentStepIndex),o=en(m=>m.voiceEnabled),a=en(m=>m.setVoiceEnabled),u=en(m=>m.stopNavigation),h=r[s],d=m=>m?m<1e3?`${Math.round(m)} m`:`${(m/1e3).toFixed(1)} km`:"--",g=m=>{if(!m)return"--";if(m<60)return`${Math.round(m)} sec`;const v=Math.round(m/60);if(v<60)return`${v} min`;const y=Math.floor(v/60),S=v%60;return`${y}u ${S}m`};return z.jsx(Au,{children:n&&z.jsxs(Qi.div,{className:"fixed top-16 left-2 right-2 z-[1100] bg-white rounded-xl shadow-lg overflow-hidden",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:[h&&z.jsxs("div",{className:"bg-blue-600 px-4 py-3 flex items-center gap-3",children:[z.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-700 flex items-center justify-center flex-shrink-0",children:xnt(h.maneuver)}),z.jsxs("div",{className:"flex-1 min-w-0",children:[z.jsx("div",{className:"text-white font-bold text-lg truncate",children:h.instruction}),z.jsxs("div",{className:"text-blue-200 text-sm",children:["Over ",d(h.distance)]})]}),z.jsx("button",{onClick:()=>a(!o),className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-colors ${o?"bg-blue-700 text-white":"bg-blue-800 text-blue-400"}`,title:o?"Geluid uit":"Geluid aan",children:o?z.jsx(UY,{size:20}):z.jsx(zY,{size:20})})]}),z.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-t border-gray-100",children:[z.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:z.jsx(sS,{size:20,className:"text-gray-600"})}),z.jsxs("div",{className:"flex-1 min-w-0",children:[z.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[z.jsx(h3,{size:12}),z.jsx("span",{children:"Bestemming"})]}),z.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:t||"Bestemming"})]}),z.jsxs("div",{className:"text-right flex-shrink-0",children:[z.jsx("div",{className:"text-lg font-bold text-blue-600",children:d(e)}),z.jsx("div",{className:"text-xs text-gray-500",children:g(i)})]}),z.jsx("button",{onClick:u,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center flex-shrink-0 transition-colors",title:"Stop navigatie",children:z.jsx(Bg,{size:20,className:"text-white"})})]}),r.length>1&&z.jsxs("div",{className:"px-4 pb-2",children:[z.jsx("div",{className:"flex gap-1",children:r.map((m,v)=>z.jsx("div",{className:`h-1 flex-1 rounded-full transition-colors ${v<s?"bg-green-500":v===s?"bg-blue-500":"bg-gray-200"}`},v))}),z.jsxs("div",{className:"text-xs text-gray-400 mt-1 text-center",children:["Stap ",s+1," van ",r.length]})]})]})})}function Snt(){const n=Oe(i=>i.tracking),t=Oe(i=>i.headingSource),e=Oe(i=>i.updateHeading);nt.useEffect(()=>{if(!n||t!=="compass")return;let i=0;const r=100,s=u=>{const h=Date.now();h-i<r||(i=h,u.alpha!==null&&e(360-u.alpha,"compass"))},o=u=>{const h=Date.now();h-i<r||(i=h,u.alpha!==null&&e(360-u.alpha,"compass"))},a=u=>{const h=Date.now();h-i<r||(i=h,u.webkitCompassHeading!==void 0&&e(u.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",o),window.addEventListener("deviceorientation",s),window.addEventListener("deviceorientation",a),()=>{window.removeEventListener("deviceorientationabsolute",o),window.removeEventListener("deviceorientation",s),window.removeEventListener("deviceorientation",a)}},[n,t,e])}const Int=n=>n<.5?2*n*n:-1+(4-2*n)*n;function Ant(){const n=Ki(u=>u.map),t=Ki(u=>u.rotationEnabled),e=Ki(u=>u.setRotation),i=Oe(u=>u.smoothHeading),r=Oe(u=>u.tracking),s=Oe(u=>u.navigationMode),o=nt.useRef(null),a=nt.useRef(null);nt.useEffect(()=>{n&&(s==="drive"&&a.current!=="drive"&&(n.getView().animate({zoom:15,duration:500}),console.log(" Rijmodus: zoom naar wijkniveau (15)")),a.current=s)},[n,s]),nt.useEffect(()=>{if(s==="free"){n&&n.getView().getRotation()!==0&&(n.getView().animate({rotation:0,duration:500}),e(0),o.current=null);return}if(!n||!r||!t||i===null){n&&!r&&(n.getView().animate({rotation:0,duration:500}),e(0),o.current=null);return}const u=i*Math.PI/180,h=o.current??n.getView().getRotation();let d=u-h;for(;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;Math.abs(d)<.087||(n.getView().animate({rotation:u,duration:250,easing:Int}),o.current=u,e(i))},[n,r,t,i,e])}function Rnt(){const n=Ki(d=>d.map),t=Oe(d=>d.position),e=Oe(d=>d.tracking),i=Oe(d=>d.navigationMode),r=Oe(d=>d.toggleMode),s=en(d=>d.isNavigating),o=en(d=>d.updateCurrentStep),a=en(d=>d.destination),u=nt.useRef(!1),h=nt.useRef(0);return nt.useEffect(()=>{s&&!u.current?(console.log(" Navigation started - activating drive mode"),i==="free"&&r(),u.current=!0):!s&&u.current&&(console.log(" Navigation stopped - deactivating drive mode"),i==="drive"&&r(),u.current=!1)},[s,i,r]),nt.useEffect(()=>{!s||!t||o({lng:t.lng,lat:t.lat})},[s,t,o]),nt.useEffect(()=>{if(!n||!t||!s||!e)return;const d=Date.now();if(d-h.current<500)return;h.current=d;const g=tu([t.lng,t.lat]);n.getView().animate({center:g,duration:300})},[n,t,s,e]),nt.useEffect(()=>{if(!n||!s)return;(n.getView().getZoom()||15)<14&&n.getView().animate({zoom:15,duration:500})},[n,s,t]),{isNavigating:s,destination:a}}function Pnt(){return Snt(),Ant(),Rnt(),z.jsxs(z.Fragment,{children:[z.jsx(mW,{}),z.jsx(XY,{}),z.jsx(wnt,{}),z.jsx(snt,{}),z.jsx(ont,{}),z.jsx(ynt,{}),z.jsx(Tnt,{}),z.jsx(qY,{}),z.jsx(YY,{}),z.jsx(ZY,{}),z.jsx(_nt,{}),z.jsx(ant,{}),z.jsx(gnt,{})]})}JO.createRoot(document.getElementById("root")).render(z.jsx(Pnt,{}));export{d0 as $,V2 as A,So as B,Bb as C,VA as D,qt as E,l4 as F,t4 as G,Tr as H,jt as I,Ia as J,La as K,b_ as L,Vb as M,Fl as N,nx as O,T5 as P,iE as Q,Fw as R,Ob as S,Ac as T,Bv as U,Xn as V,q2 as W,qd as X,Mnt as Y,bnt as Z,s0 as _,lF as a,tu as a0,J5 as a1,Dw as a2,m_ as a3,l5 as a4,x_ as a5,f_ as a6,ub as a7,cb as a8,Nnt as a9,u0 as aA,bb as aB,dE as aC,rh as aD,t6 as aE,ix as aF,c0 as aa,h0 as ab,mb as ac,aE as ad,r6 as ae,Vnt as af,hb as ag,Wc as ah,Ul as ai,BM as aj,Kw as ak,knt as al,Lnt as am,Ont as an,$nt as ao,Bnt as ap,Z2 as aq,q6 as ar,H6 as as,znt as at,Gnt as au,Of as av,Fnt as aw,Dnt as ax,jr as ay,oe as az,In as b,sh as c,ue as d,Jn as e,_a as f,Kl as g,Ai as h,v_ as i,Ud as j,_o as k,Unt as l,Ql as m,pE as n,MV as o,ae as p,bV as q,PV as r,Lw as s,Lp as t,Fe as u,Mf as v,sp as w,J1 as x,Un as y,jnt as z};
//# sourceMappingURL=index-1CYg9ZBT.js.map
