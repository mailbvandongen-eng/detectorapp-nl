const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-DlTFFjw2.js","assets/iconStyles-O6B-VD4N.js","assets/amkOL-qTpMaKgr.js","assets/layerLoaderOL-DqJ0_Igt.js","assets/romeinsOL-DPUD0Pi0.js","assets/kastelenOL-Z2OWuYsZ.js","assets/ruinesOL-Wdx_izcP.js","assets/hunebeddenOL-C__wMPqS.js","assets/uikavArcheoPuntenOL-BLO2uWLx.js","assets/uikavVlakkenOL-BldPwKd-.js","assets/uikavBufferlaagOL-De5jm-Kr.js","assets/uikavExpertOL-DpWx_9xL.js","assets/uikavUiterwaardenOL-CL4Lkpjd.js","assets/speeltuinenOL-BEq28gbi.js","assets/museaOL-Brm3YSvJ.js","assets/strandjesOL-wdm75wpA.js","assets/parkenOL-Cwy6NSCH.js","assets/kringloopwinkelsOL-DMB687zG.js","assets/fossielenOL-ZxqPxkFw.js","assets/fossielUtils-DvwOdGHF.js","assets/fossielenBelgieOL-nJiEWqIi.js","assets/fossielenDuitslandOL-DHKveEpP.js","assets/fossielenFrankrijkOL-v3IQSkQU.js","assets/bunkersOL-CPMqvp-4.js","assets/grafheuvelsOL-DJ6KNvpN.js","assets/slagveldenOL-BqzeECzc.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function FA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var J2={exports:{}},Jg={},eS={exports:{}},dn={};var I4;function XU(){if(I4)return dn;I4=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function m(se){return se===null||typeof se!="object"?null:(se=f&&se[f]||se["@@iterator"],typeof se=="function"?se:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function E(se,V,Q){this.props=se,this.context=V,this.refs=v,this.updater=Q||y}E.prototype.isReactComponent={},E.prototype.setState=function(se,V){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,V,"setState")},E.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function T(){}T.prototype=E.prototype;function b(se,V,Q){this.props=se,this.context=V,this.refs=v,this.updater=Q||y}var A=b.prototype=new T;A.constructor=b,x(A,E.prototype),A.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,U={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function R(se,V,Q){var ne,ie={},me=null,Ce=null;if(V!=null)for(ne in V.ref!==void 0&&(Ce=V.ref),V.key!==void 0&&(me=""+V.key),V)D.call(V,ne)&&!P.hasOwnProperty(ne)&&(ie[ne]=V[ne]);var Fe=arguments.length-2;if(Fe===1)ie.children=Q;else if(1<Fe){for(var fe=Array(Fe),le=0;le<Fe;le++)fe[le]=arguments[le+2];ie.children=fe}if(se&&se.defaultProps)for(ne in Fe=se.defaultProps,Fe)ie[ne]===void 0&&(ie[ne]=Fe[ne]);return{$$typeof:n,type:se,key:me,ref:Ce,props:ie,_owner:U.current}}function k(se,V){return{$$typeof:n,type:se.type,key:V,ref:se.ref,props:se.props,_owner:se._owner}}function N(se){return typeof se=="object"&&se!==null&&se.$$typeof===n}function O(se){var V={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(Q){return V[Q]})}var z=/\/+/g;function j(se,V){return typeof se=="object"&&se!==null&&se.key!=null?O(""+se.key):V.toString(36)}function Re(se,V,Q,ne,ie){var me=typeof se;(me==="undefined"||me==="boolean")&&(se=null);var Ce=!1;if(se===null)Ce=!0;else switch(me){case"string":case"number":Ce=!0;break;case"object":switch(se.$$typeof){case n:case e:Ce=!0}}if(Ce)return Ce=se,ie=ie(Ce),se=ne===""?"."+j(Ce,0):ne,M(ie)?(Q="",se!=null&&(Q=se.replace(z,"$&/")+"/"),Re(ie,V,Q,"",function(le){return le})):ie!=null&&(N(ie)&&(ie=k(ie,Q+(!ie.key||Ce&&Ce.key===ie.key?"":(""+ie.key).replace(z,"$&/")+"/")+se)),V.push(ie)),1;if(Ce=0,ne=ne===""?".":ne+":",M(se))for(var Fe=0;Fe<se.length;Fe++){me=se[Fe];var fe=ne+j(me,Fe);Ce+=Re(me,V,Q,fe,ie)}else if(fe=m(se),typeof fe=="function")for(se=fe.call(se),Fe=0;!(me=se.next()).done;)me=me.value,fe=ne+j(me,Fe++),Ce+=Re(me,V,Q,fe,ie);else if(me==="object")throw V=String(se),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Ce}function Ne(se,V,Q){if(se==null)return se;var ne=[],ie=0;return Re(se,ne,"","",function(me){return V.call(Q,me,ie++)}),ne}function Ve(se){if(se._status===-1){var V=se._result;V=V(),V.then(function(Q){(se._status===0||se._status===-1)&&(se._status=1,se._result=Q)},function(Q){(se._status===0||se._status===-1)&&(se._status=2,se._result=Q)}),se._status===-1&&(se._status=0,se._result=V)}if(se._status===1)return se._result.default;throw se._result}var Oe={current:null},ce={transition:null},we={ReactCurrentDispatcher:Oe,ReactCurrentBatchConfig:ce,ReactCurrentOwner:U};function Se(){throw Error("act(...) is not supported in production builds of React.")}return dn.Children={map:Ne,forEach:function(se,V,Q){Ne(se,function(){V.apply(this,arguments)},Q)},count:function(se){var V=0;return Ne(se,function(){V++}),V},toArray:function(se){return Ne(se,function(V){return V})||[]},only:function(se){if(!N(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},dn.Component=E,dn.Fragment=t,dn.Profiler=i,dn.PureComponent=b,dn.StrictMode=r,dn.Suspense=l,dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=we,dn.act=Se,dn.cloneElement=function(se,V,Q){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var ne=x({},se.props),ie=se.key,me=se.ref,Ce=se._owner;if(V!=null){if(V.ref!==void 0&&(me=V.ref,Ce=U.current),V.key!==void 0&&(ie=""+V.key),se.type&&se.type.defaultProps)var Fe=se.type.defaultProps;for(fe in V)D.call(V,fe)&&!P.hasOwnProperty(fe)&&(ne[fe]=V[fe]===void 0&&Fe!==void 0?Fe[fe]:V[fe])}var fe=arguments.length-2;if(fe===1)ne.children=Q;else if(1<fe){Fe=Array(fe);for(var le=0;le<fe;le++)Fe[le]=arguments[le+2];ne.children=Fe}return{$$typeof:n,type:se.type,key:ie,ref:me,props:ne,_owner:Ce}},dn.createContext=function(se){return se={$$typeof:a,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:s,_context:se},se.Consumer=se},dn.createElement=R,dn.createFactory=function(se){var V=R.bind(null,se);return V.type=se,V},dn.createRef=function(){return{current:null}},dn.forwardRef=function(se){return{$$typeof:o,render:se}},dn.isValidElement=N,dn.lazy=function(se){return{$$typeof:h,_payload:{_status:-1,_result:se},_init:Ve}},dn.memo=function(se,V){return{$$typeof:c,type:se,compare:V===void 0?null:V}},dn.startTransition=function(se){var V=ce.transition;ce.transition={};try{se()}finally{ce.transition=V}},dn.unstable_act=Se,dn.useCallback=function(se,V){return Oe.current.useCallback(se,V)},dn.useContext=function(se){return Oe.current.useContext(se)},dn.useDebugValue=function(){},dn.useDeferredValue=function(se){return Oe.current.useDeferredValue(se)},dn.useEffect=function(se,V){return Oe.current.useEffect(se,V)},dn.useId=function(){return Oe.current.useId()},dn.useImperativeHandle=function(se,V,Q){return Oe.current.useImperativeHandle(se,V,Q)},dn.useInsertionEffect=function(se,V){return Oe.current.useInsertionEffect(se,V)},dn.useLayoutEffect=function(se,V){return Oe.current.useLayoutEffect(se,V)},dn.useMemo=function(se,V){return Oe.current.useMemo(se,V)},dn.useReducer=function(se,V,Q){return Oe.current.useReducer(se,V,Q)},dn.useRef=function(se){return Oe.current.useRef(se)},dn.useState=function(se){return Oe.current.useState(se)},dn.useSyncExternalStore=function(se,V,Q){return Oe.current.useSyncExternalStore(se,V,Q)},dn.useTransition=function(){return Oe.current.useTransition()},dn.version="18.3.1",dn}var C4;function i1(){return C4||(C4=1,eS.exports=XU()),eS.exports}var P4;function qU(){if(P4)return Jg;P4=1;var n=i1(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var h,f={},m=null,y=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(f[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:o,key:m,ref:y,props:f,_owner:i.current}}return Jg.Fragment=t,Jg.jsx=a,Jg.jsxs=a,Jg}var k4;function YU(){return k4||(k4=1,J2.exports=qU()),J2.exports}var g=YU(),r_={},tS={exports:{}},Ps={},nS={exports:{}},rS={};var M4;function ZU(){return M4||(M4=1,(function(n){function e(ce,we){var Se=ce.length;ce.push(we);e:for(;0<Se;){var se=Se-1>>>1,V=ce[se];if(0<i(V,we))ce[se]=we,ce[Se]=V,Se=se;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var we=ce[0],Se=ce.pop();if(Se!==we){ce[0]=Se;e:for(var se=0,V=ce.length,Q=V>>>1;se<Q;){var ne=2*(se+1)-1,ie=ce[ne],me=ne+1,Ce=ce[me];if(0>i(ie,Se))me<V&&0>i(Ce,ie)?(ce[se]=Ce,ce[me]=Se,se=me):(ce[se]=ie,ce[ne]=Se,se=ne);else if(me<V&&0>i(Ce,Se))ce[se]=Ce,ce[me]=Se,se=me;else break e}}return we}function i(ce,we){var Se=ce.sortIndex-we.sortIndex;return Se!==0?Se:ce.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,f=null,m=3,y=!1,x=!1,v=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(ce){for(var we=t(c);we!==null;){if(we.callback===null)r(c);else if(we.startTime<=ce)r(c),we.sortIndex=we.expirationTime,e(l,we);else break;we=t(c)}}function M(ce){if(v=!1,A(ce),!x)if(t(l)!==null)x=!0,Ve(D);else{var we=t(c);we!==null&&Oe(M,we.startTime-ce)}}function D(ce,we){x=!1,v&&(v=!1,T(R),R=-1),y=!0;var Se=m;try{for(A(we),f=t(l);f!==null&&(!(f.expirationTime>we)||ce&&!O());){var se=f.callback;if(typeof se=="function"){f.callback=null,m=f.priorityLevel;var V=se(f.expirationTime<=we);we=n.unstable_now(),typeof V=="function"?f.callback=V:f===t(l)&&r(l),A(we)}else r(l);f=t(l)}if(f!==null)var Q=!0;else{var ne=t(c);ne!==null&&Oe(M,ne.startTime-we),Q=!1}return Q}finally{f=null,m=Se,y=!1}}var U=!1,P=null,R=-1,k=5,N=-1;function O(){return!(n.unstable_now()-N<k)}function z(){if(P!==null){var ce=n.unstable_now();N=ce;var we=!0;try{we=P(!0,ce)}finally{we?j():(U=!1,P=null)}}else U=!1}var j;if(typeof b=="function")j=function(){b(z)};else if(typeof MessageChannel<"u"){var Re=new MessageChannel,Ne=Re.port2;Re.port1.onmessage=z,j=function(){Ne.postMessage(null)}}else j=function(){E(z,0)};function Ve(ce){P=ce,U||(U=!0,j())}function Oe(ce,we){R=E(function(){ce(n.unstable_now())},we)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){x||y||(x=!0,Ve(D))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ce){switch(m){case 1:case 2:case 3:var we=3;break;default:we=m}var Se=m;m=we;try{return ce()}finally{m=Se}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,we){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var Se=m;m=ce;try{return we()}finally{m=Se}},n.unstable_scheduleCallback=function(ce,we,Se){var se=n.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?se+Se:se):Se=se,ce){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Se+V,ce={id:h++,callback:we,priorityLevel:ce,startTime:Se,expirationTime:V,sortIndex:-1},Se>se?(ce.sortIndex=Se,e(c,ce),t(l)===null&&ce===t(c)&&(v?(T(R),R=-1):v=!0,Oe(M,Se-se))):(ce.sortIndex=V,e(l,ce),x||y||(x=!0,Ve(D))),ce},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(ce){var we=m;return function(){var Se=m;m=we;try{return ce.apply(this,arguments)}finally{m=Se}}}})(rS)),rS}var N4;function QU(){return N4||(N4=1,nS.exports=ZU()),nS.exports}var L4;function JU(){if(L4)return Ps;L4=1;var n=i1(),e=QU();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(u,d){a(u,d),a(u+"Capture",d)}function a(u,d){for(i[u]=d,u=0;u<d.length;u++)r.add(d[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function m(u){return l.call(f,u)?!0:l.call(h,u)?!1:c.test(u)?f[u]=!0:(h[u]=!0,!1)}function y(u,d,p,w){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function x(u,d,p,w){if(d===null||typeof d>"u"||y(u,d,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function v(u,d,p,w,S,I,G){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=w,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=u,this.type=d,this.sanitizeURL=I,this.removeEmptyString=G}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){E[u]=new v(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];E[d]=new v(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){E[u]=new v(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){E[u]=new v(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){E[u]=new v(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){E[u]=new v(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){E[u]=new v(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){E[u]=new v(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){E[u]=new v(u,5,!1,u.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function b(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(T,b);E[d]=new v(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(T,b);E[d]=new v(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(T,b);E[d]=new v(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){E[u]=new v(u,1,!1,u.toLowerCase(),null,!1,!1)}),E.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){E[u]=new v(u,1,!1,u.toLowerCase(),null,!0,!0)});function A(u,d,p,w){var S=E.hasOwnProperty(d)?E[d]:null;(S!==null?S.type!==0:w||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(x(d,p,S,w)&&(p=null),w||S===null?m(d)&&(p===null?u.removeAttribute(d):u.setAttribute(d,""+p)):S.mustUseProperty?u[S.propertyName]=p===null?S.type===3?!1:"":p:(d=S.attributeName,w=S.attributeNamespace,p===null?u.removeAttribute(d):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,w?u.setAttributeNS(w,d,p):u.setAttribute(d,p))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),U=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),O=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),Re=Symbol.for("react.suspense_list"),Ne=Symbol.for("react.memo"),Ve=Symbol.for("react.lazy"),Oe=Symbol.for("react.offscreen"),ce=Symbol.iterator;function we(u){return u===null||typeof u!="object"?null:(u=ce&&u[ce]||u["@@iterator"],typeof u=="function"?u:null)}var Se=Object.assign,se;function V(u){if(se===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);se=d&&d[1]||""}return`
`+se+u}var Q=!1;function ne(u,d){if(!u||Q)return"";Q=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Pe){var w=Pe}Reflect.construct(u,[],d)}else{try{d.call()}catch(Pe){w=Pe}u.call(d.prototype)}else{try{throw Error()}catch(Pe){w=Pe}u()}}catch(Pe){if(Pe&&w&&typeof Pe.stack=="string"){for(var S=Pe.stack.split(`
`),I=w.stack.split(`
`),G=S.length-1,re=I.length-1;1<=G&&0<=re&&S[G]!==I[re];)re--;for(;1<=G&&0<=re;G--,re--)if(S[G]!==I[re]){if(G!==1||re!==1)do if(G--,re--,0>re||S[G]!==I[re]){var ae=`
`+S[G].replace(" at new "," at ");return u.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",u.displayName)),ae}while(1<=G&&0<=re);break}}}finally{Q=!1,Error.prepareStackTrace=p}return(u=u?u.displayName||u.name:"")?V(u):""}function ie(u){switch(u.tag){case 5:return V(u.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return u=ne(u.type,!1),u;case 11:return u=ne(u.type.render,!1),u;case 1:return u=ne(u.type,!0),u;default:return""}}function me(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case P:return"Fragment";case U:return"Portal";case k:return"Profiler";case R:return"StrictMode";case j:return"Suspense";case Re:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case O:return(u.displayName||"Context")+".Consumer";case N:return(u._context.displayName||"Context")+".Provider";case z:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Ne:return d=u.displayName||null,d!==null?d:me(u.type)||"Memo";case Ve:d=u._payload,u=u._init;try{return me(u(d))}catch{}}return null}function Ce(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(d);case 8:return d===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Fe(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function fe(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function le(u){var d=fe(u)?"checked":"value",p=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),w=""+u[d];if(!u.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,I=p.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return S.call(this)},set:function(G){w=""+G,I.call(this,G)}}),Object.defineProperty(u,d,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(G){w=""+G},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function yt(u){u._valueTracker||(u._valueTracker=le(u))}function St(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var p=d.getValue(),w="";return u&&(w=fe(u)?u.checked?"true":"false":u.value),u=w,u!==p?(d.setValue(u),!0):!1}function ln(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function kt(u,d){var p=d.checked;return Se({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??u._wrapperState.initialChecked})}function Dn(u,d){var p=d.defaultValue==null?"":d.defaultValue,w=d.checked!=null?d.checked:d.defaultChecked;p=Fe(d.value!=null?d.value:p),u._wrapperState={initialChecked:w,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function tn(u,d){d=d.checked,d!=null&&A(u,"checked",d,!1)}function lt(u,d){tn(u,d);var p=Fe(d.value),w=d.type;if(p!=null)w==="number"?(p===0&&u.value===""||u.value!=p)&&(u.value=""+p):u.value!==""+p&&(u.value=""+p);else if(w==="submit"||w==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?hn(u,d.type,p):d.hasOwnProperty("defaultValue")&&hn(u,d.type,Fe(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function nr(u,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var w=d.type;if(!(w!=="submit"&&w!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,p||d===u.value||(u.value=d),u.defaultValue=d}p=u.name,p!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,p!==""&&(u.name=p)}function hn(u,d,p){(d!=="number"||ln(u.ownerDocument)!==u)&&(p==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+p&&(u.defaultValue=""+p))}var rn=Array.isArray;function rr(u,d,p,w){if(u=u.options,d){d={};for(var S=0;S<p.length;S++)d["$"+p[S]]=!0;for(p=0;p<u.length;p++)S=d.hasOwnProperty("$"+u[p].value),u[p].selected!==S&&(u[p].selected=S),S&&w&&(u[p].defaultSelected=!0)}else{for(p=""+Fe(p),d=null,S=0;S<u.length;S++){if(u[S].value===p){u[S].selected=!0,w&&(u[S].defaultSelected=!0);return}d!==null||u[S].disabled||(d=u[S])}d!==null&&(d.selected=!0)}}function mt(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return Se({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Ut(u,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(rn(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}u._wrapperState={initialValue:Fe(p)}}function Fn(u,d){var p=Fe(d.value),w=Fe(d.defaultValue);p!=null&&(p=""+p,p!==u.value&&(u.value=p),d.defaultValue==null&&u.defaultValue!==p&&(u.defaultValue=p)),w!=null&&(u.defaultValue=""+w)}function xt(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function nn(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nt(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?nn(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var cr,_i=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,w,S){MSApp.execUnsafeLocalFunction(function(){return u(d,p,w,S)})}:u})(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(cr=cr||document.createElement("div"),cr.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=cr.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function Kr(u,d){if(d){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=d;return}}u.textContent=d}var Wt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fs=["Webkit","ms","Moz","O"];Object.keys(Wt).forEach(function(u){fs.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),Wt[d]=Wt[u]})});function je(u,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||Wt.hasOwnProperty(u)&&Wt[u]?(""+d).trim():d+"px"}function be(u,d){u=u.style;for(var p in d)if(d.hasOwnProperty(p)){var w=p.indexOf("--")===0,S=je(p,d[p],w);p==="float"&&(p="cssFloat"),w?u.setProperty(p,S):u[p]=S}}var _e=Se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lt(u,d){if(d){if(_e[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function L(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ot=null;function W(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Z=null,Y=null,ue=null;function he(u){if(u=jg(u)){if(typeof Z!="function")throw Error(t(280));var d=u.stateNode;d&&(d=_y(d),Z(u.stateNode,u.type,d))}}function Be(u){Y?ue?ue.push(u):ue=[u]:Y=u}function Ie(){if(Y){var u=Y,d=ue;if(ue=Y=null,he(u),d)for(u=0;u<d.length;u++)he(d[u])}}function $e(u,d){return u(d)}function et(){}var ft=!1;function Rt(u,d,p){if(ft)return u(d,p);ft=!0;try{return $e(u,d,p)}finally{ft=!1,(Y!==null||ue!==null)&&(et(),Ie())}}function cn(u,d){var p=u.stateNode;if(p===null)return null;var w=_y(p);if(w===null)return null;p=w[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(u=u.type,w=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!w;break e;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var mr=!1;if(o)try{var pn={};Object.defineProperty(pn,"passive",{get:function(){mr=!0}}),window.addEventListener("test",pn,pn),window.removeEventListener("test",pn,pn)}catch{mr=!1}function pr(u,d,p,w,S,I,G,re,ae){var Pe=Array.prototype.slice.call(arguments,3);try{d.apply(p,Pe)}catch(He){this.onError(He)}}var Tr=!1,Ki=null,B=!1,J=null,K={onError:function(u){Tr=!0,Ki=u}};function q(u,d,p,w,S,I,G,re,ae){Tr=!1,Ki=null,pr.apply(K,arguments)}function ee(u,d,p,w,S,I,G,re,ae){if(q.apply(this,arguments),Tr){if(Tr){var Pe=Ki;Tr=!1,Ki=null}else throw Error(t(198));B||(B=!0,J=Pe)}}function te(u){var d=u,p=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(p=d.return),u=d.return;while(u)}return d.tag===3?p:null}function ve(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function Le(u){if(te(u)!==u)throw Error(t(188))}function xe(u){var d=u.alternate;if(!d){if(d=te(u),d===null)throw Error(t(188));return d!==u?null:u}for(var p=u,w=d;;){var S=p.return;if(S===null)break;var I=S.alternate;if(I===null){if(w=S.return,w!==null){p=w;continue}break}if(S.child===I.child){for(I=S.child;I;){if(I===p)return Le(S),u;if(I===w)return Le(S),d;I=I.sibling}throw Error(t(188))}if(p.return!==w.return)p=S,w=I;else{for(var G=!1,re=S.child;re;){if(re===p){G=!0,p=S,w=I;break}if(re===w){G=!0,w=S,p=I;break}re=re.sibling}if(!G){for(re=I.child;re;){if(re===p){G=!0,p=I,w=S;break}if(re===w){G=!0,w=I,p=S;break}re=re.sibling}if(!G)throw Error(t(189))}}if(p.alternate!==w)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?u:d}function Te(u){return u=xe(u),u!==null?Ae(u):null}function Ae(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=Ae(u);if(d!==null)return d;u=u.sibling}return null}var Ke=e.unstable_scheduleCallback,tt=e.unstable_cancelCallback,gt=e.unstable_shouldYield,Xe=e.unstable_requestPaint,qe=e.unstable_now,Ht=e.unstable_getCurrentPriorityLevel,jn=e.unstable_ImmediatePriority,zn=e.unstable_UserBlockingPriority,yr=e.unstable_NormalPriority,Ha=e.unstable_LowPriority,ya=e.unstable_IdlePriority,Xs=null,Br=null;function xc(u){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Xs,u,void 0,(u.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:Xu,bo=Math.log,_a=Math.LN2;function Xu(u){return u>>>=0,u===0?32:31-(bo(u)/_a|0)|0}var Ao=64,vc=4194304;function Pn(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function _l(u,d){var p=u.pendingLanes;if(p===0)return 0;var w=0,S=u.suspendedLanes,I=u.pingedLanes,G=p&268435455;if(G!==0){var re=G&~S;re!==0?w=Pn(re):(I&=G,I!==0&&(w=Pn(I)))}else G=p&~S,G!==0?w=Pn(G):I!==0&&(w=Pn(I));if(w===0)return 0;if(d!==0&&d!==w&&(d&S)===0&&(S=w&-w,I=d&-d,S>=I||S===16&&(I&4194240)!==0))return d;if((w&4)!==0&&(w|=p&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=w;0<d;)p=31-br(d),S=1<<p,w|=u[p],d&=~S;return w}function qu(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yu(u,d){for(var p=u.suspendedLanes,w=u.pingedLanes,S=u.expirationTimes,I=u.pendingLanes;0<I;){var G=31-br(I),re=1<<G,ae=S[G];ae===-1?((re&p)===0||(re&w)!==0)&&(S[G]=qu(re,d)):ae<=d&&(u.expiredLanes|=re),I&=~re}}function yg(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function _g(){var u=Ao;return Ao<<=1,(Ao&4194240)===0&&(Ao=64),u}function xg(u){for(var d=[],p=0;31>p;p++)d.push(u);return d}function Zu(u,d,p){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-br(d),u[d]=p}function kw(u,d){var p=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var w=u.eventTimes;for(u=u.expirationTimes;0<p;){var S=31-br(p),I=1<<S;d[S]=0,w[S]=-1,u[S]=-1,p&=~I}}function vg(u,d){var p=u.entangledLanes|=d;for(u=u.entanglements;p;){var w=31-br(p),S=1<<w;S&d|u[w]&d&&(u[w]|=d),p&=~S}}var vn=0;function Ro(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Eg,Vd,wg,Sg,Tg,Io=!1,Gd=[],Co=null,Po=null,Mi=null,Qu=new Map,xl=new Map,qs=[],ny="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ec(u,d){switch(u){case"focusin":case"focusout":Co=null;break;case"dragenter":case"dragleave":Po=null;break;case"mouseover":case"mouseout":Mi=null;break;case"pointerover":case"pointerout":Qu.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":xl.delete(d.pointerId)}}function Ka(u,d,p,w,S,I){return u===null||u.nativeEvent!==I?(u={blockedOn:d,domEventName:p,eventSystemFlags:w,nativeEvent:I,targetContainers:[S]},d!==null&&(d=jg(d),d!==null&&Vd(d)),u):(u.eventSystemFlags|=w,d=u.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),u)}function ry(u,d,p,w,S){switch(d){case"focusin":return Co=Ka(Co,u,d,p,w,S),!0;case"dragenter":return Po=Ka(Po,u,d,p,w,S),!0;case"mouseover":return Mi=Ka(Mi,u,d,p,w,S),!0;case"pointerover":var I=S.pointerId;return Qu.set(I,Ka(Qu.get(I)||null,u,d,p,w,S)),!0;case"gotpointercapture":return I=S.pointerId,xl.set(I,Ka(xl.get(I)||null,u,d,p,w,S)),!0}return!1}function Bd(u){var d=nh(u.target);if(d!==null){var p=te(d);if(p!==null){if(d=p.tag,d===13){if(d=ve(p),d!==null){u.blockedOn=d,Tg(u.priority,function(){wg(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function ir(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var p=Ud(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(p===null){p=u.nativeEvent;var w=new p.constructor(p.type,p);Ot=w,p.target.dispatchEvent(w),Ot=null}else return d=jg(p),d!==null&&Vd(d),u.blockedOn=p,!1;d.shift()}return!0}function iy(u,d,p){ir(u)&&p.delete(d)}function Mw(){Io=!1,Co!==null&&ir(Co)&&(Co=null),Po!==null&&ir(Po)&&(Po=null),Mi!==null&&ir(Mi)&&(Mi=null),Qu.forEach(iy),xl.forEach(iy)}function wc(u,d){u.blockedOn===d&&(u.blockedOn=null,Io||(Io=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Mw)))}function Sc(u){function d(S){return wc(S,u)}if(0<Gd.length){wc(Gd[0],u);for(var p=1;p<Gd.length;p++){var w=Gd[p];w.blockedOn===u&&(w.blockedOn=null)}}for(Co!==null&&wc(Co,u),Po!==null&&wc(Po,u),Mi!==null&&wc(Mi,u),Qu.forEach(d),xl.forEach(d),p=0;p<qs.length;p++)w=qs[p],w.blockedOn===u&&(w.blockedOn=null);for(;0<qs.length&&(p=qs[0],p.blockedOn===null);)Bd(p),p.blockedOn===null&&qs.shift()}var vl=M.ReactCurrentBatchConfig,El=!0;function ko(u,d,p,w){var S=vn,I=vl.transition;vl.transition=null;try{vn=1,bg(u,d,p,w)}finally{vn=S,vl.transition=I}}function sy(u,d,p,w){var S=vn,I=vl.transition;vl.transition=null;try{vn=4,bg(u,d,p,w)}finally{vn=S,vl.transition=I}}function bg(u,d,p,w){if(El){var S=Ud(u,d,p,w);if(S===null)zw(u,d,w,Mo,p),Ec(u,w);else if(ry(S,u,d,p,w))w.stopPropagation();else if(Ec(u,w),d&4&&-1<ny.indexOf(u)){for(;S!==null;){var I=jg(S);if(I!==null&&Eg(I),I=Ud(u,d,p,w),I===null&&zw(u,d,w,Mo,p),I===S)break;S=I}S!==null&&w.stopPropagation()}else zw(u,d,w,null,p)}}var Mo=null;function Ud(u,d,p,w){if(Mo=null,u=W(w),u=nh(u),u!==null)if(d=te(u),d===null)u=null;else if(p=d.tag,p===13){if(u=ve(d),u!==null)return u;u=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return Mo=u,null}function zd(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ht()){case jn:return 1;case zn:return 4;case yr:case Ha:return 16;case ya:return 536870912;default:return 16}default:return 16}}var Ys=null,$d=null,wl=null;function ay(){if(wl)return wl;var u,d=$d,p=d.length,w,S="value"in Ys?Ys.value:Ys.textContent,I=S.length;for(u=0;u<p&&d[u]===S[u];u++);var G=p-u;for(w=1;w<=G&&d[p-w]===S[I-w];w++);return wl=S.slice(u,1<w?1-w:void 0)}function Ju(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function No(){return!0}function Ag(){return!1}function Xi(u){function d(p,w,S,I,G){this._reactName=p,this._targetInst=S,this.type=w,this.nativeEvent=I,this.target=G,this.currentTarget=null;for(var re in u)u.hasOwnProperty(re)&&(p=u[re],this[re]=p?p(I):I[re]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?No:Ag,this.isPropagationStopped=Ag,this}return Se(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=No)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=No)},persist:function(){},isPersistent:No}),d}var Lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eh=Xi(Lo),Tc=Se({},Lo,{view:0,detail:0}),Wd=Xi(Tc),Hd,Kd,Zs,th=Se({},Tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:en,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Zs&&(Zs&&u.type==="mousemove"?(Hd=u.screenX-Zs.screenX,Kd=u.screenY-Zs.screenY):Kd=Hd=0,Zs=u),Hd)},movementY:function(u){return"movementY"in u?u.movementY:Kd}}),Rg=Xi(th),oy=Se({},th,{dataTransfer:0}),ly=Xi(oy),Xd=Se({},Tc,{relatedTarget:0}),Ni=Xi(Xd),cy=Se({},Lo,{animationName:0,elapsedTime:0,pseudoElement:0}),uy=Xi(cy),bc=Se({},Lo,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),_=Xi(bc),C=Se({},Lo,{data:0}),F=Xi(C),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ke={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function it(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=ke[u])?!!d[u]:!1}function en(){return it}var Ur=Se({},Tc,{key:function(u){if(u.key){var d=H[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=Ju(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?pe[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:en,charCode:function(u){return u.type==="keypress"?Ju(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Ju(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),$n=Xi(Ur),Xr=Se({},th,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qs=Xi(Xr),Sl=Se({},Tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:en}),Oo=Xi(Sl),Do=Se({},Lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),qd=Xi(Do),Ig=Se({},th,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),UB=Xi(Ig),zB=[9,13,27,32],Nw=o&&"CompositionEvent"in window,Cg=null;o&&"documentMode"in document&&(Cg=document.documentMode);var $B=o&&"TextEvent"in window&&!Cg,vP=o&&(!Nw||Cg&&8<Cg&&11>=Cg),EP=" ",wP=!1;function SP(u,d){switch(u){case"keyup":return zB.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TP(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Yd=!1;function WB(u,d){switch(u){case"compositionend":return TP(d);case"keypress":return d.which!==32?null:(wP=!0,EP);case"textInput":return u=d.data,u===EP&&wP?null:u;default:return null}}function HB(u,d){if(Yd)return u==="compositionend"||!Nw&&SP(u,d)?(u=ay(),wl=$d=Ys=null,Yd=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return vP&&d.locale!=="ko"?null:d.data;default:return null}}var KB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bP(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!KB[u.type]:d==="textarea"}function AP(u,d,p,w){Be(w),d=my(d,"onChange"),0<d.length&&(p=new eh("onChange","change",null,p,w),u.push({event:p,listeners:d}))}var Pg=null,kg=null;function XB(u){$P(u,0)}function hy(u){var d=tf(u);if(St(d))return u}function qB(u,d){if(u==="change")return d}var RP=!1;if(o){var Lw;if(o){var Ow="oninput"in document;if(!Ow){var IP=document.createElement("div");IP.setAttribute("oninput","return;"),Ow=typeof IP.oninput=="function"}Lw=Ow}else Lw=!1;RP=Lw&&(!document.documentMode||9<document.documentMode)}function CP(){Pg&&(Pg.detachEvent("onpropertychange",PP),kg=Pg=null)}function PP(u){if(u.propertyName==="value"&&hy(kg)){var d=[];AP(d,kg,u,W(u)),Rt(XB,d)}}function YB(u,d,p){u==="focusin"?(CP(),Pg=d,kg=p,Pg.attachEvent("onpropertychange",PP)):u==="focusout"&&CP()}function ZB(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return hy(kg)}function QB(u,d){if(u==="click")return hy(d)}function JB(u,d){if(u==="input"||u==="change")return hy(d)}function eU(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Xa=typeof Object.is=="function"?Object.is:eU;function Mg(u,d){if(Xa(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var p=Object.keys(u),w=Object.keys(d);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var S=p[w];if(!l.call(d,S)||!Xa(u[S],d[S]))return!1}return!0}function kP(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function MP(u,d){var p=kP(u);u=0;for(var w;p;){if(p.nodeType===3){if(w=u+p.textContent.length,u<=d&&w>=d)return{node:p,offset:d-u};u=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=kP(p)}}function NP(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?NP(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function LP(){for(var u=window,d=ln();d instanceof u.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)u=d.contentWindow;else break;d=ln(u.document)}return d}function Dw(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function tU(u){var d=LP(),p=u.focusedElem,w=u.selectionRange;if(d!==p&&p&&p.ownerDocument&&NP(p.ownerDocument.documentElement,p)){if(w!==null&&Dw(p)){if(d=w.start,u=w.end,u===void 0&&(u=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(u,p.value.length);else if(u=(d=p.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var S=p.textContent.length,I=Math.min(w.start,S);w=w.end===void 0?I:Math.min(w.end,S),!u.extend&&I>w&&(S=w,w=I,I=S),S=MP(p,I);var G=MP(p,w);S&&G&&(u.rangeCount!==1||u.anchorNode!==S.node||u.anchorOffset!==S.offset||u.focusNode!==G.node||u.focusOffset!==G.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),u.removeAllRanges(),I>w?(u.addRange(d),u.extend(G.node,G.offset)):(d.setEnd(G.node,G.offset),u.addRange(d)))}}for(d=[],u=p;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)u=d[p],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var nU=o&&"documentMode"in document&&11>=document.documentMode,Zd=null,Fw=null,Ng=null,jw=!1;function OP(u,d,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;jw||Zd==null||Zd!==ln(w)||(w=Zd,"selectionStart"in w&&Dw(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Ng&&Mg(Ng,w)||(Ng=w,w=my(Fw,"onSelect"),0<w.length&&(d=new eh("onSelect","select",null,d,p),u.push({event:d,listeners:w}),d.target=Zd)))}function dy(u,d){var p={};return p[u.toLowerCase()]=d.toLowerCase(),p["Webkit"+u]="webkit"+d,p["Moz"+u]="moz"+d,p}var Qd={animationend:dy("Animation","AnimationEnd"),animationiteration:dy("Animation","AnimationIteration"),animationstart:dy("Animation","AnimationStart"),transitionend:dy("Transition","TransitionEnd")},Vw={},DP={};o&&(DP=document.createElement("div").style,"AnimationEvent"in window||(delete Qd.animationend.animation,delete Qd.animationiteration.animation,delete Qd.animationstart.animation),"TransitionEvent"in window||delete Qd.transitionend.transition);function fy(u){if(Vw[u])return Vw[u];if(!Qd[u])return u;var d=Qd[u],p;for(p in d)if(d.hasOwnProperty(p)&&p in DP)return Vw[u]=d[p];return u}var FP=fy("animationend"),jP=fy("animationiteration"),VP=fy("animationstart"),GP=fy("transitionend"),BP=new Map,UP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ac(u,d){BP.set(u,d),s(d,[u])}for(var Gw=0;Gw<UP.length;Gw++){var Bw=UP[Gw],rU=Bw.toLowerCase(),iU=Bw[0].toUpperCase()+Bw.slice(1);Ac(rU,"on"+iU)}Ac(FP,"onAnimationEnd"),Ac(jP,"onAnimationIteration"),Ac(VP,"onAnimationStart"),Ac("dblclick","onDoubleClick"),Ac("focusin","onFocus"),Ac("focusout","onBlur"),Ac(GP,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sU=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lg));function zP(u,d,p){var w=u.type||"unknown-event";u.currentTarget=p,ee(w,d,void 0,u),u.currentTarget=null}function $P(u,d){d=(d&4)!==0;for(var p=0;p<u.length;p++){var w=u[p],S=w.event;w=w.listeners;e:{var I=void 0;if(d)for(var G=w.length-1;0<=G;G--){var re=w[G],ae=re.instance,Pe=re.currentTarget;if(re=re.listener,ae!==I&&S.isPropagationStopped())break e;zP(S,re,Pe),I=ae}else for(G=0;G<w.length;G++){if(re=w[G],ae=re.instance,Pe=re.currentTarget,re=re.listener,ae!==I&&S.isPropagationStopped())break e;zP(S,re,Pe),I=ae}}}if(B)throw u=J,B=!1,J=null,u}function ur(u,d){var p=d[qw];p===void 0&&(p=d[qw]=new Set);var w=u+"__bubble";p.has(w)||(WP(d,u,2,!1),p.add(w))}function Uw(u,d,p){var w=0;d&&(w|=4),WP(p,u,w,d)}var gy="_reactListening"+Math.random().toString(36).slice(2);function Og(u){if(!u[gy]){u[gy]=!0,r.forEach(function(p){p!=="selectionchange"&&(sU.has(p)||Uw(p,!1,u),Uw(p,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[gy]||(d[gy]=!0,Uw("selectionchange",!1,d))}}function WP(u,d,p,w){switch(zd(d)){case 1:var S=ko;break;case 4:S=sy;break;default:S=bg}p=S.bind(null,d,p,u),S=void 0,!mr||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),w?S!==void 0?u.addEventListener(d,p,{capture:!0,passive:S}):u.addEventListener(d,p,!0):S!==void 0?u.addEventListener(d,p,{passive:S}):u.addEventListener(d,p,!1)}function zw(u,d,p,w,S){var I=w;if((d&1)===0&&(d&2)===0&&w!==null)e:for(;;){if(w===null)return;var G=w.tag;if(G===3||G===4){var re=w.stateNode.containerInfo;if(re===S||re.nodeType===8&&re.parentNode===S)break;if(G===4)for(G=w.return;G!==null;){var ae=G.tag;if((ae===3||ae===4)&&(ae=G.stateNode.containerInfo,ae===S||ae.nodeType===8&&ae.parentNode===S))return;G=G.return}for(;re!==null;){if(G=nh(re),G===null)return;if(ae=G.tag,ae===5||ae===6){w=I=G;continue e}re=re.parentNode}}w=w.return}Rt(function(){var Pe=I,He=W(p),Ye=[];e:{var ze=BP.get(u);if(ze!==void 0){var _t=eh,Tt=u;switch(u){case"keypress":if(Ju(p)===0)break e;case"keydown":case"keyup":_t=$n;break;case"focusin":Tt="focus",_t=Ni;break;case"focusout":Tt="blur",_t=Ni;break;case"beforeblur":case"afterblur":_t=Ni;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_t=Rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_t=ly;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_t=Oo;break;case FP:case jP:case VP:_t=uy;break;case GP:_t=qd;break;case"scroll":_t=Wd;break;case"wheel":_t=UB;break;case"copy":case"cut":case"paste":_t=_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_t=Qs}var It=(d&4)!==0,zr=!It&&u==="scroll",ge=It?ze!==null?ze+"Capture":null:ze;It=[];for(var oe=Pe,Ee;oe!==null;){Ee=oe;var Je=Ee.stateNode;if(Ee.tag===5&&Je!==null&&(Ee=Je,ge!==null&&(Je=cn(oe,ge),Je!=null&&It.push(Dg(oe,Je,Ee)))),zr)break;oe=oe.return}0<It.length&&(ze=new _t(ze,Tt,null,p,He),Ye.push({event:ze,listeners:It}))}}if((d&7)===0){e:{if(ze=u==="mouseover"||u==="pointerover",_t=u==="mouseout"||u==="pointerout",ze&&p!==Ot&&(Tt=p.relatedTarget||p.fromElement)&&(nh(Tt)||Tt[Tl]))break e;if((_t||ze)&&(ze=He.window===He?He:(ze=He.ownerDocument)?ze.defaultView||ze.parentWindow:window,_t?(Tt=p.relatedTarget||p.toElement,_t=Pe,Tt=Tt?nh(Tt):null,Tt!==null&&(zr=te(Tt),Tt!==zr||Tt.tag!==5&&Tt.tag!==6)&&(Tt=null)):(_t=null,Tt=Pe),_t!==Tt)){if(It=Rg,Je="onMouseLeave",ge="onMouseEnter",oe="mouse",(u==="pointerout"||u==="pointerover")&&(It=Qs,Je="onPointerLeave",ge="onPointerEnter",oe="pointer"),zr=_t==null?ze:tf(_t),Ee=Tt==null?ze:tf(Tt),ze=new It(Je,oe+"leave",_t,p,He),ze.target=zr,ze.relatedTarget=Ee,Je=null,nh(He)===Pe&&(It=new It(ge,oe+"enter",Tt,p,He),It.target=Ee,It.relatedTarget=zr,Je=It),zr=Je,_t&&Tt)t:{for(It=_t,ge=Tt,oe=0,Ee=It;Ee;Ee=Jd(Ee))oe++;for(Ee=0,Je=ge;Je;Je=Jd(Je))Ee++;for(;0<oe-Ee;)It=Jd(It),oe--;for(;0<Ee-oe;)ge=Jd(ge),Ee--;for(;oe--;){if(It===ge||ge!==null&&It===ge.alternate)break t;It=Jd(It),ge=Jd(ge)}It=null}else It=null;_t!==null&&HP(Ye,ze,_t,It,!1),Tt!==null&&zr!==null&&HP(Ye,zr,Tt,It,!0)}}e:{if(ze=Pe?tf(Pe):window,_t=ze.nodeName&&ze.nodeName.toLowerCase(),_t==="select"||_t==="input"&&ze.type==="file")var Pt=qB;else if(bP(ze))if(RP)Pt=JB;else{Pt=ZB;var Vt=YB}else(_t=ze.nodeName)&&_t.toLowerCase()==="input"&&(ze.type==="checkbox"||ze.type==="radio")&&(Pt=QB);if(Pt&&(Pt=Pt(u,Pe))){AP(Ye,Pt,p,He);break e}Vt&&Vt(u,ze,Pe),u==="focusout"&&(Vt=ze._wrapperState)&&Vt.controlled&&ze.type==="number"&&hn(ze,"number",ze.value)}switch(Vt=Pe?tf(Pe):window,u){case"focusin":(bP(Vt)||Vt.contentEditable==="true")&&(Zd=Vt,Fw=Pe,Ng=null);break;case"focusout":Ng=Fw=Zd=null;break;case"mousedown":jw=!0;break;case"contextmenu":case"mouseup":case"dragend":jw=!1,OP(Ye,p,He);break;case"selectionchange":if(nU)break;case"keydown":case"keyup":OP(Ye,p,He)}var Gt;if(Nw)e:{switch(u){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else Yd?SP(u,p)&&(Kt="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(Kt="onCompositionStart");Kt&&(vP&&p.locale!=="ko"&&(Yd||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&Yd&&(Gt=ay()):(Ys=He,$d="value"in Ys?Ys.value:Ys.textContent,Yd=!0)),Vt=my(Pe,Kt),0<Vt.length&&(Kt=new F(Kt,u,null,p,He),Ye.push({event:Kt,listeners:Vt}),Gt?Kt.data=Gt:(Gt=TP(p),Gt!==null&&(Kt.data=Gt)))),(Gt=$B?WB(u,p):HB(u,p))&&(Pe=my(Pe,"onBeforeInput"),0<Pe.length&&(He=new F("onBeforeInput","beforeinput",null,p,He),Ye.push({event:He,listeners:Pe}),He.data=Gt))}$P(Ye,d)})}function Dg(u,d,p){return{instance:u,listener:d,currentTarget:p}}function my(u,d){for(var p=d+"Capture",w=[];u!==null;){var S=u,I=S.stateNode;S.tag===5&&I!==null&&(S=I,I=cn(u,p),I!=null&&w.unshift(Dg(u,I,S)),I=cn(u,d),I!=null&&w.push(Dg(u,I,S))),u=u.return}return w}function Jd(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function HP(u,d,p,w,S){for(var I=d._reactName,G=[];p!==null&&p!==w;){var re=p,ae=re.alternate,Pe=re.stateNode;if(ae!==null&&ae===w)break;re.tag===5&&Pe!==null&&(re=Pe,S?(ae=cn(p,I),ae!=null&&G.unshift(Dg(p,ae,re))):S||(ae=cn(p,I),ae!=null&&G.push(Dg(p,ae,re)))),p=p.return}G.length!==0&&u.push({event:d,listeners:G})}var aU=/\r\n?/g,oU=/\u0000|\uFFFD/g;function KP(u){return(typeof u=="string"?u:""+u).replace(aU,`
`).replace(oU,"")}function py(u,d,p){if(d=KP(d),KP(u)!==d&&p)throw Error(t(425))}function yy(){}var $w=null,Ww=null;function Hw(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Kw=typeof setTimeout=="function"?setTimeout:void 0,lU=typeof clearTimeout=="function"?clearTimeout:void 0,XP=typeof Promise=="function"?Promise:void 0,cU=typeof queueMicrotask=="function"?queueMicrotask:typeof XP<"u"?function(u){return XP.resolve(null).then(u).catch(uU)}:Kw;function uU(u){setTimeout(function(){throw u})}function Xw(u,d){var p=d,w=0;do{var S=p.nextSibling;if(u.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(w===0){u.removeChild(S),Sc(d);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=S}while(p);Sc(d)}function Rc(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function qP(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return u;d--}else p==="/$"&&d++}u=u.previousSibling}return null}var ef=Math.random().toString(36).slice(2),Fo="__reactFiber$"+ef,Fg="__reactProps$"+ef,Tl="__reactContainer$"+ef,qw="__reactEvents$"+ef,hU="__reactListeners$"+ef,dU="__reactHandles$"+ef;function nh(u){var d=u[Fo];if(d)return d;for(var p=u.parentNode;p;){if(d=p[Tl]||p[Fo]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(u=qP(u);u!==null;){if(p=u[Fo])return p;u=qP(u)}return d}u=p,p=u.parentNode}return null}function jg(u){return u=u[Fo]||u[Tl],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function tf(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function _y(u){return u[Fg]||null}var Yw=[],nf=-1;function Ic(u){return{current:u}}function hr(u){0>nf||(u.current=Yw[nf],Yw[nf]=null,nf--)}function or(u,d){nf++,Yw[nf]=u.current,u.current=d}var Cc={},qi=Ic(Cc),bs=Ic(!1),rh=Cc;function rf(u,d){var p=u.type.contextTypes;if(!p)return Cc;var w=u.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===d)return w.__reactInternalMemoizedMaskedChildContext;var S={},I;for(I in p)S[I]=d[I];return w&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=S),S}function As(u){return u=u.childContextTypes,u!=null}function xy(){hr(bs),hr(qi)}function YP(u,d,p){if(qi.current!==Cc)throw Error(t(168));or(qi,d),or(bs,p)}function ZP(u,d,p){var w=u.stateNode;if(d=d.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var S in w)if(!(S in d))throw Error(t(108,Ce(u)||"Unknown",S));return Se({},p,w)}function vy(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Cc,rh=qi.current,or(qi,u),or(bs,bs.current),!0}function QP(u,d,p){var w=u.stateNode;if(!w)throw Error(t(169));p?(u=ZP(u,d,rh),w.__reactInternalMemoizedMergedChildContext=u,hr(bs),hr(qi),or(qi,u)):hr(bs),or(bs,p)}var bl=null,Ey=!1,Zw=!1;function JP(u){bl===null?bl=[u]:bl.push(u)}function fU(u){Ey=!0,JP(u)}function Pc(){if(!Zw&&bl!==null){Zw=!0;var u=0,d=vn;try{var p=bl;for(vn=1;u<p.length;u++){var w=p[u];do w=w(!0);while(w!==null)}bl=null,Ey=!1}catch(S){throw bl!==null&&(bl=bl.slice(u+1)),Ke(jn,Pc),S}finally{vn=d,Zw=!1}}return null}var sf=[],af=0,wy=null,Sy=0,xa=[],va=0,ih=null,Al=1,Rl="";function sh(u,d){sf[af++]=Sy,sf[af++]=wy,wy=u,Sy=d}function ek(u,d,p){xa[va++]=Al,xa[va++]=Rl,xa[va++]=ih,ih=u;var w=Al;u=Rl;var S=32-br(w)-1;w&=~(1<<S),p+=1;var I=32-br(d)+S;if(30<I){var G=S-S%5;I=(w&(1<<G)-1).toString(32),w>>=G,S-=G,Al=1<<32-br(d)+S|p<<S|w,Rl=I+u}else Al=1<<I|p<<S|w,Rl=u}function Qw(u){u.return!==null&&(sh(u,1),ek(u,1,0))}function Jw(u){for(;u===wy;)wy=sf[--af],sf[af]=null,Sy=sf[--af],sf[af]=null;for(;u===ih;)ih=xa[--va],xa[va]=null,Rl=xa[--va],xa[va]=null,Al=xa[--va],xa[va]=null}var Js=null,ea=null,_r=!1,qa=null;function tk(u,d){var p=Ta(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=u,d=u.deletions,d===null?(u.deletions=[p],u.flags|=16):d.push(p)}function nk(u,d){switch(u.tag){case 5:var p=u.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,Js=u,ea=Rc(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,Js=u,ea=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=ih!==null?{id:Al,overflow:Rl}:null,u.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=Ta(18,null,null,0),p.stateNode=d,p.return=u,u.child=p,Js=u,ea=null,!0):!1;default:return!1}}function e2(u){return(u.mode&1)!==0&&(u.flags&128)===0}function t2(u){if(_r){var d=ea;if(d){var p=d;if(!nk(u,d)){if(e2(u))throw Error(t(418));d=Rc(p.nextSibling);var w=Js;d&&nk(u,d)?tk(w,p):(u.flags=u.flags&-4097|2,_r=!1,Js=u)}}else{if(e2(u))throw Error(t(418));u.flags=u.flags&-4097|2,_r=!1,Js=u}}}function rk(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;Js=u}function Ty(u){if(u!==Js)return!1;if(!_r)return rk(u),_r=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!Hw(u.type,u.memoizedProps)),d&&(d=ea)){if(e2(u))throw ik(),Error(t(418));for(;d;)tk(u,d),d=Rc(d.nextSibling)}if(rk(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="/$"){if(d===0){ea=Rc(u.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}u=u.nextSibling}ea=null}}else ea=Js?Rc(u.stateNode.nextSibling):null;return!0}function ik(){for(var u=ea;u;)u=Rc(u.nextSibling)}function of(){ea=Js=null,_r=!1}function n2(u){qa===null?qa=[u]:qa.push(u)}var gU=M.ReactCurrentBatchConfig;function Vg(u,d,p){if(u=p.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var w=p.stateNode}if(!w)throw Error(t(147,u));var S=w,I=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===I?d.ref:(d=function(G){var re=S.refs;G===null?delete re[I]:re[I]=G},d._stringRef=I,d)}if(typeof u!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,u))}return u}function by(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function sk(u){var d=u._init;return d(u._payload)}function ak(u){function d(ge,oe){if(u){var Ee=ge.deletions;Ee===null?(ge.deletions=[oe],ge.flags|=16):Ee.push(oe)}}function p(ge,oe){if(!u)return null;for(;oe!==null;)d(ge,oe),oe=oe.sibling;return null}function w(ge,oe){for(ge=new Map;oe!==null;)oe.key!==null?ge.set(oe.key,oe):ge.set(oe.index,oe),oe=oe.sibling;return ge}function S(ge,oe){return ge=jc(ge,oe),ge.index=0,ge.sibling=null,ge}function I(ge,oe,Ee){return ge.index=Ee,u?(Ee=ge.alternate,Ee!==null?(Ee=Ee.index,Ee<oe?(ge.flags|=2,oe):Ee):(ge.flags|=2,oe)):(ge.flags|=1048576,oe)}function G(ge){return u&&ge.alternate===null&&(ge.flags|=2),ge}function re(ge,oe,Ee,Je){return oe===null||oe.tag!==6?(oe=K2(Ee,ge.mode,Je),oe.return=ge,oe):(oe=S(oe,Ee),oe.return=ge,oe)}function ae(ge,oe,Ee,Je){var Pt=Ee.type;return Pt===P?He(ge,oe,Ee.props.children,Je,Ee.key):oe!==null&&(oe.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===Ve&&sk(Pt)===oe.type)?(Je=S(oe,Ee.props),Je.ref=Vg(ge,oe,Ee),Je.return=ge,Je):(Je=qy(Ee.type,Ee.key,Ee.props,null,ge.mode,Je),Je.ref=Vg(ge,oe,Ee),Je.return=ge,Je)}function Pe(ge,oe,Ee,Je){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==Ee.containerInfo||oe.stateNode.implementation!==Ee.implementation?(oe=X2(Ee,ge.mode,Je),oe.return=ge,oe):(oe=S(oe,Ee.children||[]),oe.return=ge,oe)}function He(ge,oe,Ee,Je,Pt){return oe===null||oe.tag!==7?(oe=fh(Ee,ge.mode,Je,Pt),oe.return=ge,oe):(oe=S(oe,Ee),oe.return=ge,oe)}function Ye(ge,oe,Ee){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=K2(""+oe,ge.mode,Ee),oe.return=ge,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case D:return Ee=qy(oe.type,oe.key,oe.props,null,ge.mode,Ee),Ee.ref=Vg(ge,null,oe),Ee.return=ge,Ee;case U:return oe=X2(oe,ge.mode,Ee),oe.return=ge,oe;case Ve:var Je=oe._init;return Ye(ge,Je(oe._payload),Ee)}if(rn(oe)||we(oe))return oe=fh(oe,ge.mode,Ee,null),oe.return=ge,oe;by(ge,oe)}return null}function ze(ge,oe,Ee,Je){var Pt=oe!==null?oe.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return Pt!==null?null:re(ge,oe,""+Ee,Je);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case D:return Ee.key===Pt?ae(ge,oe,Ee,Je):null;case U:return Ee.key===Pt?Pe(ge,oe,Ee,Je):null;case Ve:return Pt=Ee._init,ze(ge,oe,Pt(Ee._payload),Je)}if(rn(Ee)||we(Ee))return Pt!==null?null:He(ge,oe,Ee,Je,null);by(ge,Ee)}return null}function _t(ge,oe,Ee,Je,Pt){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return ge=ge.get(Ee)||null,re(oe,ge,""+Je,Pt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case D:return ge=ge.get(Je.key===null?Ee:Je.key)||null,ae(oe,ge,Je,Pt);case U:return ge=ge.get(Je.key===null?Ee:Je.key)||null,Pe(oe,ge,Je,Pt);case Ve:var Vt=Je._init;return _t(ge,oe,Ee,Vt(Je._payload),Pt)}if(rn(Je)||we(Je))return ge=ge.get(Ee)||null,He(oe,ge,Je,Pt,null);by(oe,Je)}return null}function Tt(ge,oe,Ee,Je){for(var Pt=null,Vt=null,Gt=oe,Kt=oe=0,Ei=null;Gt!==null&&Kt<Ee.length;Kt++){Gt.index>Kt?(Ei=Gt,Gt=null):Ei=Gt.sibling;var An=ze(ge,Gt,Ee[Kt],Je);if(An===null){Gt===null&&(Gt=Ei);break}u&&Gt&&An.alternate===null&&d(ge,Gt),oe=I(An,oe,Kt),Vt===null?Pt=An:Vt.sibling=An,Vt=An,Gt=Ei}if(Kt===Ee.length)return p(ge,Gt),_r&&sh(ge,Kt),Pt;if(Gt===null){for(;Kt<Ee.length;Kt++)Gt=Ye(ge,Ee[Kt],Je),Gt!==null&&(oe=I(Gt,oe,Kt),Vt===null?Pt=Gt:Vt.sibling=Gt,Vt=Gt);return _r&&sh(ge,Kt),Pt}for(Gt=w(ge,Gt);Kt<Ee.length;Kt++)Ei=_t(Gt,ge,Kt,Ee[Kt],Je),Ei!==null&&(u&&Ei.alternate!==null&&Gt.delete(Ei.key===null?Kt:Ei.key),oe=I(Ei,oe,Kt),Vt===null?Pt=Ei:Vt.sibling=Ei,Vt=Ei);return u&&Gt.forEach(function(Vc){return d(ge,Vc)}),_r&&sh(ge,Kt),Pt}function It(ge,oe,Ee,Je){var Pt=we(Ee);if(typeof Pt!="function")throw Error(t(150));if(Ee=Pt.call(Ee),Ee==null)throw Error(t(151));for(var Vt=Pt=null,Gt=oe,Kt=oe=0,Ei=null,An=Ee.next();Gt!==null&&!An.done;Kt++,An=Ee.next()){Gt.index>Kt?(Ei=Gt,Gt=null):Ei=Gt.sibling;var Vc=ze(ge,Gt,An.value,Je);if(Vc===null){Gt===null&&(Gt=Ei);break}u&&Gt&&Vc.alternate===null&&d(ge,Gt),oe=I(Vc,oe,Kt),Vt===null?Pt=Vc:Vt.sibling=Vc,Vt=Vc,Gt=Ei}if(An.done)return p(ge,Gt),_r&&sh(ge,Kt),Pt;if(Gt===null){for(;!An.done;Kt++,An=Ee.next())An=Ye(ge,An.value,Je),An!==null&&(oe=I(An,oe,Kt),Vt===null?Pt=An:Vt.sibling=An,Vt=An);return _r&&sh(ge,Kt),Pt}for(Gt=w(ge,Gt);!An.done;Kt++,An=Ee.next())An=_t(Gt,ge,Kt,An.value,Je),An!==null&&(u&&An.alternate!==null&&Gt.delete(An.key===null?Kt:An.key),oe=I(An,oe,Kt),Vt===null?Pt=An:Vt.sibling=An,Vt=An);return u&&Gt.forEach(function(KU){return d(ge,KU)}),_r&&sh(ge,Kt),Pt}function zr(ge,oe,Ee,Je){if(typeof Ee=="object"&&Ee!==null&&Ee.type===P&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case D:e:{for(var Pt=Ee.key,Vt=oe;Vt!==null;){if(Vt.key===Pt){if(Pt=Ee.type,Pt===P){if(Vt.tag===7){p(ge,Vt.sibling),oe=S(Vt,Ee.props.children),oe.return=ge,ge=oe;break e}}else if(Vt.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===Ve&&sk(Pt)===Vt.type){p(ge,Vt.sibling),oe=S(Vt,Ee.props),oe.ref=Vg(ge,Vt,Ee),oe.return=ge,ge=oe;break e}p(ge,Vt);break}else d(ge,Vt);Vt=Vt.sibling}Ee.type===P?(oe=fh(Ee.props.children,ge.mode,Je,Ee.key),oe.return=ge,ge=oe):(Je=qy(Ee.type,Ee.key,Ee.props,null,ge.mode,Je),Je.ref=Vg(ge,oe,Ee),Je.return=ge,ge=Je)}return G(ge);case U:e:{for(Vt=Ee.key;oe!==null;){if(oe.key===Vt)if(oe.tag===4&&oe.stateNode.containerInfo===Ee.containerInfo&&oe.stateNode.implementation===Ee.implementation){p(ge,oe.sibling),oe=S(oe,Ee.children||[]),oe.return=ge,ge=oe;break e}else{p(ge,oe);break}else d(ge,oe);oe=oe.sibling}oe=X2(Ee,ge.mode,Je),oe.return=ge,ge=oe}return G(ge);case Ve:return Vt=Ee._init,zr(ge,oe,Vt(Ee._payload),Je)}if(rn(Ee))return Tt(ge,oe,Ee,Je);if(we(Ee))return It(ge,oe,Ee,Je);by(ge,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"?(Ee=""+Ee,oe!==null&&oe.tag===6?(p(ge,oe.sibling),oe=S(oe,Ee),oe.return=ge,ge=oe):(p(ge,oe),oe=K2(Ee,ge.mode,Je),oe.return=ge,ge=oe),G(ge)):p(ge,oe)}return zr}var lf=ak(!0),ok=ak(!1),Ay=Ic(null),Ry=null,cf=null,r2=null;function i2(){r2=cf=Ry=null}function s2(u){var d=Ay.current;hr(Ay),u._currentValue=d}function a2(u,d,p){for(;u!==null;){var w=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,w!==null&&(w.childLanes|=d)):w!==null&&(w.childLanes&d)!==d&&(w.childLanes|=d),u===p)break;u=u.return}}function uf(u,d){Ry=u,r2=cf=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(Rs=!0),u.firstContext=null)}function Ea(u){var d=u._currentValue;if(r2!==u)if(u={context:u,memoizedValue:d,next:null},cf===null){if(Ry===null)throw Error(t(308));cf=u,Ry.dependencies={lanes:0,firstContext:u}}else cf=cf.next=u;return d}var ah=null;function o2(u){ah===null?ah=[u]:ah.push(u)}function lk(u,d,p,w){var S=d.interleaved;return S===null?(p.next=p,o2(d)):(p.next=S.next,S.next=p),d.interleaved=p,Il(u,w)}function Il(u,d){u.lanes|=d;var p=u.alternate;for(p!==null&&(p.lanes|=d),p=u,u=u.return;u!==null;)u.childLanes|=d,p=u.alternate,p!==null&&(p.childLanes|=d),p=u,u=u.return;return p.tag===3?p.stateNode:null}var kc=!1;function l2(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ck(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Cl(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function Mc(u,d,p){var w=u.updateQueue;if(w===null)return null;if(w=w.shared,(Sn&2)!==0){var S=w.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),w.pending=d,Il(u,p)}return S=w.interleaved,S===null?(d.next=d,o2(w)):(d.next=S.next,S.next=d),w.interleaved=d,Il(u,p)}function Iy(u,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var w=d.lanes;w&=u.pendingLanes,p|=w,d.lanes=p,vg(u,p)}}function uk(u,d){var p=u.updateQueue,w=u.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var S=null,I=null;if(p=p.firstBaseUpdate,p!==null){do{var G={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};I===null?S=I=G:I=I.next=G,p=p.next}while(p!==null);I===null?S=I=d:I=I.next=d}else S=I=d;p={baseState:w.baseState,firstBaseUpdate:S,lastBaseUpdate:I,shared:w.shared,effects:w.effects},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=d}function Cy(u,d,p,w){var S=u.updateQueue;kc=!1;var I=S.firstBaseUpdate,G=S.lastBaseUpdate,re=S.shared.pending;if(re!==null){S.shared.pending=null;var ae=re,Pe=ae.next;ae.next=null,G===null?I=Pe:G.next=Pe,G=ae;var He=u.alternate;He!==null&&(He=He.updateQueue,re=He.lastBaseUpdate,re!==G&&(re===null?He.firstBaseUpdate=Pe:re.next=Pe,He.lastBaseUpdate=ae))}if(I!==null){var Ye=S.baseState;G=0,He=Pe=ae=null,re=I;do{var ze=re.lane,_t=re.eventTime;if((w&ze)===ze){He!==null&&(He=He.next={eventTime:_t,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var Tt=u,It=re;switch(ze=d,_t=p,It.tag){case 1:if(Tt=It.payload,typeof Tt=="function"){Ye=Tt.call(_t,Ye,ze);break e}Ye=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=It.payload,ze=typeof Tt=="function"?Tt.call(_t,Ye,ze):Tt,ze==null)break e;Ye=Se({},Ye,ze);break e;case 2:kc=!0}}re.callback!==null&&re.lane!==0&&(u.flags|=64,ze=S.effects,ze===null?S.effects=[re]:ze.push(re))}else _t={eventTime:_t,lane:ze,tag:re.tag,payload:re.payload,callback:re.callback,next:null},He===null?(Pe=He=_t,ae=Ye):He=He.next=_t,G|=ze;if(re=re.next,re===null){if(re=S.shared.pending,re===null)break;ze=re,re=ze.next,ze.next=null,S.lastBaseUpdate=ze,S.shared.pending=null}}while(!0);if(He===null&&(ae=Ye),S.baseState=ae,S.firstBaseUpdate=Pe,S.lastBaseUpdate=He,d=S.shared.interleaved,d!==null){S=d;do G|=S.lane,S=S.next;while(S!==d)}else I===null&&(S.shared.lanes=0);ch|=G,u.lanes=G,u.memoizedState=Ye}}function hk(u,d,p){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var w=u[d],S=w.callback;if(S!==null){if(w.callback=null,w=p,typeof S!="function")throw Error(t(191,S));S.call(w)}}}var Gg={},jo=Ic(Gg),Bg=Ic(Gg),Ug=Ic(Gg);function oh(u){if(u===Gg)throw Error(t(174));return u}function c2(u,d){switch(or(Ug,d),or(Bg,u),or(jo,Gg),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Nt(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=Nt(d,u)}hr(jo),or(jo,d)}function hf(){hr(jo),hr(Bg),hr(Ug)}function dk(u){oh(Ug.current);var d=oh(jo.current),p=Nt(d,u.type);d!==p&&(or(Bg,u),or(jo,p))}function u2(u){Bg.current===u&&(hr(jo),hr(Bg))}var Ar=Ic(0);function Py(u){for(var d=u;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var h2=[];function d2(){for(var u=0;u<h2.length;u++)h2[u]._workInProgressVersionPrimary=null;h2.length=0}var ky=M.ReactCurrentDispatcher,f2=M.ReactCurrentBatchConfig,lh=0,Rr=null,oi=null,xi=null,My=!1,zg=!1,$g=0,mU=0;function Yi(){throw Error(t(321))}function g2(u,d){if(d===null)return!1;for(var p=0;p<d.length&&p<u.length;p++)if(!Xa(u[p],d[p]))return!1;return!0}function m2(u,d,p,w,S,I){if(lh=I,Rr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,ky.current=u===null||u.memoizedState===null?xU:vU,u=p(w,S),zg){I=0;do{if(zg=!1,$g=0,25<=I)throw Error(t(301));I+=1,xi=oi=null,d.updateQueue=null,ky.current=EU,u=p(w,S)}while(zg)}if(ky.current=Oy,d=oi!==null&&oi.next!==null,lh=0,xi=oi=Rr=null,My=!1,d)throw Error(t(300));return u}function p2(){var u=$g!==0;return $g=0,u}function Vo(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Rr.memoizedState=xi=u:xi=xi.next=u,xi}function wa(){if(oi===null){var u=Rr.alternate;u=u!==null?u.memoizedState:null}else u=oi.next;var d=xi===null?Rr.memoizedState:xi.next;if(d!==null)xi=d,oi=u;else{if(u===null)throw Error(t(310));oi=u,u={memoizedState:oi.memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},xi===null?Rr.memoizedState=xi=u:xi=xi.next=u}return xi}function Wg(u,d){return typeof d=="function"?d(u):d}function y2(u){var d=wa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var w=oi,S=w.baseQueue,I=p.pending;if(I!==null){if(S!==null){var G=S.next;S.next=I.next,I.next=G}w.baseQueue=S=I,p.pending=null}if(S!==null){I=S.next,w=w.baseState;var re=G=null,ae=null,Pe=I;do{var He=Pe.lane;if((lh&He)===He)ae!==null&&(ae=ae.next={lane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),w=Pe.hasEagerState?Pe.eagerState:u(w,Pe.action);else{var Ye={lane:He,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null};ae===null?(re=ae=Ye,G=w):ae=ae.next=Ye,Rr.lanes|=He,ch|=He}Pe=Pe.next}while(Pe!==null&&Pe!==I);ae===null?G=w:ae.next=re,Xa(w,d.memoizedState)||(Rs=!0),d.memoizedState=w,d.baseState=G,d.baseQueue=ae,p.lastRenderedState=w}if(u=p.interleaved,u!==null){S=u;do I=S.lane,Rr.lanes|=I,ch|=I,S=S.next;while(S!==u)}else S===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function _2(u){var d=wa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var w=p.dispatch,S=p.pending,I=d.memoizedState;if(S!==null){p.pending=null;var G=S=S.next;do I=u(I,G.action),G=G.next;while(G!==S);Xa(I,d.memoizedState)||(Rs=!0),d.memoizedState=I,d.baseQueue===null&&(d.baseState=I),p.lastRenderedState=I}return[I,w]}function fk(){}function gk(u,d){var p=Rr,w=wa(),S=d(),I=!Xa(w.memoizedState,S);if(I&&(w.memoizedState=S,Rs=!0),w=w.queue,x2(yk.bind(null,p,w,u),[u]),w.getSnapshot!==d||I||xi!==null&&xi.memoizedState.tag&1){if(p.flags|=2048,Hg(9,pk.bind(null,p,w,S,d),void 0,null),vi===null)throw Error(t(349));(lh&30)!==0||mk(p,d,S)}return S}function mk(u,d,p){u.flags|=16384,u={getSnapshot:d,value:p},d=Rr.updateQueue,d===null?(d={lastEffect:null,stores:null},Rr.updateQueue=d,d.stores=[u]):(p=d.stores,p===null?d.stores=[u]:p.push(u))}function pk(u,d,p,w){d.value=p,d.getSnapshot=w,_k(d)&&xk(u)}function yk(u,d,p){return p(function(){_k(d)&&xk(u)})}function _k(u){var d=u.getSnapshot;u=u.value;try{var p=d();return!Xa(u,p)}catch{return!0}}function xk(u){var d=Il(u,1);d!==null&&Ja(d,u,1,-1)}function vk(u){var d=Vo();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wg,lastRenderedState:u},d.queue=u,u=u.dispatch=_U.bind(null,Rr,u),[d.memoizedState,u]}function Hg(u,d,p,w){return u={tag:u,create:d,destroy:p,deps:w,next:null},d=Rr.updateQueue,d===null?(d={lastEffect:null,stores:null},Rr.updateQueue=d,d.lastEffect=u.next=u):(p=d.lastEffect,p===null?d.lastEffect=u.next=u:(w=p.next,p.next=u,u.next=w,d.lastEffect=u)),u}function Ek(){return wa().memoizedState}function Ny(u,d,p,w){var S=Vo();Rr.flags|=u,S.memoizedState=Hg(1|d,p,void 0,w===void 0?null:w)}function Ly(u,d,p,w){var S=wa();w=w===void 0?null:w;var I=void 0;if(oi!==null){var G=oi.memoizedState;if(I=G.destroy,w!==null&&g2(w,G.deps)){S.memoizedState=Hg(d,p,I,w);return}}Rr.flags|=u,S.memoizedState=Hg(1|d,p,I,w)}function wk(u,d){return Ny(8390656,8,u,d)}function x2(u,d){return Ly(2048,8,u,d)}function Sk(u,d){return Ly(4,2,u,d)}function Tk(u,d){return Ly(4,4,u,d)}function bk(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function Ak(u,d,p){return p=p!=null?p.concat([u]):null,Ly(4,4,bk.bind(null,d,u),p)}function v2(){}function Rk(u,d){var p=wa();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&g2(d,w[1])?w[0]:(p.memoizedState=[u,d],u)}function Ik(u,d){var p=wa();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&g2(d,w[1])?w[0]:(u=u(),p.memoizedState=[u,d],u)}function Ck(u,d,p){return(lh&21)===0?(u.baseState&&(u.baseState=!1,Rs=!0),u.memoizedState=p):(Xa(p,d)||(p=_g(),Rr.lanes|=p,ch|=p,u.baseState=!0),d)}function pU(u,d){var p=vn;vn=p!==0&&4>p?p:4,u(!0);var w=f2.transition;f2.transition={};try{u(!1),d()}finally{vn=p,f2.transition=w}}function Pk(){return wa().memoizedState}function yU(u,d,p){var w=Dc(u);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},kk(u))Mk(d,p);else if(p=lk(u,d,p,w),p!==null){var S=ms();Ja(p,u,w,S),Nk(p,d,w)}}function _U(u,d,p){var w=Dc(u),S={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(kk(u))Mk(d,S);else{var I=u.alternate;if(u.lanes===0&&(I===null||I.lanes===0)&&(I=d.lastRenderedReducer,I!==null))try{var G=d.lastRenderedState,re=I(G,p);if(S.hasEagerState=!0,S.eagerState=re,Xa(re,G)){var ae=d.interleaved;ae===null?(S.next=S,o2(d)):(S.next=ae.next,ae.next=S),d.interleaved=S;return}}catch{}p=lk(u,d,S,w),p!==null&&(S=ms(),Ja(p,u,w,S),Nk(p,d,w))}}function kk(u){var d=u.alternate;return u===Rr||d!==null&&d===Rr}function Mk(u,d){zg=My=!0;var p=u.pending;p===null?d.next=d:(d.next=p.next,p.next=d),u.pending=d}function Nk(u,d,p){if((p&4194240)!==0){var w=d.lanes;w&=u.pendingLanes,p|=w,d.lanes=p,vg(u,p)}}var Oy={readContext:Ea,useCallback:Yi,useContext:Yi,useEffect:Yi,useImperativeHandle:Yi,useInsertionEffect:Yi,useLayoutEffect:Yi,useMemo:Yi,useReducer:Yi,useRef:Yi,useState:Yi,useDebugValue:Yi,useDeferredValue:Yi,useTransition:Yi,useMutableSource:Yi,useSyncExternalStore:Yi,useId:Yi,unstable_isNewReconciler:!1},xU={readContext:Ea,useCallback:function(u,d){return Vo().memoizedState=[u,d===void 0?null:d],u},useContext:Ea,useEffect:wk,useImperativeHandle:function(u,d,p){return p=p!=null?p.concat([u]):null,Ny(4194308,4,bk.bind(null,d,u),p)},useLayoutEffect:function(u,d){return Ny(4194308,4,u,d)},useInsertionEffect:function(u,d){return Ny(4,2,u,d)},useMemo:function(u,d){var p=Vo();return d=d===void 0?null:d,u=u(),p.memoizedState=[u,d],u},useReducer:function(u,d,p){var w=Vo();return d=p!==void 0?p(d):d,w.memoizedState=w.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},w.queue=u,u=u.dispatch=yU.bind(null,Rr,u),[w.memoizedState,u]},useRef:function(u){var d=Vo();return u={current:u},d.memoizedState=u},useState:vk,useDebugValue:v2,useDeferredValue:function(u){return Vo().memoizedState=u},useTransition:function(){var u=vk(!1),d=u[0];return u=pU.bind(null,u[1]),Vo().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,p){var w=Rr,S=Vo();if(_r){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),vi===null)throw Error(t(349));(lh&30)!==0||mk(w,d,p)}S.memoizedState=p;var I={value:p,getSnapshot:d};return S.queue=I,wk(yk.bind(null,w,I,u),[u]),w.flags|=2048,Hg(9,pk.bind(null,w,I,p,d),void 0,null),p},useId:function(){var u=Vo(),d=vi.identifierPrefix;if(_r){var p=Rl,w=Al;p=(w&~(1<<32-br(w)-1)).toString(32)+p,d=":"+d+"R"+p,p=$g++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=mU++,d=":"+d+"r"+p.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},vU={readContext:Ea,useCallback:Rk,useContext:Ea,useEffect:x2,useImperativeHandle:Ak,useInsertionEffect:Sk,useLayoutEffect:Tk,useMemo:Ik,useReducer:y2,useRef:Ek,useState:function(){return y2(Wg)},useDebugValue:v2,useDeferredValue:function(u){var d=wa();return Ck(d,oi.memoizedState,u)},useTransition:function(){var u=y2(Wg)[0],d=wa().memoizedState;return[u,d]},useMutableSource:fk,useSyncExternalStore:gk,useId:Pk,unstable_isNewReconciler:!1},EU={readContext:Ea,useCallback:Rk,useContext:Ea,useEffect:x2,useImperativeHandle:Ak,useInsertionEffect:Sk,useLayoutEffect:Tk,useMemo:Ik,useReducer:_2,useRef:Ek,useState:function(){return _2(Wg)},useDebugValue:v2,useDeferredValue:function(u){var d=wa();return oi===null?d.memoizedState=u:Ck(d,oi.memoizedState,u)},useTransition:function(){var u=_2(Wg)[0],d=wa().memoizedState;return[u,d]},useMutableSource:fk,useSyncExternalStore:gk,useId:Pk,unstable_isNewReconciler:!1};function Ya(u,d){if(u&&u.defaultProps){d=Se({},d),u=u.defaultProps;for(var p in u)d[p]===void 0&&(d[p]=u[p]);return d}return d}function E2(u,d,p,w){d=u.memoizedState,p=p(w,d),p=p==null?d:Se({},d,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var Dy={isMounted:function(u){return(u=u._reactInternals)?te(u)===u:!1},enqueueSetState:function(u,d,p){u=u._reactInternals;var w=ms(),S=Dc(u),I=Cl(w,S);I.payload=d,p!=null&&(I.callback=p),d=Mc(u,I,S),d!==null&&(Ja(d,u,S,w),Iy(d,u,S))},enqueueReplaceState:function(u,d,p){u=u._reactInternals;var w=ms(),S=Dc(u),I=Cl(w,S);I.tag=1,I.payload=d,p!=null&&(I.callback=p),d=Mc(u,I,S),d!==null&&(Ja(d,u,S,w),Iy(d,u,S))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var p=ms(),w=Dc(u),S=Cl(p,w);S.tag=2,d!=null&&(S.callback=d),d=Mc(u,S,w),d!==null&&(Ja(d,u,w,p),Iy(d,u,w))}};function Lk(u,d,p,w,S,I,G){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(w,I,G):d.prototype&&d.prototype.isPureReactComponent?!Mg(p,w)||!Mg(S,I):!0}function Ok(u,d,p){var w=!1,S=Cc,I=d.contextType;return typeof I=="object"&&I!==null?I=Ea(I):(S=As(d)?rh:qi.current,w=d.contextTypes,I=(w=w!=null)?rf(u,S):Cc),d=new d(p,I),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Dy,u.stateNode=d,d._reactInternals=u,w&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=S,u.__reactInternalMemoizedMaskedChildContext=I),d}function Dk(u,d,p,w){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,w),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,w),d.state!==u&&Dy.enqueueReplaceState(d,d.state,null)}function w2(u,d,p,w){var S=u.stateNode;S.props=p,S.state=u.memoizedState,S.refs={},l2(u);var I=d.contextType;typeof I=="object"&&I!==null?S.context=Ea(I):(I=As(d)?rh:qi.current,S.context=rf(u,I)),S.state=u.memoizedState,I=d.getDerivedStateFromProps,typeof I=="function"&&(E2(u,d,I,p),S.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&Dy.enqueueReplaceState(S,S.state,null),Cy(u,p,S,w),S.state=u.memoizedState),typeof S.componentDidMount=="function"&&(u.flags|=4194308)}function df(u,d){try{var p="",w=d;do p+=ie(w),w=w.return;while(w);var S=p}catch(I){S=`
Error generating stack: `+I.message+`
`+I.stack}return{value:u,source:d,stack:S,digest:null}}function S2(u,d,p){return{value:u,source:null,stack:p??null,digest:d??null}}function T2(u,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var wU=typeof WeakMap=="function"?WeakMap:Map;function Fk(u,d,p){p=Cl(-1,p),p.tag=3,p.payload={element:null};var w=d.value;return p.callback=function(){zy||(zy=!0,V2=w),T2(u,d)},p}function jk(u,d,p){p=Cl(-1,p),p.tag=3;var w=u.type.getDerivedStateFromError;if(typeof w=="function"){var S=d.value;p.payload=function(){return w(S)},p.callback=function(){T2(u,d)}}var I=u.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(p.callback=function(){T2(u,d),typeof w!="function"&&(Lc===null?Lc=new Set([this]):Lc.add(this));var G=d.stack;this.componentDidCatch(d.value,{componentStack:G!==null?G:""})}),p}function Vk(u,d,p){var w=u.pingCache;if(w===null){w=u.pingCache=new wU;var S=new Set;w.set(d,S)}else S=w.get(d),S===void 0&&(S=new Set,w.set(d,S));S.has(p)||(S.add(p),u=DU.bind(null,u,d,p),d.then(u,u))}function Gk(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function Bk(u,d,p,w,S){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=Cl(-1,1),d.tag=2,Mc(p,d,1))),p.lanes|=1),u):(u.flags|=65536,u.lanes=S,u)}var SU=M.ReactCurrentOwner,Rs=!1;function gs(u,d,p,w){d.child=u===null?ok(d,null,p,w):lf(d,u.child,p,w)}function Uk(u,d,p,w,S){p=p.render;var I=d.ref;return uf(d,S),w=m2(u,d,p,w,I,S),p=p2(),u!==null&&!Rs?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Pl(u,d,S)):(_r&&p&&Qw(d),d.flags|=1,gs(u,d,w,S),d.child)}function zk(u,d,p,w,S){if(u===null){var I=p.type;return typeof I=="function"&&!H2(I)&&I.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=I,$k(u,d,I,w,S)):(u=qy(p.type,null,w,d,d.mode,S),u.ref=d.ref,u.return=d,d.child=u)}if(I=u.child,(u.lanes&S)===0){var G=I.memoizedProps;if(p=p.compare,p=p!==null?p:Mg,p(G,w)&&u.ref===d.ref)return Pl(u,d,S)}return d.flags|=1,u=jc(I,w),u.ref=d.ref,u.return=d,d.child=u}function $k(u,d,p,w,S){if(u!==null){var I=u.memoizedProps;if(Mg(I,w)&&u.ref===d.ref)if(Rs=!1,d.pendingProps=w=I,(u.lanes&S)!==0)(u.flags&131072)!==0&&(Rs=!0);else return d.lanes=u.lanes,Pl(u,d,S)}return b2(u,d,p,w,S)}function Wk(u,d,p){var w=d.pendingProps,S=w.children,I=u!==null?u.memoizedState:null;if(w.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},or(gf,ta),ta|=p;else{if((p&1073741824)===0)return u=I!==null?I.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,or(gf,ta),ta|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=I!==null?I.baseLanes:p,or(gf,ta),ta|=w}else I!==null?(w=I.baseLanes|p,d.memoizedState=null):w=p,or(gf,ta),ta|=w;return gs(u,d,S,p),d.child}function Hk(u,d){var p=d.ref;(u===null&&p!==null||u!==null&&u.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function b2(u,d,p,w,S){var I=As(p)?rh:qi.current;return I=rf(d,I),uf(d,S),p=m2(u,d,p,w,I,S),w=p2(),u!==null&&!Rs?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Pl(u,d,S)):(_r&&w&&Qw(d),d.flags|=1,gs(u,d,p,S),d.child)}function Kk(u,d,p,w,S){if(As(p)){var I=!0;vy(d)}else I=!1;if(uf(d,S),d.stateNode===null)jy(u,d),Ok(d,p,w),w2(d,p,w,S),w=!0;else if(u===null){var G=d.stateNode,re=d.memoizedProps;G.props=re;var ae=G.context,Pe=p.contextType;typeof Pe=="object"&&Pe!==null?Pe=Ea(Pe):(Pe=As(p)?rh:qi.current,Pe=rf(d,Pe));var He=p.getDerivedStateFromProps,Ye=typeof He=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ye||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(re!==w||ae!==Pe)&&Dk(d,G,w,Pe),kc=!1;var ze=d.memoizedState;G.state=ze,Cy(d,w,G,S),ae=d.memoizedState,re!==w||ze!==ae||bs.current||kc?(typeof He=="function"&&(E2(d,p,He,w),ae=d.memoizedState),(re=kc||Lk(d,p,re,w,ze,ae,Pe))?(Ye||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(d.flags|=4194308)):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=w,d.memoizedState=ae),G.props=w,G.state=ae,G.context=Pe,w=re):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),w=!1)}else{G=d.stateNode,ck(u,d),re=d.memoizedProps,Pe=d.type===d.elementType?re:Ya(d.type,re),G.props=Pe,Ye=d.pendingProps,ze=G.context,ae=p.contextType,typeof ae=="object"&&ae!==null?ae=Ea(ae):(ae=As(p)?rh:qi.current,ae=rf(d,ae));var _t=p.getDerivedStateFromProps;(He=typeof _t=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(re!==Ye||ze!==ae)&&Dk(d,G,w,ae),kc=!1,ze=d.memoizedState,G.state=ze,Cy(d,w,G,S);var Tt=d.memoizedState;re!==Ye||ze!==Tt||bs.current||kc?(typeof _t=="function"&&(E2(d,p,_t,w),Tt=d.memoizedState),(Pe=kc||Lk(d,p,Pe,w,ze,Tt,ae)||!1)?(He||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(w,Tt,ae),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(w,Tt,ae)),typeof G.componentDidUpdate=="function"&&(d.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof G.componentDidUpdate!="function"||re===u.memoizedProps&&ze===u.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||re===u.memoizedProps&&ze===u.memoizedState||(d.flags|=1024),d.memoizedProps=w,d.memoizedState=Tt),G.props=w,G.state=Tt,G.context=ae,w=Pe):(typeof G.componentDidUpdate!="function"||re===u.memoizedProps&&ze===u.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||re===u.memoizedProps&&ze===u.memoizedState||(d.flags|=1024),w=!1)}return A2(u,d,p,w,I,S)}function A2(u,d,p,w,S,I){Hk(u,d);var G=(d.flags&128)!==0;if(!w&&!G)return S&&QP(d,p,!1),Pl(u,d,I);w=d.stateNode,SU.current=d;var re=G&&typeof p.getDerivedStateFromError!="function"?null:w.render();return d.flags|=1,u!==null&&G?(d.child=lf(d,u.child,null,I),d.child=lf(d,null,re,I)):gs(u,d,re,I),d.memoizedState=w.state,S&&QP(d,p,!0),d.child}function Xk(u){var d=u.stateNode;d.pendingContext?YP(u,d.pendingContext,d.pendingContext!==d.context):d.context&&YP(u,d.context,!1),c2(u,d.containerInfo)}function qk(u,d,p,w,S){return of(),n2(S),d.flags|=256,gs(u,d,p,w),d.child}var R2={dehydrated:null,treeContext:null,retryLane:0};function I2(u){return{baseLanes:u,cachePool:null,transitions:null}}function Yk(u,d,p){var w=d.pendingProps,S=Ar.current,I=!1,G=(d.flags&128)!==0,re;if((re=G)||(re=u!==null&&u.memoizedState===null?!1:(S&2)!==0),re?(I=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(S|=1),or(Ar,S&1),u===null)return t2(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(G=w.children,u=w.fallback,I?(w=d.mode,I=d.child,G={mode:"hidden",children:G},(w&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=G):I=Yy(G,w,0,null),u=fh(u,w,p,null),I.return=d,u.return=d,I.sibling=u,d.child=I,d.child.memoizedState=I2(p),d.memoizedState=R2,u):C2(d,G));if(S=u.memoizedState,S!==null&&(re=S.dehydrated,re!==null))return TU(u,d,G,w,re,S,p);if(I){I=w.fallback,G=d.mode,S=u.child,re=S.sibling;var ae={mode:"hidden",children:w.children};return(G&1)===0&&d.child!==S?(w=d.child,w.childLanes=0,w.pendingProps=ae,d.deletions=null):(w=jc(S,ae),w.subtreeFlags=S.subtreeFlags&14680064),re!==null?I=jc(re,I):(I=fh(I,G,p,null),I.flags|=2),I.return=d,w.return=d,w.sibling=I,d.child=w,w=I,I=d.child,G=u.child.memoizedState,G=G===null?I2(p):{baseLanes:G.baseLanes|p,cachePool:null,transitions:G.transitions},I.memoizedState=G,I.childLanes=u.childLanes&~p,d.memoizedState=R2,w}return I=u.child,u=I.sibling,w=jc(I,{mode:"visible",children:w.children}),(d.mode&1)===0&&(w.lanes=p),w.return=d,w.sibling=null,u!==null&&(p=d.deletions,p===null?(d.deletions=[u],d.flags|=16):p.push(u)),d.child=w,d.memoizedState=null,w}function C2(u,d){return d=Yy({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function Fy(u,d,p,w){return w!==null&&n2(w),lf(d,u.child,null,p),u=C2(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function TU(u,d,p,w,S,I,G){if(p)return d.flags&256?(d.flags&=-257,w=S2(Error(t(422))),Fy(u,d,G,w)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(I=w.fallback,S=d.mode,w=Yy({mode:"visible",children:w.children},S,0,null),I=fh(I,S,G,null),I.flags|=2,w.return=d,I.return=d,w.sibling=I,d.child=w,(d.mode&1)!==0&&lf(d,u.child,null,G),d.child.memoizedState=I2(G),d.memoizedState=R2,I);if((d.mode&1)===0)return Fy(u,d,G,null);if(S.data==="$!"){if(w=S.nextSibling&&S.nextSibling.dataset,w)var re=w.dgst;return w=re,I=Error(t(419)),w=S2(I,w,void 0),Fy(u,d,G,w)}if(re=(G&u.childLanes)!==0,Rs||re){if(w=vi,w!==null){switch(G&-G){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(w.suspendedLanes|G))!==0?0:S,S!==0&&S!==I.retryLane&&(I.retryLane=S,Il(u,S),Ja(w,u,S,-1))}return W2(),w=S2(Error(t(421))),Fy(u,d,G,w)}return S.data==="$?"?(d.flags|=128,d.child=u.child,d=FU.bind(null,u),S._reactRetry=d,null):(u=I.treeContext,ea=Rc(S.nextSibling),Js=d,_r=!0,qa=null,u!==null&&(xa[va++]=Al,xa[va++]=Rl,xa[va++]=ih,Al=u.id,Rl=u.overflow,ih=d),d=C2(d,w.children),d.flags|=4096,d)}function Zk(u,d,p){u.lanes|=d;var w=u.alternate;w!==null&&(w.lanes|=d),a2(u.return,d,p)}function P2(u,d,p,w,S){var I=u.memoizedState;I===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:S}:(I.isBackwards=d,I.rendering=null,I.renderingStartTime=0,I.last=w,I.tail=p,I.tailMode=S)}function Qk(u,d,p){var w=d.pendingProps,S=w.revealOrder,I=w.tail;if(gs(u,d,w.children,p),w=Ar.current,(w&2)!==0)w=w&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Zk(u,p,d);else if(u.tag===19)Zk(u,p,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}w&=1}if(or(Ar,w),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(p=d.child,S=null;p!==null;)u=p.alternate,u!==null&&Py(u)===null&&(S=p),p=p.sibling;p=S,p===null?(S=d.child,d.child=null):(S=p.sibling,p.sibling=null),P2(d,!1,S,p,I);break;case"backwards":for(p=null,S=d.child,d.child=null;S!==null;){if(u=S.alternate,u!==null&&Py(u)===null){d.child=S;break}u=S.sibling,S.sibling=p,p=S,S=u}P2(d,!0,p,null,I);break;case"together":P2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function jy(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Pl(u,d,p){if(u!==null&&(d.dependencies=u.dependencies),ch|=d.lanes,(p&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,p=jc(u,u.pendingProps),d.child=p,p.return=d;u.sibling!==null;)u=u.sibling,p=p.sibling=jc(u,u.pendingProps),p.return=d;p.sibling=null}return d.child}function bU(u,d,p){switch(d.tag){case 3:Xk(d),of();break;case 5:dk(d);break;case 1:As(d.type)&&vy(d);break;case 4:c2(d,d.stateNode.containerInfo);break;case 10:var w=d.type._context,S=d.memoizedProps.value;or(Ay,w._currentValue),w._currentValue=S;break;case 13:if(w=d.memoizedState,w!==null)return w.dehydrated!==null?(or(Ar,Ar.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?Yk(u,d,p):(or(Ar,Ar.current&1),u=Pl(u,d,p),u!==null?u.sibling:null);or(Ar,Ar.current&1);break;case 19:if(w=(p&d.childLanes)!==0,(u.flags&128)!==0){if(w)return Qk(u,d,p);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),or(Ar,Ar.current),w)break;return null;case 22:case 23:return d.lanes=0,Wk(u,d,p)}return Pl(u,d,p)}var Jk,k2,e4,t4;Jk=function(u,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)u.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},k2=function(){},e4=function(u,d,p,w){var S=u.memoizedProps;if(S!==w){u=d.stateNode,oh(jo.current);var I=null;switch(p){case"input":S=kt(u,S),w=kt(u,w),I=[];break;case"select":S=Se({},S,{value:void 0}),w=Se({},w,{value:void 0}),I=[];break;case"textarea":S=mt(u,S),w=mt(u,w),I=[];break;default:typeof S.onClick!="function"&&typeof w.onClick=="function"&&(u.onclick=yy)}Lt(p,w);var G;p=null;for(Pe in S)if(!w.hasOwnProperty(Pe)&&S.hasOwnProperty(Pe)&&S[Pe]!=null)if(Pe==="style"){var re=S[Pe];for(G in re)re.hasOwnProperty(G)&&(p||(p={}),p[G]="")}else Pe!=="dangerouslySetInnerHTML"&&Pe!=="children"&&Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&Pe!=="autoFocus"&&(i.hasOwnProperty(Pe)?I||(I=[]):(I=I||[]).push(Pe,null));for(Pe in w){var ae=w[Pe];if(re=S?.[Pe],w.hasOwnProperty(Pe)&&ae!==re&&(ae!=null||re!=null))if(Pe==="style")if(re){for(G in re)!re.hasOwnProperty(G)||ae&&ae.hasOwnProperty(G)||(p||(p={}),p[G]="");for(G in ae)ae.hasOwnProperty(G)&&re[G]!==ae[G]&&(p||(p={}),p[G]=ae[G])}else p||(I||(I=[]),I.push(Pe,p)),p=ae;else Pe==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,re=re?re.__html:void 0,ae!=null&&re!==ae&&(I=I||[]).push(Pe,ae)):Pe==="children"?typeof ae!="string"&&typeof ae!="number"||(I=I||[]).push(Pe,""+ae):Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&(i.hasOwnProperty(Pe)?(ae!=null&&Pe==="onScroll"&&ur("scroll",u),I||re===ae||(I=[])):(I=I||[]).push(Pe,ae))}p&&(I=I||[]).push("style",p);var Pe=I;(d.updateQueue=Pe)&&(d.flags|=4)}},t4=function(u,d,p,w){p!==w&&(d.flags|=4)};function Kg(u,d){if(!_r)switch(u.tailMode){case"hidden":d=u.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:w.sibling=null}}function Zi(u){var d=u.alternate!==null&&u.alternate.child===u.child,p=0,w=0;if(d)for(var S=u.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags&14680064,w|=S.flags&14680064,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags,w|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=w,u.childLanes=p,d}function AU(u,d,p){var w=d.pendingProps;switch(Jw(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zi(d),null;case 1:return As(d.type)&&xy(),Zi(d),null;case 3:return w=d.stateNode,hf(),hr(bs),hr(qi),d2(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(u===null||u.child===null)&&(Ty(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,qa!==null&&(U2(qa),qa=null))),k2(u,d),Zi(d),null;case 5:u2(d);var S=oh(Ug.current);if(p=d.type,u!==null&&d.stateNode!=null)e4(u,d,p,w,S),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!w){if(d.stateNode===null)throw Error(t(166));return Zi(d),null}if(u=oh(jo.current),Ty(d)){w=d.stateNode,p=d.type;var I=d.memoizedProps;switch(w[Fo]=d,w[Fg]=I,u=(d.mode&1)!==0,p){case"dialog":ur("cancel",w),ur("close",w);break;case"iframe":case"object":case"embed":ur("load",w);break;case"video":case"audio":for(S=0;S<Lg.length;S++)ur(Lg[S],w);break;case"source":ur("error",w);break;case"img":case"image":case"link":ur("error",w),ur("load",w);break;case"details":ur("toggle",w);break;case"input":Dn(w,I),ur("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!I.multiple},ur("invalid",w);break;case"textarea":Ut(w,I),ur("invalid",w)}Lt(p,I),S=null;for(var G in I)if(I.hasOwnProperty(G)){var re=I[G];G==="children"?typeof re=="string"?w.textContent!==re&&(I.suppressHydrationWarning!==!0&&py(w.textContent,re,u),S=["children",re]):typeof re=="number"&&w.textContent!==""+re&&(I.suppressHydrationWarning!==!0&&py(w.textContent,re,u),S=["children",""+re]):i.hasOwnProperty(G)&&re!=null&&G==="onScroll"&&ur("scroll",w)}switch(p){case"input":yt(w),nr(w,I,!0);break;case"textarea":yt(w),xt(w);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(w.onclick=yy)}w=S,d.updateQueue=w,w!==null&&(d.flags|=4)}else{G=S.nodeType===9?S:S.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=nn(p)),u==="http://www.w3.org/1999/xhtml"?p==="script"?(u=G.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof w.is=="string"?u=G.createElement(p,{is:w.is}):(u=G.createElement(p),p==="select"&&(G=u,w.multiple?G.multiple=!0:w.size&&(G.size=w.size))):u=G.createElementNS(u,p),u[Fo]=d,u[Fg]=w,Jk(u,d,!1,!1),d.stateNode=u;e:{switch(G=L(p,w),p){case"dialog":ur("cancel",u),ur("close",u),S=w;break;case"iframe":case"object":case"embed":ur("load",u),S=w;break;case"video":case"audio":for(S=0;S<Lg.length;S++)ur(Lg[S],u);S=w;break;case"source":ur("error",u),S=w;break;case"img":case"image":case"link":ur("error",u),ur("load",u),S=w;break;case"details":ur("toggle",u),S=w;break;case"input":Dn(u,w),S=kt(u,w),ur("invalid",u);break;case"option":S=w;break;case"select":u._wrapperState={wasMultiple:!!w.multiple},S=Se({},w,{value:void 0}),ur("invalid",u);break;case"textarea":Ut(u,w),S=mt(u,w),ur("invalid",u);break;default:S=w}Lt(p,S),re=S;for(I in re)if(re.hasOwnProperty(I)){var ae=re[I];I==="style"?be(u,ae):I==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&_i(u,ae)):I==="children"?typeof ae=="string"?(p!=="textarea"||ae!=="")&&Kr(u,ae):typeof ae=="number"&&Kr(u,""+ae):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(i.hasOwnProperty(I)?ae!=null&&I==="onScroll"&&ur("scroll",u):ae!=null&&A(u,I,ae,G))}switch(p){case"input":yt(u),nr(u,w,!1);break;case"textarea":yt(u),xt(u);break;case"option":w.value!=null&&u.setAttribute("value",""+Fe(w.value));break;case"select":u.multiple=!!w.multiple,I=w.value,I!=null?rr(u,!!w.multiple,I,!1):w.defaultValue!=null&&rr(u,!!w.multiple,w.defaultValue,!0);break;default:typeof S.onClick=="function"&&(u.onclick=yy)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Zi(d),null;case 6:if(u&&d.stateNode!=null)t4(u,d,u.memoizedProps,w);else{if(typeof w!="string"&&d.stateNode===null)throw Error(t(166));if(p=oh(Ug.current),oh(jo.current),Ty(d)){if(w=d.stateNode,p=d.memoizedProps,w[Fo]=d,(I=w.nodeValue!==p)&&(u=Js,u!==null))switch(u.tag){case 3:py(w.nodeValue,p,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&py(w.nodeValue,p,(u.mode&1)!==0)}I&&(d.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[Fo]=d,d.stateNode=w}return Zi(d),null;case 13:if(hr(Ar),w=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(_r&&ea!==null&&(d.mode&1)!==0&&(d.flags&128)===0)ik(),of(),d.flags|=98560,I=!1;else if(I=Ty(d),w!==null&&w.dehydrated!==null){if(u===null){if(!I)throw Error(t(318));if(I=d.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(t(317));I[Fo]=d}else of(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Zi(d),I=!1}else qa!==null&&(U2(qa),qa=null),I=!0;if(!I)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(w=w!==null,w!==(u!==null&&u.memoizedState!==null)&&w&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(Ar.current&1)!==0?li===0&&(li=3):W2())),d.updateQueue!==null&&(d.flags|=4),Zi(d),null);case 4:return hf(),k2(u,d),u===null&&Og(d.stateNode.containerInfo),Zi(d),null;case 10:return s2(d.type._context),Zi(d),null;case 17:return As(d.type)&&xy(),Zi(d),null;case 19:if(hr(Ar),I=d.memoizedState,I===null)return Zi(d),null;if(w=(d.flags&128)!==0,G=I.rendering,G===null)if(w)Kg(I,!1);else{if(li!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(G=Py(u),G!==null){for(d.flags|=128,Kg(I,!1),w=G.updateQueue,w!==null&&(d.updateQueue=w,d.flags|=4),d.subtreeFlags=0,w=p,p=d.child;p!==null;)I=p,u=w,I.flags&=14680066,G=I.alternate,G===null?(I.childLanes=0,I.lanes=u,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=G.childLanes,I.lanes=G.lanes,I.child=G.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=G.memoizedProps,I.memoizedState=G.memoizedState,I.updateQueue=G.updateQueue,I.type=G.type,u=G.dependencies,I.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),p=p.sibling;return or(Ar,Ar.current&1|2),d.child}u=u.sibling}I.tail!==null&&qe()>mf&&(d.flags|=128,w=!0,Kg(I,!1),d.lanes=4194304)}else{if(!w)if(u=Py(G),u!==null){if(d.flags|=128,w=!0,p=u.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),Kg(I,!0),I.tail===null&&I.tailMode==="hidden"&&!G.alternate&&!_r)return Zi(d),null}else 2*qe()-I.renderingStartTime>mf&&p!==1073741824&&(d.flags|=128,w=!0,Kg(I,!1),d.lanes=4194304);I.isBackwards?(G.sibling=d.child,d.child=G):(p=I.last,p!==null?p.sibling=G:d.child=G,I.last=G)}return I.tail!==null?(d=I.tail,I.rendering=d,I.tail=d.sibling,I.renderingStartTime=qe(),d.sibling=null,p=Ar.current,or(Ar,w?p&1|2:p&1),d):(Zi(d),null);case 22:case 23:return $2(),w=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==w&&(d.flags|=8192),w&&(d.mode&1)!==0?(ta&1073741824)!==0&&(Zi(d),d.subtreeFlags&6&&(d.flags|=8192)):Zi(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function RU(u,d){switch(Jw(d),d.tag){case 1:return As(d.type)&&xy(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return hf(),hr(bs),hr(qi),d2(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return u2(d),null;case 13:if(hr(Ar),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));of()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return hr(Ar),null;case 4:return hf(),null;case 10:return s2(d.type._context),null;case 22:case 23:return $2(),null;case 24:return null;default:return null}}var Vy=!1,Qi=!1,IU=typeof WeakSet=="function"?WeakSet:Set,vt=null;function ff(u,d){var p=u.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){Mr(u,d,w)}else p.current=null}function M2(u,d,p){try{p()}catch(w){Mr(u,d,w)}}var n4=!1;function CU(u,d){if($w=El,u=LP(),Dw(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else e:{p=(p=u.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var S=w.anchorOffset,I=w.focusNode;w=w.focusOffset;try{p.nodeType,I.nodeType}catch{p=null;break e}var G=0,re=-1,ae=-1,Pe=0,He=0,Ye=u,ze=null;t:for(;;){for(var _t;Ye!==p||S!==0&&Ye.nodeType!==3||(re=G+S),Ye!==I||w!==0&&Ye.nodeType!==3||(ae=G+w),Ye.nodeType===3&&(G+=Ye.nodeValue.length),(_t=Ye.firstChild)!==null;)ze=Ye,Ye=_t;for(;;){if(Ye===u)break t;if(ze===p&&++Pe===S&&(re=G),ze===I&&++He===w&&(ae=G),(_t=Ye.nextSibling)!==null)break;Ye=ze,ze=Ye.parentNode}Ye=_t}p=re===-1||ae===-1?null:{start:re,end:ae}}else p=null}p=p||{start:0,end:0}}else p=null;for(Ww={focusedElem:u,selectionRange:p},El=!1,vt=d;vt!==null;)if(d=vt,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,vt=u;else for(;vt!==null;){d=vt;try{var Tt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Tt!==null){var It=Tt.memoizedProps,zr=Tt.memoizedState,ge=d.stateNode,oe=ge.getSnapshotBeforeUpdate(d.elementType===d.type?It:Ya(d.type,It),zr);ge.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var Ee=d.stateNode.containerInfo;Ee.nodeType===1?Ee.textContent="":Ee.nodeType===9&&Ee.documentElement&&Ee.removeChild(Ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){Mr(d,d.return,Je)}if(u=d.sibling,u!==null){u.return=d.return,vt=u;break}vt=d.return}return Tt=n4,n4=!1,Tt}function Xg(u,d,p){var w=d.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var S=w=w.next;do{if((S.tag&u)===u){var I=S.destroy;S.destroy=void 0,I!==void 0&&M2(d,p,I)}S=S.next}while(S!==w)}}function Gy(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&u)===u){var w=p.create;p.destroy=w()}p=p.next}while(p!==d)}}function N2(u){var d=u.ref;if(d!==null){var p=u.stateNode;switch(u.tag){case 5:u=p;break;default:u=p}typeof d=="function"?d(u):d.current=u}}function r4(u){var d=u.alternate;d!==null&&(u.alternate=null,r4(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[Fo],delete d[Fg],delete d[qw],delete d[hU],delete d[dU])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function i4(u){return u.tag===5||u.tag===3||u.tag===4}function s4(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||i4(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function L2(u,d,p){var w=u.tag;if(w===5||w===6)u=u.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(u,d):p.insertBefore(u,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(u,p)):(d=p,d.appendChild(u)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=yy));else if(w!==4&&(u=u.child,u!==null))for(L2(u,d,p),u=u.sibling;u!==null;)L2(u,d,p),u=u.sibling}function O2(u,d,p){var w=u.tag;if(w===5||w===6)u=u.stateNode,d?p.insertBefore(u,d):p.appendChild(u);else if(w!==4&&(u=u.child,u!==null))for(O2(u,d,p),u=u.sibling;u!==null;)O2(u,d,p),u=u.sibling}var Li=null,Za=!1;function Nc(u,d,p){for(p=p.child;p!==null;)a4(u,d,p),p=p.sibling}function a4(u,d,p){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Xs,p)}catch{}switch(p.tag){case 5:Qi||ff(p,d);case 6:var w=Li,S=Za;Li=null,Nc(u,d,p),Li=w,Za=S,Li!==null&&(Za?(u=Li,p=p.stateNode,u.nodeType===8?u.parentNode.removeChild(p):u.removeChild(p)):Li.removeChild(p.stateNode));break;case 18:Li!==null&&(Za?(u=Li,p=p.stateNode,u.nodeType===8?Xw(u.parentNode,p):u.nodeType===1&&Xw(u,p),Sc(u)):Xw(Li,p.stateNode));break;case 4:w=Li,S=Za,Li=p.stateNode.containerInfo,Za=!0,Nc(u,d,p),Li=w,Za=S;break;case 0:case 11:case 14:case 15:if(!Qi&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){S=w=w.next;do{var I=S,G=I.destroy;I=I.tag,G!==void 0&&((I&2)!==0||(I&4)!==0)&&M2(p,d,G),S=S.next}while(S!==w)}Nc(u,d,p);break;case 1:if(!Qi&&(ff(p,d),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(re){Mr(p,d,re)}Nc(u,d,p);break;case 21:Nc(u,d,p);break;case 22:p.mode&1?(Qi=(w=Qi)||p.memoizedState!==null,Nc(u,d,p),Qi=w):Nc(u,d,p);break;default:Nc(u,d,p)}}function o4(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var p=u.stateNode;p===null&&(p=u.stateNode=new IU),d.forEach(function(w){var S=jU.bind(null,u,w);p.has(w)||(p.add(w),w.then(S,S))})}}function Qa(u,d){var p=d.deletions;if(p!==null)for(var w=0;w<p.length;w++){var S=p[w];try{var I=u,G=d,re=G;e:for(;re!==null;){switch(re.tag){case 5:Li=re.stateNode,Za=!1;break e;case 3:Li=re.stateNode.containerInfo,Za=!0;break e;case 4:Li=re.stateNode.containerInfo,Za=!0;break e}re=re.return}if(Li===null)throw Error(t(160));a4(I,G,S),Li=null,Za=!1;var ae=S.alternate;ae!==null&&(ae.return=null),S.return=null}catch(Pe){Mr(S,d,Pe)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)l4(d,u),d=d.sibling}function l4(u,d){var p=u.alternate,w=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Qa(d,u),Go(u),w&4){try{Xg(3,u,u.return),Gy(3,u)}catch(It){Mr(u,u.return,It)}try{Xg(5,u,u.return)}catch(It){Mr(u,u.return,It)}}break;case 1:Qa(d,u),Go(u),w&512&&p!==null&&ff(p,p.return);break;case 5:if(Qa(d,u),Go(u),w&512&&p!==null&&ff(p,p.return),u.flags&32){var S=u.stateNode;try{Kr(S,"")}catch(It){Mr(u,u.return,It)}}if(w&4&&(S=u.stateNode,S!=null)){var I=u.memoizedProps,G=p!==null?p.memoizedProps:I,re=u.type,ae=u.updateQueue;if(u.updateQueue=null,ae!==null)try{re==="input"&&I.type==="radio"&&I.name!=null&&tn(S,I),L(re,G);var Pe=L(re,I);for(G=0;G<ae.length;G+=2){var He=ae[G],Ye=ae[G+1];He==="style"?be(S,Ye):He==="dangerouslySetInnerHTML"?_i(S,Ye):He==="children"?Kr(S,Ye):A(S,He,Ye,Pe)}switch(re){case"input":lt(S,I);break;case"textarea":Fn(S,I);break;case"select":var ze=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!I.multiple;var _t=I.value;_t!=null?rr(S,!!I.multiple,_t,!1):ze!==!!I.multiple&&(I.defaultValue!=null?rr(S,!!I.multiple,I.defaultValue,!0):rr(S,!!I.multiple,I.multiple?[]:"",!1))}S[Fg]=I}catch(It){Mr(u,u.return,It)}}break;case 6:if(Qa(d,u),Go(u),w&4){if(u.stateNode===null)throw Error(t(162));S=u.stateNode,I=u.memoizedProps;try{S.nodeValue=I}catch(It){Mr(u,u.return,It)}}break;case 3:if(Qa(d,u),Go(u),w&4&&p!==null&&p.memoizedState.isDehydrated)try{Sc(d.containerInfo)}catch(It){Mr(u,u.return,It)}break;case 4:Qa(d,u),Go(u);break;case 13:Qa(d,u),Go(u),S=u.child,S.flags&8192&&(I=S.memoizedState!==null,S.stateNode.isHidden=I,!I||S.alternate!==null&&S.alternate.memoizedState!==null||(j2=qe())),w&4&&o4(u);break;case 22:if(He=p!==null&&p.memoizedState!==null,u.mode&1?(Qi=(Pe=Qi)||He,Qa(d,u),Qi=Pe):Qa(d,u),Go(u),w&8192){if(Pe=u.memoizedState!==null,(u.stateNode.isHidden=Pe)&&!He&&(u.mode&1)!==0)for(vt=u,He=u.child;He!==null;){for(Ye=vt=He;vt!==null;){switch(ze=vt,_t=ze.child,ze.tag){case 0:case 11:case 14:case 15:Xg(4,ze,ze.return);break;case 1:ff(ze,ze.return);var Tt=ze.stateNode;if(typeof Tt.componentWillUnmount=="function"){w=ze,p=ze.return;try{d=w,Tt.props=d.memoizedProps,Tt.state=d.memoizedState,Tt.componentWillUnmount()}catch(It){Mr(w,p,It)}}break;case 5:ff(ze,ze.return);break;case 22:if(ze.memoizedState!==null){h4(Ye);continue}}_t!==null?(_t.return=ze,vt=_t):h4(Ye)}He=He.sibling}e:for(He=null,Ye=u;;){if(Ye.tag===5){if(He===null){He=Ye;try{S=Ye.stateNode,Pe?(I=S.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(re=Ye.stateNode,ae=Ye.memoizedProps.style,G=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,re.style.display=je("display",G))}catch(It){Mr(u,u.return,It)}}}else if(Ye.tag===6){if(He===null)try{Ye.stateNode.nodeValue=Pe?"":Ye.memoizedProps}catch(It){Mr(u,u.return,It)}}else if((Ye.tag!==22&&Ye.tag!==23||Ye.memoizedState===null||Ye===u)&&Ye.child!==null){Ye.child.return=Ye,Ye=Ye.child;continue}if(Ye===u)break e;for(;Ye.sibling===null;){if(Ye.return===null||Ye.return===u)break e;He===Ye&&(He=null),Ye=Ye.return}He===Ye&&(He=null),Ye.sibling.return=Ye.return,Ye=Ye.sibling}}break;case 19:Qa(d,u),Go(u),w&4&&o4(u);break;case 21:break;default:Qa(d,u),Go(u)}}function Go(u){var d=u.flags;if(d&2){try{e:{for(var p=u.return;p!==null;){if(i4(p)){var w=p;break e}p=p.return}throw Error(t(160))}switch(w.tag){case 5:var S=w.stateNode;w.flags&32&&(Kr(S,""),w.flags&=-33);var I=s4(u);O2(u,I,S);break;case 3:case 4:var G=w.stateNode.containerInfo,re=s4(u);L2(u,re,G);break;default:throw Error(t(161))}}catch(ae){Mr(u,u.return,ae)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function PU(u,d,p){vt=u,c4(u)}function c4(u,d,p){for(var w=(u.mode&1)!==0;vt!==null;){var S=vt,I=S.child;if(S.tag===22&&w){var G=S.memoizedState!==null||Vy;if(!G){var re=S.alternate,ae=re!==null&&re.memoizedState!==null||Qi;re=Vy;var Pe=Qi;if(Vy=G,(Qi=ae)&&!Pe)for(vt=S;vt!==null;)G=vt,ae=G.child,G.tag===22&&G.memoizedState!==null?d4(S):ae!==null?(ae.return=G,vt=ae):d4(S);for(;I!==null;)vt=I,c4(I),I=I.sibling;vt=S,Vy=re,Qi=Pe}u4(u)}else(S.subtreeFlags&8772)!==0&&I!==null?(I.return=S,vt=I):u4(u)}}function u4(u){for(;vt!==null;){var d=vt;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Qi||Gy(5,d);break;case 1:var w=d.stateNode;if(d.flags&4&&!Qi)if(p===null)w.componentDidMount();else{var S=d.elementType===d.type?p.memoizedProps:Ya(d.type,p.memoizedProps);w.componentDidUpdate(S,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var I=d.updateQueue;I!==null&&hk(d,I,w);break;case 3:var G=d.updateQueue;if(G!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}hk(d,G,p)}break;case 5:var re=d.stateNode;if(p===null&&d.flags&4){p=re;var ae=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&p.focus();break;case"img":ae.src&&(p.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Pe=d.alternate;if(Pe!==null){var He=Pe.memoizedState;if(He!==null){var Ye=He.dehydrated;Ye!==null&&Sc(Ye)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Qi||d.flags&512&&N2(d)}catch(ze){Mr(d,d.return,ze)}}if(d===u){vt=null;break}if(p=d.sibling,p!==null){p.return=d.return,vt=p;break}vt=d.return}}function h4(u){for(;vt!==null;){var d=vt;if(d===u){vt=null;break}var p=d.sibling;if(p!==null){p.return=d.return,vt=p;break}vt=d.return}}function d4(u){for(;vt!==null;){var d=vt;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{Gy(4,d)}catch(ae){Mr(d,p,ae)}break;case 1:var w=d.stateNode;if(typeof w.componentDidMount=="function"){var S=d.return;try{w.componentDidMount()}catch(ae){Mr(d,S,ae)}}var I=d.return;try{N2(d)}catch(ae){Mr(d,I,ae)}break;case 5:var G=d.return;try{N2(d)}catch(ae){Mr(d,G,ae)}}}catch(ae){Mr(d,d.return,ae)}if(d===u){vt=null;break}var re=d.sibling;if(re!==null){re.return=d.return,vt=re;break}vt=d.return}}var kU=Math.ceil,By=M.ReactCurrentDispatcher,D2=M.ReactCurrentOwner,Sa=M.ReactCurrentBatchConfig,Sn=0,vi=null,qr=null,Oi=0,ta=0,gf=Ic(0),li=0,qg=null,ch=0,Uy=0,F2=0,Yg=null,Is=null,j2=0,mf=1/0,kl=null,zy=!1,V2=null,Lc=null,$y=!1,Oc=null,Wy=0,Zg=0,G2=null,Hy=-1,Ky=0;function ms(){return(Sn&6)!==0?qe():Hy!==-1?Hy:Hy=qe()}function Dc(u){return(u.mode&1)===0?1:(Sn&2)!==0&&Oi!==0?Oi&-Oi:gU.transition!==null?(Ky===0&&(Ky=_g()),Ky):(u=vn,u!==0||(u=window.event,u=u===void 0?16:zd(u.type)),u)}function Ja(u,d,p,w){if(50<Zg)throw Zg=0,G2=null,Error(t(185));Zu(u,p,w),((Sn&2)===0||u!==vi)&&(u===vi&&((Sn&2)===0&&(Uy|=p),li===4&&Fc(u,Oi)),Cs(u,w),p===1&&Sn===0&&(d.mode&1)===0&&(mf=qe()+500,Ey&&Pc()))}function Cs(u,d){var p=u.callbackNode;Yu(u,d);var w=_l(u,u===vi?Oi:0);if(w===0)p!==null&&tt(p),u.callbackNode=null,u.callbackPriority=0;else if(d=w&-w,u.callbackPriority!==d){if(p!=null&&tt(p),d===1)u.tag===0?fU(g4.bind(null,u)):JP(g4.bind(null,u)),cU(function(){(Sn&6)===0&&Pc()}),p=null;else{switch(Ro(w)){case 1:p=jn;break;case 4:p=zn;break;case 16:p=yr;break;case 536870912:p=ya;break;default:p=yr}p=w4(p,f4.bind(null,u))}u.callbackPriority=d,u.callbackNode=p}}function f4(u,d){if(Hy=-1,Ky=0,(Sn&6)!==0)throw Error(t(327));var p=u.callbackNode;if(pf()&&u.callbackNode!==p)return null;var w=_l(u,u===vi?Oi:0);if(w===0)return null;if((w&30)!==0||(w&u.expiredLanes)!==0||d)d=Xy(u,w);else{d=w;var S=Sn;Sn|=2;var I=p4();(vi!==u||Oi!==d)&&(kl=null,mf=qe()+500,hh(u,d));do try{LU();break}catch(re){m4(u,re)}while(!0);i2(),By.current=I,Sn=S,qr!==null?d=0:(vi=null,Oi=0,d=li)}if(d!==0){if(d===2&&(S=yg(u),S!==0&&(w=S,d=B2(u,S))),d===1)throw p=qg,hh(u,0),Fc(u,w),Cs(u,qe()),p;if(d===6)Fc(u,w);else{if(S=u.current.alternate,(w&30)===0&&!MU(S)&&(d=Xy(u,w),d===2&&(I=yg(u),I!==0&&(w=I,d=B2(u,I))),d===1))throw p=qg,hh(u,0),Fc(u,w),Cs(u,qe()),p;switch(u.finishedWork=S,u.finishedLanes=w,d){case 0:case 1:throw Error(t(345));case 2:dh(u,Is,kl);break;case 3:if(Fc(u,w),(w&130023424)===w&&(d=j2+500-qe(),10<d)){if(_l(u,0)!==0)break;if(S=u.suspendedLanes,(S&w)!==w){ms(),u.pingedLanes|=u.suspendedLanes&S;break}u.timeoutHandle=Kw(dh.bind(null,u,Is,kl),d);break}dh(u,Is,kl);break;case 4:if(Fc(u,w),(w&4194240)===w)break;for(d=u.eventTimes,S=-1;0<w;){var G=31-br(w);I=1<<G,G=d[G],G>S&&(S=G),w&=~I}if(w=S,w=qe()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*kU(w/1960))-w,10<w){u.timeoutHandle=Kw(dh.bind(null,u,Is,kl),w);break}dh(u,Is,kl);break;case 5:dh(u,Is,kl);break;default:throw Error(t(329))}}}return Cs(u,qe()),u.callbackNode===p?f4.bind(null,u):null}function B2(u,d){var p=Yg;return u.current.memoizedState.isDehydrated&&(hh(u,d).flags|=256),u=Xy(u,d),u!==2&&(d=Is,Is=p,d!==null&&U2(d)),u}function U2(u){Is===null?Is=u:Is.push.apply(Is,u)}function MU(u){for(var d=u;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var S=p[w],I=S.getSnapshot;S=S.value;try{if(!Xa(I(),S))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Fc(u,d){for(d&=~F2,d&=~Uy,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var p=31-br(d),w=1<<p;u[p]=-1,d&=~w}}function g4(u){if((Sn&6)!==0)throw Error(t(327));pf();var d=_l(u,0);if((d&1)===0)return Cs(u,qe()),null;var p=Xy(u,d);if(u.tag!==0&&p===2){var w=yg(u);w!==0&&(d=w,p=B2(u,w))}if(p===1)throw p=qg,hh(u,0),Fc(u,d),Cs(u,qe()),p;if(p===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,dh(u,Is,kl),Cs(u,qe()),null}function z2(u,d){var p=Sn;Sn|=1;try{return u(d)}finally{Sn=p,Sn===0&&(mf=qe()+500,Ey&&Pc())}}function uh(u){Oc!==null&&Oc.tag===0&&(Sn&6)===0&&pf();var d=Sn;Sn|=1;var p=Sa.transition,w=vn;try{if(Sa.transition=null,vn=1,u)return u()}finally{vn=w,Sa.transition=p,Sn=d,(Sn&6)===0&&Pc()}}function $2(){ta=gf.current,hr(gf)}function hh(u,d){u.finishedWork=null,u.finishedLanes=0;var p=u.timeoutHandle;if(p!==-1&&(u.timeoutHandle=-1,lU(p)),qr!==null)for(p=qr.return;p!==null;){var w=p;switch(Jw(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&xy();break;case 3:hf(),hr(bs),hr(qi),d2();break;case 5:u2(w);break;case 4:hf();break;case 13:hr(Ar);break;case 19:hr(Ar);break;case 10:s2(w.type._context);break;case 22:case 23:$2()}p=p.return}if(vi=u,qr=u=jc(u.current,null),Oi=ta=d,li=0,qg=null,F2=Uy=ch=0,Is=Yg=null,ah!==null){for(d=0;d<ah.length;d++)if(p=ah[d],w=p.interleaved,w!==null){p.interleaved=null;var S=w.next,I=p.pending;if(I!==null){var G=I.next;I.next=S,w.next=G}p.pending=w}ah=null}return u}function m4(u,d){do{var p=qr;try{if(i2(),ky.current=Oy,My){for(var w=Rr.memoizedState;w!==null;){var S=w.queue;S!==null&&(S.pending=null),w=w.next}My=!1}if(lh=0,xi=oi=Rr=null,zg=!1,$g=0,D2.current=null,p===null||p.return===null){li=1,qg=d,qr=null;break}e:{var I=u,G=p.return,re=p,ae=d;if(d=Oi,re.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Pe=ae,He=re,Ye=He.tag;if((He.mode&1)===0&&(Ye===0||Ye===11||Ye===15)){var ze=He.alternate;ze?(He.updateQueue=ze.updateQueue,He.memoizedState=ze.memoizedState,He.lanes=ze.lanes):(He.updateQueue=null,He.memoizedState=null)}var _t=Gk(G);if(_t!==null){_t.flags&=-257,Bk(_t,G,re,I,d),_t.mode&1&&Vk(I,Pe,d),d=_t,ae=Pe;var Tt=d.updateQueue;if(Tt===null){var It=new Set;It.add(ae),d.updateQueue=It}else Tt.add(ae);break e}else{if((d&1)===0){Vk(I,Pe,d),W2();break e}ae=Error(t(426))}}else if(_r&&re.mode&1){var zr=Gk(G);if(zr!==null){(zr.flags&65536)===0&&(zr.flags|=256),Bk(zr,G,re,I,d),n2(df(ae,re));break e}}I=ae=df(ae,re),li!==4&&(li=2),Yg===null?Yg=[I]:Yg.push(I),I=G;do{switch(I.tag){case 3:I.flags|=65536,d&=-d,I.lanes|=d;var ge=Fk(I,ae,d);uk(I,ge);break e;case 1:re=ae;var oe=I.type,Ee=I.stateNode;if((I.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||Ee!==null&&typeof Ee.componentDidCatch=="function"&&(Lc===null||!Lc.has(Ee)))){I.flags|=65536,d&=-d,I.lanes|=d;var Je=jk(I,re,d);uk(I,Je);break e}}I=I.return}while(I!==null)}_4(p)}catch(Pt){d=Pt,qr===p&&p!==null&&(qr=p=p.return);continue}break}while(!0)}function p4(){var u=By.current;return By.current=Oy,u===null?Oy:u}function W2(){(li===0||li===3||li===2)&&(li=4),vi===null||(ch&268435455)===0&&(Uy&268435455)===0||Fc(vi,Oi)}function Xy(u,d){var p=Sn;Sn|=2;var w=p4();(vi!==u||Oi!==d)&&(kl=null,hh(u,d));do try{NU();break}catch(S){m4(u,S)}while(!0);if(i2(),Sn=p,By.current=w,qr!==null)throw Error(t(261));return vi=null,Oi=0,li}function NU(){for(;qr!==null;)y4(qr)}function LU(){for(;qr!==null&&!gt();)y4(qr)}function y4(u){var d=E4(u.alternate,u,ta);u.memoizedProps=u.pendingProps,d===null?_4(u):qr=d,D2.current=null}function _4(u){var d=u;do{var p=d.alternate;if(u=d.return,(d.flags&32768)===0){if(p=AU(p,d,ta),p!==null){qr=p;return}}else{if(p=RU(p,d),p!==null){p.flags&=32767,qr=p;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{li=6,qr=null;return}}if(d=d.sibling,d!==null){qr=d;return}qr=d=u}while(d!==null);li===0&&(li=5)}function dh(u,d,p){var w=vn,S=Sa.transition;try{Sa.transition=null,vn=1,OU(u,d,p,w)}finally{Sa.transition=S,vn=w}return null}function OU(u,d,p,w){do pf();while(Oc!==null);if((Sn&6)!==0)throw Error(t(327));p=u.finishedWork;var S=u.finishedLanes;if(p===null)return null;if(u.finishedWork=null,u.finishedLanes=0,p===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var I=p.lanes|p.childLanes;if(kw(u,I),u===vi&&(qr=vi=null,Oi=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||$y||($y=!0,w4(yr,function(){return pf(),null})),I=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||I){I=Sa.transition,Sa.transition=null;var G=vn;vn=1;var re=Sn;Sn|=4,D2.current=null,CU(u,p),l4(p,u),tU(Ww),El=!!$w,Ww=$w=null,u.current=p,PU(p),Xe(),Sn=re,vn=G,Sa.transition=I}else u.current=p;if($y&&($y=!1,Oc=u,Wy=S),I=u.pendingLanes,I===0&&(Lc=null),xc(p.stateNode),Cs(u,qe()),d!==null)for(w=u.onRecoverableError,p=0;p<d.length;p++)S=d[p],w(S.value,{componentStack:S.stack,digest:S.digest});if(zy)throw zy=!1,u=V2,V2=null,u;return(Wy&1)!==0&&u.tag!==0&&pf(),I=u.pendingLanes,(I&1)!==0?u===G2?Zg++:(Zg=0,G2=u):Zg=0,Pc(),null}function pf(){if(Oc!==null){var u=Ro(Wy),d=Sa.transition,p=vn;try{if(Sa.transition=null,vn=16>u?16:u,Oc===null)var w=!1;else{if(u=Oc,Oc=null,Wy=0,(Sn&6)!==0)throw Error(t(331));var S=Sn;for(Sn|=4,vt=u.current;vt!==null;){var I=vt,G=I.child;if((vt.flags&16)!==0){var re=I.deletions;if(re!==null){for(var ae=0;ae<re.length;ae++){var Pe=re[ae];for(vt=Pe;vt!==null;){var He=vt;switch(He.tag){case 0:case 11:case 15:Xg(8,He,I)}var Ye=He.child;if(Ye!==null)Ye.return=He,vt=Ye;else for(;vt!==null;){He=vt;var ze=He.sibling,_t=He.return;if(r4(He),He===Pe){vt=null;break}if(ze!==null){ze.return=_t,vt=ze;break}vt=_t}}}var Tt=I.alternate;if(Tt!==null){var It=Tt.child;if(It!==null){Tt.child=null;do{var zr=It.sibling;It.sibling=null,It=zr}while(It!==null)}}vt=I}}if((I.subtreeFlags&2064)!==0&&G!==null)G.return=I,vt=G;else e:for(;vt!==null;){if(I=vt,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:Xg(9,I,I.return)}var ge=I.sibling;if(ge!==null){ge.return=I.return,vt=ge;break e}vt=I.return}}var oe=u.current;for(vt=oe;vt!==null;){G=vt;var Ee=G.child;if((G.subtreeFlags&2064)!==0&&Ee!==null)Ee.return=G,vt=Ee;else e:for(G=oe;vt!==null;){if(re=vt,(re.flags&2048)!==0)try{switch(re.tag){case 0:case 11:case 15:Gy(9,re)}}catch(Pt){Mr(re,re.return,Pt)}if(re===G){vt=null;break e}var Je=re.sibling;if(Je!==null){Je.return=re.return,vt=Je;break e}vt=re.return}}if(Sn=S,Pc(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Xs,u)}catch{}w=!0}return w}finally{vn=p,Sa.transition=d}}return!1}function x4(u,d,p){d=df(p,d),d=Fk(u,d,1),u=Mc(u,d,1),d=ms(),u!==null&&(Zu(u,1,d),Cs(u,d))}function Mr(u,d,p){if(u.tag===3)x4(u,u,p);else for(;d!==null;){if(d.tag===3){x4(d,u,p);break}else if(d.tag===1){var w=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Lc===null||!Lc.has(w))){u=df(p,u),u=jk(d,u,1),d=Mc(d,u,1),u=ms(),d!==null&&(Zu(d,1,u),Cs(d,u));break}}d=d.return}}function DU(u,d,p){var w=u.pingCache;w!==null&&w.delete(d),d=ms(),u.pingedLanes|=u.suspendedLanes&p,vi===u&&(Oi&p)===p&&(li===4||li===3&&(Oi&130023424)===Oi&&500>qe()-j2?hh(u,0):F2|=p),Cs(u,d)}function v4(u,d){d===0&&((u.mode&1)===0?d=1:(d=vc,vc<<=1,(vc&130023424)===0&&(vc=4194304)));var p=ms();u=Il(u,d),u!==null&&(Zu(u,d,p),Cs(u,p))}function FU(u){var d=u.memoizedState,p=0;d!==null&&(p=d.retryLane),v4(u,p)}function jU(u,d){var p=0;switch(u.tag){case 13:var w=u.stateNode,S=u.memoizedState;S!==null&&(p=S.retryLane);break;case 19:w=u.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(d),v4(u,p)}var E4;E4=function(u,d,p){if(u!==null)if(u.memoizedProps!==d.pendingProps||bs.current)Rs=!0;else{if((u.lanes&p)===0&&(d.flags&128)===0)return Rs=!1,bU(u,d,p);Rs=(u.flags&131072)!==0}else Rs=!1,_r&&(d.flags&1048576)!==0&&ek(d,Sy,d.index);switch(d.lanes=0,d.tag){case 2:var w=d.type;jy(u,d),u=d.pendingProps;var S=rf(d,qi.current);uf(d,p),S=m2(null,d,w,u,S,p);var I=p2();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,As(w)?(I=!0,vy(d)):I=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,l2(d),S.updater=Dy,d.stateNode=S,S._reactInternals=d,w2(d,w,u,p),d=A2(null,d,w,!0,I,p)):(d.tag=0,_r&&I&&Qw(d),gs(null,d,S,p),d=d.child),d;case 16:w=d.elementType;e:{switch(jy(u,d),u=d.pendingProps,S=w._init,w=S(w._payload),d.type=w,S=d.tag=GU(w),u=Ya(w,u),S){case 0:d=b2(null,d,w,u,p);break e;case 1:d=Kk(null,d,w,u,p);break e;case 11:d=Uk(null,d,w,u,p);break e;case 14:d=zk(null,d,w,Ya(w.type,u),p);break e}throw Error(t(306,w,""))}return d;case 0:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),b2(u,d,w,S,p);case 1:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),Kk(u,d,w,S,p);case 3:e:{if(Xk(d),u===null)throw Error(t(387));w=d.pendingProps,I=d.memoizedState,S=I.element,ck(u,d),Cy(d,w,null,p);var G=d.memoizedState;if(w=G.element,I.isDehydrated)if(I={element:w,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},d.updateQueue.baseState=I,d.memoizedState=I,d.flags&256){S=df(Error(t(423)),d),d=qk(u,d,w,p,S);break e}else if(w!==S){S=df(Error(t(424)),d),d=qk(u,d,w,p,S);break e}else for(ea=Rc(d.stateNode.containerInfo.firstChild),Js=d,_r=!0,qa=null,p=ok(d,null,w,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(of(),w===S){d=Pl(u,d,p);break e}gs(u,d,w,p)}d=d.child}return d;case 5:return dk(d),u===null&&t2(d),w=d.type,S=d.pendingProps,I=u!==null?u.memoizedProps:null,G=S.children,Hw(w,S)?G=null:I!==null&&Hw(w,I)&&(d.flags|=32),Hk(u,d),gs(u,d,G,p),d.child;case 6:return u===null&&t2(d),null;case 13:return Yk(u,d,p);case 4:return c2(d,d.stateNode.containerInfo),w=d.pendingProps,u===null?d.child=lf(d,null,w,p):gs(u,d,w,p),d.child;case 11:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),Uk(u,d,w,S,p);case 7:return gs(u,d,d.pendingProps,p),d.child;case 8:return gs(u,d,d.pendingProps.children,p),d.child;case 12:return gs(u,d,d.pendingProps.children,p),d.child;case 10:e:{if(w=d.type._context,S=d.pendingProps,I=d.memoizedProps,G=S.value,or(Ay,w._currentValue),w._currentValue=G,I!==null)if(Xa(I.value,G)){if(I.children===S.children&&!bs.current){d=Pl(u,d,p);break e}}else for(I=d.child,I!==null&&(I.return=d);I!==null;){var re=I.dependencies;if(re!==null){G=I.child;for(var ae=re.firstContext;ae!==null;){if(ae.context===w){if(I.tag===1){ae=Cl(-1,p&-p),ae.tag=2;var Pe=I.updateQueue;if(Pe!==null){Pe=Pe.shared;var He=Pe.pending;He===null?ae.next=ae:(ae.next=He.next,He.next=ae),Pe.pending=ae}}I.lanes|=p,ae=I.alternate,ae!==null&&(ae.lanes|=p),a2(I.return,p,d),re.lanes|=p;break}ae=ae.next}}else if(I.tag===10)G=I.type===d.type?null:I.child;else if(I.tag===18){if(G=I.return,G===null)throw Error(t(341));G.lanes|=p,re=G.alternate,re!==null&&(re.lanes|=p),a2(G,p,d),G=I.sibling}else G=I.child;if(G!==null)G.return=I;else for(G=I;G!==null;){if(G===d){G=null;break}if(I=G.sibling,I!==null){I.return=G.return,G=I;break}G=G.return}I=G}gs(u,d,S.children,p),d=d.child}return d;case 9:return S=d.type,w=d.pendingProps.children,uf(d,p),S=Ea(S),w=w(S),d.flags|=1,gs(u,d,w,p),d.child;case 14:return w=d.type,S=Ya(w,d.pendingProps),S=Ya(w.type,S),zk(u,d,w,S,p);case 15:return $k(u,d,d.type,d.pendingProps,p);case 17:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),jy(u,d),d.tag=1,As(w)?(u=!0,vy(d)):u=!1,uf(d,p),Ok(d,w,S),w2(d,w,S,p),A2(null,d,w,!0,u,p);case 19:return Qk(u,d,p);case 22:return Wk(u,d,p)}throw Error(t(156,d.tag))};function w4(u,d){return Ke(u,d)}function VU(u,d,p,w){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(u,d,p,w){return new VU(u,d,p,w)}function H2(u){return u=u.prototype,!(!u||!u.isReactComponent)}function GU(u){if(typeof u=="function")return H2(u)?1:0;if(u!=null){if(u=u.$$typeof,u===z)return 11;if(u===Ne)return 14}return 2}function jc(u,d){var p=u.alternate;return p===null?(p=Ta(u.tag,d,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=d,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&14680064,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,d=u.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p}function qy(u,d,p,w,S,I){var G=2;if(w=u,typeof u=="function")H2(u)&&(G=1);else if(typeof u=="string")G=5;else e:switch(u){case P:return fh(p.children,S,I,d);case R:G=8,S|=8;break;case k:return u=Ta(12,p,d,S|2),u.elementType=k,u.lanes=I,u;case j:return u=Ta(13,p,d,S),u.elementType=j,u.lanes=I,u;case Re:return u=Ta(19,p,d,S),u.elementType=Re,u.lanes=I,u;case Oe:return Yy(p,S,I,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case N:G=10;break e;case O:G=9;break e;case z:G=11;break e;case Ne:G=14;break e;case Ve:G=16,w=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=Ta(G,p,d,S),d.elementType=u,d.type=w,d.lanes=I,d}function fh(u,d,p,w){return u=Ta(7,u,w,d),u.lanes=p,u}function Yy(u,d,p,w){return u=Ta(22,u,w,d),u.elementType=Oe,u.lanes=p,u.stateNode={isHidden:!1},u}function K2(u,d,p){return u=Ta(6,u,null,d),u.lanes=p,u}function X2(u,d,p){return d=Ta(4,u.children!==null?u.children:[],u.key,d),d.lanes=p,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function BU(u,d,p,w,S){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xg(0),this.expirationTimes=xg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xg(0),this.identifierPrefix=w,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function q2(u,d,p,w,S,I,G,re,ae){return u=new BU(u,d,p,re,ae),d===1?(d=1,I===!0&&(d|=8)):d=0,I=Ta(3,null,null,d),u.current=I,I.stateNode=u,I.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},l2(I),u}function UU(u,d,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:w==null?null:""+w,children:u,containerInfo:d,implementation:p}}function S4(u){if(!u)return Cc;u=u._reactInternals;e:{if(te(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(As(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var p=u.type;if(As(p))return ZP(u,p,d)}return d}function T4(u,d,p,w,S,I,G,re,ae){return u=q2(p,w,!0,u,S,I,G,re,ae),u.context=S4(null),p=u.current,w=ms(),S=Dc(p),I=Cl(w,S),I.callback=d??null,Mc(p,I,S),u.current.lanes=S,Zu(u,S,w),Cs(u,w),u}function Zy(u,d,p,w){var S=d.current,I=ms(),G=Dc(S);return p=S4(p),d.context===null?d.context=p:d.pendingContext=p,d=Cl(I,G),d.payload={element:u},w=w===void 0?null:w,w!==null&&(d.callback=w),u=Mc(S,d,G),u!==null&&(Ja(u,S,G,I),Iy(u,S,G)),G}function Qy(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function b4(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<d?p:d}}function Y2(u,d){b4(u,d),(u=u.alternate)&&b4(u,d)}function zU(){return null}var A4=typeof reportError=="function"?reportError:function(u){console.error(u)};function Z2(u){this._internalRoot=u}Jy.prototype.render=Z2.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));Zy(u,d,null,null)},Jy.prototype.unmount=Z2.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;uh(function(){Zy(null,u,null,null)}),d[Tl]=null}};function Jy(u){this._internalRoot=u}Jy.prototype.unstable_scheduleHydration=function(u){if(u){var d=Sg();u={blockedOn:null,target:u,priority:d};for(var p=0;p<qs.length&&d!==0&&d<qs[p].priority;p++);qs.splice(p,0,u),p===0&&Bd(u)}};function Q2(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function e_(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function R4(){}function $U(u,d,p,w,S){if(S){if(typeof w=="function"){var I=w;w=function(){var Pe=Qy(G);I.call(Pe)}}var G=T4(d,w,u,0,null,!1,!1,"",R4);return u._reactRootContainer=G,u[Tl]=G.current,Og(u.nodeType===8?u.parentNode:u),uh(),G}for(;S=u.lastChild;)u.removeChild(S);if(typeof w=="function"){var re=w;w=function(){var Pe=Qy(ae);re.call(Pe)}}var ae=q2(u,0,!1,null,null,!1,!1,"",R4);return u._reactRootContainer=ae,u[Tl]=ae.current,Og(u.nodeType===8?u.parentNode:u),uh(function(){Zy(d,ae,p,w)}),ae}function t_(u,d,p,w,S){var I=p._reactRootContainer;if(I){var G=I;if(typeof S=="function"){var re=S;S=function(){var ae=Qy(G);re.call(ae)}}Zy(d,G,u,S)}else G=$U(p,d,u,S,w);return Qy(G)}Eg=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var p=Pn(d.pendingLanes);p!==0&&(vg(d,p|1),Cs(d,qe()),(Sn&6)===0&&(mf=qe()+500,Pc()))}break;case 13:uh(function(){var w=Il(u,1);if(w!==null){var S=ms();Ja(w,u,1,S)}}),Y2(u,1)}},Vd=function(u){if(u.tag===13){var d=Il(u,134217728);if(d!==null){var p=ms();Ja(d,u,134217728,p)}Y2(u,134217728)}},wg=function(u){if(u.tag===13){var d=Dc(u),p=Il(u,d);if(p!==null){var w=ms();Ja(p,u,d,w)}Y2(u,d)}},Sg=function(){return vn},Tg=function(u,d){var p=vn;try{return vn=u,d()}finally{vn=p}},Z=function(u,d,p){switch(d){case"input":if(lt(u,p),d=p.name,p.type==="radio"&&d!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var w=p[d];if(w!==u&&w.form===u.form){var S=_y(w);if(!S)throw Error(t(90));St(w),lt(w,S)}}}break;case"textarea":Fn(u,p);break;case"select":d=p.value,d!=null&&rr(u,!!p.multiple,d,!1)}},$e=z2,et=uh;var WU={usingClientEntryPoint:!1,Events:[jg,tf,_y,Be,Ie,z2]},Qg={findFiberByHostInstance:nh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HU={bundleType:Qg.bundleType,version:Qg.version,rendererPackageName:Qg.rendererPackageName,rendererConfig:Qg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Te(u),u===null?null:u.stateNode},findFiberByHostInstance:Qg.findFiberByHostInstance||zU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var n_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!n_.isDisabled&&n_.supportsFiber)try{Xs=n_.inject(HU),Br=n_}catch{}}return Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WU,Ps.createPortal=function(u,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q2(d))throw Error(t(200));return UU(u,d,null,p)},Ps.createRoot=function(u,d){if(!Q2(u))throw Error(t(299));var p=!1,w="",S=A4;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=q2(u,1,!1,null,null,p,!1,w,S),u[Tl]=d.current,Og(u.nodeType===8?u.parentNode:u),new Z2(d)},Ps.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Te(d),u=u===null?null:u.stateNode,u},Ps.flushSync=function(u){return uh(u)},Ps.hydrate=function(u,d,p){if(!e_(d))throw Error(t(200));return t_(null,u,d,!0,p)},Ps.hydrateRoot=function(u,d,p){if(!Q2(u))throw Error(t(405));var w=p!=null&&p.hydratedSources||null,S=!1,I="",G=A4;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(I=p.identifierPrefix),p.onRecoverableError!==void 0&&(G=p.onRecoverableError)),d=T4(d,null,u,1,p??null,S,!1,I,G),u[Tl]=d.current,Og(u),w)for(u=0;u<w.length;u++)p=w[u],S=p._getVersion,S=S(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,S]:d.mutableSourceEagerHydrationData.push(p,S);return new Jy(d)},Ps.render=function(u,d,p){if(!e_(d))throw Error(t(200));return t_(null,u,d,!1,p)},Ps.unmountComponentAtNode=function(u){if(!e_(u))throw Error(t(40));return u._reactRootContainer?(uh(function(){t_(null,null,u,!1,function(){u._reactRootContainer=null,u[Tl]=null})}),!0):!1},Ps.unstable_batchedUpdates=z2,Ps.unstable_renderSubtreeIntoContainer=function(u,d,p,w){if(!e_(p))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return t_(u,d,p,!1,w)},Ps.version="18.3.1-next-f1338f8080-20240426",Ps}var O4;function ez(){if(O4)return tS.exports;O4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),tS.exports=JU(),tS.exports}var D4;function tz(){if(D4)return r_;D4=1;var n=ez();return r_.createRoot=n.createRoot,r_.hydrateRoot=n.hydrateRoot,r_}var nz=tz();const rz=FA(nz);var X=i1();const iz=FA(X),Ns={ADD:"add",REMOVE:"remove"},b0={PROPERTYCHANGE:"propertychange"},Zt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class s1{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function sz(n,e,t){let r,i;t=t||Wl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Wl(n,e){return n>e?1:n<e?-1:0}function az(n,e){return n<e?1:n>e?-1:0}function oE(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function oz(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Vn(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function uc(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function lz(n,e,t){const r=e||Wl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function cp(){return!0}function lE(){return!1}function up(){}function Z5(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!uc(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function Q5(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function eg(n){for(const e in n)delete n[e]}function Zh(n){let e;for(e in n)return!1;return!e}class gl{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let a1=class extends s1{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new gl(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let c=0,h=i.length;c<h;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let c=o[r];for(delete o[r];c--;)this.removeEventListener(r,up);delete a[r]}return l}disposeInternal(){this.listeners_&&eg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=up,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function fn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Ex(n,e,t,r){return fn(n,e,t,r,!0)}function sr(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),eg(n))}class o1 extends a1{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Zt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=fn(this,e[s],t);return i}return fn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=Ex(this,e[s],t)}else r=Ex(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)cz(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}o1.prototype.on;o1.prototype.once;o1.prototype.un;function cz(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)sr(n[e]);else sr(n)}function $t(){throw new Error("Unimplemented abstract method.")}let uz=0;function zt(n){return n.ol_uid||(n.ol_uid=String(++uz))}class F4 extends gl{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class ml extends o1{constructor(e){super(),this.on,this.once,this.un,zt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new F4(r,e,t)),r=b0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new F4(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],Zh(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const j4={LENGTH:"length"};class i_ extends gl{constructor(e,t,r){super(e),this.element=t,this.index=r}}class Ma extends ml{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(j4.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new i_(Ns.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new i_(Ns.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new i_(Ns.REMOVE,i,e)),this.dispatchEvent(new i_(Ns.ADD,t,e))}updateLength_(){this.set(j4.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function wn(n,e){if(!n)throw new Error(e)}let vr=class J5 extends ml{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new J5(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(sr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=fn(e,Zt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?hz(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function hz(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(wn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const wi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function V4(n){const e=Bs();for(let t=0,r=n.length;t<r;++t)km(e,n[t]);return e}function A0(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function eD(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Ed(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function Qh(n,e){return jA(n,e[0],e[1])}function su(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function jA(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function BT(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=wi.UNKNOWN;return a<t?l=l|wi.LEFT:a>i&&(l=l|wi.RIGHT),o<r?l=l|wi.BELOW:o>s&&(l=l|wi.ABOVE),l===wi.UNKNOWN&&(l=wi.INTERSECTING),l}function Bs(){return[1/0,1/0,-1/0,-1/0]}function bu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function l1(n){return bu(1/0,1/0,-1/0,-1/0,n)}function tD(n,e){const t=n[0],r=n[1];return bu(t,r,t,r,e)}function VA(n,e,t,r,i){const s=l1(i);return rD(s,n,e,t,r)}function Jh(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function nD(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function km(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function rD(n,e,t,r,i){for(;t<r;t+=i)dz(n,e[t],e[t+1]);return n}function dz(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function iD(n,e){let t;return t=e(cE(n)),t||(t=e(uE(n)),t)||(t=e(hE(n)),t)||(t=e(wd(n)),t)?t:!1}function UT(n){let e=0;return tg(n)||(e=gn(n)*ei(n)),e}function cE(n){return[n[0],n[1]]}function uE(n){return[n[2],n[1]]}function ll(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function fz(n,e){let t;if(e==="bottom-left")t=cE(n);else if(e==="bottom-right")t=uE(n);else if(e==="top-left")t=wd(n);else if(e==="top-right")t=hE(n);else throw new Error("Invalid corner");return t}function wx(n,e,t,r,i){const[s,a,o,l,c,h,f,m]=sD(n,e,t,r);return bu(Math.min(s,o,c,f),Math.min(a,l,h,m),Math.max(s,o,c,f),Math.max(a,l,h,m),i)}function sD(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,c=i*o,h=s*a,f=s*o,m=n[0],y=n[1];return[m-l+f,y-c-h,m-l-f,y-c+h,m+l-f,y+c+h,m+l+f,y+c-h,m-l+f,y-c-h]}function ei(n){return n[3]-n[1]}function Hl(n,e,t){const r=t||Bs();return xs(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):l1(r),r}function wd(n){return[n[0],n[3]]}function hE(n){return[n[2],n[3]]}function gn(n){return n[2]-n[0]}function xs(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function tg(n){return n[2]<n[0]||n[3]<n[1]}function gz(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function mz(n,e,t){let r=!1;const i=BT(n,e),s=BT(n,t);if(i===wi.INTERSECTING||s===wi.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],c=n[3],h=e[0],f=e[1],m=t[0],y=t[1],x=(y-f)/(m-h);let v,E;s&wi.ABOVE&&!(i&wi.ABOVE)&&(v=m-(y-c)/x,r=v>=a&&v<=l),!r&&s&wi.RIGHT&&!(i&wi.RIGHT)&&(E=y-(m-l)*x,r=E>=o&&E<=c),!r&&s&wi.BELOW&&!(i&wi.BELOW)&&(v=m-(y-o)/x,r=v>=a&&v<=l),!r&&s&wi.LEFT&&!(i&wi.LEFT)&&(E=y-(m-a)*x,r=E>=o&&E<=c)}return r}function aD(n,e){const t=e.getExtent(),r=ll(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=gn(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function oD(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];aD(n,e);const i=gn(r);if(gn(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function lr(n,e,t){return Math.min(Math.max(n,e),t)}function pz(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return zh(n,e,t,r)}function zh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function yz(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let c=r;c<e+1;c++)r==c?n[o][c]=0:n[o][c]+=l*n[r][c]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function G4(n){return n*180/Math.PI}function Kl(n){return n*Math.PI/180}function pu(n,e){const t=n%e;return t*e<0?t+e:t}function sa(n,e,t){return n+t*(e-n)}function c1(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function Sx(n,e){return Math.round(c1(n,e))}function s_(n,e){return Math.floor(c1(n,e))}function au(n,e){return Math.ceil(c1(n,e))}function zT(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function em(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function lD(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function _z(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Tx(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function GA(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function xz(n,e){return n[0]*=e,n[1]*=e,n}function cD(n,e){if(e.canWrapX()){const t=gn(e.getExtent()),r=uD(n,e,t);r&&(n[0]-=r*t)}return n}function uD(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||gn(r),i=Math.floor((n[0]-r[0])/t)),i}function hD(...n){console.warn(...n)}const R0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let dE=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||R0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const u1=6378137,qf=Math.PI*u1,vz=[-qf,-qf,qf,qf],Ez=[-180,-85,180,85],a_=u1*Math.log(Math.tan(Math.PI/2));class yf extends dE{constructor(e){super({code:e,units:"m",extent:vz,global:!0,worldExtent:Ez,getPointResolution:function(t,r){return t/Math.cosh(r[1]/u1)}})}}const B4=[new yf("EPSG:3857"),new yf("EPSG:102100"),new yf("EPSG:102113"),new yf("EPSG:900913"),new yf("http://www.opengis.net/def/crs/EPSG/0/3857"),new yf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function wz(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=qf*n[s]/180;let a=u1*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>a_?a=a_:a<-a_&&(a=-a_),e[s+1]=a}return e}function Sz(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/qf,e[s+1]=360*Math.atan(Math.exp(n[s+1]/u1))/Math.PI-90;return e}const Tz=6378137,U4=[-180,-90,180,90],bz=Math.PI*Tz/180;class gh extends dE{constructor(e,t){super({code:e,units:"degrees",extent:U4,axisOrientation:t,global:!0,metersPerUnit:bz,worldExtent:U4})}}const z4=[new gh("CRS:84"),new gh("EPSG:4326","neu"),new gh("urn:ogc:def:crs:OGC:1.3:CRS84"),new gh("urn:ogc:def:crs:OGC:2:84"),new gh("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new gh("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new gh("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let $T={};function H_(n){return $T[n]||$T[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Az(n,e){$T[n]=e}let o0={};function ed(n,e,t){const r=n.getCode(),i=e.getCode();r in o0||(o0[r]={}),o0[r][i]=t}function K_(n,e){return n in o0&&e in o0[n]?o0[n][e]:null}const bx=.9996,Da=.00669438,fE=Da*Da,gE=fE*Da,Lh=Da/(1-Da),$4=Math.sqrt(1-Da),I0=(1-$4)/(1+$4),dD=I0*I0,BA=dD*I0,UA=BA*I0,fD=UA*I0,gD=1-Da/4-3*fE/64-5*gE/256,Rz=3*Da/8+3*fE/32+45*gE/1024,Iz=15*fE/256+45*gE/1024,Cz=35*gE/3072,Pz=3/2*I0-27/32*BA+269/512*fD,kz=21/16*dD-55/32*UA,Mz=151/96*BA-417/128*fD,Nz=1097/512*UA,Ax=6378137;function Lz(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/bx/(Ax*gD),o=a+Pz*Math.sin(2*a)+kz*Math.sin(4*a)+Mz*Math.sin(6*a)+Nz*Math.sin(8*a),l=Math.sin(o),c=l*l,h=Math.cos(o),f=l/h,m=f*f,y=m*m,x=1-Da*c,v=Math.sqrt(1-Da*c),E=Ax/v,T=(1-Da)/x,b=Lh*h**2,A=b*b,M=r/(E*bx),D=M*M,U=D*M,P=U*M,R=P*M,k=R*M,N=o-f/T*(D/2-P/24*(5+3*m+10*b-4*A-9*Lh))+k/720*(61+90*m+298*b+45*y-252*Lh-3*A);let O=(M-U/6*(1+2*m+b)+R/120*(5-2*b+28*m-3*A+8*Lh+24*y))/h;return O=zT(O+Kl(mD(t.number)),-Math.PI,Math.PI),[G4(O),G4(N)]}const W4=-80,H4=84,Oz=-180,Dz=180;function Fz(n,e,t){n=zT(n,Oz,Dz),e<W4?e=W4:e>H4&&(e=H4);const r=Kl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,c=Kl(n),h=mD(t.number),f=Kl(h),m=Ax/Math.sqrt(1-Da*i**2),y=Lh*s**2,x=s*zT(c-f,-Math.PI,Math.PI),v=x*x,E=v*x,T=E*x,b=T*x,A=b*x,M=Ax*(gD*r-Rz*Math.sin(2*r)+Iz*Math.sin(4*r)-Cz*Math.sin(6*r)),D=bx*m*(x+E/6*(1-o+y)+b/120*(5-18*o+l+72*y-58*Lh))+5e5;let U=bx*(M+m*a*(v/2+T/24*(5-o+9*y+4*y**2)+A/720*(61-58*o+l+600*y-330*Lh)));return t.north||(U+=1e7),[D,U]}function mD(n){return(n-1)*6-180+3}const jz=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function pD(n){let e=0;for(const i of jz){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function K4(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],c=t[o+1],h=n(l,c,e);r[o]=h[0],r[o+1]=h[1]}return r}}function Vz(n){return pD(n)?new dE({code:n,units:"m"}):null}function Gz(n){const e=pD(n.getCode());return e?{forward:K4(Fz,e),inverse:K4(Lz,e)}:null}const Bz=63710088e-1;function X4(n,e,t){t=t||Bz;const r=Kl(n[1]),i=Kl(e[1]),s=(i-r)/2,a=Kl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const Uz=[Gz],zz=[Vz];let WT=!0;function yD(n){WT=!1}function zA(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Rx(n){Az(n.getCode(),n),ed(n,n,zA)}function $z(n){n.forEach(Rx)}function tr(n){if(typeof n!="string")return n;const e=H_(n);if(e)return e;for(const t of zz){const r=t(n);if(r)return r}return null}function Ix(n,e,t,r){n=tr(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/R0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=WA(n,tr("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=o(c,c,2);const h=X4(c.slice(0,2),c.slice(2,4)),f=X4(c.slice(4,6),c.slice(6,8));i=(h+f)/2}const l=r?R0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function HT(n){$z(n),n.forEach(function(e){n.forEach(function(t){e!==t&&ed(e,t,zA)})})}function Wz(n,e,t,r){n.forEach(function(i){e.forEach(function(s){ed(i,s,t),ed(s,i,r)})})}function $A(n,e){return n?typeof n=="string"?tr(n):n:tr(e)}function KT(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let c=0,h=i;c<h;++c)t[a+c]=c>=l?e[a+c]:o[c]}return t})}function Hz(n,e,t,r){const i=tr(n),s=tr(e);ed(i,s,KT(t)),ed(s,i,KT(r))}function Ir(n,e){return yD(),h1(n,"EPSG:4326","EPSG:3857")}function Tn(n,e){const t=h1(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=pu(r+180,360)-180),t}function $h(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||WA(n,e)===zA)&&t}function WA(n,e){const t=n.getCode(),r=e.getCode();let i=K_(t,r);if(i)return i;let s=null,a=null;for(const l of Uz)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=iS(s.inverse,a.forward);else{const l=K_(t,o);l&&(i=iS(l,a.forward))}else{const l=K_(o,r);l&&(i=iS(s.inverse,l))}return i&&(Rx(n),Rx(e),ed(n,e,i)),i}function iS(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function hp(n,e){const t=tr(n),r=tr(e);return WA(t,r)}function h1(n,e,t){const r=hp(e,t);if(!r){const i=tr(e).getCode(),s=tr(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function XT(n,e){return n}function Ol(n,e){return WT&&!Tx(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(WT=!1,hD("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function _D(n,e){return n}function qo(n,e){return n}function q4(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=gn(a);r=r.slice(0),s=uD(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=lr(r[0],a[0],a[2]),r[1]=lr(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*gn(e.getExtent())),i}}function Kz(){HT(B4),HT(z4),Wz(z4,B4,wz,Sz)}Kz();const Xz=new Array(6);function fi(){return[1,0,0,1,0,0]}function xD(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=n[4],o=n[5],l=e[0],c=e[1],h=e[2],f=e[3],m=e[4],y=e[5];return n[0]=t*l+i*c,n[1]=r*l+s*c,n[2]=t*h+i*f,n[3]=r*h+s*f,n[4]=t*m+i*y+a,n[5]=r*m+s*y+o,n}function qz(n,e,t,r,i,s,a){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=a,n}function vD(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Dr(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function Yz(n,e,t){return xD(n,qz(Xz,1,0,0,1,e,t))}function Va(n,e,t,r,i,s,a,o){const l=Math.sin(s),c=Math.cos(s);return n[0]=r*c,n[1]=i*l,n[2]=-r*l,n[3]=i*c,n[4]=a*r*c-o*r*l+e,n[5]=a*i*l+o*i*c+t,n}function dp(n,e){const t=Zz(e);wn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function Zz(n){return n[0]*n[3]-n[1]*n[2]}const Qz=[1e5,1e5,1e5,1e5,2,2];function Jz(n){return"matrix("+n.join(", ")+")"}function qT(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function e$(n,e){const t=qT(n),r=qT(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*Qz[i])!==0)return!1;return!0}function Jo(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const c=n[l],h=n[l+1];s[o++]=i[0]*c+i[2]*h+i[4],s[o++]=i[1]*c+i[3]*h+i[5];for(let f=2;f<a;f++)s[o++]=n[l+f]}return s&&s.length!=o&&(s.length=o),s}function ED(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),c=s[0],h=s[1];let f=0;for(let m=e;m<t;m+=r){const y=n[m]-c,x=n[m+1]-h;a[f++]=c+y*o-x*l,a[f++]=h+y*l+x*o;for(let v=m+2;v<m+r;++v)a[f++]=n[v]}return a&&a.length!=f&&(a.length=f),a}function t$(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],c=a[1];let h=0;for(let f=e;f<t;f+=r){const m=n[f]-l,y=n[f+1]-c;o[h++]=l+i*m,o[h++]=c+s*y;for(let x=f+2;x<f+r;++x)o[h++]=n[x]}return o&&o.length!=h&&(o.length=h),o}function n$(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let c=l+2;c<l+r;++c)a[o++]=n[c]}return a&&a.length!=o&&(a.length=o),a}const Y4=fi(),r$=[NaN,NaN];class wD extends ml{constructor(){super(),this.extent_=Bs(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Z5((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return $t()}closestPointXY(e,t,r,i){return $t()}containsXY(e,t){return this.closestPointXY(e,t,r$,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return $t()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&l1(t),this.extentRevision_=this.getRevision()}return gz(this.extent_,e)}rotate(e,t){$t()}scale(e,t,r){$t()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return $t()}getType(){return $t()}applyTransform(e){$t()}intersectsExtent(e){return $t()}translate(e,t){$t()}transform(e,t){const r=tr(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),c=r.getWorldExtent(),h=ei(c)/ei(l);Va(Y4,c[0],c[3],h,-h,0,0,0);const f=Jo(s,0,s.length,o,Y4,a),m=hp(r,t);return m?m(f,f,o):f}:hp(r,t);return this.applyTransform(i),this}}class Sd extends wD{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return VA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return $t()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=Z4(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){$t()}setLayout(e,t,r){let i;if(e)i=Z4(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=Td(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();ED(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=ll(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();t$(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();n$(r,0,r.length,i,e,t,r),this.changed()}}}function Td(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function Z4(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function i$(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return Jo(r,0,r.length,i,e,t)}function Q4(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],c=n[t]-o,h=n[t+1]-l;let f;if(c===0&&h===0)f=e;else{const m=((i-o)*c+(s-l)*h)/(c*c+h*h);if(m>1)f=t;else if(m>0){for(let y=0;y<r;++y)a[y]=sa(n[e+y],n[t+y],m);a.length=r;return}else f=e}for(let m=0;m<r;++m)a[m]=n[f+m];a.length=r}function HA(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],c=zh(s,a,o,l);c>i&&(i=c),s=o,a=l}return i}function KA(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=HA(n,e,o,r,i),e=o}return i}function s$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=KA(n,e,o,r,i),e=o[o.length-1]}return i}function XA(n,e,t,r,i,s,a,o,l,c,h){if(e==t)return c;let f,m;if(i===0){if(m=zh(a,o,n[e],n[e+1]),m<c){for(f=0;f<r;++f)l[f]=n[e+f];return l.length=r,m}return c}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(Q4(n,y-r,y,r,a,o,h),m=zh(a,o,h[0],h[1]),m<c){for(c=m,f=0;f<r;++f)l[f]=h[f];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(m)-Math.sqrt(c))/i|0,1);if(s&&(Q4(n,t-r,e,r,a,o,h),m=zh(a,o,h[0],h[1]),m<c)){for(c=m,f=0;f<r;++f)l[f]=h[f];l.length=r}return c}function qA(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let f=0,m=t.length;f<m;++f){const y=t[f];c=XA(n,e,y,r,i,s,a,o,l,c,h),e=y}return c}function a$(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let f=0,m=t.length;f<m;++f){const y=t[f];c=qA(n,e,y,r,i,s,a,o,l,c,h),e=y[y.length-1]}return c}function o$(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function mE(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function d1(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=mE(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function SD(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=d1(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function ou(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function fp(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=ou(n,e,l,r,i[s]),e=l}return i.length=s,i}function YT(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:fp(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function Cx(n,e,t,r,i,s,a){let o,l;const c=(t-e)/r;if(c===1)o=e;else if(c===2)o=e,l=i;else if(c!==0){let h=n[e],f=n[e+1],m=0;const y=[0];for(let E=e+r;E<t;E+=r){const T=n[E],b=n[E+1];m+=Math.sqrt((T-h)*(T-h)+(b-f)*(b-f)),y.push(m),h=T,f=b}const x=i*m,v=sz(y,x);v<0?(l=(x-y[-v-2])/(y[-v-1]-y[-v-2]),o=e+(-v-2)*r):o=e+v*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:sa(n[o+h],n[o+r+h],l);return s}function ZT(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const m=o+l>>1;i<n[(m+1)*r-1]?l=m:o=m+1}const c=n[o*r-1];if(i==c)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],f=(i-c)/(h-c);a=[];for(let m=0;m<r-1;++m)a.push(sa(n[(o-1)*r+m],n[o*r+m],f));return a.push(i),a}function l$(n,e,t,r,i,s,a){if(a)return ZT(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,c=t.length;l<c;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return ZT(n,e,h,r,i,!1);e=h}}return null}function c$(n,e,t,r,i){return!iD(i,function(a){return!Oh(n,e,t,r,a[0],a[1])})}function Oh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const c=n[e],h=n[e+1];l<=s?h>s&&(c-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(c-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=c,l=h}return a!==0}function YA(n,e,t,r,i,s){if(t.length===0||!Oh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(Oh(n,t[a-1],t[a],r,i,s))return!1;return!0}function u$(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(YA(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function TD(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function pE(n,e,t,r,i,s){return s=s??rD(Bs(),n,e,t,r),xs(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:TD(n,e,t,r,function(a,o){return mz(i,a,o)}):!1}function h$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(pE(n,e,t[s],r,i))return!0;e=t[s]}return!1}function bD(n,e,t,r,i){return!!(pE(n,e,t,r,i)||Oh(n,e,t,r,i[0],i[1])||Oh(n,e,t,r,i[0],i[3])||Oh(n,e,t,r,i[2],i[1])||Oh(n,e,t,r,i[2],i[3]))}function AD(n,e,t,r,i){if(!bD(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(c$(n,t[s-1],t[s],r,i)&&!pE(n,t[s-1],t[s],r,i))return!1;return!0}function d$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(AD(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function ZA(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],c=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return a}function yE(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const c=[e,t-r];let h=0;for(;c.length>0;){const f=c.pop(),m=c.pop();let y=0;const x=n[m],v=n[m+1],E=n[f],T=n[f+1];for(let b=m+r;b<f;b+=r){const A=n[b],M=n[b+1],D=pz(A,M,x,v,E,T);D>y&&(h=b,y=D)}y>i&&(l[(h-e)/r]=1,m+r<h&&c.push(m,h),h+r<f&&c.push(h,f))}for(let f=0;f<o;++f)l[f]&&(s[a++]=n[e+f*r],s[a++]=n[e+f*r+1]);return a}function RD(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=yE(n,e,h,r,i,s,a),o.push(a),e=h}return a}function xh(n,e){return e*Math.round(n/e)}function f$(n,e,t,r,i,s,a){if(e==t)return a;let o=xh(n[e],i),l=xh(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let c,h;do if(c=xh(n[e],i),h=xh(n[e+1],i),e+=r,e==t)return s[a++]=c,s[a++]=h,a;while(c==o&&h==l);for(;e<t;){const f=xh(n[e],i),m=xh(n[e+1],i);if(e+=r,f==c&&m==h)continue;const y=c-o,x=h-l,v=f-o,E=m-l;if(y*E==x*v&&(y<0&&v<y||y==v||y>0&&v>y)&&(x<0&&E<x||x==E||x>0&&E>x)){c=f,h=m;continue}s[a++]=c,s[a++]=h,o=c,l=h,c=f,h=m}return s[a++]=c,s[a++]=h,a}function QA(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=f$(n,e,h,r,i,s,a),o.push(a),e=h}return a}function g$(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l],f=[];a=QA(n,e,h,r,i,s,a,f),o.push(f),e=h[h.length-1]}return a}class bi extends Sd{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Vn(this.flatCoordinates,e),this.changed()}clone(){const e=new bi(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<Ed(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(HA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),XA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return TD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,ZT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return ou(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return Cx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return ZA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=yE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new bi(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return pE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mE(this.flatCoordinates,0,e,this.stride),this.changed()}}let gi=class ID extends Sd{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new ID(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=zh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return tD(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return jA(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=o$(this.flatCoordinates,0,e,this.stride),this.changed()}};const Ti={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},td=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",m$=td.includes("safari")&&!td.includes("chrom"),p$=m$&&(td.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(td)),y$=td.includes("webkit")&&!td.includes("edge"),CD=td.includes("macintosh"),_$=typeof devicePixelRatio<"u"?devicePixelRatio:1,ca=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,JA=typeof Image<"u"&&Image.prototype.decode,PD=typeof createImageBitmap=="function",kD=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Et={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ni(n,e,t,r){let i;return t&&t.length?i=t.shift():ca?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let sS;function Px(){return sS||(sS=ni(1,1)),sS}function _E(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function J4(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function x$(n){for(;n.lastChild;)n.lastChild.remove()}function v$(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function MD(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function lu(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const eR=[NaN,NaN,NaN,0];let aS;function E$(){return aS||(aS=ni(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),aS}const w$=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,S$=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,T$=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,b$=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function o_(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Mm(n){throw new Error('failed to parse "'+n+'" as color')}function ND(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(S$)||n.match(w$)||n.match(T$);if(s){const a=s[4],o=100/255;return[lr(o_(s[1],o)+.5|0,0,255),lr(o_(s[2],o)+.5|0,0,255),lr(o_(s[3],o)+.5|0,0,255),a!==void 0?lr(o_(a,100),0,1):1]}Mm(n)}if(n.startsWith("#")){if(b$.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}Mm(n)}const e=E$();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Mm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return ND(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=c1(i[3]/255,3),i}function A$(n){return typeof n=="string"?n:nR(n)}const R$=1024,tm={};let oS=0;function I$(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function lS(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function cS(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function uS(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function hS(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function eM(n){const e=uS(n[0]),t=uS(n[1]),r=uS(n[2]),i=hS(e*.222488403+t*.716873169+r*.06060791),s=500*(hS(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-hS(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function C$(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=cS(e),s=cS(e+t/500*Math.cos(r)),a=cS(e-t/200*Math.sin(r)),o=lS(s*3.021973625-i*1.617392459-a*.404875592),l=lS(s*-.943766287+i*1.916279586+a*.027607165),c=lS(s*.069407491-i*.22898585+a*1.159737864);return[lr(o+.5|0,0,255),lr(l+.5|0,0,255),lr(c+.5|0,0,255),n[3]]}function tR(n){if(n==="none")return eR;if(tm.hasOwnProperty(n))return tm[n];if(oS>=R$){let t=0;for(const r in tm)(t++&3)===0&&(delete tm[r],--oS)}const e=ND(n);e.length!==4&&Mm(n);for(const t of e)isNaN(t)&&Mm(n);return tm[n]=e,++oS,e}function Ga(n){return Array.isArray(n)?n:tR(n)}function nR(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class LD extends a1{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?Et.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Zt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Et.IDLE&&this.loader){this.state=Et.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;Q5(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||PD&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=Et.LOADED}).catch(r=>{this.state=Et.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function P$(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[Ex(r,Zt.LOAD,function(){a=!0,s||e()})];return r.src&&JA?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(Ex(r,Zt.ERROR,t)),function(){i=!1,o.forEach(sr)}}function k$(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function OD(n,e){return e&&(n.src=e),n.src&&JA?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):k$(n)}function DD(n,e){return e&&(n.src=e),n.src&&JA&&PD?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):OD(n)}class M${constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=dS(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=dS(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=dS(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===Et.IDLE&&i.load(),i.getImageState()===Et.LOADING?i.ready().then(()=>{this.patternCache_[a]=Px().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=Px().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function dS(n,e,t){const r=t?Ga(t):"null";return e+":"+n+":"+r}const Na=new M$;let nm=null;class FD extends a1{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?Et.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Et.LOADED){nm||(nm=ni(1,1,void 0,{willReadFrequently:!0})),nm.drawImage(this.image_,0,0);try{nm.getImageData(0,0,1,1),this.tainted_=!1}catch{nm=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Zt.CHANGE)}handleImageError_(){this.imageState_=Et.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Et.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=ni(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Et.IDLE){this.image_||this.initializeImage_(),this.imageState_=Et.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&OD(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Et.LOADED)return;const t=this.image_,r=ni(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=A$(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Et.LOADED||this.imageState_===Et.ERROR)e();else{const t=()=>{(this.imageState_===Et.LOADED||this.imageState_===Et.ERROR)&&(this.removeEventListener(Zt.CHANGE,t),e())};this.addEventListener(Zt.CHANGE,t)}})),this.ready_}}function kx(n,e,t,r,i,s){let a=e===void 0?void 0:Na.get(e,t,i);return a||(a=new FD(n,n&&"src"in n?n.src||void 0:e,t,r,i),Na.set(e,t,i,a,s)),s&&a&&!Na.getPattern(e,t,i)&&Na.set(e,t,i,a,s),a}function Yo(n){return n?Array.isArray(n)?nR(n):typeof n=="object"&&"src"in n?N$(n):n:null}function N$(n){if(!n.offset||!n.size)return Na.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Na.getPattern(e,void 0,n.color);if(t)return t;const r=Na.get(n.src,"anonymous",null);if(r.getImageState()!==Et.LOADED)return null;const i=ni(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),kx(i.canvas,e,void 0,Et.LOADED,n.color,!0),Na.getPattern(e,void 0,n.color)}class jD{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const l_="ol-hidden",f1="ol-unselectable",rR="ol-control",tM="ol-collapsed",L$=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),nM=["style","variant","weight","size","lineHeight","family"],QT={normal:400,bold:700},JT=function(n){const e=n.match(L$);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=nM.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[nM[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in QT&&(t.weight=QT[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},VD="10px sans-serif",Ls="#000",C0="round",Xl=[],ql=0,P0="round",gp=10,mp="#000",pp="center",Mx="middle",Dh=[0,0,0,0],yp=1,Df=new ml;let rm=null,rM;const eb={},O$=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function D$(n,e,t){return`${n} ${e} 16px "${t}"`}const F$=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=JT(s),l=o.families[0].toLowerCase(),c=o.weight;return a.some(h=>{const f=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=QT[h.weight]||h.weight;return f===l&&h.style===o.style&&m==c})}async function i(){await t.ready;let s=!0;const a=Df.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const c=o[l];let h=a[c];h<100&&(await r(c)?(eg(eb),Df.set(c,100)):(h+=10,Df.set(c,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=ca?self.fonts:document.fonts);const a=JT(s);if(!a)return;const o=a.families;let l=!1;for(const c of o){if(O$.has(c))continue;const h=D$(a.style,a.weight,c);Df.get(h)===void 0&&(Df.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),j$=(function(){let n;return function(e){let t=eb[e];if(t==null){if(ca){const r=JT(e),i=GD(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);eb[e]=t}return t}})();function GD(n,e){return rm||(rm=ni(1,1)),n!=rM&&(rm.font=n,rM=rm.font),rm.measureText(e)}function BD(n,e){return GD(n,e).width}function iM(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,BD(n,s)),0);return t[e]=r,r}function V$(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const f=e[c];if(f===`
`||c===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const m=e[c+1]||n.font,y=BD(m,f);t.push(y),a+=y;const x=j$(m);r.push(x),l=Math.max(l,x)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function G$(n,e,t,r,i,s,a,o,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=f=>f.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),B$(r,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,c,a*h[0],o*h[1]),n.restore()}function B$(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class U$ extends jD{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?c1(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=fi()}drawImages_(e,t,r,i){if(!this.image_)return;const s=Jo(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,f=s.length;h<f;h+=2){const m=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const x=m+this.imageAnchorX_,v=y+this.imageAnchorY_;Va(o,x,v,1,1,c,-x,-v),a.save(),a.transform.apply(a,o),a.translate(x,v),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Jo(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,c-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,c),this.textFillState_&&a.fillText(this.text_,l,c))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=Jo(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let c=2;c<l;c+=2)a.lineTo(o[c],o[c+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!xs(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=i$(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!xs(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(xs(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,c=a.length;l<c;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!xs(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!xs(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const c=s[o];i=this.drawRings_(r,i,c,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),uc(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:pp;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Yo(r||Ls)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||Xl;this.strokeState_={lineCap:i!==void 0?i:C0,lineDash:this.pixelRatio_===1?h:h.map(f=>f*this.pixelRatio_),lineDashOffset:(a||ql)*this.pixelRatio_,lineJoin:o!==void 0?o:P0,lineWidth:(l!==void 0?l:yp)*this.pixelRatio_,miterLimit:c!==void 0?c:gp,strokeStyle:Yo(r||mp)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Yo(y||Ls)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),x=r.getLineCap(),v=r.getLineDash(),E=r.getLineDashOffset(),T=r.getLineJoin(),b=r.getWidth(),A=r.getMiterLimit();this.textStrokeState_={lineCap:x!==void 0?x:C0,lineDash:v||Xl,lineDashOffset:E||ql,lineJoin:T!==void 0?T:P0,lineWidth:b!==void 0?b:yp,miterLimit:A!==void 0?A:gp,strokeStyle:Yo(y||mp)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),f=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:i!==void 0?i:VD,textAlign:f!==void 0?f:pp,textBaseline:m!==void 0?m:Mx},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,x,v)=>y+=v%2?" ":x,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const z$=.5,UD={Point:Z$,LineString:X$,Polygon:J$,MultiPoint:Q$,MultiLineString:q$,MultiPolygon:Y$,GeometryCollection:K$,Circle:W$};function $$(n,e){return parseInt(zt(n),10)-parseInt(zt(e),10)}function sM(n,e){const t=zD(n,e);return t*t}function zD(n,e){return z$*n/e}function W$(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function aM(n,e,t,r,i,s,a,o){const l=[],c=t.getImage();if(c){let m=!0;const y=c.getImageState();y==Et.LOADED||y==Et.ERROR?m=!1:y==Et.IDLE&&c.load(),m&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const f=l.length>0;return f&&Promise.all(l).then(()=>i(null)),H$(n,e,t,r,s,a,o),f}function H$(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())$D(n,l,t,e,a);else{const h=UD[l.getType()];h(n,l,t,e,a,s)}}function $D(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)$D(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function K$(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const c=UD[a[o].getType()];c(n,a[o],t,r,i,s)}}function X$(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function q$(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function Y$(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function Z$(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),c=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=Et.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,c),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,c),h.drawText(e,r,i)}}function Q$(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(a.getImageState()!=Et.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(a,h),f.drawMultiPoint(e,r,i)}if(c){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,r,i)}}function J$(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let eW=!1;function tW(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=eW,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=o.responseText:c=="xml"?h=o.responseXML||o.responseText:c=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function oM(n,e){return function(t,r,i,s,a){tW(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function nW(n,e){return[[-1/0,-1/0,1/0,1/0]]}function WD(n,e,t,r){const i=[];let s=Bs();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=VA(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function iR(n,e,t,r,i,s,a){let o,l,c,h,f,m,y;const x=i[s+1],v=[];for(let b=0,A=t.length;b<A;++b){const M=t[b];for(h=n[M-r],m=n[M-r+1],o=e;o<M;o+=r)f=n[o],y=n[o+1],(x<=m&&y<=x||m<=x&&x<=y)&&(c=(x-m)/(y-m)*(f-h)+h,v.push(c)),h=f,m=y}let E=NaN,T=-1/0;for(v.sort(Wl),h=v[0],o=1,l=v.length;o<l;++o){f=v[o];const b=Math.abs(f-h);b>T&&(c=(h+f)/2,YA(n,e,t,r,c,x)&&(E=c,T=b)),h=f}return isNaN(E)&&(E=i[s]),a?(a.push(E,x,T),a):[E,x,T]}function HD(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=iR(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function rW(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function sR(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function aR(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=sR(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function KD(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!aR(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function Nx(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=sR(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&rW(n,e,o,r),e=o}return e}function tb(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=Nx(n,e,t[s],r,i);return e}function XD(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],c=sR(n,r,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class go extends wD{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(sr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(fn(e[t],Zt.CHANGE,this.changed,this))}clone(){const e=new go(fS(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<Ed(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){l1(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)nD(e,t[r].getExtent());return e}getGeometries(){return fS(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new go(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=ll(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(fS(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function fS(n){return n.map(e=>e.clone())}function qD(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const c=n[e]-s,h=n[e+1]-a;i+=l*c-o*h,o=c,l=h}return i/2}function YD(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=qD(n,e,o,r),e=o}return i}function iW(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=YD(n,e,o,r),e=o[o.length-1]}return i}class _p extends Sd{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new _p(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<Ed(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(HA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),XA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return qD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return ou(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=yE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new _p(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mE(this.flatCoordinates,0,e,this.stride),this.changed()}}class tc extends Sd{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,c=i.length;l<c;++l){const h=i[l];Vn(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Vn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new tc(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<Ed(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(KA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,l$(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return fp(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new bi(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],c=new bi(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=ZA(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],c=Cx(t,r,l,s,.5);Vn(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=RD(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new tc(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return h$(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=d1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class bd extends Sd{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Vn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new bd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<Ed(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const c=zh(e,t,s[o],s[o+1]);if(c<i){i=c;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return ou(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new gi(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new gi(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(jA(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mE(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ba extends Sd{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Vn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ba(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<Ed(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(KA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return YA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return YD(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Nx(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,fp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=ll(this.getExtent());this.flatInteriorPoint_=iR(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new gi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new _p(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],c=new _p(t.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;aR(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Nx(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=QA(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ba(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return AD(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=d1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function lM(n){if(tg(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ba(s,"XY",[s.length])}class nd extends Sd{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const c=i[o],h=s.length,f=c.getEnds();for(let m=0,y=f.length;m<y;++m)f[m]+=h;Vn(s,c.getFlatCoordinates()),a.push(f)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Vn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new nd(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<Ed(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(s$(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),a$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return u$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return iW(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),tb(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,YT(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=WD(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=HD(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new bd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;KD(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=tb(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=g$(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new nd(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ba(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),c=l[l.length-1];if(s!==0)for(let f=0,m=l.length;f<m;++f)l[f]-=s;const h=new Ba(t.slice(s,c),e,l);i.push(h),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return d$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=SD(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const cM=fi();class Os{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?tD(this.flatCoordinates_):VA(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=ll(this.getExtent());this.flatInteriorPoints_=iR(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=XD(this.flatCoordinates_,this.ends_),t=WD(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=HD(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Cx(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=Cx(e,t,a,2,.5);Vn(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=tr(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=ei(r)/ei(t);Va(cM,r[0],r[3],i,-i,0,0,0),Jo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,cM,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Os(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Z5((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=yE(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=RD(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=QA(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Os(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Os.prototype.getFlatCoordinates=Os.prototype.getOrientedFlatCoordinates;function ZD(n,e,t=0,r=n.length-1,i=sW){for(;r>t;){if(r-t>600){const l=r-t+1,c=e-t+1,h=Math.log(l),f=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*f*(l-f)/l)*(c-l/2<0?-1:1),y=Math.max(t,Math.floor(e-c*f/l+m)),x=Math.min(r,Math.floor(e+(l-c)*f/l+m));ZD(n,e,y,x,i)}const s=n[e];let a=t,o=r;for(im(n,t,e),i(n[r],s)>0&&im(n,t,r);a<o;){for(im(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?im(n,t,o):(o++,im(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function im(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function sW(n,e){return n<e?-1:n>e?1:0}let QD=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!u_(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;u_(e,l)&&(t.leaf?r.push(o):mS(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!u_(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(u_(e,a)){if(t.leaf||mS(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Ff([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),c=!0),r.leaf){const h=aW(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&mS(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=Ff(e.slice(t,r+1)),_f(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=Ff([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));uM(e,t,r,c,this.compareMinX);for(let h=t;h<=r;h+=c){const f=Math.min(h+c-1,r);uM(e,h,f,l,this.compareMinY);for(let m=h;m<=f;m+=l){const y=Math.min(m+l-1,f);o.children.push(this._build(e,m,y,i-1))}}return _f(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=gS(c),f=cW(e,c)-h;f<a?(a=f,s=h<s?h:s,o=c):f===a&&h<s&&(s=h,o=c)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),pm(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=Ff(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,_f(r,this.toBBox),_f(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=Ff([e,t]),this.data.height=e.height+1,this.data.leaf=!1,_f(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=mm(e,0,o,this.toBBox),c=mm(e,o,r,this.toBBox),h=uW(l,c),f=gS(l)+gS(c);h<s?(s=h,i=o,a=f<a?f:a):h===s&&f<a&&(a=f,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:oW,s=e.leaf?this.compareMinY:lW,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=mm(e,0,t,s),o=mm(e,r-t,r,s);let l=c_(a)+c_(o);for(let c=t;c<r-t;c++){const h=e.children[c];pm(a,e.leaf?s(h):h),l+=c_(a)}for(let c=r-t-1;c>=t;c--){const h=e.children[c];pm(o,e.leaf?s(h):h),l+=c_(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)pm(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():_f(e[t],this.toBBox)}};function aW(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function _f(n,e){mm(n,0,n.children.length,e,n)}function mm(n,e,t,r,i){i||(i=Ff(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];pm(i,n.leaf?r(a):a)}return i}function pm(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function oW(n,e){return n.minX-e.minX}function lW(n,e){return n.minY-e.minY}function gS(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function c_(n){return n.maxX-n.minX+(n.maxY-n.minY)}function cW(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function uW(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function mS(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function u_(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Ff(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function uM(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;ZD(n,a,e,t,i),s.push(e,a,a,t)}}class hM{constructor(e){this.rbush_=new QD(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[zt(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[zt(o)]=l}this.rbush_.load(r)}remove(e){const t=zt(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[zt(t)],i=[r.minX,r.minY,r.maxX,r.maxY];Jh(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return Zh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return bu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class oR extends ml{constructor(e){super(),this.projection=tr(e.projection),this.attributions_=dM(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=dM(e),this.changed()}setState(e){this.state_=e,this.changed()}}function dM(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const ts={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Gc extends gl{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class hc extends oR{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=up,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(wn(this.format_,"`format` must be set when `url` is set"),this.loader_=oM(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:nW;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new hM:null,this.loadedExtentsRtree_=new hM,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new Ma(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=zt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Gc(ts.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Os||(this.featureChangeKeys_[e]=[fn(t,Zt.CHANGE,this.handleFeatureChange_,this),fn(t,b0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Os){const s=this.idIndex_[i];s instanceof Os?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(wn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=zt(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=zt(o);this.setupChangeEvents_(l,o);const c=o.getGeometry();if(c){const h=c.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(ts.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new Gc(ts.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ts.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(ts.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Ns.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(Ns.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(sr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Gc(ts.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Os||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Os||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Zh(this.nullGeometryFeatures_)||Vn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=oD(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||cp,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),f=o;if(o=h instanceof Os?0:h.closestPointXY(r,i,a,o),o<f){s=c;const m=Math.sqrt(o);l[0]=r-m,l[1]=i-m,l[2]=r+m,l[3]=i+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=zt(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new Gc(ts.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:zt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Zh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return su(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Gc(ts.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Gc(ts.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Gc(ts.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(Jh(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=zt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(sr),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(ts.REMOVEFEATURE)&&this.dispatchEvent(new Gc(ts.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){wn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(oM(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class er{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new er({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=kx(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Et.IDLE&&t.load(),t.getImageState()===Et.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?zt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Ga(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Xn{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Xn({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function fM(n){return n[0]>0&&n[1]>0}function hW(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Es(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class xE{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Es(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new xE({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return $t()}getImage(e){return $t()}getHitDetectionImage(){return $t()}getPixelRatio(e){return 1}getImageState(){return $t()}getImageSize(){return $t()}getOrigin(){return $t()}getSize(){return $t()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Es(e)}listenImageChange(e){$t()}load(){$t()}unlistenImageChange(e){$t()}ready(){return Promise.resolve()}}class vE extends xE{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Et.LOADING:Et.LOADED,this.imageState_===Et.LOADING&&this.ready().then(()=>this.imageState_=Et.LOADED),this.render()}clone(){const e=this.getScale(),t=new vE({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=Na.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=ni(a,a);this.draw_(s,o,e),i=o.canvas,Na.set(r,null,null,new FD(i,void 0,null,Et.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const U=i;i=s,s=U}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),c=Math.sqrt(s*s-l*l),h=i-c,f=Math.sqrt(l*l+h*h),m=f/l;if(e==="miter"&&m<=r)return m*t;const y=t/2/m,x=t/2*(h/f),E=Math.sqrt((i+y)*(i+y)+x*x)-i;if(this.radius2_===void 0||e==="bevel")return E*2;const T=i*Math.sin(o),b=Math.sqrt(i*i-T*T),A=s-b,D=Math.sqrt(T*T+A*A)/T;if(D<=r){const U=D*t/2-s-i;return 2*Math.max(E,U)}return E*2}createRenderOptions(){let e=C0,t=P0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Yo(this.stroke_.getColor()??mp),o=this.stroke_.getWidth()??yp,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??P0,e=this.stroke_.getLineCap()??C0,r=this.stroke_.getMiterLimit()??gp);const l=this.calculateLineJoinSize_(t,o,r),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=Ls),t.fillStyle=Yo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Ga(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=ni(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,c=o%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Ls,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Us extends vE{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Us({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class mn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=gM,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new mn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=gM,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function dW(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(wn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let pS=null;function JD(n,e){if(!pS){const t=new er({color:"rgba(255,255,255,0.4)"}),r=new Xn({color:"#3399CC",width:1.25});pS=[new mn({image:new Us({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return pS}function gM(n){return n.getGeometry()}const fW="#333";class mo{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Es(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new er({color:fW}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new mo({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof er?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Es(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Qr={ANIMATING:0,INTERACTING:1},Ft={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},h_=[Ft.FILL],cu=[Ft.STROKE],Fh=[Ft.BEGIN_PATH],mM=[Ft.CLOSE_PATH];class g1 extends jD{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],Qh(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const c=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],f=e[t+1];const m=this.tmpCoordinate_;let y=!0,x,v,E;for(x=t+i;x<r;x+=i)m[0]=e[x],m[1]=e[x+1],E=BT(c,m),E!==v?(y&&(o[l++]=h,o[l++]=f,y=!1),o[l++]=m[0],o[l++]=m[1]):E===wi.INTERSECTING?(o[l++]=m[0],o[l++]=m[1],y=!1):y=!0,h=m[0],f=m[1],v=E;return(s&&y||x===t+i)&&(o[l++]=h,o[l++]=f),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],c=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let c,h,f,m,y;switch(a){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),m=[];const x=e.getEndss();y=0;for(let v=0,E=x.length;v<E;++v){const T=[];y=this.drawCustomCoordinates_(c,y,x[v],o,T),m.push(T)}this.instructions.push([Ft.CUSTOM,l,m,e,r,YT,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,m,e,i||r,YT,s]);break;case"Polygon":case"MultiLineString":f=[],c=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(c,0,e.getEnds(),o,f),this.instructions.push([Ft.CUSTOM,l,f,e,r,fp,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,f,e,i||r,fp,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,o,!1,!1),this.instructions.push([Ft.CUSTOM,l,h,e,r,ou,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,h,e,i||r,ou,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,o),h>l&&(this.instructions.push([Ft.CUSTOM,l,h,e,r,ou,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,h,e,i||r,ou,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Ft.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Ft.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ft.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Ft.END_GEOMETRY?a=t:s==Ft.BEGIN_GEOMETRY&&(i[2]=t,oz(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Yo(r||Ls)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Yo(r||mp);const i=e.getLineCap();t.lineCap=i!==void 0?i:C0;const s=e.getLineDash();t.lineDash=s?s.slice():Xl;const a=e.getLineDashOffset();t.lineDashOffset=a||ql;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:P0;const l=e.getWidth();t.lineWidth=l!==void 0?l:yp;const c=e.getMiterLimit();t.miterLimit=c!==void 0?c:gp,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Ft.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ft.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!uc(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ft.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=eD(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;A0(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class gW extends g1{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!Qh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Ft.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ft.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||Qh(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ft.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ft.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class mW extends g1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Ft.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xl,ql],Fh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(cu),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xl,ql],Fh);const o=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let f=0,m=o.length;f<m;++f)h=this.drawFlatCoordinates_(l,h,o[f],c);this.hitDetectionInstructions.push(cu),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(cu),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(cu),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Fh)}}class pM extends g1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Fh),this.hitDetectionInstructions.push(Fh);for(let c=0;c<l;++c){const h=r[c],f=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[Ft.MOVE_TO_LINE_TO,f,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(mM),this.hitDetectionInstructions.push(mM)),t=h}return a&&(this.instructions.push(h_),this.hitDetectionInstructions.push(h_)),o&&(this.instructions.push(cu),this.hitDetectionInstructions.push(cu)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_FILL_STYLE,Ls]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xl,ql]);const o=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Ft.CIRCLE,c];this.instructions.push(Fh,h),this.hitDetectionInstructions.push(Fh,h),i.fillStyle!==void 0&&(this.instructions.push(h_),this.hitDetectionInstructions.push(h_)),i.strokeStyle!==void 0&&(this.instructions.push(cu),this.hitDetectionInstructions.push(cu)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_FILL_STYLE,Ls]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xl,ql]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,o,c),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_FILL_STYLE,Ls]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xl,ql]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let f=0,m=o.length;f<m;++f)h=this.drawFlatCoordinatess_(l,h,o[f],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=xh(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function pW(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[c,h]=l.slice(-2),f=e[a+i],m=e[a+i+1],y=Math.sqrt((f-c)*(f-c)+(m-h)*(m-h));if(o+=y,o>=n){const x=(n-o+y)/y,v=sa(c,f,x),E=sa(h,m,x);l.push(v,E),s.push(l),l=[v,E],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const x=y-o,v=sa(c,f,x/y),E=sa(h,m,x/y);l.push(v,E),s.push(l),l=[v,E],o=0,a+=i}}return o>0&&s.push(l),s}function yW(n,e,t,r,i){let s=t,a=t,o=0,l=0,c=t,h,f,m,y,x,v,E,T,b,A;for(f=t;f<r;f+=i){const M=e[f],D=e[f+1];x!==void 0&&(b=M-x,A=D-v,y=Math.sqrt(b*b+A*A),E!==void 0&&(l+=m,h=Math.acos((E*b+T*A)/(m*y)),h>n&&(l>o&&(o=l,s=c,a=f),l=0,c=f-i)),m=y,E=b,T=A),x=M,v=D}return l+=y,l>o?[c,f]:[s,a]}const Lx={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class _W extends g1{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Ls]={fillStyle:Ls},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const c=e.getType();let h=null,f=e.getStride();if(a.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!xs(this.maxExtent,e.getExtent()))return;let m;if(h=e.getFlatCoordinates(),c=="LineString")m=[h.length];else if(c=="MultiLineString")m=e.getEnds();else if(c=="Polygon")m=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const E=e.getEndss();m=[];for(let T=0,b=E.length;T<b;++T)m.push(E[T][0])}this.beginGeometry(e,t,r);const y=a.repeat,x=y?void 0:a.textAlign;let v=0;for(let E=0,T=m.length;E<T;++E){let b;y?b=pW(y*this.resolution,h,v,m[E],f):b=[h.slice(v,m[E])];for(let A=0,M=b.length;A<M;++A){const D=b[A];let U=0,P=D.length;if(x==null){const k=yW(a.maxAngle,D,0,D.length,2);U=k[0],P=k[1]}for(let k=U;k<P;k+=f)o.push(D[k],D[k+1]);const R=o.length;v=m[E],this.drawChars_(l,R),l=R}}this.endGeometry(t)}else{let m=a.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),f=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||m.push(h[2]/this.resolution),f=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();h=[];for(let D=0,U=M.length;D<U;D+=3)a.overflow||m.push(M[D+2]/this.resolution),h.push(M[D],M[D+1]);if(h.length===0)return;f=2;break}const y=this.appendFlatPointCoordinates(h,f);if(y===l)return;if(m&&(y-l)/2!==h.length/f){let M=l/2;m=m.filter((D,U)=>{const P=o[(M+U)*2]===h[U*f]&&o[(M+U)*2+1]===h[U*f+1];return P||--M,P})}this.saveTextStates_();const x=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,v=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let E=a.padding;if(E!=Dh&&(a.scale[0]<0||a.scale[1]<0)){let M=a.padding[0],D=a.padding[1],U=a.padding[2],P=a.padding[3];a.scale[0]<0&&(D=-D,P=-P),a.scale[1]<0&&(M=-M,U=-U),E=[M,D,U,P]}const T=this.pixelRatio;this.instructions.push([Ft.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==Dh?Dh:E.map(function(M){return M*T}),x,v,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const b=1/T,A=x?x.slice(0):null;A&&(A[1]=Ls),this.hitDetectionInstructions.push([Ft.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,E,A,v,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Ls:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||pp,justify:t.justify,textBaseline:t.textBaseline||Mx,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=Lx[i.textBaseline],h=this.textOffsetY_*l,f=this.text_,m=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Ft.DRAW_CHARS,e,t,c,i.overflow,o,i.maxAngle,l,h,s,m*l,f,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ft.DRAW_CHARS,e,t,c,i.overflow,o&&Ls,i.maxAngle,l,h,s,m*l,f,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Yo(a.getColor()||Ls)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const v=o.getLineDash(),E=o.getLineDashOffset(),T=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||C0,s.lineDash=v?v.slice():Xl,s.lineDashOffset=E===void 0?ql:E,s.lineJoin=o.getLineJoin()||P0,s.lineWidth=T===void 0?yp:T,s.miterLimit=b===void 0?gp:b,s.strokeStyle=Yo(o.getColor()||mp)}r=this.textState_;const l=e.getFont()||VD;F$(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||Mx,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||Dh,r.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),f=e.getOffsetY(),m=e.getRotateWithView(),y=e.getKeepUpright(),x=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=x===void 0?0:x,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:zt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+zt(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const xW={Circle:pM,Default:g1,Image:gW,LineString:mW,Polygon:pM,Text:_W};class vW{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=xW[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function EW(n,e,t,r,i,s,a,o,l,c,h,f,m=!0){let y=n[e],x=n[e+1],v=0,E=0,T=0,b=0;function A(){v=y,E=x,e+=r,y=n[e],x=n[e+1],b+=T,T=Math.sqrt((y-v)*(y-v)+(x-E)*(x-E))}do A();while(e<t-r&&b+T<s);let M=T===0?0:(s-b)/T;const D=sa(v,y,M),U=sa(E,x,M),P=e-r,R=b,k=s+o*l(c,i,h);for(;e<t-r&&b+T<k;)A();M=T===0?0:(k-b)/T;const N=sa(v,y,M),O=sa(E,x,M);let z=!1;if(m)if(f){const Oe=[D,U,N,O];ED(Oe,0,4,2,f,Oe,Oe),z=Oe[0]>Oe[2]}else z=D>N;const j=Math.PI,Re=[],Ne=P+r===e;e=P,T=0,b=R,y=n[e],x=n[e+1];let Ve;if(Ne){A(),Ve=Math.atan2(x-E,y-v),z&&(Ve+=Ve>0?-j:j);const Oe=(N+D)/2,ce=(O+U)/2;return Re[0]=[Oe,ce,(k-s)/2,Ve,i],Re}i=i.replace(/\n/g," ");for(let Oe=0,ce=i.length;Oe<ce;){A();let we=Math.atan2(x-E,y-v);if(z&&(we+=we>0?-j:j),Ve!==void 0){let ie=we-Ve;if(ie+=ie>j?-2*j:ie<-j?2*j:0,Math.abs(ie)>a)return null}Ve=we;const Se=Oe;let se=0;for(;Oe<ce;++Oe){const ie=z?ce-Oe-1:Oe,me=o*l(c,i[ie],h);if(e+r<t&&b+T<s+se+me/2)break;se+=me}if(Oe===Se)continue;const V=z?i.substring(ce-Se,ce-Oe):i.substring(Se,Oe);M=T===0?0:(s+se/2-b)/T;const Q=sa(v,y,M),ne=sa(E,x,M);Re.push([Q,ne,se/2,we,V]),s+=se}return Re}class eF{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Px(),{get:(e,t)=>{if(typeof Px()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const xf=Bs(),Bc=[],Ml=[],Nl=[],Uc=[];function yM(n){return n[3].declutterBox}const _M=new RegExp("[-----]");function yS(n,e){return e==="start"?e=_M.test(n)?"right":"left":e==="end"&&(e=_M.test(n)?"left":"right"),Lx[e]}function wW(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function SW(n,e,t){return t%2===0&&(n+=e),n}class TW{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=fi(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new eF:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],f=l.justify?Lx[l.justify]:yS(Array.isArray(e)?e[0]:e,l.textAlign||pp),m=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(wW,[]),{width:x,height:v,widths:E,heights:T,lineWidths:b}=V$(l,y),A=x+m,M=[],D=(A+2)*h[0],U=(v+m)*h[1],P={width:D<0?Math.floor(D):Math.ceil(D),height:U<0?Math.floor(U):Math.ceil(U),contextInstructions:M};(h[0]!=1||h[1]!=1)&&M.push("scale",h),i&&(M.push("strokeStyle",a.strokeStyle),M.push("lineWidth",m),M.push("lineCap",a.lineCap),M.push("lineJoin",a.lineJoin),M.push("miterLimit",a.miterLimit),M.push("setLineDash",[a.lineDash]),M.push("lineDashOffset",a.lineDashOffset)),r&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const R=.5-f;let k=f*A+R*m;const N=[],O=[];let z=0,j=0,Re=0,Ne=0,Ve;for(let Oe=0,ce=y.length;Oe<ce;Oe+=2){const we=y[Oe];if(we===`
`){j+=z,z=0,k=f*A+R*m,++Ne;continue}const Se=y[Oe+1]||l.font;Se!==Ve&&(i&&N.push("font",Se),r&&O.push("font",Se),Ve=Se),z=Math.max(z,T[Re]);const se=[we,k+R*E[Re]+f*(E[Re]-b[Ne]),.5*(m+z)+j];k+=E[Re],i&&N.push("strokeText",se),r&&O.push("fillText",se),++Re}return Array.prototype.push.apply(M,N),Array.prototype.push.apply(M,O),this.labels_[s]=P,P}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,c,h,f,m,y,x,v,E){o*=m[0],l*=m[1];let T=r-o,b=i-l;const A=s+c>e?e-c:s,M=a+h>t?t-h:a,D=x[3]+A*m[0]+x[1],U=x[0]+M*m[1]+x[2],P=T-x[3],R=b-x[0];(v||f!==0)&&(Bc[0]=P,Uc[0]=P,Bc[1]=R,Ml[1]=R,Ml[0]=P+D,Nl[0]=Ml[0],Nl[1]=R+U,Uc[1]=Nl[1]);let k;return f!==0?(k=Va(fi(),r,i,1,1,f,-r,-i),Dr(k,Bc),Dr(k,Ml),Dr(k,Nl),Dr(k,Uc),bu(Math.min(Bc[0],Ml[0],Nl[0],Uc[0]),Math.min(Bc[1],Ml[1],Nl[1],Uc[1]),Math.max(Bc[0],Ml[0],Nl[0],Uc[0]),Math.max(Bc[1],Ml[1],Nl[1],Uc[1]),xf)):bu(Math.min(P,P+D),Math.min(R,R+U),Math.max(P,P+D),Math.max(R,R+U),xf),y&&(T=Math.round(T),b=Math.round(b)),{drawImageX:T,drawImageY:b,drawImageW:A,drawImageH:M,originX:c,originY:h,declutterBox:{minX:xf[0],minY:xf[1],maxX:xf[2],maxY:xf[3],value:E},canvasTransform:k,scale:m}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),c=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,Bc,Ml,Nl,Uc,a,o),G$(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=Dr(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,c=yS(Array.isArray(e)?e[0]:e,s.textAlign||pp),h=Lx[s.textBaseline||Mx],f=o&&o.lineWidth?o.lineWidth:0,m=a.width/l-2*s.scale[0],y=c*m+2*(.5-c)*f,x=h*a.height/l+2*(.5-h)*f;return{label:a,anchorX:y,anchorY:x}}execute_(e,t,r,i,s,a,o,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&uc(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Jo(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),vD(this.renderedTransform_,r));let f=0;const m=i.length;let y=0,x,v,E,T,b,A,M,D,U,P,R,k,N,O=0,z=0;const j=this.coordinateCache_,Re=this.viewRotation_,Ne=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Ve={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Re},Oe=this.instructions!=i||this.overlaps?0:200;let ce,we,Se,se;for(;f<m;){const V=i[f];switch(V[0]){case Ft.BEGIN_GEOMETRY:ce=V[1],se=V[3],ce.getGeometry()?o!==void 0&&!xs(o,se.getExtent())?f=V[2]+1:++f:f=V[2],c&&(c.zIndex=V[4]);break;case Ft.BEGIN_PATH:O>Oe&&(this.fill_(e),O=0),z>Oe&&(e.stroke(),z=0),!O&&!z&&(e.beginPath(),b=NaN,A=NaN),++f;break;case Ft.CIRCLE:y=V[1];const ne=h[y],ie=h[y+1],me=h[y+2],Ce=h[y+3],Fe=me-ne,fe=Ce-ie,le=Math.sqrt(Fe*Fe+fe*fe);e.moveTo(ne+le,ie),e.arc(ne,ie,le,0,2*Math.PI,!0),++f;break;case Ft.CLOSE_PATH:e.closePath(),++f;break;case Ft.CUSTOM:y=V[1],x=V[2];const yt=V[3],St=V[4],ln=V[5];Ve.geometry=yt,Ve.feature=ce,f in j||(j[f]=[]);const kt=j[f];ln?ln(h,y,x,2,kt):(kt[0]=h[y],kt[1]=h[y+1],kt.length=2),c&&(c.zIndex=V[6]),St(kt,Ve),++f;break;case Ft.DRAW_IMAGE:y=V[1],x=V[2],U=V[3],v=V[4],E=V[5];let Dn=V[6];const tn=V[7],lt=V[8],nr=V[9],hn=V[10];let rn=V[11];const rr=V[12];let mt=V[13];T=V[14]||"declutter";const Ut=V[15];if(!U&&V.length>=20){P=V[19],R=V[20],k=V[21],N=V[22];const Ie=this.drawLabelWithPointPlacement_(P,R,k,N);U=Ie.label,V[3]=U;const $e=V[23];v=(Ie.anchorX-$e)*this.pixelRatio,V[4]=v;const et=V[24];E=(Ie.anchorY-et)*this.pixelRatio,V[5]=E,Dn=U.height,V[6]=Dn,mt=U.width,V[13]=mt}let Fn;V.length>25&&(Fn=V[25]);let xt,nn,Nt;V.length>17?(xt=V[16],nn=V[17],Nt=V[18]):(xt=Dh,nn=null,Nt=null),hn&&Ne?rn+=Re:!hn&&!Ne&&(rn-=Re);let cr=0;for(;y<x;y+=2){if(Fn&&Fn[cr++]<mt/this.pixelRatio)continue;const Ie=this.calculateImageOrLabelDimensions_(U.width,U.height,h[y],h[y+1],mt,Dn,v,E,lt,nr,rn,rr,s,xt,!!nn||!!Nt,ce),$e=[e,t,U,Ie,tn,nn,Nt];if(l){let et,ft,Rt;if(Ut){const pn=x-y;if(!Ut[pn]){Ut[pn]={args:$e,declutterMode:T};continue}const pr=Ut[pn];et=pr.args,ft=pr.declutterMode,delete Ut[pn],Rt=yM(et)}let cn,mr;if(et&&(ft!=="declutter"||!l.collides(Rt))&&(cn=!0),(T!=="declutter"||!l.collides(Ie.declutterBox))&&(mr=!0),ft==="declutter"&&T==="declutter"){const pn=cn&&mr;cn=pn,mr=pn}cn&&(ft!=="none"&&l.insert(Rt),this.replayImageOrLabel_.apply(this,et)),mr&&(T!=="none"&&l.insert(Ie.declutterBox),this.replayImageOrLabel_.apply(this,$e))}else this.replayImageOrLabel_.apply(this,$e)}++f;break;case Ft.DRAW_CHARS:const _i=V[1],Kr=V[2],Wt=V[3],fs=V[4];N=V[5];const je=V[6],be=V[7],_e=V[8];k=V[9];const Lt=V[10];P=V[11],Array.isArray(P)&&(P=P.reduce(SW,"")),R=V[12];const L=[V[13],V[13]];T=V[14]||"declutter";const Ot=V[15],W=this.textStates[R],Z=W.font,Y=[W.scale[0]*be,W.scale[1]*be];let ue;Z in this.widths_?ue=this.widths_[Z]:(ue={},this.widths_[Z]=ue);const he=ZA(h,_i,Kr,2),Be=Math.abs(Y[0])*iM(Z,P,ue);if(fs||Be<=he){const Ie=this.textStates[R].textAlign,$e=(he-Be)*yS(P,Ie),et=EW(h,_i,Kr,2,P,$e,je,Math.abs(Y[0]),iM,Z,ue,Ne?0:this.viewRotation_,Ot);e:if(et){const ft=[];let Rt,cn,mr,pn,pr;if(k)for(Rt=0,cn=et.length;Rt<cn;++Rt){pr=et[Rt],mr=pr[4],pn=this.createLabel(mr,R,"",k),v=pr[2]+(Y[0]<0?-Lt:Lt),E=Wt*pn.height+(.5-Wt)*2*Lt*Y[1]/Y[0]-_e;const Tr=this.calculateImageOrLabelDimensions_(pn.width,pn.height,pr[0],pr[1],pn.width,pn.height,v,E,0,0,pr[3],L,!1,Dh,!1,ce);if(l&&T==="declutter"&&l.collides(Tr.declutterBox))break e;ft.push([e,t,pn,Tr,1,null,null])}if(N)for(Rt=0,cn=et.length;Rt<cn;++Rt){pr=et[Rt],mr=pr[4],pn=this.createLabel(mr,R,N,""),v=pr[2],E=Wt*pn.height-_e;const Tr=this.calculateImageOrLabelDimensions_(pn.width,pn.height,pr[0],pr[1],pn.width,pn.height,v,E,0,0,pr[3],L,!1,Dh,!1,ce);if(l&&T==="declutter"&&l.collides(Tr.declutterBox))break e;ft.push([e,t,pn,Tr,1,null,null])}l&&T!=="none"&&l.load(ft.map(yM));for(let Tr=0,Ki=ft.length;Tr<Ki;++Tr)this.replayImageOrLabel_.apply(this,ft[Tr])}}++f;break;case Ft.END_GEOMETRY:if(a!==void 0){ce=V[1];const Ie=a(ce,se,T);if(Ie)return Ie}++f;break;case Ft.FILL:Oe?O++:this.fill_(e),++f;break;case Ft.MOVE_TO_LINE_TO:for(y=V[1],x=V[2],we=h[y],Se=h[y+1],e.moveTo(we,Se),b=we+.5|0,A=Se+.5|0,y+=2;y<x;y+=2)we=h[y],Se=h[y+1],M=we+.5|0,D=Se+.5|0,(y==x-2||M!==b||D!==A)&&(e.lineTo(we,Se),b=M,A=D);++f;break;case Ft.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],O&&(this.fill_(e),O=0,z&&(e.stroke(),z=0)),e.fillStyle=V[1],++f;break;case Ft.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,V),++f;break;case Ft.STROKE:Oe?z++:e.stroke(),++f;break;default:++f;break}}O&&this.fill_(e),z&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const Ih=["Polygon","Circle","LineString","Image","Text","Default"],tF=["Image","Text"],bW=Ih.filter(n=>!tF.includes(n));class AW{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=fi(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new TW(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=Va(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ni(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):c||h.clearRect(0,0,o,o);let f;this.renderBuffer_!==void 0&&(f=Bs(),km(f,e),A0(f,t*(this.renderBuffer_+i),f));const m=RW(i);let y;function x(D,U,P){const R=h.getImageData(0,0,o,o).data;for(let k=0,N=m.length;k<N;k++)if(R[m[k]]>0){if(!a||P==="none"||y!=="Image"&&y!=="Text"||a.includes(D)){const O=(m[k]-3)/4,z=i-O%o,j=i-(O/o|0),Re=s(D,U,z*z+j*j);if(Re)return Re}h.clearRect(0,0,o,o);break}}const v=Object.keys(this.executorsByZIndex_).map(Number);v.sort(Wl);let E,T,b,A,M;for(E=v.length-1;E>=0;--E){const D=v[E].toString();for(b=this.executorsByZIndex_[D],T=Ih.length-1;T>=0;--T)if(y=Ih[T],A=b[y],A!==void 0&&(M=A.executeHitDetection(h,l,r,x,f),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return Jo(o,0,8,2,e,o),o}isEmpty(){return Zh(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?az:Wl),a=a||Ih;const c=Ih.length;for(let h=0,f=l.length;h<f;++h){const m=l[h].toString(),y=this.executorsByZIndex_[m];for(let x=0,v=a.length;x<v;++x){const E=a[x],T=y[E];if(T!==void 0){const b=o===null?void 0:T.getZIndexContext(),A=b?b.getContext():e,M=this.maxExtent_&&E!=="Image"&&E!=="Text";if(M&&(A.save(),this.clip(A,r)),!b||E==="Text"||E==="Image"?T.execute(A,t,r,i,s,o):b.pushFunction(D=>T.execute(D,t,r,i,s,o)),M&&A.restore(),b){b.offset();const D=l[h]*c+Ih.indexOf(E);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Wl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const _S={};function RW(n){if(_S[n]!==void 0)return _S[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return _S[n]=i,i}function xM(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let m1=class nF extends xE{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;wn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||zt(a)),wn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),wn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Et.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?Et.LOADED:Et.IDLE:l=Et.LOADING:l=Et.LOADED),this.color_=e.color!==void 0?Ga(e.color):null,this.iconImage_=kx(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const f=this.getImage(1);if(f.width&&f.height)c=f.width,h=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(xM(y[0],y[1],e.width,e.height))};this.listenImageChange(m);return}}c!==void 0&&this.setScale(xM(c,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new nF({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=kx(null,e,this.crossOrigin_,Et.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Et.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Et.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Zt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Zt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Ko=.5;function IW(n,e,t,r,i,s,a,o,l){const c=i,h=n[0]*Ko,f=n[1]*Ko,m=ni(h,f);m.imageSmoothingEnabled=!1;const y=m.canvas,x=new U$(m,Ko,i,null,a,o,null),v=t.length,E=Math.floor((256*256*256-1)/v),T={};for(let A=1;A<=v;++A){const M=t[A-1],D=M.getStyleFunction()||r;if(!D)continue;let U=D(M,s);if(!U)continue;Array.isArray(U)||(U=[U]);const R=(A*E).toString(16).padStart(7,"#00000");for(let k=0,N=U.length;k<N;++k){const O=U[k],z=O.getGeometryFunction()(M);if(!z||!xs(c,z.getExtent()))continue;const j=O.clone(),Re=j.getFill();Re&&Re.setColor(R);const Ne=j.getStroke();Ne&&(Ne.setColor(R),Ne.setLineDash(null)),j.setText(void 0);const Ve=O.getImage();if(Ve){const Se=Ve.getImageSize();if(!Se)continue;const se=ni(Se[0],Se[1],void 0,{alpha:!1}),V=se.canvas;se.fillStyle=R,se.fillRect(0,0,V.width,V.height),j.setImage(new m1({img:V,anchor:Ve.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Ve.getOrigin(),opacity:1,size:Ve.getSize(),scale:Ve.getScale(),rotation:Ve.getRotation(),rotateWithView:Ve.getRotateWithView()}))}const Oe=j.getZIndex()||0;let ce=T[Oe];ce||(ce={},T[Oe]=ce,ce.Polygon=[],ce.Circle=[],ce.LineString=[],ce.Point=[]);const we=z.getType();if(we==="GeometryCollection"){const Se=z.getGeometriesArrayRecursive();for(let se=0,V=Se.length;se<V;++se){const Q=Se[se];ce[Q.getType().replace("Multi","")].push(Q,j)}}else ce[we.replace("Multi","")].push(z,j)}}const b=Object.keys(T).map(Number).sort(Wl);for(let A=0,M=b.length;A<M;++A){const D=T[b[A]];for(const U in D){const P=D[U];for(let R=0,k=P.length;R<k;R+=2){x.setStyle(P[R+1]);for(let N=0,O=e.length;N<O;++N)x.setTransform(e[N]),x.drawGeometry(P[R])}}}return m.getImageData(0,0,y.width,y.height)}function CW(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*Ko),s=Math.floor(Math.round(n[1])*Ko),a=(lr(i,0,t.width-1)+lr(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),f=Math.floor((256*256*256-1)/e.length);h&&h%f===0&&r.push(e[h/f-1])}return r}class Nm extends gl{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const PW=5;class rF extends o1{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=PW}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return $t()}getData(e){return null}prepareFrame(e){return $t()}renderFrame(e,t){return $t()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Et.LOADED||t.getState()===Et.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Et.LOADED&&t!=Et.ERROR&&e.addEventListener(Zt.CHANGE,this.boundHandleImageChange_),t==Et.IDLE&&(e.load(),t=e.getState()),t==Et.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const vM=[];let jf=null;function kW(){jf=ni(1,1,void 0,{willReadFrequently:!0})}class lR extends rF{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=fi(),this.pixelTransform=fi(),this.inversePixelTransform=fi(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){jf||kW(),jf.clearRect(0,0,1,1);let i;try{jf.drawImage(e,t,r,1,1,0,0,1,1),i=jf.getImageData(0,0,1,1).data}catch{return jf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&uc(Ga(e.style.backgroundColor),Ga(r)))){const o=e.firstElementChild;lu(o)&&(a=o.getContext("2d"))}if(a&&e$(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=ca?MD():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=ni();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=wd(r),s=hE(r),a=uE(r),o=cE(r);Dr(t.coordinateToPixelTransform,i),Dr(t.coordinateToPixelTransform,s),Dr(t.coordinateToPixelTransform,a),Dr(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;Dr(l,i),Dr(l,s),Dr(l,a),Dr(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(gn(r)/i*a),l=Math.round(ei(r)/i*a);Va(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),dp(this.inversePixelTransform,this.pixelTransform);const c=Jz(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new Nm(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Ti.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Ti.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new eF),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ti.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ti.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,c=a/2,h=i/t,f=-h,m=-e[0]+o,y=-e[1];return Va(this.tempTransform,l,c,h,f,-r,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class MW extends lR{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Bs(),this.wrappedRenderedExtent_=Bs(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),f=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),y=t.pixelRatio,x=t.viewHints,v=!(x[Qr.ANIMATING]||x[Qr.INTERACTING]),E=this.context,T=Math.round(gn(i)/o*y),b=Math.round(ei(i)/o*y),A=f.getWrapX()&&l.canWrapX(),M=A?gn(h):null,D=A?Math.ceil((i[2]-h[2])/M)+1:1;let U=A?Math.floor((i[0]-h[0])/M):0;do{let P=this.getRenderTransform(a,o,0,y,T,b,U*M);t.declutter&&(P=P.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],P,c,v,r===void 0?Ih:r?tF:bW,r?m&&t.declutter[m]:void 0)}while(++U<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ni(this.context.canvas.width,this.context.canvas.height,vM))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,_E(this.context),vM.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Ti.PRERENDER)||this.getLayer().hasListener(Ti.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=qo(r.extent);o=xs(l,e.extent),this.clipped_=o&&!su(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],f=r[0]*Ko,m=r[1]*Ko;h.push(this.getRenderTransform(i,s,a,Ko,f,m,0).slice());const y=c.getSource(),x=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!su(x,l)){let v=l[0];const E=gn(x);let T=0,b;for(;v<x[0];)--T,b=E*T,h.push(this.getRenderTransform(i,s,a,Ko,f,m,b).slice()),v+=E;for(T=0,v=l[2];v>x[2];)++T,b=E*T,h.push(this.getRenderTransform(i,s,a,Ko,f,m,b).slice()),v-=E}this.hitDetectionImageData_=IW(r,h,this.renderedFeatures_,c.getStyleFunction(),l,s,a,sM(s,this.renderedPixelRatio_))}t(CW(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),c={},h=function(m,y,x){const v=zt(m),E=c[v];if(E){if(E!==!0&&x<E.distanceSq){if(x===0)return c[v]=!0,s.splice(s.lastIndexOf(E),1),i(m,l,y);E.geometry=y,E.distanceSq=x}}else{if(x===0)return c[v]=!0,i(m,l,y);s.push(c[v]={feature:m,layer:l,geometry:y,distanceSq:x,callback:i})}},f=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,f?t.declutter?.[f]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[Qr.ANIMATING],s=e.viewHints[Qr.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,f=c.resolution,m=e.pixelRatio,y=t.getRevision(),x=t.getRenderBuffer();let v=t.getRenderOrder();v===void 0&&(v=$$);const E=c.center.slice(),T=A0(l,x*f),b=T.slice(),A=[T.slice()],M=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!su(M,e.extent)){const Re=gn(M),Ne=Math.max(gn(T)/2,Re);T[0]=M[0]-Ne,T[2]=M[2]+Ne,cD(E,h);const Ve=aD(A[0],h);Ve[0]<M[0]&&Ve[2]<M[2]?A.push([Ve[0]+Re,Ve[1],Ve[2]+Re,Ve[3]]):Ve[0]>M[0]&&Ve[2]>M[2]&&A.push([Ve[0]-Re,Ve[1],Ve[2]-Re,Ve[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==y&&this.renderedRenderOrder_==v&&this.renderedFrameDeclutter_===!!e.declutter&&su(this.wrappedRenderedExtent_,T))return uc(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new vW(zD(f,m),T,f,m);let U;for(let Re=0,Ne=A.length;Re<Ne;++Re)r.loadFeatures(A[Re],f,h);const P=sM(f,m);let R=!0;const k=(Re,Ne)=>{let Ve;const Oe=Re.getStyleFunction()||t.getStyleFunction();if(Oe&&(Ve=Oe(Re,f)),Ve){const ce=this.renderFeature(Re,P,Ve,D,U,this.getLayer().getDeclutter(),Ne);R=R&&!ce}},N=_D(T),O=r.getFeaturesInExtent(N);v&&O.sort(v);for(let Re=0,Ne=O.length;Re<Ne;++Re)k(O[Re],Re);this.renderedFeatures_=O,this.ready=R;const z=D.finish(),j=new AW(T,f,m,r.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=f,this.renderedRevision_=y,this.renderedRenderOrder_=v,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=T,this.renderedCenter_=E,this.renderedProjection_=h,this.renderedPixelRatio_=m,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,h=r.length;c<h;++c)l=aM(i,e,r[c],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=aM(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let Ad=0;const Jr=1<<Ad++,bt=1<<Ad++,di=1<<Ad++,Er=1<<Ad++,zs=1<<Ad++,La=1<<Ad++,d_=Math.pow(2,Ad)-1,cR={[Jr]:"boolean",[bt]:"number",[di]:"string",[Er]:"color",[zs]:"number[]",[La]:"size"},NW=Object.keys(cR).map(Number).sort(Wl);function LW(n){return n in cR}function Yf(n){const e=[];for(const t of NW)ym(n,t)&&e.push(cR[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function ym(n,e){return(n&e)===e}function Wo(n,e){return n===e}class hi{constructor(e,t){if(!LW(e))throw new Error(`literal expressions must have a specific type, got ${Yf(e)}`);this.type=e,this.value=t}}class iF{constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function uR(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ii(n,e,t){switch(typeof n){case"boolean":{if(Wo(e,di))return new hi(di,n?"true":"false");if(!ym(e,Jr))throw new Error(`got a boolean, but expected ${Yf(e)}`);return new hi(Jr,n)}case"number":{if(Wo(e,La))return new hi(La,Es(n));if(Wo(e,Jr))return new hi(Jr,!!n);if(Wo(e,di))return new hi(di,n.toString());if(!ym(e,bt))throw new Error(`got a number, but expected ${Yf(e)}`);return new hi(bt,n)}case"string":{if(Wo(e,Er))return new hi(Er,tR(n));if(Wo(e,Jr))return new hi(Jr,!!n);if(!ym(e,di))throw new Error(`got a string, but expected ${Yf(e)}`);return new hi(di,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return WW(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(Wo(e,La)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new hi(La,n)}if(Wo(e,Er)){if(n.length===3)return new hi(Er,[...n,1]);if(n.length===4)return new hi(Er,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!ym(e,zs))throw new Error(`got an array of numbers, but expected ${Yf(e)}`);return new hi(zs,n)}const ye={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},OW={[ye.Get]:Xt(sn(1,1/0),EM),[ye.Var]:Xt(sn(1,1),DW),[ye.Has]:Xt(sn(1,1/0),EM),[ye.Id]:Xt(FW,vf),[ye.Concat]:Xt(sn(2,1/0),kn(di)),[ye.GeometryType]:Xt(jW,vf),[ye.LineMetric]:Xt(vf),[ye.Resolution]:Xt(xS,vf),[ye.Zoom]:Xt(xS,vf),[ye.Time]:Xt(xS,vf),[ye.Any]:Xt(sn(2,1/0),kn(Jr)),[ye.All]:Xt(sn(2,1/0),kn(Jr)),[ye.Not]:Xt(sn(1,1),kn(Jr)),[ye.Equal]:Xt(sn(2,2),kn(d_)),[ye.NotEqual]:Xt(sn(2,2),kn(d_)),[ye.GreaterThan]:Xt(sn(2,2),kn(bt)),[ye.GreaterThanOrEqualTo]:Xt(sn(2,2),kn(bt)),[ye.LessThan]:Xt(sn(2,2),kn(bt)),[ye.LessThanOrEqualTo]:Xt(sn(2,2),kn(bt)),[ye.Multiply]:Xt(sn(2,1/0),wM),[ye.Coalesce]:Xt(sn(2,1/0),wM),[ye.Divide]:Xt(sn(2,2),kn(bt)),[ye.Add]:Xt(sn(2,1/0),kn(bt)),[ye.Subtract]:Xt(sn(2,2),kn(bt)),[ye.Clamp]:Xt(sn(3,3),kn(bt)),[ye.Mod]:Xt(sn(2,2),kn(bt)),[ye.Pow]:Xt(sn(2,2),kn(bt)),[ye.Abs]:Xt(sn(1,1),kn(bt)),[ye.Floor]:Xt(sn(1,1),kn(bt)),[ye.Ceil]:Xt(sn(1,1),kn(bt)),[ye.Round]:Xt(sn(1,1),kn(bt)),[ye.Sin]:Xt(sn(1,1),kn(bt)),[ye.Cos]:Xt(sn(1,1),kn(bt)),[ye.Atan]:Xt(sn(1,2),kn(bt)),[ye.Sqrt]:Xt(sn(1,1),kn(bt)),[ye.Match]:Xt(sn(4,1/0),SM,GW),[ye.Between]:Xt(sn(3,3),kn(bt)),[ye.Interpolate]:Xt(sn(6,1/0),SM,BW),[ye.Case]:Xt(sn(3,1/0),VW,UW),[ye.In]:Xt(sn(2,2),zW),[ye.Number]:Xt(sn(1,1/0),kn(d_)),[ye.String]:Xt(sn(1,1/0),kn(d_)),[ye.Array]:Xt(sn(1,1/0),kn(bt)),[ye.Color]:Xt(sn(1,4),kn(bt)),[ye.Band]:Xt(sn(1,3),kn(bt)),[ye.Palette]:Xt(sn(2,2),$W),[ye.ToString]:Xt(sn(1,1),kn(Jr|bt|di|Er))};function EM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new hi(bt,a);break}case"string":{i[s]=new hi(di,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function DW(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new hi(di,r)]}function FW(n,e,t){t.featureId=!0}function jW(n,e,t){t.geometryType=!0}function xS(n,e,t){t.mapState=!0}function vf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function sn(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function wM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Ii(n[s+1],e,t);i[s]=a}return i}function kn(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Ii(e[a+1],n,r);s[a]=o}return s}}function VW(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function SM(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function GW(n,e,t){const r=n.length-1,i=di|bt|Jr,s=Ii(n[1],i,t),a=Ii(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=Ii(n[l+2],s.type,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Ii(n[l+3],a.type,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...o,a]}function BW(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new hi(bt,i);let a;try{a=Ii(n[2],bt,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const c=Ii(n[l+3],bt,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Ii(n[l+4],e,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,a,...o]}function UW(n,e,t){const r=Ii(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Ii(n[s+1],Jr,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Ii(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function zW(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=di}else i=bt;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Ii(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Ii(n[1],i,t),...s]}function $W(n,e,t){let r;try{r=Ii(n[1],bt,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Ii(i[a],Er,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof hi))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Xt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new iF(t,i,...s)}}function WW(n,e,t){const r=n[0],i=OW[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function hR(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return hR(n.getGeometries()[0]);default:return""}}function sF(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function dc(n,e,t){const r=Ii(n,e,t);return Eo(r)}function Eo(n,e){if(n instanceof hi){if(n.type===Er&&typeof n.value=="string"){const r=tR(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case ye.Number:case ye.String:case ye.Coalesce:return HW(n);case ye.Get:case ye.Var:case ye.Has:return KW(n);case ye.Id:return r=>r.featureId;case ye.GeometryType:return r=>r.geometryType;case ye.Concat:{const r=n.args.map(i=>Eo(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case ye.Resolution:return r=>r.resolution;case ye.Any:case ye.All:case ye.Between:case ye.In:case ye.Not:return qW(n);case ye.Equal:case ye.NotEqual:case ye.LessThan:case ye.LessThanOrEqualTo:case ye.GreaterThan:case ye.GreaterThanOrEqualTo:return XW(n);case ye.Multiply:case ye.Divide:case ye.Add:case ye.Subtract:case ye.Clamp:case ye.Mod:case ye.Pow:case ye.Abs:case ye.Floor:case ye.Ceil:case ye.Round:case ye.Sin:case ye.Cos:case ye.Atan:case ye.Sqrt:return YW(n);case ye.Case:return ZW(n);case ye.Match:return QW(n);case ye.Interpolate:return JW(n);case ye.ToString:return eH(n);default:throw new Error(`Unsupported operator ${t}`)}}function HW(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Eo(n.args[s]);switch(t){case ye.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case ye.Number:case ye.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function KW(n,e){const r=n.args[0].value;switch(n.operator){case ye.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case ye.Var:return i=>i.variables[r];case ye.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function XW(n,e){const t=n.operator,r=Eo(n.args[0]),i=Eo(n.args[1]);switch(t){case ye.Equal:return s=>r(s)===i(s);case ye.NotEqual:return s=>r(s)!==i(s);case ye.LessThan:return s=>r(s)<i(s);case ye.LessThanOrEqualTo:return s=>r(s)<=i(s);case ye.GreaterThan:return s=>r(s)>i(s);case ye.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function qW(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Eo(n.args[s]);switch(t){case ye.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case ye.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case ye.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case ye.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case ye.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function YW(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Eo(n.args[s]);switch(t){case ye.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case ye.Divide:return s=>i[0](s)/i[1](s);case ye.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case ye.Subtract:return s=>i[0](s)-i[1](s);case ye.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case ye.Mod:return s=>i[0](s)%i[1](s);case ye.Pow:return s=>Math.pow(i[0](s),i[1](s));case ye.Abs:return s=>Math.abs(i[0](s));case ye.Floor:return s=>Math.floor(i[0](s));case ye.Ceil:return s=>Math.ceil(i[0](s));case ye.Round:return s=>Math.round(i[0](s));case ye.Sin:return s=>Math.sin(i[0](s));case ye.Cos:return s=>Math.cos(i[0](s));case ye.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case ye.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function ZW(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=Eo(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function QW(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=Eo(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function JW(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=Eo(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let c=2;c<t;c+=2){const h=r[c](i);let f=r[c+1](i);const m=Array.isArray(f);if(m&&(f=I$(f)),h>=a)return c===2?f:m?tH(s,a,o,l,h,f):_m(s,a,o,l,h,f);o=h,l=f}return l}}function eH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Eo(n.args[s]);switch(t){case ye.ToString:return s=>{const a=i[0](s);return n.args[0].type===Er?nR(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function _m(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function tH(n,e,t,r,i,s){if(i-t===0)return r;const o=eM(r),l=eM(s);let c=l[2]-o[2];c>180?c-=360:c<-180&&(c+=360);const h=[_m(n,e,t,o[0],i,l[0]),_m(n,e,t,o[1],i,l[1]),o[2]+_m(n,e,t,0,i,c),_m(n,e,t,r[3],i,s[3])];return C$(h)}function nH(n){return!0}function rH(n){const e=uR(),t=iH(n,e),r=sF();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=hR(i.getGeometry())),t(r)}}function TM(n){const e=uR(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=nb(n[a],e);const i=sF(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const c=a.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<t;++c){const h=r[c](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function iH(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?dc(s.filter,Jr,e):nH;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let c=0;c<l;++c)o[c]=nb(s.style[c],e)}else o=[nb(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const c of r[o].styles){const h=c(i);h&&s.push(h)}}}return s}}function nb(n,e){const t=xp(n,"",e),r=vp(n,"",e),i=sH(n,e),s=aH(n,e),a=Ds(n,"z-index",e);if(!t&&!r&&!i&&!s&&!Zh(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new mn;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),o.setFill(h)}if(r){const h=r(l);h&&(c=!1),o.setStroke(h)}if(i){const h=i(l);h&&(c=!1),o.setText(h)}if(s){const h=s(l);h&&(c=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),c?null:o}}function xp(n,e,t){let r;if(e+"fill-pattern-src"in n)r=uH(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=dR(n,e+"fill-color",t)}if(!r)return null;const i=new er;return function(s){const a=r(s);return a===eR?null:(i.setColor(a),i)}}function vp(n,e,t){const r=Ds(n,e+"stroke-width",t),i=dR(n,e+"stroke-color",t);if(!r&&!i)return null;const s=Fl(n,e+"stroke-line-cap",t),a=Fl(n,e+"stroke-line-join",t),o=aF(n,e+"stroke-line-dash",t),l=Ds(n,e+"stroke-line-dash-offset",t),c=Ds(n,e+"stroke-miter-limit",t),h=new Xn;return function(f){if(i){const m=i(f);if(m===eR)return null;h.setColor(m)}if(r&&h.setWidth(r(f)),s){const m=s(f);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(m)}if(a){const m=a(f);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(m)}return o&&h.setLineDash(o(f)),l&&h.setLineDashOffset(l(f)),c&&h.setMiterLimit(c(f)),h}}function sH(n,e){const t="text-",r=Fl(n,t+"value",e);if(!r)return null;const i=xp(n,t,e),s=xp(n,t+"background-",e),a=vp(n,t,e),o=vp(n,t+"background-",e),l=Fl(n,t+"font",e),c=Ds(n,t+"max-angle",e),h=Ds(n,t+"offset-x",e),f=Ds(n,t+"offset-y",e),m=l0(n,t+"overflow",e),y=Fl(n,t+"placement",e),x=Ds(n,t+"repeat",e),v=EE(n,t+"scale",e),E=l0(n,t+"rotate-with-view",e),T=Ds(n,t+"rotation",e),b=Fl(n,t+"align",e),A=Fl(n,t+"justify",e),M=Fl(n,t+"baseline",e),D=l0(n,t+"keep-upright",e),U=aF(n,t+"padding",e),P=wE(n,t+"declutter-mode"),R=new mo({declutterMode:P});return function(k){if(R.setText(r(k)),i&&R.setFill(i(k)),s&&R.setBackgroundFill(s(k)),a&&R.setStroke(a(k)),o&&R.setBackgroundStroke(o(k)),l&&R.setFont(l(k)),c&&R.setMaxAngle(c(k)),h&&R.setOffsetX(h(k)),f&&R.setOffsetY(f(k)),m&&R.setOverflow(m(k)),y){const N=y(k);if(N!=="point"&&N!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(N)}if(x&&R.setRepeat(x(k)),v&&R.setScale(v(k)),E&&R.setRotateWithView(E(k)),T&&R.setRotation(T(k)),b){const N=b(k);if(N!=="left"&&N!=="center"&&N!=="right"&&N!=="end"&&N!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(N)}if(A){const N=A(k);if(N!=="left"&&N!=="right"&&N!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(N)}if(M){const N=M(k);if(N!=="bottom"&&N!=="top"&&N!=="middle"&&N!=="alphabetic"&&N!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(N)}return U&&R.setPadding(U(k)),D&&R.setKeepUpright(D(k)),R}}function aH(n,e){return"icon-src"in n?oH(n,e):"shape-points"in n?lH(n,e):"circle-radius"in n?cH(n,e):null}function oH(n,e){const t="icon-",r=t+"src",i=oF(n[r],r),s=Ox(n,t+"anchor",e),a=EE(n,t+"scale",e),o=Ds(n,t+"opacity",e),l=Ox(n,t+"displacement",e),c=Ds(n,t+"rotation",e),h=l0(n,t+"rotate-with-view",e),f=AM(n,t+"anchor-origin"),m=RM(n,t+"anchor-x-units"),y=RM(n,t+"anchor-y-units"),x=gH(n,t+"color"),v=dH(n,t+"cross-origin"),E=fH(n,t+"offset"),T=AM(n,t+"offset-origin"),b=Dx(n,t+"width"),A=Dx(n,t+"height"),M=hH(n,t+"size"),D=wE(n,t+"declutter-mode"),U=new m1({src:i,anchorOrigin:f,anchorXUnits:m,anchorYUnits:y,color:x,crossOrigin:v,offset:E,offsetOrigin:T,height:A,width:b,size:M,declutterMode:D});return function(P){return o&&U.setOpacity(o(P)),l&&U.setDisplacement(l(P)),c&&U.setRotation(c(P)),h&&U.setRotateWithView(h(P)),a&&U.setScale(a(P)),s&&U.setAnchor(s(P)),U}}function lH(n,e){const t="shape-",r=t+"points",i=t+"radius",s=rb(n[r],r),a=rb(n[i],i),o=xp(n,t,e),l=vp(n,t,e),c=EE(n,t+"scale",e),h=Ox(n,t+"displacement",e),f=Ds(n,t+"rotation",e),m=l0(n,t+"rotate-with-view",e),y=Dx(n,t+"radius2"),x=Dx(n,t+"angle"),v=wE(n,t+"declutter-mode"),E=new vE({points:s,radius:a,radius2:y,angle:x,declutterMode:v});return function(T){return o&&E.setFill(o(T)),l&&E.setStroke(l(T)),h&&E.setDisplacement(h(T)),f&&E.setRotation(f(T)),m&&E.setRotateWithView(m(T)),c&&E.setScale(c(T)),E}}function cH(n,e){const t="circle-",r=xp(n,t,e),i=vp(n,t,e),s=Ds(n,t+"radius",e),a=EE(n,t+"scale",e),o=Ox(n,t+"displacement",e),l=Ds(n,t+"rotation",e),c=l0(n,t+"rotate-with-view",e),h=wE(n,t+"declutter-mode"),f=new Us({radius:5,declutterMode:h});return function(m){return s&&f.setRadius(s(m)),r&&f.setFill(r(m)),i&&f.setStroke(i(m)),o&&f.setDisplacement(o(m)),l&&f.setRotation(l(m)),c&&f.setRotateWithView(c(m)),a&&f.setScale(a(m)),f}}function Ds(n,e,t){if(!(e in n))return;const r=dc(n[e],bt,t);return function(i){return rb(r(i),e)}}function Fl(n,e,t){if(!(e in n))return null;const r=dc(n[e],di,t);return function(i){return oF(r(i),e)}}function uH(n,e,t){const r=Fl(n,e+"pattern-src",t),i=bM(n,e+"pattern-offset",t),s=bM(n,e+"pattern-size",t),a=dR(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function l0(n,e,t){if(!(e in n))return null;const r=dc(n[e],Jr,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function dR(n,e,t){if(!(e in n))return null;const r=dc(n[e],Er,t);return function(i){return lF(r(i),e)}}function aF(n,e,t){if(!(e in n))return null;const r=dc(n[e],zs,t);return function(i){return p1(r(i),e)}}function Ox(n,e,t){if(!(e in n))return null;const r=dc(n[e],zs,t);return function(i){const s=p1(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function bM(n,e,t){if(!(e in n))return null;const r=dc(n[e],zs,t);return function(i){return cF(r(i),e)}}function EE(n,e,t){if(!(e in n))return null;const r=dc(n[e],zs|bt,t);return function(i){return mH(r(i),e)}}function Dx(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function hH(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Es(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function dH(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function AM(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function RM(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function fH(n,e){const t=n[e];if(t!==void 0)return p1(t,e)}function wE(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function gH(n,e){const t=n[e];if(t!==void 0)return lF(t,e)}function p1(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function oF(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function rb(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function lF(n,e){if(typeof n=="string")return n;const t=p1(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function cF(n,e){const t=p1(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function mH(n,e){return typeof n=="number"?n:cF(n,e)}const eo={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function IM(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,h=o?o[0]:0,f=o?o[1]:0;let m=n[0]+l/2+h,y=n[2]-l/2+h,x=n[1]+c/2+f,v=n[3]-c/2+f;m>y&&(m=(y+m)/2,y=m),x>v&&(x=(v+x)/2,v=x);let E=lr(r[0],m,y),T=lr(r[1],x,v);if(a&&t&&i){const b=30*i;E+=-b*Math.log(1+Math.max(0,m-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-y)/b),T+=-b*Math.log(1+Math.max(0,x-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-v)/b)}return[E,T]})}function pH(n){return n}function uF(n){return Math.pow(n,3)}function ng(n){return 1-uF(1-n)}function yH(n){return 3*n*n-2*n*n*n}function _H(n){return n}function fR(n,e,t,r){const i=gn(e)/t[0],s=ei(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function gR(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),lr(r,t/2,e*2)}function xH(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],c=n[n.length-1],h=t?fR(l,t,a,r):l;if(o)return e?gR(i,h,c):lr(i,c,h);const f=Math.min(h,i),m=Math.floor(oE(n,f,s));return n[m]>h&&m<n.length-1?n[m+1]:n[m]}})}function vH(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,c){if(a!==void 0){const h=i?fR(e,i,l,s):e;if(c)return r?gR(a,h,t):lr(a,t,h);const f=1e-9,m=Math.ceil(Math.log(e/h)/Math.log(n)-f),y=-o*(.5-f)+.5,x=Math.min(h,a),v=Math.floor(Math.log(e/x)/Math.log(n)+y),E=Math.max(m,v),T=e/Math.pow(n,E);return lr(T,t,h)}})}function CM(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const c=r?fR(n,r,o,i):n;return!t||!l?lr(s,e,c):gR(s,c,e)}})}function mR(n){if(n!==void 0)return 0}function PM(n){if(n!==void 0)return n}function EH(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function wH(n){const e=Kl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const SH=42,pR=256,vS=0;class Xo extends ml{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=$A(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&yD(),e.center&&(e.center=Ol(e.center,this.projection_)),e.extent&&(e.extent=qo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in eo)delete t[o];this.setProperties(t,!0);const r=bH(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=TH(e),s=r.constraint,a=AH(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Ol(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Ol(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&f_(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<t;++i){const h=arguments[i],f={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||yH,callback:r};if(h.center&&(f.sourceCenter=a,f.targetCenter=h.center.slice(),a=f.targetCenter),h.zoom!==void 0?(f.sourceResolution=o,f.targetResolution=this.getResolutionForZoom(h.zoom),o=f.targetResolution):h.resolution&&(f.sourceResolution=o,f.targetResolution=h.resolution,o=f.targetResolution),h.rotation!==void 0){f.sourceRotation=l;const m=pu(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=l+m,l=f.targetRotation}RH(f)?f.complete=!0:s+=f.duration,c.push(f)}this.animations_.push(c),this.setHint(Qr.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Qr.ANIMATING]>0}getInteracting(){return this.hints_[Qr.INTERACTING]>0}cancelAnimations(){this.setHint(Qr.ANIMATING,-this.hints_[Qr.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&f_(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const f=l.easing(h);if(l.sourceCenter){const m=l.sourceCenter[0],y=l.sourceCenter[1],x=l.targetCenter[0],v=l.targetCenter[1];this.nextCenter_=l.targetCenter;const E=m+f*(x-m),T=y+f*(v-y);this.targetCenter_=[E,T]}if(l.sourceResolution&&l.targetResolution){const m=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),x=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(x,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const m=f===1?pu(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(Qr.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&f_(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],GA(r,e-this.getRotation()),_z(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&XT(e,this.getProjection())}getCenterInternal(){return this.get(eo.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return _D(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();wn(t,"The view center is not defined");const r=this.getResolution();wn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return wn(i!==void 0,"The view rotation is not defined"),wx(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(eo.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(qo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=gn(e)/t[0],i=ei(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(eo.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=ES(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=oE(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=lr(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,lr(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(wn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){wn(!tg(e),"Cannot fit empty extent provided as `geometry`");const i=qo(e,this.getProjection());r=lM(i)}else if(e.getType()==="Circle"){const i=qo(e.getExtent(),this.getProjection());r=lM(i),r.rotate(this.getRotation(),ll(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,c=-1/0,h=-1/0;for(let f=0,m=s.length;f<m;f+=a){const y=s[f]*r-s[f+1]*i,x=s[f]*i+s[f+1]*r;o=Math.min(o,y),l=Math.min(l,x),c=Math.max(c,y),h=Math.max(h,x)}return[o,l,c,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),f=Math.cos(c),m=ll(o);m[0]+=(i[1]-i[3])/2*l,m[1]+=(i[0]-i[2])/2*l;const y=m[0]*f-m[1]*h,x=m[1]*f+m[0]*h,v=this.getConstrainedCenter([y,x],l),E=t.callback?t.callback:up;t.duration!==void 0?this.animateInternal({resolution:l,center:v,duration:t.duration,easing:t.easing},E):(this.targetResolution_=l,this.targetCenter_=v,this.applyTargetState_(!1,!0),f_(E,!0))}centerOn(e,t,r){this.centerOnInternal(Ol(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(ES(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=ES(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=XT(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ol(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ol(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ol(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(eo.ROTATION)!==i&&this.set(eo.ROTATION,i),this.get(eo.RESOLUTION)!==a&&(this.set(eo.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(eo.CENTER)||!Tx(this.get(eo.CENTER),o))&&this.set(eo.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!Tx(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:ng,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Qr.INTERACTING,1)}endInteraction(e,t,r){r=r&&Ol(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(Qr.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function f_(n,e){setTimeout(function(){n(e)},0)}function TH(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return IM(n.extent,n.constrainOnlyCenter,t)}const e=$A(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,IM(t,!1,!1)}return pH}function bH(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:vS,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,f=n.showFullExtent!==void 0?n.showFullExtent:!1,m=$A(n.projection,"EPSG:3857"),y=m.getExtent();let x=n.constrainOnlyCenter,v=n.extent;if(!c&&!v&&m.isGlobal()&&(x=!1,v=y),n.resolutions!==void 0){const E=n.resolutions;t=E[a],r=E[o]!==void 0?E[o]:E[E.length-1],n.constrainResolution?e=xH(E,h,!x&&v,f):e=CM(t,r,h,!x&&v,f)}else{const T=(y?Math.max(gn(y),ei(y)):360*R0.degrees/m.getMetersPerUnit())/pR/Math.pow(2,vS),b=T/Math.pow(2,28-vS);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=vH(l,t,r,h,!x&&v,f):e=CM(t,r,h,!x&&v,f)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function AH(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?wH():t===!1?PM:typeof t=="number"?EH(t):PM}return mR}function RH(n){return!(n.sourceCenter&&n.targetCenter&&!Tx(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function ES(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const c=o*s-l*a,h=l*s+o*a;return[c,h]}const Mn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class hF extends ml{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Mn.OPACITY]=e.opacity!==void 0?e.opacity:1,wn(typeof t[Mn.OPACITY]=="number","Layer opacity must be a number"),t[Mn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Mn.Z_INDEX]=e.zIndex,t[Mn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Mn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Mn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Mn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=lr(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return $t()}getLayerStatesArray(e){return $t()}getExtent(){return this.get(Mn.EXTENT)}getMaxResolution(){return this.get(Mn.MAX_RESOLUTION)}getMinResolution(){return this.get(Mn.MIN_RESOLUTION)}getMinZoom(){return this.get(Mn.MIN_ZOOM)}getMaxZoom(){return this.get(Mn.MAX_ZOOM)}getOpacity(){return this.get(Mn.OPACITY)}getSourceState(){return $t()}getVisible(){return this.get(Mn.VISIBLE)}getZIndex(){return this.get(Mn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Mn.EXTENT,e)}setMaxResolution(e){this.set(Mn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Mn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Mn.MAX_ZOOM,e)}setMinZoom(e){this.set(Mn.MIN_ZOOM,e)}setOpacity(e){wn(typeof e=="number","Layer opacity must be a number"),this.set(Mn.OPACITY,e)}setVisible(e){this.set(Mn.VISIBLE,e)}setZIndex(e){this.set(Mn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class y1 extends hF{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Mn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Mn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(sr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=fn(e,Zt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Xo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return yR(i,t.viewState)&&(!s||xs(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Xo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Mn.MAP,e)}getMapInternal(){return this.get(Mn.MAP)}setMap(e){this.mapPrecomposeKey_&&(sr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(sr(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=fn(e,Ti.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=fn(this,Zt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);wn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Mn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function yR(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const kM={RENDER_ORDER:"renderOrder"};class SE extends y1{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(kM.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new QD(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(kM.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?JD:e;const t=IH(e);this.styleFunction_=e===null?void 0:dW(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function IH(n){if(n===void 0)return JD;if(!n)return null;if(typeof n=="function"||n instanceof mn)return n;if(!Array.isArray(n))return TM([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof mn){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof mn))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return rH(i)}return TM(n)}class Gu extends SE{constructor(e){super(e)}createRenderer(){return new MW(this)}}const zc={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Jc extends gl{constructor(e,t){super(e),this.layer=t}}const wS={LAYERS:"layers"};let TE=class dF extends hF{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(wS.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Ma(r.slice(),{unique:!0}):wn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Ma(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(sr),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(fn(e,Ns.ADD,this.handleLayersAdd_,this),fn(e,Ns.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(sr);eg(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new Jc(zc.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[fn(e,b0.PROPERTYCHANGE,this.handleLayerChange_,this),fn(e,Zt.CHANGE,this.handleLayerChange_,this)];e instanceof dF&&t.push(fn(e,zc.ADDLAYER,this.handleLayerGroupAdd_,this),fn(e,zc.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[zt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Jc(zc.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Jc(zc.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Jc(zc.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=zt(t);this.listenerKeys_[r].forEach(sr),delete this.listenerKeys_[r],this.dispatchEvent(new Jc(zc.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(wS.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new Jc(zc.REMOVELAYER,r[i]))}this.set(wS.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Hl(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const jt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function fF(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ib(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const Fx=34962,_R=34963,CH=35044,SS=35048,PH=5121,kH=5123,MH=5125,gF=5126,MM=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function NH(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!p$},e);const t=MM.length;for(let r=0;r<t;++r)try{const i=n.getContext(MM[r],e);if(i)return i}catch{}return null}const LH={STATIC_DRAW:CH};class TS{constructor(e,t){this.array_=null,this.type_=e,wn(e===Fx||e===_R,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:LH.STATIC_DRAW}ofSize(e){return this.array_=new(g_(this.type_))(e),this}fromArray(e){return this.array_=g_(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(g_(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const t=g_(this.type_);if(!(e instanceof t))throw new Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function g_(n){switch(n){case Fx:return Float32Array;case _R:return Uint32Array;default:return Float32Array}}const m_={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},OH=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,DH=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class NM{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||OH),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||DH),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(a=>{this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=t.RGBA,a=0,o=t.RGBA,l=t.UNSIGNED_BYTE,c=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,s,r[0],r[1],a,o,l,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,i){const s=this.getGL(),a=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=zt(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const o=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:t.uniform2f(s.location,r[0],r[1]);return;case 3:t.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:t.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(s.location,r)})}}const Dl={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},Fi={UNSIGNED_BYTE:PH,UNSIGNED_SHORT:kH,UNSIGNED_INT:MH,FLOAT:gF},jx={};function LM(n){return"shared/"+n}let OM=0;function FH(){const n="unique/"+OM;return OM+=1,n}function jH(n){let e=jx[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:NH(t)},jx[n]=e}return e.users+=1,e.context}function VH(n){const e=jx[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,r=t.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=t.canvas;i.width=1,i.height=1,delete jx[n]}class GH extends s1{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?LM(e.canvasCacheKey):FH(),this.gl_=jH(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(m_.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(m_.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=fi(),this.offsetScaleMatrix_=fi(),this.tmpMat4_=fF(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new NM({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new NM({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===LM(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return wn(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const t=this.gl_,r=zt(e);let i=this.bufferCache_[r];if(!i){const s=t.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=zt(e);delete this.bufferCache_[t]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(m_.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(m_.RESTORED,this.boundHandleWebGLContextRestored_),VH(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){const i=this.gl_,s=this.getCanvas(),a=e.size,o=e.pixelRatio;(s.width!==a[0]*o||s.height!==a[1]*o)&&(s.width=a[0]*o,s.height=a[1]*o,s.style.width=a[0]+"px",s.style.height=a[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,t){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),t&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){const e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,t,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}bindAttribute(e,t,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(t);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,r,i){const s=this.gl_,a=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,a[0],a[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,a=t-e,o=e*s;r.drawElements(r.TRIANGLES,a,i,o)}drawElementsInstanced(e,t,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),a=i.UNSIGNED_INT,o=4,l=t-e,c=e*o;s.drawElementsInstancedANGLE(i.TRIANGLES,l,a,c,r);for(let h=0;h<this.maxAttributeCount_;h++)s.vertexAttribDivisorANGLE(h,0)}finalizeDraw(e,t,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(Dl.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Dl.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Dl.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Dl.PIXEL_RATIO,i),this.setUniformFloatVec2(Dl.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Dl.ROTATION,r)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Dl.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Dl.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,i,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const a=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&a&&s.prevValue!==r&&(s.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,ib(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:t.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,t){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){const r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(t,r.VERTEX_SHADER),a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,s),r.linkProgram(a),!r.getShaderParameter(i,r.COMPILE_STATUS)){const o=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(o)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const o=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(o)}if(r.deleteShader(s),!r.getProgramParameter(a,r.LINK_STATUS)){const o=`GL program linking failed: ${r.getProgramInfoLog(a)}`;throw new Error(o)}return a}getUniformLocation(e){const t=zt(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=zt(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,a=e.viewState.center;return Va(t,0,0,2/(s*r[0]),2/(s*r[1]),-i,-a[0],-a[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,t,r,i,s,a){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,r,!1,i,s),a&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(o,1))}enableAttributes_(e,t){const r=BH(e);let i=0;for(let s=0;s<e.length;s++){const a=e[s];a.name&&this.enableAttributeArray_(a.name,a.size,a.type||gF,r,i,t),i+=a.size*mF(a.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){eg(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r,i){const s=this.gl_;r=r||s.createTexture();const a=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const o=0,l=s.RGBA,c=0,h=s.RGBA,f=s.UNSIGNED_BYTE;return t instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,f,t):t?s.texImage2D(s.TEXTURE_2D,o,l,h,f,t):s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,f,null),r}}function BH(n){let e=0;for(let t=0;t<n.length;t++){const r=n[t];e+=r.size*mF(r.type)}return e}function mF(n){switch(n){case Fi.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Fi.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Fi.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Fi.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class xR extends a1{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Zt.CHANGE)}release(){this.setState(jt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==jt.EMPTY){if(this.state!==jt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){$t()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:uF(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function sb(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const UH=new Error("disposed"),zH=[256,256];class DM extends xR{constructor(e){const t=jt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=sb(this.data_);return e?[e.width,e.height]:zH}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==jt.IDLE&&this.state!==jt.ERROR)return;this.state=jt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=jt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=jt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(UH),this.controller_=null),super.disposeInternal()}}class pF extends xR{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,ca?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=jt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=jt.ERROR,this.unlistenImage_(),this.image_=$H(),this.changed()}handleImageLoad_(){if(ca)this.state=jt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=jt.LOADED:this.state=jt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==jt.ERROR&&(this.state=jt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==jt.IDLE&&(this.state=jt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=P$(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function $H(){const n=ni(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let bS;const c0=[];function FM(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function AS(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function WH(){if(bS===void 0){const n=ni(6,6,c0);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",FM(n,4,5,4,0),FM(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;bS=AS(e,0)||AS(e,4)||AS(e,8),_E(n),c0.push(n.canvas)}return bS}function Vx(n,e,t,r){const i=h1(t,e,n);let s=Ix(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||Qh(l,i)){const c=Ix(n,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function HH(n,e,t,r){const i=ll(t);let s=Vx(n,e,i,r);return(!isFinite(s)||s<=0)&&iD(t,function(a){return s=Vx(n,e,a,r),isFinite(s)&&s>0}),s}function yF(n,e,t,r,i,s,a,o,l,c,h,f,m,y){const x=ni(Math.round(t*n),Math.round(t*e),c0);if(f||(x.imageSmoothingEnabled=!1),l.length===0)return x.canvas;x.scale(t,t);function v(D){return Math.round(D*t)/t}x.globalCompositeOperation="lighter";const E=Bs();l.forEach(function(D,U,P){nD(E,D.extent)});let T;const b=t/r,A=(f?1:1+Math.pow(2,-24))/b;(!m||l.length!==1||c!==0)&&(T=ni(Math.round(gn(E)*b),Math.round(ei(E)*b),c0),f||(T.imageSmoothingEnabled=!1),l.forEach(function(D,U,P){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){T.save();const z=(D.clipExtent[0]-E[0])*b,j=-(D.clipExtent[3]-E[3])*b,Re=gn(D.clipExtent)*b,Ne=ei(D.clipExtent)*b;T.rect(f?z:Math.round(z),f?j:Math.round(j),f?Re:Math.round(z+Re)-Math.round(z),f?Ne:Math.round(j+Ne)-Math.round(j)),T.clip()}const R=(D.extent[0]-E[0])*b,k=-(D.extent[3]-E[3])*b,N=gn(D.extent)*b,O=ei(D.extent)*b;T.drawImage(D.image,c,c,D.image.width-2*c,D.image.height-2*c,f?R:Math.round(R),f?k:Math.round(k),f?N:Math.round(R+N)-Math.round(R),f?O:Math.round(k+O)-Math.round(k)),D.clipExtent&&T.restore()}}));const M=wd(a);return o.getTriangles().forEach(function(D,U,P){const R=D.source,k=D.target;let N=R[0][0],O=R[0][1],z=R[1][0],j=R[1][1],Re=R[2][0],Ne=R[2][1];const Ve=v((k[0][0]-M[0])/s),Oe=v(-(k[0][1]-M[1])/s),ce=v((k[1][0]-M[0])/s),we=v(-(k[1][1]-M[1])/s),Se=v((k[2][0]-M[0])/s),se=v(-(k[2][1]-M[1])/s),V=N,Q=O;N=0,O=0,z-=V,j-=Q,Re-=V,Ne-=Q;const ne=[[z,j,0,0,ce-Ve],[Re,Ne,0,0,Se-Ve],[0,0,z,j,we-Oe],[0,0,Re,Ne,se-Oe]],ie=yz(ne);if(!ie)return;if(x.save(),x.beginPath(),WH()||!f){x.moveTo(ce,we);const Ce=4,Fe=Ve-ce,fe=Oe-we;for(let le=0;le<Ce;le++)x.lineTo(ce+v((le+1)*Fe/Ce),we+v(le*fe/(Ce-1))),le!=Ce-1&&x.lineTo(ce+v((le+1)*Fe/Ce),we+v((le+1)*fe/(Ce-1)));x.lineTo(Se,se)}else x.moveTo(ce,we),x.lineTo(Ve,Oe),x.lineTo(Se,se);x.clip(),x.transform(ie[0],ie[2],ie[1],ie[3],Ve,Oe),x.translate(E[0]-V,E[3]-Q);let me;if(T)me=T.canvas,x.scale(A,-A);else{const Ce=l[0],Fe=Ce.extent;me=Ce.image,x.scale(gn(Fe)/me.width,-ei(Fe)/me.height)}x.drawImage(me,0,0),x.restore()}),T&&(_E(T),c0.push(T.canvas)),h&&(x.save(),x.globalCompositeOperation="source-over",x.strokeStyle="black",x.lineWidth=1,o.getTriangles().forEach(function(D,U,P){const R=D.target,k=(R[0][0]-M[0])/s,N=-(R[0][1]-M[1])/s,O=(R[1][0]-M[0])/s,z=-(R[1][1]-M[1])/s,j=(R[2][0]-M[0])/s,Re=-(R[2][1]-M[1])/s;x.beginPath(),x.moveTo(O,z),x.lineTo(k,N),x.lineTo(j,Re),x.closePath(),x.stroke()}),x.restore()),x.canvas}const KH=10,jM=.25;class _F{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const c=o?KT(A=>Dr(o,h1(A,this.targetProj_,this.sourceProj_))):hp(this.targetProj_,this.sourceProj_);this.transformInv_=function(A){const M=A[0]+"/"+A[1];return l[M]||(l[M]=c(A)),l[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&gn(i)>=gn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?gn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?gn(this.targetProj_.getExtent()):null;const h=wd(r),f=hE(r),m=uE(r),y=cE(r),x=this.transformInv_(h),v=this.transformInv_(f),E=this.transformInv_(m),T=this.transformInv_(y),b=KH+(a?Math.max(0,Math.ceil(Math.log2(UT(r)/(a*a*256*256)))):0);if(this.addQuad_(h,f,m,y,x,v,E,T,b),this.wrapsXInSource_){let A=1/0;this.triangles_.forEach(function(M,D,U){A=Math.min(A,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-A>this.sourceWorldWidth_/2){const D=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];D[0][0]-A>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-A>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-A>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const U=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-U<this.sourceWorldWidth_/2&&(M.source=D)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,c){const h=V4([s,a,o,l]),f=this.sourceWorldWidth_?gn(h)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&f>.5&&f<1;let x=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=V4([e,t,r,i]);x=gn(E)/this.targetWorldWidth_>jM||x}!y&&this.sourceProj_.isGlobal()&&f&&(x=f>jM||x)}if(!x&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!xs(h,this.maxSourceExtent_))return;let v=0;if(!x&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)x=!0;else if(v=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),v!=1&&v!=2&&v!=4&&v!=8)return}if(c>0){if(!x){const E=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(E);let b;y?b=(pu(s[0],m)+pu(o[0],m))/2-pu(T[0],m):b=(s[0]+o[0])/2-T[0];const A=(s[1]+o[1])/2-T[1];x=b*b+A*A>this.errorThresholdSquared_}if(x){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const E=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(E),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],A=this.transformInv_(b);this.addQuad_(e,t,E,b,s,a,T,A,c-1),this.addQuad_(b,E,r,i,A,T,o,l,c-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(E),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],A=this.transformInv_(b);this.addQuad_(e,E,b,i,s,T,A,l,c-1),this.addQuad_(E,t,r,b,T,a,o,A,c-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(v&11)==0&&this.addTriangle_(e,r,i,s,o,l),(v&14)==0&&this.addTriangle_(e,r,t,s,o,a),v&&((v&13)==0&&this.addTriangle_(t,i,e,a,l,s),(v&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=Bs();return this.triangles_.forEach(function(t,r,i){const s=t.source;km(e,s[0]),km(e,s[1]),km(e,s[2])}),e}getTriangles(){return this.triangles_}}const xF=.5;class vF extends xR{constructor(e,t,r,i,s,a,o,l,c,h,f,m){super(s,jt.IDLE,m),this.renderEdges_=f!==void 0?f:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),x=this.targetTileGrid_.getExtent();let v=this.sourceTileGrid_.getExtent();const E=x?Hl(y,x):y;if(UT(E)===0){this.state=jt.EMPTY;return}const T=e.getExtent();T&&(v?v=Hl(v,T):v=T);const b=i.getResolution(this.wrappedTileCoord_[0]),A=HH(e,r,E,b);if(!isFinite(A)||A<=0){this.state=jt.EMPTY;return}const M=h!==void 0?h:xF;if(this.triangulation_=new _F(e,r,E,v,A*M,b),this.triangulation_.getTriangles().length===0){this.state=jt.EMPTY;return}this.sourceZ_=t.getZForResolution(A);let D=this.triangulation_.calculateSourceExtent();if(v&&(e.canWrapX()?(D[1]=lr(D[1],v[1],v[3]),D[3]=lr(D[3],v[1],v[3])):D=Hl(D,v)),!UT(D))this.state=jt.EMPTY;else{let U=0,P=0;e.canWrapX()&&(U=gn(T),P=Math.floor((D[0]-T[0])/U)),oD(D.slice(),e,!0).forEach(k=>{const N=t.getTileRangeForExtentAndZ(k,this.sourceZ_);for(let O=N.minX;O<=N.maxX;O++)for(let z=N.minY;z<=N.maxY;z++){const j=c(this.sourceZ_,O,z,o);if(j){const Re=P*U;this.sourceTiles_.push({tile:j,offset:Re})}}++P}),this.sourceTiles_.length===0&&(this.state=jt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==jt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=jt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=yF(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=jt.LOADED}this.changed()}load(){if(this.state==jt.IDLE){this.state=jt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==jt.IDLE||r==jt.LOADING){e++;const i=fn(t,Zt.CHANGE,s=>{const a=t.getState();(a==jt.LOADED||a==jt.ERROR||a==jt.EMPTY)&&(sr(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==jt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(sr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(_E(this.canvas_.getContext("2d")),c0.push(this.canvas_),this.canvas_=null),super.release()}}class vR{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ef(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new vR(n,e,t,r)}class VM{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof s1&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return wn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return wn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){wn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function Gx(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function XH(n,e,t){return n+"/"+e+"/"+t}function X_(n,e,t,r,i){return`${zt(n)},${e},${XH(t,r,i)}`}function EF(n){return qH(n[0],n[1],n[2])}function qH(n,e,t){return(e<<n)+t}function YH(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class ER extends rF{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=fi(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Mn.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Ti.PRECOMPOSE)){const i=new Nm(Ti.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Ti.POSTCOMPOSE)){const i=new Nm(Ti.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,r=-1,i;for(let a=0,o=e.layerStatesArray.length;a<o;a++){const l=e.layerStatesArray[a].layer,c=l.getRenderer();if(!(c instanceof ER)){t=!0;continue}const h=l.getClassName();if((t||h!==i)&&(r+=1,t=!1),i=h,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new GH({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Mn.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){Va(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new Nm(e,this.inversePixelTransform_,r,t);i.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(Ti.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(Ti.POSTRENDER,e,t)}}const RS={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class ZH{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function QH(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}function yu(n){const e=n.toString();return e.includes(".")?e:e+".0"}function wR(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(yu).join(", ")})`}function q_(n){const e=Ga(n),t=e.length>3?e[3]:1;return wR([e[0]/255,e[1]/255,e[2]/255,t])}function JH(n){const e=Es(n);return wR(e)}const IS={};let eK=0;function Ep(n){return n in IS||(IS[n]=eK++),IS[n]}function jl(n){return yu(Ep(n))}function SR(n){return"u_var_"+n}function wF(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const CS="getBandValue",tK="u_paletteTextures",SF="featureId",TF="geometryType",ab=-9999999;function nK(n,e,t,r){const i=Ii(n,e,t);return TR(i,e,r)}function Rn(n){return(e,t,r)=>{const i=t.args.length,s=new Array(i);for(let a=0;a<i;++a)s[a]=TR(t.args[a],r,e);return n(s,e)}}const rK={[ye.Get]:(n,e)=>{const r=e.args[0].value;r in n.properties||(n.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Wo(e.type,Jr)&&(s=`(${s} > 0.0)`),s},[ye.Id]:n=>(n.featureId=!0,"a_"+SF),[ye.GeometryType]:n=>(n.geometryType=!0,"a_"+TF),[ye.LineMetric]:()=>"currentLineMetric",[ye.Var]:(n,e)=>{const r=e.args[0].value;r in n.variables||(n.variables[r]={name:r,type:e.type});let s=SR(r);return Wo(e.type,Jr)&&(s=`(${s} > 0.0)`),s},[ye.Has]:(n,e)=>{const r=e.args[0].value;return r in n.properties||(n.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${yu(ab)})`},[ye.Resolution]:()=>"u_resolution",[ye.Zoom]:()=>"u_zoom",[ye.Time]:()=>"u_time",[ye.Any]:Rn(n=>`(${n.join(" || ")})`),[ye.All]:Rn(n=>`(${n.join(" && ")})`),[ye.Not]:Rn(([n])=>`(!${n})`),[ye.Equal]:Rn(([n,e])=>`(${n} == ${e})`),[ye.NotEqual]:Rn(([n,e])=>`(${n} != ${e})`),[ye.GreaterThan]:Rn(([n,e])=>`(${n} > ${e})`),[ye.GreaterThanOrEqualTo]:Rn(([n,e])=>`(${n} >= ${e})`),[ye.LessThan]:Rn(([n,e])=>`(${n} < ${e})`),[ye.LessThanOrEqualTo]:Rn(([n,e])=>`(${n} <= ${e})`),[ye.Multiply]:Rn(n=>`(${n.join(" * ")})`),[ye.Divide]:Rn(([n,e])=>`(${n} / ${e})`),[ye.Add]:Rn(n=>`(${n.join(" + ")})`),[ye.Subtract]:Rn(([n,e])=>`(${n} - ${e})`),[ye.Clamp]:Rn(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[ye.Mod]:Rn(([n,e])=>`mod(${n}, ${e})`),[ye.Pow]:Rn(([n,e])=>`pow(${n}, ${e})`),[ye.Abs]:Rn(([n])=>`abs(${n})`),[ye.Floor]:Rn(([n])=>`floor(${n})`),[ye.Ceil]:Rn(([n])=>`ceil(${n})`),[ye.Round]:Rn(([n])=>`floor(${n} + 0.5)`),[ye.Sin]:Rn(([n])=>`sin(${n})`),[ye.Cos]:Rn(([n])=>`cos(${n})`),[ye.Atan]:Rn(([n,e])=>e!==void 0?`atan(${n}, ${e})`:`atan(${n})`),[ye.Sqrt]:Rn(([n])=>`sqrt(${n})`),[ye.Match]:Rn(n=>{const e=n[0],t=n[n.length-1];let r=null;for(let i=n.length-3;i>=1;i-=2){const s=n[i],a=n[i+1];r=`(${e} == ${s} ? ${a} : ${r||t})`}return r}),[ye.Between]:Rn(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[ye.Interpolate]:Rn(([n,e,...t])=>{let r="";for(let i=0;i<t.length-2;i+=2){const s=t[i],a=r||t[i+1],o=t[i+2],l=t[i+3];let c;n===yu(1)?c=`(${e} - ${s}) / (${o} - ${s})`:c=`(pow(${n}, (${e} - ${s})) - 1.0) / (pow(${n}, (${o} - ${s})) - 1.0)`,r=`mix(${a}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[ye.Case]:Rn(n=>{const e=n[n.length-1];let t=null;for(let r=n.length-3;r>=0;r-=2){const i=n[r],s=n[r+1];t=`(${i} ? ${s} : ${t||e})`}return t}),[ye.In]:Rn(([n,...e],t)=>{const r=QH("in",t),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${n})`}),[ye.Array]:Rn(n=>`vec${n.length}(${n.join(", ")})`),[ye.Color]:Rn(n=>{if(n.length===1)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(n.length===2)return`vec4(vec3(${n[0]} / 255.0), ${n[1]})`;const e=n.slice(0,3).map(r=>`${r} / 255.0`);if(n.length===3)return`vec4(${e.join(", ")}, 1.0)`;const t=n[3];return`vec4(${e.join(", ")}, ${t})`}),[ye.Band]:Rn(([n,e,t],r)=>{if(!(CS in r.functions)){let i="";const s=r.bandCount||1;for(let a=0;a<s;a++){const o=Math.floor(a/4);let l=a%4;a===s-1&&l===1&&(l=3);const c=`${RS.TILE_TEXTURE_ARRAY}[${o}]`;i+=`  if (band == ${a+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[CS]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${RS.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${RS.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${CS}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[ye.Palette]:(n,e)=>{const[t,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const h=r[c].value,f=Ga(h),m=c*4;s[m]=f[0],s[m+1]=f[1],s[m+2]=f[2],s[m+3]=f[3]*255}n.paletteTextures||(n.paletteTextures=[]);const a=`${tK}[${n.paletteTextures.length}]`,o=new ZH(a,s);n.paletteTextures.push(o);const l=TR(t,bt,n);return`texture2D(${a}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function TR(n,e,t){if(n instanceof iF){const r=rK[n.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return r(t,n,e)}if((n.type&bt)>0)return yu(n.value);if((n.type&Jr)>0)return n.value.toString();if((n.type&di)>0)return jl(n.value.toString());if((n.type&Er)>0)return q_(n.value);if((n.type&zs)>0)return wR(n.value);if((n.type&La)>0)return JH(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${Yf(e)})`)}function iK(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const GM=.985;function qt(n,e,t){const r=uR();return nK(e,t,r,n)}function sK(n){const e=Ga(n),t=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[t+r,i+s]}const aK=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function bR(n){return n===Er||n===La?2:n===zs?4:1}function ob(n){const e=bR(n);return e>1?`vec${e}`:"float"}function bF(n,e){for(const t in e.variables){const r=e.variables[t],i=SR(r.name);let s=ob(r.type);r.type===Er&&(s="vec4"),n.addUniform(i,s)}for(const t in e.properties){const r=e.properties[t],i=ob(r.type),s=`a_prop_${r.name}`;r.type===Er?n.addAttribute(s,i,`unpackColor(${s})`,"vec4"):n.addAttribute(s,i)}for(const t in e.functions)n.addVertexShaderFunction(e.functions[t]),n.addFragmentShaderFunction(e.functions[t])}function AF(n,e){const t={};for(const r in n.variables){const i=n.variables[r],s=SR(i.name);t[s]=()=>{const a=e[i.name];if(typeof a=="number")return a;if(typeof a=="boolean")return a?1:0;if(i.type===Er){const o=[...Ga(a||"#eee")];return o[0]/=255,o[1]/=255,o[2]/=255,o[3]??=1,o}return typeof a=="string"?Ep(a):a}}return t}function RF(n){const e={};for(const t in n.properties){const r=n.properties[t],i=s=>{const a=s.get(r.name);return r.type===Er?sK([...Ga(a||"#eee")]):typeof a=="string"?Ep(a):typeof a=="boolean"?a?1:0:a};e[`prop_${r.name}`]={size:bR(r.type),callback:i}}return e}const wf=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${aK}
`,Sf=iK();class IF{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${yu(Sf["circle-radius"])} + ${yu(Sf["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=q_(Sf["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=yu(Sf["stroke-width"]),this.strokeColorExpression_=q_(Sf["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=jl("round"),this.strokeJoinExpression_=jl("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=q_(Sf["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,t){return this.uniforms_.push({name:e,type:t}),this}addAttribute(e,t,r,i){return this.attributes_.push({name:e,type:t,varyingName:e.replace(/^a_/,"v_"),varyingType:i??t,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${wf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${wf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${wf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${GM} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${wf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${GM}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${jl("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${jl("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${jl("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${jl("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${wf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${wf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class Bx{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,t){for(let r=0;r<e.length;r++)this.addFeature(e[r],t)}addFeature(e,t){let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const t=zt(e),r=this.pointBatch.entries[t];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[t],r}clearFeatureEntryInLineStringBatch_(e){const t=zt(e),r=this.lineStringBatch.entries[t];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[t],r}clearFeatureEntryInPolygonBatch_(e){const t=zt(e),r=this.polygonBatch.entries[t];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[t],r}addGeometry_(e,t){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,t);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),t,zt(t),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,zt(t),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,zt(t),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,zt(t),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,zt(t),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,t,zt(t),s,i.getLayout?.());break}}}addCoordinates_(e,t,r,i,s,a,o){let l;switch(e){case"MultiPolygon":{const c=r;for(let h=0,f=c.length;h<f;h++){let m=c[h];const y=h>0?c[h-1]:null,x=y?y[y.length-1]:0,v=m[m.length-1];m=x>0?m.map(E=>E-x):m,this.addCoordinates_("Polygon",t.slice(x,v),m,i,s,a,o)}break}case"MultiLineString":{const c=r;for(let h=0,f=c.length;h<f;h++){const m=h>0?c[h-1]:0;this.addCoordinates_("LineString",t.slice(m,c[h]),null,i,s,a,o)}break}case"MultiPoint":for(let c=0,h=t.length;c<h;c+=a)this.addCoordinates_("Point",t.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof Os){const m=XD(t,c);if(m.length>1){this.addCoordinates_("MultiPolygon",t,m,i,s,a,o);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=t.length/a;const h=r.length,f=r.map((m,y,x)=>y>0?(m-x[y-1])/a:m/a);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(oK(t,a)),this.polygonBatch.entries[s].ringsVerticesCounts.push(f),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let m=0,y=c.length;m<y;m++){const x=m>0?c[m-1]:0;this.addCoordinates_("LinearRing",t.slice(x,c[m]),null,i,s,a,o)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(t);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=t.length/a,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(lK(t,a,o)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,t){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return t.ref=i,r||(this.refToFeature_.set(i,t.feature),this.uidToRef_.set(e,i)),t}removeRef_(e,t){if(!e)throw new Error("This feature has no ref: "+t);this.refToFeature_.delete(e),this.uidToRef_.delete(t),this.freeGlobalRef_.push(e)}changeFeature(e,t){if(!this.uidToRef_.get(zt(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}removeFeature(e){let t=this.clearFeatureEntryInPointBatch_(e);t=this.clearFeatureEntryInPolygonBatch_(e)||t,t=this.clearFeatureEntryInLineStringBatch_(e)||t,t&&this.removeRef_(t.ref,zt(t.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const t=new Bx;t.globalCounter_=this.globalCounter_,t.uidToRef_=this.uidToRef_,t.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(t.addFeature(i),r=!1);return r?new Bx:t}}function oK(n,e){return e===2?n:n.filter((t,r)=>r%e<2)}function lK(n,e,t){return e===3&&t==="XYM"?n:e===4?n.filter((r,i)=>i%e!==2):e===3?n.map((r,i)=>i%e!==2?r:0):new Array(n.length*1.5).fill(0).map((r,i)=>i%3===2?0:n[Math.round(i/1.5)])}function cK(){const n='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}const PS={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function uK(n,e){e=e||[];const t=256,r=t-1,i=Math.floor(n/t/t/t)/r,s=Math.floor(n/t/t)%t/r,a=Math.floor(n/t)%t/r,o=n%t/r;return e[0]=i*256*255+s*255,e[1]=a*256*255+o*255,e}function hK(n){let e=0;const t=256,r=t-1;return e+=Math.round(n[0]*t*t*t*r),e+=Math.round(n[1]*t*t*r),e+=Math.round(n[2]*t*r),e+=Math.round(n[3]*r),e}function AR(n,e,t,r){let i=0;for(const s in e){const a=e[s],o=a.callback.call(t,t.feature);let l=o?.[0]??o;l===ab&&console.warn('The "has" operator might return false positives.'),l===void 0?l=ab:l===null&&(l=0),n[r+i++]=l,!(!a.size||a.size===1)&&(n[r+i++]=o[1],!(a.size<3)&&(n[r+i++]=o[2],!(a.size<4)&&(n[r+i++]=o[3])))}return i}function bE(n){return Object.keys(n).reduce((e,t)=>e+(n[t].size||1),0)}function dK(n,e,t,r){const i=(2+bE(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Dr(r,s),e[a++]=s[0],e[a++]=s[1],a+=AR(e,t,l,a)}return e}function fK(n,e,t,r){const i=3*n.verticesCount+(1+bE(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,Jo(l.flatCoordss[c],0,s.length,3,r,s,3),a+=AR(e,t,l,a),e[a++]=s.length/3;for(let f=0,m=s.length;f<m;f+=3)e[a++]=s[f],e[a++]=s[f+1],e[a++]=s[f+2]}}return e}function gK(n,e,t,r){const i=2*n.verticesCount+(1+bE(t))*n.geometriesCount+n.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,Jo(l.flatCoordss[c],0,s.length,2,r,s),a+=AR(e,t,l,a),e[a++]=l.ringsVerticesCounts[c].length;for(let f=0,m=l.ringsVerticesCounts[c].length;f<m;f++)e[a++]=l.ringsVerticesCounts[c][f];for(let f=0,m=s.length;f<m;f+=2)e[a++]=s[f],e[a++]=s[f+1]}}return e}function Ux(n){return(JSON.stringify(n).split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0),0)>>>0).toString()}function RR(n,e,t,r){if(`${r}radius`in n&&r!=="icon-"){let i=qt(t,n[`${r}radius`],bt);if(`${r}radius2`in n){const s=qt(t,n[`${r}radius2`],bt);i=`max(${i}, ${s})`}`${r}stroke-width`in n&&(i=`(${i} + ${qt(t,n[`${r}stroke-width`],bt)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in n){const i=qt(t,n[`${r}scale`],La);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in n&&e.setSymbolOffsetExpression(qt(t,n[`${r}displacement`],zs)),`${r}rotation`in n&&e.setSymbolRotationExpression(qt(t,n[`${r}rotation`],bt)),`${r}rotate-with-view`in n&&e.setSymbolRotateWithView(!!n[`${r}rotate-with-view`])}function CF(n,e,t,r,i){let s="vec4(0.)";if(e!==null&&(s=e),t!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${n})`;s=`mix(${t}, ${s}, ${l})`}const a=`(1.0 - smoothstep(-0.63, 0.58, ${n}))`;let o=`${s} * vec4(1.0, 1.0, 1.0, ${a})`;return i!==null&&(o=`${o} * vec4(1.0, 1.0, 1.0, ${i})`),o}function IR(n,e,t,r,i){const s=new Image;s.crossOrigin=n[`${r}cross-origin`]===void 0?"anonymous":n[`${r}cross-origin`],wn(typeof n[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=n[`${r}src`],t[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const a=`u_texture${i}_size`;return t[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),a}function CR(n,e,t,r,i){let s=qt(t,n[`${e}offset`],La);if(`${e}offset-origin`in n)switch(n[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function mK(n,e,t,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,RR(n,e,r,"circle-");let i=null;"circle-opacity"in n&&(i=qt(r,n["circle-opacity"],bt));let s="coordsPx";"circle-scale"in n&&(s=`coordsPx / ${qt(r,n["circle-scale"],La)}`);let a=null;"circle-fill-color"in n&&(a=qt(r,n["circle-fill-color"],Er));let o=null;"circle-stroke-color"in n&&(o=qt(r,n["circle-stroke-color"],Er));let l=qt(r,n["circle-radius"],bt),c=null;"circle-stroke-width"in n&&(c=qt(r,n["circle-stroke-width"],bt),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,f=CF(h,a,o,c,i);e.setSymbolColorExpression(f)}function pK(n,e,t,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,RR(n,e,r,"shape-");let i=null;"shape-opacity"in n&&(i=qt(r,n["shape-opacity"],bt));let s="coordsPx";"shape-scale"in n&&(s=`coordsPx / ${qt(r,n["shape-scale"],La)}`);let a=null;"shape-fill-color"in n&&(a=qt(r,n["shape-fill-color"],Er));let o=null;"shape-stroke-color"in n&&(o=qt(r,n["shape-stroke-color"],Er));let l=null;"shape-stroke-width"in n&&(l=qt(r,n["shape-stroke-width"],bt));const c=qt(r,n["shape-points"],bt);let h="0.";"shape-angle"in n&&(h=qt(r,n["shape-angle"],bt));let f,m=qt(r,n["shape-radius"],bt);if(l!==null&&(m=`${m} + ${l} * 0.5`),"shape-radius2"in n){let x=qt(r,n["shape-radius2"],bt);l!==null&&(x=`${x} + ${l} * 0.5`),f=`starDistanceField(${s}, ${c}, ${m}, ${x}, ${h})`}else f=`regularDistanceField(${s}, ${c}, ${m}, ${h})`;const y=CF(f,a,o,l,i);e.setSymbolColorExpression(y)}function yK(n,e,t,r){let i="vec4(1.0)";"icon-color"in n&&(i=qt(r,n["icon-color"],Er)),"icon-opacity"in n&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${qt(r,n["icon-opacity"],bt)})`);const s=Ux(n["icon-src"]),a=IR(n,e,t,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(a),"icon-width"in n&&"icon-height"in n&&e.setSymbolSizeExpression(`vec2(${qt(r,n["icon-width"],bt)}, ${qt(r,n["icon-height"],bt)})`),"icon-offset"in n&&"icon-size"in n){const o=qt(r,n["icon-size"],zs),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(o);const c=CR(n,"icon-",r,"v_quadSizePx",o);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${o})) / (${l}).xyxy`)}if(RR(n,e,r,"icon-"),"icon-anchor"in n){const o=qt(r,n["icon-anchor"],zs);let l="1.0";"icon-scale"in n&&(l=qt(r,n["icon-scale"],La));let c;n["icon-anchor-x-units"]==="pixels"&&n["icon-anchor-y-units"]==="pixels"?c=`${o} * ${l}`:n["icon-anchor-x-units"]==="pixels"?c=`${o} * vec2(vec2(${l}).x, v_quadSizePx.y)`:n["icon-anchor-y-units"]==="pixels"?c=`${o} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${o} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in n)switch(n["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${h}`)}}function _K(n,e,t,r){if("stroke-color"in n&&e.setStrokeColorExpression(qt(r,n["stroke-color"],Er)),"stroke-pattern-src"in n){const i=Ux(n["stroke-pattern-src"]),s=IR(n,e,t,"stroke-pattern-",i);let a=s,o="vec2(0.)";"stroke-pattern-offset"in n&&"stroke-pattern-size"in n&&(a=qt(r,n["stroke-pattern-size"],zs),o=CR(n,"stroke-pattern-",r,s,a));let l="0.";"stroke-pattern-spacing"in n&&(l=qt(r,n["stroke-pattern-spacing"],bt));let c="0.";"stroke-pattern-start-offset"in n&&(c=qt(r,n["stroke-pattern-start-offset"],bt)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const h=`u_texture${i}`;let f="1.";"stroke-color"in n&&(f=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${f} * sampleStrokePattern(${h}, ${s}, ${o}, ${a}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${a}, ${l}, v_width)`)}if("stroke-width"in n&&e.setStrokeWidthExpression(qt(r,n["stroke-width"],bt)),"stroke-offset"in n&&e.setStrokeOffsetExpression(qt(r,n["stroke-offset"],bt)),"stroke-line-cap"in n&&e.setStrokeCapExpression(qt(r,n["stroke-line-cap"],di)),"stroke-line-join"in n&&e.setStrokeJoinExpression(qt(r,n["stroke-line-join"],di)),"stroke-miter-limit"in n&&e.setStrokeMiterLimitExpression(qt(r,n["stroke-miter-limit"],bt)),"stroke-line-dash"in n){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${jl("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${jl("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=n["stroke-line-dash"].map(x=>qt(r,x,bt));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in n&&(s=qt(r,n["stroke-line-dash-offset"],bt));const o=`dashDistanceField_${Ux(n["stroke-line-dash"])}`,l=i.map((x,v)=>`float dashLength${v}`).join(", "),c=i.map((x,v)=>`dashLength${v}`).join(" + ");let h="0.",f=`getSingleDashDistance(distance, radius, ${h}, dashLength0, totalDashLength, capType, lineWidth)`;for(let x=2;x<i.length;x+=2)h=`${h} + dashLength${x-2} + dashLength${x-1}`,f=`min(${f}, getSingleDashDistance(distance, radius, ${h}, dashLength${x}, totalDashLength, capType, lineWidth))`;r.functions[o]=`float ${o}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${f};
}`;const m=i.map((x,v)=>`${x}`).join(", ");e.setStrokeDistanceFieldExpression(`${o}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${m})`);let y=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,y=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${y})`),e.setStrokePatternLengthExpression(y)}}function xK(n,e,t,r){if("fill-color"in n&&e.setFillColorExpression(qt(r,n["fill-color"],Er)),"fill-pattern-src"in n){const i=Ux(n["fill-pattern-src"]),s=IR(n,e,t,"fill-pattern-",i);let a=s,o="vec2(0.)";"fill-pattern-offset"in n&&"fill-pattern-size"in n&&(a=qt(r,n["fill-pattern-size"],zs),o=CR(n,"fill-pattern-",r,s,a)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in n&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${o}, ${a}, pxOrigin, pxPos)`)}}function BM(n,e,t){const r=wF(),i=new IF,s={};if("icon-src"in n?yK(n,i,s,r):"shape-points"in n?pK(n,i,s,r):"circle-radius"in n&&mK(n,i,s,r),_K(n,i,s,r),xK(n,i,s,r),t){const l=qt(r,t,Jr);i.setFragmentDiscardExpression(`!${l}`)}const a={};function o(l,c,h,f){if(!r[l])return;const m=ob(h),y=bR(h);i.addAttribute(`a_${c}`,m),a[c]={size:y,callback:f}}return o("geometryType",TF,di,l=>Ep(hR(l.getGeometry()))),o("featureId",SF,di|bt,l=>{const c=l.getId()??null;return typeof c=="string"?Ep(c):c}),bF(i,r),{builder:i,attributes:{...a,...RF(r)},uniforms:{...s,...AF(r,e)}}}const vK=[];let kS;function EK(){return kS||(kS=cK()),kS}let wK=0;const ba={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class SK{constructor(e,t,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=TK(e,t),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return uK(this.ref,vK)},size:2});for(const s of this.styleShaders){for(const a in s.attributes)a in this.customAttributes_||(this.customAttributes_[a]=s.attributes[a]);for(const a in s.uniforms)a in this.uniforms_||(this.uniforms_[a]=s.uniforms[a])}this.renderPasses_=this.styleShaders.map(s=>{const a={},o=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:Fi.FLOAT}));return s.builder.getFillVertexShader()&&(a.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:ba.POSITION,size:2,type:Fi.FLOAT},...o],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(a.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:ba.LOCAL_POSITION,size:2,type:Fi.FLOAT}],instancedAttributesDesc:[{name:ba.SEGMENT_START,size:2,type:Fi.FLOAT},{name:ba.MEASURE_START,size:1,type:Fi.FLOAT},{name:ba.SEGMENT_END,size:2,type:Fi.FLOAT},{name:ba.MEASURE_END,size:1,type:Fi.FLOAT},{name:ba.JOIN_ANGLES,size:2,type:Fi.FLOAT},{name:ba.DISTANCE_LOW,size:1,type:Fi.FLOAT},{name:ba.DISTANCE_HIGH,size:1,type:Fi.FLOAT},{name:ba.ANGLE_TANGENT_SUM,size:1,type:Fi.FLOAT},...o],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(a.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:ba.LOCAL_POSITION,size:2,type:Fi.FLOAT}],instancedAttributesDesc:[{name:ba.POSITION,size:2,type:Fi.FLOAT},...o],instancePrimitiveVertexCount:6}),a}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,t){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,t),[i,s,a]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",t),this.generateBuffersForType_(r.lineStringInstructions,"LineString",t),this.generateBuffersForType_(r.pointInstructions,"Point",t)]),o=dp(fi(),t);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:a,invertVerticesTransform:o}}generateRenderInstructions_(e,t){const r=this.hasFill_?gK(e.polygonBatch,new Float32Array(0),this.customAttributes_,t):null,i=this.hasStroke_?fK(e.lineStringBatch,new Float32Array(0),this.customAttributes_,t):null,s=this.hasSymbol_?dK(e.pointBatch,new Float32Array(0),this.customAttributes_,t):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,t,r){if(e===null)return null;const i=wK++;let s;switch(t){case"Polygon":s=PS.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=PS.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=PS.GENERATE_POINT_BUFFERS;break}const a={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:bE(this.customAttributes_)},o=EK();return o.postMessage(a,[e.buffer]),e=null,new Promise(l=>{const c=h=>{const f=h.data;if(f.id!==i||(o.removeEventListener("message",c),!this.helper_.getGL()))return;const m=new TS(_R,SS).fromArrayBuffer(f.indicesBuffer),y=new TS(Fx,SS).fromArrayBuffer(f.vertexAttributesBuffer),x=new TS(Fx,SS).fromArrayBuffer(f.instanceAttributesBuffer);this.helper_.flushBufferData(m),this.helper_.flushBufferData(y),this.helper_.flushBufferData(x),l([m,y,x])};o.addEventListener("message",c)})}render(e,t,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,t,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,t,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,t,r)}renderInternal_(e,t,r,i,s,a){const o=e.getSize();if(o===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(t),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),a(),l){const c=i.instancedAttributesDesc.reduce((f,m)=>f+(m.size||1),0),h=r.getSize()/c;this.helper_.drawElementsInstanced(0,o,h)}else this.helper_.drawElements(0,o)}setHelper(e,t=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),t&&(t.polygonBuffers&&(this.helper_.flushBufferData(t.polygonBuffers[0]),this.helper_.flushBufferData(t.polygonBuffers[1]),this.helper_.flushBufferData(t.polygonBuffers[2])),t.lineStringBuffers&&(this.helper_.flushBufferData(t.lineStringBuffers[0]),this.helper_.flushBufferData(t.lineStringBuffers[1]),this.helper_.flushBufferData(t.lineStringBuffers[2])),t.pointBuffers&&(this.helper_.flushBufferData(t.pointBuffers[0]),this.helper_.flushBufferData(t.pointBuffers[1]),this.helper_.flushBufferData(t.pointBuffers[2])))}}function TK(n,e){const t=Array.isArray(n)?n:[n];if("style"in t[0]){const r=[],i=t,s=[];for(const a of i){const o=Array.isArray(a.style)?a.style:[a.style];let l=a.filter;a.else&&s.length&&(l=["all",...s.map(h=>["!",h])],a.filter&&l.push(a.filter),l.length<3&&(l=l[1])),a.filter&&s.push(a.filter);const c=o.map(h=>BM(h,e,l));r.push(...c)}return r}return"builder"in t[0]?t:t.map(r=>BM(r,e,null))}const Bo=new Uint8Array(4);class bK{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){uc(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return Bo[0]=0,Bo[1]=0,Bo[2]=0,Bo[3]=0,Bo;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return Bo[0]=this.data_[r*4],Bo[1]=this.data_[r*4+1],Bo[2]=this.data_[r*4+2],Bo[3]=this.data_[r*4+3],Bo}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function AK(n,e){const t=n.viewState.projection,i=e.getSource().getWrapX()&&t.canWrapX(),s=t.getExtent(),a=n.extent,o=i?gn(s):null,l=i?Math.ceil((a[2]-s[2])/o)+1:1;return[i?Math.floor((a[0]-s[0])/o):0,l,o]}const Tf={...Dl,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class RK extends ER{constructor(e,t){const r={[Tf.RENDER_EXTENT]:[0,0,0,0],[Tf.PATTERN_ORIGIN]:[0,0],[Tf.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:t.postProcesses}),this.hitDetectionEnabled_=!t.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=Bs(),this.currentTransform_=fi(),this.tmpCoords_=[0,0],this.tmpTransform_=fi(),this.tmpMat4_=fF(),this.currentFrameStateTransform_=fi(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(t),this.batch_=new Bx,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const t=this.getLayer().getSource();let r;this.batch_.addFeatures(t.getFeatures(),r),this.sourceListenKeys_=[fn(t,ts.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),fn(t,ts.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),fn(t,ts.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),fn(t,ts.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new SK(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new bK(this.helper))}handleSourceFeatureAdded_(e,t){const r=t.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,t){const r=t.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const t=e.feature;this.batch_.removeFeature(t)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){vD(this.tmpTransform_,this.currentFrameStateTransform_),xD(this.tmpTransform_,e),this.helper.setUniformMatrixValue(Tf.PROJECTION_MATRIX,ib(this.tmpMat4_,this.tmpTransform_)),dp(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(Tf.SCREEN_TO_WORLD_MATRIX,ib(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,dp(this.tmpTransform_,e),Dr(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(Tf.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[r,i,s]=AK(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const a=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),a}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[Qr.ANIMATING]&&!e.viewHints[Qr.INTERACTING],a=!Jh(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(a||o)){const l=i.projection,c=i.resolution,h=t instanceof SE?t.getRenderBuffer():0,f=A0(e.extent,h*c);r.loadFeatures(f,c,l),this.ready=!1;const m=this.helper.makeProjectionTransform(e,fi());this.styleRenderer_.generateBuffers(this.batch_,m).then(y=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=y,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,t,r,i,s){let a=r;t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),Yz(this.currentFrameStateTransform_,a*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(t)});while(++a<i)}forEachFeatureAtCoordinate(e,t,r,i,s){if(wn(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const a=Dr(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],c=hK(l),h=this.batch_.getFeatureFromRef(c);if(h)return i(h,this.getLayer(),null)}disposeBuffers(e){const t=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&t(e.pointBuffers),e.lineStringBuffers&&t(e.lineStringBuffers),e.polygonBuffers&&t(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){sr(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const Ll={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},IK=["#00f","#0ff","#0f0","#ff0","#f00"];class CK extends SE{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(Ll.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:IK),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(Ll.BLUR)}getGradient(){return this.get(Ll.GRADIENT)}getRadius(){return this.get(Ll.RADIUS)}handleGradientChanged_(){this.gradient_=PK(this.getGradient())}setBlur(e){const t=this.get(Ll.BLUR);if(this.set(Ll.BLUR,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(Ll.GRADIENT,e)}setRadius(e){const t=this.get(Ll.RADIUS);if(this.set(Ll.RADIUS,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new IF,t=wF(),r=qt(t,this.filter_,Jr);let i=qt(t,this.getRadius(),bt),s=qt(t,this.getBlur(),bt);const a={};typeof this.getBlur()=="number"&&(s="a_blur",a.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",a.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const o={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const f=typeof this.weight_=="string"?m=>m.get(this.weight_):this.weight_;o.prop_weight={size:1,callback:m=>{const y=f(m);return y!==void 0?lr(y,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const f=["clamp",this.weight_,0,1];l=qt(t,f,bt)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),bF(e,t);const c=RF(t),h=AF(t,this.styleVariables_);return new RK(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...o},uniforms:{...h,...a}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function PK(n){const r=ni(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let a=0,o=n.length;a<o;++a)i.addColorStop(a*s,n[a]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class kK extends lR{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Hl(l,qo(t.extent,i.projection))),!o[Qr.ANIMATING]&&!o[Qr.INTERACTING]&&!tg(l))if(a){const c=i.projection,h=a.getImage(l,s,r,c);h&&(this.loadImage(h)?this.image=h:h.getState()===Et.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Dr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!Qh(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=gn(a),c=Math.floor(o.width*((i[0]-a[0])/l));if(c<0||c>=o.width)return null;const h=ei(a),f=Math.floor(o.height*((a[3]-i[1])/h));return f<0||f>=o.height?null:this.getImageData(o,c,f)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,f=e.viewState,m=f.center,y=f.resolution,x=h*a/(y*l),v=h*o/(y*l);this.prepareContainer(e,t);const E=this.context.canvas.width,T=this.context.canvas.height,b=this.getRenderContext(e);let A=!1,M=!0;if(c.extent){const k=qo(c.extent,f.projection);M=xs(k,e.extent),A=M&&!su(k,e.extent),A&&this.clipUnrotated(b,e,k)}const D=r.getImage(),U=Va(this.tempTransform,E/2,T/2,x,v,0,l*(i[0]-m[0])/a,l*(m[1]-i[3])/o);this.renderedResolution=o*h/l;const P=D.width*U[0],R=D.height*U[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),M&&P>=.5&&R>=.5){const k=U[4],N=U[5],O=c.opacity;O!==1&&(b.save(),b.globalAlpha=O),b.drawImage(D,0,0,+D.width,+D.height,k,N,P,R),O!==1&&b.restore()}return this.postRender(this.context,e),A&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class MK extends y1{constructor(e){e=e||{},super(e)}}class NK extends MK{constructor(e){super(e)}createRenderer(){return new kK(this)}getData(e){return super.getData(e)}}function MS(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function LK(n,e,t){const r=n[t];return r?r.delete(e):!1}function UM(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Hl(e,qo(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Hl(e,i))}return e}class OK extends lR{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Bs(),this.tempTileRange_=new vR(0,0,0,0),this.tempTileCoord_=Gx(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new VM(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new VM(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=X_(o,o.getKey(),e,t,r);let c;if(s.containsKey(l))c=s.get(l);else{const h=i.viewState.projection,f=o.getProjection();if(c=o.getTile(e,t,r,i.pixelRatio,h,!f||$h(f,h)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Dr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!Qh(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),c=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const f=l.getTileCoordForCoordAndZ(i,h),m=this.getTile(h,f[1],f[2],t);if(!m||m.getState()!==jt.LOADED)continue;const y=l.getOrigin(h),x=Es(l.getTileSize(h)),v=l.getResolution(h);let E;if(m instanceof pF||m instanceof vF)E=m.getImage();else if(m instanceof DM){if(E=sb(m.getData()),!E)continue}else continue;const T=Math.floor(c*((i[0]-y[0])/v-f[1]*x[0])),b=Math.floor(c*((y[1]-i[1])/v-f[2]*x[1])),A=Math.round(c*o.getGutterForProjection(a.projection));return this.getImageData(E,T+A,b+A)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=zt(l);h in e.wantedTiles||(e.wantedTiles[h]={});const f=e.wantedTiles[h],m=o.getMapInternal(),y=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),x=a.rotation,v=x?sD(a.center,a.resolution,x,e.size):void 0;for(let E=r;E>=y;--E){const T=c.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),b=c.getResolution(E);for(let A=T.minX;A<=T.maxX;++A)for(let M=T.minY;M<=T.maxY;++M){if(x&&!c.tileCoordIntersectsViewport([E,A,M],v))continue;const D=this.getTile(E,A,M,e);if(!D||!MS(i,D,E))continue;const P=D.getKey();if(f[P]=!0,D.getState()===jt.IDLE&&!e.tileQueue.isKeyQueued(P)){const R=Gx(E,A,M,this.tempTileCoord_);e.tileQueue.enqueue([D,h,c.getTileCoordCenter(R),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const c=X_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(c)){const h=r.peek(c);if(h.getState()===jt.LOADED)return h.endTransition(zt(this)),MS(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let f=s.minY;f<=s.maxY;++f){const m=X_(l,c,r,h,f);let y=!1;if(o.containsKey(m)){const x=o.peek(m);x.getState()===jt.LOADED&&(MS(i,x,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),f=h.getTileGridForProjection(s),m=f.getZForResolution(a,h.zDirection),y=f.getResolution(m),x=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==x&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=x):this.renderedSourceKey_=x;let v=e.extent;const E=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,b=this.context.canvas.height,A=r.extent&&qo(r.extent);A&&(v=Hl(v,qo(r.extent)));const M=y*T/2/E,D=y*b/2/E,U=[o[0]-M,o[1]-D,o[0]+M,o[1]+D],P={};this.renderedTiles.length=0;const R=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ce=f.getZForResolution(i.nextResolution,h.zDirection),we=UM(e,e.nextExtent);this.enqueueTiles(e,we,ce,P,R)}const k=UM(e,v);if(this.enqueueTiles(e,k,m,P,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,k,m-1,P,R-1)},0),!(m in P))return this.container;const N=zt(this),O=e.time;for(const ce of P[m]){const we=ce.getState();if(we===jt.EMPTY)continue;const Se=ce.tileCoord;if(we===jt.LOADED&&ce.getAlpha(N,O)===1){ce.endTransition(N);continue}if(we!==jt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Se,P)){LK(P,ce,m),e.animate=!0;continue}if(this.findAltTiles_(f,Se,m+1,P))continue;const Q=f.getMinZoom();for(let ne=m-1;ne>=Q&&!this.findAltTiles_(f,Se,ne,P);--ne);}const z=y/a*l/E,j=this.getRenderContext(e);Va(this.tempTransform,T/2,b/2,z,z,0,-T/2,-b/2),r.extent&&this.clipUnrotated(j,e,A),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const Re=Object.keys(P).map(Number);Re.sort(Wl);let Ne;const Ve=[],Oe=[];for(let ce=Re.length-1;ce>=0;--ce){const we=Re[ce],Se=h.getTilePixelSize(we,l,s),V=f.getResolution(we)/y,Q=Se[0]*V*z,ne=Se[1]*V*z,ie=f.getTileCoordForCoordAndZ(wd(U),we),me=f.getTileCoordExtent(ie),Ce=Dr(this.tempTransform,[E*(me[0]-U[0])/y,E*(U[3]-me[3])/y]),Fe=E*h.getGutterForProjection(s);for(const fe of P[we]){if(fe.getState()!==jt.LOADED)continue;const le=fe.tileCoord,yt=ie[1]-le[1],St=Math.round(Ce[0]-(yt-1)*Q),ln=ie[2]-le[2],kt=Math.round(Ce[1]-(ln-1)*ne),Dn=Math.round(Ce[0]-yt*Q),tn=Math.round(Ce[1]-ln*ne),lt=St-Dn,nr=kt-tn,hn=Re.length===1;let rn=!1;Ne=[Dn,tn,Dn+lt,tn,Dn+lt,tn+nr,Dn,tn+nr];for(let rr=0,mt=Ve.length;rr<mt;++rr)if(!hn&&we<Oe[rr]){const Ut=Ve[rr];xs([Dn,tn,Dn+lt,tn+nr],[Ut[0],Ut[3],Ut[4],Ut[7]])&&(rn||(j.save(),rn=!0),j.beginPath(),j.moveTo(Ne[0],Ne[1]),j.lineTo(Ne[2],Ne[3]),j.lineTo(Ne[4],Ne[5]),j.lineTo(Ne[6],Ne[7]),j.moveTo(Ut[6],Ut[7]),j.lineTo(Ut[4],Ut[5]),j.lineTo(Ut[2],Ut[3]),j.lineTo(Ut[0],Ut[1]),j.clip())}Ve.push(Ne),Oe.push(we),this.drawTile(fe,e,Dn,tn,lt,nr,Fe,hn),rn&&j.restore(),this.renderedTiles.unshift(fe),this.updateUsedTiles(e.usedTiles,h,fe)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!Jh(this.renderedExtent_,U),this.renderedExtent_=U,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const ce=(we,Se)=>{const se=zt(h),V=Se.wantedTiles[se],Q=V?Object.keys(V).length:0;this.updateCacheSize(Q),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ce)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let c;if(e instanceof DM){if(c=sb(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),f=zt(this),m=t.layerStatesArray[t.layerIndex],y=m.opacity*(l?e.getAlpha(f,t.time):1),x=y!==h.globalAlpha;x&&(h.save(),h.globalAlpha=y),h.drawImage(c,o,o,c.width-2*o,c.height-2*o,r,i,s,a),x&&h.restore(),y!==m.opacity?t.animate=!0:l&&e.endTransition(f)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=zt(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const p_={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class DK extends y1{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(p_.PRELOAD)}setPreload(e){this.set(p_.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(p_.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(p_.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class vh extends DK{constructor(e){super(e)}createRenderer(){return new OK(this,{cacheSize:this.getCacheSize()})}}function lb(n){return Array.isArray(n)?Math.min(...n):n}const bf=[0,0,0],$c=5;class PF{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,wn(lz(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,wn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=wd(r)),wn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,wn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:pR,wn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new vR(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,c=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=Ef(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,c,r),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return Ef(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return Ef(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),c=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return Ef(c,c,h,h,r);const f=Math.floor(l*(s+1))-1,m=Math.floor(l*(a+1))-1;return Ef(c,f,h,m,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,bf);const i=bf[1],s=bf[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,bf);const a=bf[1],o=bf[2];return Ef(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=Es(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=Es(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,c=o+s[1]*i;return bu(a,o,l,c,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),c=Es(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/c[0],f=o*(l[1]-t)/r/c[1];return i?(h=au(h,$c)-1,f=au(f,$c)-1):(h=s_(h,$c),f=s_(f,$c)),Gx(a,h,f,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=Es(this.getTileSize(r),this.tmpSize_);let c=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(c=au(c,$c)-1,h=au(h,$c)-1):(c=s_(c,$c),h=s_(h,$c)),Gx(r,c,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=oE(this.resolutions_,e,t||0);return lr(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return bD(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function kF(n){let e=n.getDefaultTileGrid();return e||(e=GK(n),n.setDefaultTileGrid(e)),e}function FK(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=PR(t);if(!Qh(s,i)){const a=gn(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function jK(n,e,t,r){r=r!==void 0?r:"top-left";const i=MF(n,e,t);return new PF({extent:n,origin:fz(n,r),resolutions:i,tileSize:t})}function VK(n){const e=n||{},t=e.extent||tr("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:MF(t,e.maxZoom,e.tileSize,e.maxResolution)};return new PF(r)}function MF(n,e,t,r){e=e!==void 0?e:SH,t=Es(t!==void 0?t:pR);const i=ei(n),s=gn(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function GK(n,e,t,r){const i=PR(n);return jK(i,e,t,r)}function PR(n){n=tr(n);let e=n.getExtent();if(!e){const t=180*R0.degrees/n.getMetersPerUnit();e=bu(-t,-t,t,t)}return e}function kR(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const BK=/\{z\}/g,UK=/\{x\}/g,zK=/\{y\}/g,$K=/\{-y\}/g;function WK(n,e,t,r,i){return n.replace(BK,e.toString()).replace(UK,t.toString()).replace(zK,r.toString()).replace($K,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function HK(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function KK(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return WK(n,a,t[1],t[2],s)})}function XK(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=KK(n[i],e);return qK(r)}function qK(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=EF(e),s=pu(i,n.length);return n[s](e,t,r)})}class YK extends oR{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Es(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||zt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return $t()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:kF(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=Es(i.getTileSize(e),this.tmpSize);return s==1?a:hW(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=FK(i,e,r)),YH(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class ZK extends gl{constructor(e,t){super(e),this.tile=t}}const NS={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class MR extends YK{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===MR.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=zt(t),i=t.getState();let s;i==jt.LOADING?(this.tileLoadingKeys_[r]=!0,s=NS.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==jt.ERROR?NS.TILELOADERROR:i==jt.LOADED?NS.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new ZK(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=HK(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(XK(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class NF extends MR{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:LF,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:pF,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!$h(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||$h(t,e)))return this.tileGrid;const r=zt(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=kF(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),c=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,c!==void 0?jt.IDLE:jt.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Zt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||$h(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],c=this.getKey(),h=this.getTileGridForProjection(o),f=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(l,s),y=new vF(o,h,s,f,l,m,this.getTilePixelRatio(i),this.getGutter(),(x,v,E,T)=>this.getTileInternal(x,v,E,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=c,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=X_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const c=this.createTile_(e,t,r,i,s,o);return a?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=tr(e);if(r){const i=zt(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function LF(n,e){if(ca){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Vf extends NF{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:VK({extent:PR(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const QK="modulepreload",JK=function(n){return"/detectorapp-nl/"+n},zM={},pt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(c=>{if(c=JK(c),c in zM)return;zM[c]=!0;const h=c.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":QK,h||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),h)return new Promise((y,x)=>{m.addEventListener("load",y),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class eX extends LD{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const h=c?Hl(r,c):r,f=ll(h),m=Vx(e,t,f,i),y=xF,x=new _F(e,t,h,l,m*y,i),v=x.calculateSourceExtent(),E=tg(v)?null:a(v,m,s),T=E?Et.IDLE:Et.EMPTY,b=E?E.getPixelRatio():1;super(r,i,b,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=x,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=E,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Et.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Et.LOADED){const t=gn(this.targetExtent_)/this.targetResolution_,r=ei(this.targetExtent_)/this.targetResolution_;this.canvas_=yF(t,r,this.sourcePixelRatio_,lb(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Et.IDLE){this.state=Et.LOADING,this.changed();const e=this.sourceImage_.getState();e==Et.LOADED||e==Et.ERROR?this.reproject_():(this.sourceListenerKey_=fn(this.sourceImage_,Zt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==Et.LOADED||r==Et.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){sr(this.sourceListenerKey_),this.sourceListenerKey_=null}}const uu=4,LS={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class tX extends gl{constructor(e,t){super(e),this.image=t}}class nX extends oR{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=oE(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||$h(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&$h(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&Jh(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new eX(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=OF(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&su(this.wantedExtent_,s)||su(this.image.getExtent(),s))&&(this.wantedResolution_&&lb(this.wantedResolution_)===a||lb(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new LD(s,a,r,this.loader),this.image.addEventListener(Zt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case Et.LOADING:this.loading=!0,r=LS.IMAGELOADSTART;break;case Et.LOADED:this.loading=!1,r=LS.IMAGELOADEND;break;case Et.ERROR:this.loading=!1,r=LS.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new tX(r,t))}}function rX(n,e){n.getImage().src=e}function OF(n,e,t,r){const i=e/t,s=ll(n),a=au(gn(n)/i,uu),o=au(ei(n)/i,uu),l=au((r-1)*a/2,uu),c=a+2*l,h=au((r-1)*o/2,uu),f=o+2*h;return wx(s,i,0,[c,f])}function iX(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[Sx(gn(e)/o,uu),Sx(ei(e)/o,uu)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return kR(c,s)}function sX(n){const e=n.load?n.load:DD,t=tr(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=OF(s,a,o,r);const c=iX(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,c).then(f=>{const m=gn(s)/f.width*o;return{image:f,extent:s,resolution:m,pixelRatio:o}})}}class aX extends nX{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:rX,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=sX({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),DD(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const cb="1.3.0";function oX(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=lD(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),kR(n,i)}function lX(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[Sx(gn(n)/o,uu),Sx(ei(n)/o,uu)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return oX(i,n,l,r,s)}function $M(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:cb,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const cX='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class uX extends Vf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[cX];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!ca&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||LF)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const zx=1/0;class hX{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,eg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){wn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=zx?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<i&&r[c]<r[l]?c:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==zx?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class dX extends hX{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Zt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===jt.LOADED||r===jt.ERROR||r===jt.EMPTY){r!==jt.ERROR&&t.removeEventListener(Zt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===jt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function fX(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return zx;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class gX extends NF{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Bs(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=tr(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=h1(e,s,a),c=Vx(a,s,e,t),h=o.getZForResolution(c,this.zDirection),f=o.getResolution(h),m=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=m[0])return;let y=o.getTileCoordExtent(m,this.tmpExtent_);const x=this.gutter_;x!==0&&(y=A0(y,f*x,y));const v={QUERY_LAYERS:this.params_.LAYERS};Object.assign(v,$M(this.params_,"GetFeatureInfo"),i);const E=Math.floor((l[0]-y[0])/f),T=Math.floor((y[3]-l[1])/f);return v[this.v13_?"I":"X"]=E,v[this.v13_?"J":"Y"]=T,this.getRequestUrl_(m,y,1,a||s,v)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:cb,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),kR(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=pu(EF(e),a.length);o=a[l]}return lX(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||cb;this.v13_=lD(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=A0(a,s*o,a));const l=Object.assign({},$M(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Gf extends gl{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Yc extends Gf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Nr={SINGLECLICK:"singleclick",CLICK:Zt.CLICK,DBLCLICK:Zt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ub={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class mX extends a1{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=fn(r,ub.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=fn(r,ub.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Zt.TOUCHMOVE,this.boundHandleTouchMove_,kD?{passive:!1}:!1)}emulateClick_(e){let t=new Yc(Nr.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Yc(Nr.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Yc(Nr.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Nr.POINTERUP||t.type==Nr.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Nr.POINTERDOWN||t.type==Nr.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Yc(Nr.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(sr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Yc(Nr.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(fn(r,Nr.POINTERMOVE,this.handlePointerMove_,this),fn(r,Nr.POINTERUP,this.handlePointerUp_,this),fn(this.element_,Nr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(fn(this.element_.getRootNode(),Nr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Yc(Nr.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Yc(Nr.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(sr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Zt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(sr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(sr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Zc={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},es={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class AE extends ml{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)sr(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==up&&this.listenerKeys.push(fn(e,Zc.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class pX extends AE{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Zt.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+f1+" "+rR+(this.collapsed_&&this.collapsible_?" "+tM:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>Q5(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!uc(t,this.renderedAttributions_)){x$(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(tM),this.collapsed_?J4(this.collapseLabel_,this.label_):J4(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class yX extends AE{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Zt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+f1+" "+rR,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(l_)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ng}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(l_);!s&&r===0?this.element.classList.add(l_):s&&r!==0&&this.element.classList.remove(l_)}this.label_.style.transform=i}this.rotation_=r}}class _X extends AE{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Zt.CLICK,this.handleClick_.bind(this,r),!1);const f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=c,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Zt.CLICK,this.handleClick_.bind(this,-r),!1);const m=t+" "+f1+" "+rR,y=this.element;y.className=m,y.appendChild(h),y.appendChild(f),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:ng})):r.setZoom(s)}}}function xX(n){n=n||{};const e=new Ma;return(n.zoom===void 0||n.zoom)&&e.push(new _X(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new yX(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new pX(n.attributionOptions)),e}class vX{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const WM={ACTIVE:"active"};class _1 extends ml{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(WM.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(WM.ACTIVE,e)}setMap(e){this.map_=e}}function EX(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:_H,center:n.getConstrainedCenter(i)})}}function NR(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:ng})}class wX extends _1{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Nr.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();NR(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function hb(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const SX=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},TX=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},DF=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?TX(n):!0},bX=cp,FF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(y$&&CD&&e.ctrlKey)},jF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},AX=function(n){const e=n.originalEvent;return CD?e.metaKey:e.ctrlKey},RX=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},VF=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},OS=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},IX=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class x1 extends _1{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Nr.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Nr.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Nr.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Nr.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function LR(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class CX extends x1{constructor(e){super({stopDown:lE}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:hb(jF,IX);this.condition_=e.onFocusOnly?hb(DF,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(LR(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();xz(s,o.getResolution()),GA(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:ng})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class PX extends x1{constructor(e){e=e||{},super({stopDown:lE}),this.condition_=e.condition?e.condition:SX,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!OS(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===mR)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return OS(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return OS(e)&&FF(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class kX extends s1{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ba([i])}getGeometry(){return this.geometry_}}const Af={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class sm extends gl{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class MX extends x1{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new kX(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??FF,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new sm(Af.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new sm(t?Af.BOXEND:Af.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new sm(Af.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new sm(Af.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new sm(Af.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class NX extends MX{constructor(e){e=e||{};const t=e.condition?e.condition:RX;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:ng})}}const mh={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class LX extends _1{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return jF(t)&&VF(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Zt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==mh.DOWN||i==mh.LEFT||i==mh.RIGHT||i==mh.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,c=0;i==mh.DOWN?c=-o:i==mh.LEFT?l=-o:i==mh.RIGHT?l=o:c=o;const h=[l,c];GA(h,a.getRotation()),EX(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class OX extends _1{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!AX(t)&&VF(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Zt.KEYDOWN||e.type==Zt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();NR(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const DX=40,FX=300;class jX extends _1{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:bX;this.condition_=e.onFocusOnly?hb(DF,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Zt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=DX;break;case WheelEvent.DOM_DELTA_PAGE:s*=FX;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-lr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),NR(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class VX extends x1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=lE),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==mR&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(LR(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class GX extends x1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=lE),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(LR(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function BX(n){n=n||{};const e=new Ma,t=new vX(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new PX),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new wX({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new CX({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new VX),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new GX({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new LX),e.push(new OX({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new jX({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new NX({duration:n.zoomDuration})),e}class UX extends s1{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){$t()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Va(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),dp(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let c;const h=t.viewState;function f(M,D,U,P){return s.call(a,D,M?U:null,P)}const m=h.projection,y=cD(e.slice(),m),x=[[0,0]];if(m.canWrapX()&&i){const M=m.getExtent(),D=gn(M);x.push([-D,0],[D,0])}const v=t.layerStatesArray,E=v.length,T=[],b=[];for(let M=0;M<x.length;M++)for(let D=E-1;D>=0;--D){const U=v[D],P=U.layer;if(P.hasRenderer()&&yR(U,h)&&o.call(l,P)){const R=P.getRenderer(),k=P.getSource();if(R&&k){const N=k.getWrapX()?y:e,O=f.bind(null,U.managed);b[0]=N[0]+x[M][0],b[1]=N[1]+x[M][1],c=R.forEachFeatureAtCoordinate(b,t,r,O,T)}if(c)return c}}if(T.length===0)return;const A=1/T.length;return T.forEach((M,D)=>M.distanceSq+=D*A),T.sort((M,D)=>M.distanceSq-D.distanceSq),T.some(M=>c=M.callback(M.feature,M.layer,M.geometry)),c}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,cp,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){$t()}scheduleExpireIconCache(e){Na.canExpireCache()&&e.postRenderFunctions.push(zX)}}function zX(n,e){Na.expire()}class $X extends UX{constructor(e){super(e),this.fontChangeListenerKey_=fn(Df,b0.PROPERTYCHANGE,e.redrawText,e),this.element_=ca?MD():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=f1+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new Nm(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){sr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ti.PRECOMPOSE,e);const t=e.layerStatesArray.sort((c,h)=>c.zIndex-h.zIndex);t.some(c=>c.layer instanceof SE&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let c=0,h=t.length;c<h;++c){const f=t[c];e.layerIndex=c;const m=f.layer,y=m.getSourceState();if(!yR(f,i)||y!="ready"&&y!="undefined"){m.unrender();continue}const x=m.render(e,a);x&&(x!==a&&(this.children_.push(x),a=x),s.push(f))}this.declutter(e,s),v$(this.element_,this.children_);const l=this.getMap().getTargetElement();if(lu(l)){const c=l.getContext("2d");for(const h of this.children_){const f=h.firstElementChild||h,m=h.style.backgroundColor;if(m&&(!lu(f)||f.width>0)&&(c.fillStyle=m,c.fillRect(0,0,l.width,l.height)),lu(f)&&f.width>0){const y=h.style.opacity||f.style.opacity;c.globalAlpha=y===""?1:Number(y);const x=f.style.transform;if(x)c.setTransform(...qT(x));else{const v=parseFloat(f.style.width)/f.width,E=parseFloat(f.style.height)/f.height;c.setTransform(v,0,0,E,0,0)}c.drawImage(f,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Ti.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function GF(n){if(n instanceof y1){n.setMapInternal(null);return}n instanceof TE&&n.getLayers().forEach(GF)}function BF(n,e){if(n instanceof y1){n.setMapInternal(e);return}if(n instanceof TE){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)BF(t[r],e)}}let WX=class extends ml{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=HX(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:_$,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=fi(),this.pixelToCoordinateTransform_=fi(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ca||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ca||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(ca?new Ma:xX()),this.interactions=t.interactions||(ca?new Ma:BX({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new dX(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(es.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(es.VIEW,this.handleViewChanged_),this.addChangeListener(es.SIZE,this.handleSizeChanged_),this.addChangeListener(es.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Xo)&&e.view.then(function(i){r.setView(new Xo(i))}),this.controls.addEventListener(Ns.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Ns.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Ns.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Ns.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Ns.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Ns.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){BF(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:cp,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof TE?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:cp,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(es.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return XT(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Dr(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(es.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ma){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ol(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Dr(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(es.SIZE)}getView(){return this.get(es.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return fX(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Yc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===ub.POINTERDOWN||r===Zt.WHEEL||r===Zt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[Qr.ANIMATING]||a[Qr.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ti.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ti.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Gf(Zc.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Gf(Zc.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)sr(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Zt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Zt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!lu(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(lu(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new $X(this)),!lu(t)){this.mapBrowserEventHandler_=new mX(this,this.moveTolerance_);for(const i in Nr)this.mapBrowserEventHandler_.addEventListener(Nr[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Zt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Zt.WHEEL,this.boundHandleBrowserEvent_,kD?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[fn(r,Zt.KEYDOWN,this.handleBrowserEvent,this),fn(r,Zt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(sr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(sr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=fn(e,b0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=fn(e,Zt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(sr),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Jc("addlayer",e)),this.layerGroupPropertyListenerKeys_=[fn(e,b0.PROPERTYCHANGE,this.render,this),fn(e,Zt.CHANGE,this.render,this),fn(e,"addlayer",this.handleLayerAdd_,this),fn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){GF(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&fM(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:wx(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:zt(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=wx(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!tg(this.previousExtent_)&&!Jh(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Gf(Zc.MOVESTART,this,i)),this.previousExtent_=l1(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Qr.ANIMATING]&&!s.viewHints[Qr.INTERACTING]&&!Jh(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Gf(Zc.MOVEEND,this,s)),eD(s.extent,this.previousExtent_))),this.dispatchEvent(new Gf(Zc.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Zc.LOADSTART)||this.hasListener(Zc.LOADEND)||this.hasListener(Ti.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Jc("removelayer",t)),this.set(es.LAYERGROUP,e)}setSize(e){this.set(es.SIZE,e)}setTarget(e){this.set(es.TARGET,e)}setView(e){if(!e||e instanceof Xo){this.set(es.VIEW,e);return}this.set(es.VIEW,new Xo);const t=this;e.then(function(r){t.setView(new Xo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(lu(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!fM(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&hD("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!uc(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function HX(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new TE({layers:n.layers});t[es.LAYERGROUP]=r,t[es.TARGET]=n.target,t[es.VIEW]=n.view instanceof Xo?n.view:new Xo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new Ma(n.controls.slice()):(wn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ma(n.interactions.slice()):(wn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new Ma(n.overlays.slice()):(wn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new Ma,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const DS="units",KX=[1,2,5],am=25.4/.28;class XX extends AE{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+f1,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(DS,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(DS)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(DS,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=Ix(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||am)/am,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||am)/am:void 0;let c=o*a,h="";if(i=="degrees"){const A=R0.degrees;c*=A,c<A/60?(h="",a*=3600):c<A?(h="",a*=60):h=""}else if(i=="imperial")c<.9144?(h="in",a/=.0254):c<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")c<1e-6?(h="nm",a*=1e9):c<.001?(h="m",a*=1e6):c<1?(h="mm",a*=1e3):c<1e3?h="m":(h="km",a/=1e3);else if(i=="us")c<.9144?(h="in",a*=39.37):c<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let f=3*Math.floor(Math.log(o*a)/Math.log(10)),m,y,x,v=0,E,T;for(;;){x=Math.floor(f/3);const A=Math.pow(10,x);if(m=KX[(f%3+3)%3]*A,y=Math.round(m/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){m=v,y=E,x=T;break}else if(y>=o)break;v=m,E=y,T=x,++f}const b=this.scaleBar_?this.createScaleBar(y,m,h):m.toFixed(x<0?-x:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const f=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${f}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,c=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=Ix(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||am,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const qX={},HM=n=>{let e;const t=new Set,r=(h,f)=>{const m=typeof h=="function"?h(e):h;if(!Object.is(m,e)){const y=e;e=f??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(x=>x(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(qX?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},c=e=n(r,i,l);return l},YX=n=>n?HM(n):HM;var FS={exports:{}},jS={},VS={exports:{}},GS={};var KM;function ZX(){if(KM)return GS;KM=1;var n=i1();function e(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,m){var y=m(),x=r({inst:{value:y,getSnapshot:m}}),v=x[0].inst,E=x[1];return s(function(){v.value=y,v.getSnapshot=m,l(v)&&E({inst:v})},[f,y,m]),i(function(){return l(v)&&E({inst:v}),f(function(){l(v)&&E({inst:v})})},[f]),a(y),y}function l(f){var m=f.getSnapshot;f=f.value;try{var y=m();return!t(f,y)}catch{return!0}}function c(f,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return GS.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,GS}var XM;function QX(){return XM||(XM=1,VS.exports=ZX()),VS.exports}var qM;function JX(){if(qM)return jS;qM=1;var n=i1(),e=QX();function t(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return jS.useSyncExternalStoreWithSelector=function(c,h,f,m,y){var x=s(null);if(x.current===null){var v={hasValue:!1,value:null};x.current=v}else v=x.current;x=o(function(){function T(U){if(!b){if(b=!0,A=U,U=m(U),y!==void 0&&v.hasValue){var P=v.value;if(y(P,U))return M=P}return M=U}if(P=M,r(A,U))return P;var R=m(U);return y!==void 0&&y(P,R)?(A=U,P):(A=U,M=R)}var b=!1,A,M,D=f===void 0?null:f;return[function(){return T(h())},D===null?void 0:function(){return T(D())}]},[h,f,m,y]);var E=i(c,x[0],x[1]);return a(function(){v.hasValue=!0,v.value=E},[E]),l(E),E},jS}var YM;function eq(){return YM||(YM=1,FS.exports=JX()),FS.exports}var tq=eq();const nq=FA(tq),UF={},{useDebugValue:rq}=iz,{useSyncExternalStoreWithSelector:iq}=nq;let ZM=!1;const sq=n=>n;function aq(n,e=sq,t){(UF?"production":void 0)!=="production"&&t&&!ZM&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ZM=!0);const r=iq(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return rq(r),r}const oq=n=>{(UF?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?YX(n):n,t=(r,i)=>aq(e,r,i);return Object.assign(t,e),t},pa=n=>oq;var zF=Symbol.for("immer-nothing"),QM=Symbol.for("immer-draftable"),da=Symbol.for("immer-state");function oo(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var wp=Object.getPrototypeOf;function k0(n){return!!n&&!!n[da]}function rd(n){return n?$F(n)||Array.isArray(n)||!!n[QM]||!!n.constructor?.[QM]||v1(n)||IE(n):!1}var lq=Object.prototype.constructor.toString(),JM=new WeakMap;function $F(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=JM.get(t);return r===void 0&&(r=Function.toString.call(t),JM.set(t,r)),r===lq}function $x(n,e,t=!0){RE(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function RE(n){const e=n[da];return e?e.type_:Array.isArray(n)?1:v1(n)?2:IE(n)?3:0}function db(n,e){return RE(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function WF(n,e,t){const r=RE(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function cq(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function v1(n){return n instanceof Map}function IE(n){return n instanceof Set}function Eh(n){return n.copy_||n.base_}function fb(n,e){if(v1(n))return new Map(n);if(IE(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=$F(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[da];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(wp(n),r)}else{const r=wp(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function OR(n,e=!1){return CE(n)||k0(n)||!rd(n)||(RE(n)>1&&Object.defineProperties(n,{set:y_,add:y_,clear:y_,delete:y_}),Object.freeze(n),e&&Object.values(n).forEach(t=>OR(t,!0))),n}function uq(){oo(2)}var y_={value:uq};function CE(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var hq={};function id(n){const e=hq[n];return e||oo(0,n),e}var Sp;function HF(){return Sp}function dq(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function eN(n,e){e&&(id("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function gb(n){mb(n),n.drafts_.forEach(fq),n.drafts_=null}function mb(n){n===Sp&&(Sp=n.parent_)}function tN(n){return Sp=dq(Sp,n)}function fq(n){const e=n[da];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function nN(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[da].modified_&&(gb(e),oo(4)),rd(n)&&(n=Wx(e,n),e.parent_||Hx(e,n)),e.patches_&&id("Patches").generateReplacementPatches_(t[da].base_,n,e.patches_,e.inversePatches_)):n=Wx(e,t,[]),gb(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==zF?n:void 0}function Wx(n,e,t){if(CE(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[da];if(!i)return $x(e,(s,a)=>rN(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return Hx(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),$x(a,(l,c)=>rN(n,i,s,l,c,t,o),r),Hx(n,s,!1),t&&n.patches_&&id("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function rN(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=CE(i);if(!(o&&!a)){if(k0(i)){const l=s&&e&&e.type_!==3&&!db(e.assigned_,r)?s.concat(r):void 0,c=Wx(n,i,l);if(WF(t,r,c),k0(c))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(rd(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;Wx(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(v1(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&Hx(n,i)}}}function Hx(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&OR(e,t)}function gq(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:HF(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=DR;t&&(i=[r],s=Tp);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var DR={get(n,e){if(e===da)return n;const t=Eh(n);if(!db(t,e))return mq(n,t,e);const r=t[e];return n.finalized_||!rd(r)?r:r===BS(n.base_,e)?(US(n),n.copy_[e]=yb(r,n)):r},has(n,e){return e in Eh(n)},ownKeys(n){return Reflect.ownKeys(Eh(n))},set(n,e,t){const r=KF(Eh(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=BS(Eh(n),e),s=i?.[da];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(cq(t,i)&&(t!==void 0||db(n.base_,e)))return!0;US(n),pb(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return BS(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,US(n),pb(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Eh(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){oo(11)},getPrototypeOf(n){return wp(n.base_)},setPrototypeOf(){oo(12)}},Tp={};$x(DR,(n,e)=>{Tp[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Tp.deleteProperty=function(n,e){return Tp.set.call(this,n,e,void 0)};Tp.set=function(n,e,t){return DR.set.call(this,n[0],e,t,n[0])};function BS(n,e){const t=n[da];return(t?Eh(t):n)[e]}function mq(n,e,t){const r=KF(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function KF(n,e){if(!(e in n))return;let t=wp(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=wp(t)}}function pb(n){n.modified_||(n.modified_=!0,n.parent_&&pb(n.parent_))}function US(n){n.copy_||(n.copy_=fb(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var pq=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...c){return a.produce(l,h=>t.call(this,h,...c))}}typeof t!="function"&&oo(6),r!==void 0&&typeof r!="function"&&oo(7);let i;if(rd(e)){const s=tN(this),a=yb(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?gb(s):mb(s)}return eN(s,r),nN(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===zF&&(i=void 0),this.autoFreeze_&&OR(i,!0),r){const s=[],a=[];id("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else oo(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){rd(n)||oo(8),k0(n)&&(n=yq(n));const e=tN(this),t=yb(n,void 0);return t[da].isManual_=!0,mb(e),t}finishDraft(n,e){const t=n&&n[da];(!t||!t.isManual_)&&oo(9);const{scope_:r}=t;return eN(r,e),nN(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=id("Patches").applyPatches_;return k0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function yb(n,e){const t=v1(n)?id("MapSet").proxyMap_(n,e):IE(n)?id("MapSet").proxySet_(n,e):gq(n,e);return(e?e.scope_:HF()).drafts_.push(t),t}function yq(n){return k0(n)||oo(10,n),XF(n)}function XF(n){if(!rd(n)||CE(n))return n;const e=n[da];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=fb(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=fb(n,!0);return $x(t,(i,s)=>{WF(t,i,XF(s))},r),e&&(e.finalized_=!1),t}var _q=new pq,xq=_q.produce;const vq=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?xq(i):i;return e(o,s,...a)},n(r.setState,t,r)),rg=vq,_s=pa()(rg((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),PE={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await pt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await pt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await pt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await pt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await pt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await pt(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await pt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await pt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await pt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await pt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await pt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-D2RP3Ybi.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await pt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-Cd8WQIgc.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await pt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-Cd8WQIgc.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await pt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-Cd8WQIgc.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await pt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-9vq1jZZ9.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await pt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-9vq1jZZ9.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await pt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-9vq1jZZ9.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await pt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-9vq1jZZ9.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await pt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-9vq1jZZ9.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await pt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-9vq1jZZ9.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await pt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-9vq1jZZ9.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await pt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-CzqyWL3c.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await pt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-D5qw6IWM.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await pt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-D5qw6IWM.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await pt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-D5qw6IWM.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await pt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await pt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await pt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await pt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await pt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-DlTFFjw2.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await pt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-DlTFFjw2.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await pt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await pt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await pt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await pt(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await pt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await pt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await pt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-DtMSUiL8.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await pt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-qTpMaKgr.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await pt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-qTpMaKgr.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await pt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-qTpMaKgr.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await pt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-qTpMaKgr.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await pt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-qTpMaKgr.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await pt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-qTpMaKgr.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await pt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-DPUD0Pi0.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await pt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-DPUD0Pi0.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await pt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-Z2OWuYsZ.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await pt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-Wdx_izcP.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await pt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-pLSN61D4.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await pt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-C__wMPqS.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await pt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-BLO2uWLx.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await pt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BldPwKd-.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await pt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-De5jm-Kr.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await pt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-DpWx_9xL.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await pt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-CL4Lkpjd.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await pt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-BEq28gbi.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await pt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-Brm3YSvJ.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await pt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-wdm75wpA.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await pt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-Cwy6NSCH.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await pt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-DMB687zG.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await pt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-ZxqPxkFw.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await pt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-nJiEWqIi.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await pt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-DHKveEpP.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await pt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-v3IQSkQU.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await pt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-SK3LVD6i.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await pt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-Bwe6jPw3.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await pt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-5eu_O7zq.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await pt(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-CqvZz6YC.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await pt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-CPMqvp-4.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await pt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-DJ6KNvpN.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await pt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-BqzeECzc.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await pt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-D-iGHk8T.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function Eq(){return Object.values(PE).filter(n=>n.immediateLoad)}const pi=pa()(rg((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ai=pa()(rg((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"Archeo Landschappen":.5,Essen:.6,Terpen:.7,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=PE[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=pi.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),wr=pa()(rg((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{n(t=>{t.routeDashboardOpen=!t.routeDashboardOpen})}}))),wq=()=>{};var iN={};const qF=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Sq=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},YF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4;let m=(o&15)<<2|c>>6,y=c&63;l||(y=64,a||(m=64)),r.push(t[h],t[f],t[m],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(qF(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Sq(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||c==null||f==null)throw new Tq;const m=s<<2|o>>4;if(r.push(m),c!==64){const y=o<<4&240|c>>2;if(r.push(y),f!==64){const x=c<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Tq extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bq=function(n){const e=qF(n);return YF.encodeByteArray(e,!0)},Kx=function(n){return bq(n).replace(/\./g,"")},ZF=function(n){try{return YF.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function QF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Aq=()=>QF().__FIREBASE_DEFAULTS__,Rq=()=>{if(typeof process>"u"||typeof iN>"u")return;const n=iN.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Iq=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ZF(n[1]);return e&&JSON.parse(e)},kE=()=>{try{return wq()||Aq()||Rq()||Iq()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},JF=n=>kE()?.emulatorHosts?.[n],e6=n=>{const e=JF(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},t6=()=>kE()?.config,n6=n=>kE()?.[`_${n}`];class Cq{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Rd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function FR(n){return(await fetch(n,{credentials:"include"})).ok}function r6(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Kx(JSON.stringify(t)),Kx(JSON.stringify(a)),""].join(".")}const Lm={};function Pq(){const n={prod:[],emulator:[]};for(const e of Object.keys(Lm))Lm[e]?n.emulator.push(e):n.prod.push(e);return n}function kq(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let sN=!1;function jR(n,e){if(typeof window>"u"||typeof document>"u"||!Rd(window.location.host)||Lm[n]===e||Lm[n]||sN)return;Lm[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=Pq().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{sN=!0,a()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=kq(r),y=t("text"),x=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),E=document.getElementById(v)||document.createElement("a"),T=t("preprendIcon"),b=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const A=m.element;o(A),h(E,v);const M=c();l(b,T),A.append(b,x,E,M),document.body.appendChild(A)}s?(x.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function mi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Mq(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mi())}function i6(){const n=kE()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Nq(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Lq(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Oq(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Dq(){const n=mi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function s6(){return!i6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function a6(){return!i6()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function o6(){try{return typeof indexedDB=="object"}catch{return!1}}function Fq(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const jq="FirebaseError";class pl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=jq,Object.setPrototypeOf(this,pl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,E1.prototype.create)}}class E1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Vq(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new pl(i,o,r)}}function Vq(n,e){return n.replace(Gq,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Gq=/\{\$([^}]+)}/g;function Bq(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function sd(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(aN(s)&&aN(a)){if(!sd(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function aN(n){return n!==null&&typeof n=="object"}function w1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Uq(n,e){const t=new zq(n,e);return t.subscribe.bind(t)}class zq{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");$q(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=zS),i.error===void 0&&(i.error=zS),i.complete===void 0&&(i.complete=zS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $q(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function zS(){}function ki(n){return n&&n._delegate?n._delegate:n}class Au{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const wh="[DEFAULT]";class Wq{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Cq;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Kq(e))try{this.getOrInitializeService({instanceIdentifier:wh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=wh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wh){return this.instances.has(e)}getOptions(e=wh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Hq(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=wh){return this.component?this.component.multipleInstances?e:wh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Hq(n){return n===wh?void 0:n}function Kq(n){return n.instantiationMode==="EAGER"}class Xq{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Wq(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var yn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yn||(yn={}));const qq={debug:yn.DEBUG,verbose:yn.VERBOSE,info:yn.INFO,warn:yn.WARN,error:yn.ERROR,silent:yn.SILENT},Yq=yn.INFO,Zq={[yn.DEBUG]:"log",[yn.VERBOSE]:"log",[yn.INFO]:"info",[yn.WARN]:"warn",[yn.ERROR]:"error"},Qq=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Zq[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class VR{constructor(e){this.name=e,this._logLevel=Yq,this._logHandler=Qq,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yn.DEBUG,...e),this._logHandler(this,yn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yn.VERBOSE,...e),this._logHandler(this,yn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yn.INFO,...e),this._logHandler(this,yn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yn.WARN,...e),this._logHandler(this,yn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yn.ERROR,...e),this._logHandler(this,yn.ERROR,...e)}}const Jq=(n,e)=>e.some(t=>n instanceof t);let oN,lN;function eY(){return oN||(oN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tY(){return lN||(lN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const l6=new WeakMap,_b=new WeakMap,c6=new WeakMap,$S=new WeakMap,GR=new WeakMap;function nY(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(_u(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&l6.set(t,n)}).catch(()=>{}),GR.set(e,n),e}function rY(n){if(_b.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});_b.set(n,e)}let xb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return _b.get(n);if(e==="objectStoreNames")return n.objectStoreNames||c6.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return _u(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function iY(n){xb=n(xb)}function sY(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(WS(this),e,...t);return c6.set(r,e.sort?e.sort():[e]),_u(r)}:tY().includes(n)?function(...e){return n.apply(WS(this),e),_u(l6.get(this))}:function(...e){return _u(n.apply(WS(this),e))}}function aY(n){return typeof n=="function"?sY(n):(n instanceof IDBTransaction&&rY(n),Jq(n,eY())?new Proxy(n,xb):n)}function _u(n){if(n instanceof IDBRequest)return nY(n);if($S.has(n))return $S.get(n);const e=aY(n);return e!==n&&($S.set(n,e),GR.set(e,n)),e}const WS=n=>GR.get(n);function oY(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=_u(a);return r&&a.addEventListener("upgradeneeded",l=>{r(_u(a.result),l.oldVersion,l.newVersion,_u(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const lY=["get","getKey","getAll","getAllKeys","count"],cY=["put","add","delete","clear"],HS=new Map;function cN(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(HS.get(e))return HS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=cY.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||lY.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),i&&l.done]))[0]};return HS.set(e,s),s}iY(n=>({...n,get:(e,t,r)=>cN(e,t)||n.get(e,t,r),has:(e,t)=>!!cN(e,t)||n.has(e,t)}));class uY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(hY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function hY(n){return n.getComponent()?.type==="VERSION"}const vb="@firebase/app",uN="0.14.6";const nc=new VR("@firebase/app"),dY="@firebase/app-compat",fY="@firebase/analytics-compat",gY="@firebase/analytics",mY="@firebase/app-check-compat",pY="@firebase/app-check",yY="@firebase/auth",_Y="@firebase/auth-compat",xY="@firebase/database",vY="@firebase/data-connect",EY="@firebase/database-compat",wY="@firebase/functions",SY="@firebase/functions-compat",TY="@firebase/installations",bY="@firebase/installations-compat",AY="@firebase/messaging",RY="@firebase/messaging-compat",IY="@firebase/performance",CY="@firebase/performance-compat",PY="@firebase/remote-config",kY="@firebase/remote-config-compat",MY="@firebase/storage",NY="@firebase/storage-compat",LY="@firebase/firestore",OY="@firebase/ai",DY="@firebase/firestore-compat",FY="firebase",jY="12.6.0";const Eb="[DEFAULT]",VY={[vb]:"fire-core",[dY]:"fire-core-compat",[gY]:"fire-analytics",[fY]:"fire-analytics-compat",[pY]:"fire-app-check",[mY]:"fire-app-check-compat",[yY]:"fire-auth",[_Y]:"fire-auth-compat",[xY]:"fire-rtdb",[vY]:"fire-data-connect",[EY]:"fire-rtdb-compat",[wY]:"fire-fn",[SY]:"fire-fn-compat",[TY]:"fire-iid",[bY]:"fire-iid-compat",[AY]:"fire-fcm",[RY]:"fire-fcm-compat",[IY]:"fire-perf",[CY]:"fire-perf-compat",[PY]:"fire-rc",[kY]:"fire-rc-compat",[MY]:"fire-gcs",[NY]:"fire-gcs-compat",[LY]:"fire-fst",[DY]:"fire-fst-compat",[OY]:"fire-vertex","fire-js":"fire-js",[FY]:"fire-js-all"};const Xx=new Map,GY=new Map,wb=new Map;function hN(n,e){try{n.container.addComponent(e)}catch(t){nc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ad(n){const e=n.name;if(wb.has(e))return nc.debug(`There were multiple attempts to register component ${e}.`),!1;wb.set(e,n);for(const t of Xx.values())hN(t,n);for(const t of GY.values())hN(t,n);return!0}function ME(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function la(n){return n==null?!1:n.settings!==void 0}const BY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xu=new E1("app","Firebase",BY);class UY{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Au("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xu.create("app-deleted",{appName:this._name})}}const Id=jY;function u6(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Eb,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw xu.create("bad-app-name",{appName:String(i)});if(t||(t=t6()),!t)throw xu.create("no-options");const s=Xx.get(i);if(s){if(sd(t,s.options)&&sd(r,s.config))return s;throw xu.create("duplicate-app",{appName:i})}const a=new Xq(i);for(const l of wb.values())a.addComponent(l);const o=new UY(t,r,a);return Xx.set(i,o),o}function BR(n=Eb){const e=Xx.get(n);if(!e&&n===Eb&&t6())return u6();if(!e)throw xu.create("no-app",{appName:n});return e}function el(n,e,t){let r=VY[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nc.warn(a.join(" "));return}ad(new Au(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const zY="firebase-heartbeat-database",$Y=1,bp="firebase-heartbeat-store";let KS=null;function h6(){return KS||(KS=oY(zY,$Y,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(bp)}catch(t){console.warn(t)}}}}).catch(n=>{throw xu.create("idb-open",{originalErrorMessage:n.message})})),KS}async function WY(n){try{const t=(await h6()).transaction(bp),r=await t.objectStore(bp).get(d6(n));return await t.done,r}catch(e){if(e instanceof pl)nc.warn(e.message);else{const t=xu.create("idb-get",{originalErrorMessage:e?.message});nc.warn(t.message)}}}async function dN(n,e){try{const r=(await h6()).transaction(bp,"readwrite");await r.objectStore(bp).put(e,d6(n)),await r.done}catch(t){if(t instanceof pl)nc.warn(t.message);else{const r=xu.create("idb-set",{originalErrorMessage:t?.message});nc.warn(r.message)}}}function d6(n){return`${n.name}!${n.options.appId}`}const HY=1024,KY=30;class XY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new YY(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=fN();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>KY){const i=ZY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){nc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=fN(),{heartbeatsToSend:t,unsentEntries:r}=qY(this._heartbeatsCache.heartbeats),i=Kx(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return nc.warn(e),""}}}function fN(){return new Date().toISOString().substring(0,10)}function qY(n,e=HY){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),gN(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),gN(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class YY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return o6()?Fq().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await WY(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return dN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return dN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function gN(n){return Kx(JSON.stringify({version:2,heartbeats:n})).length}function ZY(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function QY(n){ad(new Au("platform-logger",e=>new uY(e),"PRIVATE")),ad(new Au("heartbeat",e=>new XY(e),"PRIVATE")),el(vb,uN,n),el(vb,uN,"esm2020"),el("fire-js","")}QY("");function f6(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JY=f6,g6=new E1("auth","Firebase",f6());const qx=new VR("@firebase/auth");function eZ(n,...e){qx.logLevel<=yn.WARN&&qx.warn(`Auth (${Id}): ${n}`,...e)}function Y_(n,...e){qx.logLevel<=yn.ERROR&&qx.error(`Auth (${Id}): ${n}`,...e)}function cl(n,...e){throw zR(n,...e)}function po(n,...e){return zR(n,...e)}function UR(n,e,t){const r={...JY(),[e]:t};return new E1("auth","Firebase",r).create(e,{appName:n.name})}function vu(n){return UR(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tZ(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&cl(n,"argument-error"),UR(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function zR(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return g6.create(n,...e)}function Yt(n,e,...t){if(!n)throw zR(e,...t)}function Gl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Y_(e),new Error(e)}function rc(n,e){n||Gl(e)}function Sb(){return typeof self<"u"&&self.location?.href||""}function nZ(){return mN()==="http:"||mN()==="https:"}function mN(){return typeof self<"u"&&self.location?.protocol||null}function rZ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nZ()||Lq()||"connection"in navigator)?navigator.onLine:!0}function iZ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class S1{constructor(e,t){this.shortDelay=e,this.longDelay=t,rc(t>e,"Short delay should be less than long delay!"),this.isMobile=Mq()||Oq()}get(){return rZ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $R(n,e){rc(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class m6{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const sZ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const aZ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],oZ=new S1(3e4,6e4);function NE(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ig(n,e,t,r,i={}){return p6(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=w1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...s};return Nq()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Rd(n.emulatorConfig.host)&&(c.credentials="include"),m6.fetch()(await _6(n,n.config.apiHost,t,o),c)})}async function p6(n,e,t){n._canInitEmulator=!1;const r={...sZ,...e};try{const i=new lZ(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw __(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw __(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw __(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw __(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw UR(n,h,c);cl(n,h)}}catch(i){if(i instanceof pl)throw i;cl(n,"network-request-failed",{message:String(i)})}}async function y6(n,e,t,r,i={}){const s=await ig(n,e,t,r,i);return"mfaPendingCredential"in s&&cl(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function _6(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?$R(n.config,i):`${n.config.apiScheme}://${i}`;return aZ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class lZ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(po(this.auth,"network-request-failed")),oZ.get())})}}function __(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=po(n,e,r);return i.customData._tokenResponse=t,i}async function cZ(n,e){return ig(n,"POST","/v1/accounts:delete",e)}async function Yx(n,e){return ig(n,"POST","/v1/accounts:lookup",e)}function Om(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uZ(n,e=!1){const t=ki(n),r=await t.getIdToken(e),i=WR(r);Yt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Om(XS(i.auth_time)),issuedAtTime:Om(XS(i.iat)),expirationTime:Om(XS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function XS(n){return Number(n)*1e3}function WR(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Y_("JWT malformed, contained fewer than 3 sections"),null;try{const i=ZF(t);return i?JSON.parse(i):(Y_("Failed to decode base64 JWT payload"),null)}catch(i){return Y_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function pN(n){const e=WR(n);return Yt(e,"internal-error"),Yt(typeof e.exp<"u","internal-error"),Yt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ap(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof pl&&hZ(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function hZ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class dZ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Tb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Om(this.lastLoginAt),this.creationTime=Om(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Zx(n){const e=n.auth,t=await n.getIdToken(),r=await Ap(n,Yx(e,{idToken:t}));Yt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?x6(i.providerUserInfo):[],a=gZ(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,c=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Tb(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function fZ(n){const e=ki(n);await Zx(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gZ(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function x6(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mZ(n,e){const t=await p6(n,{},async()=>{const r=w1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await _6(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Rd(n.emulatorConfig.host)&&(l.credentials="include"),m6.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pZ(n,e){return ig(n,"POST","/v2/accounts:revokeToken",NE(n,e))}class u0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Yt(e.idToken,"internal-error"),Yt(typeof e.idToken<"u","internal-error"),Yt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Yt(e.length!==0,"internal-error");const t=pN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Yt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await mZ(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new u0;return r&&(Yt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Yt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Yt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new u0,this.toJSON())}_performRefresh(){return Gl("not implemented")}}function Wc(n,e){Yt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class uo{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new dZ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Tb(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ap(this,this.stsTokenManager.getToken(this.auth,e));return Yt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return uZ(this,e)}reload(){return fZ(this)}_assign(e){this!==e&&(Yt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new uo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Yt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Zx(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(la(this.auth.app))return Promise.reject(vu(this.auth));const e=await this.getIdToken();return await Ap(this,cZ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:y,providerData:x,stsTokenManager:v}=t;Yt(f&&v,e,"internal-error");const E=u0.fromJSON(this.name,v);Yt(typeof f=="string",e,"internal-error"),Wc(r,e.name),Wc(i,e.name),Yt(typeof m=="boolean",e,"internal-error"),Yt(typeof y=="boolean",e,"internal-error"),Wc(s,e.name),Wc(a,e.name),Wc(o,e.name),Wc(l,e.name),Wc(c,e.name),Wc(h,e.name);const T=new uo({uid:f,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:E,createdAt:c,lastLoginAt:h});return x&&Array.isArray(x)&&(T.providerData=x.map(b=>({...b}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new u0;i.updateFromServerResponse(t);const s=new uo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Zx(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Yt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?x6(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new u0;o.updateFromIdToken(r);const l=new uo({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Tb(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const yN=new Map;function Bl(n){rc(n instanceof Function,"Expected a class definition");let e=yN.get(n);return e?(rc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,yN.set(n,e),e)}class v6{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}v6.type="NONE";const _N=v6;function Z_(n,e,t){return`firebase:${n}:${e}:${t}`}class h0{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Z_(this.userKey,i.apiKey,s),this.fullPersistenceKey=Z_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Yx(this.auth,{idToken:e}).catch(()=>{});return t?uo._fromGetAccountInfoResponse(this.auth,t,e):null}return uo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new h0(Bl(_N),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Bl(_N);const a=Z_(r,e.config.apiKey,e.name);let o=null;for(const c of t)try{const h=await c._get(a);if(h){let f;if(typeof h=="string"){const m=await Yx(e,{idToken:h}).catch(()=>{});if(!m)break;f=await uo._fromGetAccountInfoResponse(e,m,h)}else f=uo._fromJSON(e,h);c!==s&&(o=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new h0(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new h0(s,e,r))}}function xN(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(T6(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(E6(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(A6(e))return"Blackberry";if(R6(e))return"Webos";if(w6(e))return"Safari";if((e.includes("chrome/")||S6(e))&&!e.includes("edge/"))return"Chrome";if(b6(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function E6(n=mi()){return/firefox\//i.test(n)}function w6(n=mi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function S6(n=mi()){return/crios\//i.test(n)}function T6(n=mi()){return/iemobile/i.test(n)}function b6(n=mi()){return/android/i.test(n)}function A6(n=mi()){return/blackberry/i.test(n)}function R6(n=mi()){return/webos/i.test(n)}function HR(n=mi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function yZ(n=mi()){return HR(n)&&!!window.navigator?.standalone}function _Z(){return Dq()&&document.documentMode===10}function I6(n=mi()){return HR(n)||b6(n)||R6(n)||A6(n)||/windows phone/i.test(n)||T6(n)}function C6(n,e=[]){let t;switch(n){case"Browser":t=xN(mi());break;case"Worker":t=`${xN(mi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Id}/${r}`}class xZ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function vZ(n,e={}){return ig(n,"GET","/v2/passwordPolicy",NE(n,e))}const EZ=6;class wZ{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??EZ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class SZ{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vN(this),this.idTokenSubscription=new vN(this),this.beforeStateQueue=new xZ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=g6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Bl(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await h0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Yx(this,{idToken:e}),r=await uo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(la(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Yt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Zx(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iZ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(la(this.app))return Promise.reject(vu(this));const t=e?ki(e):null;return t&&Yt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Yt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return la(this.app)?Promise.reject(vu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return la(this.app)?Promise.reject(vu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Bl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vZ(this),t=new wZ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new E1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await pZ(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Bl(e)||this._popupRedirectResolver;Yt(t,this,"argument-error"),this.redirectPersistenceManager=await h0.create(this,[Bl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Yt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Yt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=C6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(la(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&eZ(`Error while retrieving App Check token: ${e.error}`),e?.token}}function T1(n){return ki(n)}class vN{constructor(e){this.auth=e,this.observer=null,this.addObserver=Uq(t=>this.observer=t)}get next(){return Yt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let KR={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TZ(n){KR=n}function bZ(n){return KR.loadJS(n)}function AZ(){return KR.gapiScript}function RZ(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function IZ(n,e){const t=ME(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(sd(s,e??{}))return i;cl(i,"already-initialized")}return t.initialize({options:e})}function CZ(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Bl);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function PZ(n,e,t){const r=T1(n);Yt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=P6(e),{host:a,port:o}=kZ(e),l=o===null?"":`:${o}`,c={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Yt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Yt(sd(c,r.config.emulator)&&sd(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Rd(a)?(FR(`${s}//${a}${l}`),jR("Auth",!0)):MZ()}function P6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function kZ(n){const e=P6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:EN(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:EN(a)}}}function EN(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function MZ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class k6{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gl("not implemented")}_getIdTokenResponse(e){return Gl("not implemented")}_linkToIdToken(e,t){return Gl("not implemented")}_getReauthenticationResolver(e){return Gl("not implemented")}}async function d0(n,e){return y6(n,"POST","/v1/accounts:signInWithIdp",NE(n,e))}const NZ="http://localhost";class od extends k6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new od(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):cl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new od(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return d0(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,d0(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,d0(e,t)}buildRequest(){const e={requestUri:NZ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=w1(t)}return e}}class XR{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class b1 extends XR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class tu extends b1{constructor(){super("facebook.com")}static credential(e){return od._fromParams({providerId:tu.PROVIDER_ID,signInMethod:tu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tu.credentialFromTaggedObject(e)}static credentialFromError(e){return tu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tu.credential(e.oauthAccessToken)}catch{return null}}}tu.FACEBOOK_SIGN_IN_METHOD="facebook.com";tu.PROVIDER_ID="facebook.com";class Vl extends b1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return od._fromParams({providerId:Vl.PROVIDER_ID,signInMethod:Vl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Vl.credentialFromTaggedObject(e)}static credentialFromError(e){return Vl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Vl.credential(t,r)}catch{return null}}}Vl.GOOGLE_SIGN_IN_METHOD="google.com";Vl.PROVIDER_ID="google.com";class nu extends b1{constructor(){super("github.com")}static credential(e){return od._fromParams({providerId:nu.PROVIDER_ID,signInMethod:nu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nu.credentialFromTaggedObject(e)}static credentialFromError(e){return nu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nu.credential(e.oauthAccessToken)}catch{return null}}}nu.GITHUB_SIGN_IN_METHOD="github.com";nu.PROVIDER_ID="github.com";class ru extends b1{constructor(){super("twitter.com")}static credential(e,t){return od._fromParams({providerId:ru.PROVIDER_ID,signInMethod:ru.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ru.credentialFromTaggedObject(e)}static credentialFromError(e){return ru.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ru.credential(t,r)}catch{return null}}}ru.TWITTER_SIGN_IN_METHOD="twitter.com";ru.PROVIDER_ID="twitter.com";async function LZ(n,e){return y6(n,"POST","/v1/accounts:signUp",NE(n,e))}class Ru{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await uo._fromIdTokenResponse(e,r,i),a=wN(r);return new Ru({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=wN(r);return new Ru({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function wN(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function OZ(n){if(la(n.app))return Promise.reject(vu(n));const e=T1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Ru({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await LZ(e,{returnSecureToken:!0}),r=await Ru._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class Qx extends pl{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Qx.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Qx(e,t,r,i)}}function M6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Qx._fromErrorAndOperation(n,s,e,r):s})}async function DZ(n,e,t=!1){const r=await Ap(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ru._forOperation(n,"link",r)}async function FZ(n,e,t=!1){const{auth:r}=n;if(la(r.app))return Promise.reject(vu(r));const i="reauthenticate";try{const s=await Ap(n,M6(r,i,e,n),t);Yt(s.idToken,r,"internal-error");const a=WR(s.idToken);Yt(a,r,"internal-error");const{sub:o}=a;return Yt(n.uid===o,r,"user-mismatch"),Ru._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&cl(r,"user-mismatch"),s}}async function jZ(n,e,t=!1){if(la(n.app))return Promise.reject(vu(n));const r="signIn",i=await M6(n,r,e),s=await Ru._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function VZ(n,e,t,r){return ki(n).onIdTokenChanged(e,t,r)}function GZ(n,e,t){return ki(n).beforeAuthStateChanged(e,t)}function N6(n,e,t,r){return ki(n).onAuthStateChanged(e,t,r)}function L6(n){return ki(n).signOut()}const Jx="__sak";class O6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jx,"1"),this.storage.removeItem(Jx),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const BZ=1e3,UZ=10;class D6 extends O6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=I6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);_Z()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,UZ):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},BZ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}D6.type="LOCAL";const zZ=D6;class F6 extends O6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}F6.type="SESSION";const j6=F6;function $Z(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class LE{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new LE(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async c=>c(t.origin,s)),l=await $Z(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}LE.receivers=[];function qR(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class WZ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=qR("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function tl(){return window}function HZ(n){tl().location.href=n}function V6(){return typeof tl().WorkerGlobalScope<"u"&&typeof tl().importScripts=="function"}async function KZ(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XZ(){return navigator?.serviceWorker?.controller||null}function qZ(){return V6()?self:null}const G6="firebaseLocalStorageDb",YZ=1,ev="firebaseLocalStorage",B6="fbase_key";class A1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function OE(n,e){return n.transaction([ev],e?"readwrite":"readonly").objectStore(ev)}function ZZ(){const n=indexedDB.deleteDatabase(G6);return new A1(n).toPromise()}function bb(){const n=indexedDB.open(G6,YZ);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ev,{keyPath:B6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ev)?e(r):(r.close(),await ZZ(),e(await bb()))})})}async function SN(n,e,t){const r=OE(n,!0).put({[B6]:e,value:t});return new A1(r).toPromise()}async function QZ(n,e){const t=OE(n,!1).get(e),r=await new A1(t).toPromise();return r===void 0?null:r.value}function TN(n,e){const t=OE(n,!0).delete(e);return new A1(t).toPromise()}const JZ=800,eQ=3;class U6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>eQ)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return V6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=LE._getInstance(qZ()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await KZ(),!this.activeServiceWorker)return;this.sender=new WZ(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XZ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await bb();return await SN(e,Jx,"1"),await TN(e,Jx),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>SN(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>QZ(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>TN(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=OE(i,!1).getAll();return new A1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JZ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}U6.type="LOCAL";const tQ=U6;new S1(3e4,6e4);function z6(n,e){return e?Bl(e):(Yt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class YR extends k6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return d0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return d0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return d0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function nQ(n){return jZ(n.auth,new YR(n),n.bypassAuthState)}function rQ(n){const{auth:e,user:t}=n;return Yt(t,e,"internal-error"),FZ(t,new YR(n),n.bypassAuthState)}async function iQ(n){const{auth:e,user:t}=n;return Yt(t,e,"internal-error"),DZ(t,new YR(n),n.bypassAuthState)}class $6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nQ;case"linkViaPopup":case"linkViaRedirect":return iQ;case"reauthViaPopup":case"reauthViaRedirect":return rQ;default:cl(this.auth,"internal-error")}}resolve(e){rc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sQ=new S1(2e3,1e4);async function aQ(n,e,t){if(la(n.app))return Promise.reject(po(n,"operation-not-supported-in-this-environment"));const r=T1(n);tZ(n,e,XR);const i=z6(r,t);return new jh(r,"signInViaPopup",e,i).executeNotNull()}class jh extends $6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,jh.currentPopupAction&&jh.currentPopupAction.cancel(),jh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Yt(e,this.auth,"internal-error"),e}async onExecution(){rc(this.filter.length===1,"Popup operations only handle one event");const e=qR();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(po(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(po(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(po(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sQ.get())};e()}}jh.currentPopupAction=null;const oQ="pendingRedirect",Q_=new Map;class lQ extends $6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Q_.get(this.auth._key());if(!e){try{const r=await cQ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Q_.set(this.auth._key(),e)}return this.bypassAuthState||Q_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cQ(n,e){const t=dQ(e),r=hQ(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function uQ(n,e){Q_.set(n._key(),e)}function hQ(n){return Bl(n._redirectPersistence)}function dQ(n){return Z_(oQ,n.config.apiKey,n.name)}async function fQ(n,e,t=!1){if(la(n.app))return Promise.reject(vu(n));const r=T1(n),i=z6(r,e),a=await new lQ(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const gQ=600*1e3;class mQ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pQ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!W6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(po(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gQ&&this.cachedEventUids.clear(),this.cachedEventUids.has(bN(e))}saveEventToCache(e){this.cachedEventUids.add(bN(e)),this.lastProcessedEventTime=Date.now()}}function bN(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function W6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function pQ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return W6(n);default:return!1}}async function yQ(n,e={}){return ig(n,"GET","/v1/projects",e)}const _Q=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xQ=/^https?/;async function vQ(n){if(n.config.emulator)return;const{authorizedDomains:e}=await yQ(n);for(const t of e)try{if(EQ(t))return}catch{}cl(n,"unauthorized-domain")}function EQ(n){const e=Sb(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!xQ.test(t))return!1;if(_Q.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const wQ=new S1(3e4,6e4);function AN(){const n=tl().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function SQ(n){return new Promise((e,t)=>{function r(){AN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{AN(),t(po(n,"network-request-failed"))},timeout:wQ.get()})}if(tl().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(tl().gapi?.load)r();else{const i=RZ("iframefcb");return tl()[i]=()=>{gapi.load?r():t(po(n,"network-request-failed"))},bZ(`${AZ()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw J_=null,e})}let J_=null;function TQ(n){return J_=J_||SQ(n),J_}const bQ=new S1(5e3,15e3),AQ="__/auth/iframe",RQ="emulator/auth/iframe",IQ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CQ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function PQ(n){const e=n.config;Yt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?$R(e,RQ):`https://${n.config.authDomain}/${AQ}`,r={apiKey:e.apiKey,appName:n.name,v:Id},i=CQ.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${w1(r).slice(1)}`}async function kQ(n){const e=await TQ(n),t=tl().gapi;return Yt(t,n,"internal-error"),e.open({where:document.body,url:PQ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IQ,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=po(n,"network-request-failed"),o=tl().setTimeout(()=>{s(a)},bQ.get());function l(){tl().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const MQ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},NQ=500,LQ=600,OQ="_blank",DQ="http://localhost";class RN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FQ(n,e,t,r=NQ,i=LQ){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...MQ,width:r.toString(),height:i.toString(),top:s,left:a},c=mi().toLowerCase();t&&(o=S6(c)?OQ:t),E6(c)&&(e=e||DQ,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[y,x])=>`${m}${y}=${x},`,"");if(yZ(c)&&o!=="_self")return jQ(e||"",o),new RN(null);const f=window.open(e||"",o,h);Yt(f,n,"popup-blocked");try{f.focus()}catch{}return new RN(f)}function jQ(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const VQ="__/auth/handler",GQ="emulator/auth/handler",BQ=encodeURIComponent("fac");async function IN(n,e,t,r,i,s){Yt(n.config.authDomain,n,"auth-domain-config-required"),Yt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Id,eventId:i};if(e instanceof XR){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Bq(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(e instanceof b1){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),c=l?`#${BQ}=${encodeURIComponent(l)}`:"";return`${UQ(n)}?${w1(o).slice(1)}${c}`}function UQ({config:n}){return n.emulator?$R(n,GQ):`https://${n.authDomain}/${VQ}`}const qS="webStorageSupport";class zQ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=j6,this._completeRedirectFn=fQ,this._overrideRedirectResult=uQ}async _openPopup(e,t,r,i){rc(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await IN(e,t,r,Sb(),i);return FQ(e,s,qR())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await IN(e,t,r,Sb(),i);return HZ(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(rc(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await kQ(e),r=new mQ(e);return t.register("authEvent",i=>(Yt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(qS,{type:qS},i=>{const s=i?.[0]?.[qS];s!==void 0&&t(!!s),cl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=vQ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return I6()||w6()||HR()}}const $Q=zQ;var CN="@firebase/auth",PN="1.12.0";class WQ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Yt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function HQ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KQ(n){ad(new Au("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Yt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:C6(n)},c=new SZ(r,i,s,l);return CZ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ad(new Au("auth-internal",e=>{const t=T1(e.getProvider("auth").getImmediate());return(r=>new WQ(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),el(CN,PN,HQ(n)),el(CN,PN,"esm2020")}const XQ=300,qQ=n6("authIdTokenMaxAge")||XQ;let kN=null;const YQ=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>qQ)return;const i=t?.token;kN!==i&&(kN=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function ZQ(n=BR()){const e=ME(n,"auth");if(e.isInitialized())return e.getImmediate();const t=IZ(n,{popupRedirectResolver:$Q,persistence:[tQ,zZ,j6]}),r=n6("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=YQ(s.toString());GZ(t,a,()=>a(t.currentUser)),VZ(t,o=>a(o))}}const i=JF("auth");return i&&PZ(t,`http://${i}`),t}function QQ(){return document.getElementsByTagName("head")?.[0]??document}TZ({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=po("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",QQ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KQ("Browser");var JQ="firebase",eJ="12.7.0";el(JQ,eJ,"app");var MN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Eu,H6;(function(){var n;function e(P,R){function k(){}k.prototype=R.prototype,P.F=R.prototype,P.prototype=new k,P.prototype.constructor=P,P.D=function(N,O,z){for(var j=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)j[Re-2]=arguments[Re];return R.prototype[O].apply(N,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,R,k){k||(k=0);const N=Array(16);if(typeof R=="string")for(var O=0;O<16;++O)N[O]=R.charCodeAt(k++)|R.charCodeAt(k++)<<8|R.charCodeAt(k++)<<16|R.charCodeAt(k++)<<24;else for(O=0;O<16;++O)N[O]=R[k++]|R[k++]<<8|R[k++]<<16|R[k++]<<24;R=P.g[0],k=P.g[1],O=P.g[2];let z=P.g[3],j;j=R+(z^k&(O^z))+N[0]+3614090360&4294967295,R=k+(j<<7&4294967295|j>>>25),j=z+(O^R&(k^O))+N[1]+3905402710&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(k^z&(R^k))+N[2]+606105819&4294967295,O=z+(j<<17&4294967295|j>>>15),j=k+(R^O&(z^R))+N[3]+3250441966&4294967295,k=O+(j<<22&4294967295|j>>>10),j=R+(z^k&(O^z))+N[4]+4118548399&4294967295,R=k+(j<<7&4294967295|j>>>25),j=z+(O^R&(k^O))+N[5]+1200080426&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(k^z&(R^k))+N[6]+2821735955&4294967295,O=z+(j<<17&4294967295|j>>>15),j=k+(R^O&(z^R))+N[7]+4249261313&4294967295,k=O+(j<<22&4294967295|j>>>10),j=R+(z^k&(O^z))+N[8]+1770035416&4294967295,R=k+(j<<7&4294967295|j>>>25),j=z+(O^R&(k^O))+N[9]+2336552879&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(k^z&(R^k))+N[10]+4294925233&4294967295,O=z+(j<<17&4294967295|j>>>15),j=k+(R^O&(z^R))+N[11]+2304563134&4294967295,k=O+(j<<22&4294967295|j>>>10),j=R+(z^k&(O^z))+N[12]+1804603682&4294967295,R=k+(j<<7&4294967295|j>>>25),j=z+(O^R&(k^O))+N[13]+4254626195&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(k^z&(R^k))+N[14]+2792965006&4294967295,O=z+(j<<17&4294967295|j>>>15),j=k+(R^O&(z^R))+N[15]+1236535329&4294967295,k=O+(j<<22&4294967295|j>>>10),j=R+(O^z&(k^O))+N[1]+4129170786&4294967295,R=k+(j<<5&4294967295|j>>>27),j=z+(k^O&(R^k))+N[6]+3225465664&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^k&(z^R))+N[11]+643717713&4294967295,O=z+(j<<14&4294967295|j>>>18),j=k+(z^R&(O^z))+N[0]+3921069994&4294967295,k=O+(j<<20&4294967295|j>>>12),j=R+(O^z&(k^O))+N[5]+3593408605&4294967295,R=k+(j<<5&4294967295|j>>>27),j=z+(k^O&(R^k))+N[10]+38016083&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^k&(z^R))+N[15]+3634488961&4294967295,O=z+(j<<14&4294967295|j>>>18),j=k+(z^R&(O^z))+N[4]+3889429448&4294967295,k=O+(j<<20&4294967295|j>>>12),j=R+(O^z&(k^O))+N[9]+568446438&4294967295,R=k+(j<<5&4294967295|j>>>27),j=z+(k^O&(R^k))+N[14]+3275163606&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^k&(z^R))+N[3]+4107603335&4294967295,O=z+(j<<14&4294967295|j>>>18),j=k+(z^R&(O^z))+N[8]+1163531501&4294967295,k=O+(j<<20&4294967295|j>>>12),j=R+(O^z&(k^O))+N[13]+2850285829&4294967295,R=k+(j<<5&4294967295|j>>>27),j=z+(k^O&(R^k))+N[2]+4243563512&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^k&(z^R))+N[7]+1735328473&4294967295,O=z+(j<<14&4294967295|j>>>18),j=k+(z^R&(O^z))+N[12]+2368359562&4294967295,k=O+(j<<20&4294967295|j>>>12),j=R+(k^O^z)+N[5]+4294588738&4294967295,R=k+(j<<4&4294967295|j>>>28),j=z+(R^k^O)+N[8]+2272392833&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^k)+N[11]+1839030562&4294967295,O=z+(j<<16&4294967295|j>>>16),j=k+(O^z^R)+N[14]+4259657740&4294967295,k=O+(j<<23&4294967295|j>>>9),j=R+(k^O^z)+N[1]+2763975236&4294967295,R=k+(j<<4&4294967295|j>>>28),j=z+(R^k^O)+N[4]+1272893353&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^k)+N[7]+4139469664&4294967295,O=z+(j<<16&4294967295|j>>>16),j=k+(O^z^R)+N[10]+3200236656&4294967295,k=O+(j<<23&4294967295|j>>>9),j=R+(k^O^z)+N[13]+681279174&4294967295,R=k+(j<<4&4294967295|j>>>28),j=z+(R^k^O)+N[0]+3936430074&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^k)+N[3]+3572445317&4294967295,O=z+(j<<16&4294967295|j>>>16),j=k+(O^z^R)+N[6]+76029189&4294967295,k=O+(j<<23&4294967295|j>>>9),j=R+(k^O^z)+N[9]+3654602809&4294967295,R=k+(j<<4&4294967295|j>>>28),j=z+(R^k^O)+N[12]+3873151461&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^k)+N[15]+530742520&4294967295,O=z+(j<<16&4294967295|j>>>16),j=k+(O^z^R)+N[2]+3299628645&4294967295,k=O+(j<<23&4294967295|j>>>9),j=R+(O^(k|~z))+N[0]+4096336452&4294967295,R=k+(j<<6&4294967295|j>>>26),j=z+(k^(R|~O))+N[7]+1126891415&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~k))+N[14]+2878612391&4294967295,O=z+(j<<15&4294967295|j>>>17),j=k+(z^(O|~R))+N[5]+4237533241&4294967295,k=O+(j<<21&4294967295|j>>>11),j=R+(O^(k|~z))+N[12]+1700485571&4294967295,R=k+(j<<6&4294967295|j>>>26),j=z+(k^(R|~O))+N[3]+2399980690&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~k))+N[10]+4293915773&4294967295,O=z+(j<<15&4294967295|j>>>17),j=k+(z^(O|~R))+N[1]+2240044497&4294967295,k=O+(j<<21&4294967295|j>>>11),j=R+(O^(k|~z))+N[8]+1873313359&4294967295,R=k+(j<<6&4294967295|j>>>26),j=z+(k^(R|~O))+N[15]+4264355552&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~k))+N[6]+2734768916&4294967295,O=z+(j<<15&4294967295|j>>>17),j=k+(z^(O|~R))+N[13]+1309151649&4294967295,k=O+(j<<21&4294967295|j>>>11),j=R+(O^(k|~z))+N[4]+4149444226&4294967295,R=k+(j<<6&4294967295|j>>>26),j=z+(k^(R|~O))+N[11]+3174756917&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~k))+N[2]+718787259&4294967295,O=z+(j<<15&4294967295|j>>>17),j=k+(z^(O|~R))+N[9]+3951481745&4294967295,P.g[0]=P.g[0]+R&4294967295,P.g[1]=P.g[1]+(O+(j<<21&4294967295|j>>>11))&4294967295,P.g[2]=P.g[2]+O&4294967295,P.g[3]=P.g[3]+z&4294967295}r.prototype.v=function(P,R){R===void 0&&(R=P.length);const k=R-this.blockSize,N=this.C;let O=this.h,z=0;for(;z<R;){if(O==0)for(;z<=k;)i(this,P,z),z+=this.blockSize;if(typeof P=="string"){for(;z<R;)if(N[O++]=P.charCodeAt(z++),O==this.blockSize){i(this,N),O=0;break}}else for(;z<R;)if(N[O++]=P[z++],O==this.blockSize){i(this,N),O=0;break}}this.h=O,this.o+=R},r.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var R=1;R<P.length-8;++R)P[R]=0;R=this.o*8;for(var k=P.length-8;k<P.length;++k)P[k]=R&255,R/=256;for(this.v(P),P=Array(16),R=0,k=0;k<4;++k)for(let N=0;N<32;N+=8)P[R++]=this.g[k]>>>N&255;return P};function s(P,R){var k=o;return Object.prototype.hasOwnProperty.call(k,P)?k[P]:k[P]=R(P)}function a(P,R){this.h=R;const k=[];let N=!0;for(let O=P.length-1;O>=0;O--){const z=P[O]|0;N&&z==R||(k[O]=z,N=!1)}this.g=k}var o={};function l(P){return-128<=P&&P<128?s(P,function(R){return new a([R|0],R<0?-1:0)}):new a([P|0],P<0?-1:0)}function c(P){if(isNaN(P)||!isFinite(P))return f;if(P<0)return E(c(-P));const R=[];let k=1;for(let N=0;P>=k;N++)R[N]=P/k|0,k*=4294967296;return new a(R,0)}function h(P,R){if(P.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(P.charAt(0)=="-")return E(h(P.substring(1),R));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=c(Math.pow(R,8));let N=f;for(let z=0;z<P.length;z+=8){var O=Math.min(8,P.length-z);const j=parseInt(P.substring(z,z+O),R);O<8?(O=c(Math.pow(R,O)),N=N.j(O).add(c(j))):(N=N.j(k),N=N.add(c(j)))}return N}var f=l(0),m=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(v(this))return-E(this).m();let P=0,R=1;for(let k=0;k<this.g.length;k++){const N=this.i(k);P+=(N>=0?N:4294967296+N)*R,R*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(x(this))return"0";if(v(this))return"-"+E(this).toString(P);const R=c(Math.pow(P,6));var k=this;let N="";for(;;){const O=M(k,R).g;k=T(k,O.j(R));let z=((k.g.length>0?k.g[0]:k.h)>>>0).toString(P);if(k=O,x(k))return z+N;for(;z.length<6;)z="0"+z;N=z+N}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function x(P){if(P.h!=0)return!1;for(let R=0;R<P.g.length;R++)if(P.g[R]!=0)return!1;return!0}function v(P){return P.h==-1}n.l=function(P){return P=T(this,P),v(P)?-1:x(P)?0:1};function E(P){const R=P.g.length,k=[];for(let N=0;N<R;N++)k[N]=~P.g[N];return new a(k,~P.h).add(m)}n.abs=function(){return v(this)?E(this):this},n.add=function(P){const R=Math.max(this.g.length,P.g.length),k=[];let N=0;for(let O=0;O<=R;O++){let z=N+(this.i(O)&65535)+(P.i(O)&65535),j=(z>>>16)+(this.i(O)>>>16)+(P.i(O)>>>16);N=j>>>16,z&=65535,j&=65535,k[O]=j<<16|z}return new a(k,k[k.length-1]&-2147483648?-1:0)};function T(P,R){return P.add(E(R))}n.j=function(P){if(x(this)||x(P))return f;if(v(this))return v(P)?E(this).j(E(P)):E(E(this).j(P));if(v(P))return E(this.j(E(P)));if(this.l(y)<0&&P.l(y)<0)return c(this.m()*P.m());const R=this.g.length+P.g.length,k=[];for(var N=0;N<2*R;N++)k[N]=0;for(N=0;N<this.g.length;N++)for(let O=0;O<P.g.length;O++){const z=this.i(N)>>>16,j=this.i(N)&65535,Re=P.i(O)>>>16,Ne=P.i(O)&65535;k[2*N+2*O]+=j*Ne,b(k,2*N+2*O),k[2*N+2*O+1]+=z*Ne,b(k,2*N+2*O+1),k[2*N+2*O+1]+=j*Re,b(k,2*N+2*O+1),k[2*N+2*O+2]+=z*Re,b(k,2*N+2*O+2)}for(P=0;P<R;P++)k[P]=k[2*P+1]<<16|k[2*P];for(P=R;P<2*R;P++)k[P]=0;return new a(k,0)};function b(P,R){for(;(P[R]&65535)!=P[R];)P[R+1]+=P[R]>>>16,P[R]&=65535,R++}function A(P,R){this.g=P,this.h=R}function M(P,R){if(x(R))throw Error("division by zero");if(x(P))return new A(f,f);if(v(P))return R=M(E(P),R),new A(E(R.g),E(R.h));if(v(R))return R=M(P,E(R)),new A(E(R.g),R.h);if(P.g.length>30){if(v(P)||v(R))throw Error("slowDivide_ only works with positive integers.");for(var k=m,N=R;N.l(P)<=0;)k=D(k),N=D(N);var O=U(k,1),z=U(N,1);for(N=U(N,2),k=U(k,2);!x(N);){var j=z.add(N);j.l(P)<=0&&(O=O.add(k),z=j),N=U(N,1),k=U(k,1)}return R=T(P,O.j(R)),new A(O,R)}for(O=f;P.l(R)>=0;){for(k=Math.max(1,Math.floor(P.m()/R.m())),N=Math.ceil(Math.log(k)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),z=c(k),j=z.j(R);v(j)||j.l(P)>0;)k-=N,z=c(k),j=z.j(R);x(z)&&(z=m),O=O.add(z),P=T(P,j)}return new A(O,P)}n.B=function(P){return M(this,P).h},n.and=function(P){const R=Math.max(this.g.length,P.g.length),k=[];for(let N=0;N<R;N++)k[N]=this.i(N)&P.i(N);return new a(k,this.h&P.h)},n.or=function(P){const R=Math.max(this.g.length,P.g.length),k=[];for(let N=0;N<R;N++)k[N]=this.i(N)|P.i(N);return new a(k,this.h|P.h)},n.xor=function(P){const R=Math.max(this.g.length,P.g.length),k=[];for(let N=0;N<R;N++)k[N]=this.i(N)^P.i(N);return new a(k,this.h^P.h)};function D(P){const R=P.g.length+1,k=[];for(let N=0;N<R;N++)k[N]=P.i(N)<<1|P.i(N-1)>>>31;return new a(k,P.h)}function U(P,R){const k=R>>5;R%=32;const N=P.g.length-k,O=[];for(let z=0;z<N;z++)O[z]=R>0?P.i(z+k)>>>R|P.i(z+k+1)<<32-R:P.i(z+k);return new a(O,P.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,H6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,Eu=a}).apply(typeof MN<"u"?MN:typeof self<"u"?self:typeof window<"u"?window:{});var x_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var K6,xm,X6,ex,Ab,q6,Y6,Z6;(function(){var n,e=Object.defineProperty;function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof x_=="object"&&x_];for(var C=0;C<_.length;++C){var F=_[C];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var r=t(this);function i(_,C){if(C)e:{var F=r;_=_.split(".");for(var H=0;H<_.length-1;H++){var pe=_[H];if(!(pe in F))break e;F=F[pe]}_=_[_.length-1],H=F[_],C=C(H),C!=H&&C!=null&&e(F,_,{configurable:!0,writable:!0,value:C})}}i("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(_){return _||function(C){var F=[],H;for(H in C)Object.prototype.hasOwnProperty.call(C,H)&&F.push([H,C[H]]);return F}});var s=s||{},a=this||self;function o(_){var C=typeof _;return C=="object"&&_!=null||C=="function"}function l(_,C,F){return _.call.apply(_.bind,arguments)}function c(_,C,F){return c=l,c.apply(null,arguments)}function h(_,C){var F=Array.prototype.slice.call(arguments,1);return function(){var H=F.slice();return H.push.apply(H,arguments),_.apply(this,H)}}function f(_,C){function F(){}F.prototype=C.prototype,_.Z=C.prototype,_.prototype=new F,_.prototype.constructor=_,_.Ob=function(H,pe,ke){for(var it=Array(arguments.length-2),en=2;en<arguments.length;en++)it[en-2]=arguments[en];return C.prototype[pe].apply(H,it)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function y(_){const C=_.length;if(C>0){const F=Array(C);for(let H=0;H<C;H++)F[H]=_[H];return F}return[]}function x(_,C){for(let H=1;H<arguments.length;H++){const pe=arguments[H];var F=typeof pe;if(F=F!="object"?F:pe?Array.isArray(pe)?"array":F:"null",F=="array"||F=="object"&&typeof pe.length=="number"){F=_.length||0;const ke=pe.length||0;_.length=F+ke;for(let it=0;it<ke;it++)_[F+it]=pe[it]}else _.push(pe)}}class v{constructor(C,F){this.i=C,this.j=F,this.h=0,this.g=null}get(){let C;return this.h>0?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function E(_){a.setTimeout(()=>{throw _},0)}function T(){var _=P;let C=null;return _.g&&(C=_.g,_.g=_.g.next,_.g||(_.h=null),C.next=null),C}class b{constructor(){this.h=this.g=null}add(C,F){const H=A.get();H.set(C,F),this.h?this.h.next=H:this.g=H,this.h=H}}var A=new v(()=>new M,_=>_.reset());class M{constructor(){this.next=this.g=this.h=null}set(C,F){this.h=C,this.g=F,this.next=null}reset(){this.next=this.g=this.h=null}}let D,U=!1,P=new b,R=()=>{const _=Promise.resolve(void 0);D=()=>{_.then(k)}};function k(){for(var _;_=T();){try{_.h.call(_.g)}catch(F){E(F)}var C=A;C.j(_),C.h<100&&(C.h++,_.next=C.g,C.g=_)}U=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(_,C){this.type=_,this.g=this.target=C,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,C=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const F=()=>{};a.addEventListener("test",F,C),a.removeEventListener("test",F,C)}catch{}return _})();function j(_){return/^[\s\xa0]*$/.test(_)}function Re(_,C){O.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,C)}f(Re,O),Re.prototype.init=function(_,C){const F=this.type=_.type,H=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=C,C=_.relatedTarget,C||(F=="mouseover"?C=_.fromElement:F=="mouseout"&&(C=_.toElement)),this.relatedTarget=C,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&Re.Z.h.call(this)},Re.prototype.h=function(){Re.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Ne="closure_listenable_"+(Math.random()*1e6|0),Ve=0;function Oe(_,C,F,H,pe){this.listener=_,this.proxy=null,this.src=C,this.type=F,this.capture=!!H,this.ha=pe,this.key=++Ve,this.da=this.fa=!1}function ce(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function we(_,C,F){for(const H in _)C.call(F,_[H],H,_)}function Se(_,C){for(const F in _)C.call(void 0,_[F],F,_)}function se(_){const C={};for(const F in _)C[F]=_[F];return C}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(_,C){let F,H;for(let pe=1;pe<arguments.length;pe++){H=arguments[pe];for(F in H)_[F]=H[F];for(let ke=0;ke<V.length;ke++)F=V[ke],Object.prototype.hasOwnProperty.call(H,F)&&(_[F]=H[F])}}function ne(_){this.src=_,this.g={},this.h=0}ne.prototype.add=function(_,C,F,H,pe){const ke=_.toString();_=this.g[ke],_||(_=this.g[ke]=[],this.h++);const it=me(_,C,H,pe);return it>-1?(C=_[it],F||(C.fa=!1)):(C=new Oe(C,this.src,ke,!!H,pe),C.fa=F,_.push(C)),C};function ie(_,C){const F=C.type;if(F in _.g){var H=_.g[F],pe=Array.prototype.indexOf.call(H,C,void 0),ke;(ke=pe>=0)&&Array.prototype.splice.call(H,pe,1),ke&&(ce(C),_.g[F].length==0&&(delete _.g[F],_.h--))}}function me(_,C,F,H){for(let pe=0;pe<_.length;++pe){const ke=_[pe];if(!ke.da&&ke.listener==C&&ke.capture==!!F&&ke.ha==H)return pe}return-1}var Ce="closure_lm_"+(Math.random()*1e6|0),Fe={};function fe(_,C,F,H,pe){if(Array.isArray(C)){for(let ke=0;ke<C.length;ke++)fe(_,C[ke],F,H,pe);return null}return F=nr(F),_&&_[Ne]?_.J(C,F,o(H)?!!H.capture:!1,pe):le(_,C,F,!1,H,pe)}function le(_,C,F,H,pe,ke){if(!C)throw Error("Invalid event type");const it=o(pe)?!!pe.capture:!!pe;let en=tn(_);if(en||(_[Ce]=en=new ne(_)),F=en.add(C,F,H,it,ke),F.proxy)return F;if(H=yt(),F.proxy=H,H.src=_,H.listener=F,_.addEventListener)z||(pe=it),pe===void 0&&(pe=!1),_.addEventListener(C.toString(),H,pe);else if(_.attachEvent)_.attachEvent(kt(C.toString()),H);else if(_.addListener&&_.removeListener)_.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return F}function yt(){function _(F){return C.call(_.src,_.listener,F)}const C=Dn;return _}function St(_,C,F,H,pe){if(Array.isArray(C))for(var ke=0;ke<C.length;ke++)St(_,C[ke],F,H,pe);else H=o(H)?!!H.capture:!!H,F=nr(F),_&&_[Ne]?(_=_.i,ke=String(C).toString(),ke in _.g&&(C=_.g[ke],F=me(C,F,H,pe),F>-1&&(ce(C[F]),Array.prototype.splice.call(C,F,1),C.length==0&&(delete _.g[ke],_.h--)))):_&&(_=tn(_))&&(C=_.g[C.toString()],_=-1,C&&(_=me(C,F,H,pe)),(F=_>-1?C[_]:null)&&ln(F))}function ln(_){if(typeof _!="number"&&_&&!_.da){var C=_.src;if(C&&C[Ne])ie(C.i,_);else{var F=_.type,H=_.proxy;C.removeEventListener?C.removeEventListener(F,H,_.capture):C.detachEvent?C.detachEvent(kt(F),H):C.addListener&&C.removeListener&&C.removeListener(H),(F=tn(C))?(ie(F,_),F.h==0&&(F.src=null,C[Ce]=null)):ce(_)}}}function kt(_){return _ in Fe?Fe[_]:Fe[_]="on"+_}function Dn(_,C){if(_.da)_=!0;else{C=new Re(C,this);const F=_.listener,H=_.ha||_.src;_.fa&&ln(_),_=F.call(H,C)}return _}function tn(_){return _=_[Ce],_ instanceof ne?_:null}var lt="__closure_events_fn_"+(Math.random()*1e9>>>0);function nr(_){return typeof _=="function"?_:(_[lt]||(_[lt]=function(C){return _.handleEvent(C)}),_[lt])}function hn(){N.call(this),this.i=new ne(this),this.M=this,this.G=null}f(hn,N),hn.prototype[Ne]=!0,hn.prototype.removeEventListener=function(_,C,F,H){St(this,_,C,F,H)};function rn(_,C){var F,H=_.G;if(H)for(F=[];H;H=H.G)F.push(H);if(_=_.M,H=C.type||C,typeof C=="string")C=new O(C,_);else if(C instanceof O)C.target=C.target||_;else{var pe=C;C=new O(H,_),Q(C,pe)}pe=!0;let ke,it;if(F)for(it=F.length-1;it>=0;it--)ke=C.g=F[it],pe=rr(ke,H,!0,C)&&pe;if(ke=C.g=_,pe=rr(ke,H,!0,C)&&pe,pe=rr(ke,H,!1,C)&&pe,F)for(it=0;it<F.length;it++)ke=C.g=F[it],pe=rr(ke,H,!1,C)&&pe}hn.prototype.N=function(){if(hn.Z.N.call(this),this.i){var _=this.i;for(const C in _.g){const F=_.g[C];for(let H=0;H<F.length;H++)ce(F[H]);delete _.g[C],_.h--}}this.G=null},hn.prototype.J=function(_,C,F,H){return this.i.add(String(_),C,!1,F,H)},hn.prototype.K=function(_,C,F,H){return this.i.add(String(_),C,!0,F,H)};function rr(_,C,F,H){if(C=_.i.g[String(C)],!C)return!0;C=C.concat();let pe=!0;for(let ke=0;ke<C.length;++ke){const it=C[ke];if(it&&!it.da&&it.capture==F){const en=it.listener,Ur=it.ha||it.src;it.fa&&ie(_.i,it),pe=en.call(Ur,H)!==!1&&pe}}return pe&&!H.defaultPrevented}function mt(_,C){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=c(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(C)>2147483647?-1:a.setTimeout(_,C||0)}function Ut(_){_.g=mt(()=>{_.g=null,_.i&&(_.i=!1,Ut(_))},_.l);const C=_.h;_.h=null,_.m.apply(null,C)}class Fn extends N{constructor(C,F){super(),this.m=C,this.l=F,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:Ut(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xt(_){N.call(this),this.h=_,this.g={}}f(xt,N);var nn=[];function Nt(_){we(_.g,function(C,F){this.g.hasOwnProperty(F)&&ln(C)},_),_.g={}}xt.prototype.N=function(){xt.Z.N.call(this),Nt(this)},xt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cr=a.JSON.stringify,_i=a.JSON.parse,Kr=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function Wt(){}function fs(){}var je={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function be(){O.call(this,"d")}f(be,O);function _e(){O.call(this,"c")}f(_e,O);var Lt={},L=null;function Ot(){return L=L||new hn}Lt.Ia="serverreachability";function W(_){O.call(this,Lt.Ia,_)}f(W,O);function Z(_){const C=Ot();rn(C,new W(C))}Lt.STAT_EVENT="statevent";function Y(_,C){O.call(this,Lt.STAT_EVENT,_),this.stat=C}f(Y,O);function ue(_){const C=Ot();rn(C,new Y(C,_))}Lt.Ja="timingevent";function he(_,C){O.call(this,Lt.Ja,_),this.size=C}f(he,O);function Be(_,C){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},C)}function Ie(){this.g=!0}Ie.prototype.ua=function(){this.g=!1};function $e(_,C,F,H,pe,ke){_.info(function(){if(_.g)if(ke){var it="",en=ke.split("&");for(let $n=0;$n<en.length;$n++){var Ur=en[$n].split("=");if(Ur.length>1){const Xr=Ur[0];Ur=Ur[1];const Qs=Xr.split("_");it=Qs.length>=2&&Qs[1]=="type"?it+(Xr+"="+Ur+"&"):it+(Xr+"=redacted&")}}}else it=null;else it=ke;return"XMLHTTP REQ ("+H+") [attempt "+pe+"]: "+C+`
`+F+`
`+it})}function et(_,C,F,H,pe,ke,it){_.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+pe+"]: "+C+`
`+F+`
`+ke+" "+it})}function ft(_,C,F,H){_.info(function(){return"XMLHTTP TEXT ("+C+"): "+cn(_,F)+(H?" "+H:"")})}function Rt(_,C){_.info(function(){return"TIMEOUT: "+C})}Ie.prototype.info=function(){};function cn(_,C){if(!_.g)return C;if(!C)return null;try{const ke=JSON.parse(C);if(ke){for(_=0;_<ke.length;_++)if(Array.isArray(ke[_])){var F=ke[_];if(!(F.length<2)){var H=F[1];if(Array.isArray(H)&&!(H.length<1)){var pe=H[0];if(pe!="noop"&&pe!="stop"&&pe!="close")for(let it=1;it<H.length;it++)H[it]=""}}}}return cr(ke)}catch{return C}}var mr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},pr;function Tr(){}f(Tr,Wt),Tr.prototype.g=function(){return new XMLHttpRequest},pr=new Tr;function Ki(_){return encodeURIComponent(String(_))}function B(_){var C=1;_=_.split(":");const F=[];for(;C>0&&_.length;)F.push(_.shift()),C--;return _.length&&F.push(_.join(":")),F}function J(_,C,F,H){this.j=_,this.i=C,this.l=F,this.S=H||1,this.V=new xt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var q={},ee={};function te(_,C,F){_.M=1,_.A=_l(_a(C)),_.u=F,_.R=!0,ve(_,null)}function ve(_,C){_.F=Date.now(),Ae(_),_.B=_a(_.A);var F=_.B,H=_.S;Array.isArray(H)||(H=[String(H)]),Sg(F.i,"t",H),_.C=0,F=_.j.L,_.h=new K,_.g=oy(_.j,F?C:null,!_.u),_.P>0&&(_.O=new Fn(c(_.Y,_,_.g),_.P)),C=_.V,F=_.g,H=_.ba;var pe="readystatechange";Array.isArray(pe)||(pe&&(nn[0]=pe.toString()),pe=nn);for(let ke=0;ke<pe.length;ke++){const it=fe(F,pe[ke],H||C.handleEvent,!1,C.h||C);if(!it)break;C.g[it.key]=it}C=_.J?se(_.J):{},_.u?(_.v||(_.v="POST"),C["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,C)):(_.v="GET",_.g.ea(_.B,_.v,null,C)),Z(),$e(_.i,_.v,_.B,_.l,_.S,_.u)}J.prototype.ba=function(_){_=_.target;const C=this.O;C&&ko(_)==3?C.j():this.Y(_)},J.prototype.Y=function(_){try{if(_==this.g)e:{const en=ko(this.g),Ur=this.g.ya(),$n=this.g.ca();if(!(en<3)&&(en!=3||this.g&&(this.h.h||this.g.la()||sy(this.g)))){this.K||en!=4||Ur==7||(Ur==8||$n<=0?Z(3):Z(2)),tt(this);var C=this.g.ca();this.X=C;var F=Le(this);if(this.o=C==200,et(this.i,this.v,this.B,this.l,this.S,en,C),this.o){if(this.U&&!this.L){t:{if(this.g){var H,pe=this.g;if((H=pe.g?pe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var ke=H;break t}}ke=null}if(_=ke)ft(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qe(this,_);else{this.o=!1,this.m=3,ue(12),Xe(this),gt(this);break e}}if(this.R){_=!0;let Xr;for(;!this.K&&this.C<F.length;)if(Xr=Te(this,F),Xr==ee){en==4&&(this.m=4,ue(14),_=!1),ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Xr==q){this.m=4,ue(15),ft(this.i,this.l,F,"[Invalid Chunk]"),_=!1;break}else ft(this.i,this.l,Xr,null),qe(this,Xr);if(xe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),en!=4||F.length!=0||this.h.h||(this.m=1,ue(16),_=!1),this.o=this.o&&_,!_)ft(this.i,this.l,F,"[Invalid Chunked Response]"),Xe(this),gt(this);else if(F.length>0&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.aa&&!it.P&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),eh(it),it.P=!0,ue(11))}}else ft(this.i,this.l,F,null),qe(this,F);en==4&&Xe(this),this.o&&!this.K&&(en==4?Hd(this.j,this):(this.o=!1,Ae(this)))}else bg(this.g),C==400&&F.indexOf("Unknown SID")>0?(this.m=3,ue(12)):(this.m=0,ue(13)),Xe(this),gt(this)}}}catch{}};function Le(_){if(!xe(_))return _.g.la();const C=sy(_.g);if(C==="")return"";let F="";const H=C.length,pe=ko(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return Xe(_),gt(_),"";_.h.i=new a.TextDecoder}for(let ke=0;ke<H;ke++)_.h.h=!0,F+=_.h.i.decode(C[ke],{stream:!(pe&&ke==H-1)});return C.length=0,_.h.g+=F,_.C=0,_.h.g}function xe(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function Te(_,C){var F=_.C,H=C.indexOf(`
`,F);return H==-1?ee:(F=Number(C.substring(F,H)),isNaN(F)?q:(H+=1,H+F>C.length?ee:(C=C.slice(H,H+F),_.C=H+F,C)))}J.prototype.cancel=function(){this.K=!0,Xe(this)};function Ae(_){_.T=Date.now()+_.H,Ke(_,_.H)}function Ke(_,C){if(_.D!=null)throw Error("WatchDog timer not null");_.D=Be(c(_.aa,_),C)}function tt(_){_.D&&(a.clearTimeout(_.D),_.D=null)}J.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(Rt(this.i,this.B),this.M!=2&&(Z(),ue(17)),Xe(this),this.m=2,gt(this)):Ke(this,this.T-_)};function gt(_){_.j.I==0||_.K||Hd(_.j,_)}function Xe(_){tt(_);var C=_.O;C&&typeof C.dispose=="function"&&C.dispose(),_.O=null,Nt(_.V),_.g&&(C=_.g,_.g=null,C.abort(),C.dispose())}function qe(_,C){try{var F=_.j;if(F.I!=0&&(F.g==_||Ha(F.h,_))){if(!_.L&&Ha(F.h,_)&&F.I==3){try{var H=F.Ba.g.parse(C)}catch{H=null}if(Array.isArray(H)&&H.length==3){var pe=H;if(pe[0]==0){e:if(!F.v){if(F.g)if(F.g.F+3e3<_.F)Wd(F),Ys(F);else break e;Lo(F),ue(18)}}else F.xa=pe[1],0<F.xa-F.K&&pe[2]<37500&&F.F&&F.A==0&&!F.C&&(F.C=Be(c(F.Va,F),6e3));yr(F.h)<=1&&F.ta&&(F.ta=void 0)}else Zs(F,11)}else if((_.L||F.g==_)&&Wd(F),!j(C))for(pe=F.Ba.g.parse(C),C=0;C<pe.length;C++){let $n=pe[C];const Xr=$n[0];if(!(Xr<=F.K))if(F.K=Xr,$n=$n[1],F.I==2)if($n[0]=="c"){F.M=$n[1],F.ba=$n[2];const Qs=$n[3];Qs!=null&&(F.ka=Qs,F.j.info("VER="+F.ka));const Sl=$n[4];Sl!=null&&(F.za=Sl,F.j.info("SVER="+F.za));const Oo=$n[5];Oo!=null&&typeof Oo=="number"&&Oo>0&&(H=1.5*Oo,F.O=H,F.j.info("backChannelRequestTimeoutMs_="+H)),H=F;const Do=_.g;if(Do){const qd=Do.g?Do.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qd){var ke=H.h;ke.g||qd.indexOf("spdy")==-1&&qd.indexOf("quic")==-1&&qd.indexOf("h2")==-1||(ke.j=ke.l,ke.g=new Set,ke.h&&(ya(ke,ke.h),ke.h=null))}if(H.G){const Ig=Do.g?Do.g.getResponseHeader("X-HTTP-Session-Id"):null;Ig&&(H.wa=Ig,Pn(H.J,H.G,Ig))}}F.I=3,F.l&&F.l.ra(),F.aa&&(F.T=Date.now()-_.F,F.j.info("Handshake RTT: "+F.T+"ms")),H=F;var it=_;if(H.na=Rg(H,H.L?H.ba:null,H.W),it.L){Xs(H.h,it);var en=it,Ur=H.O;Ur&&(en.H=Ur),en.D&&(tt(en),Ae(en)),H.g=it}else Xi(H);F.i.length>0&&wl(F)}else $n[0]!="stop"&&$n[0]!="close"||Zs(F,7);else F.I==3&&($n[0]=="stop"||$n[0]=="close"?$n[0]=="stop"?Zs(F,7):zd(F):$n[0]!="noop"&&F.l&&F.l.qa($n),F.A=0)}}Z(4)}catch{}}var Ht=class{constructor(_,C){this.g=_,this.map=C}};function jn(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zn(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function yr(_){return _.h?1:_.g?_.g.size:0}function Ha(_,C){return _.h?_.h==C:_.g?_.g.has(C):!1}function ya(_,C){_.g?_.g.add(C):_.h=C}function Xs(_,C){_.h&&_.h==C?_.h=null:_.g&&_.g.has(C)&&_.g.delete(C)}jn.prototype.cancel=function(){if(this.i=Br(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Br(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let C=_.i;for(const F of _.g.values())C=C.concat(F.G);return C}return y(_.i)}var xc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function br(_,C){if(_){_=_.split("&");for(let F=0;F<_.length;F++){const H=_[F].indexOf("=");let pe,ke=null;H>=0?(pe=_[F].substring(0,H),ke=_[F].substring(H+1)):pe=_[F],C(pe,ke?decodeURIComponent(ke.replace(/\+/g," ")):"")}}}function bo(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let C;_ instanceof bo?(this.l=_.l,Xu(this,_.j),this.o=_.o,this.g=_.g,Ao(this,_.u),this.h=_.h,vc(this,Tg(_.i)),this.m=_.m):_&&(C=String(_).match(xc))?(this.l=!1,Xu(this,C[1]||"",!0),this.o=qu(C[2]||""),this.g=qu(C[3]||"",!0),Ao(this,C[4]),this.h=qu(C[5]||"",!0),vc(this,C[6]||"",!0),this.m=qu(C[7]||"")):(this.l=!1,this.i=new vn(null,this.l))}bo.prototype.toString=function(){const _=[];var C=this.j;C&&_.push(Yu(C,_g,!0),":");var F=this.g;return(F||C=="file")&&(_.push("//"),(C=this.o)&&_.push(Yu(C,_g,!0),"@"),_.push(Ki(F).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),F=this.u,F!=null&&_.push(":",String(F))),(F=this.h)&&(this.g&&F.charAt(0)!="/"&&_.push("/"),_.push(Yu(F,F.charAt(0)=="/"?Zu:xg,!0))),(F=this.i.toString())&&_.push("?",F),(F=this.m)&&_.push("#",Yu(F,vg)),_.join("")},bo.prototype.resolve=function(_){const C=_a(this);let F=!!_.j;F?Xu(C,_.j):F=!!_.o,F?C.o=_.o:F=!!_.g,F?C.g=_.g:F=_.u!=null;var H=_.h;if(F)Ao(C,_.u);else if(F=!!_.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var pe=C.h.lastIndexOf("/");pe!=-1&&(H=C.h.slice(0,pe+1)+H)}if(pe=H,pe==".."||pe==".")H="";else if(pe.indexOf("./")!=-1||pe.indexOf("/.")!=-1){H=pe.lastIndexOf("/",0)==0,pe=pe.split("/");const ke=[];for(let it=0;it<pe.length;){const en=pe[it++];en=="."?H&&it==pe.length&&ke.push(""):en==".."?((ke.length>1||ke.length==1&&ke[0]!="")&&ke.pop(),H&&it==pe.length&&ke.push("")):(ke.push(en),H=!0)}H=ke.join("/")}else H=pe}return F?C.h=H:F=_.i.toString()!=="",F?vc(C,Tg(_.i)):F=!!_.m,F&&(C.m=_.m),C};function _a(_){return new bo(_)}function Xu(_,C,F){_.j=F?qu(C,!0):C,_.j&&(_.j=_.j.replace(/:$/,""))}function Ao(_,C){if(C){if(C=Number(C),isNaN(C)||C<0)throw Error("Bad port number "+C);_.u=C}else _.u=null}function vc(_,C,F){C instanceof vn?(_.i=C,Gd(_.i,_.l)):(F||(C=Yu(C,kw)),_.i=new vn(C,_.l))}function Pn(_,C,F){_.i.set(C,F)}function _l(_){return Pn(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function qu(_,C){return _?C?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Yu(_,C,F){return typeof _=="string"?(_=encodeURI(_).replace(C,yg),F&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function yg(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var _g=/[#\/\?@]/g,xg=/[#\?:]/g,Zu=/[#\?]/g,kw=/[#\?@]/g,vg=/#/g;function vn(_,C){this.h=this.g=null,this.i=_||null,this.j=!!C}function Ro(_){_.g||(_.g=new Map,_.h=0,_.i&&br(_.i,function(C,F){_.add(decodeURIComponent(C.replace(/\+/g," ")),F)}))}n=vn.prototype,n.add=function(_,C){Ro(this),this.i=null,_=Io(this,_);let F=this.g.get(_);return F||this.g.set(_,F=[]),F.push(C),this.h+=1,this};function Eg(_,C){Ro(_),C=Io(_,C),_.g.has(C)&&(_.i=null,_.h-=_.g.get(C).length,_.g.delete(C))}function Vd(_,C){return Ro(_),C=Io(_,C),_.g.has(C)}n.forEach=function(_,C){Ro(this),this.g.forEach(function(F,H){F.forEach(function(pe){_.call(C,pe,H,this)},this)},this)};function wg(_,C){Ro(_);let F=[];if(typeof C=="string")Vd(_,C)&&(F=F.concat(_.g.get(Io(_,C))));else for(_=Array.from(_.g.values()),C=0;C<_.length;C++)F=F.concat(_[C]);return F}n.set=function(_,C){return Ro(this),this.i=null,_=Io(this,_),Vd(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[C]),this.h+=1,this},n.get=function(_,C){return _?(_=wg(this,_),_.length>0?String(_[0]):C):C};function Sg(_,C,F){Eg(_,C),F.length>0&&(_.i=null,_.g.set(Io(_,C),y(F)),_.h+=F.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],C=Array.from(this.g.keys());for(let H=0;H<C.length;H++){var F=C[H];const pe=Ki(F);F=wg(this,F);for(let ke=0;ke<F.length;ke++){let it=pe;F[ke]!==""&&(it+="="+Ki(F[ke])),_.push(it)}}return this.i=_.join("&")};function Tg(_){const C=new vn;return C.i=_.i,_.g&&(C.g=new Map(_.g),C.h=_.h),C}function Io(_,C){return C=String(C),_.j&&(C=C.toLowerCase()),C}function Gd(_,C){C&&!_.j&&(Ro(_),_.i=null,_.g.forEach(function(F,H){const pe=H.toLowerCase();H!=pe&&(Eg(this,H),Sg(this,pe,F))},_)),_.j=C}function Co(_,C){const F=new Ie;if(a.Image){const H=new Image;H.onload=h(Mi,F,"TestLoadImage: loaded",!0,C,H),H.onerror=h(Mi,F,"TestLoadImage: error",!1,C,H),H.onabort=h(Mi,F,"TestLoadImage: abort",!1,C,H),H.ontimeout=h(Mi,F,"TestLoadImage: timeout",!1,C,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=_}else C(!1)}function Po(_,C){const F=new Ie,H=new AbortController,pe=setTimeout(()=>{H.abort(),Mi(F,"TestPingServer: timeout",!1,C)},1e4);fetch(_,{signal:H.signal}).then(ke=>{clearTimeout(pe),ke.ok?Mi(F,"TestPingServer: ok",!0,C):Mi(F,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(pe),Mi(F,"TestPingServer: error",!1,C)})}function Mi(_,C,F,H,pe){try{pe&&(pe.onload=null,pe.onerror=null,pe.onabort=null,pe.ontimeout=null),H(F)}catch{}}function Qu(){this.g=new Kr}function xl(_){this.i=_.Sb||null,this.h=_.ab||!1}f(xl,Wt),xl.prototype.g=function(){return new qs(this.i,this.h)};function qs(_,C){hn.call(this),this.H=_,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(qs,hn),n=qs.prototype,n.open=function(_,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=C,this.readyState=1,Ka(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const C={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(C.body=_),(this.H||a).fetch(new Request(this.D,C)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ec(this)),this.readyState=0},n.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,Ka(this)),this.g&&(this.readyState=3,Ka(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ny(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function ny(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}n.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var C=_.value?_.value:new Uint8Array(0);(C=this.B.decode(C,{stream:!_.done}))&&(this.response=this.responseText+=C)}_.done?Ec(this):Ka(this),this.readyState==3&&ny(this)}},n.Oa=function(_){this.g&&(this.response=this.responseText=_,Ec(this))},n.Na=function(_){this.g&&(this.response=_,Ec(this))},n.ga=function(){this.g&&Ec(this)};function Ec(_){_.readyState=4,_.l=null,_.j=null,_.B=null,Ka(_)}n.setRequestHeader=function(_,C){this.A.append(_,C)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],C=this.h.entries();for(var F=C.next();!F.done;)F=F.value,_.push(F[0]+": "+F[1]),F=C.next();return _.join(`\r
`)};function Ka(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(qs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function ry(_){let C="";return we(_,function(F,H){C+=H,C+=":",C+=F,C+=`\r
`}),C}function Bd(_,C,F){e:{for(H in F){var H=!1;break e}H=!0}H||(F=ry(F),typeof _=="string"?F!=null&&Ki(F):Pn(_,C,F))}function ir(_){hn.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ir,hn);var iy=/^https?$/i,Mw=["POST","PUT"];n=ir.prototype,n.Fa=function(_){this.H=_},n.ea=function(_,C,F,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);C=C?C.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():pr.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(C,String(_),!0),this.B=!1}catch(ke){wc(this,ke);return}if(_=F||"",F=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var pe in H)F.set(pe,H[pe]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const ke of H.keys())F.set(ke,H.get(ke));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(F.keys()).find(ke=>ke.toLowerCase()=="content-type"),pe=a.FormData&&_ instanceof a.FormData,!(Array.prototype.indexOf.call(Mw,C,void 0)>=0)||H||pe||F.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ke,it]of F)this.g.setRequestHeader(ke,it);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(ke){wc(this,ke)}};function wc(_,C){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=C,_.o=5,Sc(_),El(_)}function Sc(_){_.A||(_.A=!0,rn(_,"complete"),rn(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,rn(this,"complete"),rn(this,"abort"),El(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),El(this,!0)),ir.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vl(this):this.Xa())},n.Xa=function(){vl(this)};function vl(_){if(_.h&&typeof s<"u"){if(_.v&&ko(_)==4)setTimeout(_.Ca.bind(_),0);else if(rn(_,"readystatechange"),ko(_)==4){_.h=!1;try{const ke=_.ca();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var F;if(!(F=C)){var H;if(H=ke===0){let it=String(_.D).match(xc)[1]||null;!it&&a.self&&a.self.location&&(it=a.self.location.protocol.slice(0,-1)),H=!iy.test(it?it.toLowerCase():"")}F=H}if(F)rn(_,"complete"),rn(_,"success");else{_.o=6;try{var pe=ko(_)>2?_.g.statusText:""}catch{pe=""}_.l=pe+" ["+_.ca()+"]",Sc(_)}}finally{El(_)}}}}function El(_,C){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const F=_.g;_.g=null,C||rn(_,"ready");try{F.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ko(_){return _.g?_.g.readyState:0}n.ca=function(){try{return ko(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(_){if(this.g){var C=this.g.responseText;return _&&C.indexOf(_)==0&&(C=C.substring(_.length)),_i(C)}};function sy(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function bg(_){const C={};_=(_.g&&ko(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<_.length;H++){if(j(_[H]))continue;var F=B(_[H]);const pe=F[0];if(F=F[1],typeof F!="string")continue;F=F.trim();const ke=C[pe]||[];C[pe]=ke,ke.push(F)}Se(C,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mo(_,C,F){return F&&F.internalChannelParams&&F.internalChannelParams[_]||C}function Ud(_){this.za=0,this.i=[],this.j=new Ie,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Mo("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Mo("baseRetryDelayMs",5e3,_),this.Za=Mo("retryDelaySeedMs",1e4,_),this.Ta=Mo("forwardChannelMaxRetries",2,_),this.va=Mo("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new jn(_&&_.concurrentRequestLimit),this.Ba=new Qu,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ud.prototype,n.ka=8,n.I=1,n.connect=function(_,C,F,H){ue(0),this.W=_,this.H=C||{},F&&H!==void 0&&(this.H.OSID=F,this.H.OAID=H),this.F=this.X,this.J=Rg(this,null,this.W),wl(this)};function zd(_){if($d(_),_.I==3){var C=_.V++,F=_a(_.J);if(Pn(F,"SID",_.M),Pn(F,"RID",C),Pn(F,"TYPE","terminate"),No(_,F),C=new J(_,_.j,C),C.M=2,C.A=_l(_a(F)),F=!1,a.navigator&&a.navigator.sendBeacon)try{F=a.navigator.sendBeacon(C.A.toString(),"")}catch{}!F&&a.Image&&(new Image().src=C.A,F=!0),F||(C.g=oy(C.j,null),C.g.ea(C.A)),C.F=Date.now(),Ae(C)}th(_)}function Ys(_){_.g&&(eh(_),_.g.cancel(),_.g=null)}function $d(_){Ys(_),_.v&&(a.clearTimeout(_.v),_.v=null),Wd(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&a.clearTimeout(_.m),_.m=null)}function wl(_){if(!zn(_.h)&&!_.m){_.m=!0;var C=_.Ea;D||R(),U||(D(),U=!0),P.add(C,_),_.D=0}}function ay(_,C){return yr(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=C.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=Be(c(_.Ea,_,C),Kd(_,_.D)),_.D++,!0)}n.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const pe=new J(this,this.j,_);let ke=this.o;if(this.U&&(ke?(ke=se(ke),Q(ke,this.U)):ke=this.U),this.u!==null||this.R||(pe.J=ke,ke=null),this.S)e:{for(var C=0,F=0;F<this.i.length;F++){t:{var H=this.i[F];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(C+=H,C>4096){C=F;break e}if(C===4096||F===this.i.length-1){C=F+1;break e}}C=1e3}else C=1e3;C=Ag(this,pe,C),F=_a(this.J),Pn(F,"RID",_),Pn(F,"CVER",22),this.G&&Pn(F,"X-HTTP-Session-Id",this.G),No(this,F),ke&&(this.R?C="headers="+Ki(ry(ke))+"&"+C:this.u&&Bd(F,this.u,ke)),ya(this.h,pe),this.Ra&&Pn(F,"TYPE","init"),this.S?(Pn(F,"$req",C),Pn(F,"SID","null"),pe.U=!0,te(pe,F,null)):te(pe,F,C),this.I=2}}else this.I==3&&(_?Ju(this,_):this.i.length==0||zn(this.h)||Ju(this))};function Ju(_,C){var F;C?F=C.l:F=_.V++;const H=_a(_.J);Pn(H,"SID",_.M),Pn(H,"RID",F),Pn(H,"AID",_.K),No(_,H),_.u&&_.o&&Bd(H,_.u,_.o),F=new J(_,_.j,F,_.D+1),_.u===null&&(F.J=_.o),C&&(_.i=C.G.concat(_.i)),C=Ag(_,F,1e3),F.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),ya(_.h,F),te(F,H,C)}function No(_,C){_.H&&we(_.H,function(F,H){Pn(C,H,F)}),_.l&&we({},function(F,H){Pn(C,H,F)})}function Ag(_,C,F){F=Math.min(_.i.length,F);const H=_.l?c(_.l.Ka,_.l,_):null;e:{var pe=_.i;let en=-1;for(;;){const Ur=["count="+F];en==-1?F>0?(en=pe[0].g,Ur.push("ofs="+en)):en=0:Ur.push("ofs="+en);let $n=!0;for(let Xr=0;Xr<F;Xr++){var ke=pe[Xr].g;const Qs=pe[Xr].map;if(ke-=en,ke<0)en=Math.max(0,pe[Xr].g-100),$n=!1;else try{ke="req"+ke+"_"||"";try{var it=Qs instanceof Map?Qs:Object.entries(Qs);for(const[Sl,Oo]of it){let Do=Oo;o(Oo)&&(Do=cr(Oo)),Ur.push(ke+Sl+"="+encodeURIComponent(Do))}}catch(Sl){throw Ur.push(ke+"type="+encodeURIComponent("_badmap")),Sl}}catch{H&&H(Qs)}}if($n){it=Ur.join("&");break e}}it=void 0}return _=_.i.splice(0,F),C.G=_,it}function Xi(_){if(!_.g&&!_.v){_.Y=1;var C=_.Da;D||R(),U||(D(),U=!0),P.add(C,_),_.A=0}}function Lo(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=Be(c(_.Da,_),Kd(_,_.A)),_.A++,!0)}n.Da=function(){if(this.v=null,Tc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=Be(c(this.Wa,this),_)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ue(10),Ys(this),Tc(this))};function eh(_){_.B!=null&&(a.clearTimeout(_.B),_.B=null)}function Tc(_){_.g=new J(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var C=_a(_.na);Pn(C,"RID","rpc"),Pn(C,"SID",_.M),Pn(C,"AID",_.K),Pn(C,"CI",_.F?"0":"1"),!_.F&&_.ia&&Pn(C,"TO",_.ia),Pn(C,"TYPE","xmlhttp"),No(_,C),_.u&&_.o&&Bd(C,_.u,_.o),_.O&&(_.g.H=_.O);var F=_.g;_=_.ba,F.M=1,F.A=_l(_a(C)),F.u=null,F.R=!0,ve(F,_)}n.Va=function(){this.C!=null&&(this.C=null,Ys(this),Lo(this),ue(19))};function Wd(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function Hd(_,C){var F=null;if(_.g==C){Wd(_),eh(_),_.g=null;var H=2}else if(Ha(_.h,C))F=C.G,Xs(_.h,C),H=1;else return;if(_.I!=0){if(C.o)if(H==1){F=C.u?C.u.length:0,C=Date.now()-C.F;var pe=_.D;H=Ot(),rn(H,new he(H,F)),wl(_)}else Xi(_);else if(pe=C.m,pe==3||pe==0&&C.X>0||!(H==1&&ay(_,C)||H==2&&Lo(_)))switch(F&&F.length>0&&(C=_.h,C.i=C.i.concat(F)),pe){case 1:Zs(_,5);break;case 4:Zs(_,10);break;case 3:Zs(_,6);break;default:Zs(_,2)}}}function Kd(_,C){let F=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(F*=2),F*C}function Zs(_,C){if(_.j.info("Error code "+C),C==2){var F=c(_.bb,_),H=_.Ua;const pe=!H;H=new bo(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Xu(H,"https"),_l(H),pe?Co(H.toString(),F):Po(H.toString(),F)}else ue(2);_.I=0,_.l&&_.l.pa(C),th(_),$d(_)}n.bb=function(_){_?(this.j.info("Successfully pinged google.com"),ue(2)):(this.j.info("Failed to ping google.com"),ue(1))};function th(_){if(_.I=0,_.ja=[],_.l){const C=Br(_.h);(C.length!=0||_.i.length!=0)&&(x(_.ja,C),x(_.ja,_.i),_.h.i.length=0,y(_.i),_.i.length=0),_.l.oa()}}function Rg(_,C,F){var H=F instanceof bo?_a(F):new bo(F);if(H.g!="")C&&(H.g=C+"."+H.g),Ao(H,H.u);else{var pe=a.location;H=pe.protocol,C=C?C+"."+pe.hostname:pe.hostname,pe=+pe.port;const ke=new bo(null);H&&Xu(ke,H),C&&(ke.g=C),pe&&Ao(ke,pe),F&&(ke.h=F),H=ke}return F=_.G,C=_.wa,F&&C&&Pn(H,F,C),Pn(H,"VER",_.ka),No(_,H),H}function oy(_,C,F){if(C&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return C=_.Aa&&!_.ma?new ir(new xl({ab:F})):new ir(_.ma),C.Fa(_.L),C}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ly(){}n=ly.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Xd(){}Xd.prototype.g=function(_,C){return new Ni(_,C)};function Ni(_,C){hn.call(this),this.g=new Ud(C),this.l=_,this.h=C&&C.messageUrlParams||null,_=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(_?_["X-WebChannel-Content-Type"]=C.messageContentType:_={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.sa&&(_?_["X-WebChannel-Client-Profile"]=C.sa:_={"X-WebChannel-Client-Profile":C.sa}),this.g.U=_,(_=C&&C.Qb)&&!j(_)&&(this.g.u=_),this.A=C&&C.supportsCrossDomainXhr||!1,this.v=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!j(C)&&(this.g.G=C,_=this.h,_!==null&&C in _&&(_=this.h,C in _&&delete _[C])),this.j=new bc(this)}f(Ni,hn),Ni.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ni.prototype.close=function(){zd(this.g)},Ni.prototype.o=function(_){var C=this.g;if(typeof _=="string"){var F={};F.__data__=_,_=F}else this.v&&(F={},F.__data__=cr(_),_=F);C.i.push(new Ht(C.Ya++,_)),C.I==3&&wl(C)},Ni.prototype.N=function(){this.g.l=null,delete this.j,zd(this.g),delete this.g,Ni.Z.N.call(this)};function cy(_){be.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var C=_.__sm__;if(C){e:{for(const F in C){_=F;break e}_=void 0}(this.i=_)&&(_=this.i,C=C!==null&&_ in C?C[_]:void 0),this.data=C}else this.data=_}f(cy,be);function uy(){_e.call(this),this.status=1}f(uy,_e);function bc(_){this.g=_}f(bc,ly),bc.prototype.ra=function(){rn(this.g,"a")},bc.prototype.qa=function(_){rn(this.g,new cy(_))},bc.prototype.pa=function(_){rn(this.g,new uy)},bc.prototype.oa=function(){rn(this.g,"b")},Xd.prototype.createWebChannel=Xd.prototype.g,Ni.prototype.send=Ni.prototype.o,Ni.prototype.open=Ni.prototype.m,Ni.prototype.close=Ni.prototype.close,Z6=function(){return new Xd},Y6=function(){return Ot()},q6=Lt,Ab={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},mr.NO_ERROR=0,mr.TIMEOUT=8,mr.HTTP_ERROR=6,ex=mr,pn.COMPLETE="complete",X6=pn,fs.EventType=je,je.OPEN="a",je.CLOSE="b",je.ERROR="c",je.MESSAGE="d",hn.prototype.listen=hn.prototype.J,xm=fs,ir.prototype.listenOnce=ir.prototype.K,ir.prototype.getLastError=ir.prototype.Ha,ir.prototype.getLastErrorCode=ir.prototype.ya,ir.prototype.getStatus=ir.prototype.ca,ir.prototype.getResponseJson=ir.prototype.La,ir.prototype.getResponseText=ir.prototype.la,ir.prototype.send=ir.prototype.ea,ir.prototype.setWithCredentials=ir.prototype.Fa,K6=ir}).apply(typeof x_<"u"?x_:typeof self<"u"?self:typeof window<"u"?window:{});const NN="@firebase/firestore",LN="4.9.3";let Bi=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Bi.UNAUTHENTICATED=new Bi(null),Bi.GOOGLE_CREDENTIALS=new Bi("google-credentials-uid"),Bi.FIRST_PARTY=new Bi("first-party-uid"),Bi.MOCK_USER=new Bi("mock-user");let sg="12.7.0";const ld=new VR("@firebase/firestore");function Bf(){return ld.logLevel}function Ze(n,...e){if(ld.logLevel<=yn.DEBUG){const t=e.map(ZR);ld.debug(`Firestore (${sg}): ${n}`,...t)}}function vs(n,...e){if(ld.logLevel<=yn.ERROR){const t=e.map(ZR);ld.error(`Firestore (${sg}): ${n}`,...t)}}function cd(n,...e){if(ld.logLevel<=yn.WARN){const t=e.map(ZR);ld.warn(`Firestore (${sg}): ${n}`,...t)}}function ZR(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function At(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Q6(n,r,t)}function Q6(n,e,t){let r=`FIRESTORE (${sg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw vs(r),new Error(r)}function Mt(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Q6(e,i,r)}function Jt(n,e){return n}const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends pl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class nl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class J6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Bi.UNAUTHENTICATED)))}shutdown(){}}class nJ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class rJ{constructor(e){this.t=e,this.currentUser=Bi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Mt(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new nl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new nl,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new nl)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Mt(typeof r.accessToken=="string",31837,{l:r}),new J6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Mt(e===null||typeof e=="string",2055,{h:e}),new Bi(e)}}class iJ{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Bi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class sJ{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new iJ(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Bi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ON{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aJ{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,la(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Mt(this.o===void 0,3512);const r=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ON(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Mt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ON(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function oJ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class QR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=oJ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function Qt(n,e){return n<e?-1:n>e?1:0}function Rb(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return YS(i)===YS(s)?Qt(i,s):YS(i)?1:-1}return Qt(n.length,e.length)}const lJ=55296,cJ=57343;function YS(n){const e=n.charCodeAt(0);return e>=lJ&&e<=cJ}function M0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function e8(n){return n+"\0"}const DN="__name__";class Ho{constructor(e,t,r){t===void 0?t=0:t>e.length&&At(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&At(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ho.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ho?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Ho.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Qt(e.length,t.length)}static compareSegments(e,t){const r=Ho.isNumericId(e),i=Ho.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ho.extractNumericId(e).compare(Ho.extractNumericId(t)):Rb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Eu.fromString(e.substring(4,e.length-2))}}class On extends Ho{construct(e,t,r){return new On(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new at(De.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new On(t)}static emptyPath(){return new On([])}}const uJ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pr extends Ho{construct(e,t,r){return new Pr(e,t,r)}static isValidIdentifier(e){return uJ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===DN}static keyField(){return new Pr([DN])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new at(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new at(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new at(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new at(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pr(t)}static emptyPath(){return new Pr([])}}class ut{constructor(e){this.path=e}static fromPath(e){return new ut(On.fromString(e))}static fromName(e){return new ut(On.fromString(e).popFirst(5))}static empty(){return new ut(On.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&On.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return On.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ut(new On(e.slice()))}}function t8(n,e,t){if(!t)throw new at(De.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hJ(n,e,t,r){if(e===!0&&r===!0)throw new at(De.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function FN(n){if(!ut.isDocumentKey(n))throw new at(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function jN(n){if(ut.isDocumentKey(n))throw new at(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function n8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function DE(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":At(12329,{type:typeof n})}function Ua(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new at(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=DE(n);throw new at(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ti(n,e){const t={typeString:n};return e&&(t.value=e),t}function R1(n,e){if(!n8(n))throw new at(De.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new at(De.INVALID_ARGUMENT,t);return!0}const VN=-62135596800,GN=1e6;class Kn{static now(){return Kn.fromMillis(Date.now())}static fromDate(e){return Kn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*GN);return new Kn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new at(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new at(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<VN)throw new at(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/GN}_compareTo(e){return this.seconds===e.seconds?Qt(this.nanoseconds,e.nanoseconds):Qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Kn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(R1(e,Kn._jsonSchema))return new Kn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-VN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Kn._jsonSchemaVersion="firestore/timestamp/1.0",Kn._jsonSchema={type:ti("string",Kn._jsonSchemaVersion),seconds:ti("number"),nanoseconds:ti("number")};class Dt{static fromTimestamp(e){return new Dt(e)}static min(){return new Dt(new Kn(0,0))}static max(){return new Dt(new Kn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Rp=-1;class tv{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Ib(n){return n.fields.find((e=>e.kind===2))}function Sh(n){return n.fields.filter((e=>e.kind!==2))}tv.UNKNOWN_ID=-1;class tx{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ip{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ip(0,fa.min())}}function dJ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Dt.fromTimestamp(r===1e9?new Kn(t+1,0):new Kn(t,r));return new fa(i,ut.empty(),e)}function r8(n){return new fa(n.readTime,n.key,Rp)}class fa{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new fa(Dt.min(),ut.empty(),Rp)}static max(){return new fa(Dt.max(),ut.empty(),Rp)}}function JR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ut.comparator(n.documentKey,e.documentKey),t!==0?t:Qt(n.largestBatchId,e.largestBatchId))}const i8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class s8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Cd(n){if(n.code!==De.FAILED_PRECONDITION||n.message!==i8)throw n;Ze("LocalStore","Unexpectedly lost primary lease")}class de{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&At(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new de(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof de?t:de.resolve(t)}catch(t){return de.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):de.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):de.reject(t)}static resolve(e){return new de(((t,r)=>{t(e)}))}static reject(e){return new de(((t,r)=>{r(e)}))}static waitFor(e){return new de(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=de.resolve(!1);for(const r of e)t=t.next((i=>i?de.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new de(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next((h=>{a[c]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new de(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const ra="SimpleDb";class FE{static open(e,t,r,i){try{return new FE(t,e.transaction(i,r))}catch(s){throw new Dm(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new nl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Dm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=eI(r.target.error);this.S.reject(new Dm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ze(ra,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new gJ(t)}}class wu{static delete(e){return Ze(ra,"Removing database:",e),Ch(QF().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!o6())return!1;if(wu.F())return!0;const e=mi(),t=wu.M(e),r=0<t&&t<10,i=a8(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,wu.M(mi())===12.2&&vs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ze(ra,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new Dm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new at(De.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new at(De.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Dm(e,a))},i.onupgradeneeded=s=>{Ze(ra,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{Ze(ra,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=FE.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((c=>(o.C(),c))).catch((c=>(o.abort(c),de.reject(c)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,c=l.name!=="FirebaseError"&&a<3;if(Ze(ra,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function a8(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class fJ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ch(this.U.delete())}}class Dm extends at{constructor(e,t){super(De.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Bu(n){return n.name==="IndexedDbTransactionError"}class gJ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ze(ra,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ze(ra,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ch(r)}add(e){return Ze(ra,"ADD",this.store.name,e,e),Ch(this.store.add(e))}get(e){return Ch(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ze(ra,"GET",this.store.name,e,t),t)))}delete(e){return Ze(ra,"DELETE",this.store.name,e),Ch(this.store.delete(e))}count(){return Ze(ra,"COUNT",this.store.name),Ch(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new de(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new de(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){Ze(ra,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new de(((r,i)=>{t.onerror=s=>{const a=eI(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new de(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new fJ(o),c=t(o.primaryKey,o.value,l);if(c instanceof de){const h=c.catch((f=>(l.done(),de.reject(f))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>de.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ch(n){return new de(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=eI(r.target.error);t(i)}}))}let BN=!1;function eI(n){const e=wu.M(mi());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new at("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return BN||(BN=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Fm="IndexBackfiller";class mJ{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ze(Fm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ze(Fm,`Documents written: ${t}`)}catch(t){Bu(t)?Ze(Fm,"Ignoring IndexedDB error during index backfill: ",t):await Cd(t)}await this.re(6e4)}))}}class pJ{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return de.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return Ze(Fm,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(Ze(Fm,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=r8(s);JR(a,r)>0&&(r=a)})),new fa(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Oa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Oa.ce=-1;const Wh=-1;function jE(n){return n==null}function Cp(n){return n===0&&1/n==-1/0}function yJ(n){return typeof n=="number"&&Number.isInteger(n)&&!Cp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const nv="";function ls(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=UN(e)),e=_J(n.get(t),e);return UN(e)}function _J(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case nv:t+="";break;default:t+=s}}return t}function UN(n){return n+nv+""}function Zo(n){const e=n.length;if(Mt(e>=2,64408,{path:n}),e===2)return Mt(n.charAt(0)===nv&&n.charAt(1)==="",56145,{path:n}),On.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(nv,s);switch((a<0||a>t)&&At(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:At(61167,{path:n})}s=a+2}return new On(r)}const Th="remoteDocuments",I1="owner",Rf="owner",Pp="mutationQueues",xJ="userId",so="mutations",zN="batchId",Vh="userMutationsIndex",$N=["userId","batchId"];function nx(n,e){return[n,ls(e)]}function o8(n,e,t){return[n,ls(e),t]}const vJ={},N0="documentMutations",rv="remoteDocumentsV14",EJ=["prefixPath","collectionGroup","readTime","documentId"],rx="documentKeyIndex",wJ=["prefixPath","collectionGroup","documentId"],l8="collectionGroupIndex",SJ=["collectionGroup","readTime","prefixPath","documentId"],kp="remoteDocumentGlobal",Cb="remoteDocumentGlobalKey",L0="targets",c8="queryTargetsIndex",TJ=["canonicalId","targetId"],O0="targetDocuments",bJ=["targetId","path"],tI="documentTargetsIndex",AJ=["path","targetId"],iv="targetGlobalKey",Hh="targetGlobal",Mp="collectionParents",RJ=["collectionId","parent"],D0="clientMetadata",IJ="clientId",VE="bundles",CJ="bundleId",GE="namedQueries",PJ="name",nI="indexConfiguration",kJ="indexId",Pb="collectionGroupIndex",MJ="collectionGroup",jm="indexState",NJ=["indexId","uid"],u8="sequenceNumberIndex",LJ=["uid","sequenceNumber"],Vm="indexEntries",OJ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],h8="documentKeyIndex",DJ=["indexId","uid","orderedDocumentKey"],BE="documentOverlays",FJ=["userId","collectionPath","documentId"],kb="collectionPathOverlayIndex",jJ=["userId","collectionPath","largestBatchId"],d8="collectionGroupOverlayIndex",VJ=["userId","collectionGroup","largestBatchId"],rI="globals",GJ="name",f8=[Pp,so,N0,Th,L0,I1,Hh,O0,D0,kp,Mp,VE,GE],BJ=[...f8,BE],g8=[Pp,so,N0,rv,L0,I1,Hh,O0,D0,kp,Mp,VE,GE,BE],m8=g8,iI=[...m8,nI,jm,Vm],UJ=iI,p8=[...iI,rI],zJ=p8;class Mb extends s8{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yi(n,e){const t=Jt(n);return wu.O(t.le,e)}function WN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Uu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function y8(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Sr{constructor(e,t){this.comparator=e,this.root=t||Ui.EMPTY}insert(e,t){return new Sr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ui.BLACK,null,null))}remove(e){return new Sr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ui.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new v_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new v_(this.root,e,this.comparator,!1)}getReverseIterator(){return new v_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new v_(this.root,e,this.comparator,!0)}}class v_{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ui{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Ui.RED,this.left=i??Ui.EMPTY,this.right=s??Ui.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Ui(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ui.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ui.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ui.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ui.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw At(43730,{key:this.key,value:this.value});if(this.right.isRed())throw At(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw At(27949);return e+(this.isRed()?0:1)}}Ui.EMPTY=null,Ui.RED=!0,Ui.BLACK=!1;Ui.EMPTY=new class{constructor(){this.size=0}get key(){throw At(57766)}get value(){throw At(16141)}get color(){throw At(16727)}get left(){throw At(29726)}get right(){throw At(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ui(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zn{constructor(e){this.comparator=e,this.data=new Sr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new HN(this.data.getIterator())}getIteratorFrom(e){return new HN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Zn(this.comparator);return t.data=e,t}}class HN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function If(n){return n.hasNext()?n.getNext():void 0}class js{constructor(e){this.fields=e,e.sort(Pr.comparator)}static empty(){return new js([])}unionWith(e){let t=new Zn(Pr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return M0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class _8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ii{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _8("Invalid base64 string: "+s):s}})(e);return new ii(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new ii(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ii.EMPTY_BYTE_STRING=new ii("");const $J=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ic(n){if(Mt(!!n,39018),typeof n=="string"){let e=0;const t=$J.exec(n);if(Mt(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xr(n.seconds),nanos:xr(n.nanos)}}function xr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function sc(n){return typeof n=="string"?ii.fromBase64String(n):ii.fromUint8Array(n)}const x8="server_timestamp",v8="__type__",E8="__previous_value__",w8="__local_write_time__";function sI(n){return(n?.mapValue?.fields||{})[v8]?.stringValue===x8}function UE(n){const e=n.mapValue.fields[E8];return sI(e)?UE(e):e}function Np(n){const e=ic(n.mapValue.fields[w8].timestampValue);return new Kn(e.seconds,e.nanos)}class WJ{constructor(e,t,r,i,s,a,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const sv="(default)";class ud{constructor(e,t){this.projectId=e,this.database=t||sv}static empty(){return new ud("","")}get isDefaultDatabase(){return this.database===sv}isEqual(e){return e instanceof ud&&e.projectId===this.projectId&&e.database===this.database}}const aI="__type__",S8="__max__",hu={mapValue:{fields:{__type__:{stringValue:S8}}}},oI="__vector__",F0="value",ix={nullValue:"NULL_VALUE"};function Iu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sI(n)?4:T8(n)?9007199254740991:zE(n)?10:11:At(28295,{value:n})}function ul(n,e){if(n===e)return!0;const t=Iu(n);if(t!==Iu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Np(n).isEqual(Np(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ic(i.timestampValue),o=ic(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return sc(i.bytesValue).isEqual(sc(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return xr(i.geoPointValue.latitude)===xr(s.geoPointValue.latitude)&&xr(i.geoPointValue.longitude)===xr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return xr(i.integerValue)===xr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=xr(i.doubleValue),o=xr(s.doubleValue);return a===o?Cp(a)===Cp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return M0(n.arrayValue.values||[],e.arrayValue.values||[],ul);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(WN(a)!==WN(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!ul(a[l],o[l])))return!1;return!0})(n,e);default:return At(52216,{left:n})}}function Lp(n,e){return(n.values||[]).find((t=>ul(t,e)))!==void 0}function Cu(n,e){if(n===e)return 0;const t=Iu(n),r=Iu(e);if(t!==r)return Qt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Qt(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=xr(s.integerValue||s.doubleValue),l=xr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return KN(n.timestampValue,e.timestampValue);case 4:return KN(Np(n),Np(e));case 5:return Rb(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=sc(s),l=sc(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const h=Qt(o[c],l[c]);if(h!==0)return h}return Qt(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=Qt(xr(s.latitude),xr(a.latitude));return o!==0?o:Qt(xr(s.longitude),xr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return XN(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},c=o[F0]?.arrayValue,h=l[F0]?.arrayValue,f=Qt(c?.values?.length||0,h?.values?.length||0);return f!==0?f:XN(c,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===hu.mapValue&&a===hu.mapValue)return 0;if(s===hu.mapValue)return 1;if(a===hu.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Rb(l[f],h[f]);if(m!==0)return m;const y=Cu(o[l[f]],c[h[f]]);if(y!==0)return y}return Qt(l.length,h.length)})(n.mapValue,e.mapValue);default:throw At(23264,{he:t})}}function KN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Qt(n,e);const t=ic(n),r=ic(e),i=Qt(t.seconds,r.seconds);return i!==0?i:Qt(t.nanos,r.nanos)}function XN(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Cu(t[i],r[i]);if(s)return s}return Qt(t.length,r.length)}function j0(n){return Nb(n)}function Nb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=ic(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return sc(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ut.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Nb(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Nb(t.fields[a])}`;return i+"}"})(n.mapValue):At(61005,{value:n})}function sx(n){switch(Iu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=UE(n);return e?16+sx(e):16;case 5:return 2*n.stringValue.length;case 6:return sc(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+sx(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Uu(r.fields,((s,a)=>{i+=s.length+sx(a)})),i})(n.mapValue);default:throw At(13486,{value:n})}}function Op(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Lb(n){return!!n&&"integerValue"in n}function Dp(n){return!!n&&"arrayValue"in n}function qN(n){return!!n&&"nullValue"in n}function YN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ax(n){return!!n&&"mapValue"in n}function zE(n){return(n?.mapValue?.fields||{})[aI]?.stringValue===oI}function Gm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Uu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Gm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Gm(n.arrayValue.values[t]);return e}return{...n}}function T8(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===S8}const b8={mapValue:{fields:{[aI]:{stringValue:oI},[F0]:{arrayValue:{}}}}};function HJ(n){return"nullValue"in n?ix:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Op(ud.empty(),ut.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?zE(n)?b8:{mapValue:{}}:At(35942,{value:n})}function KJ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Op(ud.empty(),ut.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?b8:"mapValue"in n?zE(n)?{mapValue:{}}:hu:At(61959,{value:n})}function ZN(n,e){const t=Cu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function QN(n,e){const t=Cu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ss{constructor(e){this.value=e}static empty(){return new ss({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ax(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gm(t)}setAll(e){let t=Pr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=Gm(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());ax(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ul(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ax(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Uu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new ss(Gm(this.value))}}function A8(n){const e=[];return Uu(n.fields,((t,r)=>{const i=new Pr([t]);if(ax(r)){const s=A8(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new js(e)}class jr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new jr(e,0,Dt.min(),Dt.min(),Dt.min(),ss.empty(),0)}static newFoundDocument(e,t,r,i){return new jr(e,1,t,Dt.min(),r,i,0)}static newNoDocument(e,t){return new jr(e,2,t,Dt.min(),Dt.min(),ss.empty(),0)}static newUnknownDocument(e,t){return new jr(e,3,t,Dt.min(),Dt.min(),ss.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ss.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ss.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class V0{constructor(e,t){this.position=e,this.inclusive=t}}function JN(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ut.comparator(ut.fromName(a.referenceValue),t.key):r=Cu(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function eL(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ul(n.position[t],e.position[t]))return!1;return!0}class av{constructor(e,t="asc"){this.field=e,this.dir=t}}function XJ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class R8{}class _n extends R8{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new qJ(e,t,r):t==="array-contains"?new QJ(e,r):t==="in"?new N8(e,r):t==="not-in"?new JJ(e,r):t==="array-contains-any"?new eee(e,r):new _n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new YJ(e,r):new ZJ(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Cu(t,this.value)):t!==null&&Iu(this.value)===Iu(t)&&this.matchesComparison(Cu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return At(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qn extends R8{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new qn(e,t)}matches(e){return G0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function G0(n){return n.op==="and"}function Ob(n){return n.op==="or"}function lI(n){return I8(n)&&G0(n)}function I8(n){for(const e of n.filters)if(e instanceof qn)return!1;return!0}function Db(n){if(n instanceof _n)return n.field.canonicalString()+n.op.toString()+j0(n.value);if(lI(n))return n.filters.map((e=>Db(e))).join(",");{const e=n.filters.map((t=>Db(t))).join(",");return`${n.op}(${e})`}}function C8(n,e){return n instanceof _n?(function(r,i){return i instanceof _n&&r.op===i.op&&r.field.isEqual(i.field)&&ul(r.value,i.value)})(n,e):n instanceof qn?(function(r,i){return i instanceof qn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&C8(a,i.filters[o])),!0):!1})(n,e):void At(19439)}function P8(n,e){const t=n.filters.concat(e);return qn.create(t,n.op)}function k8(n){return n instanceof _n?(function(t){return`${t.field.canonicalString()} ${t.op} ${j0(t.value)}`})(n):n instanceof qn?(function(t){return t.op.toString()+" {"+t.getFilters().map(k8).join(" ,")+"}"})(n):"Filter"}class qJ extends _n{constructor(e,t,r){super(e,t,r),this.key=ut.fromName(r.referenceValue)}matches(e){const t=ut.comparator(e.key,this.key);return this.matchesComparison(t)}}class YJ extends _n{constructor(e,t){super(e,"in",t),this.keys=M8("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ZJ extends _n{constructor(e,t){super(e,"not-in",t),this.keys=M8("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function M8(n,e){return(e.arrayValue?.values||[]).map((t=>ut.fromName(t.referenceValue)))}class QJ extends _n{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Dp(t)&&Lp(t.arrayValue,this.value)}}class N8 extends _n{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Lp(this.value.arrayValue,t)}}class JJ extends _n{constructor(e,t){super(e,"not-in",t)}matches(e){if(Lp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Lp(this.value.arrayValue,t)}}class eee extends _n{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Dp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Lp(this.value.arrayValue,r)))}}class tee{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function Fb(n,e=null,t=[],r=[],i=null,s=null,a=null){return new tee(n,e,t,r,i,s,a)}function hd(n){const e=Jt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Db(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),jE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>j0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>j0(r))).join(",")),e.Te=t}return e.Te}function C1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!XJ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!C8(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!eL(n.startAt,e.startAt)&&eL(n.endAt,e.endAt)}function ov(n){return ut.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function lv(n,e){return n.filters.filter((t=>t instanceof _n&&t.field.isEqual(e)))}function tL(n,e,t){let r=ix,i=!0;for(const s of lv(n,e)){let a=ix,o=!0;switch(s.op){case"<":case"<=":a=HJ(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=ix}ZN({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];ZN({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function nL(n,e,t){let r=hu,i=!0;for(const s of lv(n,e)){let a=hu,o=!0;switch(s.op){case">=":case">":a=KJ(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=hu}QN({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];QN({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class P1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nee(n,e,t,r,i,s,a,o){return new P1(n,e,t,r,i,s,a,o)}function $E(n){return new P1(n)}function rL(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function L8(n){return n.collectionGroup!==null}function Bm(n){const e=Jt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Zn(Pr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new av(s,r))})),t.has(Pr.keyField().canonicalString())||e.Ie.push(new av(Pr.keyField(),r))}return e.Ie}function Fa(n){const e=Jt(n);return e.Ee||(e.Ee=ree(e,Bm(n))),e.Ee}function ree(n,e){if(n.limitType==="F")return Fb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new av(i.field,s)}));const t=n.endAt?new V0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new V0(n.startAt.position,n.startAt.inclusive):null;return Fb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function jb(n,e){const t=n.filters.concat([e]);return new P1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Vb(n,e,t){return new P1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function WE(n,e){return C1(Fa(n),Fa(e))&&n.limitType===e.limitType}function O8(n){return`${hd(Fa(n))}|lt:${n.limitType}`}function Uf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>k8(i))).join(", ")}]`),jE(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>j0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>j0(i))).join(",")),`Target(${r})`})(Fa(n))}; limitType=${n.limitType})`}function k1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ut.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Bm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const c=JN(a,o,l);return a.inclusive?c<=0:c<0})(r.startAt,Bm(r),i)||r.endAt&&!(function(a,o,l){const c=JN(a,o,l);return a.inclusive?c>=0:c>0})(r.endAt,Bm(r),i))})(n,e)}function iee(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function D8(n){return(e,t)=>{let r=!1;for(const i of Bm(n)){const s=see(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function see(n,e,t){const r=n.field.isKeyField()?ut.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Cu(l,c):At(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return At(19790,{direction:n.dir})}}class fc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Uu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return y8(this.inner)}size(){return this.innerSize}}const aee=new Sr(ut.comparator);function ua(){return aee}const F8=new Sr(ut.comparator);function vm(...n){let e=F8;for(const t of n)e=e.insert(t.key,t);return e}function j8(n){let e=F8;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Qo(){return Um()}function V8(){return Um()}function Um(){return new fc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oee=new Sr(ut.comparator),lee=new Zn(ut.comparator);function un(...n){let e=lee;for(const t of n)e=e.add(t);return e}const cee=new Zn(Qt);function uee(){return cee}function cI(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cp(e)?"-0":e}}function G8(n){return{integerValue:""+n}}function hee(n,e){return yJ(e)?G8(e):cI(n,e)}class HE{constructor(){this._=void 0}}function dee(n,e,t){return n instanceof B0?(function(i,s){const a={fields:{[v8]:{stringValue:x8},[w8]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&sI(s)&&(s=UE(s)),s&&(a.fields[E8]=s),{mapValue:a}})(t,e):n instanceof U0?U8(n,e):n instanceof z0?z8(n,e):(function(i,s){const a=B8(i,s),o=iL(a)+iL(i.Ae);return Lb(a)&&Lb(i.Ae)?G8(o):cI(i.serializer,o)})(n,e)}function fee(n,e,t){return n instanceof U0?U8(n,e):n instanceof z0?z8(n,e):t}function B8(n,e){return n instanceof Fp?(function(r){return Lb(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class B0 extends HE{}class U0 extends HE{constructor(e){super(),this.elements=e}}function U8(n,e){const t=$8(e);for(const r of n.elements)t.some((i=>ul(i,r)))||t.push(r);return{arrayValue:{values:t}}}class z0 extends HE{constructor(e){super(),this.elements=e}}function z8(n,e){let t=$8(e);for(const r of n.elements)t=t.filter((i=>!ul(i,r)));return{arrayValue:{values:t}}}class Fp extends HE{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function iL(n){return xr(n.integerValue||n.doubleValue)}function $8(n){return Dp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class W8{constructor(e,t){this.field=e,this.transform=t}}function gee(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof U0&&i instanceof U0||r instanceof z0&&i instanceof z0?M0(r.elements,i.elements,ul):r instanceof Fp&&i instanceof Fp?ul(r.Ae,i.Ae):r instanceof B0&&i instanceof B0})(n.transform,e.transform)}class mee{constructor(e,t){this.version=e,this.transformResults=t}}class as{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new as}static exists(e){return new as(void 0,e)}static updateTime(e){return new as(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ox(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class KE{}function H8(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new XE(n.key,as.none()):new ag(n.key,n.data,as.none());{const t=n.data,r=ss.empty();let i=new Zn(Pr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new gc(n.key,r,new js(i.toArray()),as.none())}}function pee(n,e,t){n instanceof ag?(function(i,s,a){const o=i.value.clone(),l=aL(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof gc?(function(i,s,a){if(!ox(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=aL(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(K8(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function zm(n,e,t,r){return n instanceof ag?(function(s,a,o,l){if(!ox(s.precondition,a))return o;const c=s.value.clone(),h=oL(s.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof gc?(function(s,a,o,l){if(!ox(s.precondition,a))return o;const c=oL(s.fieldTransforms,l,a),h=a.data;return h.setAll(K8(s)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((f=>f.field)))})(n,e,t,r):(function(s,a,o){return ox(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function yee(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=B8(r.transform,i||null);s!=null&&(t===null&&(t=ss.empty()),t.set(r.field,s))}return t||null}function sL(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&M0(r,i,((s,a)=>gee(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ag extends KE{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class gc extends KE{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function K8(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function aL(n,e,t){const r=new Map;Mt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,fee(a,o,t[i]))}return r}function oL(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,dee(s,a,e))}return r}class XE extends KE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class X8 extends KE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class uI{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&pee(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=zm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=zm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=V8();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=H8(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Dt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),un())}isEqual(e){return this.batchId===e.batchId&&M0(this.mutations,e.mutations,((t,r)=>sL(t,r)))&&M0(this.baseMutations,e.baseMutations,((t,r)=>sL(t,r)))}}class hI{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Mt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return oee})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new hI(e,t,r,i)}}class dI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class _ee{constructor(e,t){this.count=e,this.unchangedNames=t}}var Zr,En;function xee(n){switch(n){case De.OK:return At(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return At(15467,{code:n})}}function q8(n){if(n===void 0)return vs("GRPC error has no .code"),De.UNKNOWN;switch(n){case Zr.OK:return De.OK;case Zr.CANCELLED:return De.CANCELLED;case Zr.UNKNOWN:return De.UNKNOWN;case Zr.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Zr.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Zr.INTERNAL:return De.INTERNAL;case Zr.UNAVAILABLE:return De.UNAVAILABLE;case Zr.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Zr.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Zr.NOT_FOUND:return De.NOT_FOUND;case Zr.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Zr.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Zr.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Zr.ABORTED:return De.ABORTED;case Zr.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Zr.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Zr.DATA_LOSS:return De.DATA_LOSS;default:return At(39323,{code:n})}}(En=Zr||(Zr={}))[En.OK=0]="OK",En[En.CANCELLED=1]="CANCELLED",En[En.UNKNOWN=2]="UNKNOWN",En[En.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",En[En.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",En[En.NOT_FOUND=5]="NOT_FOUND",En[En.ALREADY_EXISTS=6]="ALREADY_EXISTS",En[En.PERMISSION_DENIED=7]="PERMISSION_DENIED",En[En.UNAUTHENTICATED=16]="UNAUTHENTICATED",En[En.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",En[En.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",En[En.ABORTED=10]="ABORTED",En[En.OUT_OF_RANGE=11]="OUT_OF_RANGE",En[En.UNIMPLEMENTED=12]="UNIMPLEMENTED",En[En.INTERNAL=13]="INTERNAL",En[En.UNAVAILABLE=14]="UNAVAILABLE",En[En.DATA_LOSS=15]="DATA_LOSS";function vee(){return new TextEncoder}const Eee=new Eu([4294967295,4294967295],0);function lL(n){const e=vee().encode(n),t=new H6;return t.update(e),new Uint8Array(t.digest())}function cL(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Eu([t,r],0),new Eu([i,s],0)]}class fI{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Em(`Invalid padding: ${t}`);if(r<0)throw new Em(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Em(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Em(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Eu.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Eu.fromNumber(r)));return i.compare(Eee)===1&&(i=new Eu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=lL(e),[r,i]=cL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new fI(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=lL(e),[r,i]=cL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Em extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class qE{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,M1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new qE(Dt.min(),i,new Sr(Qt),ua(),un())}}class M1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new M1(r,t,un(),un(),un())}}class lx{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class Y8{constructor(e,t){this.targetId=e,this.Ce=t}}class Z8{constructor(e,t,r=ii.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class uL{constructor(){this.ve=0,this.Fe=hL(),this.Me=ii.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=un(),t=un(),r=un();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:At(38017,{changeType:s})}})),new M1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=hL()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Mt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wee{constructor(e){this.Ge=e,this.ze=new Map,this.je=ua(),this.Je=E_(),this.He=E_(),this.Ye=new Sr(Qt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:At(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(ov(s))if(r===0){const a=new ut(s.path);this.et(t,a,jr.newNoDocument(a,Dt.min()))}else Mt(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=sc(r).toUint8Array()}catch(l){if(l instanceof _8)return cd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new fI(a,i,s)}catch(l){return cd(l instanceof Em?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&ov(o.target)){const l=new ut(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,jr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=un();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new qE(e,t,this.Ye,this.je,r);return this.je=ua(),this.Je=E_(),this.He=E_(),this.Ye=new Sr(Qt),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new uL,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Zn(Qt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Zn(Qt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ze("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new uL),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function E_(){return new Sr(ut.comparator)}function hL(){return new Sr(ut.comparator)}const See={asc:"ASCENDING",desc:"DESCENDING"},Tee={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bee={and:"AND",or:"OR"};class Aee{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gb(n,e){return n.useProto3Json||jE(e)?e:{value:e}}function $0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Q8(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ree(n,e){return $0(n,e.toTimestamp())}function Ss(n){return Mt(!!n,49232),Dt.fromTimestamp((function(t){const r=ic(t);return new Kn(r.seconds,r.nanos)})(n))}function gI(n,e){return Bb(n,e).canonicalString()}function Bb(n,e){const t=(function(i){return new On(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function J8(n){const e=On.fromString(n);return Mt(lj(e),10190,{key:e.toString()}),e}function cv(n,e){return gI(n.databaseId,e.path)}function Kh(n,e){const t=J8(e);if(t.get(1)!==n.databaseId.projectId)throw new at(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new at(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ut(nj(t))}function ej(n,e){return gI(n.databaseId,e)}function tj(n){const e=J8(n);return e.length===4?On.emptyPath():nj(e)}function Ub(n){return new On(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function nj(n){return Mt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function dL(n,e,t){return{name:cv(n,e),fields:t.value.mapValue.fields}}function Iee(n,e,t){const r=Kh(n,e.name),i=Ss(e.updateTime),s=e.createTime?Ss(e.createTime):Dt.min(),a=new ss({mapValue:{fields:e.fields}}),o=jr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function Cee(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:At(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,h){return c.useProto3Json?(Mt(h===void 0||typeof h=="string",58123),ii.fromBase64String(h||"")):(Mt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ii.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const h=c.code===void 0?De.UNKNOWN:q8(c.code);return new at(h,c.message||"")})(a);t=new Z8(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Kh(n,r.document.name),s=Ss(r.document.updateTime),a=r.document.createTime?Ss(r.document.createTime):Dt.min(),o=new ss({mapValue:{fields:r.document.fields}}),l=jr.newFoundDocument(i,s,a,o),c=r.targetIds||[],h=r.removedTargetIds||[];t=new lx(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Kh(n,r.document),s=r.readTime?Ss(r.readTime):Dt.min(),a=jr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new lx([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Kh(n,r.document),s=r.removedTargetIds||[];t=new lx([],s,i,null)}else{if(!("filter"in e))return At(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new _ee(i,s),o=r.targetId;t=new Y8(o,a)}}return t}function uv(n,e){let t;if(e instanceof ag)t={update:dL(n,e.key,e.value)};else if(e instanceof XE)t={delete:cv(n,e.key)};else if(e instanceof gc)t={update:dL(n,e.key,e.data),updateMask:Oee(e.fieldMask)};else{if(!(e instanceof X8))return At(16599,{Vt:e.type});t={verify:cv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof B0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof U0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof z0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Fp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw At(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:Ree(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:At(27497)})(n,e.precondition)),t}function zb(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?as.updateTime(Ss(s.updateTime)):s.exists!==void 0?as.exists(s.exists):as.none()})(e.currentDocument):as.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)Mt(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new B0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new U0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new z0(h)}else"increment"in o?l=new Fp(a,o.increment):At(16584,{proto:o});const c=Pr.fromServerFormat(o.fieldPath);return new W8(c,l)})(n,i))):[];if(e.update){e.update.name;const i=Kh(n,e.update.name),s=new ss({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const c=l.fieldPaths||[];return new js(c.map((h=>Pr.fromServerFormat(h))))})(e.updateMask);return new gc(i,s,a,t,r)}return new ag(i,s,t,r)}if(e.delete){const i=Kh(n,e.delete);return new XE(i,t)}if(e.verify){const i=Kh(n,e.verify);return new X8(i,t)}return At(1463,{proto:e})}function Pee(n,e){return n&&n.length>0?(Mt(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?Ss(i.updateTime):Ss(s);return a.isEqual(Dt.min())&&(a=Ss(s)),new mee(a,i.transformResults||[])})(t,e)))):[]}function rj(n,e){return{documents:[ej(n,e.path)]}}function ij(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=ej(n,i);const s=(function(c){if(c.length!==0)return oj(qn.create(c,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(c){if(c.length!==0)return c.map((h=>(function(m){return{field:zf(m.field),direction:Mee(m.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=Gb(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:i}}function sj(n){let e=tj(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Mt(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){const m=aj(f);return m instanceof qn&&lI(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(f){return f.map((m=>(function(x){return new av($f(x.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(m)))})(t.orderBy));let o=null;t.limit&&(o=(function(f){let m;return m=typeof f=="object"?f.value:f,jE(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(f){const m=!!f.before,y=f.values||[];return new V0(y,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(f){const m=!f.before,y=f.values||[];return new V0(y,m)})(t.endAt)),nee(e,i,a,s,o,"F",l,c)}function kee(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return At(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function aj(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=$f(t.unaryFilter.field);return _n.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=$f(t.unaryFilter.field);return _n.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=$f(t.unaryFilter.field);return _n.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=$f(t.unaryFilter.field);return _n.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return At(61313);default:return At(60726)}})(n):n.fieldFilter!==void 0?(function(t){return _n.create($f(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return At(58110);default:return At(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return qn.create(t.compositeFilter.filters.map((r=>aj(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return At(1026)}})(t.compositeFilter.op))})(n):At(30097,{filter:n})}function Mee(n){return See[n]}function Nee(n){return Tee[n]}function Lee(n){return bee[n]}function zf(n){return{fieldPath:n.canonicalString()}}function $f(n){return Pr.fromServerFormat(n.fieldPath)}function oj(n){return n instanceof _n?(function(t){if(t.op==="=="){if(YN(t.value))return{unaryFilter:{field:zf(t.field),op:"IS_NAN"}};if(qN(t.value))return{unaryFilter:{field:zf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(YN(t.value))return{unaryFilter:{field:zf(t.field),op:"IS_NOT_NAN"}};if(qN(t.value))return{unaryFilter:{field:zf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zf(t.field),op:Nee(t.op),value:t.value}}})(n):n instanceof qn?(function(t){const r=t.getFilters().map((i=>oj(i)));return r.length===1?r[0]:{compositeFilter:{op:Lee(t.op),filters:r}}})(n):At(54877,{filter:n})}function Oee(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function lj(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ul{constructor(e,t,r,i,s=Dt.min(),a=Dt.min(),o=ii.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ul(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ul(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ul(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ul(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class cj{constructor(e){this.yt=e}}function Dee(n,e){let t;if(e.document)t=Iee(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ut.fromSegments(e.noDocument.path),i=fd(e.noDocument.readTime);t=jr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return At(56709);{const r=ut.fromSegments(e.unknownDocument.path),i=fd(e.unknownDocument.version);t=jr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new Kn(i[0],i[1]);return Dt.fromTimestamp(s)})(e.readTime)),t}function fL(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:hv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:cv(s,a.key),fields:a.data.value.mapValue.fields,updateTime:$0(s,a.version.toTimestamp()),createTime:$0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:dd(e.version)};else{if(!e.isUnknownDocument())return At(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:dd(e.version)}}return r}function hv(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function dd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fd(n){const e=new Kn(n.seconds,n.nanoseconds);return Dt.fromTimestamp(e)}function Ph(n,e){const t=(e.baseMutations||[]).map((s=>zb(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>zb(n.yt,s))),i=Kn.fromMillis(e.localWriteTimeMs);return new uI(e.batchId,i,t,r)}function wm(n){const e=fd(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?fd(n.lastLimboFreeSnapshotVersion):Dt.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return Mt(a===1,1966,{count:a}),Fa($E(tj(s.documents[0])))})(n.query):(function(s){return Fa(sj(s))})(n.query),new Ul(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ii.fromBase64String(n.resumeToken))}function uj(n,e){const t=dd(e.snapshotVersion),r=dd(e.lastLimboFreeSnapshotVersion);let i;i=ov(e.target)?rj(n.yt,e.target):ij(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:hd(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function hj(n){const e=sj({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Vb(e,e.limit,"L"):e}function ZS(n,e){return new dI(e.largestBatchId,zb(n.yt,e.overlayMutation))}function gL(n,e){const t=e.path.lastSegment();return[n,ls(e.path.popLast()),t]}function mL(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:dd(r.readTime),documentKey:ls(r.documentKey.path),largestBatchId:r.largestBatchId}}class Fee{getBundleMetadata(e,t){return pL(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:fd(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return pL(e).put((function(i){return{bundleId:i.id,createTime:dd(Ss(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return yL(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:hj(s.bundledQuery),readTime:fd(s.readTime)}})(r)}))}saveNamedQuery(e,t){return yL(e).put((function(i){return{name:i.name,readTime:dd(Ss(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function pL(n){return yi(n,VE)}function yL(n){return yi(n,GE)}class YE{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new YE(e,r)}getOverlay(e,t){return om(e).get(gL(this.userId,t)).next((r=>r?ZS(this.serializer,r):null))}getOverlays(e,t){const r=Qo();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new dI(t,a);i.push(this.St(e,o))})),de.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(ls(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(om(e).Z(kb,o))})),de.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Qo(),s=ls(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return om(e).J(kb,a).next((o=>{for(const l of o){const c=ZS(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=Qo();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return om(e).ee({index:d8,range:o},((l,c,h)=>{const f=ZS(this.serializer,c);s.size()<i||f.largestBatchId===a?(s.set(f.getKey(),f),a=f.largestBatchId):h.done()})).next((()=>s))}St(e,t){return om(e).put((function(i,s,a){const[o,l,c]=gL(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:uv(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function om(n){return yi(n,BE)}class jee{bt(e){return yi(e,rI)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?ii.fromUint8Array(r):ii.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class kh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(xr(e.integerValue));else if("doubleValue"in e){const r=xr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Cp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=ic(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(sc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?T8(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):zE(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):At(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=F0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(xr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ut.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}kh.Kt=new kh;const Cf=255;function Vee(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function _L(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=Vee(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class Gee{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=_L(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=_L(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Cf),this.sn(255)}_n(){this.an(Cf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Cf?(this.sn(Cf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Cf?(this.an(Cf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Bee{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Uee{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class lm{constructor(){this.cn=new Gee,this.ln=new Bee(this.cn),this.hn=new Uee(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Mh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Mh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:cx(this.En),directionalValue:cx(this.dn),orderedDocumentKey:cx(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Hc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=xL(n.En,e.En),t!==0?t:(t=xL(n.dn,e.dn),t!==0?t:ut.comparator(n.In,e.In)))}function xL(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function cx(n){return a6()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function vL(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class EL{constructor(e){this.mn=new Zn(((t,r)=>Pr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Mt(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Ib(e);if(t!==void 0&&!this.wn(t))return!1;const r=Sh(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Zn(Pr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new tx(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new tx(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new tx(r.field,r.dir==="asc"?0:1)));return new tv(tv.UNKNOWN_ID,this.collectionId,t,Ip.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function dj(n){if(Mt(n instanceof _n||n instanceof qn,20012),n instanceof _n){if(n instanceof N8){const t=n.value.arrayValue?.values?.map((r=>_n.create(n.field,"==",r)))||[];return qn.create(t,"or")}return n}const e=n.filters.map((t=>dj(t)));return qn.create(e,n.op)}function zee(n){if(n.getFilters().length===0)return[];const e=Hb(dj(n));return Mt(fj(e),7391),$b(e)||Wb(e)?[e]:e.getFilters()}function $b(n){return n instanceof _n}function Wb(n){return n instanceof qn&&lI(n)}function fj(n){return $b(n)||Wb(n)||(function(t){if(t instanceof qn&&Ob(t)){for(const r of t.getFilters())if(!$b(r)&&!Wb(r))return!1;return!0}return!1})(n)}function Hb(n){if(Mt(n instanceof _n||n instanceof qn,34018),n instanceof _n)return n;if(n.filters.length===1)return Hb(n.filters[0]);const e=n.filters.map((r=>Hb(r)));let t=qn.create(e,n.op);return t=dv(t),fj(t)?t:(Mt(t instanceof qn,64498),Mt(G0(t),40251),Mt(t.filters.length>1,57927),t.filters.reduce(((r,i)=>mI(r,i))))}function mI(n,e){let t;return Mt(n instanceof _n||n instanceof qn,38388),Mt(e instanceof _n||e instanceof qn,25473),t=n instanceof _n?e instanceof _n?(function(i,s){return qn.create([i,s],"and")})(n,e):wL(n,e):e instanceof _n?wL(e,n):(function(i,s){if(Mt(i.filters.length>0&&s.filters.length>0,48005),G0(i)&&G0(s))return P8(i,s.getFilters());const a=Ob(i)?i:s,o=Ob(i)?s:i,l=a.filters.map((c=>mI(c,o)));return qn.create(l,"or")})(n,e),dv(t)}function wL(n,e){if(G0(e))return P8(e,n.getFilters());{const t=e.filters.map((r=>mI(n,r)));return qn.create(t,"or")}}function dv(n){if(Mt(n instanceof _n||n instanceof qn,11850),n instanceof _n)return n;const e=n.getFilters();if(e.length===1)return dv(e[0]);if(I8(n))return n;const t=e.map((i=>dv(i))),r=[];return t.forEach((i=>{i instanceof _n?r.push(i):i instanceof qn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:qn.create(r,n.op)}class $ee{constructor(){this.Cn=new pI}addToCollectionParentIndex(e,t){return this.Cn.add(t),de.resolve()}getCollectionParents(e,t){return de.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return de.resolve()}deleteFieldIndex(e,t){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,t){return de.resolve()}getDocumentsMatchingTarget(e,t){return de.resolve(null)}getIndexType(e,t){return de.resolve(0)}getFieldIndexes(e,t){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,t){return de.resolve(fa.min())}getMinOffsetFromCollectionGroup(e,t){return de.resolve(fa.min())}updateCollectionGroup(e,t,r){return de.resolve()}updateIndexEntries(e,t){return de.resolve()}}class pI{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Zn(On.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Zn(On.comparator)).toArray()}}const SL="IndexedDbIndexManager",w_=new Uint8Array(0);class Wee{constructor(e,t){this.databaseId=t,this.vn=new pI,this.Fn=new fc((r=>hd(r)),((r,i)=>C1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:ls(i)};return TL(e).put(s)}return de.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[e8(t),""],!1,!0);return TL(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Zo(a.parent))}return r}))}addFieldIndex(e,t){const r=cm(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=kf(e);return s.next((o=>{a.put(mL(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=cm(e),i=kf(e),s=Pf(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=cm(e),r=Pf(e),i=kf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return de.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new EL(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=Pf(e);let i=!0;const s=new Map;return de.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=un();const o=[];return de.forEach(s,((l,c)=>{Ze(SL,`Using index ${(function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(l)} to execute ${hd(t)}`);const h=(function(A,M){const D=Ib(M);if(D===void 0)return null;for(const U of lv(A,D.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null})(c,l),f=(function(A,M){const D=new Map;for(const U of Sh(M))for(const P of lv(A,U.fieldPath))switch(P.op){case"==":case"in":D.set(U.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return D.set(U.fieldPath.canonicalString(),P.value),Array.from(D.values())}return null})(c,l),m=(function(A,M){const D=[];let U=!0;for(const P of Sh(M)){const R=P.kind===0?tL(A,P.fieldPath,A.startAt):nL(A,P.fieldPath,A.startAt);D.push(R.value),U&&(U=R.inclusive)}return new V0(D,U)})(c,l),y=(function(A,M){const D=[];let U=!0;for(const P of Sh(M)){const R=P.kind===0?nL(A,P.fieldPath,A.endAt):tL(A,P.fieldPath,A.endAt);D.push(R.value),U&&(U=R.inclusive)}return new V0(D,U)})(c,l),x=this.On(l,c,m),v=this.On(l,c,y),E=this.Nn(l,c,f),T=this.Bn(l.indexId,h,x,m.inclusive,v,y.inclusive,E);return de.forEach(T,(b=>r.Y(b,t.limit).next((A=>{A.forEach((M=>{const D=ut.fromSegments(M.documentKey);a.has(D)||(a=a.add(D),o.push(D))}))}))))})).next((()=>o))}return de.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=zee(qn.create(e.filters,"and")).map((r=>Fb(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),c=l/(t!=null?t.length:1),h=[];for(let f=0;f<l;++f){const m=t?this.Ln(t[f/c]):w_,y=this.kn(e,m,r[f%c],i),x=this.qn(e,m,s[f%c],a),v=o.map((E=>this.kn(e,m,E,!0)));h.push(...this.createRange(y,x,v))}return h}kn(e,t,r,i){const s=new Mh(e,ut.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new Mh(e,ut.empty(),t,r);return i?s.An():s}xn(e,t){const r=new EL(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return de.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let c=new Zn(Pr.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:c=c.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new lm;for(const i of Sh(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);kh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new lm;return kh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new lm;return kh.Kt.Dt(Op(this.databaseId,t),r.Pn((function(s){const a=Sh(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new lm);let s=0;for(const a of Sh(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&Dp(o))i=this.Kn(i,a,o);else{const c=l.Pn(a.kind);kh.Kt.Dt(o,c)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new lm;l.seed(o.un()),kh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof _n&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=cm(e),i=kf(e);return(t?r.J(Pb,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return de.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,f){const m=f?new Ip(f.sequenceNumber,new fa(fd(f.readTime),new ut(Zo(f.documentKey)),f.largestBatchId)):Ip.empty(),y=h.fields.map((([x,v])=>new tx(Pr.fromServerFormat(x),v)));return new tv(h.indexId,h.collectionGroup,y,m)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Qt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=cm(e),s=kf(e);return this.Gn(e).next((a=>i.J(Pb,IDBKeyRange.bound(t,t)).next((o=>de.forEach(o,(l=>s.put(mL(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return de.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?de.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),de.forEach(o,(l=>this.zn(e,i,l).next((c=>{const h=this.jn(s,l);return c.isEqual(h)?de.resolve():this.Jn(e,s,l,c,h)})))))))}))}Hn(e,t,r,i){return Pf(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Pf(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Pf(e);let s=new Zn(Hc);return i.ee({index:h8,range:IDBKeyRange.only([r.indexId,this.uid,cx(this.$n(r,t))])},((a,o)=>{s=s.add(new Mh(r.indexId,t,vL(o.arrayValue),vL(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Zn(Hc);const i=this.Qn(t,e);if(i==null)return r;const s=Ib(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Dp(a))for(const o of a.arrayValue.values||[])r=r.add(new Mh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new Mh(t.indexId,e.key,w_,i));return r}Jn(e,t,r,i,s){Ze(SL,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,c,h,f,m){const y=l.getIterator(),x=c.getIterator();let v=If(y),E=If(x);for(;v||E;){let T=!1,b=!1;if(v&&E){const A=h(v,E);A<0?b=!0:A>0&&(T=!0)}else v!=null?b=!0:T=!0;T?(f(E),E=If(x)):b?(m(v),v=If(y)):(v=If(y),E=If(x))}})(i,s,Hc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),de.waitFor(a)}Gn(e){let t=1;return kf(e).ee({index:u8,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>Hc(a,o))).filter(((a,o,l)=>!o||Hc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=Hc(a,e),l=Hc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,w_,ut.empty()),l=i[a+1].Vn(this.uid,w_,ut.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return Hc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(bL)}getMinOffset(e,t){return de.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||At(44426))))).next(bL)}}function TL(n){return yi(n,Mp)}function Pf(n){return yi(n,Vm)}function cm(n){return yi(n,nI)}function kf(n){return yi(n,jm)}function bL(n){Mt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;JR(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new fa(e.readTime,e.documentKey,t)}const AL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gj=41943040;class rs{static withCacheSize(e){return new rs(e,rs.DEFAULT_COLLECTION_PERCENTILE,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function mj(n,e,t){const r=n.store(so),i=n.store(N0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,f,m)=>(o++,m.delete())));s.push(l.next((()=>{Mt(o===1,47070,{batchId:t.batchId})})));const c=[];for(const h of t.mutations){const f=o8(e,h.key.path,t.batchId);s.push(i.delete(f)),c.push(h.key)}return de.waitFor(s).next((()=>c))}function fv(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw At(14731);e=n.noDocument}return JSON.stringify(e).length}rs.DEFAULT_COLLECTION_PERCENTILE=10,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rs.DEFAULT=new rs(gj,rs.DEFAULT_COLLECTION_PERCENTILE,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rs.DISABLED=new rs(-1,0,0);class ZE{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Mt(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new ZE(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Kc(e).ee({index:Vh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Wf(e),a=Kc(e);return a.add({}).next((o=>{Mt(typeof o=="number",49019);const l=new uI(o,t,r,i),c=(function(y,x,v){const E=v.baseMutations.map((b=>uv(y.yt,b))),T=v.mutations.map((b=>uv(y.yt,b)));return{userId:x,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:E,mutations:T}})(this.serializer,this.userId,l),h=[];let f=new Zn(((m,y)=>Qt(m.canonicalString(),y.canonicalString())));for(const m of i){const y=o8(this.userId,m.key.path,o);f=f.add(m.key.path.popLast()),h.push(a.put(c)),h.push(s.put(y,vJ))}return f.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),de.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Kc(e).get(t).next((r=>r?(Mt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Ph(this.serializer,r)):null))}er(e,t){return this.Xn[t]?de.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Kc(e).ee({index:Vh,range:i},((a,o,l)=>{o.userId===this.userId&&(Mt(o.batchId>=r,47524,{tr:r}),s=Ph(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Wh;return Kc(e).ee({index:Vh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Wh],[this.userId,Number.POSITIVE_INFINITY]);return Kc(e).J(Vh,t).next((r=>r.map((i=>Ph(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=nx(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Wf(e).ee({range:i},((a,o,l)=>{const[c,h,f]=a,m=Zo(h);if(c===this.userId&&t.path.isEqual(m))return Kc(e).get(f).next((y=>{if(!y)throw At(61480,{nr:a,batchId:f});Mt(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),s.push(Ph(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(Qt);const i=[];return t.forEach((s=>{const a=nx(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Wf(e).ee({range:o},((c,h,f)=>{const[m,y,x]=c,v=Zo(y);m===this.userId&&s.path.isEqual(v)?r=r.add(x):f.done()}));i.push(l)})),de.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=nx(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Zn(Qt);return Wf(e).ee({range:a},((l,c,h)=>{const[f,m,y]=l,x=Zo(m);f===this.userId&&r.isPrefixOf(x)?x.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Kc(e).get(s).next((a=>{if(a===null)throw At(35274,{batchId:s});Mt(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(Ph(this.serializer,a))})))})),de.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return mj(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),de.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return de.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Wf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=Zo(s[1]);i.push(l)}else o.done()})).next((()=>{Mt(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return pj(e,this.userId,t)}_r(e){return yj(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Wh,lastStreamToken:""}))}}function pj(n,e,t){const r=nx(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Wf(n).ee({range:s,X:!0},((o,l,c)=>{const[h,f,m]=o;h===e&&f===i&&(a=!0),c.done()})).next((()=>a))}function Kc(n){return yi(n,so)}function Wf(n){return yi(n,N0)}function yj(n){return yi(n,Pp)}class gd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new gd(0)}static cr(){return new gd(-1)}}class Hee{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new gd(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Dt.fromTimestamp(new Kn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Mf(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Mt(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return Mf(e).ee(((a,o)=>{const l=wm(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>de.waitFor(s))).next((()=>i))}forEachTarget(e,t){return Mf(e).ee(((r,i)=>{const s=wm(i);t(s)}))}lr(e){return RL(e).get(iv).next((t=>(Mt(t!==null,2888),t)))}hr(e,t){return RL(e).put(iv,t)}Pr(e,t){return Mf(e).put(uj(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=hd(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Mf(e).ee({range:i,index:c8},((a,o,l)=>{const c=wm(o);C1(t,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=iu(e);return t.forEach((a=>{const o=ls(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),de.waitFor(i)}removeMatchingKeys(e,t,r){const i=iu(e);return de.forEach(t,(s=>{const a=ls(s.path);return de.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=iu(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=iu(e);let s=un();return i.ee({range:r,X:!0},((a,o,l)=>{const c=Zo(a[1]),h=new ut(c);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=ls(t.path),i=IDBKeyRange.bound([r],[e8(r)],!1,!0);let s=0;return iu(e).ee({index:tI,X:!0,range:i},(([a,o],l,c)=>{a!==0&&(s++,c.done())})).next((()=>s>0))}At(e,t){return Mf(e).get(t).next((r=>r?wm(r):null))}}function Mf(n){return yi(n,L0)}function RL(n){return yi(n,Hh)}function iu(n){return yi(n,O0)}const IL="LruGarbageCollector",Kee=1048576;function CL([n,e],[t,r]){const i=Qt(n,t);return i===0?Qt(e,r):i}class Xee{constructor(e){this.Ir=e,this.buffer=new Zn(CL),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();CL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _j{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ze(IL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Bu(t)?Ze(IL,"Ignoring IndexedDB error during garbage collection: ",t):await Cd(t)}await this.Vr(3e5)}))}}class qee{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return de.resolve(Oa.ce);const r=new Xee(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ze("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(AL)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),AL):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(Ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i)))).next((f=>(r=f,o=Date.now(),this.removeTargets(e,r,t)))).next((f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((f=>(c=Date.now(),Bf()<=yn.DEBUG&&Ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f}))))}}function xj(n,e){return new qee(n,e)}class Yee{constructor(e,t){this.db=e,this.garbageCollector=xj(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return S_(e,r)}removeReference(e,t,r){return S_(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return S_(e,t)}br(e,t){return(function(i,s){let a=!1;return yj(i).te((o=>pj(i,o,s).next((l=>(l&&(a=!0),de.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((c=>{if(!c)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Dt.min()),iu(e).delete((function(f){return[0,ls(f.path)]})(a)))))}));i.push(l)}})).next((()=>de.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return S_(e,t)}Sr(e,t){const r=iu(e);let i,s=Oa.ce;return r.ee({index:tI},(([a,o],{path:l,sequenceNumber:c})=>{a===0?(s!==Oa.ce&&t(new ut(Zo(i)),s),s=c,i=l):s=Oa.ce})).next((()=>{s!==Oa.ce&&t(new ut(Zo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function S_(n,e){return iu(n).put((function(r,i){return{targetId:0,path:ls(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class vj{constructor(){this.changes=new fc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,jr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?de.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Zee{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ph(e).put(r)}removeEntry(e,t,r){return ph(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],hv(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=jr.newInvalidDocument(t);return ph(e).ee({index:rx,range:IDBKeyRange.only(um(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:jr.newInvalidDocument(t)};return ph(e).ee({index:rx,range:IDBKeyRange.only(um(t))},((i,s)=>{r={document:this.Cr(t,s),size:fv(s)}})).next((()=>r))}getEntries(e,t){let r=ua();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=ua(),i=new Sr(ut.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,fv(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return de.resolve();let i=new Zn(ML);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(um(i.first()),um(i.last())),a=i.getIterator();let o=a.getNext();return ph(e).ee({index:rx,range:s},((l,c,h)=>{const f=ut.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&ML(o,f)<0;)r(o,null),o=a.getNext();o&&o.isEqual(f)&&(r(o,c),o=a.hasNext()?a.getNext():null),o?h.j(um(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),hv(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ph(e).J(IDBKeyRange.bound(o,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let h=ua();for(const f of c){const m=this.Cr(ut.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(k1(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=ua();const a=kL(t,r),o=kL(t,fa.max());return ph(e).ee({index:l8,range:IDBKeyRange.bound(a,o,!0)},((l,c,h)=>{const f=this.Cr(ut.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(f.key,f),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new Qee(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return PL(e).get(Cb).next((t=>(Mt(!!t,20021),t)))}Dr(e,t){return PL(e).put(Cb,t)}Cr(e,t){if(t){const r=Dee(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Dt.min())))return r}return jr.newInvalidDocument(e)}}function Ej(n){return new Zee(n)}class Qee extends vj{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new fc((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Zn(((s,a)=>Qt(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=fL(this.Nr.serializer,a);i=i.add(s.path.popLast());const c=fv(l);r+=c-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=fL(this.Nr.serializer,a.convertToNoDocument(Dt.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),de.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function PL(n){return yi(n,kp)}function ph(n){return yi(n,rv)}function um(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function kL(n,e){const t=e.documentKey.path.toArray();return[n,hv(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ML(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Qt(t[s],r[s]),i)return i;return i=Qt(t.length,r.length),i||(i=Qt(t[t.length-2],r[r.length-2]),i||Qt(t[t.length-1],r[r.length-1]))}class Jee{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class wj{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&zm(r.mutation,i,js.empty(),Kn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,un()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=un()){const i=Qo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=vm();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Qo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,un())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=ua();const a=Um(),o=(function(){return Um()})();return t.forEach(((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof gc)?s=s.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),zm(h.mutation,c,h.mutation.getFieldMask(),Kn.now())):a.set(c.key,js.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,h)=>a.set(c,h))),t.forEach(((c,h)=>o.set(c,new Jee(h,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=Um();let i=new Sr(((a,o)=>a-o)),s=un();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||js.empty();h=o.applyToLocalView(c,h),r.set(l,h);const f=(i.get(o.batchId)||un()).add(l);i=i.insert(o.batchId,f)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,h=l.value,f=V8();h.forEach((m=>{if(!s.has(m)){const y=H8(t.get(m),r.get(m));y!==null&&f.set(m,y),s=s.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,f))}return de.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ut.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):L8(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):de.resolve(Qo());let o=Rp,l=s;return a.next((c=>de.forEach(c,((h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?de.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,un()))).next((h=>({batchId:o,changes:j8(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ut(t)).next((r=>{let i=vm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=vm();return this.indexManager.getCollectionParents(e,s).next((o=>de.forEach(o,(l=>{const c=(function(f,m){return new P1(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((h=>{h.forEach(((f,m)=>{a=a.insert(f,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,jr.newInvalidDocument(h)))}));let o=vm();return a.forEach(((l,c)=>{const h=s.get(l);h!==void 0&&zm(h.mutation,c,js.empty(),Kn.now()),k1(t,c)&&(o=o.insert(l,c))})),o}))}}class ete{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return de.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ss(i.createTime)}})(t)),de.resolve()}getNamedQuery(e,t){return de.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:hj(i.bundledQuery),readTime:Ss(i.readTime)}})(t)),de.resolve()}}class tte{constructor(){this.overlays=new Sr(ut.comparator),this.qr=new Map}getOverlay(e,t){return de.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Qo();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),de.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),de.resolve()}getOverlaysForCollection(e,t,r){const i=Qo(),s=t.length+1,a=new ut(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return de.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Sr(((c,h)=>c-h));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=Qo(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const o=Qo(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,h)=>o.set(c,h))),!(o.size()>=i)););return de.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new dI(t,r));let s=this.qr.get(t);s===void 0&&(s=un(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class nte{constructor(){this.sessionToken=ii.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,de.resolve()}}class yI{constructor(){this.Qr=new Zn(Si.$r),this.Ur=new Zn(Si.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Si(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Si(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ut(new On([])),r=new Si(t,e),i=new Si(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ut(new On([])),r=new Si(t,e),i=new Si(t,e+1);let s=un();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Si(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Si{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ut.comparator(e.key,t.key)||Qt(e.Yr,t.Yr)}static Kr(e,t){return Qt(e.Yr,t.Yr)||ut.comparator(e.key,t.key)}}class rte{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Zn(Si.$r)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new uI(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new Si(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return de.resolve(a)}lookupMutationBatch(e,t){return de.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?Wh:this.tr-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Si(t,0),i=new Si(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(Qt);return t.forEach((i=>{const s=new Si(i,0),a=new Si(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),de.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ut.isDocumentKey(s)||(s=s.child(""));const a=new Si(new ut(s),0);let o=new Zn(Qt);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)}),a),de.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Mt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return de.forEach(t.mutations,(i=>{const s=new Si(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Si(t,0),i=this.Zr.firstAfterOrEqual(r);return de.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ite{constructor(e){this.ri=e,this.docs=(function(){return new Sr(ut.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return de.resolve(r?r.document.mutableCopy():jr.newInvalidDocument(t))}getEntries(e,t){let r=ua();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():jr.newInvalidDocument(i))})),de.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=ua();const a=t.path,o=new ut(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||JR(r8(h),r)<=0||(i.has(h.key)||k1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,t,r,i){At(9500)}ii(e,t){return de.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new ste(this)}getSize(e){return de.resolve(this.size)}}class ste extends vj{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),de.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class ate{constructor(e){this.persistence=e,this.si=new fc((t=>hd(t)),C1),this.lastRemoteSnapshotVersion=Dt.min(),this.highestTargetId=0,this.oi=0,this._i=new yI,this.targetCount=0,this.ai=gd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),de.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new gd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,de.resolve()}updateTargetData(e,t){return this.Pr(t),de.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),de.waitFor(s).next((()=>i))}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return de.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),de.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),de.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),de.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return de.resolve(r)}containsKey(e,t){return de.resolve(this._i.containsKey(t))}}class _I{constructor(e,t){this.ui={},this.overlays={},this.ci=new Oa(0),this.li=!1,this.li=!0,this.hi=new nte,this.referenceDelegate=e(this),this.Pi=new ate(this),this.indexManager=new $ee,this.remoteDocumentCache=(function(i){return new ite(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new cj(t),this.Ii=new ete(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tte,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new rte(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze("MemoryPersistence","Starting transaction:",e);const i=new ote(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return de.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class ote extends s8{constructor(e){super(),this.currentSequenceNumber=e}}class QE{constructor(e){this.persistence=e,this.Ri=new yI,this.Vi=null}static mi(e){return new QE(e)}get fi(){if(this.Vi)return this.Vi;throw At(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),de.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),de.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.fi,(r=>{const i=ut.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Dt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return de.or([()=>de.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class gv{constructor(e,t){this.persistence=e,this.pi=new fc((r=>ls(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=xj(this,t)}static mi(e,t){return new gv(e,t)}Ei(){}di(e){return de.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return de.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?de.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Dt.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=sx(e.data.value)),t}br(e,t,r){return de.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class lte{constructor(e){this.serializer=e}k(e,t,r,i){const s=new FE("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(I1)})(e),(function(l){l.createObjectStore(Pp,{keyPath:xJ}),l.createObjectStore(so,{keyPath:zN,autoIncrement:!0}).createIndex(Vh,$N,{unique:!0}),l.createObjectStore(N0)})(e),NL(e),(function(l){l.createObjectStore(Th)})(e));let a=de.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(O0),l.deleteObjectStore(L0),l.deleteObjectStore(Hh)})(e),NL(e)),a=a.next((()=>(function(l){const c=l.store(Hh),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Dt.min().toTimestamp(),targetCount:0};return c.put(iv,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,c){return c.store(so).J().next((f=>{l.deleteObjectStore(so),l.createObjectStore(so,{keyPath:zN,autoIncrement:!0}).createIndex(Vh,$N,{unique:!0});const m=c.store(so),y=f.map((x=>m.put(x)));return de.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(D0,{keyPath:IJ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(kp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(VE,{keyPath:CJ})})(e),(function(l){l.createObjectStore(GE,{keyPath:PJ})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const c=l.createObjectStore(BE,{keyPath:FJ});c.createIndex(kb,jJ,{unique:!1}),c.createIndex(d8,VJ,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const c=l.createObjectStore(rv,{keyPath:EJ});c.createIndex(rx,wJ),c.createIndex(l8,SJ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Th)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(nI,{keyPath:kJ,autoIncrement:!0}).createIndex(Pb,MJ,{unique:!1}),l.createObjectStore(jm,{keyPath:NJ}).createIndex(u8,LJ,{unique:!1}),l.createObjectStore(Vm,{keyPath:OJ}).createIndex(h8,DJ,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(jm).clear()})).next((()=>{t.objectStore(Vm).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(rI,{keyPath:GJ})})(e)}))),r<18&&i>=18&&a6()&&(a=a.next((()=>{t.objectStore(jm).clear()})).next((()=>{t.objectStore(Vm).clear()}))),a}wi(e){let t=0;return e.store(Th).ee(((r,i)=>{t+=fv(i)})).next((()=>{const r={byteSize:t};return e.store(kp).put(Cb,r)}))}yi(e){const t=e.store(Pp),r=e.store(so);return t.J().next((i=>de.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Wh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Vh,a).next((o=>de.forEach(o,(l=>{Mt(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Ph(this.serializer,l);return mj(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const t=e.store(O0),r=e.store(Th);return e.store(Hh).get(iv).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new On(a),c=(function(f){return[0,ls(f)]})(l);s.push(t.get(c).next((h=>h?de.resolve():(f=>t.put({targetId:0,path:ls(f),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>de.waitFor(s)))}))}bi(e,t){e.createObjectStore(Mp,{keyPath:RJ});const r=t.store(Mp),i=new pI,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:ls(l)})}};return t.store(Th).ee({X:!0},((a,o)=>{const l=new On(a);return s(l.popLast())})).next((()=>t.store(N0).ee({X:!0},(([a,o,l],c)=>{const h=Zo(o);return s(h.popLast())}))))}Di(e){const t=e.store(L0);return t.ee(((r,i)=>{const s=wm(i),a=uj(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(Th),i=[];return r.ee(((s,a)=>{const o=t.store(rv),l=(function(f){return f.document?new ut(On.fromString(f.document.name).popFirst(5)):f.noDocument?ut.fromSegments(f.noDocument.path):f.unknownDocument?ut.fromSegments(f.unknownDocument.path):At(36783)})(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(c))})).next((()=>de.waitFor(i)))}Fi(e,t){const r=t.store(so),i=Ej(this.serializer),s=new _I(QE.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let c=o.get(l.userId)??un();Ph(this.serializer,l).keys().forEach((h=>c=c.add(h))),o.set(l.userId,c)})),de.forEach(o,((l,c)=>{const h=new Bi(c),f=YE.wt(this.serializer,h),m=s.getIndexManager(h),y=ZE.wt(h,this.serializer,m,s.referenceDelegate);return new wj(i,y,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Mb(t,Oa.ce),l).next()}))}))}}function NL(n){n.createObjectStore(O0,{keyPath:bJ}).createIndex(tI,AJ,{unique:!0}),n.createObjectStore(L0,{keyPath:"targetId"}).createIndex(c8,TJ,{unique:!0}),n.createObjectStore(Hh)}const Xc="IndexedDbPersistence",QS=18e5,JS=5e3,eT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",cte="main";class xI{constructor(e,t,r,i,s,a,o,l,c,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=c,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!xI.v())throw new at(De.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Yee(this,i),this.$i=t+cte,this.serializer=new cj(l),this.Ui=new wu(this.$i,this.Ni,new lte(this.serializer)),this.hi=new jee,this.Pi=new Hee(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ej(this.serializer),this.Ii=new Fee,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&vs(Xc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new at(De.FAILED_PRECONDITION,eT);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Oa(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>T_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Bu(e))return Ze(Xc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ze(Xc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return hm(e).get(Rf).next((t=>de.resolve(this.es(t))))}ts(e){return T_(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,QS)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=yi(t,D0);return r.J().next((i=>{const s=this.ss(i,QS),a=i.filter((o=>s.indexOf(o)===-1));return de.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?de.resolve(!0):hm(e).get(Rf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,JS)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new at(De.FAILED_PRECONDITION,eT);return!1}}return!(!this.networkEnabled||!this.inForeground)||T_(e).J().next((r=>this.ss(r,JS).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ze(Xc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[I1,D0],(e=>{const t=new Mb(e,Oa.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>T_(e).J().next((t=>this.ss(t,QS).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ZE.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Wee(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return YE.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze(Xc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?zJ:l===17?p8:l===16?UJ:l===15?iI:l===14?m8:l===13?g8:l===12?BJ:l===11?f8:void At(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new Mb(o,this.ci?this.ci.next():Oa.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw vs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new at(De.FAILED_PRECONDITION,i8);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return hm(e).get(Rf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,JS)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new at(De.FAILED_PRECONDITION,eT)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return hm(e).put(Rf,t)}static v(){return wu.v()}Zi(e){const t=hm(e);return t.get(Rf).next((r=>this.es(r)?(Ze(Xc,"Releasing primary lease."),t.delete(Rf)):de.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(vs(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;s6()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ze(Xc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return vs(Xc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){vs("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function hm(n){return yi(n,I1)}function T_(n){return yi(n,D0)}function ute(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class vI{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=un(),i=un();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new vI(e,t.fromCache,r,i)}}class hte{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Sj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return s6()?8:a8(mi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new hte;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Bf()<=yn.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Uf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),de.resolve()):(Bf()<=yn.DEBUG&&Ze("QueryEngine","Query:",Uf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Bf()<=yn.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Uf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fa(t))):de.resolve())}ys(e,t){if(rL(t))return de.resolve(null);let r=Fa(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Vb(t,null,"F"),r=Fa(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=un(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,Vb(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,i){return rL(t)||i.isEqual(Dt.min())?de.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?de.resolve(null):(Bf()<=yn.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Uf(t)),this.vs(e,a,t,dJ(i,Rp)).next((o=>o)))}))}Ds(e,t){let r=new Zn(D8(e));return t.forEach(((i,s)=>{k1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Bf()<=yn.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Uf(t)),this.ps.getDocumentsMatchingQuery(e,t,fa.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const EI="LocalStore",dte=3e8;class fte{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Sr(Qt),this.xs=new fc((s=>hd(s)),C1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wj(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Tj(n,e,t,r){return new fte(n,e,t,r)}async function bj(n,e){const t=Jt(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=un();for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function gte(n,e){const t=Jt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,h){const f=c.batch,m=f.keys();let y=de.resolve();return m.forEach((x=>{y=y.next((()=>h.getEntry(l,x))).next((v=>{const E=c.docVersions.get(x);Mt(E!==null,48541),v.version.compareTo(E)<0&&(f.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),h.addEntry(v)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,f)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=un();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function Aj(n){const e=Jt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function mte(n,e){const t=Jt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,f)=>{const m=i.get(f);if(!m)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,f))));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(ii.EMPTY_BYTE_STRING,Dt.min()).withLastLimboFreeSnapshotVersion(Dt.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(f,y),(function(v,E,T){return v.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=dte?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=ua(),c=un();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(pte(s,a,e.documentUpdates).next((h=>{l=h.ks,c=h.qs}))),!r.isEqual(Dt.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((f=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return de.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function pte(n,e,t){let r=un(),i=un();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=ua();return t.forEach(((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Dt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze(EI,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function yte(n,e){const t=Jt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Wh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function _te(n,e){const t=Jt(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,de.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Ul(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Kb(n,e,t){const r=Jt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Bu(a))throw a;Ze(EI,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function LL(n,e,t){const r=Jt(n);let i=Dt.min(),s=un();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,h){const f=Jt(l),m=f.xs.get(h);return m!==void 0?de.resolve(f.Ms.get(m)):f.Pi.getTargetData(c,h)})(r,a,Fa(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Dt.min(),t?s:un()))).next((o=>(xte(r,iee(e),o),{documents:o,Qs:s})))))}function xte(n,e,t){let r=n.Os.get(e)||Dt.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class OL{constructor(){this.activeTargetIds=uee()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rj{constructor(){this.Mo=new OL,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new OL,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class vte{Oo(e){}shutdown(){}}const DL="ConnectivityMonitor";class FL{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ze(DL,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ze(DL,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let b_=null;function Xb(){return b_===null?b_=(function(){return 268435456+Math.round(2147483648*Math.random())})():b_++,"0x"+b_.toString(16)}const tT="RestConnection",Ete={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wte{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===sv?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=Xb(),o=this.zo(e,t.toUriEncodedString());Ze(tT,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(o),h=Rd(c);return this.Jo(e,o,l,r,h).then((f=>(Ze(tT,`Received RPC '${e}' ${a}: `,f),f)),(f=>{throw cd(tT,`RPC '${e}' ${a} failed with error: `,f,"url: ",o,"request:",r),f}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+sg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=Ete[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Ste{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ji="WebChannelConnection";class Tte extends wte{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=Xb();return new Promise(((o,l)=>{const c=new K6;c.setWithCredentials(!0),c.listenOnce(X6.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case ex.NO_ERROR:const f=c.getResponseJson();Ze(Ji,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case ex.TIMEOUT:Ze(Ji,`RPC '${e}' ${a} timed out`),l(new at(De.DEADLINE_EXCEEDED,"Request time out"));break;case ex.HTTP_ERROR:const m=c.getStatus();if(Ze(Ji,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const x=y?.error;if(x&&x.status&&x.message){const v=(function(T){const b=T.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(b)>=0?b:De.UNKNOWN})(x.status);l(new at(v,x.message))}else l(new at(De.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new at(De.UNAVAILABLE,"Connection failed."));break;default:At(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Ze(Ji,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);Ze(Ji,`RPC '${e}' ${a} sending request:`,i),c.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=Xb(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Z6(),o=Y6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");Ze(Ji,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=a.createWebChannel(h,l);this.I_(f);let m=!1,y=!1;const x=new Ste({Yo:E=>{y?Ze(Ji,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(m||(Ze(Ji,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),Ze(Ji,`RPC '${e}' stream ${i} sending:`,E),f.send(E))},Zo:()=>f.close()}),v=(E,T,b)=>{E.listen(T,(A=>{try{b(A)}catch(M){setTimeout((()=>{throw M}),0)}}))};return v(f,xm.EventType.OPEN,(()=>{y||(Ze(Ji,`RPC '${e}' stream ${i} transport opened.`),x.o_())})),v(f,xm.EventType.CLOSE,(()=>{y||(y=!0,Ze(Ji,`RPC '${e}' stream ${i} transport closed`),x.a_(),this.E_(f))})),v(f,xm.EventType.ERROR,(E=>{y||(y=!0,cd(Ji,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),x.a_(new at(De.UNAVAILABLE,"The operation could not be completed")))})),v(f,xm.EventType.MESSAGE,(E=>{if(!y){const T=E.data[0];Mt(!!T,16349);const b=T,A=b?.error||b[0]?.error;if(A){Ze(Ji,`RPC '${e}' stream ${i} received error:`,A);const M=A.status;let D=(function(R){const k=Zr[R];if(k!==void 0)return q8(k)})(M),U=A.message;D===void 0&&(D=De.INTERNAL,U="Unknown error status: "+M+" with message "+A.message),y=!0,x.a_(new at(D,U)),f.close()}else Ze(Ji,`RPC '${e}' stream ${i} received:`,T),x.u_(T)}})),v(o,q6.STAT_EVENT,(E=>{E.stat===Ab.PROXY?Ze(Ji,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===Ab.NOPROXY&&Ze(Ji,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{x.__()}),0),x}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function bte(){return typeof window<"u"?window:null}function ux(){return typeof document<"u"?document:null}function JE(n){return new Aee(n,!0)}class Ij{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const jL="PersistentStream";class Cj{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ij(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===De.RESOURCE_EXHAUSTED?(vs(t.toString()),vs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new at(De.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ze(jL,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ze(jL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ate extends Cj{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Cee(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Dt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Dt.min():a.readTime?Ss(a.readTime):Dt.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ub(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=ov(l)?{documents:rj(s,l)}:{query:ij(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Q8(s,a.resumeToken);const c=Gb(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Dt.min())>0){o.readTime=$0(s,a.snapshotVersion.toTimestamp());const c=Gb(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const r=kee(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ub(this.serializer),t.removeTarget=e,this.q_(t)}}class Rte extends Cj{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Mt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Mt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Mt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Pee(e.writeResults,e.commitTime),r=Ss(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ub(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>uv(this.serializer,r)))};this.q_(t)}}class Ite{}class Cte extends Ite{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new at(De.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,Bb(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new at(De.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,Bb(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new at(De.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Pte{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vs(t),this.aa=!1):Ze("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const md="RemoteStore";class kte{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Pd(this)&&(Ze(md,"Restarting streams for network reachability change."),await(async function(l){const c=Jt(l);c.Ea.add(4),await N1(c),c.Ra.set("Unknown"),c.Ea.delete(4),await ew(c)})(this))}))})),this.Ra=new Pte(r,i)}}async function ew(n){if(Pd(n))for(const e of n.da)await e(!0)}async function N1(n){for(const e of n.da)await e(!1)}function Pj(n,e){const t=Jt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),bI(t)?TI(t):og(t).O_()&&SI(t,e))}function wI(n,e){const t=Jt(n),r=og(t);t.Ia.delete(e),r.O_()&&kj(t,e),t.Ia.size===0&&(r.O_()?r.L_():Pd(t)&&t.Ra.set("Unknown"))}function SI(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Dt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}og(n).Y_(e)}function kj(n,e){n.Va.Ue(e),og(n).Z_(e)}function TI(n){n.Va=new wee({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),og(n).start(),n.Ra.ua()}function bI(n){return Pd(n)&&!og(n).x_()&&n.Ia.size>0}function Pd(n){return Jt(n).Ea.size===0}function Mj(n){n.Va=void 0}async function Mte(n){n.Ra.set("Online")}async function Nte(n){n.Ia.forEach(((e,t)=>{SI(n,e)}))}async function Lte(n,e){Mj(n),bI(n)?(n.Ra.ha(e),TI(n)):n.Ra.set("Unknown")}async function Ote(n,e,t){if(n.Ra.set("Online"),e instanceof Z8&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){Ze(md,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await mv(n,r)}else if(e instanceof lx?n.Va.Ze(e):e instanceof Y8?n.Va.st(e):n.Va.tt(e),!t.isEqual(Dt.min()))try{const r=await Aj(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(c);h&&s.Ia.set(c,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(ii.EMPTY_BYTE_STRING,h.snapshotVersion)),kj(s,l);const f=new Ul(h.target,l,c,h.sequenceNumber);SI(s,f)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){Ze(md,"Failed to raise snapshot:",r),await mv(n,r)}}async function mv(n,e,t){if(!Bu(e))throw e;n.Ea.add(1),await N1(n),n.Ra.set("Offline"),t||(t=()=>Aj(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ze(md,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ew(n)}))}function Nj(n,e){return e().catch((t=>mv(n,t,e)))}async function L1(n){const e=Jt(n),t=Pu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Wh;for(;Dte(e);)try{const i=await yte(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Fte(e,i)}catch(i){await mv(e,i)}Lj(e)&&Oj(e)}function Dte(n){return Pd(n)&&n.Ta.length<10}function Fte(n,e){n.Ta.push(e);const t=Pu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Lj(n){return Pd(n)&&!Pu(n).x_()&&n.Ta.length>0}function Oj(n){Pu(n).start()}async function jte(n){Pu(n).ra()}async function Vte(n){const e=Pu(n);for(const t of n.Ta)e.ea(t.mutations)}async function Gte(n,e,t){const r=n.Ta.shift(),i=hI.from(r,e,t);await Nj(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await L1(n)}async function Bte(n,e){e&&Pu(n).X_&&await(async function(r,i){if((function(a){return xee(a)&&a!==De.ABORTED})(i.code)){const s=r.Ta.shift();Pu(r).B_(),await Nj(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await L1(r)}})(n,e),Lj(n)&&Oj(n)}async function VL(n,e){const t=Jt(n);t.asyncQueue.verifyOperationInProgress(),Ze(md,"RemoteStore received new credentials");const r=Pd(t);t.Ea.add(3),await N1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ew(t)}async function Ute(n,e){const t=Jt(n);e?(t.Ea.delete(2),await ew(t)):e||(t.Ea.add(2),await N1(t),t.Ra.set("Unknown"))}function og(n){return n.ma||(n.ma=(function(t,r,i){const s=Jt(t);return s.sa(),new Ate(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:Mte.bind(null,n),t_:Nte.bind(null,n),r_:Lte.bind(null,n),H_:Ote.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),bI(n)?TI(n):n.Ra.set("Unknown")):(await n.ma.stop(),Mj(n))}))),n.ma}function Pu(n){return n.fa||(n.fa=(function(t,r,i){const s=Jt(t);return s.sa(),new Rte(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:jte.bind(null,n),r_:Bte.bind(null,n),ta:Vte.bind(null,n),na:Gte.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await L1(n)):(await n.fa.stop(),n.Ta.length>0&&(Ze(md,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class AI{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new nl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new AI(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function RI(n,e){if(vs("AsyncQueue",`${e}: ${n}`),Bu(n))return new at(De.UNAVAILABLE,`${e}: ${n}`);throw n}class f0{static emptySet(e){return new f0(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ut.comparator(t.key,r.key):(t,r)=>ut.comparator(t.key,r.key),this.keyedMap=vm(),this.sortedSet=new Sr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof f0)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new f0;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class GL{constructor(){this.ga=new Sr(ut.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):At(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class W0{constructor(e,t,r,i,s,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new W0(e,t,f0.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&WE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class zte{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class $te{constructor(){this.queries=BL(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Jt(t),s=i.queries;i.queries=BL(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new at(De.ABORTED,"Firestore shutting down"))}}function BL(){return new fc((n=>O8(n)),WE)}async function Dj(n,e){const t=Jt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new zte,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=RI(a,`Initialization of query '${Uf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&II(t)}async function Fj(n,e){const t=Jt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Wte(n,e){const t=Jt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&II(t)}function Hte(n,e,t){const r=Jt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function II(n){n.Ca.forEach((e=>{e.next()}))}var qb,UL;(UL=qb||(qb={})).Ma="default",UL.Cache="cache";class jj{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new W0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=W0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qb.Cache}}class Vj{constructor(e){this.key=e}}class Gj{constructor(e){this.key=e}}class Kte{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=un(),this.mutatedKeys=un(),this.eu=D8(e),this.tu=new f0(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new GL,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,f)=>{const m=i.get(h),y=k1(this.query,f)?f:null,x=!!m&&this.mutatedKeys.has(m.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;m&&y?m.data.isEqual(y.data)?x!==v&&(r.track({type:3,doc:y}),E=!0):this.su(m,y)||(r.track({type:2,doc:y}),E=!0,(l&&this.eu(y,l)>0||c&&this.eu(y,c)<0)&&(o=!0)):!m&&y?(r.track({type:0,doc:y}),E=!0):m&&!y&&(r.track({type:1,doc:m}),E=!0,(l||c)&&(o=!0)),E&&(y?(a=a.add(y),s=v?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,f)=>(function(y,x){const v=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return At(20277,{Rt:E})}};return v(y)-v(x)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new W0(this.query,e.tu,s,a,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new GL,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=un(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new Gj(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Vj(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=un();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return W0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const CI="SyncEngine";class Xte{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class qte{constructor(e){this.key=e,this.hu=!1}}class Yte{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new fc((o=>O8(o)),WE),this.Iu=new Map,this.Eu=new Set,this.du=new Sr(ut.comparator),this.Au=new Map,this.Ru=new yI,this.Vu={},this.mu=new Map,this.fu=gd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Zte(n,e,t=!0){const r=Hj(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Bj(r,e,t,!0),i}async function Qte(n,e){const t=Hj(n);await Bj(t,e,!0,!1)}async function Bj(n,e,t,r){const i=await _te(n.localStore,Fa(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await Jte(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Pj(n.remoteStore,i),o}async function Jte(n,e,t,r,i){n.pu=(f,m,y)=>(async function(v,E,T,b){let A=E.view.ru(T);A.Cs&&(A=await LL(v.localStore,E.query,!1).then((({documents:P})=>E.view.ru(P,A))));const M=b&&b.targetChanges.get(E.targetId),D=b&&b.targetMismatches.get(E.targetId)!=null,U=E.view.applyChanges(A,v.isPrimaryClient,M,D);return $L(v,E.targetId,U.au),U.snapshot})(n,f,m,y);const s=await LL(n.localStore,e,!0),a=new Kte(e,s.Qs),o=a.ru(s.documents),l=M1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=a.applyChanges(o,n.isPrimaryClient,l);$L(n,t,c.au);const h=new Xte(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function ene(n,e,t){const r=Jt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!WE(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Kb(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&wI(r.remoteStore,i.targetId),Yb(r,i.targetId)})).catch(Cd)):(Yb(r,i.targetId),await Kb(r.localStore,i.targetId,!0))}async function tne(n,e){const t=Jt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),wI(t.remoteStore,r.targetId))}async function nne(n,e,t){const r=Kj(n);try{const i=await(function(a,o){const l=Jt(a),c=Kn.now(),h=o.reduce(((y,x)=>y.add(x.key)),un());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let x=ua(),v=un();return l.Ns.getEntries(y,h).next((E=>{x=E,x.forEach(((T,b)=>{b.isValidDocument()||(v=v.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,x))).next((E=>{f=E;const T=[];for(const b of o){const A=yee(b,f.get(b.key).overlayedDocument);A!=null&&T.push(new gc(b.key,A,A8(A.value.mapValue),as.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,T,o)})).next((E=>{m=E;const T=E.applyToLocalDocumentSet(f,v);return l.documentOverlayCache.saveOverlays(y,E.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:j8(f)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Sr(Qt)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(r,i.batchId,t),await O1(r,i.changes),await L1(r.remoteStore)}catch(i){const s=RI(i,"Failed to persist write");t.reject(s)}}async function Uj(n,e){const t=Jt(n);try{const r=await mte(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Mt(a.hu,14607):i.removedDocuments.size>0&&(Mt(a.hu,42227),a.hu=!1))})),await O1(t,r,e)}catch(r){await Cd(r)}}function zL(n,e,t){const r=Jt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=Jt(a);l.onlineState=o;let c=!1;l.queries.forEach(((h,f)=>{for(const m of f.Sa)m.va(o)&&(c=!0)})),c&&II(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function rne(n,e,t){const r=Jt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new Sr(ut.comparator);a=a.insert(s,jr.newNoDocument(s,Dt.min()));const o=un().add(s),l=new qE(Dt.min(),new Map,new Sr(Qt),a,o);await Uj(r,l),r.du=r.du.remove(s),r.Au.delete(e),PI(r)}else await Kb(r.localStore,e,!1).then((()=>Yb(r,e,t))).catch(Cd)}async function ine(n,e){const t=Jt(n),r=e.batch.batchId;try{const i=await gte(t.localStore,e);$j(t,r,null),zj(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await O1(t,i)}catch(i){await Cd(i)}}async function sne(n,e,t){const r=Jt(n);try{const i=await(function(a,o){const l=Jt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let h;return l.mutationQueue.lookupMutationBatch(c,o).next((f=>(Mt(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(c,f)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h))).next((()=>l.localDocuments.getDocuments(c,h)))}))})(r.localStore,e);$j(r,e,t),zj(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await O1(r,i)}catch(i){await Cd(i)}}function zj(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function $j(n,e,t){const r=Jt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Yb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||Wj(n,r)}))}function Wj(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(wI(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),PI(n))}function $L(n,e,t){for(const r of t)r instanceof Vj?(n.Ru.addReference(r.key,e),ane(n,r)):r instanceof Gj?(Ze(CI,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||Wj(n,r.key)):At(19791,{wu:r})}function ane(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ze(CI,"New document in limbo: "+t),n.Eu.add(r),PI(n))}function PI(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ut(On.fromString(e)),r=n.fu.next();n.Au.set(r,new qte(t)),n.du=n.du.insert(t,r),Pj(n.remoteStore,new Ul(Fa($E(t.path)),r,"TargetPurposeLimboResolution",Oa.ce))}}async function O1(n,e,t){const r=Jt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=vI.As(l.targetId,c);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,c){const h=Jt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>de.forEach(c,(m=>de.forEach(m.Es,(y=>h.persistence.referenceDelegate.addReference(f,m.targetId,y))).next((()=>de.forEach(m.ds,(y=>h.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))))))}catch(f){if(!Bu(f))throw f;Ze(EI,"Failed to update sequence numbers: "+f)}for(const f of c){const m=f.targetId;if(!f.fromCache){const y=h.Ms.get(m),x=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(x);h.Ms=h.Ms.insert(m,v)}}})(r.localStore,s))}async function one(n,e){const t=Jt(n);if(!t.currentUser.isEqual(e)){Ze(CI,"User change. New user:",e.toKey());const r=await bj(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new at(De.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await O1(t,r.Ls)}}function lne(n,e){const t=Jt(n),r=t.Au.get(e);if(r&&r.hu)return un().add(r.key);{let i=un();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function Hj(n){const e=Jt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Uj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rne.bind(null,e),e.Pu.H_=Wte.bind(null,e.eventManager),e.Pu.yu=Hte.bind(null,e.eventManager),e}function Kj(n){const e=Jt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ine.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sne.bind(null,e),e}class jp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=JE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Tj(this.persistence,new Sj,e.initialUser,this.serializer)}Cu(e){return new _I(QE.mi,this.serializer)}Du(e){return new Rj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jp.provider={build:()=>new jp};class cne extends jp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Mt(this.persistence.referenceDelegate instanceof gv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new _j(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?rs.withCacheSize(this.cacheSizeBytes):rs.DEFAULT;return new _I((r=>gv.mi(r,t)),this.serializer)}}class une extends jp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Kj(this.xu.syncEngine),await L1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return Tj(this.persistence,new Sj,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new _j(r,e.asyncQueue,t)}Mu(e,t){const r=new pJ(t,this.persistence);return new mJ(e.asyncQueue,r)}Cu(e){const t=ute(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?rs.withCacheSize(this.cacheSizeBytes):rs.DEFAULT;return new xI(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,bte(),ux(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Rj}}class pv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=one.bind(null,this.syncEngine),await Ute(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new $te})()}createDatastore(e){const t=JE(e.databaseInfo.databaseId),r=(function(s){return new Tte(s)})(e.databaseInfo);return(function(s,a,o,l){return new Cte(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new kte(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>zL(this.syncEngine,t,0)),(function(){return FL.v()?new FL:new vte})())}createSyncEngine(e,t){return(function(i,s,a,o,l,c,h){const f=new Yte(i,s,a,o,l,c);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Jt(t);Ze(md,"RemoteStore shutting down."),r.Ea.add(5),await N1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}pv.provider={build:()=>new pv};class Xj{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ku="FirestoreClient";class hne{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Bi.UNAUTHENTICATED,this.clientId=QR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{Ze(ku,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(Ze(ku,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new nl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=RI(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function nT(n,e){n.asyncQueue.verifyOperationInProgress(),Ze(ku,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await bj(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function WL(n,e){n.asyncQueue.verifyOperationInProgress();const t=await dne(n);Ze(ku,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>VL(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>VL(e.remoteStore,i))),n._onlineComponents=e}async function dne(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ze(ku,"Using user provided OfflineComponentProvider");try{await nT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;cd("Error using user provided cache. Falling back to memory cache: "+t),await nT(n,new jp)}}else Ze(ku,"Using default OfflineComponentProvider"),await nT(n,new cne(void 0));return n._offlineComponents}async function qj(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ze(ku,"Using user provided OnlineComponentProvider"),await WL(n,n._uninitializedComponentsProvider._online)):(Ze(ku,"Using default OnlineComponentProvider"),await WL(n,new pv))),n._onlineComponents}function fne(n){return qj(n).then((e=>e.syncEngine))}async function Yj(n){const e=await qj(n),t=e.eventManager;return t.onListen=Zte.bind(null,e.syncEngine),t.onUnlisten=ene.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Qte.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tne.bind(null,e.syncEngine),t}function gne(n,e,t={}){const r=new nl;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new Xj({next:m=>{h.Nu(),a.enqueueAndForget((()=>Fj(s,f)));const y=m.docs.has(o);!y&&m.fromCache?c.reject(new at(De.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&l.source==="server"?c.reject(new at(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new jj($E(o.path),h,{includeMetadataChanges:!0,qa:!0});return Dj(s,f)})(await Yj(n),n.asyncQueue,e,t,r))),r.promise}function mne(n,e,t={}){const r=new nl;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new Xj({next:m=>{h.Nu(),a.enqueueAndForget((()=>Fj(s,f))),m.fromCache&&l.source==="server"?c.reject(new at(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new jj(o,h,{includeMetadataChanges:!0,qa:!0});return Dj(s,f)})(await Yj(n),n.asyncQueue,e,t,r))),r.promise}function Zj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const HL=new Map;const Qj="firestore.googleapis.com",KL=!0;class XL{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new at(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Qj,this.ssl=KL}else this.host=e.host,this.ssl=e.ssl??KL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=gj;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Kee)throw new at(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hJ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Zj(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new at(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new at(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new at(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tw{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new XL({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new XL(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new tJ;switch(r.type){case"firstParty":return new sJ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new at(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=HL.get(t);r&&(Ze("ComponentProvider","Removing Datastore"),HL.delete(t),r.terminate())})(this),Promise.resolve()}}function pne(n,e,t,r={}){n=Ua(n,tw);const i=Rd(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(FR(`https://${o}`),jR("Firestore",!0)),s.host!==Qj&&s.host!==o&&cd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!sd(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=Bi.MOCK_USER;else{c=r6(r.mockUserToken,n._app?.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new at(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Bi(f)}n._authCredentials=new nJ(new J6(c,h))}}class lg{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lg(this.firestore,e,this._query)}}class Hr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Su(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hr(this.firestore,e,this._key)}toJSON(){return{type:Hr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(R1(t,Hr._jsonSchema))return new Hr(e,r||null,new ut(On.fromString(t.referencePath)))}}Hr._jsonSchemaVersion="firestore/documentReference/1.0",Hr._jsonSchema={type:ti("string",Hr._jsonSchemaVersion),referencePath:ti("string")};class Su extends lg{constructor(e,t,r){super(e,t,$E(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hr(this.firestore,null,new ut(e))}withConverter(e){return new Su(this.firestore,e,this._path)}}function qL(n,e,...t){if(n=ki(n),t8("collection","path",e),n instanceof tw){const r=On.fromString(e,...t);return jN(r),new Su(n,null,r)}{if(!(n instanceof Hr||n instanceof Su))throw new at(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(On.fromString(e,...t));return jN(r),new Su(n.firestore,null,r)}}function g0(n,e,...t){if(n=ki(n),arguments.length===1&&(e=QR.newId()),t8("doc","path",e),n instanceof tw){const r=On.fromString(e,...t);return FN(r),new Hr(n,null,new ut(r))}{if(!(n instanceof Hr||n instanceof Su))throw new at(De.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(On.fromString(e,...t));return FN(r),new Hr(n.firestore,n instanceof Su?n.converter:null,new ut(r))}}const YL="AsyncQueue";class ZL{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ij(this,"async_queue_retry"),this._c=()=>{const r=ux();r&&Ze(YL,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ux();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ux();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new nl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Bu(e))throw e;Ze(YL,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,vs("INTERNAL UNHANDLED ERROR: ",QL(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=AI.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&At(47125,{Pc:QL(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function QL(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class zu extends tw{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ZL,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ZL(e),this._firestoreClient=void 0,await e}}}function yne(n,e){const t=typeof n=="object"?n:BR(),r=typeof n=="string"?n:sv,i=ME(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=e6("firestore");s&&pne(i,...s)}return i}function kI(n){if(n._terminated)throw new at(De.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Jj(n),n._firestoreClient}function Jj(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new WJ(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,Zj(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new hne(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function _ne(n,e){cd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return xne(n,pv.provider,{build:r=>new une(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function xne(n,e,t){if((n=Ua(n,zu))._firestoreClient||n._terminated)throw new at(De.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new at(De.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Jj(n)}class ka{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ka(ii.fromBase64String(e))}catch(t){throw new at(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ka(ii.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ka._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(R1(e,ka._jsonSchema))return ka.fromBase64String(e.bytes)}}ka._jsonSchemaVersion="firestore/bytes/1.0",ka._jsonSchema={type:ti("string",ka._jsonSchemaVersion),bytes:ti("string")};class nw{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new at(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class rw{constructor(e){this._methodName=e}}class rl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new at(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new at(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Qt(this._lat,e._lat)||Qt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rl._jsonSchemaVersion}}static fromJSON(e){if(R1(e,rl._jsonSchema))return new rl(e.latitude,e.longitude)}}rl._jsonSchemaVersion="firestore/geoPoint/1.0",rl._jsonSchema={type:ti("string",rl._jsonSchemaVersion),latitude:ti("number"),longitude:ti("number")};class il{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:il._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(R1(e,il._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new il(e.vectorValues);throw new at(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}il._jsonSchemaVersion="firestore/vectorValue/1.0",il._jsonSchema={type:ti("string",il._jsonSchemaVersion),vectorValues:ti("object")};const vne=/^__.*__$/;class Ene{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gc(e,this.data,this.fieldMask,t,this.fieldTransforms):new ag(e,this.data,t,this.fieldTransforms)}}class e9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function t9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw At(40011,{Ac:n})}}class MI{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new MI({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return yv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(t9(this.Ac)&&vne.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class wne{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||JE(e)}Cc(e,t,r,i=!1){return new MI({Ac:e,methodName:t,Dc:r,path:Pr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function iw(n){const e=n._freezeSettings(),t=JE(n._databaseId);return new wne(n._databaseId,!!e.ignoreUndefinedProperties,t)}function n9(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);LI("Data must be an object, but it was:",a,r);const o=r9(r,a);let l,c;if(s.merge)l=new js(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=Zb(e,f,t);if(!a.contains(m))throw new at(De.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);s9(h,m)||h.push(m)}l=new js(h),c=a.fieldTransforms.filter((f=>l.covers(f.field)))}else l=null,c=a.fieldTransforms;return new Ene(new ss(o),l,c)}class sw extends rw{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sw}}class NI extends rw{_toFieldTransform(e){return new W8(e.path,new B0)}isEqual(e){return e instanceof NI}}function Sne(n,e,t,r){const i=n.Cc(1,e,t);LI("Data must be an object, but it was:",i,r);const s=[],a=ss.empty();Uu(r,((l,c)=>{const h=OI(e,l,t);c=ki(c);const f=i.yc(h);if(c instanceof sw)s.push(h);else{const m=D1(c,f);m!=null&&(s.push(h),a.set(h,m))}}));const o=new js(s);return new e9(a,o,i.fieldTransforms)}function Tne(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[Zb(e,r,t)],l=[i];if(s.length%2!=0)throw new at(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)o.push(Zb(e,s[m])),l.push(s[m+1]);const c=[],h=ss.empty();for(let m=o.length-1;m>=0;--m)if(!s9(c,o[m])){const y=o[m];let x=l[m];x=ki(x);const v=a.yc(y);if(x instanceof sw)c.push(y);else{const E=D1(x,v);E!=null&&(c.push(y),h.set(y,E))}}const f=new js(c);return new e9(h,f,a.fieldTransforms)}function bne(n,e,t,r=!1){return D1(t,n.Cc(r?4:3,e))}function D1(n,e){if(i9(n=ki(n)))return LI("Unsupported field value:",e,n),r9(n,e);if(n instanceof rw)return(function(r,i){if(!t9(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=D1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=ki(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hee(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Kn.fromDate(r);return{timestampValue:$0(i.serializer,s)}}if(r instanceof Kn){const s=new Kn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$0(i.serializer,s)}}if(r instanceof rl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ka)return{bytesValue:Q8(i.serializer,r._byteString)};if(r instanceof Hr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:gI(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof il)return(function(a,o){return{mapValue:{fields:{[aI]:{stringValue:oI},[F0]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return cI(o.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${DE(r)}`)})(n,e)}function r9(n,e){const t={};return y8(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Uu(n,((r,i)=>{const s=D1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function i9(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Kn||n instanceof rl||n instanceof ka||n instanceof Hr||n instanceof rw||n instanceof il)}function LI(n,e,t){if(!i9(t)||!n8(t)){const r=DE(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Zb(n,e,t){if((e=ki(e))instanceof nw)return e._internalPath;if(typeof e=="string")return OI(n,e);throw yv("Field path arguments must be of type string or ",n,!1,void 0,t)}const Ane=new RegExp("[~\\*/\\[\\]]");function OI(n,e,t){if(e.search(Ane)>=0)throw yv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new nw(...e.split("."))._internalPath}catch{throw yv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function yv(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new at(De.INVALID_ARGUMENT,o+n+l)}function s9(n,e){return n.some((t=>t.isEqual(e)))}class a9{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Hr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Rne(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(DI("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Rne extends a9{data(){return super.data()}}function DI(n,e){return typeof e=="string"?OI(n,e):e instanceof nw?e._internalPath:e._delegate._internalPath}function Ine(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new at(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class FI{}class Cne extends FI{}function Pne(n,e,...t){let r=[];e instanceof FI&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof jI)).length,o=s.filter((l=>l instanceof aw)).length;if(a>1||a>0&&o>0)throw new at(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class aw extends Cne{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new aw(e,t,r)}_apply(e){const t=this._parse(e);return o9(e._query,t),new lg(e.firestore,e.converter,jb(e._query,t))}_parse(e){const t=iw(e.firestore);return(function(s,a,o,l,c,h,f){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new at(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){e3(f,h);const x=[];for(const v of f)x.push(JL(l,s,v));m={arrayValue:{values:x}}}else m=JL(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||e3(f,h),m=bne(o,a,f,h==="in"||h==="not-in");return _n.create(c,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function kne(n,e,t){const r=e,i=DI("where",n);return aw._create(i,r,t)}class jI extends FI{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new jI(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:qn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)o9(a,l),a=jb(a,l)})(e._query,t),new lg(e.firestore,e.converter,jb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function JL(n,e,t){if(typeof(t=ki(t))=="string"){if(t==="")throw new at(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L8(e)&&t.indexOf("/")!==-1)throw new at(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(On.fromString(t));if(!ut.isDocumentKey(r))throw new at(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Op(n,new ut(r))}if(t instanceof Hr)return Op(n,t._key);throw new at(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${DE(t)}.`)}function e3(n,e){if(!Array.isArray(n)||n.length===0)throw new at(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function o9(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new at(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Mne{convertValue(e,t="none"){switch(Iu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(sc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw At(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Uu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[F0].arrayValue?.values?.map((r=>xr(r.doubleValue)));return new il(t)}convertGeoPoint(e){return new rl(xr(e.latitude),xr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=UE(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Np(e));default:return null}}convertTimestamp(e){const t=ic(e);return new Kn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=On.fromString(e);Mt(lj(r),9688,{name:e});const i=new ud(r.get(1),r.get(3)),s=new ut(r.popFirst(5));return i.isEqual(t)||vs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function l9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Sm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xh extends a9{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new hx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(DI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new at(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Xh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Xh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xh._jsonSchema={type:ti("string",Xh._jsonSchemaVersion),bundleSource:ti("string","DocumentSnapshot"),bundleName:ti("string"),bundle:ti("string")};class hx extends Xh{data(e={}){return super.data(e)}}class m0{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Sm(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new hx(this._firestore,this._userDataWriter,r.key,r,new Sm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new at(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new hx(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Sm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new hx(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Sm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:Nne(o.type),doc:l,oldIndex:c,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new at(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=m0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=QR.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Nne(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return At(61501,{type:n})}}function Lne(n){n=Ua(n,Hr);const e=Ua(n.firestore,zu);return gne(kI(e),n._key).then((t=>Vne(e,n,t)))}m0._jsonSchemaVersion="firestore/querySnapshot/1.0",m0._jsonSchema={type:ti("string",m0._jsonSchemaVersion),bundleSource:ti("string","QuerySnapshot"),bundleName:ti("string"),bundle:ti("string")};class c9 extends Mne{constructor(e){super(),this.firestore=e}convertBytes(e){return new ka(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hr(this.firestore,null,t)}}function One(n){n=Ua(n,lg);const e=Ua(n.firestore,zu),t=kI(e),r=new c9(e);return Ine(n._query),mne(t,n._query).then((i=>new m0(e,r,n,i)))}function t3(n,e,t){n=Ua(n,Hr);const r=Ua(n.firestore,zu),i=l9(n.converter,e,t);return ow(r,[n9(iw(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,as.none())])}function Dne(n,e,t,...r){n=Ua(n,Hr);const i=Ua(n.firestore,zu),s=iw(i);let a;return a=typeof(e=ki(e))=="string"||e instanceof nw?Tne(s,"updateDoc",n._key,e,t,r):Sne(s,"updateDoc",n._key,e),ow(i,[a.toMutation(n._key,as.exists(!0))])}function Fne(n){return ow(Ua(n.firestore,zu),[new XE(n._key,as.none())])}function jne(n,e){const t=Ua(n.firestore,zu),r=g0(n),i=l9(n.converter,e);return ow(t,[n9(iw(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,as.exists(!1))]).then((()=>r))}function ow(n,e){return(function(r,i){const s=new nl;return r.asyncQueue.enqueueAndForget((async()=>nne(await fne(r),i,s))),s.promise})(kI(n),e)}function Vne(n,e,t){const r=t.docs.get(e._key),i=new c9(n);return new Xh(n,i,e._key,r,new Sm(t.hasPendingWrites,t.fromCache),e.converter)}function n3(){return new NI("serverTimestamp")}(function(e,t=!0){(function(i){sg=i})(Id),ad(new Au("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new zu(new rJ(r.getProvider("auth-internal")),new aJ(a,r.getProvider("app-check-internal")),(function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new at(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ud(c.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),el(NN,LN,e),el(NN,LN,"esm2020")})();const u9="firebasestorage.googleapis.com",Gne="storageBucket",Bne=120*1e3,Une=600*1e3;class yl extends pl{constructor(e,t,r=0){super(rT(e),`Firebase Storage: ${t} (${rT(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,yl.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rT(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var hl;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(hl||(hl={}));function rT(n){return"storage/"+n}function zne(){const n="An unknown error occurred, please check the error payload for server response.";return new yl(hl.UNKNOWN,n)}function $ne(){return new yl(hl.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Wne(){return new yl(hl.CANCELED,"User canceled the upload/download.")}function Hne(n){return new yl(hl.INVALID_URL,"Invalid URL '"+n+"'.")}function Kne(n){return new yl(hl.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function r3(n){return new yl(hl.INVALID_ARGUMENT,n)}function h9(){return new yl(hl.APP_DELETED,"The Firebase app was deleted.")}function Xne(n){return new yl(hl.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class ho{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ho.makeFromUrl(e,t)}catch{return new ho(e,"")}if(r.path==="")return r;throw Kne(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${h}/b/${i}/o${m}`,"i"),x={bucket:1,path:3},v=t===u9?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",T=new RegExp(`^https?://${v}/${i}/${E}`,"i"),A=[{regex:o,indices:l,postModify:s},{regex:y,indices:x,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let M=0;M<A.length;M++){const D=A[M],U=D.regex.exec(e);if(U){const P=U[D.indices.bucket];let R=U[D.indices.path];R||(R=""),r=new ho(P,R),D.postModify(r);break}}if(r==null)throw Hne(e);return r}}class qne{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Yne(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function h(...E){c||(c=!0,e.apply(null,E))}function f(E){i=setTimeout(()=>{i=null,n(y,l())},E)}function m(){s&&clearTimeout(s)}function y(E,...T){if(c){m();return}if(E){m(),h.call(null,E,...T);return}if(l()||a){m(),h.call(null,E,...T);return}r<64&&(r*=2);let A;o===1?(o=2,A=0):A=(r+Math.random())*1e3,f(A)}let x=!1;function v(E){x||(x=!0,m(),!c&&(i!==null?(E||(o=2),clearTimeout(i),f(0)):E||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,v(!0)},t),v}function Zne(n){n(!1)}function Qne(n){return n!==void 0}function i3(n,e,t,r){if(r<e)throw r3(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw r3(`Invalid value for '${n}'. Expected ${t} or less.`)}function Jne(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var _v;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(_v||(_v={}));function ere(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class tre{constructor(e,t,r,i,s,a,o,l,c,h,f,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,v)=>{this.resolve_=x,this.reject_=v,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new A_(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===_v.NO_ERROR,l=s.getStatus();if(!o||ere(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===_v.ABORT;r(!1,new A_(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new A_(c,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Qne(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=zne();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?h9():Wne();a(l)}else{const l=$ne();a(l)}};this.canceled_?t(!1,new A_(!1,null,!0)):this.backoffId_=Yne(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Zne(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class A_{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function nre(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function rre(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ire(n,e){e&&(n["X-Firebase-GMPID"]=e)}function sre(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function are(n,e,t,r,i,s,a=!0,o=!1){const l=Jne(n.urlParams),c=n.url+l,h=Object.assign({},n.headers);return ire(h,e),nre(h,t),rre(h,s),sre(h,r),new tre(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function ore(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function lre(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class xv{constructor(e,t){this._service=e,t instanceof ho?this._location=t:this._location=ho.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new xv(e,t)}get root(){const e=new ho(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lre(this._location.path)}get storage(){return this._service}get parent(){const e=ore(this._location.path);if(e===null)return null;const t=new ho(this._location.bucket,e);return new xv(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Xne(e)}}function s3(n,e){const t=e?.[Gne];return t==null?null:ho.makeFromBucketSpec(t,n)}function cre(n,e,t,r={}){n.host=`${e}:${t}`;const i=Rd(e);i&&(FR(`https://${n.host}/b`),jR("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:r6(s,n.app.options.projectId))}class ure{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=u9,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Bne,this._maxUploadRetryTime=Une,this._requests=new Set,i!=null?this._bucket=ho.makeFromBucketSpec(i,this._host):this._bucket=s3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ho.makeFromBucketSpec(this._url,e):this._bucket=s3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){i3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){i3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(la(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xv(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new qne(h9());{const a=are(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const a3="@firebase/storage",o3="0.14.0";const d9="storage";function hre(n=BR(),e){n=ki(n);const r=ME(n,d9).getImmediate({identifier:e}),i=e6("storage");return i&&dre(r,...i),r}function dre(n,e,t,r={}){cre(n,e,t,r)}function fre(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new ure(t,r,i,e,Id)}function gre(){ad(new Au(d9,fre,"PUBLIC").setMultipleInstances(!0)),el(a3,o3,""),el(a3,o3,"esm2020")}gre();const mre={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},VI=u6(mre),p0=ZQ(VI),du=yne(VI);hre(VI);_ne(du).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const pre={};function yre(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const Vp=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Vp(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Vp(r)(t)}}}},_re=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,T)=>({...T,...E}),...e},a=!1;const o=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...E)},r,i);const h=Vp(s.serialize),f=()=>{const E=s.partialize({...r()});let T;const b=h({state:E,version:s.version}).then(A=>c.setItem(s.name,A)).catch(A=>{T=A});if(T)throw T;return b},m=i.setState;i.setState=(E,T)=>{m(E,T),f()};const y=n((...E)=>{t(...E),f()},r,i);let x;const v=()=>{var E;if(!c)return;a=!1,o.forEach(b=>b(r()));const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,r()))||void 0;return Vp(c.getItem.bind(c))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var A;return x=s.merge(b,(A=r())!=null?A:y),t(x,!0),f()}).then(()=>{T?.(x,void 0),a=!0,l.forEach(b=>b(x))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:E=>{s={...s,...E},E.getStorage&&(c=E.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:E=>(o.add(E),()=>{o.delete(E)}),onFinishHydration:E=>(l.add(E),()=>{l.delete(E)})},v(),x||y},xre=(n,e)=>(t,r,i)=>{let s={storage:yre(()=>localStorage),partialize:v=>v,version:0,merge:(v,E)=>({...E,...v}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...v)},r,i);const h=()=>{const v=s.partialize({...r()});return c.setItem(s.name,{state:v,version:s.version})},f=i.setState;i.setState=(v,E)=>{f(v,E),h()};const m=n((...v)=>{t(...v),h()},r,i);i.getInitialState=()=>m;let y;const x=()=>{var v,E;if(!c)return;a=!1,o.forEach(b=>{var A;return b((A=r())!=null?A:m)});const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,(v=r())!=null?v:m))||void 0;return Vp(c.getItem.bind(c))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var A;const[M,D]=b;if(y=s.merge(D,(A=r())!=null?A:m),t(y,!0),M)return h()}).then(()=>{T?.(y,void 0),y=r(),a=!0,l.forEach(b=>b(y))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:v=>{s={...s,...v},v.storage&&(c=v.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:v=>(o.add(v),()=>{o.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},s.skipHydration||x(),y||m},vre=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((pre?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),_re(n,e)):xre(n,e),kd=vre,Gr=pa()(kd(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),lw=pa()(rg((n,e)=>({user:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new Vl;await aQ(p0,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},logout:async()=>{n(t=>{t.loading=!0});try{await L6(p0)}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),N6(p0,t=>{n(r=>{r.user=t,r.loading=!1}),t&&Gr.getState().setVondstenLocalOnly(!1)}))}})));pa()(rg((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=Pne(qL(du,"vondsten"),kne("userId","==",t)),s=(await One(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await jne(qL(du,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=g0(du,"vondsten",t);await Dne(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await Fne(g0(du,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const iT=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],l3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],f9=pa()(kd((n,e)=>({presets:[...iT],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=Ai.getState();l3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=Ai.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&l3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...iT]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...iT]}:n})),c3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],F1=pa()(kd((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=c3[i%c3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),Ere=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],GI=pa()(kd((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||Ere.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));function wre({target:n,viewOptions:e}){const t=X.useRef(null),r=X.useRef(null),i=pi(a=>a.setMap),s=Gr(a=>a.showScaleBar);return X.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new WX({target:n,controls:[],view:new Xo({center:Ir(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),X.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new XX({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const u3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function Sre(){const n=X.useRef(null),e=X.useRef(!1);wre({target:"map"});const t=pi(f=>f.map),r=Ai(f=>f.registerLayer),i=Ai(f=>f.setLayerVisibility),s=Gr(f=>f.defaultBackground);X.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const f=new vh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new uX}),m=new vh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Vf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new vh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Vf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),x=new vh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Vf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),v=new vh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Vf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),E=new vh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Vf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(f),t.addLayer(m),t.addLayer(y),t.addLayer(x),t.addLayer(v),t.addLayer(E),console.log(" Base layers added:",{osm:f.getVisible(),cartodb:m.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",f),r("CartoDB (licht)",m),r("Luchtfoto",y),r("Labels Overlay",x),r("TMK 1850",v),r("Bonnebladen 1900",E),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const f=Eq();console.log(` Loading ${f.length} immediate-load layers (WMS/Tile)...`);const m=await Promise.allSettled(f.map(async x=>{try{const v=await x.factory();return v?{name:x.name,layer:v}:null}catch(v){return console.warn(` Failed to create ${x.name}:`,v),null}}));let y=0;m.forEach(x=>{if(x.status==="fulfilled"&&x.value){const{name:v,layer:E}=x.value;t.addLayer(E),r(v,E),y++,console.log(`   ${v}`)}}),console.log(` Immediate layers loaded: ${y}/${f.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}X.useEffect(()=>{if(!t||e.current)return;const f=setTimeout(()=>{const m=s||"CartoDB (licht)";u3.forEach(y=>{i(y,!1)}),u3.includes(m)?i(m,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${m}`)},100);return()=>clearTimeout(f)},[t,s,i]);const o=Gr(f=>f.gpsAutoStart),l=_s(f=>f.startTracking),c=X.useRef(!1);X.useEffect(()=>{if(!(!t||c.current)&&o){const f=setTimeout(()=>{l(),c.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(f)}},[t,o,l]);const h={width:"100%",height:"100vh"};return g.jsx("div",{id:"map",ref:n,style:h})}const BI=X.createContext({});function UI(n){const e=X.useRef(null);return e.current===null&&(e.current=n()),e.current}const cw=X.createContext(null),zI=X.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class Tre extends X.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function bre({children:n,isPresent:e}){const t=X.useId(),r=X.useRef(null),i=X.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=X.useContext(zI);return X.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),g.jsx(Tre,{isPresent:e,childRef:r,sizeRef:i,children:X.cloneElement(n,{ref:r})})}const Are=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=UI(Rre),l=X.useId(),c=X.useCallback(f=>{o.set(f,!0);for(const m of o.values())if(!m)return;r&&r()},[o,r]),h=X.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:c,register:f=>(o.set(f,!1),()=>o.delete(f))}),s?[Math.random(),c]:[t,c]);return X.useMemo(()=>{o.forEach((f,m)=>o.set(m,!1))},[t]),X.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=g.jsx(bre,{isPresent:t,children:n})),g.jsx(cw.Provider,{value:h,children:n})};function Rre(){return new Map}function g9(n=!0){const e=X.useContext(cw);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=X.useId();X.useEffect(()=>{n&&i(s)},[n]);const a=X.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const R_=n=>n.key||"";function h3(n){const e=[];return X.Children.forEach(n,t=>{X.isValidElement(t)&&e.push(t)}),e}const $I=typeof window<"u",m9=$I?X.useLayoutEffect:X.useEffect,Un=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=g9(a),c=X.useMemo(()=>h3(n),[n]),h=a&&!o?[]:c.map(R_),f=X.useRef(!0),m=X.useRef(c),y=UI(()=>new Map),[x,v]=X.useState(c),[E,T]=X.useState(c);m9(()=>{f.current=!1,m.current=c;for(let M=0;M<E.length;M++){const D=R_(E[M]);h.includes(D)?y.delete(D):y.get(D)!==!0&&y.set(D,!1)}},[E,h.length,h.join("-")]);const b=[];if(c!==x){let M=[...c];for(let D=0;D<E.length;D++){const U=E[D],P=R_(U);h.includes(P)||(M.splice(D,0,U),b.push(U))}s==="wait"&&b.length&&(M=b),T(h3(M)),v(c);return}const{forceRender:A}=X.useContext(BI);return g.jsx(g.Fragment,{children:E.map(M=>{const D=R_(M),U=a&&!o?!1:c===E||h.includes(D),P=()=>{if(y.has(D))y.set(D,!0);else return;let R=!0;y.forEach(k=>{k||(R=!1)}),R&&(A?.(),T(m.current),a&&l?.(),r&&r())};return g.jsx(Are,{isPresent:U,initial:!f.current||t?void 0:!1,custom:U?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:U?void 0:P,children:M},D)})})},ha=n=>n;let p9=ha;function WI(n){let e;return()=>(e===void 0&&(e=n()),e)}const H0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Yl=n=>n*1e3,Zl=n=>n/1e3,Ire={useManualTiming:!1};function Cre(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(c){s.has(c)&&(l.schedule(c),n()),c(a)}const l={schedule:(c,h=!1,f=!1)=>{const y=f&&r?e:t;return h&&s.add(c),y.has(c)||y.add(c),c},cancel:c=>{t.delete(c),s.delete(c)},process:c=>{if(a=c,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const I_=["read","resolveKeyframes","update","preRender","render","postRender"],Pre=40;function y9(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=I_.reduce((T,b)=>(T[b]=Cre(s),T),{}),{read:o,resolveKeyframes:l,update:c,preRender:h,render:f,postRender:m}=a,y=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,Pre),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),h.process(i),f.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},x=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:I_.reduce((T,b)=>{const A=a[b];return T[b]=(M,D=!1,U=!1)=>(t||x(),A.schedule(M,D,U)),T},{}),cancel:T=>{for(let b=0;b<I_.length;b++)a[I_[b]].cancel(T)},state:i,steps:a}}const{schedule:fr,cancel:Mu,state:Vi,steps:sT}=y9(typeof requestAnimationFrame<"u"?requestAnimationFrame:ha,!0),_9=X.createContext({strict:!1}),d3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},K0={};for(const n in d3)K0[n]={isEnabled:e=>d3[n].some(t=>!!e[t])};function kre(n){for(const e in n)K0[e]={...K0[e],...n[e]}}const Mre=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function vv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Mre.has(n)}let x9=n=>!vv(n);function Nre(n){n&&(x9=e=>e.startsWith("on")?!vv(e):n(e))}try{Nre(require("@emotion/is-prop-valid").default)}catch{}function Lre(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(x9(i)||t===!0&&vv(i)||!e&&!vv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function Ore(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const uw=X.createContext({});function Gp(n){return typeof n=="string"||Array.isArray(n)}function hw(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const HI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],KI=["initial",...HI];function dw(n){return hw(n.animate)||KI.some(e=>Gp(n[e]))}function v9(n){return!!(dw(n)||n.variants)}function Dre(n,e){if(dw(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Gp(t)?t:void 0,animate:Gp(r)?r:void 0}}return n.inherit!==!1?e:{}}function Fre(n){const{initial:e,animate:t}=Dre(n,X.useContext(uw));return X.useMemo(()=>({initial:e,animate:t}),[f3(e),f3(t)])}function f3(n){return Array.isArray(n)?n.join(" "):n}const jre=Symbol.for("motionComponentSymbol");function Zf(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Vre(n,e,t){return X.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Zf(t)&&(t.current=r))},[e])}const XI=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Gre="framerAppearId",E9="data-"+XI(Gre),{schedule:qI}=y9(queueMicrotask,!1),w9=X.createContext({});function Bre(n,e,t,r,i){var s,a;const{visualElement:o}=X.useContext(uw),l=X.useContext(_9),c=X.useContext(cw),h=X.useContext(zI).reducedMotion,f=X.useRef(null);r=r||l.renderer,!f.current&&r&&(f.current=r(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const m=f.current,y=X.useContext(w9);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&Ure(f.current,t,i,y);const x=X.useRef(!1);X.useInsertionEffect(()=>{m&&x.current&&m.update(t,c)});const v=t[E9],E=X.useRef(!!v&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,v))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,v)));return m9(()=>{m&&(x.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),qI.render(m.render),E.current&&m.animationState&&m.animationState.animateChanges())}),X.useEffect(()=>{m&&(!E.current&&m.animationState&&m.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,v)}),E.current=!1))}),m}function Ure(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:S9(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&Zf(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function S9(n){if(n)return n.options.allowProjection!==!1?n.projection:S9(n.parent)}function zre({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&kre(n);function o(c,h){let f;const m={...X.useContext(zI),...c,layoutId:$re(c)},{isStatic:y}=m,x=Fre(c),v=r(c,y);if(!y&&$I){Wre();const E=Hre(m);f=E.MeasureLayout,x.visualElement=Bre(i,v,m,e,E.ProjectionNode)}return g.jsxs(uw.Provider,{value:x,children:[f&&x.visualElement?g.jsx(f,{visualElement:x.visualElement,...m}):null,t(i,c,Vre(v,x.visualElement,h),v,y,x.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=X.forwardRef(o);return l[jre]=i,l}function $re({layoutId:n}){const e=X.useContext(BI).id;return e&&n!==void 0?e+"-"+n:n}function Wre(n,e){X.useContext(_9).strict}function Hre(n){const{drag:e,layout:t}=K0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Kre=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function YI(n){return typeof n!="string"||n.includes("-")?!1:!!(Kre.indexOf(n)>-1||/[A-Z]/u.test(n))}function g3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function ZI(n,e,t,r){if(typeof e=="function"){const[i,s]=g3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=g3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const Qb=n=>Array.isArray(n),Xre=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),qre=n=>Qb(n)?n[n.length-1]||0:n,os=n=>!!(n&&n.getVelocity);function dx(n){const e=os(n)?n.get():n;return Xre(e)?e.toValue():e}function Yre({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:Zre(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const T9=n=>(e,t)=>{const r=X.useContext(uw),i=X.useContext(cw),s=()=>Yre(n,e,r,i);return t?s():UI(s)};function Zre(n,e,t,r){const i={},s=r(n,{});for(const m in s)i[m]=dx(s[m]);let{initial:a,animate:o}=n;const l=dw(n),c=v9(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const f=h?o:a;if(f&&typeof f!="boolean"&&!hw(f)){const m=Array.isArray(f)?f:[f];for(let y=0;y<m.length;y++){const x=ZI(n,m[y]);if(x){const{transitionEnd:v,transition:E,...T}=x;for(const b in T){let A=T[b];if(Array.isArray(A)){const M=h?A.length-1:0;A=A[M]}A!==null&&(i[b]=A)}for(const b in v)i[b]=v[b]}}}return i}const cg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Md=new Set(cg),b9=n=>e=>typeof e=="string"&&e.startsWith(n),A9=b9("--"),Qre=b9("var(--"),QI=n=>Qre(n)?Jre.test(n.split("/*")[0].trim()):!1,Jre=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,R9=(n,e)=>e&&typeof n=="number"?e.transform(n):n,ac=(n,e,t)=>t>e?e:t<n?n:t,ug={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Bp={...ug,transform:n=>ac(0,1,n)},C_={...ug,default:1},j1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Qc=j1("deg"),sl=j1("%"),Bt=j1("px"),eie=j1("vh"),tie=j1("vw"),m3={...sl,parse:n=>sl.parse(n)/100,transform:n=>sl.transform(n*100)},nie={borderWidth:Bt,borderTopWidth:Bt,borderRightWidth:Bt,borderBottomWidth:Bt,borderLeftWidth:Bt,borderRadius:Bt,radius:Bt,borderTopLeftRadius:Bt,borderTopRightRadius:Bt,borderBottomRightRadius:Bt,borderBottomLeftRadius:Bt,width:Bt,maxWidth:Bt,height:Bt,maxHeight:Bt,top:Bt,right:Bt,bottom:Bt,left:Bt,padding:Bt,paddingTop:Bt,paddingRight:Bt,paddingBottom:Bt,paddingLeft:Bt,margin:Bt,marginTop:Bt,marginRight:Bt,marginBottom:Bt,marginLeft:Bt,backgroundPositionX:Bt,backgroundPositionY:Bt},rie={rotate:Qc,rotateX:Qc,rotateY:Qc,rotateZ:Qc,scale:C_,scaleX:C_,scaleY:C_,scaleZ:C_,skew:Qc,skewX:Qc,skewY:Qc,distance:Bt,translateX:Bt,translateY:Bt,translateZ:Bt,x:Bt,y:Bt,z:Bt,perspective:Bt,transformPerspective:Bt,opacity:Bp,originX:m3,originY:m3,originZ:Bt},p3={...ug,transform:Math.round},JI={...nie,...rie,zIndex:p3,size:Bt,fillOpacity:Bp,strokeOpacity:Bp,numOctaves:p3},iie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},sie=cg.length;function aie(n,e,t){let r="",i=!0;for(let s=0;s<sie;s++){const a=cg[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=R9(o,JI[a]);if(!l){i=!1;const h=iie[a]||a;r+=`${h}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function eC(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(Md.has(l)){a=!0;continue}else if(A9(l)){i[l]=c;continue}else{const h=R9(c,JI[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=aie(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${c} ${h}`}}const oie={offset:"stroke-dashoffset",array:"stroke-dasharray"},lie={offset:"strokeDashoffset",array:"strokeDasharray"};function cie(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?oie:lie;n[s.offset]=Bt.transform(-r);const a=Bt.transform(e),o=Bt.transform(t);n[s.array]=`${a} ${o}`}function y3(n,e,t){return typeof n=="string"?n:Bt.transform(e+t*n)}function uie(n,e,t){const r=y3(e,n.x,n.width),i=y3(t,n.y,n.height);return`${r} ${i}`}function tC(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},h,f){if(eC(n,c,f),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:x}=n;m.transform&&(x&&(y.transform=m.transform),delete m.transform),x&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=uie(x,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),a!==void 0&&cie(m,a,o,l,!1)}const nC=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),I9=()=>({...nC(),attrs:{}}),rC=n=>typeof n=="string"&&n.toLowerCase()==="svg";function C9(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const P9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function k9(n,e,t,r){C9(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(P9.has(i)?i:XI(i),e.attrs[i])}const Ev={};function hie(n){Object.assign(Ev,n)}function M9(n,{layout:e,layoutId:t}){return Md.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Ev[n]||n==="opacity")}function iC(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(os(i[a])||e.style&&os(e.style[a])||M9(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function N9(n,e,t){const r=iC(n,e,t);for(const i in n)if(os(n[i])||os(e[i])){const s=cg.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function die(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const _3=["x","y","width","height","cx","cy","r"],fie={useVisualState:T9({scrapeMotionValuesFromProps:N9,createRenderState:I9,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(Md.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<_3.length;o++){const l=_3[o];n[l]!==e[l]&&(a=!0)}a&&fr.read(()=>{die(t,r),fr.render(()=>{tC(r,i,rC(t.tagName),n.transformTemplate),k9(t,r)})})}})},gie={useVisualState:T9({scrapeMotionValuesFromProps:iC,createRenderState:nC})};function L9(n,e,t){for(const r in e)!os(e[r])&&!M9(r,t)&&(n[r]=e[r])}function mie({transformTemplate:n},e){return X.useMemo(()=>{const t=nC();return eC(t,e,n),Object.assign({},t.vars,t.style)},[e])}function pie(n,e){const t=n.style||{},r={};return L9(r,t,n),Object.assign(r,mie(n,e)),r}function yie(n,e){const t={},r=pie(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function _ie(n,e,t,r){const i=X.useMemo(()=>{const s=I9();return tC(s,e,rC(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};L9(s,n.style,n),i.style={...s,...i.style}}return i}function xie(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(YI(t)?_ie:yie)(r,s,a,t),c=Lre(r,typeof t=="string",n),h=t!==X.Fragment?{...c,...l,ref:i}:{},{children:f}=r,m=X.useMemo(()=>os(f)?f.get():f,[f]);return X.createElement(t,{...h,children:m})}}function vie(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...YI(r)?fie:gie,preloadedFeatures:n,useRender:xie(i),createVisualElement:e,Component:r};return zre(a)}}function O9(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function fw(n,e,t){const r=n.getProps();return ZI(r,e,t!==void 0?t:r.custom,n)}const Eie=WI(()=>window.ScrollTimeline!==void 0);class wie{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(Eie()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Sie extends wie{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function sC(n,e){return n?n[e]||n.default||n:void 0}const Jb=2e4;function D9(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<Jb;)e+=t,r=n.next(e);return e>=Jb?1/0:e}function aC(n){return typeof n=="function"}function x3(n,e){n.timeline=e,n.onfinish=null}const oC=n=>Array.isArray(n)&&typeof n[0]=="number",Tie={linearEasing:void 0};function bie(n,e){const t=WI(n);return()=>{var r;return(r=Tie[e])!==null&&r!==void 0?r:t()}}const wv=bie(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),F9=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(H0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function j9(n){return!!(typeof n=="function"&&wv()||!n||typeof n=="string"&&(n in eA||wv())||oC(n)||Array.isArray(n)&&n.every(j9))}const Tm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,eA={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Tm([0,.65,.55,1]),circOut:Tm([.55,0,1,.45]),backIn:Tm([.31,.01,.66,-.59]),backOut:Tm([.33,1.53,.69,.99])};function V9(n,e){if(n)return typeof n=="function"&&wv()?F9(n,e):oC(n)?Tm(n):Array.isArray(n)?n.map(t=>V9(t,e)||eA.easeOut):eA[n]}const ro={x:!1,y:!1};function G9(){return ro.x||ro.y}function Aie(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function B9(n,e){const t=Aie(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function v3(n){return e=>{e.pointerType==="touch"||G9()||n(e)}}function Rie(n,e,t={}){const[r,i,s]=B9(n,t),a=v3(o=>{const{target:l}=o,c=e(o);if(typeof c!="function"||!l)return;const h=v3(f=>{c(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const U9=(n,e)=>e?n===e?!0:U9(n,e.parentElement):!1,lC=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Iie=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Cie(n){return Iie.has(n.tagName)||n.tabIndex!==-1}const bm=new WeakSet;function E3(n){return e=>{e.key==="Enter"&&n(e)}}function aT(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Pie=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=E3(()=>{if(bm.has(t))return;aT(t,"down");const i=E3(()=>{aT(t,"up")}),s=()=>aT(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function w3(n){return lC(n)&&!G9()}function kie(n,e,t={}){const[r,i,s]=B9(n,t),a=o=>{const l=o.currentTarget;if(!w3(o)||bm.has(l))return;bm.add(l);const c=e(o),h=(y,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),!(!w3(y)||!bm.has(l))&&(bm.delete(l),typeof c=="function"&&c(y,{success:x}))},f=y=>{h(y,t.useGlobalTarget||U9(l,y.target))},m=y=>{h(y,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",m,i)};return r.forEach(o=>{!Cie(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",c=>Pie(c,i),i)}),s}function Mie(n){return n==="x"||n==="y"?ro[n]?null:(ro[n]=!0,()=>{ro[n]=!1}):ro.x||ro.y?null:(ro.x=ro.y=!0,()=>{ro.x=ro.y=!1})}const z9=new Set(["width","height","top","left","right","bottom",...cg]);let fx;function Nie(){fx=void 0}const al={now:()=>(fx===void 0&&al.set(Vi.isProcessing||Ire.useManualTiming?Vi.timestamp:performance.now()),fx),set:n=>{fx=n,queueMicrotask(Nie)}};function cC(n,e){n.indexOf(e)===-1&&n.push(e)}function uC(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class hC{constructor(){this.subscriptions=[]}add(e){return cC(this.subscriptions,e),()=>uC(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function $9(n,e){return e?n*(1e3/e):0}const S3=30,Lie=n=>!isNaN(parseFloat(n));class Oie{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=al.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=al.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Lie(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new hC);const r=this.events[e].add(t);return e==="change"?()=>{r(),fr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=al.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>S3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,S3);return $9(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Up(n,e){return new Oie(n,e)}function Die(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Up(t))}function Fie(n,e){const t=fw(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=qre(s[a]);Die(n,a,o)}}function jie(n){return!!(os(n)&&n.add)}function tA(n,e){const t=n.getValue("willChange");if(jie(t))return t.add(e)}function W9(n){return n.props[E9]}const H9=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,Vie=1e-7,Gie=12;function Bie(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=H9(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>Vie&&++o<Gie);return a}function V1(n,e,t,r){if(n===e&&t===r)return ha;const i=s=>Bie(s,0,1,n,t);return s=>s===0||s===1?s:H9(i(s),e,r)}const K9=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,X9=n=>e=>1-n(1-e),q9=V1(.33,1.53,.69,.99),dC=X9(q9),Y9=K9(dC),Z9=n=>(n*=2)<1?.5*dC(n):.5*(2-Math.pow(2,-10*(n-1))),fC=n=>1-Math.sin(Math.acos(n)),Q9=X9(fC),J9=K9(fC),e7=n=>/^0[^.\s]+$/u.test(n);function Uie(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||e7(n):!0}const $m=n=>Math.round(n*1e5)/1e5,gC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function zie(n){return n==null}const $ie=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,mC=(n,e)=>t=>!!(typeof t=="string"&&$ie.test(t)&&t.startsWith(n)||e&&!zie(t)&&Object.prototype.hasOwnProperty.call(t,e)),t7=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(gC);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Wie=n=>ac(0,255,n),oT={...ug,transform:n=>Math.round(Wie(n))},Gh={test:mC("rgb","red"),parse:t7("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+oT.transform(n)+", "+oT.transform(e)+", "+oT.transform(t)+", "+$m(Bp.transform(r))+")"};function Hie(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const nA={test:mC("#"),parse:Hie,transform:Gh.transform},Qf={test:mC("hsl","hue"),parse:t7("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+sl.transform($m(e))+", "+sl.transform($m(t))+", "+$m(Bp.transform(r))+")"},ns={test:n=>Gh.test(n)||nA.test(n)||Qf.test(n),parse:n=>Gh.test(n)?Gh.parse(n):Qf.test(n)?Qf.parse(n):nA.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Gh.transform(n):Qf.transform(n)},Kie=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Xie(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(gC))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Kie))===null||t===void 0?void 0:t.length)||0)>0}const n7="number",r7="color",qie="var",Yie="var(",T3="${}",Zie=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function zp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Zie,l=>(ns.test(l)?(r.color.push(s),i.push(r7),t.push(ns.parse(l))):l.startsWith(Yie)?(r.var.push(s),i.push(qie),t.push(l)):(r.number.push(s),i.push(n7),t.push(parseFloat(l))),++s,T3)).split(T3);return{values:t,split:o,indexes:r,types:i}}function i7(n){return zp(n).values}function s7(n){const{split:e,types:t}=zp(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===n7?s+=$m(i[a]):o===r7?s+=ns.transform(i[a]):s+=i[a]}return s}}const Qie=n=>typeof n=="number"?0:n;function Jie(n){const e=i7(n);return s7(n)(e.map(Qie))}const Nu={test:Xie,parse:i7,createTransformer:s7,getAnimatableNone:Jie},ese=new Set(["brightness","contrast","saturate","opacity"]);function tse(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(gC)||[];if(!r)return n;const i=t.replace(r,"");let s=ese.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const nse=/\b([a-z-]*)\(.*?\)/gu,rA={...Nu,getAnimatableNone:n=>{const e=n.match(nse);return e?e.map(tse).join(" "):n}},rse={...JI,color:ns,backgroundColor:ns,outlineColor:ns,fill:ns,stroke:ns,borderColor:ns,borderTopColor:ns,borderRightColor:ns,borderBottomColor:ns,borderLeftColor:ns,filter:rA,WebkitFilter:rA},pC=n=>rse[n];function a7(n,e){let t=pC(n);return t!==rA&&(t=Nu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const ise=new Set(["auto","none","0"]);function sse(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!ise.has(s)&&zp(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=a7(t,i)}const b3=n=>n===ug||n===Bt,A3=(n,e)=>parseFloat(n.split(", ")[e]),R3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return A3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?A3(s[1],n):0}},ase=new Set(["x","y","z"]),ose=cg.filter(n=>!ase.has(n));function lse(n){const e=[];return ose.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const X0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:R3(4,13),y:R3(5,14)};X0.translateX=X0.x;X0.translateY=X0.y;const qh=new Set;let iA=!1,sA=!1;function o7(){if(sA){const n=Array.from(qh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=lse(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}sA=!1,iA=!1,qh.forEach(n=>n.complete()),qh.clear()}function l7(){qh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(sA=!0)})}function cse(){l7(),o7()}class yC{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(qh.add(this),iA||(iA=!0,fr.read(l7),fr.resolveKeyframes(o7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),qh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,qh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const c7=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),use=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function hse(n){const e=use.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function u7(n,e,t=1){const[r,i]=hse(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return c7(a)?parseFloat(a):a}return QI(i)?u7(i,e,t+1):i}const h7=n=>e=>e.test(n),dse={test:n=>n==="auto",parse:n=>n},d7=[ug,Bt,sl,Qc,tie,eie,dse],I3=n=>d7.find(h7(n));class f7 extends yC{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),QI(c))){const h=u7(c,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!z9.has(r)||e.length!==2)return;const[i,s]=e,a=I3(i),o=I3(s);if(a!==o)if(b3(a)&&b3(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)Uie(e[i])&&r.push(i);r.length&&sse(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=X0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=X0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const C3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Nu.test(n)||n==="0")&&!n.startsWith("url("));function fse(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function gse(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=C3(i,e),o=C3(s,e);return!a||!o?!1:fse(n)||(t==="spring"||aC(t))&&r}const mse=n=>n!==null;function gw(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(mse),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const pse=40;class g7{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=al.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>pse?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&cse(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=al.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!gse(e,r,i,s))if(a)this.options.duration=0;else{l&&l(gw(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const kr=(n,e,t)=>n+(e-n)*t;function lT(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function yse({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=lT(l,o,n+1/3),s=lT(l,o,n),a=lT(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Sv(n,e){return t=>t>0?e:n}const cT=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},_se=[nA,Gh,Qf],xse=n=>_se.find(e=>e.test(n));function P3(n){const e=xse(n);if(!e)return!1;let t=e.parse(n);return e===Qf&&(t=yse(t)),t}const k3=(n,e)=>{const t=P3(n),r=P3(e);if(!t||!r)return Sv(n,e);const i={...t};return s=>(i.red=cT(t.red,r.red,s),i.green=cT(t.green,r.green,s),i.blue=cT(t.blue,r.blue,s),i.alpha=kr(t.alpha,r.alpha,s),Gh.transform(i))},vse=(n,e)=>t=>e(n(t)),G1=(...n)=>n.reduce(vse),aA=new Set(["none","hidden"]);function Ese(n,e){return aA.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function wse(n,e){return t=>kr(n,e,t)}function _C(n){return typeof n=="number"?wse:typeof n=="string"?QI(n)?Sv:ns.test(n)?k3:bse:Array.isArray(n)?m7:typeof n=="object"?ns.test(n)?k3:Sse:Sv}function m7(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>_C(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function Sse(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=_C(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Tse(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const bse=(n,e)=>{const t=Nu.createTransformer(e),r=zp(n),i=zp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?aA.has(n)&&!i.values.length||aA.has(e)&&!r.values.length?Ese(n,e):G1(m7(Tse(r,i),i.values),t):Sv(n,e)};function p7(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kr(n,e,t):_C(n)(n,e)}const Ase=5;function y7(n,e,t){const r=Math.max(e-Ase,0);return $9(t-n(r),e-r)}const Or={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},uT=.001;function Rse({duration:n=Or.duration,bounce:e=Or.bounce,velocity:t=Or.velocity,mass:r=Or.mass}){let i,s,a=1-e;a=ac(Or.minDamping,Or.maxDamping,a),n=ac(Or.minDuration,Or.maxDuration,Zl(n)),a<1?(i=c=>{const h=c*a,f=h*n,m=h-t,y=oA(c,a),x=Math.exp(-f);return uT-m/y*x},s=c=>{const f=c*a*n,m=f*t+t,y=Math.pow(a,2)*Math.pow(c,2)*n,x=Math.exp(-f),v=oA(Math.pow(c,2),a);return(-i(c)+uT>0?-1:1)*((m-y)*x)/v}):(i=c=>{const h=Math.exp(-c*n),f=(c-t)*n+1;return-uT+h*f},s=c=>{const h=Math.exp(-c*n),f=(t-c)*(n*n);return h*f});const o=5/n,l=Cse(i,s,o);if(n=Yl(n),isNaN(l))return{stiffness:Or.stiffness,damping:Or.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const Ise=12;function Cse(n,e,t){let r=t;for(let i=1;i<Ise;i++)r=r-n(r)/e(r);return r}function oA(n,e){return n*Math.sqrt(1-e*e)}const Pse=["duration","bounce"],kse=["stiffness","damping","mass"];function M3(n,e){return e.some(t=>n[t]!==void 0)}function Mse(n){let e={velocity:Or.velocity,stiffness:Or.stiffness,damping:Or.damping,mass:Or.mass,isResolvedFromDuration:!1,...n};if(!M3(n,kse)&&M3(n,Pse))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*ac(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Or.mass,stiffness:i,damping:s}}else{const t=Rse(n);e={...e,...t,mass:Or.mass},e.isResolvedFromDuration=!0}return e}function _7(n=Or.visualDuration,e=Or.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:h,duration:f,velocity:m,isResolvedFromDuration:y}=Mse({...t,velocity:-Zl(t.velocity||0)}),x=m||0,v=c/(2*Math.sqrt(l*h)),E=a-s,T=Zl(Math.sqrt(l/h)),b=Math.abs(E)<5;r||(r=b?Or.restSpeed.granular:Or.restSpeed.default),i||(i=b?Or.restDelta.granular:Or.restDelta.default);let A;if(v<1){const D=oA(T,v);A=U=>{const P=Math.exp(-v*T*U);return a-P*((x+v*T*E)/D*Math.sin(D*U)+E*Math.cos(D*U))}}else if(v===1)A=D=>a-Math.exp(-T*D)*(E+(x+T*E)*D);else{const D=T*Math.sqrt(v*v-1);A=U=>{const P=Math.exp(-v*T*U),R=Math.min(D*U,300);return a-P*((x+v*T*E)*Math.sinh(R)+D*E*Math.cosh(R))/D}}const M={calculatedDuration:y&&f||null,next:D=>{const U=A(D);if(y)o.done=D>=f;else{let P=0;v<1&&(P=D===0?Yl(x):y7(A,D,U));const R=Math.abs(P)<=r,k=Math.abs(a-U)<=i;o.done=R&&k}return o.value=o.done?a:U,o},toString:()=>{const D=Math.min(D9(M),Jb),U=F9(P=>M.next(D*P).value,D,30);return D+"ms "+U}};return M}function N3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:h}){const f=n[0],m={done:!1,value:f},y=R=>o!==void 0&&R<o||l!==void 0&&R>l,x=R=>o===void 0?l:l===void 0||Math.abs(o-R)<Math.abs(l-R)?o:l;let v=t*e;const E=f+v,T=a===void 0?E:a(E);T!==E&&(v=T-f);const b=R=>-v*Math.exp(-R/r),A=R=>T+b(R),M=R=>{const k=b(R),N=A(R);m.done=Math.abs(k)<=c,m.value=m.done?T:N};let D,U;const P=R=>{y(m.value)&&(D=R,U=_7({keyframes:[m.value,x(m.value)],velocity:y7(A,R,m.value),damping:i,stiffness:s,restDelta:c,restSpeed:h}))};return P(0),{calculatedDuration:null,next:R=>{let k=!1;return!U&&D===void 0&&(k=!0,M(R),P(R)),D!==void 0&&R>=D?U.next(R-D):(!k&&M(R),m)}}}const Nse=V1(.42,0,1,1),Lse=V1(0,0,.58,1),x7=V1(.42,0,.58,1),Ose=n=>Array.isArray(n)&&typeof n[0]!="number",Dse={linear:ha,easeIn:Nse,easeInOut:x7,easeOut:Lse,circIn:fC,circInOut:J9,circOut:Q9,backIn:dC,backInOut:Y9,backOut:q9,anticipate:Z9},L3=n=>{if(oC(n)){p9(n.length===4);const[e,t,r,i]=n;return V1(e,t,r,i)}else if(typeof n=="string")return Dse[n];return n};function Fse(n,e,t){const r=[],i=t||p7,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||ha:e;o=G1(l,o)}r.push(o)}return r}function jse(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(p9(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Fse(e,r,i),l=o.length,c=h=>{if(a&&h<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const m=H0(n[f],n[f+1],h);return o[f](m)};return t?h=>c(ac(n[0],n[s-1],h)):c}function Vse(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=H0(0,e,r);n.push(kr(t,1,i))}}function Gse(n){const e=[0];return Vse(e,n.length-1),e}function Bse(n,e){return n.map(t=>t*e)}function Use(n,e){return n.map(()=>e||x7).splice(0,n.length-1)}function Tv({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=Ose(r)?r.map(L3):L3(r),s={done:!1,value:e[0]},a=Bse(t&&t.length===e.length?t:Gse(e),n),o=jse(a,e,{ease:Array.isArray(i)?i:Use(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const zse=n=>{const e=({timestamp:t})=>n(t);return{start:()=>fr.update(e,!0),stop:()=>Mu(e),now:()=>Vi.isProcessing?Vi.timestamp:al.now()}},$se={decay:N3,inertia:N3,tween:Tv,keyframes:Tv,spring:_7},Wse=n=>n/100;class xC extends g7{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||yC,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=aC(t)?t:$se[t]||Tv;let l,c;o!==Tv&&typeof e[0]!="number"&&(l=G1(Wse,p7(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=D9(h));const{calculatedDuration:f}=h,m=f+i,y=m*(r+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:m,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:f}=r;if(this.startTime===null)return s.next(0);const{delay:m,repeat:y,repeatType:x,repeatDelay:v,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-m*(this.speed>=0?1:-1),b=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let A=this.currentTime,M=s;if(y){const R=Math.min(this.currentTime,h)/f;let k=Math.floor(R),N=R%1;!N&&R>=1&&(N=1),N===1&&k--,k=Math.min(k,y+1),k%2&&(x==="reverse"?(N=1-N,v&&(N-=v/f)):x==="mirror"&&(M=a)),A=ac(0,1,N)*f}const D=b?{done:!1,value:l[0]}:M.next(A);o&&(D.value=o(D.value));let{done:U}=D;!b&&c!==null&&(U=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&U);return P&&i!==void 0&&(D.value=gw(l,this.options,i)),E&&E(D.value),P&&this.finish(),D}get duration(){const{resolved:e}=this;return e?Zl(e.calculatedDuration):0}get time(){return Zl(this.currentTime)}set time(e){e=Yl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Zl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=zse,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Hse=new Set(["opacity","clipPath","filter","transform"]);function Kse(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const h=V9(o,i);return Array.isArray(h)&&(c.easing=h),n.animate(c,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Xse=WI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),bv=10,qse=2e4;function Yse(n){return aC(n.type)||n.type==="spring"||!j9(n.ease)}function Zse(n,e){const t=new xC({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<qse;)r=t.sample(s),i.push(r.value),s+=bv;return{times:void 0,keyframes:i,duration:s-bv,ease:"linear"}}const v7={anticipate:Z9,backInOut:Y9,circInOut:J9};function Qse(n){return n in v7}class O3 extends g7{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new f7(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&wv()&&Qse(s)&&(s=v7[s]),Yse(this.options)){const{onComplete:f,onUpdate:m,motionValue:y,element:x,...v}=this.options,E=Zse(e,v);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,i=E.times,s=E.ease,a="keyframes"}const h=Kse(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(x3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;o.set(gw(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Zl(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Zl(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Yl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return ha;const{animation:r}=t;x3(r,e)}return ha}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:f,element:m,...y}=this.options,x=new xC({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),v=Yl(this.time);c.setWithVelocity(x.sample(v-bv).value,x.sample(v).value,bv)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Xse()&&r&&Hse.has(r)&&!l&&!c&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Jse={type:"spring",stiffness:500,damping:25,restSpeed:10},eae=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),tae={type:"keyframes",duration:.8},nae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},rae=(n,{keyframes:e})=>e.length>2?tae:Md.has(n)?n.startsWith("scale")?eae(e[1]):Jse:nae;function iae({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const vC=(n,e,t,r={},i,s)=>a=>{const o=sC(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Yl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};iae(o)||(h={...h,...rae(n,h)}),h.duration&&(h.duration=Yl(h.duration)),h.repeatDelay&&(h.repeatDelay=Yl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!s&&e.get()!==void 0){const m=gw(h.keyframes,o);if(m!==void 0)return fr.update(()=>{h.onUpdate(m),h.onComplete()}),new Sie([])}return!s&&O3.supports(h)?new O3(h):new xC(h)};function sae({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function E7(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const c=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const f in l){const m=n.getValue(f,(s=n.latestValues[f])!==null&&s!==void 0?s:null),y=l[f];if(y===void 0||h&&sae(h,f))continue;const x={delay:t,...sC(a||{},f)};let v=!1;if(window.MotionHandoffAnimation){const T=W9(n);if(T){const b=window.MotionHandoffAnimation(T,f,fr);b!==null&&(x.startTime=b,v=!0)}}tA(n,f),m.start(vC(f,m,y,n.shouldReduceMotion&&z9.has(f)?{type:!1}:x,n,v));const E=m.animation;E&&c.push(E)}return o&&Promise.all(c).then(()=>{fr.update(()=>{o&&Fie(n,o)})}),c}function lA(n,e,t={}){var r;const i=fw(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(E7(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:m}=s;return aae(n,e,h+c,f,m,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,h]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function aae(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(n.variantChildren).sort(oae).forEach((c,h)=>{c.notify("AnimationStart",e),a.push(lA(c,e,{...s,delay:t+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(a)}function oae(n,e){return n.sortNodePosition(e)}function lae(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>lA(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=lA(n,e,t);else{const i=typeof e=="function"?fw(n,e,t.custom):e;r=Promise.all(E7(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const cae=KI.length;function w7(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?w7(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<cae;t++){const r=KI[t],i=n.props[r];(Gp(i)||i===!1)&&(e[r]=i)}return e}const uae=[...HI].reverse(),hae=HI.length;function dae(n){return e=>Promise.all(e.map(({animation:t,options:r})=>lae(n,t,r)))}function fae(n){let e=dae(n),t=D3(),r=!0;const i=l=>(c,h)=>{var f;const m=fw(n,h,l==="exit"?(f=n.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(m){const{transition:y,transitionEnd:x,...v}=m;c={...c,...v,...x}}return c};function s(l){e=l(n)}function a(l){const{props:c}=n,h=w7(n.parent)||{},f=[],m=new Set;let y={},x=1/0;for(let E=0;E<hae;E++){const T=uae[E],b=t[T],A=c[T]!==void 0?c[T]:h[T],M=Gp(A),D=T===l?b.isActive:null;D===!1&&(x=E);let U=A===h[T]&&A!==c[T]&&M;if(U&&r&&n.manuallyAnimateOnMount&&(U=!1),b.protectedKeys={...y},!b.isActive&&D===null||!A&&!b.prevProp||hw(A)||typeof A=="boolean")continue;const P=gae(b.prevProp,A);let R=P||T===l&&b.isActive&&!U&&M||E>x&&M,k=!1;const N=Array.isArray(A)?A:[A];let O=N.reduce(i(T),{});D===!1&&(O={});const{prevResolvedValues:z={}}=b,j={...z,...O},Re=Oe=>{R=!0,m.has(Oe)&&(k=!0,m.delete(Oe)),b.needsAnimating[Oe]=!0;const ce=n.getValue(Oe);ce&&(ce.liveStyle=!1)};for(const Oe in j){const ce=O[Oe],we=z[Oe];if(y.hasOwnProperty(Oe))continue;let Se=!1;Qb(ce)&&Qb(we)?Se=!O9(ce,we):Se=ce!==we,Se?ce!=null?Re(Oe):m.add(Oe):ce!==void 0&&m.has(Oe)?Re(Oe):b.protectedKeys[Oe]=!0}b.prevProp=A,b.prevResolvedValues=O,b.isActive&&(y={...y,...O}),r&&n.blockInitialAnimation&&(R=!1),R&&(!(U&&P)||k)&&f.push(...N.map(Oe=>({animation:Oe,options:{type:T}})))}if(m.size){const E={};m.forEach(T=>{const b=n.getBaseTarget(T),A=n.getValue(T);A&&(A.liveStyle=!0),E[T]=b??null}),f.push({animation:E})}let v=!!f.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(v=!1),r=!1,v?e(f):Promise.resolve()}function o(l,c){var h;if(t[l].isActive===c)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(l,c)}),t[l].isActive=c;const f=a(l);for(const m in t)t[m].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=D3(),r=!0}}}function gae(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!O9(e,n):!1}function yh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function D3(){return{animate:yh(!0),whileInView:yh(),whileHover:yh(),whileTap:yh(),whileDrag:yh(),whileFocus:yh(),exit:yh()}}class $u{constructor(e){this.isMounted=!1,this.node=e}update(){}}class mae extends $u{constructor(e){super(e),e.animationState||(e.animationState=fae(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();hw(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let pae=0;class yae extends $u{constructor(){super(...arguments),this.id=pae++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const _ae={animation:{Feature:mae},exit:{Feature:yae}};function $p(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function B1(n){return{point:{x:n.pageX,y:n.pageY}}}const xae=n=>e=>lC(e)&&n(e,B1(e));function Wm(n,e,t,r){return $p(n,e,xae(t),r)}const F3=(n,e)=>Math.abs(n-e);function vae(n,e){const t=F3(n.x,e.x),r=F3(n.y,e.y);return Math.sqrt(t**2+r**2)}class S7{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=dT(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=vae(f.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:x}=f,{timestamp:v}=Vi;this.history.push({...x,timestamp:v});const{onStart:E,onMove:T}=this.handlers;m||(E&&E(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=hT(m,this.transformPagePoint),fr.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:y,onSessionEnd:x,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=dT(f.type==="pointercancel"?this.lastMoveEventInfo:hT(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(f,E),x&&x(f,E)},!lC(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=B1(e),o=hT(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Vi;this.history=[{...l,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,dT(o,this.history)),this.removeListeners=G1(Wm(this.contextWindow,"pointermove",this.handlePointerMove),Wm(this.contextWindow,"pointerup",this.handlePointerUp),Wm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Mu(this.updatePoint)}}function hT(n,e){return e?{point:e(n.point)}:n}function j3(n,e){return{x:n.x-e.x,y:n.y-e.y}}function dT({point:n},e){return{point:n,delta:j3(n,T7(e)),offset:j3(n,Eae(e)),velocity:wae(e,.1)}}function Eae(n){return n[0]}function T7(n){return n[n.length-1]}function wae(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=T7(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Yl(e)));)t--;if(!r)return{x:0,y:0};const s=Zl(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const b7=1e-4,Sae=1-b7,Tae=1+b7,A7=.01,bae=0-A7,Aae=0+A7;function ga(n){return n.max-n.min}function Rae(n,e,t){return Math.abs(n-e)<=t}function V3(n,e,t,r=.5){n.origin=r,n.originPoint=kr(e.min,e.max,n.origin),n.scale=ga(t)/ga(e),n.translate=kr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=Sae&&n.scale<=Tae||isNaN(n.scale))&&(n.scale=1),(n.translate>=bae&&n.translate<=Aae||isNaN(n.translate))&&(n.translate=0)}function Hm(n,e,t,r){V3(n.x,e.x,t.x,r?r.originX:void 0),V3(n.y,e.y,t.y,r?r.originY:void 0)}function G3(n,e,t){n.min=t.min+e.min,n.max=n.min+ga(e)}function Iae(n,e,t){G3(n.x,e.x,t.x),G3(n.y,e.y,t.y)}function B3(n,e,t){n.min=e.min-t.min,n.max=n.min+ga(e)}function Km(n,e,t){B3(n.x,e.x,t.x),B3(n.y,e.y,t.y)}function Cae(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?kr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?kr(t,n,r.max):Math.min(n,t)),n}function U3(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Pae(n,{top:e,left:t,bottom:r,right:i}){return{x:U3(n.x,t,i),y:U3(n.y,e,r)}}function z3(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function kae(n,e){return{x:z3(n.x,e.x),y:z3(n.y,e.y)}}function Mae(n,e){let t=.5;const r=ga(n),i=ga(e);return i>r?t=H0(e.min,e.max-r,n.min):r>i&&(t=H0(n.min,n.max-i,e.min)),ac(0,1,t)}function Nae(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const cA=.35;function Lae(n=cA){return n===!1?n=0:n===!0&&(n=cA),{x:$3(n,"left","right"),y:$3(n,"top","bottom")}}function $3(n,e,t){return{min:W3(n,e),max:W3(n,t)}}function W3(n,e){return typeof n=="number"?n:n[e]||0}const H3=()=>({translate:0,scale:1,origin:0,originPoint:0}),Jf=()=>({x:H3(),y:H3()}),K3=()=>({min:0,max:0}),$r=()=>({x:K3(),y:K3()});function Ia(n){return[n("x"),n("y")]}function R7({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function Oae({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Dae(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function fT(n){return n===void 0||n===1}function uA({scale:n,scaleX:e,scaleY:t}){return!fT(n)||!fT(e)||!fT(t)}function bh(n){return uA(n)||I7(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function I7(n){return X3(n.x)||X3(n.y)}function X3(n){return n&&n!=="0%"}function Av(n,e,t){const r=n-t,i=e*r;return t+i}function q3(n,e,t,r,i){return i!==void 0&&(n=Av(n,i,r)),Av(n,t,r)+e}function hA(n,e=0,t=1,r,i){n.min=q3(n.min,e,t,r,i),n.max=q3(n.max,e,t,r,i)}function C7(n,{x:e,y:t}){hA(n.x,e.translate,e.scale,e.originPoint),hA(n.y,t.translate,t.scale,t.originPoint)}const Y3=.999999999999,Z3=1.0000000000001;function Fae(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&t0(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,C7(n,a)),r&&bh(s.latestValues)&&t0(n,s.latestValues))}e.x<Z3&&e.x>Y3&&(e.x=1),e.y<Z3&&e.y>Y3&&(e.y=1)}function e0(n,e){n.min=n.min+e,n.max=n.max+e}function Q3(n,e,t,r,i=.5){const s=kr(n.min,n.max,i);hA(n,e,t,s,r)}function t0(n,e){Q3(n.x,e.x,e.scaleX,e.scale,e.originX),Q3(n.y,e.y,e.scaleY,e.scale,e.originY)}function P7(n,e){return R7(Dae(n.getBoundingClientRect(),e))}function jae(n,e,t){const r=P7(n,t),{scroll:i}=e;return i&&(e0(r.x,i.offset.x),e0(r.y,i.offset.y)),r}const k7=({current:n})=>n?n.ownerDocument.defaultView:null,Vae=new WeakMap;class Gae{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$r(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(B1(h).point)},s=(h,f)=>{const{drag:m,dragPropagation:y,onDragStart:x}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Mie(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ia(E=>{let T=this.getAxisMotionValue(E).get()||0;if(sl.test(T)){const{projection:b}=this.visualElement;if(b&&b.layout){const A=b.layout.layoutBox[E];A&&(T=ga(A)*(parseFloat(T)/100))}}this.originPoint[E]=T}),x&&fr.postRender(()=>x(h,f)),tA(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:x,onDrag:v}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:E}=f;if(y&&this.currentDirection===null){this.currentDirection=Bae(E),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,E),this.updateAxis("y",f.point,E),this.visualElement.render(),v&&v(h,f)},o=(h,f)=>this.stop(h,f),l=()=>Ia(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new S7(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:k7(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&fr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!P_(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=Cae(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Zf(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Pae(i.layoutBox,t):this.constraints=!1,this.elastic=Lae(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ia(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Nae(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Zf(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=jae(r,i.root,this.visualElement.getTransformPagePoint());let a=kae(i.layout.layoutBox,s);if(t){const o=t(Oae(a));this.hasMutatedConstraints=!!o,o&&(a=R7(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ia(h=>{if(!P_(h,t,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const m=i?200:1e6,y=i?40:1e7,x={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,x)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return tA(this.visualElement,e),r.start(vC(e,r,0,t,this.visualElement,!1))}stopAnimation(){Ia(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ia(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ia(t=>{const{drag:r}=this.getProps();if(!P_(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-kr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Zf(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ia(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=Mae({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ia(a=>{if(!P_(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(kr(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;Vae.set(this.visualElement,this);const e=this.visualElement.current,t=Wm(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Zf(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),fr.read(r);const a=$p(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ia(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=cA,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function P_(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Bae(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Uae extends $u{constructor(e){super(e),this.removeGroupControls=ha,this.removeListeners=ha,this.controls=new Gae(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ha}unmount(){this.removeGroupControls(),this.removeListeners()}}const J3=n=>(e,t)=>{n&&fr.postRender(()=>n(e,t))};class zae extends $u{constructor(){super(...arguments),this.removePointerDownListener=ha}onPointerDown(e){this.session=new S7(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:k7(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:J3(e),onStart:J3(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&fr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Wm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const gx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function eO(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const dm={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Bt.test(n))n=parseFloat(n);else return n;const t=eO(n,e.target.x),r=eO(n,e.target.y);return`${t}% ${r}%`}},$ae={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=Nu.parse(n);if(i.length>5)return r;const s=Nu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const c=kr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class Wae extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;hie(Hae),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),gx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||fr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),qI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function M7(n){const[e,t]=g9(),r=X.useContext(BI);return g.jsx(Wae,{...n,layoutGroup:r,switchLayoutGroup:X.useContext(w9),isPresent:e,safeToRemove:t})}const Hae={borderRadius:{...dm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:dm,borderTopRightRadius:dm,borderBottomLeftRadius:dm,borderBottomRightRadius:dm,boxShadow:$ae};function Kae(n,e,t){const r=os(n)?n:Up(n);return r.start(vC("",r,e,t)),r.animation}function Xae(n){return n instanceof SVGElement&&n.tagName!=="svg"}const qae=(n,e)=>n.depth-e.depth;class Yae{constructor(){this.children=[],this.isDirty=!1}add(e){cC(this.children,e),this.isDirty=!0}remove(e){uC(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(qae),this.isDirty=!1,this.children.forEach(e)}}function Zae(n,e){const t=al.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(Mu(r),n(s-e))};return fr.read(r,!0),()=>Mu(r)}const N7=["TopLeft","TopRight","BottomLeft","BottomRight"],Qae=N7.length,tO=n=>typeof n=="string"?parseFloat(n):n,nO=n=>typeof n=="number"||Bt.test(n);function Jae(n,e,t,r,i,s){i?(n.opacity=kr(0,t.opacity!==void 0?t.opacity:1,eoe(r)),n.opacityExit=kr(e.opacity!==void 0?e.opacity:1,0,toe(r))):s&&(n.opacity=kr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Qae;a++){const o=`border${N7[a]}Radius`;let l=rO(e,o),c=rO(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||nO(l)===nO(c)?(n[o]=Math.max(kr(tO(l),tO(c),r),0),(sl.test(c)||sl.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=kr(e.rotate||0,t.rotate||0,r))}function rO(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const eoe=L7(0,.5,Q9),toe=L7(.5,.95,ha);function L7(n,e,t){return r=>r<n?0:r>e?1:t(H0(n,e,r))}function iO(n,e){n.min=e.min,n.max=e.max}function Aa(n,e){iO(n.x,e.x),iO(n.y,e.y)}function sO(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function aO(n,e,t,r,i){return n-=e,n=Av(n,1/t,r),i!==void 0&&(n=Av(n,1/i,r)),n}function noe(n,e=0,t=1,r=.5,i,s=n,a=n){if(sl.test(e)&&(e=parseFloat(e),e=kr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=kr(s.min,s.max,r);n===s&&(o-=e),n.min=aO(n.min,e,t,o,i),n.max=aO(n.max,e,t,o,i)}function oO(n,e,[t,r,i],s,a){noe(n,e[t],e[r],e[i],e.scale,s,a)}const roe=["x","scaleX","originX"],ioe=["y","scaleY","originY"];function lO(n,e,t,r){oO(n.x,e,roe,t?t.x:void 0,r?r.x:void 0),oO(n.y,e,ioe,t?t.y:void 0,r?r.y:void 0)}function cO(n){return n.translate===0&&n.scale===1}function O7(n){return cO(n.x)&&cO(n.y)}function uO(n,e){return n.min===e.min&&n.max===e.max}function soe(n,e){return uO(n.x,e.x)&&uO(n.y,e.y)}function hO(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function D7(n,e){return hO(n.x,e.x)&&hO(n.y,e.y)}function dO(n){return ga(n.x)/ga(n.y)}function fO(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class aoe{constructor(){this.members=[]}add(e){cC(this.members,e),e.scheduleRender()}remove(e){if(uC(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ooe(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:h,rotateX:f,rotateY:m,skewX:y,skewY:x}=t;c&&(r=`perspective(${c}px) ${r}`),h&&(r+=`rotate(${h}deg) `),f&&(r+=`rotateX(${f}deg) `),m&&(r+=`rotateY(${m}deg) `),y&&(r+=`skewX(${y}deg) `),x&&(r+=`skewY(${x}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Ah={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Am=typeof window<"u"&&window.MotionDebug!==void 0,gT=["","X","Y","Z"],loe={visibility:"hidden"},gO=1e3;let coe=0;function mT(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function F7(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=W9(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",fr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&F7(r)}function j7({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=coe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Am&&(Ah.totalNodes=Ah.resolvedTargetDeltas=Ah.recalculatedProjection=0),this.nodes.forEach(doe),this.nodes.forEach(yoe),this.nodes.forEach(_oe),this.nodes.forEach(foe),Am&&window.MotionDebug.record(Ah)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Yae)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new hC),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Xae(a),this.instance=a;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let f;const m=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Zae(m,250),gx.hasAnimatedSinceResize&&(gx.hasAnimatedSinceResize=!1,this.nodes.forEach(pO))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:y,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||h.getDefaultTransition()||Soe,{onLayoutAnimationStart:E,onLayoutAnimationComplete:T}=h.getProps(),b=!this.targetLayout||!D7(this.targetLayout,x)||y,A=!m&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||A||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,A);const M={...sC(v,"layout"),onPlay:E,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else m||pO(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Mu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(xoe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&F7(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(mO);return}this.isUpdating||this.nodes.forEach(moe),this.isUpdating=!1,this.nodes.forEach(poe),this.nodes.forEach(uoe),this.nodes.forEach(hoe),this.clearAllSnapshots();const o=al.now();Vi.delta=ac(0,1e3/60,o-Vi.timestamp),Vi.timestamp=o,Vi.isProcessing=!0,sT.update.process(Vi),sT.preRender.process(Vi),sT.render.process(Vi),Vi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,qI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(goe),this.sharedNodes.forEach(voe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,fr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){fr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$r(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!O7(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;a&&(o||bh(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Toe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return $r();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(boe))){const{scroll:h}=this.root;h&&(e0(l.x,h.offset.x),e0(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=$r();if(Aa(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:f,options:m}=h;h!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&Aa(l,a),e0(l.x,f.offset.x),e0(l.y,f.offset.y))}return l}applyTransform(a,o=!1){const l=$r();Aa(l,a);for(let c=0;c<this.path.length;c++){const h=this.path[c];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&t0(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),bh(h.latestValues)&&t0(l,h.latestValues)}return bh(this.latestValues)&&t0(l,this.latestValues),l}removeTransform(a){const o=$r();Aa(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!bh(c.latestValues))continue;uA(c.latestValues)&&c.updateSnapshot();const h=$r(),f=c.measurePageBox();Aa(h,f),lO(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return bh(this.latestValues)&&lO(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Vi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=Vi.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),Km(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),Aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=$r(),this.targetWithTransforms=$r()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Iae(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Aa(this.target,this.layout.layoutBox),C7(this.target,this.targetDelta)):Aa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),Km(this.relativeTargetOrigin,this.target,y.target),Aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Am&&Ah.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||uA(this.parent.latestValues)||I7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Vi.timestamp&&(c=!1),c)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;Aa(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,y=this.treeScale.y;Fae(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=$r());const{target:x}=o;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(sO(this.prevProjectionDelta.x,this.projectionDelta.x),sO(this.prevProjectionDelta.y,this.projectionDelta.y)),Hm(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==y||!fO(this.projectionDelta.x,this.prevProjectionDelta.x)||!fO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),Am&&Ah.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Jf(),this.projectionDelta=Jf(),this.projectionDeltaWithTransform=Jf()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},f=Jf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=$r(),y=l?l.source:void 0,x=this.layout?this.layout.source:void 0,v=y!==x,E=this.getStack(),T=!E||E.members.length<=1,b=!!(v&&!T&&this.options.crossfade===!0&&!this.path.some(woe));this.animationProgress=0;let A;this.mixTargetDelta=M=>{const D=M/1e3;yO(f.x,a.x,D),yO(f.y,a.y,D),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Km(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Eoe(this.relativeTarget,this.relativeTargetOrigin,m,D),A&&soe(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=$r()),Aa(A,this.relativeTarget)),v&&(this.animationValues=h,Jae(h,c,this.latestValues,D,b,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Mu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=fr.update(()=>{gx.hasAnimatedSinceResize=!0,this.currentAnimation=Kae(0,gO,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gO),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:h}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&V7(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||$r();const f=ga(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const m=ga(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}Aa(o,l),t0(o,h),Hm(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new aoe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&mT("z",a,c,this.animationValues);for(let h=0;h<gT.length;h++)mT(`rotate${gT[h]}`,a,c,this.animationValues),mT(`skew${gT[h]}`,a,c,this.animationValues);a.render();for(const h in c)a.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return loe;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=dx(a?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=dx(a?.pointerEvents)||""),this.hasProjected&&!bh(this.latestValues)&&(v.transform=h?h({},""):"none",this.hasProjected=!1),v}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),c.transform=ooe(this.projectionDeltaWithTransform,this.treeScale,m),h&&(c.transform=h(m,c.transform));const{x:y,y:x}=this.projectionDelta;c.transformOrigin=`${y.origin*100}% ${x.origin*100}% 0`,f.animationValues?c.opacity=f===this?(l=(o=m.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:c.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const v in Ev){if(m[v]===void 0)continue;const{correct:E,applyTo:T}=Ev[v],b=c.transform==="none"?m[v]:E(m[v],f);if(T){const A=T.length;for(let M=0;M<A;M++)c[T[M]]=b}else c[v]=b}return this.options.layoutId&&(c.pointerEvents=f===this?dx(a?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(mO),this.root.sharedNodes.clear()}}}function uoe(n){n.updateLayout()}function hoe(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?Ia(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],y=ga(m);m.min=r[f].min,m.max=m.min+y}):V7(s,t.layoutBox,r)&&Ia(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],y=ga(r[f]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+y)});const o=Jf();Hm(o,r,t.layoutBox);const l=Jf();a?Hm(l,n.applyTransform(i,!0),t.measuredBox):Hm(l,r,t.layoutBox);const c=!O7(o);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:y}=f;if(m&&y){const x=$r();Km(x,t.layoutBox,m.layoutBox);const v=$r();Km(v,r,y.layoutBox),D7(x,v)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=v,n.relativeTargetOrigin=x,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function doe(n){Am&&Ah.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function foe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function goe(n){n.clearSnapshot()}function mO(n){n.clearMeasurements()}function moe(n){n.isLayoutDirty=!1}function poe(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function pO(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function yoe(n){n.resolveTargetDelta()}function _oe(n){n.calcProjection()}function xoe(n){n.resetSkewAndRotation()}function voe(n){n.removeLeadSnapshot()}function yO(n,e,t){n.translate=kr(e.translate,0,t),n.scale=kr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function _O(n,e,t,r){n.min=kr(e.min,t.min,r),n.max=kr(e.max,t.max,r)}function Eoe(n,e,t,r){_O(n.x,e.x,t.x,r),_O(n.y,e.y,t.y,r)}function woe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Soe={duration:.45,ease:[.4,0,.1,1]},xO=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),vO=xO("applewebkit/")&&!xO("chrome/")?Math.round:ha;function EO(n){n.min=vO(n.min),n.max=vO(n.max)}function Toe(n){EO(n.x),EO(n.y)}function V7(n,e,t){return n==="position"||n==="preserve-aspect"&&!Rae(dO(e),dO(t),.2)}function boe(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const Aoe=j7({attachResizeListener:(n,e)=>$p(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),pT={current:void 0},G7=j7({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!pT.current){const n=new Aoe({});n.mount(window),n.setOptions({layoutScroll:!0}),pT.current=n}return pT.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),Roe={pan:{Feature:zae},drag:{Feature:Uae,ProjectionNode:G7,MeasureLayout:M7}};function wO(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&fr.postRender(()=>s(e,B1(e)))}class Ioe extends $u{mount(){const{current:e}=this.node;e&&(this.unmount=Rie(e,t=>(wO(this.node,t,"Start"),r=>wO(this.node,r,"End"))))}unmount(){}}class Coe extends $u{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=G1($p(this.node.current,"focus",()=>this.onFocus()),$p(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function SO(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&fr.postRender(()=>s(e,B1(e)))}class Poe extends $u{mount(){const{current:e}=this.node;e&&(this.unmount=kie(e,t=>(SO(this.node,t,"Start"),(r,{success:i})=>SO(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const dA=new WeakMap,yT=new WeakMap,koe=n=>{const e=dA.get(n.target);e&&e(n)},Moe=n=>{n.forEach(koe)};function Noe({root:n,...e}){const t=n||document;yT.has(t)||yT.set(t,{});const r=yT.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Moe,{root:n,...e})),r[i]}function Loe(n,e,t){const r=Noe(e);return dA.set(n,t),r.observe(n),()=>{dA.delete(n),r.unobserve(n)}}const Ooe={some:0,all:1};class Doe extends $u{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Ooe[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),m=c?h:f;m&&m(l)};return Loe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Foe(e,t))&&this.startObserver()}unmount(){}}function Foe({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const joe={inView:{Feature:Doe},tap:{Feature:Poe},focus:{Feature:Coe},hover:{Feature:Ioe}},Voe={layout:{ProjectionNode:G7,MeasureLayout:M7}},fA={current:null},B7={current:!1};function Goe(){if(B7.current=!0,!!$I)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>fA.current=n.matches;n.addListener(e),e()}else fA.current=!1}const Boe=[...d7,ns,Nu],Uoe=n=>Boe.find(h7(n)),TO=new WeakMap;function zoe(n,e,t){for(const r in e){const i=e[r],s=t[r];if(os(i))n.addValue(r,i);else if(os(s))n.addValue(r,Up(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,Up(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const bO=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class $oe{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=yC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=al.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,fr.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=dw(t),this.isVariantNode=v9(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in m){const x=m[y];l[y]!==void 0&&os(x)&&x.set(l[y],!1)}}mount(e){this.current=e,TO.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),B7.current||Goe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:fA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){TO.delete(this.current),this.projection&&this.projection.unmount(),Mu(this.notifyUpdate),Mu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Md.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&fr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in K0){const t=K0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$r()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<bO.length;r++){const i=bO[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=zoe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Up(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(c7(i)||e7(i))?i=parseFloat(i):!Uoe(i)&&Nu.test(t)&&(i=a7(e,t)),this.setBaseTarget(e,os(i)?i.get():i)),os(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=ZI(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!os(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new hC),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class U7 extends $oe{constructor(){super(...arguments),this.KeyframeResolver=f7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;os(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Woe(n){return window.getComputedStyle(n)}class Hoe extends U7{constructor(){super(...arguments),this.type="html",this.renderInstance=C9}readValueFromInstance(e,t){if(Md.has(t)){const r=pC(t);return r&&r.default||0}else{const r=Woe(e),i=(A9(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return P7(e,t)}build(e,t,r){eC(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return iC(e,t,r)}}class Koe extends U7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$r}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Md.has(t)){const r=pC(t);return r&&r.default||0}return t=P9.has(t)?t:XI(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return N9(e,t,r)}build(e,t,r){tC(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){k9(e,t,r,i)}mount(e){this.isSVGTag=rC(e.tagName),super.mount(e)}}const Xoe=(n,e)=>YI(n)?new Koe(e):new Hoe(e,{allowProjection:n!==X.Fragment}),qoe=vie({..._ae,...joe,...Roe,...Voe},Xoe),wt=Ore(qoe);const Yoe=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Zoe=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),AO=n=>{const e=Zoe(n);return e.charAt(0).toUpperCase()+e.slice(1)},z7=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Qoe=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Joe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ele=X.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>X.createElement("svg",{ref:l,...Joe,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:z7("lucide",i),...!s&&!Qoe(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,h])=>X.createElement(c,h)),...Array.isArray(s)?s:[s]]));const ot=(n,e)=>{const t=X.forwardRef(({className:r,...i},s)=>X.createElement(ele,{ref:s,iconNode:e,className:z7(`lucide-${Yoe(AO(n))}`,`lucide-${n}`,r),...i}));return t.displayName=AO(n),t};const tle=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],nle=ot("archive-restore",tle);const rle=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],$7=ot("archive",rle);const ile=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],sle=ot("ban",ile);const ale=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ole=ot("book-open",ale);const lle=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],W7=ot("bug",lle);const cle=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],EC=ot("calendar",cle);const ule=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],mw=ot("camera",ule);const hle=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],H7=ot("chart-column",hle);const dle=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],oc=ot("check",dle);const fle=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],wC=ot("chevron-down",fle);const gle=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],mle=ot("chevron-left",gle);const ple=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],pw=ot("chevron-right",ple);const yle=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],K7=ot("chevron-up",yle);const _le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],X7=ot("circle-alert",_le);const xle=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],vle=ot("circle-check-big",xle);const Ele=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Rv=ot("clock",Ele);const wle=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],Sle=ot("cloud-off",wle);const Tle=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],gA=ot("cloud",Tle);const ble=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Ale=ot("code",ble);const Rle=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ile=ot("compass",Rle);const Cle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],Iv=ot("crosshair",Cle);const Ple=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Cv=ot("download",Ple);const kle=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],U1=ot("external-link",kle);const Mle=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Pv=ot("eye-off",Mle);const Nle=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],kv=ot("eye",Nle);const Lle=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],SC=ot("file-text",Lle);const Ole=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Dle=ot("flame",Ole);const Fle=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],jle=ot("folder-open",Fle);const Vle=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Gle=ot("folder-plus",Vle);const Ble=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ule=ot("folder",Ble);const zle=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],$le=ot("gauge",zle);const Wle=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Hle=ot("gem",Wle);const Kle=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],q7=ot("grid-3x3",Kle);const Xle=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],qle=ot("image-plus",Xle);const Yle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],TC=ot("info",Yle);const Zle=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],yo=ot("layers",Zle);const Qle=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Y7=ot("list",Qle);const Jle=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],bC=ot("loader-circle",Jle);const ece=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],tce=ot("locate-fixed",ece);const nce=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],mA=ot("lock",nce);const rce=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],AC=ot("log-out",rce);const ice=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],za=ot("map-pin",ice);const sce=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],RC=ot("map",sce);const ace=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],oce=ot("menu",ace);const lce=[["path",{d:"M5 12h14",key:"1ays0h"}]],Z7=ot("minus",lce);const cce=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],q0=ot("mountain",cce);const uce=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],hce=ot("mouse-pointer",uce);const dce=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],IC=ot("navigation",dce);const fce=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],gce=ot("pause",fce);const mce=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],RO=ot("pen-line",mce);const pce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],yce=ot("pen",pce);const _ce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Y0=ot("pencil",_ce);const xce=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],vce=ot("play",xce);const Ece=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$a=ot("plus",Ece);const wce=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Sce=ot("rotate-ccw",wce);const Tce=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],bce=ot("rotate-cw",Tce);const Ace=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Mv=ot("route",Ace);const Rce=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Wp=ot("ruler",Rce);const Ice=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Q7=ot("save",Ice);const Cce=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Pce=ot("scale",Cce);const kce=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],pA=ot("search",kce);const Mce=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],yA=ot("settings",Mce);const Nce=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Lce=ot("settings-2",Nce);const Oce=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Dce=ot("share-2",Oce);const Fce=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],jce=ot("shield",Fce);const Vce=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Gce=ot("sliders-horizontal",Vce);const Bce=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],Uce=ot("sliders-vertical",Bce);const zce=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],$ce=ot("smartphone",zce);const Wce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Hce=ot("square",Wce);const Kce=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Xce=ot("tag",Kce);const qce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Yce=ot("target",qce);const Zce=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Qce=ot("timer",Zce);const Jce=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],mc=ot("trash-2",Jce);const eue=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],tue=ot("tree-palm",eue);const nue=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],rue=ot("trending-down",nue);const iue=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],sue=ot("trending-up",iue);const aue=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],oue=ot("type",aue);const lue=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],z1=ot("upload",lue);const cue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],CC=ot("user",cue);const uue=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],hue=ot("waves",uue);const due=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],si=ot("x",due);function fue(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=_s(),a=X.useCallback(l=>{r(l)},[r]),o=X.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return X.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function gue(){const{tracking:n,toggle:e}=fue();return g.jsx(wt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:g.jsx(tce,{size:22,strokeWidth:2})})}const mue="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function pue(){const n=pi(y=>y.map),e=_s(y=>y.position),t=_s(y=>y.accuracy),r=_s(y=>y.tracking),i=_s(y=>y.smoothHeading),s=Gr(y=>y.showAccuracyCircle),a=_s(y=>y.firstFix),o=_s(y=>y.resetFirstFix),l=_s(y=>y.config.centerOnUser),c=X.useRef(null),h=X.useRef(null),f=X.useRef(null),m=X.useMemo(()=>y=>new mn({image:new m1({src:mue,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return X.useEffect(()=>{if(!n||!r&&!e)return;const y=Ir([5.1214,52.0907]);return c.current=new vr({geometry:new gi(y)}),c.current.setStyle(m(0)),h.current=new vr({geometry:new gi(y)}),f.current=new Gu({source:new hc({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,r,e,m]),X.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const y=Ir([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,v=Math.min(t/x,80);h.current.setStyle(new mn({image:new Us({radius:v,fill:new er({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new mn({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),X.useEffect(()=>{if(!c.current)return;const y=i!==null?i*Math.PI/180:0;c.current.setStyle(m(y))},[i,m]),null}function yue(){const n=wr(t=>t.themesPanelOpen),e=wr(t=>t.toggleThemesPanel);return g.jsx(wt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:g.jsx(RC,{size:22,strokeWidth:2})})}function _ue(){return g.jsx(yue,{})}const k_=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],eu=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],ao="default-vondsten",J7={id:ao,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},xue=n=>n.some(t=>t.id===ao)?n:[{...J7,createdAt:new Date().toISOString()},...n],cs=pa()(kd((n,e)=>({layers:[{...J7}],colorIndex:0,addLayer:(t,r=eu)=>{const i=crypto.randomUUID(),s=k_[e().colorIndex%k_.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||eu,o=i.color||k_[e().colorIndex%k_.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:c,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===ao?{...r,points:[]}:r).filter(r=>r.id===ao),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:xue(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===ao?{...r,name:"Mijn vondsten"}:r)}:t}}));function ci({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=X.useState(t),a=Ai(E=>E.visible),o=Ai(E=>E.setLayerVisibility),l=GI(E=>E.isLayerUnlocked),c=E=>{const T=PE[E],b=T?.tier??"free",A=T?.regions??["nl"];return l(E,b,A)},h=r?.filter(E=>c(E))||[],f=h.filter(E=>a[E]).length,m=h.length,y=m>0&&f===m,x=f>0&&f<m,v=E=>{if(E.stopPropagation(),!r||h.length===0)return;const T=!y;h.forEach(b=>{o(b,T)})};return g.jsxs("div",{className:"mb-0.5",children:[g.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[g.jsxs("button",{onClick:E=>{E.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[g.jsx(wt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:g.jsx(pw,{size:14})}),i?g.jsx(jle,{size:16,className:"text-blue-500"}):g.jsx(Ule,{size:16,className:"text-blue-500"}),g.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),f>0&&g.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:f})]}),r&&r.length>0&&g.jsx("button",{onClick:v,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":x?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||x)&&g.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:g.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),g.jsx(Un,{initial:!1,children:i&&g.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function ct({name:n,type:e,hasOverlay:t}){const r=Ai(A=>A.visible[n]),i=Ai(A=>A.visible["Labels Overlay"]),s=Ai(A=>A.loadingState[n]),a=Ai(A=>A.toggleLayer),o=Ai(A=>A.setLayerVisibility),l=GI(A=>A.isLayerUnlocked),c=s==="loading",h=s==="error",f=PE[n],m=f?.tier??"free",y=f?.regions??["nl"],v=!l(n,m,y),E=A=>{A.stopPropagation(),!(c||v)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(D=>{o(D,D===n)}))},T=A=>{A.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsxs("button",{onClick:E,disabled:c||v,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${v?"opacity-50 cursor-not-allowed bg-gray-50":c?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:v?"Premium laag - upgrade om te ontgrendelen":void 0,children:[g.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":v?"text-gray-400":"text-gray-600"}`,children:[n,h&&g.jsx(X7,{size:12,className:"text-red-500"}),v&&g.jsx(mA,{size:12,className:"text-amber-500"})]}),g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:v?"#e5e7eb":c?"#93c5fd":b?"#3b82f6":"white",border:v?"2px solid #d1d5db":c?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:v?g.jsx(mA,{size:10,strokeWidth:3,className:"text-gray-400"}):c?g.jsx(bC,{size:10,strokeWidth:3,className:"animate-spin"}):b?g.jsx(oc,{size:12,strokeWidth:3}):null})]}),t&&b&&g.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:g.jsx(Xce,{size:12})})]})}const vue=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function eV({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=F1(),[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,f]=X.useState(n.name),[m,y]=X.useState(!1),x=X.useRef(null),v=X.useRef(null),E=n.features.features.length,T=[...new Set(n.features.features.map(P=>P.geometry?.type).filter(Boolean))];X.useEffect(()=>{l&&x.current&&(x.current.focus(),x.current.select())},[l]),X.useEffect(()=>{const P=R=>{v.current&&!v.current.contains(R.target)&&y(!1)};if(m)return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[m]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},A=()=>{const P=h.trim();P&&P!==n.name&&i(n.id,{name:P}),c(!1)},M=()=>{f(n.name),c(!1)},D=P=>{P.key==="Enter"?A():P.key==="Escape"&&M()},U=P=>{s(n.id,P),y(!1)};return e?g.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[g.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&g.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:g.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),g.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),g.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:E})]}):g.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[g.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[g.jsxs("div",{className:"relative",ref:v,children:[g.jsx("button",{onClick:()=>y(!m),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),m&&g.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:vue.map(P=>g.jsx("button",{onClick:()=>U(P),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${P===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:P},title:P},P))})]}),g.jsx("div",{className:"flex-1 min-w-0",children:l?g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("input",{ref:x,type:"text",value:h,onChange:P=>f(P.target.value),onKeyDown:D,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),g.jsx("button",{onClick:A,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:g.jsx(oc,{size:14})}),g.jsx("button",{onClick:M,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:g.jsx(si,{size:14})})]}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),g.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:g.jsx(Y0,{size:12})})]}),g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[g.jsxs("span",{children:[E," ",E===1?"feature":"features"]}),T.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"mx-0.5",children:""}),g.jsx("span",{children:T.join(", ")})]})]})]})})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&g.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:g.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),g.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:g.jsx(mc,{size:14})})]})]})}function Eue(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=wr(),{layers:r,toggleVisibility:i}=cs(),s=F1(h=>h.layers),a=X.useRef(null),o=Gr(h=>h.layerPanelFontScale),l=Gr(h=>h.setLayerPanelFontScale),c=13*o/100;return X.useEffect(()=>{if(!n)return;const h=m=>{a.current&&!a.current.contains(m.target)&&e()},f=setTimeout(()=>{document.addEventListener("click",h)},100);return()=>{clearTimeout(f),document.removeEventListener("click",h)}},[n,e]),g.jsx(Un,{children:n&&g.jsxs(wt.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[g.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${c}px`},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(yo,{size:14,className:"text-white"}),g.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:h=>{l(parseInt(h.target.value))},onChange:h=>l(parseInt(h.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),g.jsx("span",{className:"text-xs text-blue-200",children:"T"}),g.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:g.jsx(si,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),g.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${c}px`},children:[r.filter(h=>!h.archived).length>0&&g.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[g.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:g.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(h=>!h.archived).map(h=>g.jsxs("button",{onClick:f=>{f.stopPropagation(),i(h.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${h.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[g.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[h.name,g.jsxs("span",{className:"text-xs text-gray-400",children:["(",h.points.length,")"]})]}),g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:h.visible?"#f97316":"white",border:h.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:h.visible&&g.jsx(oc,{size:12,strokeWidth:3})})]},h.id))]}),s.length>0&&g.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[g.jsx(z1,{size:12,className:"text-cyan-600"}),g.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(h=>g.jsx(eV,{layer:h,compact:!0},h.id)),g.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),g.jsxs("div",{className:"mb-2",children:[g.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:g.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),g.jsxs("div",{className:"space-y-0",children:[g.jsx(ct,{name:"CartoDB (licht)",type:"base"}),g.jsx(ct,{name:"OpenStreetMap",type:"base"}),g.jsx(ct,{name:"Luchtfoto",type:"base",hasOverlay:!0}),g.jsx(ct,{name:"TMK 1850",type:"base",hasOverlay:!0}),g.jsx(ct,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),g.jsxs("div",{className:"mb-2",children:[g.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:g.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),g.jsxs(ci,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[g.jsx(ct,{name:"Hunebedden",type:"overlay"}),g.jsx(ct,{name:"FAMKE Steentijd",type:"overlay"}),g.jsx(ct,{name:"Grafheuvels",type:"overlay"}),g.jsx(ct,{name:"Terpen",type:"overlay"}),g.jsxs(ci,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[g.jsx(ct,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),g.jsx(ct,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),g.jsx(ct,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),g.jsx(ct,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),g.jsx(ct,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),g.jsx(ct,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),g.jsx(ct,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]})]}),g.jsxs(ci,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","IKAW","Archeo Landschappen","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[g.jsx(ct,{name:"AMK Monumenten",type:"overlay"}),g.jsxs(ci,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[g.jsx(ct,{name:"AMK Romeins",type:"overlay"}),g.jsx(ct,{name:"AMK Steentijd",type:"overlay"}),g.jsx(ct,{name:"AMK Vroege ME",type:"overlay"}),g.jsx(ct,{name:"AMK Late ME",type:"overlay"}),g.jsx(ct,{name:"AMK Overig",type:"overlay"})]}),g.jsx(ct,{name:"Archeo Onderzoeken",type:"overlay"}),g.jsxs(ci,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[g.jsxs(ci,{title:"Romeinse wegen",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)"],children:[g.jsx(ct,{name:"Romeinse wegen (regio)",type:"overlay"}),g.jsx(ct,{name:"Romeinse wegen (Wereld)",type:"overlay"})]}),g.jsxs(ci,{title:"Romeinse forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[g.jsx(ct,{name:"Romeinse Forten",type:"overlay"}),g.jsx(ct,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),g.jsx(ct,{name:"IKAW",type:"overlay"}),g.jsx(ct,{name:"Archeo Landschappen",type:"overlay"}),g.jsxs(ci,{title:"Verwachtingen uiterwaarden",defaultExpanded:!1,layerNames:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[g.jsx(ct,{name:"UIKAV Punten",type:"overlay"}),g.jsx(ct,{name:"UIKAV Vlakken",type:"overlay"}),g.jsx(ct,{name:"UIKAV Expert",type:"overlay"}),g.jsx(ct,{name:"UIKAV Buffer",type:"overlay"}),g.jsx(ct,{name:"UIKAV Indeling",type:"overlay"})]})]}),g.jsxs(ci,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[g.jsx(ct,{name:"Rijksmonumenten",type:"overlay"}),g.jsx(ct,{name:"Werelderfgoed",type:"overlay"}),g.jsx(ct,{name:"Religieus Erfgoed",type:"overlay"}),g.jsx(ct,{name:"Kastelen",type:"overlay"}),g.jsx(ct,{name:"Runes",type:"overlay"})]}),g.jsxs(ci,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[g.jsx(ct,{name:"WWII Bunkers",type:"overlay"}),g.jsx(ct,{name:"Slagvelden",type:"overlay"}),g.jsx(ct,{name:"Militaire Vliegvelden",type:"overlay"}),g.jsx(ct,{name:"Verdedigingslinies",type:"overlay"}),g.jsx(ct,{name:"Militaire Objecten",type:"overlay"}),g.jsx(ct,{name:"Inundatiegebieden",type:"overlay"})]}),g.jsxs(ci,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[g.jsx(ct,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),g.jsx(ct,{name:"AHN4 Hillshade NL",type:"overlay"}),g.jsx(ct,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),g.jsx(ct,{name:"AHN 0.5m",type:"overlay"})]}),g.jsxs(ci,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[g.jsx(ct,{name:"Veengebieden",type:"overlay"}),g.jsx(ct,{name:"Geomorfologie",type:"overlay"}),g.jsx(ct,{name:"Bodemkaart",type:"overlay"}),g.jsx(ct,{name:"Essen",type:"overlay"})]}),g.jsxs(ci,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[g.jsx(ct,{name:"Gewaspercelen",type:"overlay"}),g.jsx(ct,{name:"Kadastrale Grenzen",type:"overlay"})]}),g.jsxs(ci,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[g.jsxs(ci,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[g.jsx(ct,{name:"Scheepswrakken",type:"overlay"}),g.jsx(ct,{name:"Woonheuvels ZH",type:"overlay"}),g.jsx(ct,{name:"Windmolens",type:"overlay"}),g.jsx(ct,{name:"Erfgoedlijnen",type:"overlay"}),g.jsx(ct,{name:"Oude Kernen",type:"overlay"})]}),g.jsxs(ci,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[g.jsx(ct,{name:"Relictenkaart Punten",type:"overlay"}),g.jsx(ct,{name:"Relictenkaart Lijnen",type:"overlay"}),g.jsx(ct,{name:"Relictenkaart Vlakken",type:"overlay"})]}),g.jsx(ci,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:g.jsx(ct,{name:"Verdronken Dorpen",type:"overlay"})})]}),g.jsxs(ci,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[g.jsx(ct,{name:"Fossiel Hotspots",type:"overlay"}),g.jsx(ct,{name:"Mineralen Hotspots",type:"overlay"}),g.jsx(ct,{name:"Goudrivieren",type:"overlay"}),g.jsx(ct,{name:"Fossielen Nederland",type:"overlay"}),g.jsx(ct,{name:"Fossielen Belgi",type:"overlay"}),g.jsx(ct,{name:"Fossielen Duitsland",type:"overlay"}),g.jsx(ct,{name:"Fossielen Frankrijk",type:"overlay"})]}),g.jsxs(ci,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[g.jsx(ct,{name:"Wandelroutes",type:"overlay"}),g.jsx(ct,{name:"Parken",type:"overlay"}),g.jsx(ct,{name:"Speeltuinen",type:"overlay"}),g.jsx(ct,{name:"Musea",type:"overlay"}),g.jsx(ct,{name:"Strandjes",type:"overlay"}),g.jsx(ct,{name:"Kringloopwinkels",type:"overlay"})]})]})]})]})})}function wue(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var pd=1,yd=2,y0=3,Sue=4,_A=5,IO=6378137,Tue=6356752314e-3,CO=.0066943799901413165,Xm=484813681109536e-20,We=Math.PI/2,bue=.16666666666666666,Aue=.04722222222222222,Rue=.022156084656084655,st=1e-10,Lr=.017453292519943295,Vs=57.29577951308232,Gn=Math.PI/4,Hp=Math.PI*2,Wr=3.14159265359,Ks={};Ks.greenwich=0;Ks.lisbon=-9.131906111111;Ks.paris=2.337229166667;Ks.bogota=-74.080916666667;Ks.madrid=-3.687938888889;Ks.rome=12.452333333333;Ks.bern=7.439583333333;Ks.jakarta=106.807719444444;Ks.ferro=-17.666666666667;Ks.brussels=4.367975;Ks.stockholm=18.058277777778;Ks.athens=23.7163375;Ks.oslo=10.722916666667;const Iue={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var PO=/[\s_\-\/\(\)]/g;function Lu(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(PO,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(PO,""),a===r)return n[s]}function xA(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var c=l.split("=");return c.push(!0),o[c[0].toLowerCase()]=c[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Lr},lat_1:function(o){e.lat1=o*Lr},lat_2:function(o){e.lat2=o*Lr},lat_ts:function(o){e.lat_ts=o*Lr},lon_0:function(o){e.long0=o*Lr},lon_1:function(o){e.long1=o*Lr},lon_2:function(o){e.long2=o*Lr},alpha:function(o){e.alpha=parseFloat(o)*Lr},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Lr},lonc:function(o){e.longc=o*Lr},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=Lu(Iue,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Lr},pm:function(o){var l=Lu(Ks,o);e.from_greenwich=(l||parseFloat(o))*Lr},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class tV{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const r=e.find(m=>Array.isArray(m)&&m[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(i){const m=this.convertUnit(i);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const y=e.find(x=>Array.isArray(x)&&x[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(m.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const a=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(l){const m=l.find(y=>Array.isArray(y));t.source_crs=m?this.convert(m):null}const c=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(c){const m=c.find(y=>Array.isArray(y));t.target_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const f=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=f)}),f.conversion_factor&&f.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:f});break;default:t.keyword=e[0];break}return t}}class Cue extends tV{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class Pue extends tV{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function kue(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function Mue(n){return(kue(n)==="2019"?Pue:Cue).convert(n)}function Nue(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Kp=1,nV=2,rV=3,Nv=4,iV=5,PC=-1,Lue=/\s/,Oue=/[A-Za-z]/,Due=/[A-Za-z84_]/,yw=/[,\]]/,sV=/[\d\.E\-\+]/;function pc(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Kp}pc.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Nv)for(;Lue.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Kp:return this.neutral(n);case nV:return this.keyword(n);case Nv:return this.quoted(n);case iV:return this.afterquote(n);case rV:return this.number(n);case PC:return}};pc.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Nv;return}if(yw.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};pc.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Kp;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Kp,this.currentObject=this.stack.pop(),this.currentObject||(this.state=PC);return}};pc.prototype.number=function(n){if(sV.test(n)){this.word+=n;return}if(yw.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};pc.prototype.quoted=function(n){if(n==='"'){this.state=iV;return}this.word+=n};pc.prototype.keyword=function(n){if(Due.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Kp;return}if(yw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};pc.prototype.neutral=function(n){if(Oue.test(n)){this.word=n,this.state=nV;return}if(n==='"'){this.word="",this.state=Nv;return}if(sV.test(n)){this.word=n,this.state=rV;return}if(yw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};pc.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===PC)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Fue(n){var e=new pc(n);return e.output()}function _T(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return n0(a,s),s},r);e&&(n[e]=i)}function n0(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},n0(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&n0(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&n0(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],_T(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],_T(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return n0(n,e[t]);return _T(e,t,n)}}var jue=.017453292519943295;function io(n){return n*jue}function aV(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=io(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=io(n.lat0>0?90:-90),delete n.lat1)}function kO(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function MO(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function NO(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=MO(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-MO(n.ellipsoid.semi_minor_axis))))}function Lv(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(Lv(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,NO(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,NO(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=kO(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=kO(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":Lv(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),aV(e),e)}var Vue=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Gue(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function oV(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];Vue.indexOf(i)!==-1&&Bue(n[i]),typeof n[i]=="object"&&oV(n[i])}}function Bue(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=io(n.rectified_grid_angle));function o(h){var f=n.to_meter||1;return h*f}var l=function(h){return Gue(n,h)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",io],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",io],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",io],["lat0","latitude_of_origin",io],["lat0","standard_parallel_1",io],["lat1","standard_parallel_1",io],["lat2","standard_parallel_2",io],["azimuth","Azimuth"],["alpha","azimuth",io],["srsCode","name"]];c.forEach(l),aV(n)}function Ov(n){if(typeof n=="object")return Lv(n);const e=Nue(n);var t=Fue(n);if(e==="WKT2"){const s=Mue(t);return Lv(s)}var r=t[0],i={};return n0(t,i),oV(i),i[r]}function ji(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?ji[n]=xA(arguments[1]):ji[n]=Ov(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?ji[n]=Ov(arguments[1]):(ji[n]=t,t||delete ji[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?ji.apply(e,r):ji(r)});if(typeof n=="string"){if(n in ji)return ji[n]}else"EPSG"in n?ji["EPSG:"+n.EPSG]=n:"ESRI"in n?ji["ESRI:"+n.ESRI]=n:"IAU2000"in n?ji["IAU2000:"+n.IAU2000]=n:console.log(n);return}}wue(ji);function Uue(n){return typeof n=="string"}function zue(n){return n in ji}function $ue(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var Wue=["3857","900913","3785","102113"];function Hue(n){var e=Lu(n,"authority");if(e){var t=Lu(e,"epsg");return t&&Wue.indexOf(t)>-1}}function Kue(n){var e=Lu(n,"extension");if(e)return Lu(e,"proj4")}function Xue(n){return n[0]==="+"}function que(n){if(Uue(n)){if(zue(n))return ji[n];if($ue(n)){var e=Ov(n);if(Hue(e))return ji["EPSG:3857"];var t=Kue(e);return t?xA(t):e}if(Xue(n))return xA(n)}else return"projName"in n?n:Ov(n)}function LO(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function dl(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function $1(n){return n<0?-1:1}function dt(n,e){return e||Math.abs(n)<=Wr?n:n-$1(n)*Hp}function _o(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(We-e))/r}function Xp(n,e){for(var t=.5*n,r,i,s=We-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=We-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function Yue(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=dl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Zue(n){var e=n.x,t=n.y;if(t*Vs>90&&t*Vs<-90&&e*Vs>180&&e*Vs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-We)<=st)return null;if(this.sphere)r=this.x0+this.a*this.k0*dt(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Gn+.5*t));else{var s=Math.sin(t),a=_o(this.e,t,s);r=this.x0+this.a*this.k0*dt(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function Que(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=We-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=Xp(this.e,s),i===-9999)return null}return r=dt(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var Jue=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const ehe={init:Yue,forward:Zue,inverse:Que,names:Jue};function the(){}function OO(n){return n}var lV=["longlat","identity"];const nhe={init:the,forward:OO,inverse:OO,names:lV};var rhe=[ehe,nhe],Rh={},r0=[];function cV(n,e){var t=r0.length;return n.names?(r0[t]=n,n.names.forEach(function(r){Rh[r.toLowerCase()]=t}),this):(console.log(e),!0)}function uV(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function ihe(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Rh[e]<"u"&&r0[Rh[e]]||(e=uV(e),e in Rh&&r0[Rh[e]]))return r0[Rh[e]]}function she(){rhe.forEach(cV)}const ahe={start:she,add:cV,get:ihe};var hV={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const ohe=hV.WGS84;function lhe(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(bue+a*(Aue+a*Rue)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function che(n,e,t,r,i){if(!n){var s=Lu(hV,r);s||(s=ohe),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<st)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var mx={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var uhe in mx){var xT=mx[uhe];xT.datumName&&(mx[xT.datumName]=xT)}function hhe(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=_A:o.datum_type=Sue,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=pd),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=yd,o.datum_params[3]*=Xm,o.datum_params[4]*=Xm,o.datum_params[5]*=Xm,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=y0,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var kC={};function dhe(n,e,t){return e instanceof ArrayBuffer?fhe(n,e,t):{ready:ghe(n,e)}}function fhe(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=yhe(i),a=_he(i,s),o=xhe(i,a,s,r),l={header:a,subgrids:o};return kC[n]=l,l}async function ghe(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(DO),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(DO),f=c[0]+(l[0]-1)*h[0],m=c[3]-(l[1]-1)*h[1],y=o[0],x=o[1],v=[];for(let b=l[1]-1;b>=0;b--)for(let A=l[0]-1;A>=0;A--){var E=b*l[0]+A;v.push([-fu(x[E]),fu(y[E])])}t.push({del:h,lim:l,ll:[-f,m],cvs:v})}var T={header:{nSubgrids:r},subgrids:t};return kC[n]=T,T}function mhe(n){if(n===void 0)return null;var e=n.split(",");return e.map(phe)}function phe(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:kC[n]||null,isNull:!1}}function DO(n){return n*Math.PI/180}function fu(n){return n/3600*Math.PI/180}function yhe(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function _he(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:vA(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function vA(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function xhe(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=Ehe(n,i,t),l=whe(n,i,o,t,r),c=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[fu(o.lowerLongitude),fu(o.lowerLatitude)],del:[fu(o.longitudeInterval),fu(o.latitudeInterval)],lim:[c,h],count:o.gridNodeCount,cvs:vhe(l)});var f=16;r===!1&&(f=8),i+=176+o.gridNodeCount*f}return s}function vhe(n){return n.map(function(e){return[fu(e.longitudeShift),fu(e.latitudeShift)]})}function Ehe(n,e,t){return{name:vA(n,e+8,e+16).trim(),parent:vA(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function whe(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var c={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(c.latitudeAccuracy=n.getFloat32(s+l*a+8,r),c.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(c)}return o}function ja(n,e){if(!(this instanceof ja))return new ja(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var t=que(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=ja.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=Lu(mx,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=che(t.a,t.b,t.rf,t.ellps,t.sphere),a=lhe(s.a,s.b,s.rf,t.R_A),o=mhe(t.nadgrids),l=t.datum||hhe(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);LO(this,t),LO(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}ja.projections=ahe;ja.projections.start();function She(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===pd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===yd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function dV(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,c;if(i<-We&&i>-1.001*We)i=-We;else if(i>We&&i<1.001*We)i=We;else{if(i<-We)return{x:-1/0,y:-1/0,z:n.z};if(i>We)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),c=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*c*Math.cos(r),y:(a+s)*c*Math.sin(r),z:(a*(1-e)+s)*o}}function fV(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,c,h,f,m,y,x,v,E,T,b,A,M=n.x,D=n.y,U=n.z?n.z:0,P,R,k;if(o=Math.sqrt(M*M+D*D),l=Math.sqrt(M*M+D*D+U*U),o/t<i){if(P=0,l/t<i)return R=We,k=-r,{x:n.x,y:n.y,z:n.z}}else P=Math.atan2(D,M);c=U/l,h=o/l,f=1/Math.sqrt(1-e*(2-e)*h*h),x=h*(1-e)*f,v=c*f,A=0;do A++,y=t/Math.sqrt(1-e*v*v),k=o*x+U*v-y*(1-e*v*v),m=e*y/(y+k),f=1/Math.sqrt(1-m*(2-m)*h*h),E=h*(1-m)*f,T=c*f,b=T*x-E*v,x=E,v=T;while(b*b>s&&A<a);return R=Math.atan(T/Math.abs(E)),{x:P,y:R,z:k}}function The(n,e,t){if(e===pd)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===yd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6];return{x:c*(n.x-l*n.y+o*n.z)+r,y:c*(l*n.x+n.y-a*n.z)+i,z:c*(-o*n.x+a*n.y+n.z)+s}}}function bhe(n,e,t){if(e===pd)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===yd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=(n.x-r)/c,f=(n.y-i)/c,m=(n.z-s)/c;return{x:h+l*f-o*m,y:-l*h+f+a*m,z:o*h-a*f+m}}}function M_(n){return n===pd||n===yd}function Ahe(n,e,t){if(She(n,e)||n.datum_type===_A||e.datum_type===_A)return t;var r=n.a,i=n.es;if(n.datum_type===y0){var s=FO(n,!1,t);if(s!==0)return;r=IO,i=CO}var a=e.a,o=e.b,l=e.es;if(e.datum_type===y0&&(a=IO,o=Tue,l=CO),i===l&&r===a&&!M_(n.datum_type)&&!M_(e.datum_type))return t;if(t=dV(t,i,r),M_(n.datum_type)&&(t=The(t,n.datum_type,n.datum_params)),M_(e.datum_type)&&(t=bhe(t,e.datum_type,e.datum_params)),t=fV(t,l,a,o),e.datum_type===y0){var c=FO(e,!0,t);if(c!==0)return}return t}function FO(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,c=0,h=l.length;c<h;c++){var f=l[c],m=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,y=f.ll[0]-m,x=f.ll[1]-m,v=f.ll[0]+(f.lim[0]-1)*f.del[0]+m,E=f.ll[1]+(f.lim[1]-1)*f.del[1]+m;if(!(x>r.y||y>r.x||E<r.y||v<r.x)&&(i=Rhe(r,e,f),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Vs+" "+r.y*Vs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function Rhe(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=dt(i.x-Math.PI)+Math.PI;var s=jO(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,c;do{if(c=jO(s,t),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=dt(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function jO(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var c={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},f=i.x*i.y,m=i.x*(1-i.y),y=(1-i.x)*(1-i.y),x=(1-i.x)*i.y;return s.x=y*o.x+m*l.x+x*h.x+f*c.x,s.y=y*o.y+m*l.y+x*h.y+f*c.y,s}function VO(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":c[o]=a;break;case"w":c[o]=-a;break;case"n":c[o]=a;break;case"s":c[o]=-a;break;case"u":t[o]!==void 0&&(c.z=a);break;case"d":t[o]!==void 0&&(c.z=-a);break;default:return null}return c}function gV(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function Ihe(n){GO(n.x),GO(n.y)}function GO(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function Che(n,e){return(n.datum.datum_type===pd||n.datum.datum_type===yd||n.datum.datum_type===y0)&&e.datumCode!=="WGS84"||(e.datum.datum_type===pd||e.datum.datum_type===yd||e.datum.datum_type===y0)&&n.datumCode!=="WGS84"}function Dv(n,e,t,r){var i;Array.isArray(t)?t=gV(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(Ihe(t),n.datum&&e.datum&&Che(n,e)&&(i=new ja("WGS84"),t=Dv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=VO(n,!1,t)),n.projName==="longlat")t={x:t.x*Lr,y:t.y*Lr,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=Ahe(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Vs,y:t.y*Vs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?VO(e,!0,t):(t&&!s&&delete t.z,t)}var BO=ja("WGS84");function vT(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=Dv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=Dv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function N_(n){return n instanceof ja?n:typeof n=="object"&&"oProj"in n?n.oProj:ja(n)}function Phe(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=N_(n),r=BO,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=N_(n),r=BO,s=!0),r||(r=N_(n)),i||(i=N_(e)),t?vT(r,i,t):(a={forward:function(o,l){return vT(r,i,o,l)},inverse:function(o,l){return vT(i,r,o,l)}},s&&(a.oProj=i),a)}var UO=6,mV="AJSAJS",pV="AFAFAF",i0=65,ks=73,Ca=79,Rm=86,Im=90;const khe={forward:yV,inverse:Mhe,toPoint:_V};function yV(n,e){return e=e||5,Ohe(Nhe({lat:n[1],lon:n[0]}),e)}function Mhe(n){var e=MC(vV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function _V(n){var e=MC(vV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function ET(n){return n*(Math.PI/180)}function zO(n){return 180*(n/Math.PI)}function Nhe(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,c,h,f,m,y=ET(e),x=ET(t),v,E;E=Math.floor((t+180)/6)+1,t===180&&(E=60),e>=56&&e<64&&t>=3&&t<12&&(E=32),e>=72&&e<84&&(t>=0&&t<9?E=31:t>=9&&t<21?E=33:t>=21&&t<33?E=35:t>=33&&t<42&&(E=37)),a=(E-1)*6-180+3,v=ET(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),c=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),f=Math.cos(y)*(x-v),m=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var T=s*l*(f+(1-c+h)*f*f*f/6+(5-18*c+c*c+72*h-58*o)*f*f*f*f*f/120)+5e5,b=s*(m+l*Math.tan(y)*(f*f/2+(5-c+9*h+4*h*h)*f*f*f*f/24+(61-58*c+c*c+600*h-330*o)*f*f*f*f*f*f/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(T),zoneNumber:E,zoneLetter:Lhe(e)}}function MC(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,c=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,f,m,y,x,v,E,T,b,A=t-5e5,M=e;r<"N"&&(M-=1e7),E=(i-1)*6-180+3,l=o/(1-o),v=M/s,T=v/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=T+(3*c/2-27*c*c*c/32)*Math.sin(2*T)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*T)+151*c*c*c/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),f=Math.tan(b)*Math.tan(b),m=l*Math.cos(b)*Math.cos(b),y=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),x=A/(h*s);var D=b-h*Math.tan(b)/y*(x*x/2-(5+3*f+10*m-4*m*m-9*l)*x*x*x*x/24+(61+90*f+298*m+45*f*f-252*l-3*m*m)*x*x*x*x*x*x/720);D=zO(D);var U=(x-(1+2*f+m)*x*x*x/6+(5-2*m+28*f-3*m*m+8*l+24*f*f)*x*x*x*x*x/120)/Math.cos(b);U=E+zO(U);var P;if(n.accuracy){var R=MC({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});P={top:R.lat,right:R.lon,bottom:D,left:U}}else P={lat:D,lon:U};return P}function Lhe(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Ohe(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+Dhe(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function Dhe(n,e,t){var r=xV(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return Fhe(i,s,r)}function xV(n){var e=n%UO;return e===0&&(e=UO),e}function Fhe(n,e,t){var r=t-1,i=mV.charCodeAt(r),s=pV.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>Im&&(a=a-Im+i0-1,l=!0),(a===ks||i<ks&&a>ks||(a>ks||i<ks)&&l)&&a++,(a===Ca||i<Ca&&a>Ca||(a>Ca||i<Ca)&&l)&&(a++,a===ks&&a++),a>Im&&(a=a-Im+i0-1),o>Rm?(o=o-Rm+i0-1,l=!0):l=!1,(o===ks||s<ks&&o>ks||(o>ks||s<ks)&&l)&&o++,(o===Ca||s<Ca&&o>Ca||(o>Ca||s<Ca)&&l)&&(o++,o===ks&&o++),o>Rm&&(o=o-Rm+i0-1);var c=String.fromCharCode(a)+String.fromCharCode(o);return c}function vV(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=xV(a),c=jhe(t.charAt(0),l),h=Vhe(t.charAt(1),l);h<Ghe(o);)h+=2e6;var f=e-s;if(f%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=f/2,y=0,x=0,v,E,T,b,A;return m>0&&(v=1e5/Math.pow(10,m),E=n.substring(s,s+m),y=parseFloat(E)*v,T=n.substring(s+m),x=parseFloat(T)*v),b=y+c,A=x+h,{easting:b,northing:A,zoneLetter:o,zoneNumber:a,accuracy:v}}function jhe(n,e){for(var t=mV.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===ks&&t++,t===Ca&&t++,t>Im){if(i)throw"Bad character: "+n;t=i0,i=!0}r+=1e5}return r}function Vhe(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=pV.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===ks&&t++,t===Ca&&t++,t>Rm){if(i)throw"Bad character: "+n;t=i0,i=!0}r+=1e5}return r}function Ghe(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function Z0(n,e,t){if(!(this instanceof Z0))return new Z0(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Z0.fromMGRS=function(n){return new Z0(_V(n))};Z0.prototype.toMGRS=function(n){return yV([this.x,this.y],n)};var Bhe=1,Uhe=.25,$O=.046875,WO=.01953125,HO=.01068115234375,zhe=.75,$he=.46875,Whe=.013020833333333334,Hhe=.007120768229166667,Khe=.3645833333333333,Xhe=.005696614583333333,qhe=.3076171875;function NC(n){var e=[];e[0]=Bhe-n*(Uhe+n*($O+n*(WO+n*HO))),e[1]=n*(zhe-n*($O+n*(WO+n*HO)));var t=n*n;return e[2]=t*($he-n*(Whe+n*Hhe)),t*=n,e[3]=t*(Khe-n*Xhe),e[4]=t*n*qhe,e}function hg(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var Yhe=20;function LC(n,e,t){for(var r=1/(1-e),i=n,s=Yhe;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(hg(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<st)return i}return i}function Zhe(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=NC(this.es),this.ml0=hg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Qhe(n){var e=n.x,t=n.y,r=dt(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,f=Math.pow(h,2),m=this.ep2*Math.pow(l,2),y=Math.pow(m,2),x=Math.abs(l)>st?Math.tan(t):0,v=Math.pow(x,2),E=Math.pow(v,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=hg(t,o,l,this.en);s=this.a*(this.k0*h*(1+f/6*(1-v+m+f/20*(5-18*v+E+14*m-58*v*m+f/42*(61+179*E-E*v-479*v)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+f/12*(5-v+9*m+4*y+f/30*(61+E-58*v+270*m-330*v*m+f/56*(1385+543*E-E*v-3111*v))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<st)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(a),c>=1){if(c-1>st)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function Jhe(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=LC(e,this.es,this.en),Math.abs(t)<We){var f=Math.sin(t),m=Math.cos(t),y=Math.abs(m)>st?Math.tan(t):0,x=this.ep2*Math.pow(m,2),v=Math.pow(x,2),E=Math.pow(y,2),T=Math.pow(E,2);e=1-this.es*Math.pow(f,2);var b=s*Math.sqrt(e)/this.k0,A=Math.pow(b,2);e=e*y,r=t-e*A/(1-this.es)*.5*(1-A/12*(5+3*E-9*x*E+x-4*v-A/30*(61+90*E-252*x*E+45*T+46*x-A/56*(1385+3633*E+4095*T+1574*T*E)))),i=dt(this.long0+b*(1-A/6*(1+2*E+x-A/20*(5+28*E+24*T+8*x*E+6*x-A/42*(61+662*E+1320*T+720*T*E))))/m,this.over)}else r=We*$1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),c=this.lat0+a/this.k0,h=Math.cos(c);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=dt(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var ede=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const px={init:Zhe,forward:Qhe,inverse:Jhe,names:ede};function EV(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Fs(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function tde(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function nde(n){var e=Math.abs(n);return e=tde(e*(1+e/(Fs(1,e)+1))),n<0?-e:e}function OC(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function rde(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function ide(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function wV(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=EV(t),a=ide(t),o=2*i*a,l=-2*r*s,c=n.length-1,h=n[c],f=0,m=0,y=0,x,v;--c>=0;)x=m,v=f,m=h,f=y,h=-x+o*m-l*f+n[c],y=-v+l*m+o*f;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function sde(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(px.init.apply(this),this.forward=px.forward,this.inverse=px.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=OC(this.cbg,this.lat0);this.Zb=-this.Qn*(r+rde(this.gtu,2*r))}function ade(n){var e=dt(n.x-this.long0,this.over),t=n.y;t=OC(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,Fs(r,i*a)),e=nde(Math.tan(e));var o=wV(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,c=1/0),n.x=l,n.y=c,n}function ode(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=wV(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(EV(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),c=Math.cos(e);t=Math.atan2(a*c,Fs(l,c*o)),e=Math.atan2(l,c*o),r=dt(e+this.long0,this.over),i=OC(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var lde=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const yx={init:sde,forward:ade,inverse:ode,names:lde};function cde(n,e){if(n===void 0){if(n=Math.floor((dt(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var ude="etmerc";function hde(){var n=cde(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Lr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,yx.init.apply(this),this.forward=yx.forward,this.inverse=yx.inverse}var dde=["Universal Transverse Mercator System","utm"];const fde={init:hde,names:dde,dependsOn:ude};function DC(n,e){return Math.pow((1-n)/(1+n),e)}var gde=20;function mde(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Gn)/(Math.pow(Math.tan(.5*this.lat0+Gn),this.C)*DC(this.e*n,this.ratexp))}function pde(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Gn),this.C)*DC(this.e*Math.sin(t),this.ratexp))-We,n.x=this.C*e,n}function yde(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+Gn)/this.K,1/this.C),s=gde;s>0&&(r=2*Math.atan(i*DC(this.e*Math.sin(n.y),-.5*this.e))-We,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const FC={init:mde,forward:pde,inverse:yde};function _de(){FC.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function xde(n){var e,t,r,i;return n.x=dt(n.x-this.long0,this.over),FC.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function vde(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Fs(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,FC.inverse.apply(this,[n]),n.x=dt(n.x+this.long0,this.over),n}var Ede=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const wde={init:_de,forward:xde,inverse:vde,names:Ede};function jC(n,e,t){return e*=t,Math.tan(.5*(We+n))*Math.pow((1-e)/(1+e),.5*t)}function Sde(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*(1+$1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=st&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&Math.abs(Math.cos(this.lat_ts))>st&&(this.k0=.5*this.cons*dl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/_o(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=dl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(jC(this.lat0,this.sinlat0,this.e))-We,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Tde(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,c,h,f=dt(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=st&&Math.abs(t+this.lat0)<=st?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(f)),n.x=this.a*s*i*Math.sin(f)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(f))+this.y0,n):(a=2*Math.atan(jC(t,r,this.e))-We,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=st?(c=_o(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*c/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<st?(s=2*this.a*this.k0/(1+l*Math.cos(f)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(f))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(f))+this.y0),n.x=s*l*Math.sin(f)+this.x0,n))}function bde(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=st?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<st?this.lat0>0?e=dt(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=dt(this.long0+Math.atan2(n.x,n.y),this.over):e=dt(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=st){if(a<=st)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*Xp(this.e,r),e=this.con*dt(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=st?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=dt(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*Xp(this.e,Math.tan(.5*(We+s)));return n.x=e,n.y=t,n}var Ade=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Rde={init:Sde,forward:Tde,inverse:bde,names:Ade,ssfn_:jC};function Ide(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),c=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*c}function Cde(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function Pde(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,c=s,h=-1e3,f=0;Math.abs(c-h)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=c,n}var kde=["somerc"];const Mde={init:Ide,forward:Cde,inverse:Pde,names:kde};var Hf=1e-7;function Nde(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(uV(t))!==-1}function Lde(){var n,e,t,r,i,s,a,o,l,c,h=0,f,m=0,y=0,x=0,v=0,E=0,T=0;this.no_off=Nde(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var A=!1;if("rectified_grid_angle"in this&&(A=!0),b&&(T=this.alpha),A&&(h=this.rectified_grid_angle),b||A)m=this.longc;else if(y=this.long1,v=this.lat1,x=this.long2,E=this.lat2,Math.abs(v-E)<=Hf||(n=Math.abs(v))<=Hf||Math.abs(n-We)<=Hf||Math.abs(Math.abs(this.lat0)-We)<=Hf||Math.abs(Math.abs(E)-We)<=Hf)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>st?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(_o(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||A?(b?(f=Math.asin(Math.sin(T)/r),A||(h=T)):(f=h,T=Math.asin(r*Math.sin(f))),this.lam0=m-Math.asin(.5*(i-1/i)*Math.tan(f))/this.B):(s=Math.pow(_o(this.e,v,Math.sin(v)),this.B),a=Math.pow(_o(this.e,E,Math.sin(E)),this.B),i=this.E/s,l=(a-s)/(a+s),c=this.E*this.E,c=(c-a*s)/(c+a*s),n=y-x,n<-Math.PI?x-=Hp:n>Math.PI&&(x+=Hp),this.lam0=dt(.5*(y+x)-Math.atan(c*Math.tan(.5*this.B*(y-x))/l)/this.B,this.over),f=Math.atan(2*Math.sin(this.B*dt(y-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(Gn-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Gn+i))}function Ode(n){var e={},t,r,i,s,a,o,l,c;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-We)>st){if(a=this.E/Math.pow(_o(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<st)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Hf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else c=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Dde(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<st)l.x=0,l.y=o<0?-We:We;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=Xp(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Fde=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const jde={init:Lde,forward:Ode,inverse:Dde,names:Fde};function Vde(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<st)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=dl(this.e,e,t),i=_o(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=dl(this.e,s,a),l=_o(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-We)<st?0:_o(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>st?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Gde(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=st&&(t=$1(t)*(We-2*st));var r=Math.abs(Math.abs(t)-We),i,s;if(r>st)i=_o(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*dt(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Bde(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=Xp(this.e,r),i===-9999)return null}else i=-We;return s=dt(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var Ude=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const zde={init:Vde,forward:Gde,inverse:Bde,names:Ude};function $de(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Wde(n){var e,t,r,i,s,a,o,l=n.x,c=n.y,h=dt(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function Hde(n){var e,t,r,i,s,a,o,l,c=n.x;n.x=n.y,n.y=c,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var Kde=["Krovak","krovak"];const Xde={init:$de,forward:Wde,inverse:Hde,names:Kde};function ws(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function W1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function H1(n){return .375*n*(1+.25*n*(1+.46875*n))}function K1(n){return .05859375*n*n*(1+.75*n)}function X1(n){return n*n*n*(35/3072)}function VC(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Wu(n){return Math.abs(n)<We?n:n-$1(n)*Math.PI}function Fv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function qde(){this.sphere||(this.e0=W1(this.es),this.e1=H1(this.es),this.e2=K1(this.es),this.e3=X1(this.es),this.ml0=this.a*ws(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Yde(n){var e,t,r=n.x,i=n.y;if(r=dt(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=VC(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),h=c*c,f=this.es*a*a/(1-this.es),m=this.a*ws(this.e0,this.e1,this.e2,this.e3,i);e=o*c*(1-h*l*(1/6-(8-l+8*f)*h/120)),t=m-this.ml0+o*s/a*h*(.5+(5-l+6*f)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function Zde(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=Fv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-We)<=st)return n.x=this.long0,n.y=We,t<0&&(n.y*=-1),n;var l=VC(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),f=e*this.a/l,m=f*f;r=o-l*Math.tan(o)/c*f*f*(.5-(1+3*h)*f*f/24),i=f*(1-m*(h/3+(1+3*h)*h*m/15))/Math.cos(o)}return n.x=dt(i+this.long0,this.over),n.y=Wu(r),n}var Qde=["Cassini","Cassini_Soldner","cass"];const Jde={init:qde,forward:Yde,inverse:Zde,names:Qde};function Tu(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var EA=1,wA=2,SA=3,_x=4;function efe(){var n=Math.abs(this.lat0);if(Math.abs(n-We)<st?this.mode=this.lat0<0?EA:wA:Math.abs(n)<st?this.mode=SA:this.mode=_x,this.es>0){var e;switch(this.qp=Tu(this.e,1),this.mmf=.5/(1-this.es),this.apa=cfe(this.es),this.mode){case wA:this.dd=1;break;case EA:this.dd=1;break;case SA:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case _x:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Tu(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===_x&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function tfe(n){var e,t,r,i,s,a,o,l,c,h,f=n.x,m=n.y;if(f=dt(f-this.long0,this.over),this.sphere){if(s=Math.sin(m),h=Math.cos(m),r=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=st)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(f),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(m+this.lat0)<st)return null;t=Gn-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=r}}else{switch(o=0,l=0,c=0,r=Math.cos(f),i=Math.sin(f),s=Math.sin(m),a=Tu(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=We+m,a=this.qp-a;break;case this.S_POLE:c=m-We,a=this.qp+a;break}if(Math.abs(c)<st)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?t=this.ymf*c*(this.cosb1*o-this.sinb1*l*r):t=(c=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(c=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?c:-c)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function nfe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,c;if(this.sphere){var h=0,f,m=0;if(f=Math.sqrt(e*e+t*t),i=f*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=st?0:Math.asin(t*m/f),e*=m,t=h*f;break;case this.OBLIQ:i=Math.abs(f)<=st?this.lat0:Math.asin(h*this.sinph0+t*m*this.cosph0/f),e*=m*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:t=-t,i=We-i;break;case this.S_POLE:i-=We;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<st)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(c=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*c,t=l*this.cosb1*s-t*this.sinb1*a):(c=t*a/l,o=this.qp*c,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;c=1-o/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,t),i=ufe(Math.asin(c),this.apa)}return n.x=dt(this.long0+r,this.over),n.y=i,n}var rfe=.3333333333333333,ife=.17222222222222222,sfe=.10257936507936508,afe=.06388888888888888,ofe=.0664021164021164,lfe=.016415012942191543;function cfe(n){var e,t=[];return t[0]=n*rfe,e=n*n,t[0]+=e*ife,t[1]=e*afe,e*=n,t[0]+=e*sfe,t[1]+=e*ofe,t[2]=e*lfe,t}function ufe(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var hfe=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const dfe={init:efe,forward:tfe,inverse:nfe,names:hfe,S_POLE:EA,N_POLE:wA,EQUIT:SA,OBLIQ:_x};function Ou(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function ffe(){Math.abs(this.lat1+this.lat2)<st||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=dl(this.e3,this.sin_po,this.cos_po),this.qs1=Tu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=dl(this.e3,this.sin_po,this.cos_po),this.qs2=Tu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Tu(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>st?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function gfe(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=Tu(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*dt(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function mfe(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=dt(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function pfe(n,e){var t,r,i,s,a,o=Ou(.5*e);if(n<st)return o;for(var l=n*n,c=1;c<=25;c++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var yfe=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const _fe={init:ffe,forward:gfe,inverse:mfe,names:yfe,phi1z:pfe};function xfe(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function vfe(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=dt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=st?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Efe(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=Ou(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=dt(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var wfe=["gnom"];const Sfe={init:xfe,forward:vfe,inverse:Efe,names:wfe};function Tfe(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*We:We;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function bfe(){this.sphere||(this.k0=dl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Afe(n){var e=n.x,t=n.y,r,i,s=dt(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=Tu(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function Rfe(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=dt(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=Tfe(this.e,2*n.y*this.k0/this.a),e=dt(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var Ife=["cea"];const Cfe={init:bfe,forward:Afe,inverse:Rfe,names:Ife};function Pfe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function kfe(n){var e=n.x,t=n.y,r=dt(e-this.long0,this.over),i=Wu(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function Mfe(n){var e=n.x,t=n.y;return n.x=dt(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Wu(this.lat0+(t-this.y0)/this.a),n}var Nfe=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Lfe={init:Pfe,forward:kfe,inverse:Mfe,names:Nfe};var KO=20;function Ofe(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=W1(this.es),this.e1=H1(this.es),this.e2=K1(this.es),this.e3=X1(this.es),this.ml0=this.a*ws(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Dfe(n){var e=n.x,t=n.y,r,i,s,a=dt(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=st?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Wu(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=st)r=this.a*a,i=-1*this.ml0;else{var o=VC(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*ws(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function Ffe(n){var e,t,r,i,s,a,o,l,c;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=st)e=dt(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=KO;s;--s)if(h=Math.tan(l),c=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=c,Math.abs(c)<=st){t=l;break}e=dt(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=st)t=0,e=dt(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var f,m,y,x,v;for(s=KO;s;--s)if(v=this.e*Math.sin(l),f=Math.sqrt(1-v*v)*Math.tan(l),m=this.a*ws(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),x=m/this.a,c=(a*(f*x+1)-x-.5*f*(x*x+o))/(this.es*Math.sin(2*l)*(x*x+o-2*a*x)/(4*f)+(a-x)*(f*y-2/Math.sin(2*l))-y),l-=c,Math.abs(c)<=st){t=l;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=dt(this.long0+Math.asin(r*f/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var jfe=["Polyconic","American_Polyconic","poly"];const Vfe={init:Ofe,forward:Dfe,inverse:Ffe,names:jfe};function Gfe(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Bfe(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/Xm*1e-5,o=s,l=1,c=0;for(e=1;e<=10;e++)l=l*a,c=c+this.A[e]*l;var h=c,f=o,m=1,y=0,x,v,E=0,T=0;for(e=1;e<=6;e++)x=m*h-y*f,v=y*h+m*f,m=x,y=v,E=E+this.B_re[e]*m-this.B_im[e]*y,T=T+this.B_im[e]*m+this.B_re[e]*y;return n.x=T*this.a+this.x0,n.y=E*this.a+this.y0,n}function Ufe(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,c=0,h,f,m=0,y=0;for(e=1;e<=6;e++)h=l*a-c*o,f=c*a+l*o,l=h,c=f,m=m+this.C_re[e]*l-this.C_im[e]*c,y=y+this.C_im[e]*l+this.C_re[e]*c;for(var x=0;x<this.iterations;x++){var v=m,E=y,T,b,A=a,M=o;for(e=2;e<=6;e++)T=v*m-E*y,b=E*m+v*y,v=T,E=b,A=A+(e-1)*(this.B_re[e]*v-this.B_im[e]*E),M=M+(e-1)*(this.B_im[e]*v+this.B_re[e]*E);v=1,E=0;var D=this.B_re[1],U=this.B_im[1];for(e=2;e<=6;e++)T=v*m-E*y,b=E*m+v*y,v=T,E=b,D=D+e*(this.B_re[e]*v-this.B_im[e]*E),U=U+e*(this.B_im[e]*v+this.B_re[e]*E);var P=D*D+U*U;m=(A*D+M*U)/P,y=(M*D-A*U)/P}var R=m,k=y,N=1,O=0;for(e=1;e<=9;e++)N=N*R,O=O+this.D[e]*N;var z=this.lat0+O*Xm*1e5,j=this.long0+k;return n.x=j,n.y=z,n}var zfe=["New_Zealand_Map_Grid","nzmg"];const $fe={init:Gfe,forward:Bfe,inverse:Ufe,names:zfe};function Wfe(){}function Hfe(n){var e=n.x,t=n.y,r=dt(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function Kfe(n){n.x-=this.x0,n.y-=this.y0;var e=dt(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var Xfe=["Miller_Cylindrical","mill"];const qfe={init:Wfe,forward:Hfe,inverse:Kfe,names:Xfe};var Yfe=20;function Zfe(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=NC(this.es)}function Qfe(n){var e,t,r=n.x,i=n.y;if(r=dt(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=Yfe;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<st)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);t=this.a*hg(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function Jfe(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Ou((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Ou(Math.sin(e)/this.n)),r=dt(r+this.long0,this.over),e=Wu(e)):(e=LC(n.y/this.a,this.es,this.en),i=Math.abs(e),i<We?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=dt(t,this.over)):i-st<We&&(r=this.long0)),n.x=r,n.y=e,n}var e0e=["Sinusoidal","sinu"];const t0e={init:Zfe,forward:Qfe,inverse:Jfe,names:e0e};function n0e(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function r0e(n){for(var e=n.x,t=n.y,r=dt(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<st)break}i/=2,Math.PI/2-Math.abs(t)<st&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function i0e(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=dt(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var s0e=["Mollweide","moll"];const a0e={init:n0e,forward:r0e,inverse:i0e,names:s0e};function o0e(){Math.abs(this.lat1+this.lat2)<st||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=W1(this.es),this.e1=H1(this.es),this.e2=K1(this.es),this.e3=X1(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=dl(this.e,this.sin_phi,this.cos_phi),this.ml1=ws(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<st?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=dl(this.e,this.sin_phi,this.cos_phi),this.ml2=ws(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ws(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function l0e(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=ws(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*dt(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function c0e(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=dt(this.long0+s/this.ns,this.over),r=Wu(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=Fv(a,this.e0,this.e1,this.e2,this.e3),i=dt(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var u0e=["Equidistant_Conic","eqdc"];const h0e={init:o0e,forward:l0e,inverse:c0e,names:u0e};function d0e(){this.R=this.a}function f0e(n){var e=n.x,t=n.y,r=dt(e-this.long0,this.over),i,s;Math.abs(t)<=st&&(i=this.x0+this.R*r,s=this.y0);var a=Ou(2*Math.abs(t/Math.PI));(Math.abs(r)<=st||Math.abs(Math.abs(t)-We)<=st)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,c=Math.sin(a),h=Math.cos(a),f=h/(c+h-1),m=f*f,y=f*(2/c-1),x=y*y,v=Math.PI*this.R*(o*(f-x)+Math.sqrt(l*(f-x)*(f-x)-(x+l)*(m-x)))/(x+l);r<0&&(v=-v),i=this.x0+v;var E=l+f;return v=Math.PI*this.R*(y*E-o*Math.sqrt((x+l)*(l+1)-E*E))/(x+l),t>=0?s=this.y0+v:s=this.y0-v,n.x=i,n.y=s,n}function g0e(n){var e,t,r,i,s,a,o,l,c,h,f,m,y;return n.x-=this.x0,n.y-=this.y0,f=Math.PI*this.R,r=n.x/f,i=n.y/f,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,c=(a-o*o/3/l)/l,h=2*Math.sqrt(-c/3),f=3*y/c/h,Math.abs(f)>1&&(f>=0?f=1:f=-1),m=Math.acos(f)/3,n.y>=0?t=(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<st?e=this.long0:e=dt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var m0e=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const p0e={init:d0e,forward:f0e,inverse:g0e,names:m0e};function y0e(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),c=Math.sin(o),h=Math.cos(o),f=Math.sin(l),m=Math.cos(l);let y=a,x,v=100,E,T,b,A,M,D,U,P,R,k,N,O,z,j;do{if(E=Math.sin(y),T=Math.cos(y),b=Math.sqrt(m*E*(m*E)+(h*f-c*m*T)*(h*f-c*m*T)),b===0)return{azi1:0,s12:0};A=c*f+h*m*T,M=Math.atan2(b,A),D=h*m*E/b,U=1-D*D,P=U!==0?A-2*c*f/U:0,R=s/16*U*(4+s*(4-3*U)),x=y,y=a+(1-R)*s*D*(M+R*b*(P+R*A*(-1+2*P*P)))}while(Math.abs(y-x)>1e-12&&--v>0);return v===0?{azi1:NaN,s12:NaN}:(k=U*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),N=1+k/16384*(4096+k*(-768+k*(320-175*k))),O=k/1024*(256+k*(-128+k*(74-47*k))),z=O*b*(P+O/4*(A*(-1+2*P*P)-O/6*P*(-3+4*b*b)*(-3+4*P*P))),j=i*(1-s)*N*(M-z),{azi1:Math.atan2(m*E,h*f-c*m*T),s12:j})}function _0e(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),c=Math.sin(t),h=Math.cos(t),f=Math.atan2(o,l*h),m=l*c,y=1-m*m,x=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),v=1+x/16384*(4096+x*(-768+x*(320-175*x))),E=x/1024*(256+x*(-128+x*(74-47*x)));let T=r/(i*(1-s)*v),b,A=100,M,D,U,P;do M=Math.cos(2*f+T),D=Math.sin(T),U=Math.cos(T),P=E*D*(M+E/4*(U*(-1+2*M*M)-E/6*M*(-3+4*D*D)*(-3+4*M*M))),b=T,T=r/(i*(1-s)*v)+P;while(Math.abs(T-b)>1e-12&&--A>0);if(A===0)return{lat2:NaN,lon2:NaN};const R=o*D-l*U*h,k=Math.atan2(o*U+l*D*h,(1-s)*Math.sqrt(m*m+R*R)),N=Math.atan2(D*c,l*U-o*D*h),O=s/16*y*(4+s*(4-3*y)),z=N-(1-O)*s*m*(T+O*D*(M+O*U*(-1+2*M*M))),j=e+z;return{lat2:k,lon2:j}}function x0e(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function v0e(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=dt(e-this.long0,this.over),a,o,l,c,h,f,m,y,x,v,E;return this.sphere?Math.abs(this.sin_p12-1)<=st?(n.x=this.x0+this.a*(We-t)*Math.sin(s),n.y=this.y0-this.a*(We-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(n.x=this.x0+this.a*(We+t)*Math.sin(s),n.y=this.y0+this.a*(We+t)*Math.cos(s),n):(x=this.sin_p12*r+this.cos_p12*i*Math.cos(s),m=Math.acos(x),y=m?m/Math.sin(m):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=W1(this.es),o=H1(this.es),l=K1(this.es),c=X1(this.es),Math.abs(this.sin_p12-1)<=st?(h=this.a*ws(a,o,l,c,We),f=this.a*ws(a,o,l,c,t),n.x=this.x0+(h-f)*Math.sin(s),n.y=this.y0-(h-f)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(h=this.a*ws(a,o,l,c,We),f=this.a*ws(a,o,l,c,t),n.x=this.x0+(h+f)*Math.sin(s),n.y=this.y0+(h+f)*Math.cos(s),n):Math.abs(e)<st&&Math.abs(t-this.lat0)<st?(n.x=n.y=0,n):(v=y0e(this.lat0,this.long0,t,e,this.a,this.f),E=v.azi1,n.x=v.s12*Math.sin(E),n.y=v.s12*Math.cos(E),n))}function E0e(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,c,h,f,m,y,x,v,E;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*We*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=st?a=this.lat0:(a=Ou(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-We,Math.abs(o)<=st?this.lat0>=0?s=dt(this.long0+Math.atan2(n.x,-n.y),this.over):s=dt(this.long0-Math.atan2(-n.x,n.y),this.over):s=dt(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=W1(this.es),c=H1(this.es),h=K1(this.es),f=X1(this.es),Math.abs(this.sin_p12-1)<=st?(m=this.a*ws(l,c,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=m-e,a=Fv(y/this.a,l,c,h,f),s=dt(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=st?(m=this.a*ws(l,c,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-m,a=Fv(y/this.a,l,c,h,f),s=dt(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(x=Math.atan2(n.x,n.y),v=Math.sqrt(n.x*n.x+n.y*n.y),E=_0e(this.lat0,this.long0,x,v,this.a,this.f),n.x=E.lon2,n.y=E.lat2,n))}var w0e=["Azimuthal_Equidistant","aeqd"];const S0e={init:x0e,forward:v0e,inverse:E0e,names:w0e};function T0e(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function b0e(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=dt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=st)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function A0e(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Ou(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=st?(o=this.lat0,n.x=a,n.y=o,n):(o=Ou(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-We,Math.abs(s)<=st?(this.lat0>=0?a=dt(this.long0+Math.atan2(n.x,-n.y),this.over):a=dt(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=dt(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var R0e=["ortho"];const I0e={init:T0e,forward:b0e,inverse:A0e,names:R0e};var Cr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Bn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function C0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=We-Gn/2?this.face=Cr.TOP:this.lat0<=-(We-Gn/2)?this.face=Cr.BOTTOM:Math.abs(this.long0)<=Gn?this.face=Cr.FRONT:Math.abs(this.long0)<=We+Gn?this.face=this.long0>0?Cr.RIGHT:Cr.LEFT:this.face=Cr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function P0e(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Cr.TOP)s=We-t,r>=Gn&&r<=We+Gn?(l.value=Bn.AREA_0,i=r-We):r>We+Gn||r<=-(We+Gn)?(l.value=Bn.AREA_1,i=r>0?r-Wr:r+Wr):r>-(We+Gn)&&r<=-Gn?(l.value=Bn.AREA_2,i=r+We):(l.value=Bn.AREA_3,i=r);else if(this.face===Cr.BOTTOM)s=We+t,r>=Gn&&r<=We+Gn?(l.value=Bn.AREA_0,i=-r+We):r<Gn&&r>=-Gn?(l.value=Bn.AREA_1,i=-r):r<-Gn&&r>=-(We+Gn)?(l.value=Bn.AREA_2,i=-r-We):(l.value=Bn.AREA_3,i=r>0?-r+Wr:-r-Wr);else{var c,h,f,m,y,x,v;this.face===Cr.RIGHT?r=_0(r,+We):this.face===Cr.BACK?r=_0(r,+Wr):this.face===Cr.LEFT&&(r=_0(r,-We)),m=Math.sin(t),y=Math.cos(t),x=Math.sin(r),v=Math.cos(r),c=y*v,h=y*x,f=m,this.face===Cr.FRONT?(s=Math.acos(c),i=L_(s,f,h,l)):this.face===Cr.RIGHT?(s=Math.acos(h),i=L_(s,f,-c,l)):this.face===Cr.BACK?(s=Math.acos(-c),i=L_(s,f,-h,l)):this.face===Cr.LEFT?(s=Math.acos(-h),i=L_(s,f,c,l)):(s=i=0,l.value=Bn.AREA_0)}return o=Math.atan(12/Wr*(i+Math.acos(Math.sin(i)*Math.cos(Gn))-We)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Bn.AREA_1?o+=We:l.value===Bn.AREA_2?o+=Wr:l.value===Bn.AREA_3&&(o+=1.5*Wr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function k0e(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,c,h,f={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?f.value=Bn.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(f.value=Bn.AREA_1,t-=We):n.x<0&&-n.x>=Math.abs(n.y)?(f.value=Bn.AREA_2,t=t<0?t+Wr:t-Wr):(f.value=Bn.AREA_3,t+=We),h=Wr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===Cr.TOP)c=Math.acos(l),e.phi=We-c,f.value===Bn.AREA_0?e.lam=o+We:f.value===Bn.AREA_1?e.lam=o<0?o+Wr:o-Wr:f.value===Bn.AREA_2?e.lam=o-We:e.lam=o;else if(this.face===Cr.BOTTOM)c=Math.acos(l),e.phi=c-We,f.value===Bn.AREA_0?e.lam=-o+We:f.value===Bn.AREA_1?e.lam=-o:f.value===Bn.AREA_2?e.lam=-o-We:e.lam=o<0?-o-Wr:-o+Wr;else{var m,y,x;m=l,h=m*m,h>=1?x=0:x=Math.sqrt(1-h)*Math.sin(o),h+=x*x,h>=1?y=0:y=Math.sqrt(1-h),f.value===Bn.AREA_1?(h=y,y=-x,x=h):f.value===Bn.AREA_2?(y=-y,x=-x):f.value===Bn.AREA_3&&(h=y,y=x,x=-h),this.face===Cr.RIGHT?(h=m,m=-y,y=h):this.face===Cr.BACK?(m=-m,y=-y):this.face===Cr.LEFT&&(h=m,m=y,y=-h),e.phi=Math.acos(-x)-We,e.lam=Math.atan2(y,m),this.face===Cr.RIGHT?e.lam=_0(e.lam,-We):this.face===Cr.BACK?e.lam=_0(e.lam,-Wr):this.face===Cr.LEFT&&(e.lam=_0(e.lam,+We))}if(this.es!==0){var v,E,T;v=e.phi<0?1:0,E=Math.tan(e.phi),T=this.b/Math.sqrt(E*E+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),v&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function L_(n,e,t,r){var i;return n<st?(r.value=Bn.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=Gn?r.value=Bn.AREA_0:i>Gn&&i<=We+Gn?(r.value=Bn.AREA_1,i-=We):i>We+Gn||i<=-(We+Gn)?(r.value=Bn.AREA_2,i=i>=0?i-Wr:i+Wr):(r.value=Bn.AREA_3,i+=We)),i}function _0(n,e){var t=n+e;return t<-Wr?t+=Hp:t>+Wr&&(t-=Hp),t}var M0e=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const N0e={init:C0e,forward:P0e,inverse:k0e,names:M0e};var TA=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Cm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],SV=.8487,TV=1.3523,bV=Vs/5,L0e=1/bV,s0=18,jv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},O0e=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function D0e(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function F0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function j0e(n){var e=dt(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*bV);r<0?r=0:r>=s0&&(r=s0-1),t=Vs*(t-L0e*r);var i={x:jv(TA[r],t)*e,y:jv(Cm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*SV+this.x0,i.y=i.y*this.a*TV+this.y0,i}function V0e(n){var e={x:(n.x-this.x0)/(this.a*SV),y:Math.abs(n.y-this.y0)/(this.a*TV)};if(e.y>=1)e.x/=TA[s0][0],e.y=n.y<0?-We:We;else{var t=Math.floor(e.y*s0);for(t<0?t=0:t>=s0&&(t=s0-1);;)if(Cm[t][0]>e.y)--t;else if(Cm[t+1][0]<=e.y)++t;else break;var r=Cm[t],i=5*(e.y-r[0])/(Cm[t+1][0]-r[0]);i=D0e(function(s){return(jv(r,s)-e.y)/O0e(r,s)},i,st,100),e.x/=jv(TA[t],i),e.y=(5*t+i)*Lr,n.y<0&&(e.y=-e.y)}return e.x=dt(e.x+this.long0,this.over),e}var G0e=["Robinson","robin"];const B0e={init:F0e,forward:j0e,inverse:V0e,names:G0e};function U0e(){this.name="geocent"}function z0e(n){var e=dV(n,this.es,this.a);return e}function $0e(n){var e=fV(n,this.es,this.a,this.b);return e}var W0e=["Geocentric","geocentric","geocent","Geocent"];const H0e={init:U0e,forward:z0e,inverse:$0e,names:W0e};var is={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},fm={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function K0e(){if(Object.keys(fm).forEach((function(t){if(typeof this[t]>"u")this[t]=fm[t].def;else{if(fm[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);fm[t].num&&(this[t]=parseFloat(this[t]))}fm[t].degrees&&(this[t]=this[t]*Lr)}).bind(this)),Math.abs(Math.abs(this.lat0)-We)<st?this.mode=this.lat0<0?is.S_POLE:is.N_POLE:Math.abs(this.lat0)<st?this.mode=is.EQUIT:(this.mode=is.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function X0e(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case is.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case is.EQUIT:s=t*r;break;case is.S_POLE:s=-e;break;case is.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case is.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case is.EQUIT:s*=e;break;case is.N_POLE:s*=-(t*r);break;case is.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function q0e(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=Fs(n.x,n.y);if(Math.abs(s)<st)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case is.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case is.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case is.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case is.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var Y0e=["Tilted_Perspective","tpers"];const Z0e={init:K0e,forward:X0e,inverse:q0e,names:Y0e};function Q0e(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function J0e(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/Fs(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Fs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Fs(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Fs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Fs(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function ege(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Fs(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Fs(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var tge=["Geostationary Satellite View","Geostationary_Satellite","geos"];const nge={init:Q0e,forward:J0e,inverse:ege,names:tge};var qm=1.340264,Ym=-.081106,Zm=893e-6,Qm=.003796,Vv=Math.sqrt(3)/2;function rge(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function ige(n){var e=dt(n.x-this.long0,this.over),t=n.y,r=Math.asin(Vv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(Vv*(qm+3*Ym*i+s*(7*Zm+9*Qm*i))),n.y=r*(qm+Ym*i+s*(Zm+Qm*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function sge(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,c;for(c=0;c<t&&(i=r*r,s=i*i*i,a=r*(qm+Ym*i+s*(Zm+Qm*i))-n.y,o=qm+3*Ym*i+s*(7*Zm+9*Qm*i),r-=l=a/o,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,n.x=Vv*n.x*(qm+3*Ym*i+s*(7*Zm+9*Qm*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/Vv),n.x=dt(n.x+this.long0,this.over),n}var age=["eqearth","Equal Earth","Equal_Earth"];const oge={init:rge,forward:ige,inverse:sge,names:age};var qp=1e-10;function lge(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<qp)throw new Error;this.es?(this.en=NC(this.es),this.m1=hg(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=uge,this.forward=cge):(Math.abs(this.phi1)+qp>=We?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=dge,this.forward=hge)}function cge(n){var e=dt(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-hg(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function uge(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=Fs(n.x,n.y=this.am1-n.y),i=LC(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<We)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-We)<=qp)r=0;else throw new Error;return n.x=dt(r+(this.long0||0),this.over),n.y=Wu(i),n}function hge(n){var e=dt(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>qp?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function dge(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=Fs(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>We)throw new Error;return Math.abs(Math.abs(t)-We)<=qp?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=dt(e+(this.long0||0),this.over),n.y=Wu(t),n}var fge=["bonne","Bonne (Werner lat_1=90)"];const gge={init:lge,names:fge},XO={OBLIQUE:{forward:xge,inverse:Ege},TRANSVERSE:{forward:vge,inverse:wge}},Gv={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function mge(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=lV.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=ja(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(Gv),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Lr;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],c=Gv[l],h=Object.entries(c);if(h.some(([m])=>typeof this[m]<"u")){t=c;for(let m=0;m<h.length;m++){const[y,x]=h[m],v=i(y);if(typeof v>"u")throw new Error("Missing parameter: "+y+".");this[x]=v}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=_ge(this,t);this.lamp=s,Math.abs(a)>st?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=XO.OBLIQUE):this.projectionType=XO.TRANSVERSE}function pge(n){return this.projectionType.forward(this,n)}function yge(n){return this.projectionType.inverse(this,n)}function _ge(n,e){let t,r;if(e===Gv.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-We)<=st)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===Gv.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>We-st)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>We-st)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<st)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<st)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function xge(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=dt(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Vs,o.y*=Vs),o}function vge(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=dt(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Vs,a.y*=Vs),a}function Ege(n,e){n.isIdentity&&(e.x*=Lr,e.y*=Lr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=dt(e.x+n.long0),e}function wge(n,e){n.isIdentity&&(e.x*=Lr,e.y*=Lr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=dt(e.x+n.long0),e}var Sge=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Tge={init:mge,forward:pge,inverse:yge,names:Sge};function bge(n){n.Proj.projections.add(px),n.Proj.projections.add(yx),n.Proj.projections.add(fde),n.Proj.projections.add(wde),n.Proj.projections.add(Rde),n.Proj.projections.add(Mde),n.Proj.projections.add(jde),n.Proj.projections.add(zde),n.Proj.projections.add(Xde),n.Proj.projections.add(Jde),n.Proj.projections.add(dfe),n.Proj.projections.add(_fe),n.Proj.projections.add(Sfe),n.Proj.projections.add(Cfe),n.Proj.projections.add(Lfe),n.Proj.projections.add(Vfe),n.Proj.projections.add($fe),n.Proj.projections.add(qfe),n.Proj.projections.add(t0e),n.Proj.projections.add(a0e),n.Proj.projections.add(h0e),n.Proj.projections.add(p0e),n.Proj.projections.add(S0e),n.Proj.projections.add(I0e),n.Proj.projections.add(N0e),n.Proj.projections.add(B0e),n.Proj.projections.add(H0e),n.Proj.projections.add(Z0e),n.Proj.projections.add(nge),n.Proj.projections.add(oge),n.Proj.projections.add(gge),n.Proj.projections.add(Tge)}const bn=Object.assign(Phe,{defaultDatum:"WGS84",Proj:ja,WGS84:new ja("WGS84"),Point:Z0,toPoint:gV,defs:ji,nadgrid:dhe,transform:Dv,mgrs:khe,version:"__VERSION__"});bge(bn);class AV{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=vr,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?tr(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=tr(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return $t()}readFeature(e,t){return $t()}readFeatures(e,t){return $t()}readGeometry(e,t){return $t()}readProjection(e){return $t()}writeFeature(e,t){return $t()}writeFeatures(e,t){return $t()}writeGeometry(e,t){return $t()}}function wo(n,e,t){const r=t?tr(t.featureProjection):null,i=t?tr(t.dataProjection):null;let s=n;if(r&&i&&!$h(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(hp(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const Age={Point:gi,LineString:bi,Polygon:Ba,MultiPoint:bd,MultiLineString:tc,MultiPolygon:nd};function Rge(n,e,t){return Array.isArray(e[0])?(KD(n,0,e,t)||(n=n.slice(),tb(n,0,e,t)),n):(aR(n,0,e,t)||(n=n.slice(),Nx(n,0,e,t)),n)}function RV(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>RV({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return wo(new Os(r,r==="Polygon"?Rge(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function GC(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>GC(i,e));return new go(r)}const t=Age[n.type];return wo(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class Ige extends AV{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(O_(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(O_(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return $t()}readFeaturesFromObject(e,t){return $t()}readGeometry(e,t){return this.readGeometryFromObject(O_(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return $t()}readProjection(e){return this.readProjectionFromObject(O_(e))}readProjectionFromObject(e){return $t()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return $t()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return $t()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return $t()}}function O_(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class BC extends Ige{constructor(e){e=e||{},super(),this.dataProjection=tr(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=tr(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=UC(r.geometry);if(this.featureClass===Os)return RV({geometry:i,id:r.id,properties:r.properties},t);const s=new vr;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(GC(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const c=this.readFeatureFromObject(a[o],t);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return Cge(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=tr(t.properties.name);else if(t.type==="EPSG")r=tr("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=bA(a,t),delete s[e.getGeometryName()]),Zh(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return bA(e,this.adaptOptions(t))}}function UC(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=kge(n);break}case"LineString":{t=Mge(n);break}case"Polygon":{t=Dge(n);break}case"MultiPoint":{t=Lge(n);break}case"MultiLineString":{t=Nge(n);break}case"MultiPolygon":{t=Oge(n);break}case"GeometryCollection":{t=Pge(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function Cge(n,e){const t=UC(n);return GC(t,e)}function Pge(n,e){return n.geometries.map(function(r){return UC(r)})}function kge(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:Td(e.length)}}function Mge(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Td(e[0]?.length||2)}}function Nge(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=d1(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:Td(t)}}function Lge(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Td(e[0]?.length||2)}}function Oge(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=SD(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:Td(r)}}function Dge(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=d1(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:Td(r)}}function bA(n,e){n=wo(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=Uge(n);break}case"LineString":{r=jge(n);break}case"Polygon":{r=zge(n,e);break}case"MultiPoint":{r=Gge(n);break}case"MultiLineString":{r=Vge(n);break}case"MultiPolygon":{r=Bge(n,e);break}case"GeometryCollection":{r=Fge(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function Fge(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return bA(r,e)})}}function jge(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function Vge(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Gge(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Bge(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function Uge(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function zge(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const Bv="http://www.w3.org/2001/XMLSchema-instance";function Nd(n,e){return dg().createElementNS(n,e)}function So(n,e){return IV(n,e,[]).join("")}function IV(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)IV(r,e,t)}return t}function zl(n){return"documentElement"in n}function $l(n){return new DOMParser().parseFromString(n,"application/xml")}function qO(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Vn(s,i)}})}function lo(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function zC(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Ge(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function Qe(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function CV(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=To(i.localName)}PV(t,r,s,a)}}function To(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return Nd(l,o)})}const us=To();function $s(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function ht(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Hu(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function xn(n,e,t,r,i){return r.push(n),Hu(e,t,r,i),r.pop()}function PV(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let c=0;c<a;++c)o=t[c],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[c]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function ar(n,e,t,r,i,s,a){return i.push(n),PV(e,t,r,i,s,a),i.pop()}let wT;function $ge(){return wT===void 0&&typeof XMLSerializer<"u"&&(wT=new XMLSerializer),wT}let ST;function dg(){return ST===void 0&&typeof document<"u"&&(ST=document.implementation.createDocument("","",null)),ST}class kV extends AV{constructor(){super(),this.xmlSerializer_=$ge()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=$l(e);return this.readFeatureFromDocument(r,t)}return zl(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=$l(e);return this.readFeaturesFromDocument(r,t)}return zl(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Vn(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return $t()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=$l(e);return this.readGeometryFromDocument(r,t)}return zl(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=$l(e);return this.readProjectionFromDocument(t)}return zl(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function Du(n){const e=So(n,!1);return Wge(e)}function Wge(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function _w(n){const e=So(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Cn(n){const e=So(n,!1);return Hge(e)}function Hge(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function Yp(n){const e=So(n,!1);return Kge(e)}function Kge(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function on(n){return So(n,!1).trim()}function Q0(n,e){Ln(n,e?"1":"0")}function Xge(n,e){n.appendChild(dg().createCDATASection(e))}function qge(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+em(t.getUTCMonth()+1,2)+"-"+em(t.getUTCDate(),2)+"T"+em(t.getUTCHours(),2)+":"+em(t.getUTCMinutes(),2)+":"+em(t.getUTCSeconds(),2)+"Z";n.appendChild(dg().createTextNode(r))}function Ms(n,e){const t=e.toPrecision();n.appendChild(dg().createTextNode(t))}function Uv(n,e){const t=e.toString();n.appendChild(dg().createTextNode(t))}const Yge=/^\s/,Zge=/\s$/,Qge=/(\n|\t|\r|<|&| {2})/;function Ln(n,e){typeof e=="string"&&(Yge.test(e)||Zge.test(e)||Qge.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),Xge(n,t)}):n.appendChild(dg().createTextNode(e))}const dr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Jge="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",eme={rte:MV,trk:NV,wpt:LV},tme=ht(dr,{rte:lo(MV),trk:lo(NV),wpt:lo(LV)}),nme=ht(dr,{text:Ge(on,"linkText"),type:Ge(on,"linkType")}),rme=ht(dr,{name:Ge(on),email:Pme,link:q1}),ime=ht(dr,{name:Ge(on),desc:Ge(on),author:Ge(Rme),copyright:Ge(Ime),link:q1,time:Ge(_w),keywords:Ge(on),bounds:Cme,extensions:xw}),sme=ht(dr,{year:Ge(Yp),license:Ge(on)}),ame=ht(dr,{rte:Qe(Lme),trk:Qe(Ome),wpt:Qe(Fme)});class ome extends kV{constructor(e){super(),e=e||{},this.dataProjection=tr("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument($l(e)):zl(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!dr.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(dr.includes(t.namespaceURI)&&t.localName==="metadata")return xn({},ime,t,[]);return null}readFeatureFromNode(e,t){if(!dr.includes(e.namespaceURI))return null;const r=eme[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!dr.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=xn([],tme,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Nd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Bv),r.setAttributeNS(Bv,"xsi:schemaLocation",Jge),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),ar({node:r},ame,Ame,e,[t]),r}}const lme=ht(dr,{name:Ge(on),cmt:Ge(on),desc:Ge(on),src:Ge(on),link:q1,number:Ge(Yp),extensions:xw,type:Ge(on),rtept:kme}),cme=ht(dr,{ele:Ge(Cn),time:Ge(_w)}),ume=ht(dr,{name:Ge(on),cmt:Ge(on),desc:Ge(on),src:Ge(on),link:q1,number:Ge(Yp),type:Ge(on),extensions:xw,trkseg:Nme}),hme=ht(dr,{trkpt:Mme}),dme=ht(dr,{ele:Ge(Cn),time:Ge(_w)}),fme=ht(dr,{ele:Ge(Cn),time:Ge(_w),magvar:Ge(Cn),geoidheight:Ge(Cn),name:Ge(on),cmt:Ge(on),desc:Ge(on),src:Ge(on),link:q1,sym:Ge(on),type:Ge(on),fix:Ge(on),sat:Ge(Yp),hdop:Ge(Cn),vdop:Ge(Cn),pdop:Ge(Cn),ageofdgpsdata:Ge(Cn),dgpsid:Ge(Yp),extensions:xw}),gme=["text","type"],mme=ht(dr,{text:Qe(Ln),type:Qe(Ln)}),pme=ht(dr,["name","cmt","desc","src","link","number","type","rtept"]),yme=ht(dr,{name:Qe(Ln),cmt:Qe(Ln),desc:Qe(Ln),src:Qe(Ln),link:Qe(HC),number:Qe(Uv),type:Qe(Ln),rtept:CV(Qe(KC))}),_me=ht(dr,["ele","time"]),xme=ht(dr,["name","cmt","desc","src","link","number","type","trkseg"]),vme=ht(dr,{name:Qe(Ln),cmt:Qe(Ln),desc:Qe(Ln),src:Qe(Ln),link:Qe(HC),number:Qe(Uv),type:Qe(Ln),trkseg:CV(Qe(Dme))}),Eme=To("trkpt"),wme=ht(dr,{trkpt:Qe(KC)}),Sme=ht(dr,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Tme=ht(dr,{ele:Qe(Ms),time:Qe(qge),magvar:Qe(Ms),geoidheight:Qe(Ms),name:Qe(Ln),cmt:Qe(Ln),desc:Qe(Ln),src:Qe(Ln),link:Qe(HC),sym:Qe(Ln),type:Qe(Ln),fix:Qe(Ln),sat:Qe(Uv),hdop:Qe(Ms),vdop:Qe(Ms),pdop:Qe(Ms),ageofdgpsdata:Qe(Ms),dgpsid:Qe(Uv)}),bme={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Ame(n,e,t){const r=n.getGeometry();if(r){const i=bme[r.getType()];if(i){const s=e[e.length-1].node;return Nd(s.namespaceURI,i)}}}function $C(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function WC(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function Rme(n,e){const t=xn({},rme,n,e);if(t)return t}function Ime(n,e){const t=xn({},sme,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function Cme(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function Pme(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function q1(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Hu(nme,n,e)}function xw(n,e){const t=e[e.length-1];t.extensionsNode_=n}function kme(n,e){const t=xn({},cme,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;$C(i,s,n,t)}}function Mme(n,e){const t=xn({},dme,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;$C(i,s,n,t)}}function Nme(n,e){const t=e[e.length-1];Hu(hme,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function MV(n,e){const t=e[0],r=xn({flatCoordinates:[],layoutOptions:{}},lme,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=WC(s,i),o=new bi(i,a);wo(o,!1,t);const l=new vr(o);return l.setProperties(r,!0),l}function NV(n,e){const t=e[0],r=xn({flatCoordinates:[],ends:[],layoutOptions:{}},ume,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=WC(a,i,s),l=new tc(i,o,s);wo(l,!1,t);const c=new vr(l);return c.setProperties(r,!0),c}function LV(n,e){const t=e[0],r=xn({},fme,n,e);if(!r)return;const i={},s=$C([],i,n,r),a=WC(i,s),o=new gi(s,a);wo(o,!1,t);const l=new vr(o);return l.setProperties(r,!0),l}function HC(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];ar({node:n},mme,us,s,t,gme)}function KC(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?_me[s]:Sme[s],c=$s(a,l);ar({node:n,properties:a},Tme,us,c,t,l)}function Lme(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=wo(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=pme[o.namespaceURI],c=$s(i,l);ar(s,yme,us,c,t,l)}function Ome(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=wo(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=xme[o.namespaceURI],c=$s(i,l);ar(s,vme,us,c,t,l)}function Dme(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},ar(r,wme,Eme,e.getCoordinates(),t)}function Fme(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=wo(s,!0,r);i.geometryLayout=a.getLayout(),KC(n,a.getCoordinates(),t)}}const yc=["http://www.google.com/kml/ext/2.2"],Ct=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],jme="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",YO={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Vme=ht(Ct,{ExtendedData:qV,Region:YV,MultiGeometry:Ge(HV,"geometry"),LineString:Ge($V,"geometry"),LinearRing:Ge(WV,"geometry"),Point:Ge(KV,"geometry"),Polygon:Ge(XV,"geometry"),Style:Ge(YC),StyleMap:wpe,address:Ge(on),description:Ge(on),name:Ge(on),open:Ge(Du),phoneNumber:Ge(on),styleUrl:Ge(VV),visibility:Ge(Du)},ht(yc,{MultiTrack:Ge(cpe,"geometry"),Track:Ge(zV,"geometry")})),Gme=ht(Ct,{ExtendedData:qV,Region:YV,Link:Lpe,address:Ge(on),description:Ge(on),name:Ge(on),open:Ge(Du),phoneNumber:Ge(on),visibility:Ge(Du)}),Bme=ht(Ct,{href:Ge(jV)}),Ume=ht(Ct,{Altitude:Ge(Cn),Longitude:Ge(Cn),Latitude:Ge(Cn),Tilt:Ge(Cn),AltitudeMode:Ge(on),Heading:Ge(Cn),Roll:Ge(Cn)}),OV=ht(Ct,{LatLonAltBox:Rpe,Lod:Cpe}),zme=ht(Ct,["Document","Placemark"]),$me=ht(Ct,{Document:Qe(Upe),Placemark:Qe(JV)});let x0,xx=null,AA,Jm,ep,tp,zv,RA=null,XC,IA=null,CA,Bh=null,ZO=null,PA=null;function $v(n){return 32/Math.min(n[0],n[1])}function Wme(){x0=[255,255,255,1],xx=new er({color:x0}),AA=[20,2],Jm="pixels",ep="pixels",tp=[64,64],zv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",RA=new m1({anchor:AA,anchorOrigin:"bottom-left",anchorXUnits:Jm,anchorYUnits:ep,crossOrigin:"anonymous",rotation:0,scale:$v(tp),size:tp,src:zv}),XC="NO_IMAGE",IA=new Xn({color:x0,width:1}),CA=new Xn({color:[51,51,51,1],width:2}),Bh=new mo({font:"bold 16px Helvetica",fill:xx,stroke:CA,scale:.8}),ZO=new mn({fill:xx,image:RA,text:Bh,stroke:IA,zIndex:0}),PA=[ZO]}let D_;function Hme(n){return n}class Kme extends kV{constructor(e){super(),e=e||{},PA||Wme(),this.dataProjection=tr("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:PA,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:Hme,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=ht(Ct,{Document:qO(this.readDocumentOrFolder_,this),Folder:qO(this.readDocumentOrFolder_,this),Placemark:lo(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=xn([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=xn({geometry:null},Vme,e,t,this);if(!r)return;const i=new vr,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&wo(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,h=qme(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=YC.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=BV.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!Ct.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!Ct.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Vn(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=$l(e);return this.readNameFromDocument(t)}return zl(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Ct.includes(t.namespaceURI)&&t.localName=="name")return on(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(Ct.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=$l(e);Vn(t,this.readNetworkLinksFromDocument(r))}else zl(e)?Vn(t,this.readNetworkLinksFromDocument(e)):Vn(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Vn(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Ct.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=xn({},Gme,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Ct.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Vn(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=$l(e);Vn(t,this.readRegionFromDocument(r))}else zl(e)?Vn(t,this.readRegionFromDocument(e)):Vn(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Vn(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Ct.includes(r.namespaceURI)&&r.localName=="Region"){const i=xn({},OV,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Ct.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Vn(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=$l(e);Vn(t,this.readCameraFromDocument(r))}else zl(e)?Vn(t,this.readCameraFromDocument(e)):Vn(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Vn(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Ct.includes(r.namespaceURI)&&r.localName==="Camera"){const i=xn({},Ume,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Ct.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Vn(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Nd(Ct[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",yc[0]),r.setAttributeNS(i,"xmlns:xsi",Bv),r.setAttributeNS(Bv,"xsi:schemaLocation",jme);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=zme[r.namespaceURI],l=$s(a,o);return ar(s,$me,us,l,[t],o,this),r}}function Xme(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),c=i.getAnchor();t[0]=l[0]*(o[0]-c[0]),t[1]=l[1]*(o[1]/2-c[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Bh.getFont()),s.setScale(s.getScale()||Bh.getScale()),s.setFill(s.getFill()||Bh.getFill()),s.setStroke(s.getStroke()||CA)):s=Bh.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new mn({image:i,text:s})}function qme(n,e,t,r,i){return(function(s,a){let o=i,l="",c=[];if(o){const f=s.getGeometry();if(f)if(f instanceof go)c=f.getGeometriesArrayRecursive().filter(function(m){const y=m.getType();return y==="Point"||y==="MultiPoint"}),o=c.length>0;else{const m=f.getType();o=m==="Point"||m==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(D_||(D_=document.createElement("textarea")),D_.innerHTML=l,l=D_.value));let h=t;if(n?h=n:e&&(h=DV(e,t,r)),o){const f=Xme(h[0],l);if(c.length>0){f.setGeometry(new go(c));const m=new mn({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[f,m].concat(h.slice(1))}return f}return h})}function DV(n,e,t){return Array.isArray(n)?n:typeof n=="string"?DV(t[n],e,t):e}function vw(n){const e=So(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function FV(n){let e=So(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function jV(n){const e=So(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function VV(n){const e=So(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function Yme(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:YO[e],y:parseFloat(n.getAttribute("y")),yunits:YO[t],origin:r}}function GV(n){return Cn(n)}const Zme=ht(Ct,{Pair:Epe});function BV(n,e){return xn(void 0,Zme,n,e,this)}const Qme=ht(Ct,{Icon:Ge(dpe),color:Ge(vw),heading:Ge(Cn),hotSpot:Ge(Yme),scale:Ge(GV)});function Jme(n,e){const t=xn({},Qme,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=zv);let l,c,h,f="bottom-left";const m=t.hotSpot;m?(l=[m.x,m.y],c=m.xunits,h=m.yunits,f=m.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=AA,c=Jm,h=ep):a.includes("arrow-reverse")?(l=[54,42],c=Jm,h=ep):a.includes("paddle")&&(l=[32,1],c=Jm,h=ep));let y;const x=i.x,v=i.y;x!==void 0&&v!==void 0&&(y=[x,v]);let E;const T=i.w,b=i.h;T!==void 0&&b!==void 0&&(E=[T,b]);let A;const M=t.heading;M!==void 0&&(A=Kl(M));const D=t.scale,U=t.color;if(s){a==zv&&(E=tp);const P=new m1({anchor:l,anchorOrigin:f,anchorXUnits:c,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:A,scale:D,size:E,src:this.iconUrlFunction_(a),color:U}),R=P.getScaleArray()[0],k=P.getSize();if(k===null){const N=P.getImageState();if(N===Et.IDLE||N===Et.LOADING){const O=function(){const z=P.getImageState();if(!(z===Et.IDLE||z===Et.LOADING)){const j=P.getSize();if(j&&j.length==2){const Re=$v(j);P.setScale(R*Re)}P.unlistenImageChange(O)}};P.listenImageChange(O),N===Et.IDLE&&P.load()}}else if(k.length==2){const N=$v(k);P.setScale(R*N)}r.imageStyle=P}else r.imageStyle=XC}const epe=ht(Ct,{color:Ge(vw),scale:Ge(GV)});function tpe(n,e){const t=xn({},epe,n,e);if(!t)return;const r=e[e.length-1],i=new mo({fill:new er({color:"color"in t?t.color:x0}),scale:t.scale});r.textStyle=i}const npe=ht(Ct,{color:Ge(vw),width:Ge(Cn)});function rpe(n,e){const t=xn({},npe,n,e);if(!t)return;const r=e[e.length-1],i=new Xn({color:"color"in t?t.color:x0,width:"width"in t?t.width:1});r.strokeStyle=i}const ipe=ht(Ct,{color:Ge(vw),fill:Ge(Du),outline:Ge(Du)});function spe(n,e){const t=xn({},ipe,n,e);if(!t)return;const r=e[e.length-1],i=new er({color:"color"in t?t.color:x0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const ape=ht(Ct,{coordinates:zC(FV)});function UV(n,e){return xn(null,ape,n,e)}function ope(n,e){const r=e[e.length-1].coordinates,i=So(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),c=parseFloat(a[3]);r.push([o,l,c])}else r.push([])}const lpe=ht(yc,{Track:lo(zV)});function cpe(n,e){const t=xn([],lpe,n,e);if(t)return new tc(t)}const upe=ht(Ct,{when:Ope},ht(yc,{coord:ope}));function zV(n,e){const t=xn({coordinates:[],whens:[]},upe,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new bi(r,"XYZM")}const hpe=ht(Ct,{href:Ge(jV)},ht(yc,{x:Ge(Cn),y:Ge(Cn),w:Ge(Cn),h:Ge(Cn)}));function dpe(n,e){const t=xn({},hpe,n,e);return t||null}const fpe=ht(Ct,{coordinates:zC(FV)});function qC(n,e){return xn(null,fpe,n,e)}const Ew=ht(Ct,{extrude:Ge(Du),tessellate:Ge(Du),altitudeMode:Ge(on)});function $V(n,e){const t=xn({},Ew,n,e),r=qC(n,e);if(r){const i=new bi(r,"XYZ");return i.setProperties(t,!0),i}}function WV(n,e){const t=xn({},Ew,n,e),r=qC(n,e);if(r){const i=new Ba(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const gpe=ht(Ct,{LineString:lo($V),LinearRing:lo(WV),MultiGeometry:lo(HV),Point:lo(KV),Polygon:lo(XV)});function HV(n,e){const t=xn([],gpe,n,e);if(!t)return null;if(t.length===0)return new go(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const c=t[0];o=c.getLayout(),l=c.getFlatCoordinates();for(let h=1,f=t.length;h<f;++h)a=t[h],Vn(l,a.getFlatCoordinates());r=new bd(l,o),TT(r,t)}else if(s=="LineString")r=new tc(t),TT(r,t);else if(s=="Polygon")r=new nd(t),TT(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new go(t);else throw new Error("Unknown geometry type found")}else r=new go(t);return r}function KV(n,e){const t=xn({},Ew,n,e),r=qC(n,e);if(r){const i=new gi(r,"XYZ");return i.setProperties(t,!0),i}}const mpe=ht(Ct,{innerBoundaryIs:kpe,outerBoundaryIs:Npe});function XV(n,e){const t=xn({},Ew,n,e),r=xn([null],mpe,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Vn(i,r[o]),s.push(i.length);const a=new Ba(i,"XYZ",s);return a.setProperties(t,!0),a}}const ppe=ht(Ct,{IconStyle:Jme,LabelStyle:tpe,LineStyle:rpe,PolyStyle:spe});function YC(n,e){const t=xn({},ppe,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:xx;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=XC&&(s=t.imageStyle):s=RA;const a="textStyle"in t?t.textStyle:Bh,o="strokeStyle"in t?t.strokeStyle:IA,l=t.outline;return l!==void 0&&!l?[new mn({geometry:function(c){const h=c.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const m=h;return new go(m.getGeometriesArrayRecursive().filter(function(y){const x=y.getType();return x!=="Polygon"&&x!=="MultiPolygon"}))}if(f!=="Polygon"&&f!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new mn({geometry:function(c){const h=c.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const m=h;return new go(m.getGeometriesArrayRecursive().filter(function(y){const x=y.getType();return x==="Polygon"||x==="MultiPolygon"}))}if(f==="Polygon"||f==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new mn({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function TT(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let c=0;c<t;++c){const h=e[c];r[c]=h.get("extrude"),i[c]=h.get("tessellate"),s[c]=h.get("altitudeMode"),a=a||r[c]!==void 0,o=o||i[c]!==void 0,l=l||s[c]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const ype=ht(Ct,{displayName:Ge(on),value:Ge(on)});function _pe(n,e){const t=n.getAttribute("name");Hu(ype,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const xpe=ht(Ct,{Data:_pe,SchemaData:Tpe});function qV(n,e){Hu(xpe,n,e)}function YV(n,e){Hu(OV,n,e)}const vpe=ht(Ct,{Style:Ge(YC),key:Ge(on),styleUrl:Ge(VV)});function Epe(n,e){const t=xn({},vpe,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function wpe(n,e){const t=BV.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const Spe=ht(Ct,{SimpleData:bpe});function Tpe(n,e){Hu(Spe,n,e)}function bpe(n,e){const t=n.getAttribute("name");if(t!==null){const r=on(n),i=e[e.length-1];i[t]=r}}const Ape=ht(Ct,{altitudeMode:Ge(on),minAltitude:Ge(Cn),maxAltitude:Ge(Cn),north:Ge(Cn),south:Ge(Cn),east:Ge(Cn),west:Ge(Cn)});function Rpe(n,e){const t=xn({},Ape,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const Ipe=ht(Ct,{minLodPixels:Ge(Cn),maxLodPixels:Ge(Cn),minFadeExtent:Ge(Cn),maxFadeExtent:Ge(Cn)});function Cpe(n,e){const t=xn({},Ipe,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const Ppe=ht(Ct,{LinearRing:lo(UV)});function kpe(n,e){const t=xn([],Ppe,n,e);t.length>0&&e[e.length-1].push(...t)}const Mpe=ht(Ct,{LinearRing:zC(UV)});function Npe(n,e){const t=xn(void 0,Mpe,n,e);if(t){const r=e[e.length-1];r[0]=t}}function Lpe(n,e){Hu(Bme,n,e)}function Ope(n,e){const r=e[e.length-1].whens,i=So(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function ww(n,e){const t=Ga(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}Ln(n,i.join(""))}function Dpe(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let c=1;c<a;++c)l+=","+e[c];for(let c=s;c<o;c+=s){l+=" "+e[c];for(let h=1;h<a;++h)l+=","+e[c+h]}}Ln(n,l)}const vx=ht(Ct,{Data:Qe(Fpe),value:Qe(Vpe),displayName:Qe(jpe)});function Fpe(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&ar(r,vx,us,[i.displayName],t,["displayName"]),i!==null&&i.value&&ar(r,vx,us,[i.value],t,["value"])):ar(r,vx,us,[i],t,["value"])}function jpe(n,e){Ln(n,e)}function Vpe(n,e){Ln(n,e)}const Gpe=ht(Ct,{Placemark:Qe(JV)}),Bpe=function(n,e,t){const r=e[e.length-1].node;return Nd(r.namespaceURI,"Placemark")};function Upe(n,e,t){ar({node:n},Gpe,Bpe,e,t,void 0,this)}const zpe=To("Data");function $pe(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)ar(r,vx,zpe,[{name:i[o],value:s[o]}],t)}const QO=ht(Ct,["href"],ht(yc,["x","y","w","h"])),JO=ht(Ct,{href:Qe(Ln)},ht(yc,{x:Qe(Ms),y:Qe(Ms),w:Qe(Ms),h:Qe(Ms)})),Wpe=function(n,e,t){return Nd(yc[0],"gx:"+t)};function Hpe(n,e,t){const r={node:n},i=t[t.length-1].node;let s=QO[i.namespaceURI],a=$s(e,s);ar(r,JO,us,a,t,s),s=QO[yc[0]],a=$s(e,s),ar(r,JO,Wpe,a,t,s)}const Kpe=ht(Ct,["scale","heading","Icon","color","hotSpot"]),Xpe=ht(Ct,{Icon:Qe(Hpe),color:Qe(ww),heading:Qe(Ms),hotSpot:Qe(E1e),scale:Qe(tG)});function qpe(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const E=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),E&&(E[0]!==a[0]/2||E[1]!==a[1]/2)){const b={x:E[0],xunits:"pixels",y:a[1]-E[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let c=e.getScaleArray()[0],h=a;if(h===null&&(h=tp),h.length==2){const E=$v(h);c=c/E}c!==1&&(i.scale=c);const f=e.getRotation();f!==0&&(i.heading=f);const m=e.getColor();m&&(i.color=m);const y=t[t.length-1].node,x=Kpe[y.namespaceURI],v=$s(i,x);ar(r,Xpe,us,v,t,x)}const Ype=ht(Ct,["color","scale"]),Zpe=ht(Ct,{color:Qe(ww),scale:Qe(tG)});function Qpe(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=Ype[o.namespaceURI],c=$s(i,l);ar(r,Zpe,us,c,t,l)}const Jpe=ht(Ct,["color","width"]),e1e=ht(Ct,{color:Qe(ww),width:Qe(Ms)});function t1e(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=Jpe[s.namespaceURI],o=$s(i,a);ar(r,e1e,us,o,t,a)}const n1e={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},ZV=function(n,e,t){if(n){const r=e[e.length-1].node;return Nd(r.namespaceURI,n1e[n.getType()])}},r1e=To("Point"),i1e=To("LineString"),s1e=To("LinearRing"),a1e=To("Polygon"),o1e=ht(Ct,{LineString:Qe(v0),Point:Qe(v0),Polygon:Qe(eG),GeometryCollection:Qe(QV)});function QV(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=ZV;else if(i==="MultiPoint")s=e.getPoints(),a=r1e;else if(i==="MultiLineString")s=e.getLineStrings(),a=i1e;else if(i==="MultiPolygon")s=e.getPolygons(),a=a1e;else throw new Error("Unknown geometry type");ar(r,o1e,a,s,t)}const l1e=ht(Ct,{LinearRing:Qe(v0)});function e5(n,e,t){ar({node:n},l1e,s1e,[e],t)}const bT=ht(Ct,{ExtendedData:Qe($pe),MultiGeometry:Qe(QV),LineString:Qe(v0),LinearRing:Qe(v0),Point:Qe(v0),Polygon:Qe(eG),Style:Qe(v1e),address:Qe(Ln),description:Qe(Ln),name:Qe(Ln),open:Qe(Q0),phoneNumber:Qe(Ln),styleUrl:Qe(Ln),visibility:Qe(Q0)}),c1e=ht(Ct,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),u1e=To("ExtendedData");function JV(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const x=Array.isArray(y)?y:[y];let v=x;if(e.getGeometry()&&(v=x.filter(function(E){const T=E.getGeometryFunction()(e);if(T){const b=T.getType();return b==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(A){const M=A.getType();return M==="Point"||M==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let E=x,T=x;e.getGeometry()&&(E=x.filter(function(b){const A=b.getGeometryFunction()(e);if(A){const M=A.getType();return M==="GeometryCollection"?A.getGeometriesArrayRecursive().filter(function(D){const U=D.getType();return U==="LineString"||U==="MultiLineString"}).length:M==="LineString"||M==="MultiLineString"}}),T=x.filter(function(b){const A=b.getGeometryFunction()(e);if(A){const M=A.getType();return M==="GeometryCollection"?A.getGeometriesArrayRecursive().filter(function(D){const U=D.getType();return U==="Polygon"||U==="MultiPolygon"}).length:M==="Polygon"||M==="MultiPolygon"}})),i.Style={pointStyles:v,lineStyles:E,polyStyles:T}}if(v.length&&i.name===void 0){const E=v[0].getText();E&&(i.name=E.getText())}}}const l=t[t.length-1].node,c=c1e[l.namespaceURI],h=$s(i,c);if(ar(r,bT,us,h,t,c),a.length>0){const y=$s(i,a);ar(r,bT,u1e,[{names:a,values:y}],t)}const f=t[0];let m=e.getGeometry();m&&(m=wo(m,!0,f)),ar(r,bT,ZV,[m],t)}const h1e=ht(Ct,["extrude","tessellate","altitudeMode","coordinates"]),d1e=ht(Ct,{extrude:Qe(Q0),tessellate:Qe(Q0),altitudeMode:Qe(Ln),coordinates:Qe(Dpe)});function v0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=h1e[a.namespaceURI],l=$s(s,o);ar(i,d1e,us,l,t,o)}const f1e=ht(Ct,["color","fill","outline"]),t5=ht(Ct,{outerBoundaryIs:Qe(e5),innerBoundaryIs:Qe(e5)}),g1e=To("innerBoundaryIs"),m1e=To("outerBoundaryIs");function eG(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};ar(s,t5,g1e,r,t),ar(s,t5,m1e,[i],t)}const p1e=ht(Ct,{color:Qe(ww),fill:Qe(Q0),outline:Qe(Q0)});function y1e(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=f1e[o.namespaceURI],c=$s(a,l);ar(r,p1e,us,c,t,l)}function tG(n,e){Ms(n,Math.round(e*1e6)/1e6)}const _1e=ht(Ct,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),x1e=ht(Ct,{IconStyle:Qe(qpe),LabelStyle:Qe(Qpe),LineStyle:Qe(t1e),PolyStyle:Qe(y1e)});function v1e(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=_1e[s.namespaceURI],o=$s(i,a);ar(r,x1e,us,o,t,a)}function E1e(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function nG(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!H_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),Rx(new dE({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=H_(s);for(i=0;i<t;++i){const o=e[i],l=H_(o);if(!K_(s,o))if(n.defs[s]===n.defs[o])HT([a,l]);else{const c=n(s,o);Hz(a,l,q4(a,l,c.forward),q4(l,a,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");nG(bn);let Uh=null,np=null,Kf=null;function kA(n){Uh&&(n.removeLayer(Uh),Uh=null),np&&(n.removeLayer(np),np=null),Kf=null}async function w1e(n,e){try{const t=Tn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=bn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;kA(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(c),!h.ok)return console.error("WFS request failed:",h.status),!1;const f=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(f).substring(0,500)),!f.features||f.features.length===0)return console.log("No parcel found at location"),!1;const m=f.features[0];console.log(" PARCEL ID:",m.id||m.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(m.bbox||"geen bbox"));const x=new BC().readFeature(m,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),v=x.getGeometry();if(!v)return console.log("No geometry in parcel feature"),!1;const E=m.properties||{};console.log(` Parcel: ${E.category||"unknown"} - ${E.gewasnaam||E.gewas||"geen gewas"}`),console.log(` Geometry type: ${v.getType()}, extent: ${v.getExtent().map(k=>k.toFixed(0)).join(", ")}`);const T=v.getExtent(),b=T[2]-T[0],A=T[3]-T[1],M=Math.max(b,A)*.05,D=[T[0]-M,T[1]-M,T[2]+M,T[3]+M],U=Math.max(b,A)*.3,P=[T[0]-U,T[1]-U,T[2]+U,T[3]+U];Kf=v,Uh=new NK({source:new aX({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:D,zIndex:998}),Uh.on("prerender",k=>{if(!Kf)return;const N=k.context;if(!N)return;const O=k.frameState;if(!O)return;N.save(),N.beginPath(),(Kf.getType()==="Polygon"?Kf.getCoordinates()[0]:Kf.getCoordinates()[0][0]).forEach((j,Re)=>{const Ne=n.getPixelFromCoordinate(j);if(!Ne)return;const Ve=O.pixelRatio,Oe=Ne[0]*Ve,ce=Ne[1]*Ve;Re===0?N.moveTo(Oe,ce):N.lineTo(Oe,ce)}),N.closePath(),N.clip()}),Uh.on("postrender",k=>{const N=k.context;N&&N.restore()}),n.addLayer(Uh);const R=new hc({features:[x]});return np=new Gu({source:R,style:new mn({fill:new er({color:"rgba(0, 0, 0, 0)"}),stroke:new Xn({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(np),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var Wv={};Wv.version="0.18.5";var rG=1252,S1e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],iG=function(n){S1e.indexOf(n)!=-1&&(rG=n)};function T1e(){iG(1252)}var Zp=function(n){iG(n)};function b1e(){Zp(1200),T1e()}var F_=function(e){return String.fromCharCode(e)},n5=function(e){return String.fromCharCode(e)},Hv,gu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qp(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),s=t>>2,r=n.charCodeAt(c++),a=(t&3)<<4|r>>4,i=n.charCodeAt(c++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=gu.charAt(s)+gu.charAt(a)+gu.charAt(o)+gu.charAt(l);return e}function lc(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)s=gu.indexOf(n.charAt(c++)),a=gu.indexOf(n.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=gu.indexOf(n.charAt(c++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=gu.indexOf(n.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Nn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),_c=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function _d(n){return Nn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function r5(n){return Nn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var co=function(e){return Nn?_c(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Sw(n){if(typeof ArrayBuffer>"u")return co(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function Y1(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function A1e(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var zi=Nn?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:_c(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function R1e(n){for(var e=[],t=0,r=n.length+250,i=_d(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=_d(65535),r=65530)}return e.push(i.slice(0,t)),zi(e)}var rp=/\u0000/g,j_=/[\u0001-\u0006]/g;function E0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function fo(n,e){var t=""+n;return t.length>=e?t:Fr("0",e-t.length)+t}function ZC(n,e){var t=""+n;return t.length>=e?t:Fr(" ",e-t.length)+t}function Kv(n,e){var t=""+n;return t.length>=e?t:t+Fr(" ",e-t.length)}function I1e(n,e){var t=""+Math.round(n);return t.length>=e?t:Fr("0",e-t.length)+t}function C1e(n,e){var t=""+n;return t.length>=e?t:Fr("0",e-t.length)+t}var i5=Math.pow(2,32);function Nf(n,e){if(n>i5||n<-i5)return I1e(n,e);var t=Math.round(n);return C1e(t,e)}function Xv(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var s5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],AT=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function P1e(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Vr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},a5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},k1e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function qv(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,c=0,h=0,f=Math.floor(i);c<e&&(f=Math.floor(i),o=f*a+s,h=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=s):(h=c,o=a)),!t)return[0,r*o,h];var m=Math.floor(r*o/h);return[m,r*o-m*h,h]}function V_(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=j1e(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var sG=new Date(1899,11,31,0,0,0),M1e=sG.getTime(),N1e=new Date(1900,2,1,0,0,0);function aG(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=N1e&&(t+=1440*60*1e3),(t-(M1e+(n.getTimezoneOffset()-sG.getTimezoneOffset())*6e4))/(1440*60*1e3)}function QC(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function L1e(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function O1e(n){var e=n<0?12:11,t=QC(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function D1e(n){var e=QC(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function F1e(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=O1e(n):e===10?t=n.toFixed(10).substr(0,12):t=D1e(n),QC(L1e(t.toUpperCase()))}function MA(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):F1e(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Fu(14,aG(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function j1e(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function V1e(n,e,t,r){var i="",s=0,a=0,o=t.y,l,c=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return AT[t.m-1][1];case 5:return AT[t.m-1][0];default:return AT[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return s5[t.q][0];default:return s5[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?fo(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=fo(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?fo(l,c):"";return h}function mu(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var oG=/%/g;function G1e(n,e,t){var r=e.replace(oG,""),i=e.length-r.length;return Ql(n,r,t*Math.pow(10,2*i))+Fr("%",i)}function B1e(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ql(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function lG(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lG(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var cG=/# (\?+)( ?)\/( ?)(\d+)/;function U1e(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Fr(" ",n[1].length+1+n[4].length):ZC(a,n[1].length)+n[2]+"/"+n[3]+fo(o,n[4].length))}function z1e(n,e,t){return t+(e===0?"":""+e)+Fr(" ",n[1].length+2+n[4].length)}var uG=/^#*0*\.([0#]+)/,hG=/\).*[0#]/,dG=/\(###\) ###\\?-####/;function ps(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function o5(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function l5(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function $1e(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function W1e(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ra(n,e,t){if(n.charCodeAt(0)===40&&!e.match(hG)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ra("n",r,t):"("+Ra("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return B1e(n,e,t);if(e.indexOf("%")!==-1)return G1e(n,e,t);if(e.indexOf("E")!==-1)return lG(e,t);if(e.charCodeAt(0)===36)return"$"+Ra(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Nf(l,e.length);if(e.match(/^[#?]+$/))return i=Nf(t,0),i==="0"&&(i=""),i.length>e.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(cG))return U1e(s,l,c);if(e.match(/^#+0+$/))return c+Nf(l,e.length-e.indexOf("0"));if(s=e.match(uG))return i=o5(t,s[1].length).replace(/^([^\.]+)$/,"$1."+ps(s[1])).replace(/\.$/,"."+ps(s[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Fr("0",ps(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+o5(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+mu(Nf(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ra(n,e,-t):mu(""+(Math.floor(t)+$1e(t,s[1].length)))+"."+fo(l5(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ra(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=E0(Ra(n,e.replace(/[\\-]/g,""),t)),a=0,E0(E0(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(e.match(dG))return i=Ra(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=qv(l,Math.pow(10,a)-1,!1),i=""+c,h=Ql("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Kv(o[2],a),h.length<s[4].length&&(h=ps(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=qv(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ZC(o[1],a)+s[2]+"/"+s[3]+Kv(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Nf(t,0),e.length<=i.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,m=e.length-i.length-f;return ps(e.substr(0,f)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=l5(t,s[1].length),t<0?"-"+Ra(n,e,-t):mu(W1e(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?fo(0,3-x.length):"")+x})+"."+fo(a,s[1].length);switch(e){case"###,##0.00":return Ra(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=mu(Nf(l,0));return y!=="0"?c+y:"";case"###,###.00":return Ra(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ra(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function H1e(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ql(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function K1e(n,e,t){var r=e.replace(oG,""),i=e.length-r.length;return Ql(n,r,t*Math.pow(10,2*i))+Fr("%",i)}function fG(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fG(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function zo(n,e,t){if(n.charCodeAt(0)===40&&!e.match(hG)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?zo("n",r,t):"("+zo("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return H1e(n,e,t);if(e.indexOf("%")!==-1)return K1e(n,e,t);if(e.indexOf("E")!==-1)return fG(e,t);if(e.charCodeAt(0)===36)return"$"+zo(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+fo(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(cG))return z1e(s,l,c);if(e.match(/^#+0+$/))return c+fo(l,e.length-e.indexOf("0"));if(s=e.match(uG))return i=(""+t).replace(/^([^\.]+)$/,"$1."+ps(s[1])).replace(/\.$/,"."+ps(s[1])),i=i.replace(/\.(\d*)$/,function(x,v){return"."+v+Fr("0",ps(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+mu(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+zo(n,e,-t):mu(""+t)+"."+Fr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return zo(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=E0(zo(n,e.replace(/[\\-]/g,""),t)),a=0,E0(E0(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(e.match(dG))return i=zo(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=qv(l,Math.pow(10,a)-1,!1),i=""+c,h=Ql("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Kv(o[2],a),h.length<s[4].length&&(h=ps(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=qv(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ZC(o[1],a)+s[2]+"/"+s[3]+Kv(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,m=e.length-i.length-f;return ps(e.substr(0,f)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+zo(n,e,-t):mu(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?fo(0,3-x.length):"")+x})+"."+fo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=mu(""+l);return y!=="0"?c+y:"";default:if(e.match(/\.[0#?]*$/))return zo(n,e.slice(0,e.lastIndexOf(".")),t)+ps(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ql(n,e,t){return(t|0)===t?zo(n,e,t):Ra(n,e,t)}function X1e(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var gG=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mG(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":Xv(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(gG))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function q1e(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",c,h,f,m="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!Xv(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),x=y==="("||y===")"?y:"t";i[i.length]={t:x,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(c==null&&(c=V_(e,t,n.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=V_(e,t),c==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(c==null&&(c=V_(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",a+=5,m="h"):(v.t="t",++a),c==null&&v.t==="T")return"";i[i.length]=v,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(gG)){if(c==null&&(c=V_(e,t),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",mG(n)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",E<1&&(E=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var A="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=V1e(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;A+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=MA(e,t);break}var D="",U,P;if(A.length>0){A.charCodeAt(0)==40?(U=e<0&&A.charCodeAt(0)===45?-e:e,P=Ql("n",A,U)):(U=e<0&&r>1?-e:e,P=Ql("n",A,U),U<0&&i[0]&&i[0].t=="t"&&(P=P.substr(1),i[0].v="-"+i[0].v)),M=P.length-1;var R=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){R=a;break}var k=i.length;if(R===i.length&&P.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=P.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=P.substr(0,M+1),M=-1),i[a].t="t",k=a);M>=0&&k<i.length&&(i[k].v=P.substr(0,M+1)+i[k].v)}else if(R!==i.length&&P.indexOf("E")===-1){for(M=P.indexOf(".")-1,a=R;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===R?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(h+1);h>=0;--h)M>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(D=P.charAt(M--)+D);i[a].v=D,i[a].t="t",k=a}for(M>=0&&k<i.length&&(i[k].v=P.substr(0,M+1)+i[k].v),M=P.indexOf(".")+1,a=R;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==R)){for(h=i[a].v.indexOf(".")>-1&&a===R?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,h);h<i[a].v.length;++h)M<P.length&&(D+=P.charAt(M++));i[a].v=D,i[a].t="t",k=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(U=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ql(i[a].t,i[a].v,U),i[a].t="t");var N="";for(a=0;a!==i.length;++a)i[a]!=null&&(N+=i[a].v);return N}var c5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function u5(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function Y1e(n,e){var t=X1e(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(c5),o=t[1].match(c5);return u5(e,a)?[r,t[0]]:u5(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function Fu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Vr)[n],r==null&&(r=t.table&&t.table[a5[n]]||Vr[a5[n]]),r==null&&(r=k1e[n]||"General");break}if(Xv(r,0))return MA(e,t);e instanceof Date&&(e=aG(e,t.date1904));var i=Y1e(r,e);if(Xv(i[1]))return MA(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return q1e(i[1],e,t,i[0])}function pG(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Vr[t]==null){e<0&&(e=t);continue}if(Vr[t]==n){e=t;break}}e<0&&(e=391)}return Vr[e]=n,e}function Tw(n){for(var e=0;e!=392;++e)n[e]!==void 0&&pG(n[e],e)}function bw(){Vr=P1e()}var yG=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Z1e(n){var e=typeof n=="number"?Vr[n]:n;return e=e.replace(yG,"(\\d+)"),new RegExp("^"+e+"$")}function Q1e(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(yG)||[]).forEach(function(f,m){var y=parseInt(t[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:r==-1&&i==-1&&s==-1?h:c+"T"+h}var J1e=(function(){var n={};n.version="1.2.0";function e(){for(var P=0,R=new Array(256),k=0;k!=256;++k)P=k,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,R[k]=P;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function r(P){var R=0,k=0,N=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)O[N]=P[N];for(N=0;N!=256;++N)for(k=P[N],R=256+N;R<4096;R+=256)k=O[R]=k>>>8^P[k&255];var z=[];for(N=1;N!=16;++N)z[N-1]=typeof Int32Array<"u"?O.subarray(N*256,N*256+256):O.slice(N*256,N*256+256);return z}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],h=i[5],f=i[6],m=i[7],y=i[8],x=i[9],v=i[10],E=i[11],T=i[12],b=i[13],A=i[14];function M(P,R){for(var k=R^-1,N=0,O=P.length;N<O;)k=k>>>8^t[(k^P.charCodeAt(N++))&255];return~k}function D(P,R){for(var k=R^-1,N=P.length-15,O=0;O<N;)k=A[P[O++]^k&255]^b[P[O++]^k>>8&255]^T[P[O++]^k>>16&255]^E[P[O++]^k>>>24]^v[P[O++]]^x[P[O++]]^y[P[O++]]^m[P[O++]]^f[P[O++]]^h[P[O++]]^c[P[O++]]^l[P[O++]]^o[P[O++]]^a[P[O++]]^s[P[O++]]^t[P[O++]];for(N+=15;O<N;)k=k>>>8^t[(k^P[O++])&255];return~k}function U(P,R){for(var k=R^-1,N=0,O=P.length,z=0,j=0;N<O;)z=P.charCodeAt(N++),z<128?k=k>>>8^t[(k^z)&255]:z<2048?(k=k>>>8^t[(k^(192|z>>6&31))&255],k=k>>>8^t[(k^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,j=P.charCodeAt(N++)&1023,k=k>>>8^t[(k^(240|z>>8&7))&255],k=k>>>8^t[(k^(128|z>>2&63))&255],k=k>>>8^t[(k^(128|j>>6&15|(z&3)<<4))&255],k=k>>>8^t[(k^(128|j&63))&255]):(k=k>>>8^t[(k^(224|z>>12&15))&255],k=k>>>8^t[(k^(128|z>>6&63))&255],k=k>>>8^t[(k^(128|z&63))&255]);return~k}return n.table=t,n.bstr=M,n.buf=D,n.str=U,n})(),Jn=(function(){var e={};e.version="1.2.1";function t(B,J){for(var K=B.split("/"),q=J.split("/"),ee=0,te=0,ve=Math.min(K.length,q.length);ee<ve;++ee){if(te=K[ee].length-q[ee].length)return te;if(K[ee]!=q[ee])return K[ee]<q[ee]?-1:1}return K.length-q.length}function r(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:r(B.slice(0,-1));var J=B.lastIndexOf("/");return J===-1?B:B.slice(0,J+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var J=B.lastIndexOf("/");return J===-1?B:B.slice(J+1)}function s(B,J){typeof J=="string"&&(J=new Date(J));var K=J.getHours();K=K<<6|J.getMinutes(),K=K<<5|J.getSeconds()>>>1,B.write_shift(2,K);var q=J.getFullYear()-1980;q=q<<4|J.getMonth()+1,q=q<<5|J.getDate(),B.write_shift(2,q)}function a(B){var J=B.read_shift(2)&65535,K=B.read_shift(2)&65535,q=new Date,ee=K&31;K>>>=5;var te=K&15;K>>>=4,q.setMilliseconds(0),q.setFullYear(K+1980),q.setMonth(te-1),q.setDate(ee);var ve=J&31;J>>>=5;var Le=J&63;return J>>>=6,q.setHours(J),q.setMinutes(Le),q.setSeconds(ve<<1),q}function o(B){ia(B,0);for(var J={},K=0;B.l<=B.length-4;){var q=B.read_shift(2),ee=B.read_shift(2),te=B.l+ee,ve={};switch(q){case 21589:K=B.read_shift(1),K&1&&(ve.mtime=B.read_shift(4)),ee>5&&(K&2&&(ve.atime=B.read_shift(4)),K&4&&(ve.ctime=B.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}B.l=te,J[q]=ve}return J}var l;function c(){return l||(l={})}function h(B,J){if(B[0]==80&&B[1]==75)return Z(B,J);if((B[0]|32)==109&&(B[1]|32)==105)return Rt(B,J);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,q=512,ee=0,te=0,ve=0,Le=0,xe=0,Te=[],Ae=B.slice(0,512);ia(Ae,0);var Ke=f(Ae);switch(K=Ke[0],K){case 3:q=512;break;case 4:q=4096;break;case 0:if(Ke[1]==0)return Z(B,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}q!==512&&(Ae=B.slice(0,q),ia(Ae,28));var tt=B.slice(0,q);m(Ae,K);var gt=Ae.read_shift(4,"i");if(K===3&&gt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+gt);Ae.l+=4,ve=Ae.read_shift(4,"i"),Ae.l+=4,Ae.chk("00100000","Mini Stream Cutoff Size: "),Le=Ae.read_shift(4,"i"),ee=Ae.read_shift(4,"i"),xe=Ae.read_shift(4,"i"),te=Ae.read_shift(4,"i");for(var Xe=-1,qe=0;qe<109&&(Xe=Ae.read_shift(4,"i"),!(Xe<0));++qe)Te[qe]=Xe;var Ht=y(B,q);E(xe,te,Ht,q,Te);var jn=b(Ht,ve,Te,q);jn[ve].name="!Directory",ee>0&&Le!==j&&(jn[Le].name="!MiniFAT"),jn[Te[0]].name="!FAT",jn.fat_addrs=Te,jn.ssz=q;var zn={},yr=[],Ha=[],ya=[];A(ve,jn,Ht,yr,ee,zn,Ha,Le),x(Ha,ya,yr),yr.shift();var Xs={FileIndex:Ha,FullPaths:ya};return J&&J.raw&&(Xs.raw={header:tt,sectors:Ht}),Xs}function f(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(Re,"Header Signature: "),B.l+=16;var J=B.read_shift(2,"u");return[B.read_shift(2,"u"),J]}function m(B,J){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function y(B,J){for(var K=Math.ceil(B.length/J)-1,q=[],ee=1;ee<K;++ee)q[ee-1]=B.slice(ee*J,(ee+1)*J);return q[K-1]=B.slice(K*J),q}function x(B,J,K){for(var q=0,ee=0,te=0,ve=0,Le=0,xe=K.length,Te=[],Ae=[];q<xe;++q)Te[q]=Ae[q]=q,J[q]=K[q];for(;Le<Ae.length;++Le)q=Ae[Le],ee=B[q].L,te=B[q].R,ve=B[q].C,Te[q]===q&&(ee!==-1&&Te[ee]!==ee&&(Te[q]=Te[ee]),te!==-1&&Te[te]!==te&&(Te[q]=Te[te])),ve!==-1&&(Te[ve]=q),ee!==-1&&q!=Te[q]&&(Te[ee]=Te[q],Ae.lastIndexOf(ee)<Le&&Ae.push(ee)),te!==-1&&q!=Te[q]&&(Te[te]=Te[q],Ae.lastIndexOf(te)<Le&&Ae.push(te));for(q=1;q<xe;++q)Te[q]===q&&(te!==-1&&Te[te]!==te?Te[q]=Te[te]:ee!==-1&&Te[ee]!==ee&&(Te[q]=Te[ee]));for(q=1;q<xe;++q)if(B[q].type!==0){if(Le=q,Le!=Te[Le])do Le=Te[Le],J[q]=J[Le]+"/"+J[q];while(Le!==0&&Te[Le]!==-1&&Le!=Te[Le]);Te[q]=-1}for(J[0]+="/",q=1;q<xe;++q)B[q].type!==2&&(J[q]+="/")}function v(B,J,K){for(var q=B.start,ee=B.size,te=[],ve=q;K&&ee>0&&ve>=0;)te.push(J.slice(ve*z,ve*z+z)),ee-=z,ve=Nh(K,ve*4);return te.length===0?Me(0):zi(te).slice(0,B.size)}function E(B,J,K,q,ee){var te=j;if(B===j){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var ve=K[B],Le=(q>>>2)-1;if(!ve)return;for(var xe=0;xe<Le&&(te=Nh(ve,xe*4))!==j;++xe)ee.push(te);E(Nh(ve,q-4),J-1,K,q,ee)}}function T(B,J,K,q,ee){var te=[],ve=[];ee||(ee=[]);var Le=q-1,xe=0,Te=0;for(xe=J;xe>=0;){ee[xe]=!0,te[te.length]=xe,ve.push(B[xe]);var Ae=K[Math.floor(xe*4/q)];if(Te=xe*4&Le,q<4+Te)throw new Error("FAT boundary crossed: "+xe+" 4 "+q);if(!B[Ae])break;xe=Nh(B[Ae],Te)}return{nodes:te,data:_5([ve])}}function b(B,J,K,q){var ee=B.length,te=[],ve=[],Le=[],xe=[],Te=q-1,Ae=0,Ke=0,tt=0,gt=0;for(Ae=0;Ae<ee;++Ae)if(Le=[],tt=Ae+J,tt>=ee&&(tt-=ee),!ve[tt]){xe=[];var Xe=[];for(Ke=tt;Ke>=0;){Xe[Ke]=!0,ve[Ke]=!0,Le[Le.length]=Ke,xe.push(B[Ke]);var qe=K[Math.floor(Ke*4/q)];if(gt=Ke*4&Te,q<4+gt)throw new Error("FAT boundary crossed: "+Ke+" 4 "+q);if(!B[qe]||(Ke=Nh(B[qe],gt),Xe[Ke]))break}te[tt]={nodes:Le,data:_5([xe])}}return te}function A(B,J,K,q,ee,te,ve,Le){for(var xe=0,Te=q.length?2:0,Ae=J[B].data,Ke=0,tt=0,gt;Ke<Ae.length;Ke+=128){var Xe=Ae.slice(Ke,Ke+128);ia(Xe,64),tt=Xe.read_shift(2),gt=rP(Xe,0,tt-Te),q.push(gt);var qe={name:gt,type:Xe.read_shift(1),color:Xe.read_shift(1),L:Xe.read_shift(4,"i"),R:Xe.read_shift(4,"i"),C:Xe.read_shift(4,"i"),clsid:Xe.read_shift(16),state:Xe.read_shift(4,"i"),start:0,size:0},Ht=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);Ht!==0&&(qe.ct=M(Xe,Xe.l-8));var jn=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);jn!==0&&(qe.mt=M(Xe,Xe.l-8)),qe.start=Xe.read_shift(4,"i"),qe.size=Xe.read_shift(4,"i"),qe.size<0&&qe.start<0&&(qe.size=qe.type=0,qe.start=j,qe.name=""),qe.type===5?(xe=qe.start,ee>0&&xe!==j&&(J[xe].name="!StreamData")):qe.size>=4096?(qe.storage="fat",J[qe.start]===void 0&&(J[qe.start]=T(K,qe.start,J.fat_addrs,J.ssz)),J[qe.start].name=qe.name,qe.content=J[qe.start].data.slice(0,qe.size)):(qe.storage="minifat",qe.size<0?qe.size=0:xe!==j&&qe.start!==j&&J[xe]&&(qe.content=v(qe,J[xe].data,(J[Le]||{}).data))),qe.content&&ia(qe.content,0),te[gt]=qe,ve.push(qe)}}function M(B,J){return new Date((oa(B,J+4)/1e7*Math.pow(2,32)+oa(B,J)/1e7-11644473600)*1e3)}function D(B,J){return c(),h(l.readFileSync(B),J)}function U(B,J){var K=J&&J.type;switch(K||Nn&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return D(B,J);case"base64":return h(co(lc(B)),J);case"binary":return h(co(B),J)}return h(B,J)}function P(B,J){var K=J||{},q=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=q+"/",B.FileIndex[0]={name:q,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),R(B)}function R(B){var J="Sh33tJ5";if(!Jn.find(B,"/"+J)){var K=Me(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:J,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+J),k(B)}}function k(B,J){P(B);for(var K=!1,q=!1,ee=B.FullPaths.length-1;ee>=0;--ee){var te=B.FileIndex[ee];switch(te.type){case 0:q?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(te.R*te.L*te.C)&&(K=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!J)){var ve=new Date(1987,1,19),Le=0,xe=Object.create?Object.create(null):{},Te=[];for(ee=0;ee<B.FullPaths.length;++ee)xe[B.FullPaths[ee]]=!0,B.FileIndex[ee].type!==0&&Te.push([B.FullPaths[ee],B.FileIndex[ee]]);for(ee=0;ee<Te.length;++ee){var Ae=r(Te[ee][0]);q=xe[Ae],q||(Te.push([Ae,{name:i(Ae).replace("/",""),type:1,clsid:Ve,ct:ve,mt:ve,content:null}]),xe[Ae]=!0)}for(Te.sort(function(gt,Xe){return t(gt[0],Xe[0])}),B.FullPaths=[],B.FileIndex=[],ee=0;ee<Te.length;++ee)B.FullPaths[ee]=Te[ee][0],B.FileIndex[ee]=Te[ee][1];for(ee=0;ee<Te.length;++ee){var Ke=B.FileIndex[ee],tt=B.FullPaths[ee];if(Ke.name=i(tt).replace("/",""),Ke.L=Ke.R=Ke.C=-(Ke.color=1),Ke.size=Ke.content?Ke.content.length:0,Ke.start=0,Ke.clsid=Ke.clsid||Ve,ee===0)Ke.C=Te.length>1?1:-1,Ke.size=0,Ke.type=5;else if(tt.slice(-1)=="/"){for(Le=ee+1;Le<Te.length&&r(B.FullPaths[Le])!=tt;++Le);for(Ke.C=Le>=Te.length?-1:Le,Le=ee+1;Le<Te.length&&r(B.FullPaths[Le])!=r(tt);++Le);Ke.R=Le>=Te.length?-1:Le,Ke.type=1}else r(B.FullPaths[ee+1]||"")==r(tt)&&(Ke.R=ee+1),Ke.type=2}}}function N(B,J){var K=J||{};if(K.fileType=="mad")return cn(B,K);switch(k(B),K.fileType){case"zip":return ue(B,K)}var q=(function(gt){for(var Xe=0,qe=0,Ht=0;Ht<gt.FileIndex.length;++Ht){var jn=gt.FileIndex[Ht];if(jn.content){var zn=jn.content.length;zn>0&&(zn<4096?Xe+=zn+63>>6:qe+=zn+511>>9)}}for(var yr=gt.FullPaths.length+3>>2,Ha=Xe+7>>3,ya=Xe+127>>7,Xs=Ha+qe+yr+ya,Br=Xs+127>>7,xc=Br<=109?0:Math.ceil((Br-109)/127);Xs+Br+xc+127>>7>Br;)xc=++Br<=109?0:Math.ceil((Br-109)/127);var br=[1,xc,Br,ya,yr,qe,Xe,0];return gt.FileIndex[0].size=Xe<<6,br[7]=(gt.FileIndex[0].start=br[0]+br[1]+br[2]+br[3]+br[4]+br[5])+(br[6]+7>>3),br})(B),ee=Me(q[7]<<9),te=0,ve=0;{for(te=0;te<8;++te)ee.write_shift(1,Ne[te]);for(te=0;te<8;++te)ee.write_shift(2,0);for(ee.write_shift(2,62),ee.write_shift(2,3),ee.write_shift(2,65534),ee.write_shift(2,9),ee.write_shift(2,6),te=0;te<3;++te)ee.write_shift(2,0);for(ee.write_shift(4,0),ee.write_shift(4,q[2]),ee.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),ee.write_shift(4,0),ee.write_shift(4,4096),ee.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:j),ee.write_shift(4,q[3]),ee.write_shift(-4,q[1]?q[0]-1:j),ee.write_shift(4,q[1]),te=0;te<109;++te)ee.write_shift(-4,te<q[2]?q[1]+te:-1)}if(q[1])for(ve=0;ve<q[1];++ve){for(;te<236+ve*127;++te)ee.write_shift(-4,te<q[2]?q[1]+te:-1);ee.write_shift(-4,ve===q[1]-1?j:ve+1)}var Le=function(gt){for(ve+=gt;te<ve-1;++te)ee.write_shift(-4,te+1);gt&&(++te,ee.write_shift(-4,j))};for(ve=te=0,ve+=q[1];te<ve;++te)ee.write_shift(-4,Oe.DIFSECT);for(ve+=q[2];te<ve;++te)ee.write_shift(-4,Oe.FATSECT);Le(q[3]),Le(q[4]);for(var xe=0,Te=0,Ae=B.FileIndex[0];xe<B.FileIndex.length;++xe)Ae=B.FileIndex[xe],Ae.content&&(Te=Ae.content.length,!(Te<4096)&&(Ae.start=ve,Le(Te+511>>9)));for(Le(q[6]+7>>3);ee.l&511;)ee.write_shift(-4,Oe.ENDOFCHAIN);for(ve=te=0,xe=0;xe<B.FileIndex.length;++xe)Ae=B.FileIndex[xe],Ae.content&&(Te=Ae.content.length,!(!Te||Te>=4096)&&(Ae.start=ve,Le(Te+63>>6)));for(;ee.l&511;)ee.write_shift(-4,Oe.ENDOFCHAIN);for(te=0;te<q[4]<<2;++te){var Ke=B.FullPaths[te];if(!Ke||Ke.length===0){for(xe=0;xe<17;++xe)ee.write_shift(4,0);for(xe=0;xe<3;++xe)ee.write_shift(4,-1);for(xe=0;xe<12;++xe)ee.write_shift(4,0);continue}Ae=B.FileIndex[te],te===0&&(Ae.start=Ae.size?Ae.start-1:j);var tt=te===0&&K.root||Ae.name;if(Te=2*(tt.length+1),ee.write_shift(64,tt,"utf16le"),ee.write_shift(2,Te),ee.write_shift(1,Ae.type),ee.write_shift(1,Ae.color),ee.write_shift(-4,Ae.L),ee.write_shift(-4,Ae.R),ee.write_shift(-4,Ae.C),Ae.clsid)ee.write_shift(16,Ae.clsid,"hex");else for(xe=0;xe<4;++xe)ee.write_shift(4,0);ee.write_shift(4,Ae.state||0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,Ae.start),ee.write_shift(4,Ae.size),ee.write_shift(4,0)}for(te=1;te<B.FileIndex.length;++te)if(Ae=B.FileIndex[te],Ae.size>=4096)if(ee.l=Ae.start+1<<9,Nn&&Buffer.isBuffer(Ae.content))Ae.content.copy(ee,ee.l,0,Ae.size),ee.l+=Ae.size+511&-512;else{for(xe=0;xe<Ae.size;++xe)ee.write_shift(1,Ae.content[xe]);for(;xe&511;++xe)ee.write_shift(1,0)}for(te=1;te<B.FileIndex.length;++te)if(Ae=B.FileIndex[te],Ae.size>0&&Ae.size<4096)if(Nn&&Buffer.isBuffer(Ae.content))Ae.content.copy(ee,ee.l,0,Ae.size),ee.l+=Ae.size+63&-64;else{for(xe=0;xe<Ae.size;++xe)ee.write_shift(1,Ae.content[xe]);for(;xe&63;++xe)ee.write_shift(1,0)}if(Nn)ee.l=ee.length;else for(;ee.l<ee.length;)ee.write_shift(1,0);return ee}function O(B,J){var K=B.FullPaths.map(function(xe){return xe.toUpperCase()}),q=K.map(function(xe){var Te=xe.split("/");return Te[Te.length-(xe.slice(-1)=="/"?2:1)]}),ee=!1;J.charCodeAt(0)===47?(ee=!0,J=K[0].slice(0,-1)+J):ee=J.indexOf("/")!==-1;var te=J.toUpperCase(),ve=ee===!0?K.indexOf(te):q.indexOf(te);if(ve!==-1)return B.FileIndex[ve];var Le=!te.match(j_);for(te=te.replace(rp,""),Le&&(te=te.replace(j_,"!")),ve=0;ve<K.length;++ve)if((Le?K[ve].replace(j_,"!"):K[ve]).replace(rp,"")==te||(Le?q[ve].replace(j_,"!"):q[ve]).replace(rp,"")==te)return B.FileIndex[ve];return null}var z=64,j=-2,Re="d0cf11e0a1b11ae1",Ne=[208,207,17,224,161,177,26,225],Ve="00000000000000000000000000000000",Oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ce(B,J,K){c();var q=N(B,K);l.writeFileSync(J,q)}function we(B){for(var J=new Array(B.length),K=0;K<B.length;++K)J[K]=String.fromCharCode(B[K]);return J.join("")}function Se(B,J){var K=N(B,J);switch(J&&J.type||"buffer"){case"file":return c(),l.writeFileSync(J.filename,K),K;case"binary":return typeof K=="string"?K:we(K);case"base64":return Qp(typeof K=="string"?K:we(K));case"buffer":if(Nn)return Buffer.isBuffer(K)?K:_c(K);case"array":return typeof K=="string"?co(K):K}return K}var se;function V(B){try{var J=B.InflateRaw,K=new J;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)se=B;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function Q(B,J){if(!se)return Ot(B,J);var K=se.InflateRaw,q=new K,ee=q._processChunk(B.slice(B.l),q._finishFlushFlag);return B.l+=q.bytesRead,ee}function ne(B){return se?se.deflateRawSync(B):Kr(B)}var ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(B){var J=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(J>>16|J>>8|J)&255}for(var fe=typeof Uint8Array<"u",le=fe?new Uint8Array(256):[],yt=0;yt<256;++yt)le[yt]=Fe(yt);function St(B,J){var K=le[B&255];return J<=8?K>>>8-J:(K=K<<8|le[B>>8&255],J<=16?K>>>16-J:(K=K<<8|le[B>>16&255],K>>>24-J))}function ln(B,J){var K=J&7,q=J>>>3;return(B[q]|(K<=6?0:B[q+1]<<8))>>>K&3}function kt(B,J){var K=J&7,q=J>>>3;return(B[q]|(K<=5?0:B[q+1]<<8))>>>K&7}function Dn(B,J){var K=J&7,q=J>>>3;return(B[q]|(K<=4?0:B[q+1]<<8))>>>K&15}function tn(B,J){var K=J&7,q=J>>>3;return(B[q]|(K<=3?0:B[q+1]<<8))>>>K&31}function lt(B,J){var K=J&7,q=J>>>3;return(B[q]|(K<=1?0:B[q+1]<<8))>>>K&127}function nr(B,J,K){var q=J&7,ee=J>>>3,te=(1<<K)-1,ve=B[ee]>>>q;return K<8-q||(ve|=B[ee+1]<<8-q,K<16-q)||(ve|=B[ee+2]<<16-q,K<24-q)||(ve|=B[ee+3]<<24-q),ve&te}function hn(B,J,K){var q=J&7,ee=J>>>3;return q<=5?B[ee]|=(K&7)<<q:(B[ee]|=K<<q&255,B[ee+1]=(K&7)>>8-q),J+3}function rn(B,J,K){var q=J&7,ee=J>>>3;return K=(K&1)<<q,B[ee]|=K,J+1}function rr(B,J,K){var q=J&7,ee=J>>>3;return K<<=q,B[ee]|=K&255,K>>>=8,B[ee+1]=K,J+8}function mt(B,J,K){var q=J&7,ee=J>>>3;return K<<=q,B[ee]|=K&255,K>>>=8,B[ee+1]=K&255,B[ee+2]=K>>>8,J+16}function Ut(B,J){var K=B.length,q=2*K>J?2*K:J+5,ee=0;if(K>=J)return B;if(Nn){var te=r5(q);if(B.copy)B.copy(te);else for(;ee<B.length;++ee)te[ee]=B[ee];return te}else if(fe){var ve=new Uint8Array(q);if(ve.set)ve.set(B);else for(;ee<K;++ee)ve[ee]=B[ee];return ve}return B.length=q,B}function Fn(B){for(var J=new Array(B),K=0;K<B;++K)J[K]=0;return J}function xt(B,J,K){var q=1,ee=0,te=0,ve=0,Le=0,xe=B.length,Te=fe?new Uint16Array(32):Fn(32);for(te=0;te<32;++te)Te[te]=0;for(te=xe;te<K;++te)B[te]=0;xe=B.length;var Ae=fe?new Uint16Array(xe):Fn(xe);for(te=0;te<xe;++te)Te[ee=B[te]]++,q<ee&&(q=ee),Ae[te]=0;for(Te[0]=0,te=1;te<=q;++te)Te[te+16]=Le=Le+Te[te-1]<<1;for(te=0;te<xe;++te)Le=B[te],Le!=0&&(Ae[te]=Te[Le+16]++);var Ke=0;for(te=0;te<xe;++te)if(Ke=B[te],Ke!=0)for(Le=St(Ae[te],q)>>q-Ke,ve=(1<<q+4-Ke)-1;ve>=0;--ve)J[Le|ve<<Ke]=Ke&15|te<<4;return q}var nn=fe?new Uint16Array(512):Fn(512),Nt=fe?new Uint16Array(32):Fn(32);if(!fe){for(var cr=0;cr<512;++cr)nn[cr]=0;for(cr=0;cr<32;++cr)Nt[cr]=0}(function(){for(var B=[],J=0;J<32;J++)B.push(5);xt(B,Nt,32);var K=[];for(J=0;J<=143;J++)K.push(8);for(;J<=255;J++)K.push(9);for(;J<=279;J++)K.push(7);for(;J<=287;J++)K.push(8);xt(K,nn,288)})();var _i=(function(){for(var J=fe?new Uint8Array(32768):[],K=0,q=0;K<Ce.length-1;++K)for(;q<Ce[K+1];++q)J[q]=K;for(;q<32768;++q)J[q]=29;var ee=fe?new Uint8Array(259):[];for(K=0,q=0;K<me.length-1;++K)for(;q<me[K+1];++q)ee[q]=K;function te(Le,xe){for(var Te=0;Te<Le.length;){var Ae=Math.min(65535,Le.length-Te),Ke=Te+Ae==Le.length;for(xe.write_shift(1,+Ke),xe.write_shift(2,Ae),xe.write_shift(2,~Ae&65535);Ae-- >0;)xe[xe.l++]=Le[Te++]}return xe.l}function ve(Le,xe){for(var Te=0,Ae=0,Ke=fe?new Uint16Array(32768):[];Ae<Le.length;){var tt=Math.min(65535,Le.length-Ae);if(tt<10){for(Te=hn(xe,Te,+(Ae+tt==Le.length)),Te&7&&(Te+=8-(Te&7)),xe.l=Te/8|0,xe.write_shift(2,tt),xe.write_shift(2,~tt&65535);tt-- >0;)xe[xe.l++]=Le[Ae++];Te=xe.l*8;continue}Te=hn(xe,Te,+(Ae+tt==Le.length)+2);for(var gt=0;tt-- >0;){var Xe=Le[Ae];gt=(gt<<5^Xe)&32767;var qe=-1,Ht=0;if((qe=Ke[gt])&&(qe|=Ae&-32768,qe>Ae&&(qe-=32768),qe<Ae))for(;Le[qe+Ht]==Le[Ae+Ht]&&Ht<250;)++Ht;if(Ht>2){Xe=ee[Ht],Xe<=22?Te=rr(xe,Te,le[Xe+1]>>1)-1:(rr(xe,Te,3),Te+=5,rr(xe,Te,le[Xe-23]>>5),Te+=3);var jn=Xe<8?0:Xe-4>>2;jn>0&&(mt(xe,Te,Ht-me[Xe]),Te+=jn),Xe=J[Ae-qe],Te=rr(xe,Te,le[Xe]>>3),Te-=3;var zn=Xe<4?0:Xe-2>>1;zn>0&&(mt(xe,Te,Ae-qe-Ce[Xe]),Te+=zn);for(var yr=0;yr<Ht;++yr)Ke[gt]=Ae&32767,gt=(gt<<5^Le[Ae])&32767,++Ae;tt-=Ht-1}else Xe<=143?Xe=Xe+48:Te=rn(xe,Te,1),Te=rr(xe,Te,le[Xe]),Ke[gt]=Ae&32767,++Ae}Te=rr(xe,Te,0)-1}return xe.l=(Te+7)/8|0,xe.l}return function(xe,Te){return xe.length<8?te(xe,Te):ve(xe,Te)}})();function Kr(B){var J=Me(50+Math.floor(B.length*1.1)),K=_i(B,J);return J.slice(0,K)}var Wt=fe?new Uint16Array(32768):Fn(32768),fs=fe?new Uint16Array(32768):Fn(32768),je=fe?new Uint16Array(128):Fn(128),be=1,_e=1;function Lt(B,J){var K=tn(B,J)+257;J+=5;var q=tn(B,J)+1;J+=5;var ee=Dn(B,J)+4;J+=4;for(var te=0,ve=fe?new Uint8Array(19):Fn(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xe=1,Te=fe?new Uint8Array(8):Fn(8),Ae=fe?new Uint8Array(8):Fn(8),Ke=ve.length,tt=0;tt<ee;++tt)ve[ie[tt]]=te=kt(B,J),xe<te&&(xe=te),Te[te]++,J+=3;var gt=0;for(Te[0]=0,tt=1;tt<=xe;++tt)Ae[tt]=gt=gt+Te[tt-1]<<1;for(tt=0;tt<Ke;++tt)(gt=ve[tt])!=0&&(Le[tt]=Ae[gt]++);var Xe=0;for(tt=0;tt<Ke;++tt)if(Xe=ve[tt],Xe!=0){gt=le[Le[tt]]>>8-Xe;for(var qe=(1<<7-Xe)-1;qe>=0;--qe)je[gt|qe<<Xe]=Xe&7|tt<<3}var Ht=[];for(xe=1;Ht.length<K+q;)switch(gt=je[lt(B,J)],J+=gt&7,gt>>>=3){case 16:for(te=3+ln(B,J),J+=2,gt=Ht[Ht.length-1];te-- >0;)Ht.push(gt);break;case 17:for(te=3+kt(B,J),J+=3;te-- >0;)Ht.push(0);break;case 18:for(te=11+lt(B,J),J+=7;te-- >0;)Ht.push(0);break;default:Ht.push(gt),xe<gt&&(xe=gt);break}var jn=Ht.slice(0,K),zn=Ht.slice(K);for(tt=K;tt<286;++tt)jn[tt]=0;for(tt=q;tt<30;++tt)zn[tt]=0;return be=xt(jn,Wt,286),_e=xt(zn,fs,30),J}function L(B,J){if(B[0]==3&&!(B[1]&3))return[_d(J),2];for(var K=0,q=0,ee=r5(J||1<<18),te=0,ve=ee.length>>>0,Le=0,xe=0;(q&1)==0;){if(q=kt(B,K),K+=3,q>>>1)q>>1==1?(Le=9,xe=5):(K=Lt(B,K),Le=be,xe=_e);else{K&7&&(K+=8-(K&7));var Te=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,Te>0)for(!J&&ve<te+Te&&(ee=Ut(ee,te+Te),ve=ee.length);Te-- >0;)ee[te++]=B[K>>>3],K+=8;continue}for(;;){!J&&ve<te+32767&&(ee=Ut(ee,te+32767),ve=ee.length);var Ae=nr(B,K,Le),Ke=q>>>1==1?nn[Ae]:Wt[Ae];if(K+=Ke&15,Ke>>>=4,(Ke>>>8&255)===0)ee[te++]=Ke;else{if(Ke==256)break;Ke-=257;var tt=Ke<8?0:Ke-4>>2;tt>5&&(tt=0);var gt=te+me[Ke];tt>0&&(gt+=nr(B,K,tt),K+=tt),Ae=nr(B,K,xe),Ke=q>>>1==1?Nt[Ae]:fs[Ae],K+=Ke&15,Ke>>>=4;var Xe=Ke<4?0:Ke-2>>1,qe=Ce[Ke];for(Xe>0&&(qe+=nr(B,K,Xe),K+=Xe),!J&&ve<gt&&(ee=Ut(ee,gt+100),ve=ee.length);te<gt;)ee[te]=ee[te-qe],++te}}}return J?[ee,K+7>>>3]:[ee.slice(0,te),K+7>>>3]}function Ot(B,J){var K=B.slice(B.l||0),q=L(K,J);return B.l+=q[1],q[0]}function W(B,J){if(B)typeof console<"u"&&console.error(J);else throw new Error(J)}function Z(B,J){var K=B;ia(K,0);var q=[],ee=[],te={FileIndex:q,FullPaths:ee};P(te,{root:J.root});for(var ve=K.length-4;(K[ve]!=80||K[ve+1]!=75||K[ve+2]!=5||K[ve+3]!=6)&&ve>=0;)--ve;K.l=ve+4,K.l+=4;var Le=K.read_shift(2);K.l+=6;var xe=K.read_shift(4);for(K.l=xe,ve=0;ve<Le;++ve){K.l+=20;var Te=K.read_shift(4),Ae=K.read_shift(4),Ke=K.read_shift(2),tt=K.read_shift(2),gt=K.read_shift(2);K.l+=8;var Xe=K.read_shift(4),qe=o(K.slice(K.l+Ke,K.l+Ke+tt));K.l+=Ke+tt+gt;var Ht=K.l;K.l=Xe+4,Y(K,Te,Ae,te,qe),K.l=Ht}return te}function Y(B,J,K,q,ee){B.l+=2;var te=B.read_shift(2),ve=B.read_shift(2),Le=a(B);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var xe=B.read_shift(4),Te=B.read_shift(4),Ae=B.read_shift(4),Ke=B.read_shift(2),tt=B.read_shift(2),gt="",Xe=0;Xe<Ke;++Xe)gt+=String.fromCharCode(B[B.l++]);if(tt){var qe=o(B.slice(B.l,B.l+tt));(qe[21589]||{}).mt&&(Le=qe[21589].mt),((ee||{})[21589]||{}).mt&&(Le=ee[21589].mt)}B.l+=tt;var Ht=B.slice(B.l,B.l+Te);switch(ve){case 8:Ht=Q(B,Ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var jn=!1;te&8&&(xe=B.read_shift(4),xe==134695760&&(xe=B.read_shift(4),jn=!0),Te=B.read_shift(4),Ae=B.read_shift(4)),Te!=J&&W(jn,"Bad compressed size: "+J+" != "+Te),Ae!=K&&W(jn,"Bad uncompressed size: "+K+" != "+Ae),pn(q,gt,Ht,{unsafe:!0,mt:Le})}function ue(B,J){var K=J||{},q=[],ee=[],te=Me(1),ve=K.compression?8:0,Le=0,xe=0,Te=0,Ae=0,Ke=0,tt=B.FullPaths[0],gt=tt,Xe=B.FileIndex[0],qe=[],Ht=0;for(xe=1;xe<B.FullPaths.length;++xe)if(gt=B.FullPaths[xe].slice(tt.length),Xe=B.FileIndex[xe],!(!Xe.size||!Xe.content||gt=="Sh33tJ5")){var jn=Ae,zn=Me(gt.length);for(Te=0;Te<gt.length;++Te)zn.write_shift(1,gt.charCodeAt(Te)&127);zn=zn.slice(0,zn.l),qe[Ke]=J1e.buf(Xe.content,0);var yr=Xe.content;ve==8&&(yr=ne(yr)),te=Me(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,Le),te.write_shift(2,ve),Xe.mt?s(te,Xe.mt):te.write_shift(4,0),te.write_shift(-4,qe[Ke]),te.write_shift(4,yr.length),te.write_shift(4,Xe.content.length),te.write_shift(2,zn.length),te.write_shift(2,0),Ae+=te.length,q.push(te),Ae+=zn.length,q.push(zn),Ae+=yr.length,q.push(yr),te=Me(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,Le),te.write_shift(2,ve),te.write_shift(4,0),te.write_shift(-4,qe[Ke]),te.write_shift(4,yr.length),te.write_shift(4,Xe.content.length),te.write_shift(2,zn.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,jn),Ht+=te.l,ee.push(te),Ht+=zn.length,ee.push(zn),++Ke}return te=Me(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Ke),te.write_shift(2,Ke),te.write_shift(4,Ht),te.write_shift(4,Ae),te.write_shift(2,0),zi([zi(q),zi(ee),te])}var he={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Be(B,J){if(B.ctype)return B.ctype;var K=B.name||"",q=K.match(/\.([^\.]+)$/);return q&&he[q[1]]||J&&(q=(K=J).match(/[\.\\]([^\.\\])+$/),q&&he[q[1]])?he[q[1]]:"application/octet-stream"}function Ie(B){for(var J=Qp(B),K=[],q=0;q<J.length;q+=76)K.push(J.slice(q,q+76));return K.join(`\r
`)+`\r
`}function $e(B){var J=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Ae=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Ae.length==1?"0"+Ae:Ae)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],q=J.split(`\r
`),ee=0;ee<q.length;++ee){var te=q[ee];if(te.length==0){K.push("");continue}for(var ve=0;ve<te.length;){var Le=76,xe=te.slice(ve,ve+Le);xe.charAt(Le-1)=="="?Le--:xe.charAt(Le-2)=="="?Le-=2:xe.charAt(Le-3)=="="&&(Le-=3),xe=te.slice(ve,ve+Le),ve+=Le,ve<te.length&&(xe+="="),K.push(xe)}}return K.join(`\r
`)}function et(B){for(var J=[],K=0;K<B.length;++K){for(var q=B[K];K<=B.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+B[++K];J.push(q)}for(var ee=0;ee<J.length;++ee)J[ee]=J[ee].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return co(J.join(`\r
`))}function ft(B,J,K){for(var q="",ee="",te="",ve,Le=0;Le<10;++Le){var xe=J[Le];if(!xe||xe.match(/^\s*$/))break;var Te=xe.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":q=Te[2].trim();break;case"content-type":te=Te[2].trim();break;case"content-transfer-encoding":ee=Te[2].trim();break}}switch(++Le,ee.toLowerCase()){case"base64":ve=co(lc(J.slice(Le).join("")));break;case"quoted-printable":ve=et(J.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ee)}var Ae=pn(B,q.slice(K.length),ve,{unsafe:!0});te&&(Ae.ctype=te)}function Rt(B,J){if(we(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=J&&J.root||"",q=(Nn&&Buffer.isBuffer(B)?B.toString("binary"):we(B)).split(`\r
`),ee=0,te="";for(ee=0;ee<q.length;++ee)if(te=q[ee],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),K||(K=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),te.slice(0,K.length)!=K););var ve=(q[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var Le="--"+(ve[1]||""),xe=[],Te=[],Ae={FileIndex:xe,FullPaths:Te};P(Ae);var Ke,tt=0;for(ee=0;ee<q.length;++ee){var gt=q[ee];gt!==Le&&gt!==Le+"--"||(tt++&&ft(Ae,q.slice(Ke,ee),K),Ke=ee)}return Ae}function cn(B,J){var K=J||{},q=K.boundary||"SheetJS";q="------="+q;for(var ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],te=B.FullPaths[0],ve=te,Le=B.FileIndex[0],xe=1;xe<B.FullPaths.length;++xe)if(ve=B.FullPaths[xe].slice(te.length),Le=B.FileIndex[xe],!(!Le.size||!Le.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ht){return"_x"+Ht.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ht){return"_u"+Ht.charCodeAt(0).toString(16)+"_"});for(var Te=Le.content,Ae=Nn&&Buffer.isBuffer(Te)?Te.toString("binary"):we(Te),Ke=0,tt=Math.min(1024,Ae.length),gt=0,Xe=0;Xe<=tt;++Xe)(gt=Ae.charCodeAt(Xe))>=32&&gt<128&&++Ke;var qe=Ke>=tt*4/5;ee.push(q),ee.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ve),ee.push("Content-Transfer-Encoding: "+(qe?"quoted-printable":"base64")),ee.push("Content-Type: "+Be(Le,ve)),ee.push(""),ee.push(qe?$e(Ae):Ie(Ae))}return ee.push(q+`--\r
`),ee.join(`\r
`)}function mr(B){var J={};return P(J,B),J}function pn(B,J,K,q){var ee=q&&q.unsafe;ee||P(B);var te=!ee&&Jn.find(B,J);if(!te){var ve=B.FullPaths[0];J.slice(0,ve.length)==ve?ve=J:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+J).replace("//","/")),te={name:i(J),type:2},B.FileIndex.push(te),B.FullPaths.push(ve),ee||Jn.utils.cfb_gc(B)}return te.content=K,te.size=K?K.length:0,q&&(q.CLSID&&(te.clsid=q.CLSID),q.mt&&(te.mt=q.mt),q.ct&&(te.ct=q.ct)),te}function pr(B,J){P(B);var K=Jn.find(B,J);if(K){for(var q=0;q<B.FileIndex.length;++q)if(B.FileIndex[q]==K)return B.FileIndex.splice(q,1),B.FullPaths.splice(q,1),!0}return!1}function Tr(B,J,K){P(B);var q=Jn.find(B,J);if(q){for(var ee=0;ee<B.FileIndex.length;++ee)if(B.FileIndex[ee]==q)return B.FileIndex[ee].name=i(K),B.FullPaths[ee]=K,!0}return!1}function Ki(B){k(B,!0)}return e.find=O,e.read=U,e.parse=h,e.write=Se,e.writeFile=ce,e.utils={cfb_new:mr,cfb_add:pn,cfb_del:pr,cfb_mov:Tr,cfb_gc:Ki,ReadShift:sp,CheckField:OG,prep_blob:ia,bconcat:zi,use_zlib:V,_deflateRaw:Kr,_inflateRaw:Ot,consts:Oe},e})();function eye(n){return typeof n=="string"?Sw(n):Array.isArray(n)?A1e(n):n}function Z1(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Sw(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?e1(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([eye(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Y1(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Hi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function h5(n,e){for(var t=[],r=Hi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function JC(n){for(var e=[],t=Hi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function Aw(n){for(var e=[],t=Hi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function tye(n){for(var e=[],t=Hi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var Yv=new Date(1899,11,30,0,0,0);function Ws(n,e){var t=n.getTime(),r=Yv.getTime()+(n.getTimezoneOffset()-Yv.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var _G=new Date,nye=Yv.getTime()+(_G.getTimezoneOffset()-Yv.getTimezoneOffset())*6e4,d5=_G.getTimezoneOffset();function xG(n){var e=new Date;return e.setTime(n*24*60*60*1e3+nye),e.getTimezoneOffset()!==d5&&e.setTime(e.getTime()+(e.getTimezoneOffset()-d5)*6e4),e}var f5=new Date("2017-02-19T19:06:09.000Z"),vG=isNaN(f5.getFullYear())?new Date("2/19/17"):f5,rye=vG.getFullYear()==2017;function Ts(n,e){var t=new Date(n);if(rye)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(vG.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Rw(n,e){if(Nn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Hs(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Hs(n[t]));return e}function Fr(n,e){for(var t="";t.length<e;)t+=n;return t}function Jl(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var iye=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jp(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&iye.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function an(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Nn?r=_c(t):r=R1e(t),Jn.utils.cfb_add(n,e,r)}Jn.utils.cfb_add(n,e,t)}else n.file(e,t)}function eP(){return Jn.utils.cfb_new()}var ai=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,sye={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},tP=JC(sye),nP=/[&<>'"]/g,aye=/[\u0000-\u0008\u000b-\u001f]/g;function Yn(n){var e=n+"";return e.replace(nP,function(t){return tP[t]}).replace(aye,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function g5(n){return Yn(n).replace(/ /g,"_x0020_")}var EG=/[\u0000-\u001f]/g;function oye(n){var e=n+"";return e.replace(nP,function(t){return tP[t]}).replace(/\n/g,"<br/>").replace(EG,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function lye(n){var e=n+"";return e.replace(nP,function(t){return tP[t]}).replace(EG,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function cye(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function uye(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function RT(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function m5(n){var e=_d(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function p5(n){return _c(n,"binary").toString("utf8")}var G_="foo bar baz",ip=Nn&&(p5(G_)==RT(G_)&&p5||m5(G_)==RT(G_)&&m5)||RT,e1=Nn?function(n){return _c(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},hye=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),wG=/(^\s|\s$|\n)/;function $i(n,e){return"<"+n+(e.match(wG)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function t1(n){return Hi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function nt(n,e,t){return"<"+n+(t!=null?t1(t):"")+(e!=null?(e.match(wG)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function NA(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function dye(n,e){switch(typeof n){case"string":var t=nt("vt:lpwstr",Yn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return nt((n|0)==n?"vt:i4":"vt:r8",Yn(String(n)));case"boolean":return nt("vt:bool",n?"true":"false")}if(n instanceof Date)return nt("vt:filetime",NA(n));throw new Error("Unable to serialize "+n)}var Ri={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],aa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function fye(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function gye(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var y5=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},_5=Nn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:_c(e)})):y5(n)}:y5,x5=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(Pm(n,i)));return r.join("").replace(rp,"")},rP=Nn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(rp,""):x5(n,e,t)}:x5,v5=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},SG=Nn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):v5(n,e,t)}:v5,E5=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Xf(n,i)));return r.join("")},Q1=Nn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):E5(e,t,r)}:E5,TG=function(n,e){var t=oa(n,e);return t>0?Q1(n,e+4,e+4+t-1):""},bG=TG,AG=function(n,e){var t=oa(n,e);return t>0?Q1(n,e+4,e+4+t-1):""},RG=AG,IG=function(n,e){var t=2*oa(n,e);return t>0?Q1(n,e+4,e+4+t-1):""},CG=IG,PG=function(e,t){var r=oa(e,t);return r>0?rP(e,t+4,t+4+r):""},kG=PG,MG=function(n,e){var t=oa(n,e);return t>0?Q1(n,e+4,e+4+t):""},NG=MG,LG=function(n,e){return fye(n,e)},Zv=LG,iP=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Nn&&(bG=function(e,t){if(!Buffer.isBuffer(e))return TG(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},RG=function(e,t){if(!Buffer.isBuffer(e))return AG(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},CG=function(e,t){if(!Buffer.isBuffer(e))return IG(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},kG=function(e,t){if(!Buffer.isBuffer(e))return PG(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},NG=function(e,t){if(!Buffer.isBuffer(e))return MG(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Zv=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):LG(e,t)},iP=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Xf=function(n,e){return n[e]},Pm=function(n,e){return n[e+1]*256+n[e]},mye=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},oa=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Nh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},pye=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function sp(n,e){var t="",r,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Nn&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(Pm(this,c)),c+=2;n*=2;break;case"utf8":t=Q1(this,this.l,this.l+n);break;case"utf16le":n*=2,t=rP(this,this.l,this.l+n);break;case"wstr":return sp.call(this,n,"dbcs");case"lpstr-ansi":t=bG(this,this.l),n=4+oa(this,this.l);break;case"lpstr-cp":t=RG(this,this.l),n=4+oa(this,this.l);break;case"lpwstr":t=CG(this,this.l),n=4+2*oa(this,this.l);break;case"lpp4":n=4+oa(this,this.l),t=kG(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+oa(this,this.l),t=NG(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Xf(this,this.l+n++))!==0;)s.push(F_(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=Pm(this,this.l+n))!==0;)s.push(F_(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Xf(this,c),this.l=c+1,o=sp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(F_(Pm(this,c))),c+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Xf(this,c),this.l=c+1,o=sp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(F_(Xf(this,c))),c+=1}t=s.join("");break;default:switch(n){case 1:return r=Xf(this,this.l),this.l++,r;case 2:return r=(e==="i"?mye:Pm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?Nh:pye)(this,this.l),this.l+=4,r):(i=oa(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=Zv(this,this.l):i=Zv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=SG(this,this.l,n);break}}return this.l+=n,t}var yye=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},_ye=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},xye=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function vye(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)xye(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,yye(this,e,this.l);break;case 8:if(r=8,t==="f"){gye(this,e,this.l);break}case 16:break;case-4:r=4,_ye(this,e,this.l);break}return this.l+=r,this}function OG(n,e){var t=SG(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function ia(n,e){n.l=e,n.read_shift=sp,n.chk=OG,n.write_shift=vye}function fl(n,e){n.l+=e}function Me(n){var e=_d(n);return ia(e,0),e}function Gs(){var n=[],e=Nn?256:2048,t=function(c){var h=Me(c);return ia(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},a=function(){return i(),zi(n)},o=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ue(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=f2e[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&iP(t)&&n.push(t)}}function ap(n,e,t){var r=Hs(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function w5(n,e,t){var r=Hs(n);return r.s=ap(r.s,e.s,t),r.e=ap(r.e,e.s,t),r}function op(n,e){if(n.cRel&&n.c<0)for(n=Hs(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Hs(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Qn(n);return!n.cRel&&n.cRel!=null&&(t=Sye(t)),!n.rRel&&n.rRel!=null&&(t=Eye(t)),t}function IT(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+hs(n.s.c)+":"+(n.e.cRel?"":"$")+hs(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Wi(n.s.r)+":"+(n.e.rRel?"":"$")+Wi(n.e.r):op(n.s,e.biff)+":"+op(n.e,e.biff)}function sP(n){return parseInt(wye(n),10)-1}function Wi(n){return""+(n+1)}function Eye(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wye(n){return n.replace(/\$(\d+)$/,"$1")}function aP(n){for(var e=Tye(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function hs(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function Sye(n){return n.replace(/^([A-Z])/,"$$$1")}function Tye(n){return n.replace(/^\$([A-Z])/,"$1")}function bye(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ci(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Qn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ma(n){var e=n.indexOf(":");return e==-1?{s:Ci(n),e:Ci(n)}:{s:Ci(n.slice(0,e)),e:Ci(n.slice(e+1))}}function ri(n,e){return typeof e>"u"||typeof e=="number"?ri(n.s,n.e):(typeof n!="string"&&(n=Qn(n)),typeof e!="string"&&(e=Qn(e)),n==e?n:n+":"+e)}function gr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function S5(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=Fu(n.z,t?Ws(e):e)}catch{}try{return n.w=Fu((n.XF||{}).numFmtId||(t?14:0),t?Ws(e):e)}catch{return""+e}}function cc(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?J1[n.v]||n.v:e==null?S5(n,n.v):S5(n,e))}function Ld(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function DG(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Ci(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=gr(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[f].length;++m)if(!(typeof e[f][m]>"u")){var y={v:e[f][m]},x=a+f,v=o+m;if(c.s.r>x&&(c.s.r=x),c.s.c>v&&(c.s.c=v),c.e.r<x&&(c.e.r=x),c.e.c<v&&(c.e.c=v),e[f][m]&&typeof e[f][m]=="object"&&!Array.isArray(e[f][m])&&!(e[f][m]instanceof Date))y=e[f][m];else if(Array.isArray(y.v)&&(y.f=e[f][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Vr[14],r.cellDates?(y.t="d",y.w=Fu(y.z,Ws(y.v))):(y.t="n",y.v=Ws(y.v),y.w=Fu(y.z,y.v))):y.t="s";if(i)s[x]||(s[x]=[]),s[x][v]&&s[x][v].z&&(y.z=s[x][v].z),s[x][v]=y;else{var E=Qn({c:v,r:x});s[E]&&s[E].z&&(y.z=s[E].z),s[E]=y}}}return c.s.c<1e7&&(s["!ref"]=ri(c)),s}function gg(n,e){return DG(null,n,e)}function Aye(n){return n.read_shift(4,"i")}function xo(n,e){return e||(e=Me(4)),e.write_shift(4,n),e}function ds(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function Pi(n,e){var t=!1;return e==null&&(t=!0,e=Me(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function Rye(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Iye(n,e){return e||(e=Me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function oP(n,e){var t=n.l,r=n.read_shift(1),i=ds(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(Rye(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function Cye(n,e){var t=!1;return e==null&&(t=!0,e=Me(15+4*n.t.length)),e.write_shift(1,0),Pi(n.t,e),t?e.slice(0,e.l):e}var Pye=oP;function kye(n,e){var t=!1;return e==null&&(t=!0,e=Me(23+4*n.t.length)),e.write_shift(1,1),Pi(n.t,e),e.write_shift(4,1),Iye({},e),t?e.slice(0,e.l):e}function Wa(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Od(n,e){return e==null&&(e=Me(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Dd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Fd(n,e){return e==null&&(e=Me(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var Mye=ds,FG=Pi;function lP(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function Qv(n,e){var t=!1;return e==null&&(t=!0,e=Me(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var Nye=ds,LA=lP,cP=Qv;function jG(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?Zv([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Nh(e,0)>>2;return t?i/100:i}function VG(n,e){e==null&&(e=Me(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function GG(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function Lye(n,e){return e||(e=Me(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var jd=GG,mg=Lye;function pg(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function xd(n,e){return(e||Me(8)).write_shift(8,n,"f")}function Oye(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=$ye[i];c&&(e.rgb=L5(c));break;case 2:e.rgb=L5([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Jv(n,e){if(e||(e=Me(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Dye(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Fye(n,e){e||(e=Me(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var BG=2,na=3,B_=11,eE=19,U_=64,jye=65,Vye=71,Gye=4108,Bye=4126,Gi=80,T5={1:{n:"CodePage",t:BG},2:{n:"Category",t:Gi},3:{n:"PresentationFormat",t:Gi},4:{n:"ByteCount",t:na},5:{n:"LineCount",t:na},6:{n:"ParagraphCount",t:na},7:{n:"SlideCount",t:na},8:{n:"NoteCount",t:na},9:{n:"HiddenCount",t:na},10:{n:"MultimediaClipCount",t:na},11:{n:"ScaleCrop",t:B_},12:{n:"HeadingPairs",t:Gye},13:{n:"TitlesOfParts",t:Bye},14:{n:"Manager",t:Gi},15:{n:"Company",t:Gi},16:{n:"LinksUpToDate",t:B_},17:{n:"CharacterCount",t:na},19:{n:"SharedDoc",t:B_},22:{n:"HyperlinksChanged",t:B_},23:{n:"AppVersion",t:na,p:"version"},24:{n:"DigSig",t:jye},26:{n:"ContentType",t:Gi},27:{n:"ContentStatus",t:Gi},28:{n:"Language",t:Gi},29:{n:"Version",t:Gi},255:{},2147483648:{n:"Locale",t:eE},2147483651:{n:"Behavior",t:eE},1919054434:{}},b5={1:{n:"CodePage",t:BG},2:{n:"Title",t:Gi},3:{n:"Subject",t:Gi},4:{n:"Author",t:Gi},5:{n:"Keywords",t:Gi},6:{n:"Comments",t:Gi},7:{n:"Template",t:Gi},8:{n:"LastAuthor",t:Gi},9:{n:"RevNumber",t:Gi},10:{n:"EditTime",t:U_},11:{n:"LastPrinted",t:U_},12:{n:"CreatedDate",t:U_},13:{n:"ModifiedDate",t:U_},14:{n:"PageCount",t:na},15:{n:"WordCount",t:na},16:{n:"CharCount",t:na},17:{n:"Thumbnail",t:Vye},18:{n:"Application",t:Gi},19:{n:"DocSecurity",t:na},255:{},2147483648:{n:"Locale",t:eE},2147483651:{n:"Behavior",t:eE},1919054434:{}};function Uye(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var zye=Uye([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$ye=Hs(zye),J1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Wye={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},z_={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function UG(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function zG(n,e){var t=tye(Wye),r=[],i;r[r.length]=ai,r[r.length]=nt("Types",null,{xmlns:Ri.CT,"xmlns:xsd":Ri.xsd,"xmlns:xsi":Ri.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return nt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=nt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:z_[l][e.bookType]||z_[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=nt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:z_[l][e.bookType]||z_[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(c){r[r.length]=nt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var In={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $G(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function w0(n){var e=[ai,nt("Relationships",null,{xmlns:Ri.RELS})];return Hi(n["!id"]).forEach(function(t){e[e.length]=nt("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Hn(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[In.HLINK,In.XPATH,In.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function Hye(n){var e=[ai];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function A5(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Kye(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Xye(n){var e=[ai];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(A5(n[t][0],n[t][1])),e.push(Kye("",n[t][0]));return e.push(A5("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function WG(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wv.version+"</meta:generator></office:meta></office:document-meta>"}var Yh=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function CT(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Yn(e),r[r.length]=t?nt(n,e,t):$i(n,e))}function HG(n,e){var t=e||{},r=[ai,nt("cp:coreProperties",null,{"xmlns:cp":Ri.CORE_PROPS,"xmlns:dc":Ri.dc,"xmlns:dcterms":Ri.dcterms,"xmlns:dcmitype":Ri.dcmitype,"xmlns:xsi":Ri.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&CT("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:NA(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&CT("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:NA(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Yh.length;++s){var a=Yh[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&CT(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var S0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],KG=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function XG(n){var e=[],t=nt;return n||(n={}),n.Application="SheetJS",e[e.length]=ai,e[e.length]=nt("Properties",null,{xmlns:Ri.EXT_PROPS,"xmlns:vt":Ri.vt}),S0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Yn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Yn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function qG(n){var e=[ai,nt("Properties",null,{xmlns:Ri.CUST_PROPS,"xmlns:vt":Ri.vt})];if(!n)return e.join("");var t=1;return Hi(n).forEach(function(i){++t,e[e.length]=nt("property",dye(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Yn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var R5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function qye(n,e){var t=[];return Hi(R5).map(function(r){for(var i=0;i<Yh.length;++i)if(Yh[i][1]==r)return Yh[i];for(i=0;i<S0.length;++i)if(S0[i][1]==r)return S0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push($i(R5[r[1]]||r[1],i))}}),nt("DocumentProperties",t.join(""),{xmlns:aa.o})}function Yye(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Hi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<Yh.length;++a)if(s==Yh[a][1])return;for(a=0;a<S0.length;++a)if(s==S0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(nt(g5(s),o,{"dt:dt":l}))}}),e&&Hi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(nt(g5(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+aa.o+'">'+i.join("")+"</"+r+">"}function Zye(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Me(8);return a.write_shift(4,r),a.write_shift(4,i),a}function I5(n,e){var t=Me(4),r=Me(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Me(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=Zye(e);break;case 31:case 80:for(r=Me(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return zi([t,r])}var YG=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Qye(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function C5(n,e,t){var r=Me(8),i=[],s=[],a=8,o=0,l=Me(8),c=Me(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=Me(8),c.write_shift(4,0),i.unshift(c);var h=[Me(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var f=n[o][0];for(l=Me(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=zi(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(YG.indexOf(n[o][0])>-1||KG.indexOf(n[o][0])>-1)&&n[o][1]!=null){var m=n[o][1],y=0;if(e){y=+e[n[o][0]];var x=t[y];if(x.p=="version"&&typeof m=="string"){var v=m.split(".");m=(+v[0]<<16)+(+v[1]||0)}l=I5(x.t,m)}else{var E=Qye(m);E==-1&&(E=31,m=String(m)),l=I5(E,m)}s.push(l),c=Me(8),c.write_shift(4,e?y:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),zi([r].concat(i).concat(s))}function P5(n,e,t,r,i,s){var a=Me(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Jn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=C5(n,t,r);if(o.push(l),i){var c=C5(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return zi(o)}function Jye(n,e){e||(e=Me(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function e_e(n,e){return n.read_shift(e)===1}function ys(n,e){return e||(e=Me(2)),e.write_shift(2,+!!n),e}function ZG(n){return n.read_shift(2,"u")}function Pa(n,e){return e||(e=Me(2)),e.write_shift(2,n),e}function QG(n,e,t){return t||(t=Me(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function JG(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function t_e(n){var e=n.t||"",t=Me(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Me(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return zi(i)}function n_e(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function r_e(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):n_e(n,r,t)}function i_e(n,e,t){if(t.biff>5)return r_e(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function eB(n,e,t){return t||(t=Me(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function k5(n,e){e||(e=Me(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function s_e(n){var e=Me(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),k5(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&k5(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function vd(n,e,t,r){return r||(r=Me(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function a_e(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function o_e(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function tB(n,e){return e||(e=Me(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function uP(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Me(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function l_e(n,e){var t=!e||e.biff==8,r=Me(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function c_e(n,e){var t=!e||e.biff>=8?2:1,r=Me(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function u_e(n,e){var t=Me(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=t_e(n[i]);var s=zi([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function h_e(){var n=Me(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function d_e(n){var e=Me(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function f_e(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Me(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function g_e(n,e,t,r){var i=Me(10);return vd(n,e,r,i),i.write_shift(4,t),i}function m_e(n,e,t,r,i){var s=!i||i.biff==8,a=Me(8+ +s+(1+s)*t.length);return vd(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function p_e(n,e,t,r){var i=t&&t.biff==5;r||(r=Me(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function y_e(n,e){var t=e.biff==8||!e.biff?4:2,r=Me(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function M5(n,e,t,r){var i=t&&t.biff==5;r||(r=Me(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function __e(n){var e=Me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function x_e(n,e,t,r,i,s){var a=Me(8);return vd(n,e,r,a),QG(t,s,a),a}function v_e(n,e,t,r){var i=Me(14);return vd(n,e,r,i),xd(t,i),i}function E_e(n,e,t){if(t.biff<8)return w_e(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(a_e(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function w_e(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=JG(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function S_e(n){var e=Me(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)tB(n[t],e);return e}function T_e(n){var e=Me(24),t=Ci(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return zi([e,s_e(n[1])])}function b_e(n){var e=n[1].Tooltip,t=Me(10+2*(e.length+1));t.write_shift(2,2048);var r=Ci(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function A_e(n){return n||(n=Me(4)),n.write_shift(2,1),n.write_shift(2,1),n}function R_e(n,e,t){if(!t.cellStyles)return fl(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function I_e(n,e){var t=Me(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function C_e(n){for(var e=Me(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function P_e(n,e,t){var r=Me(15);return ty(r,n,e),r.write_shift(8,t,"f"),r}function k_e(n,e,t){var r=Me(9);return ty(r,n,e),r.write_shift(2,t),r}var M_e=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=JC({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],h=_d(1);switch(l.type){case"base64":h=co(lc(o));break;case"binary":h=co(o);break;case"buffer":case"array":h=o;break}ia(h,0);var f=h.read_shift(1),m=!!(f&136),y=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,E=521;f==2&&(v=h.read_shift(2)),h.l+=3,f!=2&&(v=h.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(E=h.read_shift(2));var T=h.read_shift(2),b=l.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),x&&(h.l+=36);for(var A=[],M={},D=Math.min(h.length,f==2?521:E-10-(y?264:0)),U=x?32:11;h.l<D&&h[h.l]!=13;)switch(M={},M.name=Hv.utils.decode(b,h.slice(h.l,h.l+U)).replace(/[\u0000\r\n].*$/g,""),h.l+=U,M.type=String.fromCharCode(h.read_shift(1)),f!=2&&!x&&(M.offset=h.read_shift(4)),M.len=h.read_shift(1),f==2&&(M.offset=h.read_shift(2)),M.dec=h.read_shift(1),M.name.length&&A.push(M),f!=2&&(h.l+=x?13:14),M.type){case"B":(!y||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var P=0,R=0;for(c[0]=[],R=0;R!=A.length;++R)c[0][R]=A[R].name;for(;v-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,c[++P]=[],R=0,R=0;R!=A.length;++R){var k=h.slice(h.l,h.l+A[R].len);h.l+=A[R].len,ia(k,0);var N=Hv.utils.decode(b,k);switch(A[R].type){case"C":N.trim().length&&(c[P][R]=N.replace(/\s+$/,""));break;case"D":N.length===8?c[P][R]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):c[P][R]=N;break;case"F":c[P][R]=parseFloat(N.trim());break;case"+":case"I":c[P][R]=x?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":c[P][R]=!0;break;case"N":case"F":c[P][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[P][R]="##MEMO##"+(x?parseInt(N.trim(),10):k.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(c[P][R]=+N||0);break;case"@":c[P][R]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[P][R]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[P][R]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[P][R]=-k.read_shift(-8,"f");break;case"B":if(y&&A[R].len==8){c[P][R]=k.read_shift(8,"f");break}case"G":case"P":k.l+=A[R].len;break;case"0":if(A[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[R].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=A,c}function r(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=gg(t(o,c),c);return h["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,h}function i(o,l){try{return Ld(r(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Zp(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=Gs(),f=sE(o,{header:1,raw:!0,cellDates:!0}),m=f[0],y=f.slice(1),x=o["!cols"]||[],v=0,E=0,T=0,b=1;for(v=0;v<m.length;++v){if(((x[v]||{}).DBF||{}).name){m[v]=x[v].DBF.name,++T;continue}if(m[v]!=null){if(++T,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(E=0;E<1024;++E)if(m.indexOf(m[v]+"_"+E)==-1){m[v]+="_"+E;break}}}}var A=gr(o["!ref"]),M=[],D=[],U=[];for(v=0;v<=A.e.c-A.s.c;++v){var P="",R="",k=0,N=[];for(E=0;E<y.length;++E)y[E][v]!=null&&N.push(y[E][v]);if(N.length==0||m[v]==null){M[v]="?";continue}for(E=0;E<N.length;++E){switch(typeof N[E]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=N[E]instanceof Date?"D":"C";break;default:R="C"}k=Math.max(k,String(N[E]).length),P=P&&P!=R?"C":R}k>250&&(k=250),R=((x[v]||{}).DBF||{}).type,R=="C"&&x[v].DBF.len>k&&(k=x[v].DBF.len),P=="B"&&R=="N"&&(P="N",U[v]=x[v].DBF.dec,k=x[v].DBF.len),D[v]=P=="C"||R=="N"?k:s[P]||0,b+=D[v],M[v]=P}var O=h.next(32);for(O.write_shift(4,318902576),O.write_shift(4,y.length),O.write_shift(2,296+32*T),O.write_shift(2,b),v=0;v<4;++v)O.write_shift(4,0);for(O.write_shift(4,0|(+e[rG]||3)<<8),v=0,E=0;v<m.length;++v)if(m[v]!=null){var z=h.next(32),j=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,j,"sbcs"),z.write_shift(1,M[v]=="?"?"C":M[v],"sbcs"),z.write_shift(4,E),z.write_shift(1,D[v]||s[M[v]]||0),z.write_shift(1,U[v]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),E+=D[v]||s[M[v]]||0}var Re=h.next(264);for(Re.write_shift(4,13),v=0;v<65;++v)Re.write_shift(4,0);for(v=0;v<y.length;++v){var Ne=h.next(b);for(Ne.write_shift(1,0),E=0;E<m.length;++E)if(m[E]!=null)switch(M[E]){case"L":Ne.write_shift(1,y[v][E]==null?63:y[v][E]?84:70);break;case"B":Ne.write_shift(8,y[v][E]||0,"f");break;case"N":var Ve="0";for(typeof y[v][E]=="number"&&(Ve=y[v][E].toFixed(U[E]||0)),T=0;T<D[E]-Ve.length;++T)Ne.write_shift(1,32);Ne.write_shift(1,Ve,"sbcs");break;case"D":y[v][E]?(Ne.write_shift(4,("0000"+y[v][E].getFullYear()).slice(-4),"sbcs"),Ne.write_shift(2,("00"+(y[v][E].getMonth()+1)).slice(-2),"sbcs"),Ne.write_shift(2,("00"+y[v][E].getDate()).slice(-2),"sbcs")):Ne.write_shift(8,"00000000","sbcs");break;case"C":var Oe=String(y[v][E]!=null?y[v][E]:"").slice(0,D[E]);for(Ne.write_shift(1,Oe,"sbcs"),T=0;T<D[E]-Oe.length;++T)Ne.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),N_e=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Hi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,y){var x=n[y];return typeof x=="number"?n5(x):x},r=function(m,y,x){var v=y.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?m:n5(v)};n["|"]=254;function i(m,y){switch(y.type){case"base64":return s(lc(m),y);case"binary":return s(m,y);case"buffer":return s(Nn&&Buffer.isBuffer(m)?m.toString("binary"):Y1(m),y);case"array":return s(Rw(m),y)}throw new Error("Unrecognized type "+y.type)}function s(m,y){var x=m.split(/[\n\r]+/),v=-1,E=-1,T=0,b=0,A=[],M=[],D=null,U={},P=[],R=[],k=[],N=0,O;for(+y.codepage>=0&&Zp(+y.codepage);T!==x.length;++T){N=0;var z=x[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=z.replace(/;;/g,"\0").split(";").map(function(ie){return ie.replace(/\u0000/g,";")}),Re=j[0],Ne;if(z.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&M.push(z.slice(3).replace(/;;/g,";"));break;case"C":var Ve=!1,Oe=!1,ce=!1,we=!1,Se=-1,se=-1;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"A":break;case"X":E=parseInt(j[b].slice(1))-1,Oe=!0;break;case"Y":for(v=parseInt(j[b].slice(1))-1,Oe||(E=0),O=A.length;O<=v;++O)A[O]=[];break;case"K":Ne=j[b].slice(1),Ne.charAt(0)==='"'?Ne=Ne.slice(1,Ne.length-1):Ne==="TRUE"?Ne=!0:Ne==="FALSE"?Ne=!1:isNaN(Jl(Ne))?isNaN(Jp(Ne).getDate())||(Ne=Ts(Ne)):(Ne=Jl(Ne),D!==null&&mG(D)&&(Ne=xG(Ne))),Ve=!0;break;case"E":we=!0;var V=kxe(j[b].slice(1),{r:v,c:E});A[v][E]=[A[v][E],V];break;case"S":ce=!0,A[v][E]=[A[v][E],"S5S"];break;case"G":break;case"R":Se=parseInt(j[b].slice(1))-1;break;case"C":se=parseInt(j[b].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}if(Ve&&(A[v][E]&&A[v][E].length==2?A[v][E][0]=Ne:A[v][E]=Ne,D=null),ce){if(we)throw new Error("SYLK shared formula cannot have own formula");var Q=Se>-1&&A[Se][se];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");A[v][E][1]=Mxe(Q[1],{r:v-Se,c:E-se})}break;case"F":var ne=0;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"X":E=parseInt(j[b].slice(1))-1,++ne;break;case"Y":for(v=parseInt(j[b].slice(1))-1,O=A.length;O<=v;++O)A[O]=[];break;case"M":N=parseInt(j[b].slice(1))/20;break;case"F":break;case"G":break;case"P":D=M[parseInt(j[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=j[b].slice(1).split(" "),O=parseInt(k[0],10);O<=parseInt(k[1],10);++O)N=parseInt(k[2],10),R[O-1]=N===0?{hidden:!0}:{wch:N},hP(R[O-1]);break;case"C":E=parseInt(j[b].slice(1))-1,R[E]||(R[E]={});break;case"R":v=parseInt(j[b].slice(1))-1,P[v]||(P[v]={}),N>0?(P[v].hpt=N,P[v].hpx=aB(N)):N===0&&(P[v].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}ne<1&&(D=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}}return P.length>0&&(U["!rows"]=P),R.length>0&&(U["!cols"]=R),y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),[A,U]}function a(m,y){var x=i(m,y),v=x[0],E=x[1],T=gg(v,y);return Hi(E).forEach(function(b){T[b]=E[b]}),T}function o(m,y){return Ld(a(m,y),y)}function l(m,y,x,v){var E="C;Y"+(x+1)+";X"+(v+1)+";K";switch(m.t){case"n":E+=m.v||0,m.f&&!m.F&&(E+=";E"+fP(m.f,{r:x,c:v}));break;case"b":E+=m.v?"TRUE":"FALSE";break;case"e":E+=m.w||m.v;break;case"d":E+='"'+(m.w||m.v)+'"';break;case"s":E+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(m,y){y.forEach(function(x,v){var E="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?E+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=tE(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=nE(x.wpx)),typeof x.wch=="number"&&(E+=Math.round(x.wch))),E.charAt(E.length-1)!=" "&&m.push(E)})}function h(m,y){y.forEach(function(x,v){var E="F;";x.hidden?E+="M0;":x.hpt?E+="M"+20*x.hpt+";":x.hpx&&(E+="M"+20*rE(x.hpx)+";"),E.length>2&&m.push(E+"R"+(v+1))})}function f(m,y){var x=["ID;PWXL;N;E"],v=[],E=gr(m["!ref"]),T,b=Array.isArray(m),A=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&c(x,m["!cols"]),m["!rows"]&&h(x,m["!rows"]),x.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var M=E.s.r;M<=E.e.r;++M)for(var D=E.s.c;D<=E.e.c;++D){var U=Qn({r:M,c:D});T=b?(m[M]||[])[D]:m[U],!(!T||T.v==null&&(!T.f||T.F))&&v.push(l(T,m,M,D))}return x.join(A)+A+v.join(A)+A+"E"+A}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),L_e=(function(){function n(s,a){switch(a.type){case"base64":return e(lc(s),a);case"binary":return e(s,a);case"buffer":return e(Nn&&Buffer.isBuffer(s)?s.toString("binary"):Y1(s),a);case"array":return e(Rw(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var m=o[h].trim().split(","),y=m[0],x=m[1];++h;for(var v=o[h]||"";(v.match(/["]/g)||[]).length&1&&h<o.length-1;)v+=`
`+o[++h];switch(v=v.trim(),+y){case-1:if(v==="BOT"){f[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[l][c]=!0:v==="FALSE"?f[l][c]=!1:isNaN(Jl(x))?isNaN(Jp(x).getDate())?f[l][c]=x:f[l][c]=Ts(x):f[l][c]=Jl(x),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function t(s,a){return gg(n(s,a),a)}function r(s,a){return Ld(t(s,a),a)}var i=(function(){var s=function(l,c,h,f,m){l.push(c),l.push(h+","+f),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,c,h,f){l.push(c+","+h),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],h=gr(l["!ref"]),f,m=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,h.e.r-h.s.r+1,""),s(c,"TUPLES",0,h.e.c-h.s.c+1,""),s(c,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(c,-1,0,"BOT");for(var x=h.s.c;x<=h.e.c;++x){var v=Qn({r:y,c:x});if(f=m?(l[y]||[])[x]:l[v],!f){a(c,1,0,"");continue}switch(f.t){case"n":var E=f.w;!E&&f.v!=null&&(E=f.v),E==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Fu(f.z||Vr[14],Ws(Ts(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,b=c.join(T);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),nB=(function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,m){for(var y=f.split(`
`),x=-1,v=-1,E=0,T=[];E!==y.length;++E){var b=y[E].trim().split(":");if(b[0]==="cell"){var A=Ci(b[1]);if(T.length<=A.r)for(x=T.length;x<=A.r;++x)T[x]||(T[x]=[]);switch(x=A.r,v=A.c,b[2]){case"t":T[x][v]=n(b[3]);break;case"v":T[x][v]=+b[3];break;case"vtf":var M=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[x][v]=!!+b[4];break;default:T[x][v]=+b[4];break}b[2]=="vtf"&&(T[x][v]=[T[x][v],M])}}}return m&&m.sheetRows&&(T=T.slice(0,m.sheetRows)),T}function r(f,m){return gg(t(f,m),m)}function i(f,m){return Ld(r(f,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var m=[],y=[],x,v="",E=ma(f["!ref"]),T=Array.isArray(f),b=E.s.r;b<=E.e.r;++b)for(var A=E.s.c;A<=E.e.c;++A)if(v=Qn({r:b,c:A}),x=T?(f[b]||[])[A]:f[v],!(!x||x.v==null||x.t==="z")){switch(y=["cell",v,"t"],x.t){case"s":case"str":y.push(e(x.v));break;case"n":x.f?(y[2]="vtf",y[3]="n",y[4]=x.v,y[5]=e(x.f)):(y[2]="v",y[3]=x.v);break;case"b":y[2]="vt"+(x.f?"f":"c"),y[3]="nl",y[4]=x.v?"1":"0",y[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var M=Ws(Ts(x.v));y[2]="vtc",y[3]="nd",y[4]=""+M,y[5]=x.w||Fu(x.z||Vr[14],M);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),O_e=(function(){function n(h,f,m,y,x){x.raw?f[m][y]=h:h===""||(h==="TRUE"?f[m][y]=!0:h==="FALSE"?f[m][y]=!1:isNaN(Jl(h))?isNaN(Jp(h).getDate())?f[m][y]=h:f[m][y]=Ts(h):f[m][y]=Jl(h))}function e(h,f){var m=f||{},y=[];if(!h||h.length===0)return y;for(var x=h.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var E=10,T=0,b=0;b<=v;++b)T=x[b].indexOf(" "),T==-1?T=x[b].length:T++,E=Math.max(E,T);for(b=0;b<=v;++b){y[b]=[];var A=0;for(n(x[b].slice(0,E).trim(),y,b,A,m),A=1;A<=(x[b].length-E)/10+1;++A)n(x[b].slice(E+(A-1)*10,E+A*10).trim(),y,b,A,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var f={},m=!1,y=0,x=0;y<h.length;++y)(x=h.charCodeAt(y))==34?m=!m:!m&&x in t&&(f[x]=(f[x]||0)+1);x=[];for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&x.push([f[y],y]);if(!x.length){f=r;for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&x.push([f[y],y])}return x.sort(function(v,E){return v[0]-E[0]||r[v[1]]-r[E[1]]}),t[x.pop()[1]]||44}function s(h,f){var m=f||{},y="",x=m.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):m&&m.FS?y=m.FS:y=i(h.slice(0,1024));var E=0,T=0,b=0,A=0,M=0,D=y.charCodeAt(0),U=!1,P=0,R=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var k=m.dateNF!=null?Z1e(m.dateNF):null;function N(){var O=h.slice(A,M),z={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)z.t="z";else if(m.raw)z.t="s",z.v=O;else if(O.trim().length===0)z.t="s",z.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(z.t="s",z.v=O.slice(2,-1).replace(/""/g,'"')):Nxe(O)?(z.t="n",z.f=O.slice(1)):(z.t="s",z.v=O);else if(O=="TRUE")z.t="b",z.v=!0;else if(O=="FALSE")z.t="b",z.v=!1;else if(!isNaN(b=Jl(O)))z.t="n",m.cellText!==!1&&(z.w=O),z.v=b;else if(!isNaN(Jp(O).getDate())||k&&O.match(k)){z.z=m.dateNF||Vr[14];var j=0;k&&O.match(k)&&(O=Q1e(O,m.dateNF,O.match(k)||[]),j=1),m.cellDates?(z.t="d",z.v=Ts(O,j)):(z.t="n",z.v=Ws(Ts(O,j))),m.cellText!==!1&&(z.w=Fu(z.z,z.v instanceof Date?Ws(z.v):z.v)),m.cellNF||delete z.z}else z.t="s",z.v=O;if(z.t=="z"||(m.dense?(x[E]||(x[E]=[]),x[E][T]=z):x[Qn({c:T,r:E})]=z),A=M+1,R=h.charCodeAt(A),v.e.c<T&&(v.e.c=T),v.e.r<E&&(v.e.r=E),P==D)++T;else if(T=0,++E,m.sheetRows&&m.sheetRows<=E)return!0}e:for(;M<h.length;++M)switch(P=h.charCodeAt(M)){case 34:R===34&&(U=!U);break;case D:case 10:case 13:if(!U&&N())break e;break}return M-A>0&&N(),x["!ref"]=ri(v),x}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):gg(e(h,f),f)}function o(h,f){var m="",y=f.type=="string"?[0,0,0,0]:K2e(h,f);switch(f.type){case"base64":m=lc(h);break;case"binary":m=h;break;case"buffer":f.codepage==65001?m=h.toString("utf8"):f.codepage&&typeof Hv<"u"||(m=Nn&&Buffer.isBuffer(h)?h.toString("binary"):Y1(h));break;case"array":m=Rw(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+f.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=ip(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=ip(m):f.type=="binary"&&typeof Hv<"u",m.slice(0,19)=="socialcalc:version:"?nB.to_sheet(f.type=="string"?m:ip(m),f):a(m,f)}function l(h,f){return Ld(o(h,f),f)}function c(h){for(var f=[],m=gr(h["!ref"]),y,x=Array.isArray(h),v=m.s.r;v<=m.e.r;++v){for(var E=[],T=m.s.c;T<=m.e.c;++T){var b=Qn({r:v,c:T});if(y=x?(h[v]||[])[T]:h[b],!y||y.v==null){E.push("          ");continue}for(var A=(y.w||(cc(y),y.w)||"").slice(0,10);A.length<10;)A+=" ";E.push(A+(T===0?" ":""))}f.push(E.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),N5=(function(){function n(V,Q,ne){if(V){ia(V,V.l||0);for(var ie=ne.Enum||Se;V.l<V.length;){var me=V.read_shift(2),Ce=ie[me]||ie[65535],Fe=V.read_shift(2),fe=V.l+Fe,le=Ce.f&&Ce.f(V,Fe,ne);if(V.l=fe,Q(le,Ce,me))return}}}function e(V,Q){switch(Q.type){case"base64":return t(co(lc(V)),Q);case"binary":return t(co(V),Q);case"buffer":case"array":return t(V,Q)}throw"Unsupported type "+Q.type}function t(V,Q){if(!V)return V;var ne=Q||{},ie=ne.dense?[]:{},me="Sheet1",Ce="",Fe=0,fe={},le=[],yt=[],St={s:{r:0,c:0},e:{r:0,c:0}},ln=ne.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ne.Enum=Se,n(V,function(lt,nr,hn){switch(hn){case 0:ne.vers=lt,lt>=4096&&(ne.qpro=!0);break;case 6:St=lt;break;case 204:lt&&(Ce=lt);break;case 222:Ce=lt;break;case 15:case 51:ne.qpro||(lt[1].v=lt[1].v.slice(1));case 13:case 14:case 16:hn==14&&(lt[2]&112)==112&&(lt[2]&15)>1&&(lt[2]&15)<15&&(lt[1].z=ne.dateNF||Vr[14],ne.cellDates&&(lt[1].t="d",lt[1].v=xG(lt[1].v))),ne.qpro&&lt[3]>Fe&&(ie["!ref"]=ri(St),fe[me]=ie,le.push(me),ie=ne.dense?[]:{},St={s:{r:0,c:0},e:{r:0,c:0}},Fe=lt[3],me=Ce||"Sheet"+(Fe+1),Ce="");var rn=ne.dense?(ie[lt[0].r]||[])[lt[0].c]:ie[Qn(lt[0])];if(rn){rn.t=lt[1].t,rn.v=lt[1].v,lt[1].z!=null&&(rn.z=lt[1].z),lt[1].f!=null&&(rn.f=lt[1].f);break}ne.dense?(ie[lt[0].r]||(ie[lt[0].r]=[]),ie[lt[0].r][lt[0].c]=lt[1]):ie[Qn(lt[0])]=lt[1];break}},ne);else if(V[2]==26||V[2]==14)ne.Enum=se,V[2]==14&&(ne.qpro=!0,V.l=0),n(V,function(lt,nr,hn){switch(hn){case 204:me=lt;break;case 22:lt[1].v=lt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(lt[3]>Fe&&(ie["!ref"]=ri(St),fe[me]=ie,le.push(me),ie=ne.dense?[]:{},St={s:{r:0,c:0},e:{r:0,c:0}},Fe=lt[3],me="Sheet"+(Fe+1)),ln>0&&lt[0].r>=ln)break;ne.dense?(ie[lt[0].r]||(ie[lt[0].r]=[]),ie[lt[0].r][lt[0].c]=lt[1]):ie[Qn(lt[0])]=lt[1],St.e.c<lt[0].c&&(St.e.c=lt[0].c),St.e.r<lt[0].r&&(St.e.r=lt[0].r);break;case 27:lt[14e3]&&(yt[lt[14e3][0]]=lt[14e3][1]);break;case 1537:yt[lt[0]]=lt[1],lt[0]==Fe&&(me=lt[1]);break}},ne);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(ie["!ref"]=ri(St),fe[Ce||me]=ie,le.push(Ce||me),!yt.length)return{SheetNames:le,Sheets:fe};for(var kt={},Dn=[],tn=0;tn<yt.length;++tn)fe[le[tn]]?(Dn.push(yt[tn]||le[tn]),kt[yt[tn]]=fe[yt[tn]]||fe[le[tn]]):(Dn.push(yt[tn]),kt[yt[tn]]={"!ref":"A1"});return{SheetNames:Dn,Sheets:kt}}function r(V,Q){var ne=Q||{};if(+ne.codepage>=0&&Zp(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK1 to JS string");var ie=Gs(),me=gr(V["!ref"]),Ce=Array.isArray(V),Fe=[];rt(ie,0,s(1030)),rt(ie,6,l(me));for(var fe=Math.min(me.e.r,8191),le=me.s.r;le<=fe;++le)for(var yt=Wi(le),St=me.s.c;St<=me.e.c;++St){le===me.s.r&&(Fe[St]=hs(St));var ln=Fe[St]+yt,kt=Ce?(V[le]||[])[St]:V[ln];if(!(!kt||kt.t=="z"))if(kt.t=="n")(kt.v|0)==kt.v&&kt.v>=-32768&&kt.v<=32767?rt(ie,13,y(le,St,kt.v)):rt(ie,14,v(le,St,kt.v));else{var Dn=cc(kt);rt(ie,15,f(le,St,Dn.slice(0,239)))}}return rt(ie,1),ie.end()}function i(V,Q){var ne=Q||{};if(+ne.codepage>=0&&Zp(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK3 to JS string");var ie=Gs();rt(ie,0,a(V));for(var me=0,Ce=0;me<V.SheetNames.length;++me)(V.Sheets[V.SheetNames[me]]||{})["!ref"]&&rt(ie,27,we(V.SheetNames[me],Ce++));var Fe=0;for(me=0;me<V.SheetNames.length;++me){var fe=V.Sheets[V.SheetNames[me]];if(!(!fe||!fe["!ref"])){for(var le=gr(fe["!ref"]),yt=Array.isArray(fe),St=[],ln=Math.min(le.e.r,8191),kt=le.s.r;kt<=ln;++kt)for(var Dn=Wi(kt),tn=le.s.c;tn<=le.e.c;++tn){kt===le.s.r&&(St[tn]=hs(tn));var lt=St[tn]+Dn,nr=yt?(fe[kt]||[])[tn]:fe[lt];if(!(!nr||nr.t=="z"))if(nr.t=="n")rt(ie,23,N(kt,tn,Fe,nr.v));else{var hn=cc(nr);rt(ie,22,P(kt,tn,Fe,hn.slice(0,239)))}}++Fe}}return rt(ie,1),ie.end()}function s(V){var Q=Me(2);return Q.write_shift(2,V),Q}function a(V){var Q=Me(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var ne=0,ie=0,me=0,Ce=0;Ce<V.SheetNames.length;++Ce){var Fe=V.SheetNames[Ce],fe=V.Sheets[Fe];if(!(!fe||!fe["!ref"])){++me;var le=ma(fe["!ref"]);ne<le.e.r&&(ne=le.e.r),ie<le.e.c&&(ie=le.e.c)}}return ne>8191&&(ne=8191),Q.write_shift(2,ne),Q.write_shift(1,me),Q.write_shift(1,ie),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function o(V,Q,ne){var ie={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&ne.qpro?(ie.s.c=V.read_shift(1),V.l++,ie.s.r=V.read_shift(2),ie.e.c=V.read_shift(1),V.l++,ie.e.r=V.read_shift(2),ie):(ie.s.c=V.read_shift(2),ie.s.r=V.read_shift(2),Q==12&&ne.qpro&&(V.l+=2),ie.e.c=V.read_shift(2),ie.e.r=V.read_shift(2),Q==12&&ne.qpro&&(V.l+=2),ie.s.c==65535&&(ie.s.c=ie.e.c=ie.s.r=ie.e.r=0),ie)}function l(V){var Q=Me(8);return Q.write_shift(2,V.s.c),Q.write_shift(2,V.s.r),Q.write_shift(2,V.e.c),Q.write_shift(2,V.e.r),Q}function c(V,Q,ne){var ie=[{c:0,r:0},{t:"n",v:0},0,0];return ne.qpro&&ne.vers!=20768?(ie[0].c=V.read_shift(1),ie[3]=V.read_shift(1),ie[0].r=V.read_shift(2),V.l+=2):(ie[2]=V.read_shift(1),ie[0].c=V.read_shift(2),ie[0].r=V.read_shift(2)),ie}function h(V,Q,ne){var ie=V.l+Q,me=c(V,Q,ne);if(me[1].t="s",ne.vers==20768){V.l++;var Ce=V.read_shift(1);return me[1].v=V.read_shift(Ce,"utf8"),me}return ne.qpro&&V.l++,me[1].v=V.read_shift(ie-V.l,"cstr"),me}function f(V,Q,ne){var ie=Me(7+ne.length);ie.write_shift(1,255),ie.write_shift(2,Q),ie.write_shift(2,V),ie.write_shift(1,39);for(var me=0;me<ie.length;++me){var Ce=ne.charCodeAt(me);ie.write_shift(1,Ce>=128?95:Ce)}return ie.write_shift(1,0),ie}function m(V,Q,ne){var ie=c(V,Q,ne);return ie[1].v=V.read_shift(2,"i"),ie}function y(V,Q,ne){var ie=Me(7);return ie.write_shift(1,255),ie.write_shift(2,Q),ie.write_shift(2,V),ie.write_shift(2,ne,"i"),ie}function x(V,Q,ne){var ie=c(V,Q,ne);return ie[1].v=V.read_shift(8,"f"),ie}function v(V,Q,ne){var ie=Me(13);return ie.write_shift(1,255),ie.write_shift(2,Q),ie.write_shift(2,V),ie.write_shift(8,ne,"f"),ie}function E(V,Q,ne){var ie=V.l+Q,me=c(V,Q,ne);if(me[1].v=V.read_shift(8,"f"),ne.qpro)V.l=ie;else{var Ce=V.read_shift(2);M(V.slice(V.l,V.l+Ce),me),V.l+=Ce}return me}function T(V,Q,ne){var ie=Q&32768;return Q&=-32769,Q=(ie?V:0)+(Q>=8192?Q-16384:Q),(ie?"":"$")+(ne?hs(Q):Wi(Q))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(V,Q){ia(V,0);for(var ne=[],ie=0,me="",Ce="",Fe="",fe="";V.l<V.length;){var le=V[V.l++];switch(le){case 0:ne.push(V.read_shift(8,"f"));break;case 1:Ce=T(Q[0].c,V.read_shift(2),!0),me=T(Q[0].r,V.read_shift(2),!1),ne.push(Ce+me);break;case 2:{var yt=T(Q[0].c,V.read_shift(2),!0),St=T(Q[0].r,V.read_shift(2),!1);Ce=T(Q[0].c,V.read_shift(2),!0),me=T(Q[0].r,V.read_shift(2),!1),ne.push(yt+St+":"+Ce+me)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ne.push("("+ne.pop()+")");break;case 5:ne.push(V.read_shift(2));break;case 6:{for(var ln="";le=V[V.l++];)ln+=String.fromCharCode(le);ne.push('"'+ln.replace(/"/g,'""')+'"')}break;case 8:ne.push("-"+ne.pop());break;case 23:ne.push("+"+ne.pop());break;case 22:ne.push("NOT("+ne.pop()+")");break;case 20:case 21:fe=ne.pop(),Fe=ne.pop(),ne.push(["AND","OR"][le-20]+"("+Fe+","+fe+")");break;default:if(le<32&&A[le])fe=ne.pop(),Fe=ne.pop(),ne.push(Fe+A[le]+fe);else if(b[le]){if(ie=b[le][1],ie==69&&(ie=V[V.l++]),ie>ne.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+ne.join("|")+"|");return}var kt=ne.slice(-ie);ne.length-=ie,ne.push(b[le][0]+"("+kt.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}ne.length==1?Q[1].f=""+ne[0]:console.error("WK1 bad formula parse |"+ne.join("|")+"|")}function D(V){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=V.read_shift(2),Q[3]=V[V.l++],Q[0].c=V[V.l++],Q}function U(V,Q){var ne=D(V);return ne[1].t="s",ne[1].v=V.read_shift(Q-4,"cstr"),ne}function P(V,Q,ne,ie){var me=Me(6+ie.length);me.write_shift(2,V),me.write_shift(1,ne),me.write_shift(1,Q),me.write_shift(1,39);for(var Ce=0;Ce<ie.length;++Ce){var Fe=ie.charCodeAt(Ce);me.write_shift(1,Fe>=128?95:Fe)}return me.write_shift(1,0),me}function R(V,Q){var ne=D(V);ne[1].v=V.read_shift(2);var ie=ne[1].v>>1;if(ne[1].v&1)switch(ie&7){case 0:ie=(ie>>3)*5e3;break;case 1:ie=(ie>>3)*500;break;case 2:ie=(ie>>3)/20;break;case 3:ie=(ie>>3)/200;break;case 4:ie=(ie>>3)/2e3;break;case 5:ie=(ie>>3)/2e4;break;case 6:ie=(ie>>3)/16;break;case 7:ie=(ie>>3)/64;break}return ne[1].v=ie,ne}function k(V,Q){var ne=D(V),ie=V.read_shift(4),me=V.read_shift(4),Ce=V.read_shift(2);if(Ce==65535)return ie===0&&me===3221225472?(ne[1].t="e",ne[1].v=15):ie===0&&me===3489660928?(ne[1].t="e",ne[1].v=42):ne[1].v=0,ne;var Fe=Ce&32768;return Ce=(Ce&32767)-16446,ne[1].v=(1-Fe*2)*(me*Math.pow(2,Ce+32)+ie*Math.pow(2,Ce)),ne}function N(V,Q,ne,ie){var me=Me(14);if(me.write_shift(2,V),me.write_shift(1,ne),me.write_shift(1,Q),ie==0)return me.write_shift(4,0),me.write_shift(4,0),me.write_shift(2,65535),me;var Ce=0,Fe=0,fe=0,le=0;return ie<0&&(Ce=1,ie=-ie),Fe=Math.log2(ie)|0,ie/=Math.pow(2,Fe-31),le=ie>>>0,(le&2147483648)==0&&(ie/=2,++Fe,le=ie>>>0),ie-=le,le|=2147483648,le>>>=0,ie*=Math.pow(2,32),fe=ie>>>0,me.write_shift(4,fe),me.write_shift(4,le),Fe+=16383+(Ce?32768:0),me.write_shift(2,Fe),me}function O(V,Q){var ne=k(V);return V.l+=Q-14,ne}function z(V,Q){var ne=D(V),ie=V.read_shift(4);return ne[1].v=ie>>6,ne}function j(V,Q){var ne=D(V),ie=V.read_shift(8,"f");return ne[1].v=ie,ne}function Re(V,Q){var ne=j(V);return V.l+=Q-10,ne}function Ne(V,Q){return V[V.l+Q-1]==0?V.read_shift(Q,"cstr"):""}function Ve(V,Q){var ne=V[V.l++];ne>Q-1&&(ne=Q-1);for(var ie="";ie.length<ne;)ie+=String.fromCharCode(V[V.l++]);return ie}function Oe(V,Q,ne){if(!(!ne.qpro||Q<21)){var ie=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var me=V.read_shift(Q-21,"cstr");return[ie,me]}}function ce(V,Q){for(var ne={},ie=V.l+Q;V.l<ie;){var me=V.read_shift(2);if(me==14e3){for(ne[me]=[0,""],ne[me][0]=V.read_shift(2);V[V.l];)ne[me][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ne}function we(V,Q){var ne=Me(5+V.length);ne.write_shift(2,14e3),ne.write_shift(2,Q);for(var ie=0;ie<V.length;++ie){var me=V.charCodeAt(ie);ne[ne.l++]=me>127?95:me}return ne[ne.l++]=0,ne}var Se={0:{n:"BOF",f:ZG},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ne},222:{n:"SHEETNAMELP",f:Ve},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),D_e=/^\s|\s$|[\t\n\r]/;function rB(n,e){if(!e.bookSST)return"";var t=[ai];t[t.length]=nt("sst",null,{xmlns:fg[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(D_e)&&(s+=' xml:space="preserve"'),s+=">"+Yn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function F_e(n){return[n.read_shift(4),n.read_shift(4)]}function j_e(n,e){return e||(e=Me(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var V_e=Cye;function G_e(n){var e=Gs();Ue(e,159,j_e(n));for(var t=0;t<n.length;++t)Ue(e,19,V_e(n[t]));return Ue(e,160),e.end()}function B_e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function iB(n){var e=0,t,r=B_e(n),i=r.length+1,s,a,o,l,c;for(t=_d(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var U_e=(function(){function n(i,s){switch(s.type){case"base64":return e(lc(i),s);case"binary":return e(i,s);case"buffer":return e(Nn&&Buffer.isBuffer(i)?i.toString("binary"):Y1(i),s);case"array":return e(Rw(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var m=/\\\w+\b/g,y=0,x,v=-1;x=m.exec(h);){switch(x[0]){case"\\cell":var E=h.slice(y,m.lastIndex-x[0].length);if(E[0]==" "&&(E=E.slice(1)),++v,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[f][v]=T:o[Qn({r:f,c:v})]=T}break}y=m.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=ri(c),o}function t(i,s){return Ld(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=gr(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Qn({r:c,c:h});o=l?(i[c]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(cc(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function L5(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var z_e=6,ec=z_e;function tE(n){return Math.floor((n+Math.round(128/ec)/256)*ec)}function nE(n){return Math.floor((n-5)/ec*100+.5)/100}function OA(n){return Math.round((n*ec+5)/ec*256)/256}function hP(n){n.width?(n.wpx=tE(n.width),n.wch=nE(n.wpx),n.MDW=ec):n.wpx?(n.wch=nE(n.wpx),n.width=OA(n.wch),n.MDW=ec):typeof n.wch=="number"&&(n.width=OA(n.wch),n.wpx=tE(n.width),n.MDW=ec),n.customWidth&&delete n.customWidth}var $_e=96,sB=$_e;function rE(n){return n*96/sB}function aB(n){return n*sB/96}function W_e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=nt("numFmt",null,{numFmtId:r,formatCode:Yn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=nt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function H_e(n){var e=[];return e[e.length]=nt("cellXfs",null),n.forEach(function(t){e[e.length]=nt("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=nt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function oB(n,e){var t=[ai,nt("styleSheet",null,{xmlns:fg[0],"xmlns:vt":Ri.vt})],r;return n.SSF&&(r=W_e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=H_e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function K_e(n,e){var t=n.read_shift(2),r=ds(n);return[t,r]}function X_e(n,e,t){t||(t=Me(6+4*e.length)),t.write_shift(2,n),Pi(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function q_e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=Dye(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=Oye(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ds(n),r}function Y_e(n,e){e||(e=Me(153)),e.write_shift(2,n.sz*20),Fye(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Jv(n.color,e);var r=0;return r=2,e.write_shift(1,r),Pi(n.name,e),e.length>e.l?e.slice(0,e.l):e}var Z_e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],PT,Q_e=fl;function O5(n,e){e||(e=Me(84)),PT||(PT=JC(Z_e));var t=PT[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(Jv({auto:1},e),Jv({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function J_e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function lB(n,e,t){t||(t=Me(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function gm(n,e){return e||(e=Me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var exe=fl;function txe(n,e){return e||(e=Me(51)),e.write_shift(1,0),gm(null,e),gm(null,e),gm(null,e),gm(null,e),gm(null,e),e.length>e.l?e.slice(0,e.l):e}function nxe(n,e){return e||(e=Me(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Qv(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function rxe(n,e,t){var r=Me(2052);return r.write_shift(4,n),Qv(e,r),Qv(t,r),r.length>r.l?r.slice(0,r.l):r}function ixe(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ue(n,615,xo(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ue(n,44,X_e(i,e[i]))}),Ue(n,616))}}function sxe(n){var e=1;Ue(n,611,xo(e)),Ue(n,43,Y_e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ue(n,612)}function axe(n){var e=2;Ue(n,603,xo(e)),Ue(n,45,O5({patternType:"none"})),Ue(n,45,O5({patternType:"gray125"})),Ue(n,604)}function oxe(n){var e=1;Ue(n,613,xo(e)),Ue(n,46,txe()),Ue(n,614)}function lxe(n){var e=1;Ue(n,626,xo(e)),Ue(n,47,lB({numFmtId:0},65535)),Ue(n,627)}function cxe(n,e){Ue(n,617,xo(e.length)),e.forEach(function(t){Ue(n,47,lB(t,0))}),Ue(n,618)}function uxe(n){var e=1;Ue(n,619,xo(e)),Ue(n,48,nxe({xfId:0,name:"Normal"})),Ue(n,620)}function hxe(n){var e=0;Ue(n,505,xo(e)),Ue(n,506)}function dxe(n){var e=0;Ue(n,508,rxe(e,"TableStyleMedium9","PivotStyleMedium4")),Ue(n,509)}function fxe(n,e){var t=Gs();return Ue(t,278),ixe(t,n.SSF),sxe(t),axe(t),oxe(t),lxe(t),cxe(t,e.cellXfs),uxe(t),hxe(t),dxe(t),Ue(t,279),t.end()}function cB(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[ai];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function gxe(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:ds(n)}}function mxe(n){var e=Me(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),Pi(n.name,e),e.slice(0,e.l)}function pxe(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function yxe(n){var e=Me(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function _xe(n,e){var t=Me(8+2*e.length);return t.write_shift(4,n),Pi(e,t),t.slice(0,t.l)}function xxe(n){return n.l+=4,n.read_shift(4)!=0}function vxe(n,e){var t=Me(8);return t.write_shift(4,n),t.write_shift(4,1),t}function Exe(){var n=Gs();return Ue(n,332),Ue(n,334,xo(1)),Ue(n,335,mxe({name:"XLDAPR",version:12e4,flags:3496657072})),Ue(n,336),Ue(n,339,_xe(1,"XLDAPR")),Ue(n,52),Ue(n,35,xo(514)),Ue(n,4096,xo(0)),Ue(n,4097,Pa(1)),Ue(n,36),Ue(n,53),Ue(n,340),Ue(n,337,vxe(1)),Ue(n,51,yxe([[1,0]])),Ue(n,338),Ue(n,333),n.end()}function uB(){var n=[ai];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function wxe(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Qn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var a0=1024;function hB(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[nt("xml",null,{"xmlns:v":aa.v,"xmlns:o":aa.o,"xmlns:x":aa.x,"xmlns:mv":aa.mv}).replace(/\/>/,">"),nt("o:shapelayout",nt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),nt("v:shapetype",[nt("v:stroke",null,{joinstyle:"miter"}),nt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];a0<n*1e3;)a0+=1e3;return e.forEach(function(s){var a=Ci(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?nt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=nt("v:fill",l,o),h={on:"t",obscured:"t"};++a0,i=i.concat(["<v:shape"+t1({id:"_x0000_s"+a0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,nt("v:shadow",null,h),nt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",$i("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),$i("x:AutoFill","False"),$i("x:Row",String(a.r)),$i("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function dB(n){var e=[ai,nt("comments",null,{xmlns:fg[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Yn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Yn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push($i("t",Yn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push($i("t",Yn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Sxe(n,e,t){var r=[ai,nt("ThreadedComments",null,{xmlns:Ri.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(nt("threadedComment",$i("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function Txe(n){var e=[ai,nt("personList",null,{xmlns:Ri.TCMNT,"xmlns:x":fg[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(nt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function bxe(n){var e={};e.iauthor=n.read_shift(4);var t=jd(n);return e.rfx=t.s,e.ref=Qn(t.s),n.l+=16,e}function Axe(n,e){return e==null&&(e=Me(36)),e.write_shift(4,n[1].iauthor),mg(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Rxe=ds;function Ixe(n){return Pi(n.slice(0,54))}function Cxe(n){var e=Gs(),t=[];return Ue(e,628),Ue(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ue(e,632,Ixe(i.a)))})}),Ue(e,631),Ue(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Ci(r[0]),e:Ci(r[0])};Ue(e,635,Axe([s,i])),i.t&&i.t.length>0&&Ue(e,637,kye(i)),Ue(e,636),delete i.iauthor})}),Ue(e,634),Ue(e,629),e.end()}function Pxe(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Jn.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var fB=["xlsb","xlsm","xlam","biff8","xla"],kxe=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,i+(o?"":"$")+hs(h)+(l?"":"$")+Wi(c)}return function(i,s){return e=s,i.replace(n,t)}})(),dP=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fP=(function(){return function(e,t){return e.replace(dP,function(r,i,s,a,o,l){var c=aP(a)-(s?0:t.c),h=sP(l)-(o?0:t.r),f=h==0?"":o?h+1:"["+h+"]",m=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+m})}})();function Mxe(n,e){return n.replace(dP,function(t,r,i,s,a,o){return r+(i=="$"?i+s:hs(aP(s)+e.c))+(a=="$"?a+o:Wi(sP(o)+e.r))})}function Nxe(n){return n.length!=1}function Yr(n){n.l+=1}function ju(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function gB(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return mB(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=ju(n),o=ju(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function mB(n){var e=ju(n),t=ju(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Lxe(n,e,t){if(t.biff<8)return mB(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=ju(n),a=ju(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function pB(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return Oxe(n);var r=n.read_shift(t&&t.biff==12?4:2),i=ju(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function Oxe(n){var e=ju(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Dxe(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Fxe(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return jxe(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function jxe(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function Vxe(n,e,t){var r=(n[n.l++]&96)>>5,i=gB(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function Gxe(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=gB(n,s,t);return[r,i,a]}function Bxe(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function Uxe(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function zxe(n,e,t){var r=(n[n.l++]&96)>>5,i=Lxe(n,e-1,t);return[r,i]}function $xe(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function D5(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function Wxe(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function Hxe(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Kxe(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Xxe(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function qxe(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function yB(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function Yxe(n){return n.read_shift(2),yB(n)}function Zxe(n){return n.read_shift(2),yB(n)}function Qxe(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=pB(n,0,t);return[r,i]}function Jxe(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=Fxe(n,0,t);return[r,i]}function eve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=pB(n,0,t);return[r,i,s]}function tve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[tEe[i],vB[i],r]}function nve(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:rve(n);return[i,(s[0]===0?vB:eEe)[s[1]]]}function rve(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function ive(n,e,t){n.l+=t&&t.biff==2?3:4}function sve(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function ave(n){return n.l++,J1[n.read_shift(1)]}function ove(n){return n.l++,n.read_shift(2)}function lve(n){return n.l++,n.read_shift(1)!==0}function cve(n){return n.l++,pg(n)}function uve(n,e,t){return n.l++,JG(n,e-1,t)}function hve(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=e_e(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=J1[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=pg(n);break;case 2:t[1]=i_e(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function dve(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?jd:o_e)(n));return i}function fve(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=hve(n,t.biff);return a}function gve(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function mve(n,e,t){if(t.biff==5)return pve(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function pve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function yve(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function _ve(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function xve(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function vve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var Eve=fl,wve=fl,Sve=fl;function ey(n,e,t){return n.l+=2,[Dxe(n)]}function gP(n){return n.l+=6,[]}var Tve=ey,bve=gP,Ave=gP,Rve=ey;function _B(n){return n.l+=2,[ZG(n),n.read_shift(2)&1]}var Ive=ey,Cve=_B,Pve=gP,kve=ey,Mve=ey,Nve=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Lve(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=Nve[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function Ove(n){return n.l+=2,[n.read_shift(4)]}function Dve(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function Fve(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function jve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Vve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Gve(n){return n.l+=4,[0,0]}var F5={1:{n:"PtgExp",f:sve},2:{n:"PtgTbl",f:Sve},3:{n:"PtgAdd",f:Yr},4:{n:"PtgSub",f:Yr},5:{n:"PtgMul",f:Yr},6:{n:"PtgDiv",f:Yr},7:{n:"PtgPower",f:Yr},8:{n:"PtgConcat",f:Yr},9:{n:"PtgLt",f:Yr},10:{n:"PtgLe",f:Yr},11:{n:"PtgEq",f:Yr},12:{n:"PtgGe",f:Yr},13:{n:"PtgGt",f:Yr},14:{n:"PtgNe",f:Yr},15:{n:"PtgIsect",f:Yr},16:{n:"PtgUnion",f:Yr},17:{n:"PtgRange",f:Yr},18:{n:"PtgUplus",f:Yr},19:{n:"PtgUminus",f:Yr},20:{n:"PtgPercent",f:Yr},21:{n:"PtgParen",f:Yr},22:{n:"PtgMissArg",f:Yr},23:{n:"PtgStr",f:uve},26:{n:"PtgSheet",f:Dve},27:{n:"PtgEndSheet",f:Fve},28:{n:"PtgErr",f:ave},29:{n:"PtgBool",f:lve},30:{n:"PtgInt",f:ove},31:{n:"PtgNum",f:cve},32:{n:"PtgArray",f:$xe},33:{n:"PtgFunc",f:tve},34:{n:"PtgFuncVar",f:nve},35:{n:"PtgName",f:gve},36:{n:"PtgRef",f:Qxe},37:{n:"PtgArea",f:Vxe},38:{n:"PtgMemArea",f:yve},39:{n:"PtgMemErr",f:Eve},40:{n:"PtgMemNoMem",f:wve},41:{n:"PtgMemFunc",f:_ve},42:{n:"PtgRefErr",f:xve},43:{n:"PtgAreaErr",f:Bxe},44:{n:"PtgRefN",f:Jxe},45:{n:"PtgAreaN",f:zxe},46:{n:"PtgMemAreaN",f:jve},47:{n:"PtgMemNoMemN",f:Vve},57:{n:"PtgNameX",f:mve},58:{n:"PtgRef3d",f:eve},59:{n:"PtgArea3d",f:Gxe},60:{n:"PtgRefErr3d",f:vve},61:{n:"PtgAreaErr3d",f:Uxe},255:{}},Bve={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Uve={1:{n:"PtgElfLel",f:_B},2:{n:"PtgElfRw",f:kve},3:{n:"PtgElfCol",f:Tve},6:{n:"PtgElfRwV",f:Mve},7:{n:"PtgElfColV",f:Rve},10:{n:"PtgElfRadical",f:Ive},11:{n:"PtgElfRadicalS",f:Pve},13:{n:"PtgElfColS",f:bve},15:{n:"PtgElfColSV",f:Ave},16:{n:"PtgElfRadicalLel",f:Cve},25:{n:"PtgList",f:Lve},29:{n:"PtgSxName",f:Ove},255:{}},zve={0:{n:"PtgAttrNoop",f:Gve},1:{n:"PtgAttrSemi",f:qxe},2:{n:"PtgAttrIf",f:Kxe},4:{n:"PtgAttrChoose",f:Wxe},8:{n:"PtgAttrGoto",f:Hxe},16:{n:"PtgAttrSum",f:ive},32:{n:"PtgAttrBaxcel",f:D5},33:{n:"PtgAttrBaxcel",f:D5},64:{n:"PtgAttrSpace",f:Yxe},65:{n:"PtgAttrSpaceSemi",f:Zxe},128:{n:"PtgAttrIfError",f:Xxe},255:{}};function $ve(n,e,t,r){if(r.biff<8)return fl(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=fve(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=dve(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(fl(n,e)),s}function Wve(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=F5[s]||F5[Bve[s]],(s===24||s===25)&&(i=(s===24?Uve:zve)[n[n.l+1]]),!i||!i.f?fl(n,e):a.push([i.n,i.f(n,e,t)]);return a}function Hve(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Kve={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Xve(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function xB(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function j5(n,e,t){var r=xB(n,e,t);return r=="#REF"?r:Xve(r,t)}function J0(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,h,f=0,m=0,y,x="";if(!n[0]||!n[0][0])return"";for(var v=-1,E="",T=0,b=n[0].length;T<b;++T){var A=n[0][T];switch(A[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(n[0][v][1][0]){case 0:E=Fr(" ",n[0][v][1][1]);break;case 1:E=Fr("\r",n[0][v][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][v][1][0])}c=c+E,v=-1}o.push(c+Kve[A[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=ap(A[1][1],a,i),o.push(op(h,s));break;case"PtgRefN":h=t?ap(A[1][1],t,i):A[1][1],o.push(op(h,s));break;case"PtgRef3d":f=A[1][1],h=ap(A[1][2],a,i),x=j5(r,f,i),o.push(x+"!"+op(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=A[1][0],D=A[1][1];M||(M=0),M&=127;var U=M==0?[]:o.slice(-M);o.length-=M,D==="User"&&(D=U.shift()),o.push(D+"("+U.join(",")+")");break;case"PtgBool":o.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(A[1]);break;case"PtgNum":o.push(String(A[1]));break;case"PtgStr":o.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(A[1]);break;case"PtgAreaN":y=w5(A[1][1],t?{s:t}:a,i),o.push(IT(y,i));break;case"PtgArea":y=w5(A[1][1],a,i),o.push(IT(y,i));break;case"PtgArea3d":f=A[1][1],y=A[1][2],x=j5(r,f,i),o.push(x+"!"+IT(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=A[1][2];var P=(r.names||[])[m-1]||(r[0]||[])[m],R=P?P.Name:"SH33TJSNAME"+String(m);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var k=A[1][1];m=A[1][2];var N;if(i.biff<=5)k<0&&(k=-k),r[k]&&(N=r[k][m]);else{var O="";if(((r[k]||[])[0]||[])[0]==14849||(((r[k]||[])[0]||[])[0]==1025?r[k][m]&&r[k][m].itab>0&&(O=r.SheetNames[r[k][m].itab-1]+"!"):O=r.SheetNames[m-1]+"!"),r[k]&&r[k][m])O+=r[k][m].Name;else if(r[0]&&r[0][m])O+=r[0][m].Name;else{var z=(xB(r,k,i)||"").split(";;");z[m-1]?O=z[m-1]:O+="SH33TJSERRX"}o.push(O);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var j="(",Re=")";if(v>=0){switch(E="",n[0][v][1][0]){case 2:j=Fr(" ",n[0][v][1][1])+j;break;case 3:j=Fr("\r",n[0][v][1][1])+j;break;case 4:Re=Fr(" ",n[0][v][1][1])+Re;break;case 5:Re=Fr("\r",n[0][v][1][1])+Re;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][v][1][0])}v=-1}o.push(j+o.pop()+Re);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:A[1][1],r:A[1][0]};var Ne={c:t.c,r:t.r};if(r.sharedf[Qn(h)]){var Ve=r.sharedf[Qn(h)];o.push(J0(Ve,a,Ne,r,i))}else{var Oe=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(J0(c[1],a,Ne,r,i)),Oe=!0;break}Oe||o.push(A[1])}break;case"PtgArray":o.push("{"+Hve(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&ce.indexOf(n[0][T][0])==-1){A=n[0][v];var we=!0;switch(A[1][0]){case 4:we=!1;case 0:E=Fr(" ",A[1][1]);break;case 5:we=!1;case 1:E=Fr("\r",A[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}o.push((we?E:"")+o.pop()+(we?"":E)),v=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function qve(n){if(n==null){var e=Me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return xd(n);return xd(0)}function Yve(n,e,t,r,i){var s=vd(e,t,i),a=qve(n.v),o=Me(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Me(n.bf.length),h=0;h<n.bf.length;++h)c[h]=n.bf[h];var f=zi([s,a,o,c]);return f}function Iw(n,e,t){var r=n.read_shift(4),i=Wve(n,r,t),s=n.read_shift(4),a=s>0?$ve(n,s,i,t):null;return[i,a]}var Zve=Iw,Cw=Iw,Qve=Iw,Jve=Iw,eEe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vB={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},tEe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function nEe(n){var e="of:="+n.replace(dP,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function rEe(n){return n.replace(/\./,"!")}var lp=typeof Map<"u";function mP(n,e,t){var r=0,i=n.length;if(t){if(lp?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=lp?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(lp?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Pw(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(ec=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=nE(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=OA(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function EB(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Ku(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){pG(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function iEe(n,e,t){if(n&&n["!ref"]){var r=gr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function sEe(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+ri(n[t])+'"/>';return e+"</mergeCells>"}function aEe(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=e1(Yn(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),o=(o||"")+nt("outlinePr",null,c)}!s&&!o||(i[i.length]=nt("sheetPr",o,a))}var oEe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],lEe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function cEe(n){var e={sheet:1};return oEe.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),lEe.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=iB(n.password).toString(16).toUpperCase()),nt("sheetProtection",null,e)}function uEe(n){return EB(n),nt("pageMargins",null,n)}function hEe(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=nt("col",null,Pw(i,r)));return t[t.length]="</cols>",t.join("")}function dEe(n,e,t,r){var i=typeof n.ref=="string"?n.ref:ri(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=ma(i);a.s.r==a.e.r&&(a.e.r=ma(e["!ref"]).e.r,i=ri(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),nt("autoFilter",null,{ref:i})}function fEe(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),nt("sheetViews",nt("sheetView",null,i),{})}function gEe(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=J1[n.v];break;case"d":r&&r.cellDates?i=Ts(n.v,-1).toISOString():(n=Hs(n),n.t="n",i=""+(n.v=Ws(Ts(n.v)))),typeof n.z>"u"&&(n.z=Vr[14]);break;default:i=n.v;break}var o=$i("v",Yn(i)),l={r:e},c=Ku(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=$i("v",""+mP(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=nt("f",Yn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),nt("c",o,l)}function mEe(n,e,t,r){var i=[],s=[],a=gr(n["!ref"]),o="",l,c="",h=[],f=0,m=0,y=n["!rows"],x=Array.isArray(n),v={r:c},E,T=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=hs(m);for(f=a.s.r;f<=a.e.r;++f){for(s=[],c=Wi(f),m=a.s.c;m<=a.e.c;++m){l=h[m]+c;var b=x?(n[f]||[])[m]:n[l];b!==void 0&&(o=gEe(b,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[f])&&(v={r:c},y&&y[f]&&(E=y[f],E.hidden&&(v.hidden=1),T=-1,E.hpx?T=rE(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(v.ht=T,v.customHeight=1),E.level&&(v.outlineLevel=E.level)),i[i.length]=nt("row",s.join(""),v))}if(y)for(;f<y.length;++f)y&&y[f]&&(v={r:f+1},E=y[f],E.hidden&&(v.hidden=1),T=-1,E.hpx?T=rE(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(v.ht=T,v.customHeight=1),E.level&&(v.outlineLevel=E.level),i[i.length]=nt("row","",v));return i.join("")}function wB(n,e,t,r){var i=[ai,nt("worksheet",null,{xmlns:fg[0],"xmlns:r":Ri.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",h=gr(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=ri(h)}r||(r={}),l["!comments"]=[];var f=[];aEe(l,t,n,e,i),i[i.length]=nt("dimension",null,{ref:c}),i[i.length]=fEe(l,e,n,t),e.sheetFormat&&(i[i.length]=nt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=hEe(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=mEe(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=cEe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=dEe(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=sEe(l["!merges"]));var m=-1,y,x=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(y={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Hn(r,-1,Yn(v[1].Target).replace(/#.*$/,""),In.HLINK),y["r:id"]="rId"+x),(m=v[1].Target.indexOf("#"))>-1&&(y.location=Yn(v[1].Target.slice(m+1))),v[1].Tooltip&&(y.tooltip=Yn(v[1].Tooltip)),i[i.length]=nt("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=uEe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=$i("ignoredErrors",nt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(x=Hn(r,-1,"../drawings/drawing"+(n+1)+".xml",In.DRAW),i[i.length]=nt("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=f),l["!comments"].length>0&&(x=Hn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",In.VML),i[i.length]=nt("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function pEe(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function yEe(n,e,t){var r=Me(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=rE(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,m=-1,y=h<<10;y<h+1<<10;++y){c.c=y;var x=Array.isArray(t)?(t[c.r]||[])[c.c]:t[Qn(c)];x&&(f<0&&(f=y),m=y)}f<0||(++o,r.write_shift(4,f),r.write_shift(4,m))}var v=r.l;return r.l=l,r.write_shift(4,o),r.l=v,r.length>r.l?r.slice(0,r.l):r}function _Ee(n,e,t,r){var i=yEe(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ue(n,0,i)}var xEe=jd,vEe=mg;function EEe(){}function wEe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=Mye(n),t}function SEe(n,e,t){t==null&&(t=Me(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return Jv({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),FG(n,t),t.slice(0,t.l)}function TEe(n){var e=Wa(n);return[e]}function bEe(n,e,t){return t==null&&(t=Me(8)),Od(e,t)}function AEe(n){var e=Dd(n);return[e]}function REe(n,e,t){return t==null&&(t=Me(4)),Fd(e,t)}function IEe(n){var e=Wa(n),t=n.read_shift(1);return[e,t,"b"]}function CEe(n,e,t){return t==null&&(t=Me(9)),Od(e,t),t.write_shift(1,n.v?1:0),t}function PEe(n){var e=Dd(n),t=n.read_shift(1);return[e,t,"b"]}function kEe(n,e,t){return t==null&&(t=Me(5)),Fd(e,t),t.write_shift(1,n.v?1:0),t}function MEe(n){var e=Wa(n),t=n.read_shift(1);return[e,t,"e"]}function NEe(n,e,t){return t==null&&(t=Me(9)),Od(e,t),t.write_shift(1,n.v),t}function LEe(n){var e=Dd(n),t=n.read_shift(1);return[e,t,"e"]}function OEe(n,e,t){return t==null&&(t=Me(8)),Fd(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function DEe(n){var e=Wa(n),t=n.read_shift(4);return[e,t,"s"]}function FEe(n,e,t){return t==null&&(t=Me(12)),Od(e,t),t.write_shift(4,e.v),t}function jEe(n){var e=Dd(n),t=n.read_shift(4);return[e,t,"s"]}function VEe(n,e,t){return t==null&&(t=Me(8)),Fd(e,t),t.write_shift(4,e.v),t}function GEe(n){var e=Wa(n),t=pg(n);return[e,t,"n"]}function BEe(n,e,t){return t==null&&(t=Me(16)),Od(e,t),xd(n.v,t),t}function UEe(n){var e=Dd(n),t=pg(n);return[e,t,"n"]}function zEe(n,e,t){return t==null&&(t=Me(12)),Fd(e,t),xd(n.v,t),t}function $Ee(n){var e=Wa(n),t=jG(n);return[e,t,"n"]}function WEe(n,e,t){return t==null&&(t=Me(12)),Od(e,t),VG(n.v,t),t}function HEe(n){var e=Dd(n),t=jG(n);return[e,t,"n"]}function KEe(n,e,t){return t==null&&(t=Me(8)),Fd(e,t),VG(n.v,t),t}function XEe(n){var e=Wa(n),t=oP(n);return[e,t,"is"]}function qEe(n){var e=Wa(n),t=ds(n);return[e,t,"str"]}function YEe(n,e,t){return t==null&&(t=Me(12+4*n.v.length)),Od(e,t),Pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function ZEe(n){var e=Dd(n),t=ds(n);return[e,t,"str"]}function QEe(n,e,t){return t==null&&(t=Me(8+4*n.v.length)),Fd(e,t),Pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function JEe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=Cw(n,r-n.l,t);a[3]=J0(o,null,i,t.supbooks,t)}else n.l=r;return a}function ewe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=Cw(n,r-n.l,t);a[3]=J0(o,null,i,t.supbooks,t)}else n.l=r;return a}function twe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=pg(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=Cw(n,r-n.l,t);a[3]=J0(o,null,i,t.supbooks,t)}else n.l=r;return a}function nwe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=ds(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=Cw(n,r-n.l,t);a[3]=J0(o,null,i,t.supbooks,t)}else n.l=r;return a}var rwe=jd,iwe=mg;function swe(n,e){return e==null&&(e=Me(4)),e.write_shift(4,n),e}function awe(n,e){var t=n.l+e,r=jd(n),i=lP(n),s=ds(n),a=ds(n),o=ds(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function owe(n,e){var t=Me(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));mg({s:Ci(n[0]),e:Ci(n[0])},t),cP("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return Pi(i||"",t),Pi(n[1].Tooltip||"",t),Pi("",t),t.slice(0,t.l)}function lwe(){}function cwe(n,e,t){var r=n.l+e,i=GG(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=Zve(n,r-n.l,t);a[1]=o}else n.l=r;return a}function uwe(n,e,t){var r=n.l+e,i=jd(n),s=[i];if(t.cellFormula){var a=Jve(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function hwe(n,e,t){t==null&&(t=Me(18));var r=Pw(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var SB=["left","right","top","bottom","header","footer"];function dwe(n){var e={};return SB.forEach(function(t){e[t]=pg(n)}),e}function fwe(n,e){return e==null&&(e=Me(48)),EB(n),SB.forEach(function(t){xd(n[t],e)}),e}function gwe(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function mwe(n,e,t){t==null&&(t=Me(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function pwe(n){var e=Me(24);return e.write_shift(4,4),e.write_shift(4,1),mg(n,e),e}function ywe(n,e){return e==null&&(e=Me(66)),e.write_shift(2,n.password?iB(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function _we(){}function xwe(){}function vwe(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Hs(e),e.z=e.z||Vr[14],e.v=Ws(Ts(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Ku(i.cellXfs,e,i),e.l&&s["!links"].push([Qn(l),e.l]),e.c&&s["!comments"].push([Qn(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=mP(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ue(n,18,VEe(e,l)):Ue(n,7,FEe(e,l))):(l.t="str",a?Ue(n,17,QEe(e,l)):Ue(n,6,YEe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ue(n,13,KEe(e,l)):Ue(n,2,WEe(e,l)):a?Ue(n,16,zEe(e,l)):Ue(n,5,BEe(e,l)),!0;case"b":return l.t="b",a?Ue(n,15,kEe(e,l)):Ue(n,4,CEe(e,l)),!0;case"e":return l.t="e",a?Ue(n,14,OEe(e,l)):Ue(n,3,NEe(e,l)),!0}return a?Ue(n,12,REe(e,l)):Ue(n,1,bEe(e,l)),!0}function Ewe(n,e,t,r){var i=gr(e["!ref"]||"A1"),s,a="",o=[];Ue(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=c;++h){a=Wi(h),_Ee(n,e,i,h);var f=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(o[m]=hs(m)),s=o[m]+a;var y=l?(e[h]||[])[m]:e[s];if(!y){f=!1;continue}f=vwe(n,y,h,m,r,e,f)}}Ue(n,146)}function wwe(n,e){!e||!e["!merges"]||(Ue(n,177,swe(e["!merges"].length)),e["!merges"].forEach(function(t){Ue(n,176,iwe(t))}),Ue(n,178))}function Swe(n,e){!e||!e["!cols"]||(Ue(n,390),e["!cols"].forEach(function(t,r){t&&Ue(n,60,hwe(r,t))}),Ue(n,391))}function Twe(n,e){!e||!e["!ref"]||(Ue(n,648),Ue(n,649,pwe(gr(e["!ref"]))),Ue(n,650))}function bwe(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Hn(t,-1,r[1].Target.replace(/#.*$/,""),In.HLINK);Ue(n,494,owe(r,i))}}),delete e["!links"]}function Awe(n,e,t,r){if(e["!comments"].length>0){var i=Hn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",In.VML);Ue(n,551,cP("rId"+i)),e["!legacy"]=i}}function Rwe(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ri(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ma(s);o.s.r==o.e.r&&(o.e.r=ma(e["!ref"]).e.r,s=ri(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ue(n,161,mg(gr(s))),Ue(n,162)}}function Iwe(n,e,t){Ue(n,133),Ue(n,137,mwe(e,t)),Ue(n,138),Ue(n,134)}function Cwe(n,e){e["!protect"]&&Ue(n,535,ywe(e["!protect"]))}function Pwe(n,e,t,r){var i=Gs(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=gr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ue(i,129),(t.vbaraw||a["!outline"])&&Ue(i,147,SEe(o,a["!outline"])),Ue(i,148,vEe(l)),Iwe(i,a,t.Workbook),Swe(i,a),Ewe(i,a,n,e),Cwe(i,a),Rwe(i,a,t,n),wwe(i,a),bwe(i,a,r),a["!margins"]&&Ue(i,476,fwe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Twe(i,a),Awe(i,a,n,r),Ue(i,130),i.end()}function kwe(n,e){n.l+=10;var t=ds(n);return{name:t}}var Mwe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Nwe(n){return!n.Workbook||!n.Workbook.WBProps?"false":uye(n.Workbook.WBProps.date1904)?"true":"false"}var Lwe="][*?/\\".split("");function TB(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return Lwe.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function Owe(n,e,t){n.forEach(function(r,i){TB(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Dwe(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];Owe(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)iEe(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function bB(n){var e=[ai];e[e.length]=nt("workbook",null,{xmlns:fg[0],"xmlns:r":Ri.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(Mwe.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=nt("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Yn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=nt("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=nt("definedName",Yn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Fwe(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=LA(n),t.name=ds(n),t}function jwe(n,e){return e||(e=Me(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),cP(n.strRelID,e),Pi(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Vwe(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?ds(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function Gwe(n,e){e||(e=Me(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),FG(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Bwe(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=Nye(n),a=Qve(n,0,t),o=lP(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function Uwe(n,e){Ue(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ue(n,156,jwe(i))}Ue(n,144)}function zwe(n,e){e||(e=Me(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Pi("SheetJS",e),Pi(Wv.version,e),Pi(Wv.version,e),Pi("7262",e),e.length>e.l?e.slice(0,e.l):e}function $we(n,e){e||(e=Me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function Wwe(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ue(n,135),Ue(n,158,$we(i)),Ue(n,136))}}function Hwe(n,e){var t=Gs();return Ue(t,131),Ue(t,128,zwe()),Ue(t,153,Gwe(n.Workbook&&n.Workbook.WBProps||null)),Wwe(t,n),Uwe(t,n),Ue(t,132),t.end()}function Kwe(n,e,t){return(e.slice(-4)===".bin"?Hwe:bB)(n)}function Xwe(n,e,t,r,i){return(e.slice(-4)===".bin"?Pwe:wB)(n,t,r,i)}function qwe(n,e,t){return(e.slice(-4)===".bin"?fxe:oB)(n,t)}function Ywe(n,e,t){return(e.slice(-4)===".bin"?G_e:rB)(n,t)}function Zwe(n,e,t){return(e.slice(-4)===".bin"?Cxe:dB)(n)}function Qwe(n){return(n.slice(-4)===".bin"?Exe:uB)()}function Jwe(n,e){var t=[];return n.Props&&t.push(qye(n.Props,e)),n.Custprops&&t.push(Yye(n.Props,n.Custprops)),t.join("")}function e2e(){return""}function t2e(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(nt("NumberFormat",null,{"ss:Format":Yn(Vr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(nt("Style",s.join(""),a))}),nt("Styles",t.join(""))}function AB(n){return nt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+fP(n.Ref,{r:0,c:0})})}function n2e(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(AB(i)))}return nt("Names",t.join(""))}function r2e(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(AB(o)))}return s.join("")}function i2e(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(nt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(nt("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(nt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(nt("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push($i("ProtectContents","True")),n["!protect"].objects&&i.push($i("ProtectObjects","True")),n["!protect"].scenarios&&i.push($i("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push($i("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push($i("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":nt("WorksheetOptions",i.join(""),{xmlns:aa.x})}function s2e(n){return n.map(function(e){var t=cye(e.t||""),r=nt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return nt("Comment",r,{"ss:Author":e.a})}).join("")}function a2e(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Yn(fP(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=Ci(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Yn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Yn(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var f="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",m=String(n.v);break;case"b":f="Boolean",m=n.v?"1":"0";break;case"e":f="Error",m=J1[n.v];break;case"d":f="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Vr[14]);break;case"s":f="String",m=lye(n.v||"");break}var y=Ku(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var x=n.v!=null?m:"",v=n.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(n.c||[]).length>0&&(v+=s2e(n.c)),nt("Cell",v,o)}function o2e(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=aB(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function l2e(n,e,t,r){if(!n["!ref"])return"";var i=gr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(E,T){hP(E);var b=!!E.width,A=Pw(T,E),M={"ss:Index":T+1};b&&(M["ss:Width"]=tE(A.width)),E.hidden&&(M["ss:Hidden"]="1"),o.push(nt("Column",null,M))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var h=[o2e(c,(n["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>c)&&!(s[a].e.c<f)&&!(s[a].e.r<c)){(s[a].s.c!=f||s[a].s.r!=c)&&(m=!0);break}if(!m){var y={r:c,c:f},x=Qn(y),v=l?(n[c]||[])[f]:n[x];h.push(a2e(v,x,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function c2e(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?r2e(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?l2e(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(i2e(s,e,n,t)),r.join("")}function u2e(n,e){e||(e={}),n.SSF||(n.SSF=Hs(Vr)),n.SSF&&(bw(),Tw(n.SSF),e.revssf=Aw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Ku(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Jwe(n,e)),t.push(e2e()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(nt("Worksheet",c2e(r,e,n),{"ss:Name":Yn(n.SheetNames[r])}));return t[2]=t2e(n,e),t[3]=n2e(n),ai+nt("Workbook",t.join(""),{xmlns:aa.ss,"xmlns:o":aa.o,"xmlns:x":aa.x,"xmlns:ss":aa.ss,"xmlns:dt":aa.dt,"xmlns:html":aa.html})}var kT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function h2e(n,e){var t=[],r=[],i=[],s=0,a,o=h5(T5,"n"),l=h5(b5,"n");if(n.Props)for(a=Hi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Hi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)YG.indexOf(i[s][0])>-1||KG.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&Jn.utils.cfb_add(e,"/SummaryInformation",P5(r,kT.SI,l,b5)),(t.length||c.length)&&Jn.utils.cfb_add(e,"/DocumentSummaryInformation",P5(t,kT.DSI,o,T5,c.length?c:null,kT.UDI))}function d2e(n,e){var t=e||{},r=Jn.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Jn.utils.cfb_add(r,i,RB(n,t)),t.biff==8&&(n.Props||n.Custprops)&&h2e(n,r),t.biff==8&&n.vbaraw&&Pxe(r,Jn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var f2e={0:{f:pEe},1:{f:TEe},2:{f:$Ee},3:{f:MEe},4:{f:IEe},5:{f:GEe},6:{f:qEe},7:{f:DEe},8:{f:nwe},9:{f:twe},10:{f:JEe},11:{f:ewe},12:{f:AEe},13:{f:HEe},14:{f:LEe},15:{f:PEe},16:{f:UEe},17:{f:ZEe},18:{f:jEe},19:{f:oP},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Bwe},40:{},42:{},43:{f:q_e},44:{f:K_e},45:{f:Q_e},46:{f:exe},47:{f:J_e},48:{},49:{f:Aye},50:{},51:{f:pxe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R_e},62:{f:XEe},63:{f:wxe},64:{f:_we},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:fl,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gwe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wEe},148:{f:xEe,p:16},151:{f:lwe},152:{},153:{f:Vwe},154:{},155:{},156:{f:Fwe},157:{},158:{},159:{T:1,f:F_e},160:{T:-1},161:{T:1,f:jd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:rwe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gxe},336:{T:-1},337:{f:xxe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:LA},357:{},358:{},359:{},360:{T:1},361:{},362:{f:E_e},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:cwe},427:{f:uwe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:dwe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:EEe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:awe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:LA},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Rxe},633:{T:1},634:{T:-1},635:{T:1,f:bxe},636:{T:-1},637:{f:Pye},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kwe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xwe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function rt(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&iP(t)&&n.push(t)}}function g2e(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return rt(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(h=n.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function ty(n,e,t){return n||(n=Me(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function m2e(n,e,t,r){var i=Me(9);return ty(i,n,e),QG(t,r||"b",i),i}function p2e(n,e,t){var r=Me(8+2*t.length);return ty(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function y2e(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ws(Ts(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?rt(n,2,k_e(t,r,i)):rt(n,3,P_e(t,r,i));return;case"b":case"e":rt(n,5,m2e(t,r,e.v,e.t));return;case"s":case"str":rt(n,4,p2e(t,r,(e.v||"").slice(0,255)));return}rt(n,1,ty(null,t,r))}function _2e(n,e,t,r){var i=Array.isArray(e),s=gr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ri(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Wi(c);for(var h=s.s.c;h<=s.e.c;++h){c===s.s.r&&(l[h]=hs(h)),a=l[h]+o;var f=i?(e[c]||[])[h]:e[a];f&&y2e(n,f,c,h)}}}function x2e(n,e){for(var t=e||{},r=Gs(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return rt(r,t.biff==4?1033:t.biff==3?521:9,uP(n,16,t)),_2e(r,n.Sheets[n.SheetNames[i]],i,t),rt(r,10),r.end()}function v2e(n,e,t){rt(n,49,f_e({sz:12,name:"Arial"},t))}function E2e(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&rt(n,1054,p_e(i,e[i],t))})}function w2e(n,e){var t=Me(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),rt(n,2151,t),t=Me(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),tB(gr(e["!ref"]||"A1"),t),t.write_shift(4,4),rt(n,2152,t)}function S2e(n,e){for(var t=0;t<16;++t)rt(n,224,M5({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){rt(n,224,M5(r,0,e))})}function T2e(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];rt(n,440,T_e(r)),r[1].Tooltip&&rt(n,2048,b_e(r))}delete e["!links"]}function b2e(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&rt(n,125,I_e(Pw(i,r),i))})}}function A2e(n,e,t,r,i){var s=16+Ku(i.cellXfs,e,i);if(e.v==null&&!e.bf){rt(n,513,vd(t,r,s));return}if(e.bf)rt(n,6,Yve(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ws(Ts(e.v)):e.v;rt(n,515,v_e(t,r,a,s));break;case"b":case"e":rt(n,517,x_e(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=mP(i.Strings,e.v,i.revStrings);rt(n,253,g_e(t,r,o,s))}else rt(n,516,m_e(t,r,(e.v||"").slice(0,255),s,i));break;default:rt(n,513,vd(t,r,s))}}function R2e(n,e,t){var r=Gs(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),c=e.biff==8,h,f="",m=[],y=gr(s["!ref"]||"A1"),x=c?65536:16384;if(y.e.c>255||y.e.r>=x){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,x-1)}rt(r,2057,uP(t,16,e)),rt(r,13,Pa(1)),rt(r,12,Pa(100)),rt(r,15,ys(!0)),rt(r,17,ys(!1)),rt(r,16,xd(.001)),rt(r,95,ys(!0)),rt(r,42,ys(!1)),rt(r,43,ys(!1)),rt(r,130,Pa(1)),rt(r,128,__e()),rt(r,131,ys(!1)),rt(r,132,ys(!1)),c&&b2e(r,s["!cols"]),rt(r,512,y_e(y,e)),c&&(s["!links"]=[]);for(var v=y.s.r;v<=y.e.r;++v){f=Wi(v);for(var E=y.s.c;E<=y.e.c;++E){v===y.s.r&&(m[E]=hs(E)),h=m[E]+f;var T=l?(s[v]||[])[E]:s[h];T&&(A2e(r,T,v,E,e),c&&T.l&&s["!links"].push([h,T.l]))}}var b=o.CodeName||o.name||i;return c&&rt(r,574,d_e((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&rt(r,229,S_e(s["!merges"])),c&&T2e(r,s),rt(r,442,eB(b)),c&&w2e(r,s),rt(r,10),r.end()}function I2e(n,e,t){var r=Gs(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(rt(r,2057,uP(n,5,t)),t.bookType=="xla"&&rt(r,135),rt(r,225,o?Pa(1200):null),rt(r,193,Jye(2)),l&&rt(r,191),l&&rt(r,192),rt(r,226),rt(r,92,l_e("SheetJS",t)),rt(r,66,Pa(o?1200:1252)),o&&rt(r,353,Pa(0)),o&&rt(r,448),rt(r,317,C_e(n.SheetNames.length)),o&&n.vbaraw&&rt(r,211),o&&n.vbaraw){var c=a.CodeName||"ThisWorkbook";rt(r,442,eB(c))}rt(r,156,Pa(17)),rt(r,25,ys(!1)),rt(r,18,ys(!1)),rt(r,19,Pa(0)),o&&rt(r,431,ys(!1)),o&&rt(r,444,Pa(0)),rt(r,61,h_e()),rt(r,64,ys(!1)),rt(r,141,Pa(0)),rt(r,34,ys(Nwe(n)=="true")),rt(r,14,ys(!0)),o&&rt(r,439,ys(!1)),rt(r,218,Pa(0)),v2e(r,n,t),E2e(r,n.SSF,t),S2e(r,t),o&&rt(r,352,ys(!1));var h=r.end(),f=Gs();o&&rt(f,140,A_e()),o&&t.Strings&&g2e(f,252,u_e(t.Strings)),rt(f,10);var m=f.end(),y=Gs(),x=0,v=0;for(v=0;v<n.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*n.SheetNames[v].length;var E=h.length+x+m.length;for(v=0;v<n.SheetNames.length;++v){var T=s[v]||{};rt(y,133,c_e({pos:E,hs:T.Hidden||0,dt:0,name:n.SheetNames[v]},t)),E+=e[v].length}var b=y.end();if(x!=b.length)throw new Error("BS8 "+x+" != "+b.length);var A=[];return h.length&&A.push(h),b.length&&A.push(b),m.length&&A.push(m),zi(A)}function C2e(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Hs(Vr)),n&&n.SSF&&(bw(),Tw(n.SSF),t.revssf=Aw(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pP(t),t.cellXfs=[],Ku(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=R2e(i,t,n);return r.unshift(I2e(n,r,t)),zi(r)}function RB(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=ma(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return C2e(n,e);case 4:case 3:case 2:return x2e(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function P2e(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>a)&&!(i[c].e.r<t||i[c].e.c<a)){if(i[c].s.r<t||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var h=Qn({r:t,c:a}),f=r.dense?(n[t]||[])[a]:n[h],m=f&&f.v!=null&&(f.h||oye(f.w||(cc(f),f.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?m='<span contenteditable="true">'+m+"</span>":f&&(y["data-t"]=f&&f.t||"z",f.v!=null&&(y["data-v"]=f.v),f.z!=null&&(y["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(nt("td",m,y))}}var x="<tr>";return x+s.join("")+"</tr>"}var k2e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',M2e="</body></html>";function N2e(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function IB(n,e){var t=e||{},r=t.header!=null?t.header:k2e,i=t.footer!=null?t.footer:M2e,s=[r],a=ma(n["!ref"]);t.dense=Array.isArray(n),s.push(N2e(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(P2e(n,a,o,t));return s.push("</table>"+i),s.join("")}function CB(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?Ci(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=ma(n["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var f=[],m=0,y=n["!rows"]||(n["!rows"]=[]),x=0,v=0,E=0,T=0,b=0,A=0;for(n["!cols"]||(n["!cols"]=[]);x<o.length&&v<l;++x){var M=o[x];if(V5(M)){if(r.display)continue;y[v]={hidden:!0}}var D=M.children;for(E=T=0;E<D.length;++E){var U=D[E];if(!(r.display&&V5(U))){var P=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):hye(U.innerHTML),R=U.getAttribute("data-z")||U.getAttribute("z");for(m=0;m<f.length;++m){var k=f[m];k.s.c==T+s&&k.s.r<v+i&&v+i<=k.e.r&&(T=k.e.c+1-s,m=-1)}A=+U.getAttribute("colspan")||1,((b=+U.getAttribute("rowspan")||1)>1||A>1)&&f.push({s:{r:v+i,c:T+s},e:{r:v+i+(b||1)-1,c:T+s+(A||1)-1}});var N={t:"s",v:P},O=U.getAttribute("data-t")||U.getAttribute("t")||"";P!=null&&(P.length==0?N.t=O||"z":r.raw||P.trim().length==0||O=="s"||(P==="TRUE"?N={t:"b",v:!0}:P==="FALSE"?N={t:"b",v:!1}:isNaN(Jl(P))?isNaN(Jp(P).getDate())||(N={t:"d",v:Ts(P)},r.cellDates||(N={t:"n",v:Ws(N.v)}),N.z=r.dateNF||Vr[14]):N={t:"n",v:Jl(P)})),N.z===void 0&&R!=null&&(N.z=R);var z="",j=U.getElementsByTagName("A");if(j&&j.length)for(var Re=0;Re<j.length&&!(j[Re].hasAttribute("href")&&(z=j[Re].getAttribute("href"),z.charAt(0)!="#"));++Re);z&&z.charAt(0)!="#"&&(N.l={Target:z}),r.dense?(n[v+i]||(n[v+i]=[]),n[v+i][T+s]=N):n[Qn({c:T+s,r:v+i})]=N,c.e.c<T+s&&(c.e.c=T+s),T+=A}}++v}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,v-1+i),n["!ref"]=ri(c),v>=l&&(n["!fullref"]=ri((c.e.r=o.length-x+v-1+i,c))),n}function PB(n,e){var t=e||{},r=t.dense?[]:{};return CB(r,n,e)}function L2e(n,e){return Ld(PB(n,e),e)}function V5(n){var e="",t=O2e(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function O2e(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var D2e=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+t1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return ai+e}})(),G5=(function(){var n=function(s){return Yn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Yn(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,f=ma(s["!ref"]||"A1"),m=s["!merges"]||[],y=0,x=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var v="",E=s["!rows"]||[];for(c=0;c<f.s.r;++c)v=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;c<=f.e.r;++c){for(v=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+v+`>
`),h=0;h<f.s.c;++h)l.push(e);for(;h<=f.e.c;++h){var T=!1,b={},A="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>h)&&!(m[y].s.r>c)&&!(m[y].e.c<h)&&!(m[y].e.r<c)){(m[y].s.c!=h||m[y].s.r!=c)&&(T=!0),b["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,b["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(T){l.push(t);continue}var M=Qn({r:c,c:h}),D=x?(s[c]||[])[h]:s[M];if(D&&D.f&&(b["table:formula"]=Yn(nEe(D.f)),D.F&&D.F.slice(0,M.length)==M)){var U=ma(D.F);b["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,b["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!D){l.push(e);continue}switch(D.t){case"b":A=D.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=D.v?"true":"false";break;case"n":A=D.w||String(D.v||0),b["office:value-type"]="float",b["office:value"]=D.v||0;break;case"s":case"str":A=D.v==null?"":D.v,b["office:value-type"]="string";break;case"d":A=D.w||Ts(D.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Ts(D.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var P=n(A);if(D.l&&D.l.Target){var R=D.l.Target;R=R.charAt(0)=="#"?"#"+rEe(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),P=nt("text:a",P,{"xlink:href":R.replace(/&/g,"&amp;")})}l.push("          "+nt("table:table-cell",nt("text:p",P,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var f=c["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;hP(f),f.ods=o;var m=c["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var f=c["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[ai],c=t1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=t1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(WG().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(r(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function kB(n,e){if(e.bookType=="fods")return G5(n,e);var t=eP(),r="",i=[],s=[];return r="mimetype",an(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",an(t,r,G5(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",an(t,r,D2e(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",an(t,r,ai+WG()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",an(t,r,Xye(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",an(t,r,Hye(i)),t}function iE(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function F2e(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):co(e1(n))}function j2e(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Vu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function V2e(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function n1(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Wn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function T0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function ui(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=n1(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=n1(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Di(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Wn(r*8+i.type)),i.type==2&&e.push(Wn(i.data.length)),e.push(i.data))})}),Vu(e)}function to(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=n1(n,r),s=ui(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:T0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=ui(o.data),c=T0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=T0(s[3][0].data)>>>0>0),t.push(a)}return t}function Lf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Wn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Wn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Wn(a.data.length)}],r[2].push({data:Di(a.meta),type:2})});var s=Di(r);e.push(Wn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Vu(e)}function G2e(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=n1(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Vu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var h=Vu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function no(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(G2e(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Vu(e)}function Of(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Wn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Vu(e)}function MT(n,e){var t=new Uint8Array(32),r=iE(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,V2e(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function NT(n,e){var t=new Uint8Array(32),r=iE(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function qc(n){var e=ui(n);return n1(e[1][0].data)}function B2e(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&T0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=iE(n[7][0].data),h=0,f=[],m=iE(n[4][0].data),y=0,x=[],v=0;v<e.length;++v){if(e[v]==null){c.setUint16(v*2,65535,!0),m.setUint16(v*2,65535);continue}c.setUint16(v*2,h,!0),m.setUint16(v*2,y,!0);var E,T;switch(typeof e[v]){case"string":E=MT({t:"s",v:e[v]},t),T=NT({t:"s",v:e[v]},t);break;case"number":E=MT({t:"n",v:e[v]},t),T=NT({t:"n",v:e[v]},t);break;case"boolean":E=MT({t:"b",v:e[v]},t),T=NT({t:"b",v:e[v]},t);break;default:throw new Error("Unsupported value "+e[v])}f.push(E),h+=E.length,x.push(T),y+=T.length,++l}for(n[2][0].data=Wn(l);v<n[7][0].data.length/2;++v)c.setUint16(v*2,65535,!0),m.setUint16(v*2,65535,!0);return n[6][0].data=Vu(f),n[3][0].data=Vu(x),l}function U2e(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ma(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ri(r)));var s=sE(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(Q){return Q.forEach(function(ne){typeof ne=="string"&&a.push(ne)})});var o={},l=[],c=Jn.read(e.numbers,{type:"base64"});c.FileIndex.map(function(Q,ne){return[Q,c.FullPaths[ne]]}).forEach(function(Q){var ne=Q[0],ie=Q[1];if(ne.type==2&&ne.name.match(/\.iwa/)){var me=ne.content,Ce=no(me),Fe=to(Ce);Fe.forEach(function(fe){l.push(fe.id),o[fe.id]={deps:[],location:ie,type:T0(fe.messages[0].meta[1][0].data)}})}}),l.sort(function(Q,ne){return Q-ne});var h=l.filter(function(Q){return Q>1}).map(function(Q){return[Q,Wn(Q)]});c.FileIndex.map(function(Q,ne){return[Q,c.FullPaths[ne]]}).forEach(function(Q){var ne=Q[0];if(Q[1],!!ne.name.match(/\.iwa/)){var ie=to(no(ne.content));ie.forEach(function(me){me.messages.forEach(function(Ce){h.forEach(function(Fe){me.messages.some(function(fe){return T0(fe.meta[1][0].data)!=11006&&j2e(fe.data,Fe[1])})&&o[Fe[0]].deps.push(me.id)})})})}});for(var f=Jn.find(c,o[1].location),m=to(no(f.content)),y,x=0;x<m.length;++x){var v=m[x];v.id==1&&(y=v)}var E=qc(ui(y.messages[0].data)[1][0].data);for(f=Jn.find(c,o[E].location),m=to(no(f.content)),x=0;x<m.length;++x)v=m[x],v.id==E&&(y=v);for(E=qc(ui(y.messages[0].data)[2][0].data),f=Jn.find(c,o[E].location),m=to(no(f.content)),x=0;x<m.length;++x)v=m[x],v.id==E&&(y=v);for(E=qc(ui(y.messages[0].data)[2][0].data),f=Jn.find(c,o[E].location),m=to(no(f.content)),x=0;x<m.length;++x)v=m[x],v.id==E&&(y=v);var T=ui(y.messages[0].data);{T[6][0].data=Wn(r.e.r+1),T[7][0].data=Wn(r.e.c+1);var b=qc(T[46][0].data),A=Jn.find(c,o[b].location),M=to(no(A.content));{for(var D=0;D<M.length&&M[D].id!=b;++D);if(M[D].id!=b)throw"Bad ColumnRowUIDMapArchive";var U=ui(M[D].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var P=0;P<=r.e.c;++P){var R=[];R[1]=R[2]=[{type:0,data:Wn(P+420690)}],U[1].push({type:2,data:Di(R)}),U[2].push({type:0,data:Wn(P)}),U[3].push({type:0,data:Wn(P)})}U[4]=[],U[5]=[],U[6]=[];for(var k=0;k<=r.e.r;++k)R=[],R[1]=R[2]=[{type:0,data:Wn(k+726270)}],U[4].push({type:2,data:Di(R)}),U[5].push({type:0,data:Wn(k)}),U[6].push({type:0,data:Wn(k)});M[D].messages[0].data=Di(U)}A.content=Of(Lf(M)),A.size=A.content.length,delete T[46];var N=ui(T[4][0].data);{N[7][0].data=Wn(r.e.r+1);var O=ui(N[1][0].data),z=qc(O[2][0].data);A=Jn.find(c,o[z].location),M=to(no(A.content));{if(M[0].id!=z)throw"Bad HeaderStorageBucket";var j=ui(M[0].messages[0].data);for(k=0;k<s.length;++k){var Re=ui(j[2][0].data);Re[1][0].data=Wn(k),Re[4][0].data=Wn(s[k].length),j[2][k]={type:j[2][0].type,data:Di(Re)}}M[0].messages[0].data=Di(j)}A.content=Of(Lf(M)),A.size=A.content.length;var Ne=qc(N[2][0].data);A=Jn.find(c,o[Ne].location),M=to(no(A.content));{if(M[0].id!=Ne)throw"Bad HeaderStorageBucket";for(j=ui(M[0].messages[0].data),P=0;P<=r.e.c;++P)Re=ui(j[2][0].data),Re[1][0].data=Wn(P),Re[4][0].data=Wn(r.e.r+1),j[2][P]={type:j[2][0].type,data:Di(Re)};M[0].messages[0].data=Di(j)}A.content=Of(Lf(M)),A.size=A.content.length;var Ve=qc(N[4][0].data);(function(){for(var Q=Jn.find(c,o[Ve].location),ne=to(no(Q.content)),ie,me=0;me<ne.length;++me){var Ce=ne[me];Ce.id==Ve&&(ie=Ce)}var Fe=ui(ie.messages[0].data);{Fe[3]=[];var fe=[];a.forEach(function(St,ln){fe[1]=[{type:0,data:Wn(ln)}],fe[2]=[{type:0,data:Wn(1)}],fe[3]=[{type:2,data:F2e(St)}],Fe[3].push({type:2,data:Di(fe)})})}ie.messages[0].data=Di(Fe);var le=Lf(ne),yt=Of(le);Q.content=yt,Q.size=Q.content.length})();var Oe=ui(N[3][0].data);{var ce=Oe[1][0];delete Oe[2];var we=ui(ce.data);{var Se=qc(we[2][0].data);(function(){for(var Q=Jn.find(c,o[Se].location),ne=to(no(Q.content)),ie,me=0;me<ne.length;++me){var Ce=ne[me];Ce.id==Se&&(ie=Ce)}var Fe=ui(ie.messages[0].data);{delete Fe[6],delete Oe[7];var fe=new Uint8Array(Fe[5][0].data);Fe[5]=[];for(var le=0,yt=0;yt<=r.e.r;++yt){var St=ui(fe);le+=B2e(St,s[yt],a),St[1][0].data=Wn(yt),Fe[5].push({data:Di(St),type:2})}Fe[1]=[{type:0,data:Wn(r.e.c+1)}],Fe[2]=[{type:0,data:Wn(r.e.r+1)}],Fe[3]=[{type:0,data:Wn(le)}],Fe[4]=[{type:0,data:Wn(r.e.r+1)}]}ie.messages[0].data=Di(Fe);var ln=Lf(ne),kt=Of(ln);Q.content=kt,Q.size=Q.content.length})()}ce.data=Di(we)}N[3][0].data=Di(Oe)}T[4][0].data=Di(N)}y.messages[0].data=Di(T);var se=Lf(m),V=Of(se);return f.content=V,f.size=f.content.length,c}function z2e(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function pP(n){z2e([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function $2e(n,e){return e.bookType=="ods"?kB(n,e):e.bookType=="numbers"?U2e(n,e):e.bookType=="xlsb"?W2e(n,e):H2e(n,e)}function W2e(n,e){a0=1024,n&&!n.SSF&&(n.SSF=Hs(Vr)),n&&n.SSF&&(bw(),Tw(n.SSF),e.revssf=Aw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,lp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=fB.indexOf(e.bookType)>-1,i=UG();pP(e=e||{});var s=eP(),a="",o=0;if(e.cellXfs=[],Ku(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",an(s,a,HG(n.Props,e)),i.coreprops.push(a),Hn(e.rels,2,a,In.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,an(s,a,XG(n.Props)),i.extprops.push(a),Hn(e.rels,3,a,In.EXT_PROPS),n.Custprops!==n.Props&&Hi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",an(s,a,qG(n.Custprops)),i.custprops.push(a),Hn(e.rels,4,a,In.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},f=n.Sheets[n.SheetNames[o-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,an(s,a,Xwe(o-1,a,e,n,h)),i.sheets.push(a),Hn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,In.WS[0])}if(f){var y=f["!comments"],x=!1,v="";y&&y.length>0&&(v="xl/comments"+o+"."+t,an(s,v,Zwe(y,v)),i.comments.push(v),Hn(h,-1,"../comments"+o+"."+t,In.CMNT),x=!0),f["!legacy"]&&x&&an(s,"xl/drawings/vmlDrawing"+o+".vml",hB(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&an(s,$G(a),w0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,an(s,a,Ywe(e.Strings,a,e)),i.strs.push(a),Hn(e.wbrels,-1,"sharedStrings."+t,In.SST)),a="xl/workbook."+t,an(s,a,Kwe(n,a)),i.workbooks.push(a),Hn(e.rels,1,a,In.WB),a="xl/theme/theme1.xml",an(s,a,cB(n.Themes,e)),i.themes.push(a),Hn(e.wbrels,-1,"theme/theme1.xml",In.THEME),a="xl/styles."+t,an(s,a,qwe(n,a,e)),i.styles.push(a),Hn(e.wbrels,-1,"styles."+t,In.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",an(s,a,n.vbaraw),i.vba.push(a),Hn(e.wbrels,-1,"vbaProject.bin",In.VBA)),a="xl/metadata."+t,an(s,a,Qwe(a)),i.metadata.push(a),Hn(e.wbrels,-1,"metadata."+t,In.XLMETA),an(s,"[Content_Types].xml",zG(i,e)),an(s,"_rels/.rels",w0(e.rels)),an(s,"xl/_rels/workbook."+t+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,s}function H2e(n,e){a0=1024,n&&!n.SSF&&(n.SSF=Hs(Vr)),n&&n.SSF&&(bw(),Tw(n.SSF),e.revssf=Aw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,lp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=fB.indexOf(e.bookType)>-1,i=UG();pP(e=e||{});var s=eP(),a="",o=0;if(e.cellXfs=[],Ku(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",an(s,a,HG(n.Props,e)),i.coreprops.push(a),Hn(e.rels,2,a,In.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,an(s,a,XG(n.Props)),i.extprops.push(a),Hn(e.rels,3,a,In.EXT_PROPS),n.Custprops!==n.Props&&Hi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",an(s,a,qG(n.Custprops)),i.custprops.push(a),Hn(e.rels,4,a,In.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var f={"!id":{}},m=n.Sheets[n.SheetNames[o-1]],y=(m||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,an(s,a,wB(o-1,e,n,f)),i.sheets.push(a),Hn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,In.WS[0])}if(m){var x=m["!comments"],v=!1,E="";if(x&&x.length>0){var T=!1;x.forEach(function(b){b[1].forEach(function(A){A.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+t,an(s,E,Sxe(x,h,e)),i.threadedcomments.push(E),Hn(f,-1,"../threadedComments/threadedComment"+o+"."+t,In.TCMNT)),E="xl/comments"+o+"."+t,an(s,E,dB(x)),i.comments.push(E),Hn(f,-1,"../comments"+o+"."+t,In.CMNT),v=!0}m["!legacy"]&&v&&an(s,"xl/drawings/vmlDrawing"+o+".vml",hB(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&an(s,$G(a),w0(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,an(s,a,rB(e.Strings,e)),i.strs.push(a),Hn(e.wbrels,-1,"sharedStrings."+t,In.SST)),a="xl/workbook."+t,an(s,a,bB(n)),i.workbooks.push(a),Hn(e.rels,1,a,In.WB),a="xl/theme/theme1.xml",an(s,a,cB(n.Themes,e)),i.themes.push(a),Hn(e.wbrels,-1,"theme/theme1.xml",In.THEME),a="xl/styles."+t,an(s,a,oB(n,e)),i.styles.push(a),Hn(e.wbrels,-1,"styles."+t,In.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",an(s,a,n.vbaraw),i.vba.push(a),Hn(e.wbrels,-1,"vbaProject.bin",In.VBA)),a="xl/metadata."+t,an(s,a,uB()),i.metadata.push(a),Hn(e.wbrels,-1,"metadata."+t,In.XLMETA),h.length>1&&(a="xl/persons/person.xml",an(s,a,Txe(h)),i.people.push(a),Hn(e.wbrels,-1,"persons/person.xml",In.PEOPLE)),an(s,"[Content_Types].xml",zG(i,e)),an(s,"_rels/.rels",w0(e.rels)),an(s,"xl/_rels/workbook."+t+".rels",w0(e.wbrels)),delete e.revssf,delete e.ssf,s}function K2e(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=lc(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function MB(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Z1(e.file,Jn.write(n,{type:Nn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Jn.write(n,e)}function X2e(n,e){var t=Hs(e||{}),r=$2e(n,t);return q2e(r,t)}function q2e(n,e){var t={},r=Nn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?Jn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Sw(i))}return e.password&&typeof encrypt_agile<"u"?MB(encrypt_agile(i,e.password),e):e.type==="file"?Z1(e.file,i):e.type=="string"?ip(i):i}function Y2e(n,e){var t=e||{},r=d2e(n,t);return MB(r,t)}function $o(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return Qp(e1(r));case"binary":return e1(r);case"string":return n;case"file":return Z1(e.file,r,"utf8");case"buffer":return Nn?_c(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):$o(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Z2e(n,e){switch(e.type){case"base64":return Qp(n);case"binary":return n;case"string":return n;case"file":return Z1(e.file,n,"binary");case"buffer":return Nn?_c(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function $_(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?Qp(t):e.type=="string"?ip(t):t;case"file":return Z1(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function NB(n,e){b1e(),Dwe(n);var t=Hs(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=NB(n,t);return t.type="array",Sw(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return $o(u2e(n,t),t);case"slk":case"sylk":return $o(N_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return $o(IB(n.Sheets[n.SheetNames[i]],t),t);case"txt":return Z2e(LB(n.Sheets[n.SheetNames[i]],t),t);case"csv":return $o(yP(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return $o(L_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return $_(M_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return $o(O_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return $o(U_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return $o(nB.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return $o(kB(n,t),t);case"wk1":return $_(N5.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return $_(N5.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),$_(RB(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Y2e(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return X2e(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Q2e(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function J2e(n,e,t){var r={};return r.type="file",r.file=e,Q2e(r),NB(n,r)}function eSe(n,e,t,r,i,s,a,o){var l=Wi(t),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var x=a?n[t][y]:n[r[y]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[y]!=null&&(m[s[y]]=c);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[y]!=null){if(v==null)if(x.t=="e"&&v===null)m[s[y]]=null;else if(c!==void 0)m[s[y]]=c;else if(h&&v===null)m[s[y]]=null;else continue;else m[s[y]]=h&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:cc(x,v,o);v!=null&&(f=!1)}}return{row:m,isempty:f}}function sE(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof h){case"string":l=gr(h);break;case"number":l=gr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var f=Wi(l.s.r),m=[],y=[],x=0,v=0,E=Array.isArray(n),T=l.s.r,b=0,A={};E&&!n[T]&&(n[T]=[]);var M=c.skipHidden&&n["!cols"]||[],D=c.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(M[b]||{}).hidden)switch(m[b]=hs(b),t=E?n[T][b]:n[m[b]+f],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=m[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=cc(t,null,c),v=A[a]||0,!v)A[a]=1;else{do o=a+"_"+v++;while(A[o]);A[a]=v,A[o]=1}s[b]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(D[T]||{}).hidden){var U=eSe(n,l,T,m,r,s,E,c);(U.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(y[x++]=U.row)}return y.length=x,y}var B5=/"/g;function tSe(n,e,t,r,i,s,a,o){for(var l=!0,c=[],h="",f=Wi(t),m=e.s.c;m<=e.e.c;++m)if(r[m]){var y=o.dense?(n[t]||[])[m]:n[r[m]+f];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:cc(y,null,o));for(var x=0,v=0;x!==h.length;++x)if((v=h.charCodeAt(x))===i||v===s||v===34||o.forceQuotes){h='"'+h.replace(B5,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(B5,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function yP(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=gr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];r.dense=Array.isArray(n);for(var m=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(m[x]||{}).hidden||(f[x]=hs(x));for(var v=0,E=i.s.r;E<=i.e.r;++E)(y[E]||{}).hidden||(h=tSe(n,i,E,f,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(c,"")),(h||r.blankrows!==!1)&&t.push((v++?o:"")+h)));return delete r.dense,t.join("")}function LB(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=yP(n,e);return t}function nSe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=gr(n["!ref"]),s="",a=[],o,l=[],c=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=hs(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Wi(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=c?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function OB(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Ci(r.origin):r.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=gr(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var m=r.header||[],y=0;e.forEach(function(v,E){Hi(v).forEach(function(T){(y=m.indexOf(T))==-1&&(m[y=m.length]=T);var b=v[T],A="z",M="",D=Qn({c:o+y,r:a+E+i});c=r1(s,D),b&&typeof b=="object"&&!(b instanceof Date)?s[D]=b:(typeof b=="number"?A="n":typeof b=="boolean"?A="b":typeof b=="string"?A="s":b instanceof Date?(A="d",r.cellDates||(A="n",b=Ws(b)),M=r.dateNF||Vr[14]):b===null&&r.nullError&&(A="e",b=0),c?(c.t=A,c.v=b,delete c.w,delete c.R,M&&(c.z=M)):s[D]=c={t:A,v:b},M&&(c.z=M))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var x=Wi(a);if(i)for(y=0;y<m.length;++y)s[hs(y+o)+x]={t:"s",v:m[y]};return s["!ref"]=ri(h),s}function rSe(n,e){return OB(null,n,e)}function r1(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=Ci(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?r1(n,Qn(e)):r1(n,Qn({r:e,c:t||0}))}function iSe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function sSe(){return{SheetNames:[],Sheets:{}}}function aSe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(TB(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function oSe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=iSe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function lSe(n,e){return n.z=e,n}function DB(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function cSe(n,e,t){return DB(n,"#"+e,t)}function uSe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function hSe(n,e,t,r){for(var i=typeof e!="string"?e:gr(e),s=typeof e=="string"?e:ri(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=r1(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var LT={encode_col:hs,encode_row:Wi,encode_cell:Qn,encode_range:ri,decode_col:aP,decode_row:sP,split_cell:bye,decode_cell:Ci,decode_range:ma,format_cell:cc,sheet_add_aoa:DG,sheet_add_json:OB,sheet_add_dom:CB,aoa_to_sheet:gg,json_to_sheet:rSe,table_to_sheet:PB,table_to_book:L2e,sheet_to_csv:yP,sheet_to_txt:LB,sheet_to_json:sE,sheet_to_html:IB,sheet_to_formulae:nSe,sheet_to_row_object_array:sE,sheet_get_cell:r1,book_new:sSe,book_append_sheet:aSe,book_set_sheet_visibility:oSe,cell_set_number_format:lSe,cell_set_hyperlink:DB,cell_set_internal_link:cSe,cell_add_comment:uSe,sheet_set_array_formula:hSe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ol=pa()(kd((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(c=>{const h=new Date(c.timestamp).toLocaleDateString("nl-NL"),f=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${h},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${f},${c.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=LT.json_to_sheet(r),s=LT.book_new();LT.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,J2e(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),dSe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"4/5 n.Chr. - ca. 270 n.Chr.",beschrijving:"Fectio was een van de belangrijkste Romeinse legerbases in Nederland. Het fort lag bij de splitsing van de Rijn en de Vecht, een strategisch punt.",watWasHier:"Hier was een groot castellum (legerplaats) met ruimte voor ongeveer 500 soldaten. Er waren barakken, een badhuis, een hospitaal en pakhuizen. Buiten het fort woonden handelaren en families van soldaten.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren van het fort. In het museum zijn veel vondsten te zien, waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens, paardentuig, en militaire uitrusting. Door de natte bodem zijn hier ook organische materialen zoals leer en hout bewaard.",betekenis:"Fectio was onderdeel van de Limes, de noordgrens van het Romeinse Rijk. Vanaf hier werden troepen en goederen vervoerd over de Rijn.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"47 n.Chr. - ca. 270 n.Chr.",beschrijving:'Traiectum is het huidige Utrecht. De naam betekent "oversteekplaats". Hier stak een belangrijke weg de Rijn over.',watWasHier:"Een klein castellum met een bezetting van enkele honderden soldaten. Het fort bewaakte de oversteek van de Rijn. Er was een brug of veerpont.",watTeZien:"De Domkerk staat deels op de fundamenten van het Romeinse fort. In het Centraal Museum zijn Romeinse vondsten te zien. Onder het Domplein zijn resten gevonden.",verwachteVondsten:"Munten, sieraden, aardewerk, bouwmateriaal (tegels, bakstenen), en offers aan de rivier. Bij de brug werden vaak munten geofferd.",betekenis:"Traiectum was een belangrijk knooppunt waar de landweg de rivier kruiste. Later groeide het uit tot de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Laurum lag in het huidige Woerden. Het was een middelgroot fort aan de Rijn.",watWasHier:"Een castellum met ruimte voor ongeveer 500 soldaten. Er zijn resten gevonden van houten barakken, een badhuis en pakhuizen. Buiten het fort lag een vicus (burgerdorp).",watTeZien:"In het Stadsmuseum Woerden zijn vondsten te zien, waaronder een bijzondere Romeinse boot. De contouren van het fort zijn in het stratenpatroon te herkennen.",verwachteVondsten:"Militaria, aardewerk, munten, en schrijfplankjes. Door de natte veengrond zijn ook houten voorwerpen en leren schoenen bewaard gebleven.",betekenis:"Laurum toont hoe de Romeinen in het veengebied bouwden. De soldaten moesten constant vechten tegen het water.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Dit fort lag in Valkenburg (ZH). De naam verwijst naar Agrippina, de moeder van keizer Nero.",watWasHier:"Een middelgroot castellum met barakken voor hulptroepen. Er waren ook werkplaatsen en opslagruimtes. Het fort werd meerdere keren herbouwd na overstromingen.",watTeZien:"Het Archeologisch Steunpunt Valkenburg toont de geschiedenis. Delen van het fort zijn opgegraven en worden beschermd.",verwachteVondsten:"Militaire uitrusting, aardewerk uit het Rijnland en Galli, munten, en bouwmateriaal. Hier zijn ook inscripties gevonden.",betekenis:"Een van de best onderzochte forten aan de Rijn. Geeft veel informatie over het dagelijks leven van Romeinse soldaten.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"19 v.Chr. - ca. 70 n.Chr.",beschrijving:"Op de Hunnerberg bij Nijmegen lag een groot legerkamp. Hier waren tijdelijk twee volledige legioenen (10.000 soldaten) gestationeerd.",watWasHier:"Een enorm legerkamp van 42 hectare, een van de grootste ten noorden van de Alpen. Hier werden veldtochten naar Germani voorbereid.",watTeZien:"Op de Hunnerberg zijn de wallen nog zichtbaar in het landschap. Het Museum Het Valkhof toont veel vondsten.",verwachteVondsten:"Militaire uitrusting van hoge kwaliteit, munten van Augustus en Tiberius, legioenstempels op dakpannen, en resten van wapens.",betekenis:"Dit was de belangrijkste legerbasis in het vroege Romeinse Nederland. Vanaf hier werden de oorlogen tegen de Germanen gevoerd.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Op het Kops Plateau in Nijmegen lag een vroege militaire basis, later de hoofdstad van de Bataven.",watWasHier:"Eerst een Romeins kamp, later de civiele hoofdstad Oppidum Batavorum. Hier woonden Romeinen en Bataven samen.",watTeZien:"Het Kops Plateau is nu een natuurgebied. Opgravingen hebben veel informatie opgeleverd. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege Romeinse militaria, Keltisch-Bataafse voorwerpen, importaardewerk, en munten uit de tijd van Augustus.",betekenis:"Dit was het eerste contactpunt tussen Romeinen en Bataven. Hier begon de romanisering van Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 n.Chr. - 400 n.Chr.",beschrijving:"Op het Valkhof stond een laat-Romeinse versterking. Later bouwde Karel de Grote hier een palts.",watWasHier:"Een versterkte positie uit de tijd dat het Romeinse Rijk onder druk stond. De soldaten bewaakten de Waaloever.",watTeZien:"Het Valkhofpark met de Sint-Nicolaaskapel (deels Karolingisch). Museum Het Valkhof toont de geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, gordeltjes en riemtongen, aardewerk uit de 3e en 4e eeuw, en militaire gespen.",betekenis:"Toont de overgang van het Romeinse Rijk naar de vroege middeleeuwen. Nijmegen bleef een belangrijk centrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 n.Chr. - 270 n.Chr.",beschrijving:"Dit fort lag in Leidsche Rijn bij Utrecht. Het is nu een archeologisch park.",watWasHier:"Een middengroot castellum met houten gebouwen. Buiten de muren lag een burgerdorp. Hier is een compleet Romeins schip gevonden.",watTeZien:"Archeologisch Park Castellum Hoge Woerd met de reconstructie van het fort en een museum. Je kunt over de fundamenten lopen.",verwachteVondsten:"Militaire uitrusting, scheepsonderdelen, aardewerk, munten, en door de natte grond ook organisch materiaal.",betekenis:"Een van de best bewaarde en gepresenteerde Romeinse forten in Nederland. Ideaal om te zien hoe een fort eruitzag.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum Batavorum",latinNaam:"Lugdunum Batavorum",type:"castellum",periode:"ca. 40 n.Chr. - 270 n.Chr.",beschrijving:"Lugdunum lag in Katwijk, aan de monding van de Rijn in zee. Het was het westelijkste fort van de Limes.",watWasHier:"Een castellum dat de riviermonding bewaakte. Hier eindigde de Rijn en begon de zee. Er was ook een vuurtoren.",watTeZien:"Het fort is door de zee weggespoeld. In het Rijksmuseum van Oudheden in Leiden zijn vondsten te zien.",verwachteVondsten:"Op het strand worden soms voorwerpen gevonden na stormen. Munten, aardewerk en militaria.",betekenis:"Het westelijke eindpunt van de Limes. Hier begonnen zeereizen naar Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-batavorum-katwijk/"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e eeuw n.Chr.",beschrijving:"Bij Naaldwijk lag mogelijk een basis voor de Romeinse vloot (Classis Germanica).",watWasHier:"Een haven met schepen die langs de kust patrouilleerden en troepen naar Britannia vervoerden.",watTeZien:"Het gebied is nu landbouwgrond. Vondsten zijn in lokale musea te zien.",verwachteVondsten:"Scheepsonderdelen, ankers, militaire uitrusting voor mariniers, importaardewerk.",betekenis:"Toont het belang van de Romeinse vloot voor de verdediging van de kust.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 n.Chr.",beschrijving:"Bij Ockenburg in Den Haag stond een klein Romeins fortje dat de kust bewaakte.",watWasHier:"Een kleine wachtpost met ruimte voor een handvol soldaten. Het lag op een strandwal.",watTeZien:"Het terrein is beschermd maar niet toegankelijk. Vondsten zijn in het Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, en munten.",betekenis:"Toont dat de Romeinen ook de kust bewaakten, niet alleen de rivieren.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Ceuclum lag bij Cuijk aan de Maas. Het bewaakte een brug over de rivier.",watWasHier:"Een middelgroot castellum bij een belangrijke rivierovergang. De weg naar het noorden liep hier.",watTeZien:"In Cuijk zijn restanten gevonden. Het Maasmuseum toont lokale vondsten.",verwachteVondsten:"Munten, fibulae, aardewerk, en materiaal gerelateerd aan de brug.",betekenis:"Een belangrijke schakel in het Romeinse wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Arnhem-Meinerswijk lag een Romeins fort aan de Rijn.",watWasHier:"Een castellum dat de rivierroute bewaakte. Het lag in de uiterwaarden.",watTeZien:"Het terrein is nu natuurgebied. Vondsten zijn in Museum Arnhem te zien.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Onderdeel van de keten van forten langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Levefanum lag bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en de Kromme Rijn.",watWasHier:"Een militaire post bij een strategische riviersplitsing. Mogelijk ook een haven.",watTeZien:"Het terrein is bebouwd. Dorestad Museum toont de latere geschiedenis van deze plek.",verwachteVondsten:"Munten, aardewerk, militaria, en handelsproducten.",betekenis:"Een belangrijk controlepunt voor het scheepvaartverkeer.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum",type:"minifort",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Nigrum Pullum (Zwarte Poel) lag bij Zwammerdam. Het was een klein fortje in het veengebied.",watWasHier:"Een klein fort met pakhuizen. Er zijn meerdere Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, bouwmaterialen, aardewerk, en door de natte grond organisch materiaal.",betekenis:"Beroemd om de goed bewaarde Romeinse schepen. Toont transport over water.",bronnen:["https://www.rmo.nl"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 n.Chr.",beschrijving:"In Vleuterweide bij Utrecht stond een stenen wachttoren. Dit was ongebruikelijk - de meeste waren van hout.",watWasHier:"Een versterkte toren met uitzicht over de omgeving. Mogelijk woonden hier ook families van soldaten.",watTeZien:"De fundamenten zijn gemarkeerd in de wijk. Vondsten zijn in het Centraal Museum Utrecht.",verwachteVondsten:"Bouwmaterialen (dakpannen, stenen), aardewerk, en persoonlijke bezittingen.",betekenis:"Een van de weinige bekende stenen wachttorens. Toont variatie in Romeinse bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Bunnik stond een houten wachttoren aan de Rijn.",watWasHier:"Een uitkijkpost waar soldaten de rivier in de gaten hielden en signalen doorgaven.",watTeZien:"De exacte locatie is niet precies bekend. Het gebied is nu bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel van het signaleringssysteem langs de Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"3e - 4e eeuw n.Chr.",beschrijving:"In het centrum van Maastricht stond een laat-Romeinse versterking bij de brug over de Maas.",watWasHier:"Een verdedigingswerk uit de tijd dat het Rijk onder druk stond. Het bewaakte de rivierovergang.",watTeZien:"Onder het Vrijthof zijn resten gevonden. Centre Ceramique toont de Romeinse geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, militaire riembeslag, aardewerk, en bouwmaterialen.",betekenis:"Toont de continuiteit - Maastricht bleef belangrijk van de Romeinse tijd tot nu.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij de Roompot in Zeeland lag een Romeins fort dat de zeeroute bewaakte.",watWasHier:"Een versterking aan de kust die schepen beschermde en piraterij teginging.",watTeZien:"Het fort is door de zee verzwolgen. Soms spoelen vondsten aan.",verwachteVondsten:"Door erosie kunnen munten en voorwerpen op het strand gevonden worden.",betekenis:"Toont dat de Romeinen ook de Zeeuwse wateren controleerden.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Carvium lag bij Herwen, waar de Rijn en de Waal samenkwamen.",watWasHier:"Een fort bij een strategisch punt waar twee grote rivieren samenkwamen.",watTeZien:"Het gebied is nu natuurgebied. Vondsten zijn in Museum Het Valkhof in Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Controleerde een belangrijk knooppunt van waterwegen.",bronnen:[]}},fSe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een Romeinse militaire versterking langs de noordgrens van het Rijk.",watWasHier:"Een militaire post met soldaten die de grens bewaakten. Vaak was er ook een burgerdorp (vicus) in de buurt.",watTeZien:"De meeste forten zijn nu verdwenen of overbouwd. Lokale musea tonen vaak vondsten.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens en gereedschap.",betekenis:"Onderdeel van de Limes, de noordelijke grens van het Romeinse Rijk die door Nederland liep."},gSe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function mSe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function pSe(n){try{const e=Tn(n),t=bn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const h=typeof c=="number"?c:parseFloat(c);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const ySe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},_Se={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function U5(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function xSe(){const n=pi(mt=>mt.map),e=ol(mt=>mt.removeVondst),t=ol(mt=>mt.updateVondst),r=ol(mt=>mt.vondsten),{layers:i,addPoint:s,addLayer:a}=cs(),[o,l]=X.useState([]),[c,h]=X.useState(0),[f,m]=X.useState(!1),[y,x]=X.useState(null),[v,E]=X.useState(!1),[T,b]=X.useState(!1),[A,M]=X.useState(null),[D,U]=X.useState(null),[P,R]=X.useState(null),[k,N]=X.useState(!1),[O,z]=X.useState(null),[j,Re]=X.useState(null),[Ne,Ve]=X.useState(null),[Oe,ce]=X.useState(!1),[we,Se]=X.useState(""),[se,V]=X.useState([]),Q=se[c]||null,[ne,ie]=X.useState(()=>{const mt=localStorage.getItem("popupTextScale");return mt?parseInt(mt):100}),me=mt=>{ie(mt),localStorage.setItem("popupTextScale",mt.toString())},Ce=o[c]||"",Fe=o.length>1,fe=mt=>{const Ut=mt.match(/<strong[^>]*>(.*?)<\/strong>/);if(Ut){const Fn=Ut[1].replace(/<[^>]+>/g,""),xt=mt.replace(Ut[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:Fn,contentWithoutTitle:xt}}return{title:"",contentWithoutTitle:mt}},le=mt=>mt.replace(/class="([^"]*)"/g,(Fn,xt)=>{if(xt.includes("text-xs")){const nn=xt.replace(/\btext-xs\b/g,"").trim();return nn?`style="font-size:0.857em" class="${nn}"`:'style="font-size:0.857em"'}if(xt.includes("text-sm")){const nn=xt.replace(/\btext-sm\b/g,"").trim();return nn?`class="${nn}"`:""}return Fn}).replace(/class=""/g,""),{title:yt,contentWithoutTitle:St}=fe(Ce),ln=le(St),kt=Ce.includes("Landbouwperceel"),Dn=Ce.includes("data-vondst-id="),tn=()=>{h(mt=>(mt-1+o.length)%o.length)},lt=()=>{h(mt=>(mt+1)%o.length)},nr=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||T){console.log(" STOP - map:",!!n,"coord:",y,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),b(!0);try{await w1e(n,y)&&E(!0)}catch(mt){console.error("Failed to load height map:",mt)}finally{b(!1)}},hn=()=>{n&&(kA(n),E(!1))};X.useEffect(()=>{if(!n)return;const mt=xt=>{let nn='<strong class="text-purple-800">AMK Monument</strong>';if(xt.toponiem&&(nn+=`<br/><span class="text-sm font-semibold">${xt.toponiem}</span>`),xt.kwaliteitswaarde&&(nn+=`<br/><span class="text-sm text-purple-700">${xt.kwaliteitswaarde}</span>`),xt.omschrijving&&(nn+=`<br/><span class="text-xs text-gray-600 mt-1 block">${xt.omschrijving}</span>`),xt.txt_label){const Nt=xt.txt_label.split(", ").slice(0,3).join(", ");nn+=`<br/><span class="text-xs text-gray-500 italic">${Nt}${xt.txt_label.split(", ").length>3?"...":""}</span>`}return nn},Ut=async(xt,nn)=>{const Nt=[],cr=n.getLayers().getArray().filter(_i=>_i instanceof vh&&_i.getVisible()?_i.getSource()instanceof gX:!1);for(const _i of cr){const Kr=_i.getSource();if(!Kr)continue;const Wt=_i.get("title")||"";if(Wt.startsWith("Paleokaart"))continue;if(Wt==="Archeo Landschappen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,Y=Z.landschapsnaam||Z.naam||"Archeologisch Landschap",ue=Z.omschrijving||"";let he=`<strong class="text-green-800">${Y}</strong>`;ue&&(he+=`<br/><span class="text-sm text-gray-600">${ue}</span>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Nt.push(he)}}catch(je){console.warn("Archeo Landschappen WMS query failed:",je)}continue}if(Wt==="Essen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(Z.naam||Z.Naam||Z.NAME)&&(Y+=`<br/><span class="text-sm font-semibold text-amber-700">${Z.naam||Z.Naam||Z.NAME}</span>`),(Z.type||Z.Type||Z.TYPE)&&(Y+=`<br/><span class="text-xs text-gray-600">${Z.type||Z.Type||Z.TYPE}</span>`),(Z.omschrijving||Z.Omschrijving)&&(Y+=`<br/><span class="text-xs text-gray-500">${Z.omschrijving||Z.Omschrijving}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',Y+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Nt.push(Y)}}catch(je){console.warn("Essen WMS query failed:",je)}continue}if(Wt==="FAMKE Steentijd"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';Y+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart voor oude vondsten</span>';const ue=Z.advies||Z.Advies||"";if(ue){Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',Y+=`<div class="text-sm text-amber-700 mt-1">${ue}</div>`;const he=ue.toLowerCase();let Be="",Ie="text-gray-600",$e="";he.includes("karterend")?(Be="Op deze plek verwachten archeologen vondsten uit de steentijd of bronstijd. Bij graafwerk moet er eerst onderzoek komen.",$e="Goede kans op oude vondsten (vuursteen, bijlen, aardewerk)",Ie="text-amber-600"):he.includes("waarderend")?(Be="Hier zijn mogelijk belangrijke vindplaatsen. Proefsleuven zijn nodig om te kijken wat er precies zit.",$e="Mogelijk interessante vondsten uit de prehistorie",Ie="text-orange-600"):he.includes("geen")?(Be="De kans op prehistorische vondsten is hier klein. De grond is waarschijnlijk te jong of te veel verstoord.",$e="Weinig kans op steentijd-vondsten",Ie="text-green-600"):he.includes("quickscan")&&(Be="Hier is eerst bureau-onderzoek nodig. Er kunnen vondsten zitten, maar dat is nog niet zeker.",$e="Onbekend, nader onderzoek nodig",Ie="text-blue-600"),Be&&(Y+=`<div class="text-sm ${Ie} mt-1">${Be}</div>`),$e&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>'}Nt.push(Y)}}catch(je){console.warn("FAMKE WMS query failed:",je)}continue}if(Wt==="Archeo Onderzoeken"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}&FEATURE_COUNT=20`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0)for(const Z of W.features){const Y=Z.properties;let ue='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';const he=Y.type_onderzoek||"";he&&(ue+=`<br/><span class="text-sm font-semibold text-blue-700">${he}</span>`);const Be=Y.projectnaam||Y.project_naam||Y.naam||"";if(Be&&(ue+=`<br/><span class="text-sm text-gray-800">${Be}</span>`),Y.onderzoeksmeldingnummer&&(ue+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${Y.onderzoeksmeldingnummer}</span>`),Y.uitvoerder&&(ue+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${Y.uitvoerder}</span>`),Y.startdatum||Y.einddatum){const $e=[Y.startdatum,Y.einddatum].filter(Boolean).join(" - ");ue+=`<br/><span class="text-xs text-gray-600">Periode: ${$e}</span>`}Y.gemeente&&(ue+=`<br/><span class="text-xs text-gray-500">${Y.gemeente}</span>`);const Ie=[];if(Y.periode_paleolithicum&&Ie.push("Paleolithicum"),Y.periode_mesolithicum&&Ie.push("Mesolithicum"),Y.periode_neolithicum&&Ie.push("Neolithicum"),Y.periode_bronstijd&&Ie.push("Bronstijd"),Y.periode_ijzertijd&&Ie.push("IJzertijd"),Y.periode_romeins&&Ie.push("Romeins"),Y.periode_middeleeuwen&&Ie.push("Middeleeuwen"),Y.periode_nieuwe_tijd&&Ie.push("Nieuwe tijd"),Ie.length>0&&(ue+=`<br/><span class="text-sm text-purple-700">Datering: ${Ie.join(", ")}</span>`),ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',he.toLowerCase().includes("opgraving")?ue+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':he.toLowerCase().includes("bureauonderzoek")?ue+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':he.toLowerCase().includes("booronderzoek")?ue+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':he.toLowerCase().includes("proefsleuven")?ue+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':he.toLowerCase().includes("begeleiding")?ue+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':he.toLowerCase().includes("inventariserend")?ue+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':ue+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',ue+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>',Y.onderzoeksmeldingnummer){const $e=Y.onderzoeksmeldingnummer;ue+=`<div class="text-sm text-gray-700 mt-1"><a href="https://easy.dans.knaw.nl/ui/datasets?q=${encodeURIComponent($e)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek rapport in DANS-EASY</a></div>`,ue+='<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in ARCHIS</a></div>'}ue+='<div class="text-sm text-gray-700 mt-1"><a href="https://bibliotheek.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bibliotheek voor Archeologie</a></div>',Nt.push(ue)}}catch(je){console.warn("Archeo Onderzoeken WMS query failed:",je)}continue}if(Wt==="IKAW"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=500,L=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,Y=Math.round(Z.PALETTE_INDEX||Z.palette_index||0),ue=_Se[Y]||`Trefkans onbekend (${Y})`;let he='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';he+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',he+=`<div class="text-sm text-orange-700 mt-1">${ue}</div>`;const Ie={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[Y];Ie&&(he+=`<div class="text-sm ${Ie.kleur} mt-1">${Ie.tekst}</div>`,he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+=`<div class="text-sm text-gray-700 mt-1">${Ie.vondsten}</div>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Nt.push(he)}}catch(je){console.warn("IKAW WMS query failed:",je)}continue}if(Wt==="Inundatiegebieden"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-blue-800">Inundatiegebied</strong>';(Z["linie-naam"]||Z.linie_naam)&&(Y+=`<br/><span class="text-sm font-semibold text-blue-700">${Z["linie-naam"]||Z.linie_naam}</span>`),Z.naam&&(Y+=`<br/><span class="text-sm text-gray-700">${Z.naam}</span>`),Z.periode&&(Y+=`<br/><span class="text-xs text-gray-500">${Z.periode}</span>`),Z.lin_period&&(Y+=`<br/><span class="text-xs text-gray-400">${Z.lin_period}</span>`),Nt.push(Y)}}catch(je){console.warn("Inundatiegebieden WMS query failed:",je)}continue}if(Wt==="Militaire Objecten"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=50,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,Y=Z.obj_soort||"",ue=Z.obj_naam||"",he=Z.lin_period||"",Be=Z["linie-naam"]||Z.linie_naam||"";let Ie=Y||"Militair Object",$e="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",et="";const ft=Y.toLowerCase();ft.includes("fort")?($e="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",et="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):ft.includes("schans")?($e="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",et="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):ft.includes("batterij")||ft.includes("battery")?($e="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",et="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):ft.includes("bunker")||ft.includes("kazemat")?($e="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",et="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):ft.includes("sluis")||ft.includes("inlaatwerk")?($e="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",et="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):ft.includes("toren")||ft.includes("wachttoren")?($e="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",et="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):ft.includes("kazerne")&&($e="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",et="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let Rt=`<strong class="text-stone-800">${Ie}</strong>`;ue&&(Rt+=`<br/><span class="text-sm font-semibold text-stone-700">${ue}</span>`),Be&&(Rt+=`<br/><span class="text-sm text-blue-600">${Be}</span>`),he&&(Rt+=`<br/><span class="text-xs text-gray-500">${he}</span>`),Rt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Rt+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,et&&(Rt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Rt+=`<div class="text-sm text-gray-700 mt-1">${et}</div>`),Rt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Rt+='<div class="text-sm text-gray-700 mt-1">',Rt+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',Rt+="</div>",Nt.push(Rt)}}catch(je){console.warn("Militaire Objecten WMS query failed:",je)}continue}if(Wt==="Verdedigingslinies"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-amber-800">Verdedigingslinie</strong>';const ue={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},he=Z.naam||Z.lin_naam||"";if(he){Y+=`<br/><span class="text-sm font-semibold text-amber-700">${he}</span>`;const Be=Object.entries(ue).find(([Ie])=>he.toLowerCase().includes(Ie.toLowerCase())||Ie.toLowerCase().includes(he.toLowerCase()));Be&&(Y+=`<br/><span class="text-sm text-gray-700">${Be[1]}</span>`)}Z.lin_period&&(Y+=`<br/><span class="text-xs text-purple-600">${Z.lin_period}</span>`),Z.status&&(Y+=`<br/><span class="text-xs text-gray-400">${Z.status}</span>`),Nt.push(Y)}}catch(je){console.warn("Verdedigingslinies WMS query failed:",je)}continue}if(Wt==="Rijksmonumenten"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=50,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-red-800">Rijksmonument</strong>';(Z.cbsNaam||Z.cbs_naam)&&(Y+=`<br/><span class="text-sm font-semibold">${Z.cbsNaam||Z.cbs_naam}</span>`),Z.hoofdcategorie&&(Y+=`<br/><span class="text-sm text-red-700">${Z.hoofdcategorie}</span>`),Z.subcategorie&&(Y+=`<br/><span class="text-xs text-gray-600">${Z.subcategorie}</span>`),Z.rijksmonumentnummer&&(Y+=`<br/><span class="text-xs text-gray-500">Nr: ${Z.rijksmonumentnummer}</span>`),(Z.bouwjaar||Z.oorspronkelijkebouwjaar)&&(Y+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Z.bouwjaar||Z.oorspronkelijkebouwjaar}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Z.rijksmonumentnummer&&(Y+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${Z.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),Y+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Nt.push(Y)}}catch(je){console.warn("Rijksmonumenten WMS query failed:",je)}continue}if(Wt==="Werelderfgoed"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=500,L=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(Z.siteName||Z.naam)&&(Y+=`<br/><span class="text-sm font-semibold text-cyan-700">${Z.siteName||Z.naam}</span>`),Z.siteDesignation&&(Y+=`<br/><span class="text-xs text-gray-600">${Z.siteDesignation}</span>`),Nt.push(Y)}}catch(je){console.warn("Werelderfgoed WMS query failed:",je)}continue}if(Wt==="Terpen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,Y=Z.naam||Z.NAAM||Z.Naam||"Terp",ue=Z.plaats||Z.PLAATS||Z.Plaats||"";let he=`<strong class="text-orange-800">${Y}</strong>`;ue&&(he+=`<br/><span class="text-sm text-gray-500">${ue}</span>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Een terp is een kunstmatige heuvel. Mensen bouwden deze heuvels om droog te wonen in het vlakke, natte land. Terpen zijn vaak meer dan 2000 jaar oud.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Op en rond terpen worden vaak vondsten gedaan:</div>',he+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',he+="<li>Middeleeuws aardewerk en botten</li>",he+="<li>Munten uit verschillende periodes</li>",he+="<li>Metalen voorwerpen (gespen, fibulae, sieraden)</li>",he+="<li>Soms Romeinse of zelfs prehistorische vondsten</li>",he+="</ul>",he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waarom zijn terpen interessant?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Terpen waren vaak dorpskernen waar mensen eeuwenlang woonden. Door de ophoging bleven veel voorwerpen goed bewaard. Let op: sommige terpen zijn beschermd monument!</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Veel terpen zijn nog zichtbaar in het landschap. Vraag altijd toestemming aan de grondeigenaar voordat je gaat detecteren.</div>',Nt.push(he)}}catch(je){console.warn("Terpen WMS query failed:",je)}continue}if(Wt==="Religieus Erfgoed"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=50,L=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,Y=Z.naam||Z.NAAM||Z.name||Z.NAME||"Onbekend",ue=Z.denominatie||Z.DENOMINATIE||Z.religie||"",he=Z.type||Z.TYPE||Z.functie||"",Be=Z.bouwjaar||Z.BOUWJAAR||Z.jaar||"",Ie=Z.gemeente||Z.GEMEENTE||Z.plaats||"";let $e=`<strong class="text-purple-800">${Y}</strong>`;const et=he.toLowerCase();let ft="Een religieus gebouw of heilige plek.",Rt="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";et.includes("kerk")||et.includes("church")?(ft="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",Rt="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):et.includes("kapel")||et.includes("chapel")?(ft="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",Rt="Devotionalia, munten, kruisjes, rozenkransen"):et.includes("synagoge")?(ft="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",Rt="Munten, knopen, kleine religieuze voorwerpen"):et.includes("klooster")||et.includes("monastery")?(ft="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",Rt="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):et.includes("toren")||et.includes("tower")?(ft="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",Rt="Munten, knopen, bouwmateriaal"):(et.includes("begraafplaats")||et.includes("cemetery"))&&(ft="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",Rt="Detecteren hier niet toegestaan"),ue&&($e+=`<br/><span class="text-sm text-purple-600">${ue}</span>`),he&&($e+=`<br/><span class="text-sm text-gray-600">${he}</span>`),Be&&($e+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Be}</span>`),Ie&&($e+=`<br/><span class="text-xs text-gray-400">${Ie}</span>`),$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${ft}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${Rt}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',et.includes("begraafplaats")?$e+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':$e+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Nt.push($e)}}catch(je){console.warn("Religieus Erfgoed WMS query failed:",je)}continue}if(Wt==="Gewaspercelen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=50,Lt=`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`,L=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Lt}`,Ot=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Lt}`,[W,Z]=await Promise.all([fetch(L),fetch(Ot).catch(()=>null)]),Y=await W.json();if(Y.features&&Y.features.length>0){const ue=Y.features[0].properties;let he='<strong class="text-green-800">Landbouwperceel</strong>';if((ue.gewas||ue.gewasnaam)&&(he+=`<br/><span class="text-sm font-semibold text-green-700">${ue.gewas||ue.gewasnaam}</span>`),(ue.categorie||ue.category)&&(he+=`<br/><span class="text-xs text-gray-600">${ue.categorie||ue.category}</span>`),ue.oppervlakte&&(he+=`<br/><span class="text-xs text-gray-500">${ue.oppervlakte} ha</span>`),Z)try{const Be=await Z.json();if(Be.features&&Be.features.length>0){const Ie=Be.features[0].properties,$e=Ie.first_soilname||Ie.soilname||Ie.bodemtype,et=Ie.first_soilcode||Ie.soilcode||Ie.maparea_soilcode;if($e){he+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${$e}</span>`;const ft=U5($e,et);ft.length>0&&(he+=`<br/><span class="text-xs text-gray-500 italic">${ft.join("  ")}</span>`)}}}catch{}Nt.push(he)}}catch(je){console.warn("BRP Gewaspercelen WMS query failed:",je)}continue}if(Wt==="Kadastrale Grenzen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=20,L=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,Y=Z.kadastraleGemeenteWaarde||Z.kadastrale_gemeente_waarde||Z.kadastraleGemeente||ySe[String(Z.kadastraleGemeenteCode)]||Z.kadastraleGemeenteCode,ue=Z.sectie||Z.Sectie||"",he=Z.perceelnummer||Z.perceelNummer||Z.Perceelnummer||"",Be=Z.kadastraleGrootteWaarde||Z.kadastrale_grootte_waarde||Z.kadastraleGrootte||Z.oppervlakte,Ie=Z.AKRKadastraleGemeenteCodeWaarde||Z.akrKadastraleGemeenteCodeWaarde||"",$e=[Y,ue,he].filter(Boolean).join(" "),et=Ie&&ue&&he?`${Ie}-${ue}-${he}`:"";let ft='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if($e&&(ft+=`<br/><span class="text-sm text-indigo-700">${$e}</span>`),et&&(ft+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${et}</span>`),Be){const Rt=typeof Be=="number"?Be:parseFloat(Be);isNaN(Rt)||(ft+=`<br/><span class="text-xs text-gray-600">${Rt.toLocaleString("nl-NL")} m</span>`)}ft+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Nt.push(ft)}}catch(je){console.warn("Kadastrale Grenzen WMS query failed:",je)}continue}if(Wt==="Scheepswrakken"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-cyan-800">Scheepswrak</strong>';(Z.naam||Z.NAAM)&&(Y+=`<br/><span class="text-sm font-semibold text-cyan-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(Y+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.datering||Z.DATERING)&&(Y+=`<br/><span class="text-xs text-gray-500">Datering: ${Z.datering||Z.DATERING}</span>`),(Z.bron||Z.BRON)&&(Y+=`<br/><span class="text-xs text-gray-400">${Z.bron||Z.BRON}</span>`),Nt.push(Y)}}catch(je){console.warn("Scheepswrakken WMS query failed:",je)}continue}if(Wt==="Woonheuvels ZH"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-orange-800">Woonheuvel</strong>';(Z.naam||Z.NAAM)&&(Y+=`<br/><span class="text-sm font-semibold text-orange-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(Y+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),Nt.push(Y)}}catch(je){console.warn("Woonheuvels WMS query failed:",je)}continue}if(Wt==="Romeinse Forten"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-red-800">Romeins Fort</strong>';(Z.naam||Z.NAAM)&&(Y+=`<br/><span class="text-sm font-semibold text-red-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(Y+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.periode||Z.PERIODE)&&(Y+=`<br/><span class="text-xs text-gray-500">${Z.periode||Z.PERIODE}</span>`),Nt.push(Y)}}catch(je){console.warn("Romeinse Forten WMS query failed:",je)}continue}if(Wt==="Windmolens"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=50,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-amber-800">Windmolen</strong>';(Z.naam||Z.NAAM)&&(Y+=`<br/><span class="text-sm font-semibold text-amber-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE||Z.functie||Z.FUNCTIE)&&(Y+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE||Z.functie||Z.FUNCTIE}</span>`),(Z.bouwjaar||Z.BOUWJAAR)&&(Y+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Z.bouwjaar||Z.BOUWJAAR}</span>`),Nt.push(Y)}}catch(je){console.warn("Windmolens WMS query failed:",je)}continue}if(Wt==="Erfgoedlijnen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-purple-800">Erfgoedlijn</strong>';(Z.naam||Z.NAAM||Z.erfgoedlijn)&&(Y+=`<br/><span class="text-sm font-semibold text-purple-700">${Z.naam||Z.NAAM||Z.erfgoedlijn}</span>`),(Z.type||Z.TYPE)&&(Y+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.omschrijving||Z.OMSCHRIJVING)&&(Y+=`<br/><span class="text-xs text-gray-500">${Z.omschrijving||Z.OMSCHRIJVING}</span>`),Nt.push(Y)}}catch(je){console.warn("Erfgoedlijnen WMS query failed:",je)}continue}if(Wt==="Oude Kernen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-stone-800">Historische Kern</strong>';(Z.naam||Z.NAAM)&&(Y+=`<br/><span class="text-sm font-semibold text-stone-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(Y+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.periode||Z.PERIODE)&&(Y+=`<br/><span class="text-xs text-gray-500">${Z.periode||Z.PERIODE}</span>`),Nt.push(Y)}}catch(je){console.warn("Oude Kernen WMS query failed:",je)}continue}if(Wt==="Relictenkaart Punten"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,Y={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},ue=Z.type?.replace(/[0-9]/g,"")||"",he=Y[ue]||Z.type||"Cultuurhistorisch object";let Be='<strong class="text-emerald-800">Relict</strong>';Be+=`<br/><span class="text-sm font-semibold text-emerald-700">${he}</span>`,Z.type&&ue!==Z.type&&(Be+=`<br/><span class="text-xs text-gray-500">Code: ${Z.type}</span>`),Z.streek&&(Be+=`<br/><span class="text-xs text-gray-400">Streek: ${Z.streek}</span>`),Nt.push(Be)}}catch(je){console.warn("Relictenkaart Punten WMS query failed:",je)}continue}if(Wt==="Relictenkaart Lijnen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,ue={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[Z.klasse]||`Historisch lijnrelict (${Z.klasse})`;let he='<strong class="text-teal-800">Lijnrelict</strong>';he+=`<br/><span class="text-sm font-semibold text-teal-700">${ue}</span>`,Nt.push(he)}}catch(je){console.warn("Relictenkaart Lijnen WMS query failed:",je)}continue}if(Wt==="Relictenkaart Vlakken"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=100,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,ue={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[Z.klasse]||`Historisch landschap (${Z.klasse})`;let he='<strong class="text-lime-800">Landschapsrelict</strong>';if(he+=`<br/><span class="text-sm font-semibold text-lime-700">${ue}</span>`,Z.st_area_shape_){const Be=(Z.st_area_shape_/1e4).toFixed(1);he+=`<br/><span class="text-xs text-gray-500">${Be} ha</span>`}Nt.push(he)}}catch(je){console.warn("Relictenkaart Vlakken WMS query failed:",je)}continue}if(Wt==="Verdronken Dorpen"){try{const je=Tn(xt),be=bn("EPSG:4326","EPSG:28992",je),_e=200,L=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${be[0]-_e},${be[1]-_e},${be[0]+_e},${be[1]+_e}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let Y='<strong class="text-blue-800">Verdronken Dorp</strong>';(Z.naam||Z.NAAM)&&(Y+=`<br/><span class="text-sm font-semibold text-blue-700">${Z.naam||Z.NAAM}</span>`),(Z.verdronken||Z.VERDRONKEN||Z.jaar||Z.JAAR)&&(Y+=`<br/><span class="text-xs text-gray-600">Verdronken: ${Z.verdronken||Z.VERDRONKEN||Z.jaar||Z.JAAR}</span>`),(Z.gemeente||Z.GEMEENTE)&&(Y+=`<br/><span class="text-xs text-gray-500">${Z.gemeente||Z.GEMEENTE}</span>`),(Z.bron||Z.BRON)&&(Y+=`<br/><span class="text-xs text-gray-400">${Z.bron||Z.BRON}</span>`),Nt.push(Y)}}catch(je){console.warn("Verdronken Dorpen WMS query failed:",je)}continue}const fs=Kr.getFeatureInfoUrl(xt,nn,"EPSG:3857",{INFO_FORMAT:"application/json"});if(fs)try{const be=await(await fetch(fs)).json();if(be.features&&be.features.length>0){const _e=be.features[0].properties;if(Wt==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const Z=_e.value_list??_e.GRAY_INDEX??_e.value??_e.gray_index??_e.dtm_05m??_e.DTM_05M??_e.hoogte??_e.HOOGTE??_e.elevation??_e.ELEVATION;if(Z!=null&&!isNaN(Number(Z))){const Y=typeof Z=="number"?Z.toFixed(2):Number(Z).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${Y} m NAP</span>`,Nt.push(W)}else{let Y=!1;const ue=["geometry","id","fid","gml_id","bbox"];for(const[he,Be]of Object.entries(_e))!ue.includes(he.toLowerCase())&&Be!==null&&Be!==""&&(W+=`<br/><span class="text-xs text-gray-600">${he}: ${Be}</span>`,Y=!0);Y&&Nt.push(W)}continue}if(Wt==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',Z=!1;const Y=_e.landform_subgroup_description,ue=_e.relief_klasse,he=_e.relief_subklasse,Be=_e.genese_description,Ie=_e.active_process;if(Y&&(W+=`<br/><span class="text-sm text-green-700">${Y}</span>`,Z=!0),ue){const $e=he&&he!==ue?`${ue} (${he})`:ue;W+=`<br/><span class="text-xs text-gray-600">Relief: ${$e}</span>`,Z=!0}if(Be&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Be}</span>`,Z=!0),Ie&&Ie!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${Ie}</span>`,Z=!0),!Z){const $e=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[et,ft]of Object.entries(_e))!$e.includes(et.toLowerCase())&&ft!==null&&ft!==""&&!et.includes("validfrom")&&!et.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${et}: ${ft}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Nt.push(W);continue}let Lt=`<strong>${Wt}</strong>`;const L=_e.first_soilname||_e.soilname,Ot=_e.soilcode||_e.first_soilcode;if(L&&(Lt+=`<br/><span class="text-sm text-amber-700">${L}</span>`,Wt==="Bodemkaart")){const W=U5(L,Ot);W.length>0&&(Lt+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(_e.soilslope&&_e.soilslope!=="Niet opgenomen"&&(Lt+=`<br/><span class="text-xs text-gray-500">Helling: ${_e.soilslope}</span>`),!L){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[Z,Y]of Object.entries(_e))!W.includes(Z)&&Y&&Y!=="Niet opgenomen"&&(Lt+=`<br/><span class="text-xs text-gray-600">${Z}: ${Y}</span>`)}Nt.push(Lt)}}catch(je){console.warn("WMS GetFeatureInfo failed:",je)}}return Nt},Fn=async xt=>{const nn=[],Nt=[],cr=be=>{if(!be)return;const _e=be.getType(),L=be.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:_e,coordinates:L}},_i=pSe(xt.coordinate),Kr=[];n.forEachFeatureAtPixel(xt.pixel,be=>{Kr.push(be)});for(const be of Kr){const _e=be.getProperties(),{geometry:Lt,...L}=_e;if(L.vondst){const Y=L.vondst,ue=`<strong>${Y.objectType}</strong>
            <div data-vondst-id="${Y.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${Y.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${Y.period}</span>
            ${Y.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${Y.depth} cm</span>`:""}
            ${Y.condition&&Y.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${Y.condition}</span>`:""}
            ${Y.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${Y.weight} gram</span>`:""}
            ${Y.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${Y.notes}</span>`:""}
            ${Y.photoUrl?`<br/><a href="${Y.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(Y.timestamp).toLocaleDateString("nl-NL")}</span>`;nn.push(ue),Nt.push(null),M(Y.id);continue}if(L.layerType==="customPoint"&&L.customPoint){const Y=L.customPoint,ue=L.customLayerName||"Mijn Laag",he=L.customLayerColor||"#f97316";let Be="";if(Y.popupContent?(Be=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${he}"></span>
              <span class="text-xs font-medium" style="color: ${he}">${ue}</span>
            </div>`,Be+=Y.popupContent):(Be=`<strong>${Y.name}</strong>`,Be+=`<br/><span class="text-xs text-gray-500">${ue}</span>`,Y.category&&Y.category!=="Overig"&&(Be+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${Y.category}</span>`)),Y.photos&&Y.photos.length>0){Be+='<div class="flex flex-wrap gap-1 my-2">';for(const Ie of Y.photos.slice(0,3)){const $e=Ie.thumbnailUrl||Ie.thumbnailBase64;$e&&(Be+=`<img src="${$e}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}Y.photos.length>3&&(Be+=`<span class="text-xs text-gray-400 self-end">+${Y.photos.length-3} meer</span>`),Be+="</div>"}Y.notes&&!Y.popupContent&&(Be+=`<br/><span class="text-sm text-gray-600 mt-1">${Y.notes}</span>`),Y.url&&(Be+=`<br/><a href="${Y.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Be+=`<br/><span class="text-xs text-gray-400">${new Date(Y.createdAt).toLocaleDateString("nl-NL")}</span>`,nn.push(Be),Nt.push(null);continue}if(L.layerType==="importedLayer"){const Y=L.layerName||"Gemporteerde laag",ue=L.layerColor||"#8b5cf6",he=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Be=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.description||"Feature";let Ie=`<strong style="color: ${ue}">${Be}</strong>`;Ie+=`<br/><span class="text-xs text-gray-500">${Y}</span>`;const $e=Object.entries(L).filter(([et])=>!he.includes(et)&&et!=="name"&&et!=="Name");if($e.length>0){Ie+='<div class="mt-2 space-y-1">';for(const[et,ft]of $e)if(ft!=null&&ft!==""){const Rt=et.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,mr=>mr.toUpperCase());let cn=String(ft);cn.length>200&&(cn=cn.substring(0,200)+"..."),cn.startsWith("http://")||cn.startsWith("https://")?Ie+=`<div class="text-sm"><span class="text-gray-500">${Rt}:</span> <a href="${cn}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Ie+=`<div class="text-sm"><span class="text-gray-500">${Rt}:</span> <span class="text-gray-700">${cn}</span></div>`}Ie+="</div>"}nn.push(Ie),Nt.push({geometry:cr(Lt),properties:L,popupHtml:Ie});continue}if(L.kwaliteitswaarde&&L.kwaliteitswaarde.includes("archeologische waarde")){const Y=mt(L);nn.push(Y),Nt.push({geometry:cr(Lt),properties:L,popupHtml:Y});continue}if(L.layerType==="romeinsFort"||L.layerType==="romeinsFortLijn"){const Y=L.Name||L.name||"",ue=L.description||"",he=dSe[Y]||null,Be=he||fSe;let Ie=`<strong class="text-red-800">${he?Be.naam:Y||"Romeins Fort"}</strong>`;he?.latinNaam&&he.latinNaam!==Be.naam&&(Ie+=`<br/><span class="text-sm text-red-600 italic">${he.latinNaam}</span>`),Ie+=`<br/><span class="text-sm text-gray-600">${gSe[Be.type]||Be.type}</span>`,Ie+=`<br/><span class="text-xs text-gray-500">${Be.periode}</span>`,L.layerType==="romeinsFortLijn"&&(Ie+='<br/><span class="text-xs text-red-700 mt-1"> Gereconstrueerde fortomtrek</span>'),Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over dit fort</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Be.beschrijving}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat was hier?</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Be.watWasHier}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is er nu nog te zien?</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Be.watTeZien}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Be.verwachteVondsten}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Historische betekenis</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Be.betekenis}</div>`,he?.bronnen&&he.bronnen.length>0?(Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Ie+='<div class="text-sm text-gray-700 mt-1">',he.bronnen.forEach($e=>{const et=$e.replace(/^https?:\/\//,"").split("/")[0];Ie+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline block">${et}</a>`}),Ie+="</div>"):(Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Ie+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Limes_(Romeinse_Rijk)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Romeinse Limes</a></div>'),!he&&ue&&(Ie+=`<div class="mt-3"><span class="text-xs text-gray-500 italic">${ue}</span></div>`),nn.push(Ie),Nt.push({geometry:cr(Lt),properties:L,popupHtml:Ie});continue}let Ot=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.route_name||L.road_name;Ot||(L.leisure==="playground"?Ot="Speeltuin":L.leisure==="park"?Ot="Park":L.leisure==="swimming_area"||L.sport==="swimming"?Ot="Zwemplek":L.tourism==="museum"?Ot="Museum":L.amenity==="cafe"||L.amenity==="restaurant"?Ot=L.amenity==="cafe"?"Caf":"Restaurant":L.historic==="castle"?Ot="Kasteel":Ot="Info"),(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats")))&&(Ot="Bunker"),L.historic==="battlefield"&&(Ot="Historisch slagveld");let W=`<strong>${Ot}</strong>`;if(L.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${L.category}</span>`),L.from_to&&L.from_to!==Ot&&(W+=`<br/><span class="text-sm text-gray-600">${L.from_to}</span>`),L.route&&L.route!==Ot&&(W+=`<br/><span class="text-sm text-gray-600">${L.route}</span>`),L.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${L.TOPONIEM}</span>`,L.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${L.PLAATS}</span>`)),(L.AARD_VINDP||L.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${L.AARD_VINDP||L.Aard_vindp}</span>`),L.BEGIN_PER&&L.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.BEGIN_PER} - ${L.EIND_PER}</span>`),(L.AARD_OPM||L.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${L.AARD_OPM||L.Aard_opmer}</span>`),L.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${L.Gemeente}</span>`),L.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${L.Bron}</span>`),L.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${L.Bron_besch}</span>`),L.Dat_st_z&&L.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${L.Dat_st_z} - ${L.Dat_ei_z}</span>`),L.Begin&&L.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.Begin} - ${L.Einde}</span>`),L.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${L.Uiterwaard}</span>`),L.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${L.rivier}</span>`),L.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${L.Beschrijvi}</span>`),L.leisure&&L.name){const Y=L.leisure==="playground"?"Speeltuin":L.leisure==="park"?"Park":L.leisure==="swimming_area"?"Zwemplek":null;Y&&(W+=`<br/><span class="text-xs text-green-600">${Y}</span>`)}if((L.tourism==="museum"||L.museum)&&L.name&&(W+='<br/><span class="text-xs text-purple-600">Museum</span>'),(L.leisure==="swimming_area"||L.sport==="swimming")&&L.name&&(W+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),L.osm_id&&L.address!==void 0&&(W+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',L.address&&(W+=`<br/><span class="text-xs text-gray-500">${L.address}</span>`),L.phone&&(W+=`<br/><span class="text-xs text-gray-600">${L.phone}</span>`)),L.site_type==="tumulus"){const Y=be.getGeometry()?.getCoordinates();let ue="",he="";if(Y){const Be=Tn(Y),Ie=Be[0],$e=Be[1];Ie>5.5&&Ie<6.3&&$e>52&&$e<52.5?(ue="Veluwe",he="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Ie>6.2&&Ie<7.1&&$e>52.6&&$e<53.3?(ue="Drenthe",he="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Ie>4.5&&Ie<6&&$e>51.3&&$e<51.9?(ue="Noord-Brabant",he="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Ie>5.5&&Ie<6.3&&$e>50.7&&$e<51.6?(ue="Limburg",he="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Ie>5&&Ie<5.6&&$e>52&&$e<52.4&&(ue="Utrechtse Heuvelrug",he="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ue&&(W+=`<br/><span class="text-sm text-gray-500">${ue}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',he&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',L.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${L.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(L.historic==="castle"||L.castle_type){const Y={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ue=L.castle_type?Y[L.castle_type]:null,he=ue?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-600">${he}</span>`,L.start_date&&(W+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${L.start_date}</span>`),L.heritage&&(W+='<br/><span class="text-sm text-amber-600">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ue?W+=`<div class="text-sm text-gray-700 mt-1">${ue.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ue?W+=`<div class="text-sm text-gray-700 mt-1">${ue.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',L.wikipedia||L.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',L.wikipedia){const Be=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Be}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}L.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(L.historic==="ruins"){const Y=L.ruins_type||"";let ue="Rune",he="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Be="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(Y.toLowerCase().includes("church")||Y.toLowerCase().includes("kerk")?(ue="Kerkrune",he="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Be="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):Y.toLowerCase().includes("castle")||Y.toLowerCase().includes("kasteel")?(ue="Kasteelrune",he="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Be="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):Y.toLowerCase().includes("mill")||Y.toLowerCase().includes("molen")?(ue="Molenrune",he="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Be="Gereedschap, munten, huishoudelijke voorwerpen"):Y.toLowerCase().includes("fort")&&(ue="Fortrune",he="De overblijfselen van een militair fort of verdedigingswerk.",Be="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-gray-600">${ue}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Be}</div>`,L.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.wikipedia){const Ie=L.wikipedia.startsWith("http")?L.wikipedia:`https://${L.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${L.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Ie}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats"))){const Y={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ue=L.name||"",he=L.bunker_type?Y[L.bunker_type]||L.bunker_type:"";ue&&ue!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${ue}</span>`),he&&he!==ue&&(W+=`<br/><span class="text-xs text-gray-500">${he}</span>`);const Be=be.getGeometry()?.getCoordinates();let Ie="",$e="",et="";if(Be){const ft=Tn(Be),Rt=ft[0],cn=ft[1],mr=Rt<4.8||Rt<5.2&&cn>51.8&&cn<53.5,pn=Rt>4.2&&Rt<4.4&&cn>52&&cn<52.15,pr=Rt>4.5&&Rt<4.7&&cn>52.4&&cn<52.5,Tr=Rt>4&&Rt<4.2&&cn>51.95&&cn<52.05,Ki=Rt<4.2&&cn<51.6,B=Rt>5.2&&Rt<5.8&&cn>51.9&&cn<52.3;pn?(Ie="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",$e="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",et="Atlantikwall Museum Scheveningen"):pr?(Ie="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",$e="https://www.bunkermuseum.nl/",et="Bunkermuseum IJmuiden"):Tr?(Ie="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",$e="https://www.atlantikwallhoekvanholland.nl/",et="Atlantikwall Hoek van Holland"):Ki?(Ie="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",$e="https://www.bunkermuseumzoutelande.nl/",et="Bunkermuseum Zoutelande"):mr?(Ie="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="Atlantikwall (Wikipedia)"):B?(Ie="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",$e="https://nl.wikipedia.org/wiki/Grebbelinie",et="Grebbelinie (Wikipedia)"):(Ie="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)")}else Ie="Een bunker uit de Tweede Wereldoorlog.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ie}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${et}</a>`,L.website?W+=`<br/><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(L.historic==="battlefield"){const Y=L.name||"Onbekend slagveld",he={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[Y];if(Y!=="Onbekend slagveld"&&Y!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${Y}</span>`),he)W+=`<br/><span class="text-xs text-gray-500">${he.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${he.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,Y.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),Y.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(L.date&&(W+=`<br/><span class="text-xs text-gray-500">${L.date}</span>`),L.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),L.wikipedia){const Be=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Be}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bron==="Paleobiology Database"){const Y=Ie=>{const $e={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[et,ft]of Object.entries($e))if(Ie.toLowerCase().includes(et.toLowerCase()))return ft;return""},ue=Ie=>{const $e={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[et,ft]of Object.entries($e))if(Ie.toLowerCase().includes(et.toLowerCase()))return ft;return""},he=Ie=>{const $e={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let et=Ie;for(const[ft,Rt]of Object.entries($e))et=et.replace(new RegExp(ft,"gi"),Rt);return et},Be=Ie=>{const $e={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let et=Ie;for(const[ft,Rt]of Object.entries($e))et=et.replace(new RegExp(ft,"gi"),Rt);return et};if(L.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${L.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',L.taxonomie&&L.taxonomie!=="Onbekend"){const Ie=Y(L.taxonomie);Ie?(W+=`<div class="text-sm text-gray-700 mt-1">${Ie}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${L.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${L.taxonomie}</div>`}if(L.aantal_fossielen){const Ie=parseInt(L.aantal_fossielen),$e=Ie>100?"Veel fossielen gevonden op deze locatie.":Ie>10?"Meerdere fossielen gevonden op deze locatie.":`${L.aantal_fossielen} fossiel${Ie>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${$e}</div>`}if(L.periode&&L.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Ie=ue(L.periode);W+=`<div class="text-sm text-gray-700 mt-1">${L.periode}</div>`,Ie&&(W+=`<div class="text-sm text-gray-600">${Ie}</div>`),L.ouderdom&&L.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${L.ouderdom}</div>`)}(L.gesteente||L.formatie||L.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',L.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${he(L.gesteente)}</div>`),L.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${L.formatie}</div>`,L.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${L.lid}</div>`)),L.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${Be(L.milieu)}</div>`))}if(L.layerType==="fossielHotspot"){const Y=[];if(L.type&&Y.push(L.type),L.region&&Y.push(L.region),L.country){const ue={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Y.push(ue[L.country]||L.country)}if(Y.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Y.join("  ")}</span>`),(L.finds||L.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${L.period}</div>`),L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const he=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="mineralenHotspot"){const Y=[];if(L.region&&Y.push(L.region),L.country){const ue={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Y.push(ue[L.country]||L.country)}if(Y.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Y.join("  ")}</span>`),L.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.minerals}</div>`,L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const he=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")||L.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="goudrivier"){const Y=[];if(L.river&&Y.push(L.river),L.region&&Y.push(L.region),L.country){const ue={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Y.push(ue[L.country]||L.country)}if(Y.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Y.join("  ")}</span>`),(L.goldType||L.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.goldType}</div>`),L.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${L.origin}</div>`)),L.legal||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',L.legal){const he=L.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${L.legal}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="wandelroute"){const Y=[];if(L.region&&Y.push(L.region),L.country){const ue={NL:"Nederland",BE:"Belgi"};Y.push(ue[L.country]||L.country)}if(Y.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Y.join("  ")}</span>`),L.distance||L.duration){const ue=L.distance?`${L.distance} km`:"",he=L.duration?`${L.duration}`:"",Be=[ue,he].filter(Boolean).join("  ");Be&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${Be}</span>`)}(L.description||L.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${L.highlights}</div>`)),L.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.startAddress}</div>`),L.url&&(W+=`<div class="mt-3"><a href="${L.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(L.layerType==="hunebed"){L.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`);const Y=[];if(L.stones){const ue=L.stones.toLowerCase(),he=ue.match(/(\d+)\s*dekst[^\s,]*/i),Be=ue.match(/(\d+)\s*draagst[^\s,]*/i),Ie=ue.match(/(\d+)\s*sluitst[^\s,]*/i),$e=ue.match(/(\d+)\s*poortst[^\s,]*/i),et=ue.match(/(\d+)\s*gangdekst[^\s,]*/i),ft=ue.match(/(\d+)\s*gangzijst[^\s,]*/i);he&&Y.push(`${he[1]} deksteen${parseInt(he[1])>1?"en":""} (de grote steen${parseInt(he[1])>1?"en":""} bovenop)`),Be&&Y.push(`${Be[1]} draagstenen (de stenen die de dekstenen dragen)`),Ie&&Y.push(`${Ie[1]} sluitsteen${parseInt(Ie[1])>1?"en":""} (afsluiting aan de korte zijden)`),$e&&Y.push(`${$e[1]} poortsteen${parseInt($e[1])>1?"en":""} (bij de ingang)`),et&&Y.push(`${et[1]} gangdeksteen${parseInt(et[1])>1?"en":""} (boven de toegangsgang)`),ft&&Y.push(`${ft[1]} gangzijstenen (langs de toegangsgang)`)}if(L.length&&Y.push(`Een grafkamer van ${L.length} lang`),L.width&&Y.push(`${L.width}`),Y.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',Y.forEach(ue=>{W+=`<li>${ue}</li>`}),W+="</ul>"),L.notable){const ue=L.notable.toLowerCase();let he="Wat is hier bijzonder?";ue.includes("grootste")?he="Waarom is dit het grootste hunebed?":ue.includes("klein")||ue.includes("kindhunebed")?he="Waarom is dit hunebed zo klein?":ue.includes("cluster")||ue.includes("naast elkaar")?he="Waarom liggen hier meerdere hunebedden?":(ue.includes("enige")||ue.includes("westelijk")||ue.includes("noordelijk"))&&(he="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${he}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${L.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',L.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',L.access?W+=`<div class="text-sm text-gray-700 mt-1">${L.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',L.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${L.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((L.inventarisnummer||L.locatie_naam)&&(L.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${L.locatie_naam}</span>`),L.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${L.inventarisnummer}</span>`),L.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${L.datering_tekst}</span>`)),(L.veensoort||L.dikte)&&(L.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${L.veensoort}</span>`),L.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${L.dikte}</span>`)),L.nature&&L.debut){W+=`<br/><span class="text-sm text-purple-700">${L.nature}</span>`;const Y=L.debut===L.fin?L.debut:`${L.debut} - ${L.fin}`;Y&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${Y}</span>`),L.structure&&(W+=`<br/><span class="text-xs text-gray-600">${L.structure}</span>`),L.commune&&(W+=`<br/><span class="text-xs text-gray-500">${L.commune}</span>`),L.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${L.decouvert}</span>`),L.numero&&(W+=`<br/><span class="text-xs text-gray-400">${L.numero}</span>`)}if((L.NATURE_OPE||L.CODE_OPERA)&&(L.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${L.TITRE}</span>`),L.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${L.NATURE_OPE}</span>`),L.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${L.AUTEUR}</span>`),L.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.DATE}</span>`),L.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${L.COMMUNE}</span>`)),L.type_protection&&(L.n_site||L.t_site)){const Y=L.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${Y}">${L.type_protection}</span>`,L.n_site&&(W+=`<br/><span class="text-sm font-semibold">${L.n_site}</span>`),L.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${L.t_site}</span>`),L.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${L.c_site}</span>`),L.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${L.d_creation}</span>`)}if(L.type_protection&&L.cod_diren){const Y=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${Y}">${L.type_protection}</span>`,L.proced&&(W+=`<br/><span class="text-xs text-gray-600">${L.proced}</span>`),L.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.d_proced}</span>`),L.comment){const ue=String(L.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ue}${String(L.comment).length>150?"...":""}</span>`}}if(L.type_protection&&L.nomsite){const Y=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${Y}">${L.type_protection}</span>`,L.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${L.caractere}</span>`),L.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.datedecis}</span>`),L.descriptio){const ue=String(L.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ue}${String(L.descriptio).length>150?"...":""}</span>`}}if(L.secteur&&L.style){if(W+=`<br/><span class="text-sm text-gray-700">${L.secteur}</span>`,L["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${L["sous-secteur"]}</span>`),L.description){const Y=String(L.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${Y}${String(L.description).length>150?"...":""}</span>`}L.url&&(W+=`<br/><a href="${L.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(L.nature_operation||L.synthese){L.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${L.nature_operation}</span>`),L.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${L.responsable_operation}</span>`),L.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.date_operation}</span>`);const Y=[];if(L.prehistoire==="Oui"&&Y.push("Prehistorie"),L.protohistoire==="Oui"&&Y.push("Protohistorie"),L.antiquite==="Oui"&&Y.push("Romeins"),L.moyen_age==="Oui"&&Y.push("Middeleeuwen"),L.temps_modernes==="Oui"&&Y.push("Moderne tijd"),Y.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${Y.join(", ")}</span>`),L.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${L.adresse}</span>`),L.synthese){const ue=String(L.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${ue}${String(L.synthese).length>200?"...":""}</span>`}}if(L.operator&&(W+=`<br/><span class="text-sm text-gray-600">${L.operator}</span>`),L.opening_hours){const Y=mSe(String(L.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${Y}</span>`}if(L.website&&(W+=`<br/><a href="${L.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),L.addr_street){const Y=[L.addr_street,L.addr_housenumber,L.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${Y}</span>`}const Z=L.description||L.omschrijving||L.descr||L.info;Z&&Z!==Ot&&(W+=`<br/><span class="text-sm text-gray-600">${Z}</span>`),nn.push(W),Nt.push({geometry:cr(Lt),properties:L,popupHtml:W})}const Wt=n.getView().getResolution()||1,fs=await Ut(xt.coordinate,Wt);nn.push(...fs);for(const be of fs)Nt.push(null);const je=await _i;if(nn.length===0&&je!==null){const be=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
          </div>`;nn.push(be),Nt.push(null)}if(nn.length>0&&je!==null&&(nn[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
        </div>`),nn.length>0){l(nn),V(Nt),h(0),console.log(` KLIK OPGESLAGEN: [${xt.coordinate[0].toFixed(0)}, ${xt.coordinate[1].toFixed(0)}]`),x(xt.coordinate),E(!1),N(!1),ce(!1),Se(""),z(null);const be=Tn(xt.coordinate);Re(be),R(`https://www.google.com/maps/dir/?api=1&destination=${be[1]},${be[0]}`),m(!0)}};return n.on("click",Fn),()=>{n.un("click",Fn)}},[n]);const rn=()=>{m(!1),n&&v&&(kA(n),E(!1))},rr=(mt,Ut)=>{Ut.offset.y>100&&rn()};return g.jsx(Un,{children:f&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:rn}),g.jsxs(wt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",style:{fontSize:`${14*ne/100}px`},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:rr,children:[g.jsx("div",{className:"flex justify-center pt-2 pb-1",children:g.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),g.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[Fe&&g.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[g.jsx("button",{onClick:tn,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:g.jsx(mle,{size:18})}),g.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[c+1,"/",o.length]}),g.jsx("button",{onClick:lt,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:g.jsx(pw,{size:18})})]}),g.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:yt||"Info"}),j&&g.jsxs("div",{className:"relative",children:[g.jsx("button",{onClick:()=>N(!k),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${O?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:O?g.jsx(oc,{size:18}):g.jsx($a,{size:18})}),k&&g.jsxs("div",{className:"absolute right-0 top-8 z-50 bg-white rounded-lg shadow-md py-1 min-w-[180px] max-w-[220px]",children:[g.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),g.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(mt=>!mt.archived).map(mt=>g.jsxs("button",{onClick:()=>{const Ut=Q;s(mt.id,{name:yt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:yt,geometry:Ut?.geometry,sourceProperties:Ut?.properties,popupContent:Ut?.popupHtml}),N(!1),z(mt.name),setTimeout(()=>z(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[g.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:mt.color}}),g.jsx("span",{className:"truncate",children:mt.name})]},mt.id))}),g.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Oe?g.jsxs("div",{className:"px-2 py-1",children:[g.jsx("input",{type:"text",value:we,onChange:mt=>Se(mt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:mt=>{if(mt.key==="Enter"&&we.trim()){const Ut=a(we.trim()),Fn=Q;s(Ut,{name:yt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:yt,geometry:Fn?.geometry,sourceProperties:Fn?.properties,popupContent:Fn?.popupHtml}),N(!1),ce(!1),Se(""),z(we.trim()),setTimeout(()=>z(null),2e3)}else mt.key==="Escape"&&(ce(!1),Se(""))}}),g.jsxs("div",{className:"flex gap-1 mt-1",children:[g.jsx("button",{onClick:()=>{if(we.trim()){const mt=a(we.trim()),Ut=Q;s(mt,{name:yt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:yt,geometry:Ut?.geometry,sourceProperties:Ut?.properties,popupContent:Ut?.popupHtml}),N(!1),ce(!1),Se(""),z(we.trim()),setTimeout(()=>z(null),2e3)}},disabled:!we.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),g.jsx("button",{onClick:()=>{ce(!1),Se("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):g.jsxs("button",{onClick:()=>ce(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[g.jsx($a,{size:14}),g.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),P&&g.jsx("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Open in Google Maps","aria-label":"Open in Google Maps",children:g.jsx(U1,{size:18})}),g.jsx("button",{onClick:rn,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:g.jsx(si,{size:18})})]}),g.jsx("div",{className:"px-4 py-3 max-h-[45vh] overflow-y-auto select-text",style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:ln}}),g.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2",children:[g.jsx(oue,{size:14,className:"text-gray-400 flex-shrink-0"}),g.jsx("input",{type:"range",min:"80",max:"150",value:ne,onChange:mt=>me(parseInt(mt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[ne,"%"]})]}),Dn&&A&&!D&&g.jsxs("div",{className:"px-4 pb-4 flex gap-2",children:[g.jsxs("button",{onClick:()=>{const mt=r.find(Ut=>Ut.id===A);mt&&U(mt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[g.jsx(Y0,{size:16}),g.jsx("span",{children:"Bewerken"})]}),g.jsxs("button",{onClick:()=>{e(A),m(!1),M(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[g.jsx(mc,{size:16}),g.jsx("span",{children:"Verwijderen"})]})]}),D&&g.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3",children:[g.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),g.jsx("input",{type:"text",value:D.objectType,onChange:mt=>U({...D,objectType:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),g.jsx("input",{type:"text",value:D.material,onChange:mt=>U({...D,material:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),g.jsx("input",{type:"text",value:D.period,onChange:mt=>U({...D,period:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),g.jsx("textarea",{value:D.notes,onChange:mt=>U({...D,notes:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{onClick:()=>U(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),g.jsx("button",{onClick:()=>{t(D.id,{objectType:D.objectType,material:D.material,period:D.period,notes:D.notes}),U(null),m(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),kt&&y&&g.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:v?g.jsxs("button",{onClick:hn,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[g.jsx(q0,{size:16}),g.jsx("span",{children:"Hoogtekaart verbergen"})]}):g.jsx("button",{onClick:nr,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?g.jsxs(g.Fragment,{children:[g.jsx(bC,{size:16,className:"animate-spin"}),g.jsx("span",{children:"Laden..."})]}):g.jsxs(g.Fragment,{children:[g.jsx(q0,{size:16}),g.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const z5=1e-4;function vSe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<z5&&i<z5})}function ESe(){const n=pi(k=>k.map),e=wr(k=>k.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=wr(),s=cs(k=>k.layers),[a,o]=X.useState(null),[l,c]=X.useState(!1),[h,f]=X.useState(!1),[m,y]=X.useState(!1),x=X.useRef(null),v=X.useRef(null);X.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const k=n.getViewport();if(!k){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",k);const N=600,O=15,z=we=>{if(console.log(" Touch start, touches:",we.touches.length),we.touches.length!==1)return;const Se=we.touches[0];v.current={x:Se.clientX,y:Se.clientY},console.log(" Starting long press timer at:",v.current),x.current&&clearTimeout(x.current),x.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",v.current),!v.current)return;const se=window.__olMap;if(!se){console.log(" Map not available (global)");return}const V=k.getBoundingClientRect(),Q=[v.current.x-V.left,v.current.y-V.top],ne=se.getCoordinateFromPixel(Q);if(ne){const ie=Tn(ne);we.preventDefault(),o({pixel:[v.current.x,v.current.y],coordinate:ie}),c(!0),f(!1),setTimeout(()=>f(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ie)}},N)},j=we=>{if(!x.current||!v.current)return;const Se=we.touches[0],se=Se.clientX-v.current.x,V=Se.clientY-v.current.y,Q=Math.sqrt(se*se+V*V);Q>O&&(console.log(" Touch moved too much, cancelling. Distance:",Q),clearTimeout(x.current),x.current=null)},Re=()=>{console.log(" Touch end, timer active:",!!x.current),x.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(x.current),x.current=null),v.current=null},Ne=we=>{l&&we.preventDefault()},Ve=we=>{we.button===0&&(console.log(" Mouse down"),v.current={x:we.clientX,y:we.clientY},x.current&&clearTimeout(x.current),x.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!v.current)return;const Se=window.__olMap;if(console.log(" __olMap:",Se),console.log(" __olMap constructor:",Se?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof Se?.getCoordinateAtPixel),!Se){console.log(" Map not available (global)");return}const se=k.getBoundingClientRect(),V=[v.current.x-se.left,v.current.y-se.top];console.log(" Pixel:",V);const Q=Se.getCoordinateFromPixel(V);if(console.log(" Coordinate:",Q),Q){const ne=Tn(Q);o({pixel:[v.current.x,v.current.y],coordinate:ne}),c(!0),f(!1),setTimeout(()=>f(!0),300),console.log(" Long press (mouse) detected at:",ne)}},N))},Oe=we=>{if(!x.current||!v.current)return;const Se=we.clientX-v.current.x,se=we.clientY-v.current.y;Math.sqrt(Se*Se+se*se)>O&&(console.log(" Mouse moved, cancelling"),clearTimeout(x.current),x.current=null)},ce=()=>{console.log(" Mouse up"),x.current&&(clearTimeout(x.current),x.current=null),v.current=null};return k.addEventListener("touchstart",z,{passive:!1}),k.addEventListener("touchmove",j,{passive:!0}),k.addEventListener("touchend",Re),k.addEventListener("touchcancel",Re),k.addEventListener("contextmenu",Ne),k.addEventListener("mousedown",Ve),k.addEventListener("mousemove",Oe),k.addEventListener("mouseup",ce),k.addEventListener("mouseleave",ce),()=>{k.removeEventListener("touchstart",z),k.removeEventListener("touchmove",j),k.removeEventListener("touchend",Re),k.removeEventListener("touchcancel",Re),k.removeEventListener("contextmenu",Ne),k.removeEventListener("mousedown",Ve),k.removeEventListener("mousemove",Oe),k.removeEventListener("mouseup",ce),k.removeEventListener("mouseleave",ce),x.current&&clearTimeout(x.current)}},[n,l]);const E=()=>{h&&(c(!1),o(null),f(!1),y(!1))},T=()=>{c(!1),o(null),f(!1),y(!1)},b=k=>{if(!a)return;const[N,O]=a.coordinate;t(k,{lat:O,lng:N}),T()},A=()=>{r(),T()},M=()=>{if(!a)return;const[k,N]=a.coordinate;e({lat:N,lng:k}),c(!1),o(null),f(!1)},D=()=>{if(!a)return;const[k,N]=a.coordinate,O=`https://www.google.com/maps?q=${N},${k}`;window.open(O,"_blank"),c(!1),o(null),f(!1)},U=()=>{if(!a)return;const k=document.createElement("input");k.type="file",k.accept="image/*",k.capture="environment",k.onchange=async N=>{const O=N.target.files?.[0];if(!O)return;const[z,j]=a.coordinate;e({lat:j,lng:z},O)},k.click(),T()},P=()=>{i(),T()},R=k=>{const[N,O]=k;return`${O.toFixed(5)}N, ${N.toFixed(5)}E`};return g.jsx(Un,{children:l&&a&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:E}),g.jsxs(wt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:Math.min(a.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[g.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[g.jsx(za,{size:16}),g.jsx("span",{className:"text-xs font-mono",children:R(a.coordinate)})]})}),g.jsxs("div",{className:"bg-white",children:[g.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(Iv,{size:20,className:"text-orange-500"}),g.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),g.jsxs("button",{onClick:U,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(mw,{size:20,className:"text-green-500"}),g.jsx("span",{className:"font-medium",children:"Foto maken"})]}),g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>y(!m),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(yo,{size:20,className:"text-purple-500"}),g.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),g.jsx(pw,{size:16,className:`text-gray-400 transition-transform ${m?"rotate-90":""}`})]}),g.jsx(Un,{children:m&&g.jsx(wt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?g.jsxs("button",{onClick:A,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[g.jsx($a,{size:14}),g.jsx("span",{children:"Maak eerst een laag aan"})]}):g.jsxs(g.Fragment,{children:[s.map(k=>{const N=a?vSe(k,a.coordinate):!1;return g.jsxs("button",{onClick:()=>!N&&b(k.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${N?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:N?"Al toegevoegd aan deze laag":void 0,disabled:N,children:[N&&g.jsx(oc,{size:14,className:"text-green-500 flex-shrink-0"}),g.jsx("span",{className:"truncate",children:k.name}),g.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:N?"al toegevoegd":`(${k.points.length})`})]},k.id)}),g.jsxs("button",{onClick:A,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[g.jsx($a,{size:14}),g.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),g.jsxs("button",{onClick:P,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(Lce,{size:20,className:"text-purple-500"}),g.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),g.jsxs("button",{onClick:D,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(U1,{size:20,className:"text-blue-600"}),g.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]})]}),g.jsx("div",{className:"bg-white",children:g.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[g.jsx(si,{size:18}),g.jsx("span",{children:"Annuleren"})]})})]})]})})}const wSe={Compass:Ile,TreePalm:tue,Mountain:q0,Waves:hue,Search:pA,Target:Yce,Layers:yo,Grid:q7},SSe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},TSe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},$5=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],bSe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],ASe=[5.2913,52.1326],RSe=8;function ISe(){const n=Ai(N=>N.setLayerVisibility),e=_s(N=>N.stopTracking),t=pi(N=>N.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=wr(),{presets:a,applyPreset:o,updatePreset:l,createPreset:c,resetToDefaults:h}=f9(),f=Ai(N=>N.visible),m=Gr(N=>N.presetPanelFontScale),y=Gr(N=>N.setPresetPanelFontScale),x=12*m/100,[v,E]=X.useState(null),[T,b]=X.useState(!1),[A,M]=X.useState(""),D=()=>{s(),$5.forEach(N=>n(N,!1)),bSe.forEach(N=>{n(N,N==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:Ir(ASe),zoom:RSe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},U=N=>{o(N),s()},P=(N,O)=>{N.stopPropagation();const z=Object.entries(f).filter(([j,Re])=>Re&&$5.includes(j)).map(([j])=>j);l(O,{layers:z}),E(O),setTimeout(()=>E(null),2e3),console.log(" Lagen opgeslagen naar preset")},R=()=>{A.trim()&&(c(A.trim(),"Layers"),M(""),b(!1))},k=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return g.jsxs(g.Fragment,{children:[g.jsx(wt.button,{onClick:D,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:g.jsx(Sce,{size:20,className:"text-gray-600"})}),g.jsx(wt.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?g.jsx(K7,{size:20,className:"text-blue-600"}):g.jsx(yo,{size:20,className:"text-blue-600"})}),g.jsx(Un,{children:r&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),g.jsxs(wt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[g.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${x}px`},children:[g.jsx("span",{className:"font-medium text-white",children:"Presets"}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:m,onInput:N=>{y(parseInt(N.target.value))},onChange:N=>y(parseInt(N.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${m}%`}),g.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),g.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(N=>{const O=wSe[N.icon]||yo,z=SSe[N.icon]||"text-blue-600",j=TSe[N.icon]||"hover:bg-blue-50",Re=v===N.id;return g.jsxs("button",{onClick:()=>U(N.id),className:`w-full h-8 flex items-center gap-2 px-2 ${j} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${Re?"bg-green-50":""}`,style:{fontSize:`${x}px`},children:[g.jsx(O,{size:14,className:`${z} flex-shrink-0`}),g.jsx("span",{className:"text-gray-700 truncate flex-1",children:N.name}),Re?g.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:g.jsx(oc,{size:14,className:"text-green-500"})}):g.jsx("span",{onClick:Ne=>P(Ne,N.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:g.jsx(Q7,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},N.id)})}),g.jsx("div",{className:"border-t border-gray-200 p-2",children:T?g.jsxs("div",{className:"flex gap-1",children:[g.jsx("input",{type:"text",value:A,onChange:N=>M(N.target.value),onKeyDown:N=>{N.key==="Enter"&&R(),N.key==="Escape"&&b(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${x}px`}}),g.jsx("button",{onClick:R,disabled:!A.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:g.jsx(oc,{size:14})})]}):g.jsxs("div",{className:"flex gap-1",children:[g.jsxs("button",{onClick:()=>b(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${x}px`},children:[g.jsx($a,{size:14}),g.jsx("span",{children:"Nieuwe preset"})]}),g.jsx("button",{onClick:k,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:g.jsx(bce,{size:14})})]})})]})]})})]})}function CSe(){const n=pi(a=>a.map),[e,t]=X.useState(0),[r,i]=X.useState(!1);X.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),c=l*180/Math.PI;t(c),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return g.jsx(Un,{children:r&&g.jsx(wt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:g.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[g.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),g.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),g.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const PSe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],kSe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function MSe(){const[n,e]=X.useState(!1),[t,r]=X.useState(!1),i=Ai(h=>h.visible),s=Ai(h=>h.opacity),a=Ai(h=>h.setLayerOpacity),o=PSe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),c=o.length>3;return g.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[g.jsxs(wt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[g.jsx(Gce,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&g.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),g.jsxs(wt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[g.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),g.jsx("div",{className:"space-y-3",children:l.map(h=>{const f=s[h.name]??h.default;return g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"range",min:"0",max:"100",value:f*100,onChange:m=>a(h.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${kSe[h.color]}`}),g.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(f*100),"%"]})]})]},h.name)})}),c&&g.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?g.jsxs(g.Fragment,{children:[g.jsx(K7,{size:14}),"Minder tonen"]}):g.jsxs(g.Fragment,{children:[g.jsx(wC,{size:14}),o.length-3," meer..."]})})]})]})})]})}function NSe(){const n=pi(A=>A.map),[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState([]),[o,l]=X.useState(!1),[c,h]=X.useState(!1),f=X.useRef(null),m=X.useRef(null),y=X.useRef();X.useEffect(()=>{e&&f.current&&f.current.focus()},[e]),X.useEffect(()=>{if(!e)return;const A=M=>{m.current&&!m.current.contains(M.target)&&x()};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[e]),X.useEffect(()=>{if(!e)return;const A=M=>{M.key==="Escape"&&x()};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[e]),X.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();M.response?.docs&&a(M.response.docs)}catch(A){console.error("Search error:",A),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const x=()=>{t(!1),i(""),a([]),l(!1)},v=async A=>{try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(A)}`)).json();if(D.response?.docs?.[0]?.centroide_ll){const P=D.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(P)return{lng:parseFloat(P[1]),lat:parseFloat(P[2])}}}catch(M){console.error("Lookup error:",M)}return null},E=async A=>{if(!n)return;const M=await v(A.id);M&&n.getView().animate({center:Ir([M.lng,M.lat]),zoom:16,duration:1e3}),x()},T=async(A,M)=>{M.stopPropagation();const D=await v(A.id);if(D){const U=`https://www.google.com/maps?q=${D.lat},${D.lng}`;window.open(U,"_blank")}x()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?g.jsxs("div",{ref:m,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[g.jsxs(wt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[g.jsx(pA,{size:18,className:"search-icon"}),g.jsx("input",{ref:f,type:"text",value:r,onChange:A=>{i(A.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),g.jsx("button",{onClick:x,className:"search-clear",title:"Sluiten",children:g.jsx(si,{size:18})})]}),g.jsx(Un,{children:o&&s.length>0&&g.jsx(wt.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(A=>g.jsxs("li",{className:"search-result-item",children:[g.jsx("div",{className:"search-result-content",onClick:()=>E(A),children:g.jsx("span",{className:"search-result-text",children:A.weergavenaam})}),g.jsx("button",{className:"search-navigate-btn",onClick:M=>T(A,M),title:"Open in Google Maps",children:g.jsx(U1,{size:20})})]},A.id))})}),o&&c&&g.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):g.jsx(wt.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:g.jsx(pA,{size:22,className:"text-gray-600"})})}function LSe(){const n=pi(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return g.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[g.jsx(wt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:g.jsx($a,{size:18,className:"text-gray-600"})}),g.jsx(wt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:g.jsx(Z7,{size:18,className:"text-gray-600"})})]})}const OSe="detector2024",DA="detectorapp-auth";function DSe({children:n}){const[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState(!1),[o,l]=X.useState(""),[c,h]=X.useState(!0);X.useEffect(()=>{localStorage.getItem(DA)==="authenticated"&&t(!0),h(!1)},[]);const f=m=>{m.preventDefault(),l(""),r===OSe?(localStorage.setItem(DA,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return c?g.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:g.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?g.jsx(g.Fragment,{children:n}):g.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:g.jsxs(wt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx(mA,{size:32,className:"text-blue-600"})}),g.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),g.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),g.jsxs("form",{onSubmit:f,className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),g.jsxs("div",{className:"relative",children:[g.jsx("input",{type:s?"text":"password",value:r,onChange:m=>i(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),g.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?g.jsx(Pv,{size:20}):g.jsx(kv,{size:20})})]})]}),o&&g.jsx(wt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),g.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),g.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function FSe(){localStorage.removeItem(DA),window.location.reload()}function jSe({isOpen:n,onClose:e}){const t=ol(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((c,h)=>h[1]-c[1]),o=l=>Math.max(...Object.values(l),1);return g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(H7,{size:18}),g.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),g.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?g.jsxs("div",{className:"text-center py-8 text-gray-500",children:[g.jsx(za,{size:48,className:"mx-auto mb-3 opacity-30"}),g.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),g.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[g.jsx(OT,{icon:g.jsx(za,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),g.jsx(OT,{icon:g.jsx(Wp,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),g.jsx(OT,{icon:g.jsx(Pce,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),g.jsx(W_,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),g.jsx(W_,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),g.jsx(W_,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&g.jsx(W_,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),g.jsxs("div",{children:[g.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[g.jsx(EC,{size:14}),"Recente Vondsten"]}),g.jsx("div",{className:"space-y-2",children:r.recent.map(l=>g.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[g.jsxs("div",{children:[g.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),g.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),g.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),g.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function OT({icon:n,value:e,label:t,color:r}){return g.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[g.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),g.jsx("div",{className:"text-xl font-bold",children:e}),g.jsx("div",{className:"text-xs opacity-70",children:t})]})}function W_({title:n,data:e,max:t,color:r}){return e.length===0?null:g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),g.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),g.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:g.jsx(wt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),g.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function VSe(n){const{type:e,coordinates:t}=n,r=o=>Ir(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new gi(r(t));case"LineString":return new bi(i(t));case"Polygon":return new Ba(s(t));case"MultiPoint":return new bd(i(t));case"MultiLineString":return new tc(s(t));case"MultiPolygon":return new nd(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function GSe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new mn({image:new Us({radius:o,fill:new er({color:r}),stroke:new Xn({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new mn({stroke:new Xn({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=BSe(r,.3);return new mn({fill:new er({color:l}),stroke:new Xn({color:r,width:2})})}return new mn({image:new Us({radius:o,fill:new er({color:r}),stroke:new Xn({color:"#ffffff",width:2})})})}function BSe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function USe(){const n=pi(r=>r.map),e=F1(r=>r.layers),t=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new hc;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const c=VSe(o.geometry);if(!c)return;const h=new vr({geometry:c,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((f,m)=>GSe(i,o.geometry.type,m)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new Gu({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),X.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");nG(bn);function zSe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function $Se(n){const[e,t]=n;return bn("EPSG:28992","EPSG:4326",[e,t])}function FB(n,e){return typeof n[0]=="number"?e(n):n.map(t=>FB(t,e))}function WSe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function HSe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,h)=>({type:"Feature",geometry:c,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const c=WSe(s[0].geometry);c&&(a=zSe(c))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(c=>{if(!c.geometry)return c;const h=FB(c.geometry.coordinates,$Se);return{...c,geometry:{...c.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function KSe(n){const e=[],t=[];try{const r=await n.text(),s=new Kme({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new BC().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const m={...h.properties},y=m.name||m.Name||`Feature ${f+1}`,x=m.description||m.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:x}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function XSe(n){const e=[],t=[];try{const r=await n.text(),s=new ome().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new BC().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const m={...h.properties},y=m.name||m.Name||`Waypoint ${f+1}`,x=m.desc||m.description||"",v=m.time||null,E=m.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:x,time:v,elevation:E}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return c.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function _P(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function qSe(){return".geojson,.json,.kml,.gpx"}function xP(){return"GeoJSON, KML (Google My Maps), GPX"}async function YSe(n){switch(_P(n.name)){case"geojson":return HSe(n);case"kml":return KSe(n);case"gpx":return XSe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${xP()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function ZSe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:_P(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${xP()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function QSe({isOpen:n,onClose:e}){const t=F1(R=>R.addLayer),r=X.useRef(null),[i,s]=X.useState("idle"),[a,o]=X.useState(null),[l,c]=X.useState(null),[h,f]=X.useState(""),[m,y]=X.useState(null),[x,v]=X.useState(!1),E=X.useCallback(()=>{s("idle"),o(null),c(null),f(""),y(null),r.current&&(r.current.value="")},[]),T=X.useCallback(()=>{E(),e()},[E,e]),b=X.useCallback(async R=>{const k=ZSe(R);if(!k.valid){y(k.error||"Ongeldig bestand"),s("error");return}o(R),s("parsing"),y(null);const N=R.name.replace(/\.[^/.]+$/,"");f(N);try{const O=await YSe(R);if(!O.success){y(O.errors.join(`
`)),s("error");return}if(O.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}c(O),s("preview")}catch(O){y(O instanceof Error?O.message:"Onbekende fout bij parsen"),s("error")}},[]),A=X.useCallback(R=>{const k=R.target.files?.[0];k&&b(k)},[b]),M=X.useCallback(R=>{R.preventDefault(),v(!0)},[]),D=X.useCallback(R=>{R.preventDefault(),v(!1)},[]),U=X.useCallback(R=>{R.preventDefault(),v(!1);const k=R.dataTransfer.files?.[0];k&&b(k)},[b]),P=X.useCallback(()=>{if(!l||!h.trim())return;const R=a?_P(a.name):"geojson";t({name:h.trim(),type:R==="unsupported"?"geojson":R,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(z1,{size:18}),g.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),g.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${x?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:M,onDragLeave:D,onDrop:U,children:[g.jsx(SC,{size:40,className:"mx-auto text-gray-400 mb-3"}),g.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),g.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),g.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),g.jsx("input",{ref:r,type:"file",accept:qSe(),onChange:A,className:"hidden"})]}),g.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[g.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),g.jsx("p",{children:xP()})]})]}),i==="parsing"&&g.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[g.jsx(bC,{size:40,className:"text-purple-500 animate-spin mb-4"}),g.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),g.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[g.jsx(X7,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),g.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:m})]})]}),g.jsx("button",{onClick:E,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[g.jsx(vle,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),g.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&g.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[g.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),g.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((R,k)=>g.jsx("li",{children:R},k))})]}),g.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[g.jsxs("div",{children:[g.jsx("span",{className:"text-gray-500",children:"Features:"}),g.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),g.jsxs("div",{children:[g.jsx("span",{className:"text-gray-500",children:"Types:"}),g.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),g.jsx("input",{type:"text",value:h,onChange:R=>f(R.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&g.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[g.jsx("button",{onClick:E,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),g.jsx("button",{onClick:P,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function JSe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=lw();return X.useEffect(()=>{s()},[s]),e?g.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[g.jsx(gA,{size:16,className:"animate-pulse"}),g.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?g.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?g.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):g.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:g.jsx(CC,{size:16,className:"text-green-600"})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),g.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[g.jsx(gA,{size:12}),"Cloud sync actief"]})]}),g.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:g.jsx(AC,{size:16})})]}):g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[g.jsx(Sle,{size:16}),g.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),g.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[g.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),g.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&g.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const eTe="https://forms.gle/R5LCk11Bzu5XrkBj8";function tTe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=wr(),s=Gr(),{presets:a,createPreset:o,deletePreset:l,updatePreset:c}=f9(),h=ol(Q=>Q.vondsten),f=F1(Q=>Q.layers),{layers:m,updateLayer:y}=cs(),{devMode:x,setDevMode:v,tier:E}=GI(),[T,b]=X.useState(""),[A,M]=X.useState(!1),[D,U]=X.useState(!1),[P,R]=X.useState(null),[k,N]=X.useState(""),[O,z]=X.useState(null),[j,Re]=X.useState(""),[Ne,Ve]=X.useState("algemeen"),Oe=14*s.fontScale/100,ce=()=>{T.trim()&&(o(T.trim(),"Layers"),b(""),M(!1))},we=(Q,ne)=>{R(Q),N(ne)},Se=Q=>{k.trim()&&(c(Q,{name:k.trim()}),console.log(` Preset hernoemd naar "${k.trim()}"`)),R(null),N("")},se=()=>{R(null),N("")},V=[{id:"algemeen",label:"Algemeen",icon:g.jsx(Uce,{size:14})},{id:"lagen",label:"Lagen",icon:g.jsx(yo,{size:14})},{id:"vondsten",label:"Vondsten",icon:g.jsx(za,{size:14})}];return g.jsxs(g.Fragment,{children:[g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Oe}px`},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(yA,{size:18,className:"text-white"}),g.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:Q=>{s.setFontScale(parseInt(Q.target.value))},onChange:Q=>s.setFontScale(parseInt(Q.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),g.jsx("span",{className:"text-xs text-blue-200",children:"T"}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),g.jsx("div",{className:"flex border-b border-gray-200",children:V.map(Q=>g.jsxs("button",{onClick:()=>Ve(Q.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Ne===Q.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[Q.icon,Q.label]},Q.id))}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Oe}px`},children:[Ne==="algemeen"&&g.jsxs(g.Fragment,{children:[g.jsx(Uo,{title:"Account",icon:g.jsx(CC,{size:16}),children:g.jsx(JSe,{})}),g.jsxs(Uo,{title:"Kaart",icon:g.jsx(RC,{size:16}),children:[g.jsx(nTe,{label:"Standaard achtergrond",children:g.jsxs("select",{value:s.defaultBackground,onChange:Q=>s.setDefaultBackground(Q.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[g.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),g.jsx("option",{value:"OpenStreetMap",children:"OSM"}),g.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),g.jsx(_h,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),g.jsxs(Uo,{title:"GPS",icon:g.jsx(IC,{size:16}),children:[g.jsx(_h,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),g.jsx(_h,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),g.jsx(Uo,{title:"Feedback",icon:g.jsx($ce,{size:16}),children:g.jsx(_h,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback})}),g.jsxs(Uo,{title:"Development",icon:g.jsx(Ale,{size:16}),children:[g.jsx(_h,{label:"Dev Mode (alles ontgrendeld)",checked:x,onChange:v}),g.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",g.jsx("span",{className:"font-medium text-blue-600",children:E}),x&&g.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Ne==="lagen"&&g.jsxs(g.Fragment,{children:[g.jsx(Uo,{title:"Mijn lagen",icon:g.jsx(yo,{size:16}),isOwn:!0,children:g.jsxs("div",{className:"space-y-1",children:[m.filter(Q=>!Q.archived).length===0?g.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):m.filter(Q=>!Q.archived).map(Q=>g.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:O===Q.id?g.jsx("input",{type:"text",value:j,onChange:ne=>Re(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"?(j.trim()&&y(Q.id,{name:j.trim()}),z(null)):ne.key==="Escape"&&z(null)},onBlur:()=>{j.trim()&&y(Q.id,{name:j.trim()}),z(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:Q.name}),g.jsxs("span",{className:"text-xs text-gray-400",children:[Q.points.length," punten"]}),g.jsx("button",{onClick:()=>{z(Q.id),Re(Q.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:g.jsx(Y0,{size:12})})]})},Q.id)),g.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx(yA,{size:14}),g.jsx("span",{children:"Lagen beheren"})]})]})}),g.jsx(Uo,{title:"Lagen importeren",icon:g.jsx(z1,{size:16}),children:g.jsxs("div",{className:"space-y-1",children:[f.length>0&&g.jsxs(g.Fragment,{children:[f.map(Q=>g.jsx(eV,{layer:Q},Q.id)),g.jsx("div",{className:"border-t border-gray-100 my-2"})]}),g.jsxs("button",{onClick:()=>U(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx($a,{size:14}),g.jsx("span",{children:"Nieuwe laag importeren"})]}),g.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),g.jsx(Uo,{title:"Presets",icon:g.jsx(yo,{size:16}),children:g.jsxs("div",{className:"space-y-2",children:[a.map(Q=>g.jsx("div",{className:"flex items-center justify-between py-1",children:P===Q.id?g.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[g.jsx("input",{type:"text",value:k,onChange:ne=>N(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&Se(Q.id),ne.key==="Escape"&&se()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),g.jsx("button",{onClick:()=>Se(Q.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),g.jsx("button",{onClick:se,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[Q.name,Q.isBuiltIn&&g.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),g.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",Q.layers.length," lagen)"]})]}),!Q.isBuiltIn&&g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{onClick:()=>we(Q.id,Q.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:g.jsx(Y0,{size:14})}),g.jsx("button",{onClick:()=>l(Q.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:g.jsx(mc,{size:14})})]})]})},Q.id)),A?g.jsxs("div",{className:"flex gap-2 mt-2",children:[g.jsx("input",{type:"text",value:T,onChange:Q=>b(Q.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:Q=>Q.key==="Enter"&&ce(),autoFocus:!0}),g.jsx("button",{onClick:ce,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),g.jsx("button",{onClick:()=>M(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):g.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx($a,{size:14}),g.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Ne==="vondsten"&&g.jsxs(g.Fragment,{children:[g.jsxs(Uo,{title:"Vondsten",icon:g.jsx(za,{size:16}),isOwn:!0,children:[g.jsx(_h,{label:"Vondsten knop tonen",checked:s.showVondstButton,onChange:s.setShowVondstButton}),g.jsx("p",{className:"text-gray-500 mt-1 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),g.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx(H7,{size:14}),g.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),g.jsx(rTe,{})]}),g.jsxs(Uo,{title:"Route opnemen",icon:g.jsx(Mv,{size:16}),isOwn:!0,children:[g.jsx(_h,{label:"Route knop tonen",checked:s.showRouteRecordButton,onChange:s.setShowRouteRecordButton}),g.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Neem je route op tijdens het detecteren of wandelen. Routes worden lokaal opgeslagen en kunnen als GPX gexporteerd worden."})]})]})]}),g.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Oe}px`},children:[g.jsxs("a",{href:eTe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[g.jsx(W7,{size:16}),g.jsx("span",{children:"Meld een bug"})]}),g.jsxs("button",{onClick:FSe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[g.jsx(AC,{size:16}),g.jsx("span",{children:"Uitloggen"})]}),g.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),g.jsx(jSe,{isOpen:t,onClose:r}),g.jsx(QSe,{isOpen:D,onClose:()=>U(!1)})]})}function Uo({title:n,icon:e,children:t,isOwn:r}){return g.jsxs("section",{children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[g.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),g.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),g.jsx("div",{className:"space-y-2",children:t})]})}function nTe({label:n,children:e}){return g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function _h({label:n,checked:e,onChange:t}){return g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),g.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function rTe(){const[n,e]=X.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=ol(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],c=h=>{h(),e(!1)};return t.length===0?g.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[g.jsx(Cv,{size:14}),g.jsx("span",{children:"Geen vondsten om te exporteren"})]}):g.jsxs("div",{className:"relative mt-2",children:[g.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Cv,{size:14}),g.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),g.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&g.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,f)=>g.jsxs("button",{onClick:()=>c(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[g.jsx("span",{className:"text-gray-700",children:h.label}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},f))})]})}const aE="2.28.0";function iTe({size:n=18}){return g.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function sTe(){const[n,e]=X.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=lw(),{toggleInfoPanel:a,toggleSettingsPanel:o}=wr(),l=Gr(T=>T.menuFontScale),c=Gr(T=>T.setMenuFontScale),h={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},f=()=>e(!1),m=()=>{f(),a()},y=()=>{f(),o()},x=()=>{f(),i()},v=()=>{f(),s()},E=13*l/100;return g.jsxs(g.Fragment,{children:[g.jsx(wt.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:h,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?g.jsx(si,{size:22,className:"text-white"}):g.jsx(oce,{size:22,className:"text-gray-600"})}),g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),g.jsxs(wt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${E}px`},children:[g.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[g.jsx("span",{className:"font-medium text-white",style:{fontSize:`${E}px`},children:"Menu"}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:T=>c(parseInt(T.target.value)),onChange:T=>c(parseInt(T.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),g.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?g.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:g.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?g.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?g.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):g.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:g.jsx(CC,{size:16,className:"text-white"})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),g.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),g.jsx("button",{onClick:v,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:g.jsx(AC,{size:16})})]})}):g.jsxs("button",{onClick:x,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[g.jsx(iTe,{size:18}),g.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),g.jsx("div",{className:"py-1",children:g.jsxs("button",{onClick:m,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[g.jsx(TC,{size:18,className:"text-blue-500"}),g.jsx("span",{children:"Info & handleiding"})]})}),g.jsx("div",{className:"mt-auto border-t border-gray-100",children:g.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[g.jsx(yA,{size:18,className:"text-gray-500"}),g.jsx("span",{children:"Instellingen"})]})}),g.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",aE]})]})]})})]})}const aTe="https://forms.gle/R5LCk11Bzu5XrkBj8";function oTe(){const{infoPanelOpen:n,toggleInfoPanel:e}=wr(),[t,r]=X.useState("info"),i=[{id:"info",label:"Info",icon:g.jsx(TC,{size:14})},{id:"functies",label:"Functies",icon:g.jsx(SC,{size:14})},{id:"handleiding",label:"Handleiding",icon:g.jsx(ole,{size:14})}];return g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[g.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",aE]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:g.jsx(si,{size:18,className:"text-white",strokeWidth:2.5})})]}),g.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>g.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&g.jsx(lTe,{}),t==="functies"&&g.jsx(cTe,{}),t==="handleiding"&&g.jsx(uTe,{}),g.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[g.jsxs("a",{href:aTe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[g.jsx(W7,{size:14}),g.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),g.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",aE," - Gratis en zonder tracking"]})]})]})]})]})})}function lTe(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),g.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),g.jsxs("ul",{className:"space-y-2 text-gray-600",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Mindat.org"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Paleontica / Fossielen data"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Map5.nl / Kadaster"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Provinciale data"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),g.jsxs("div",{className:"text-gray-600 space-y-2",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Locatiegegevens:"})," Alleen voor navigatie, niet opgeslagen of gedeeld."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Geen tracking:"})," Geen analytics, cookies of gebruiksstatistieken."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Lokale opslag:"})," Standaard blijft alle data op je apparaat."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Google sync (optioneel):"})," Met Google login worden lagen en vondsten veilig gesynchroniseerd. Alleen jij hebt toegang."]})]})]})]})}function cTe(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(RC,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Hle,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Gle,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(gA,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(IC,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),g.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),g.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),g.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),g.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),g.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(za,{size:16,className:"text-orange-600"}),"Vondsten"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),g.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),g.jsx("li",{children:"Foto's toevoegen (link of upload)"}),g.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),g.jsx("li",{children:"Dashboard met statistieken"}),g.jsx("li",{children:"Cloud sync met Google account"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(yo,{size:16,className:"text-purple-600"}),"Presets"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(hce,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),g.jsx("li",{children:"Oppervlakte in m en hectare"}),g.jsx("li",{children:"Gewas en bouwplan met uitleg"}),g.jsx("li",{children:"Bodemtype met beschrijving"}),g.jsx("li",{children:"AHN hoogte in meters NAP"}),g.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),g.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(jce,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function uTe(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),g.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[g.jsxs("li",{children:["Tik op de ",g.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),g.jsxs("li",{children:["Kies een ",g.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),g.jsxs("li",{children:["Of open ",g.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),g.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsx("p",{children:"Rechtsboven vind je het menu met:"}),g.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 2:"})," Tik op de ",g.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),g.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),g.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),g.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Gebruik ",g.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),g.jsxs("li",{children:["Combineer ",g.jsx("strong",{children:"AMK"})," met ",g.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),g.jsxs("li",{children:["Check ",g.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),g.jsxs("li",{children:["Gebruik ",g.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),g.jsxs("li",{children:["Bekijk ",g.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Zet ",g.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),g.jsxs("li",{children:["Bekijk ",g.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),g.jsxs("li",{children:["Check ",g.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),g.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Zet ",g.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),g.jsxs("li",{children:["Bekijk ",g.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),g.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),g.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(U1,{size:16,className:"text-blue-600"}),"Handige links"]}),g.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("li",{children:[g.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),g.jsxs("li",{children:[g.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),g.jsxs("li",{children:[g.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),g.jsxs("li",{children:[g.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function jB(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function DT(n){let e=0;for(let t=1;t<n.length;t++)e+=jB(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const vo=pa()(kd((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=a;o&&(c+=l-o);const h=l-s-c,f=DT(i),m={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:f,totalDuration:h,pausedDuration:c,createdAt:new Date().toISOString()};return n(y=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[m,...y.savedRoutes]})),m},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if(jB(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.has(t)?i.delete(t):i.add(t),{visibleRouteIds:i}})},showRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.add(t),{visibleRouteIds:i}})},hideRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.delete(t),{visibleRouteIds:i}})},showAllRoutes:()=>{n(t=>({visibleRouteIds:new Set(t.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{n({visibleRouteIds:new Set})},toggleHeatmap:()=>{n(t=>({heatmapEnabled:!t.heatmapEnabled}))},setHeatmapEnabled:t=>{n({heatmapEnabled:t})},toggleGrid:()=>{n(t=>({gridEnabled:!t.gridEnabled}))},setGridEnabled:t=>{n({gridEnabled:t})},setGridCenter:t=>{n({gridCenter:t})},setGridSize:t=>{n({gridSize:t})},setGridCount:t=>{n({gridCount:t})},setGridColor:t=>{n({gridColor:t})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{n({gridCenter:[t.coords.longitude,t.coords.latitude],gridEnabled:!0})},t=>{console.error("Could not get location:",t)})},setAutoPauseEnabled:t=>{n({autoPauseEnabled:t})},setAutoPauseSeconds:t=>{n({autoPauseSeconds:t})},importRouteFromGPX:(t,r)=>{try{const s=new DOMParser().parseFromString(t,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const o=s.querySelectorAll("trkpt");if(o.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((o.length>0?o:s.querySelectorAll("wpt")).forEach(E=>{const T=parseFloat(E.getAttribute("lat")||"0"),b=parseFloat(E.getAttribute("lon")||"0"),A=E.querySelector("time"),M=A?new Date(A.textContent||"").getTime():Date.now();!isNaN(T)&&!isNaN(b)&&l.push({coordinates:[b,T],timestamp:isNaN(M)?Date.now():M})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const h=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,f=DT(l),m=l[0].timestamp,y=l[l.length-1].timestamp,x=y-m,v={id:crypto.randomUUID(),name:h,points:l,startTime:m,endTime:y,totalDistance:f,totalDuration:x>0?x:0,pausedDuration:0,createdAt:new Date().toISOString()};return n(E=>({savedRoutes:[v,...E.savedRoutes]})),{success:!0,routeId:v.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,notes:r}:s)}))},addPhotoToRoute:(t,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};n(s=>({savedRoutes:s.savedRoutes.map(a=>a.id===t?{...a,photos:[...a.photos||[],i]}:a)}))},removePhotoFromRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,photos:(s.photos||[]).filter(a=>a.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:t}=e();return DT(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:n=>({savedRoutes:n.savedRoutes,visibleRouteIds:Array.from(n.visibleRouteIds),heatmapEnabled:n.heatmapEnabled,gridEnabled:n.gridEnabled,gridCenter:n.gridCenter,gridSize:n.gridSize,gridCount:n.gridCount,gridColor:n.gridColor,autoPauseEnabled:n.autoPauseEnabled,autoPauseSeconds:n.autoPauseSeconds}),merge:(n,e)=>({...e,...n,visibleRouteIds:new Set(n?.visibleRouteIds||[])})}));function VB(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}function FT({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,f]=X.useState(""),m=e&&!r.includes(e),y=()=>{c(!0),f(m?e:""),o(!1)},x=()=>{h.trim()&&t(h.trim()),c(!1)};return l?g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&g.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),g.jsx("input",{type:"text",value:h,onChange:v=>f(v.target.value),onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),x()),v.key==="Escape"&&c(!1)},onBlur:x,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):g.jsxs("div",{className:"relative",children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&g.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),g.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[g.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",m&&g.jsx(RO,{size:12,className:"inline ml-1 text-orange-500"})]}),g.jsx(wC,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&g.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[g.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[g.jsx(RO,{size:12}),"Eigen invoer..."]}),g.jsx("div",{className:"border-t border-gray-100"}),r.map(v=>g.jsx("button",{type:"button",onClick:()=>{t(v),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${v===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:v},v))]})]})}function GB({onClose:n,initialLocation:e}){const t=_s(le=>le.position),r=pi(le=>le.map),i=wr(le=>le.vondstFormPhoto),s=cs(le=>le.layers),a=cs(le=>le.addPoint),o=vo(le=>le.state),l=vo(le=>le.startTime);vo(le=>le.savedRoutes);const c=()=>o==="idle"||!l?null:`Route ${new Date(l).toLocaleDateString("nl-NL")} ${new Date(l).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,h=o==="recording"||o==="paused",f=c(),[m,y]=X.useState(""),[x,v]=X.useState(""),[E,T]=X.useState(""),[b,A]=X.useState(""),[M,D]=X.useState(!1),[U,P]=X.useState(void 0),[R,k]=X.useState(void 0),[N,O]=X.useState(ao),[z,j]=X.useState(i),[Re,Ne]=X.useState(null);X.useEffect(()=>{if(z){const le=URL.createObjectURL(z);return Ne(le),()=>URL.revokeObjectURL(le)}else Ne(null)},[z]);const[Ve,Oe]=X.useState(e?"map-pick":t?"gps":"map-center"),[ce,we]=X.useState(e||null),[Se,se]=X.useState(!1),V=()=>{if(Ve==="gps"&&t)return{lat:t.lat,lng:t.lng};if(Ve==="map-pick"&&ce)return ce;if(r){const le=r.getView().getCenter();if(le){const[yt,St]=Tn(le);return{lat:St,lng:yt}}}return null},Q=V();X.useEffect(()=>{if(!Se||!r)return;const le=yt=>{const[St,ln]=Tn(yt.coordinate);we({lat:ln,lng:St}),Oe("map-pick"),se(!1)};return r.on("click",le),()=>r.un("click",le)},[Se,r]);const ne=()=>se(!0),ie=()=>{t&&(Oe("gps"),we(null))},me=()=>{const le=document.createElement("input");le.type="file",le.accept="image/*",le.capture="environment",le.onchange=yt=>{const St=yt.target.files?.[0];St&&j(St)},le.click()},Ce=()=>j(null),Fe=async le=>{le.preventDefault();const yt=V();if(!yt){alert("Geen locatie beschikbaar");return}if(!x){alert("Vul een naam/type in");return}D(!0);try{let St=m||"";if(N===ao){const kt=[];E&&kt.push(`Materiaal: ${E}`),b&&kt.push(`Periode: ${b}`),U&&kt.push(`Gewicht: ${U}g`),R&&kt.push(`Lengte: ${R}mm`),kt.length>0&&(St=kt.join(" | ")+(m?` | ${m}`:""))}a(N,{coordinates:[yt.lng,yt.lat],name:x,category:N===ao?x:"Overig",notes:St||"",...h&&l?{routeId:`recording-${l}`,routeName:f||void 0}:{}});const ln=s.find(kt=>kt.id===N)?.name||"Vondsten";alert(`Toegevoegd aan ${ln}! `),n()}catch(St){alert("Fout bij opslaan: "+St.message)}finally{D(!1)}},fe=X.useMemo(()=>s.map(le=>({id:le.id,name:le.name,color:le.color})),[s]);return Se?g.jsx(wt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:g.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Iv,{size:24,className:"animate-pulse"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),g.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),g.jsx("button",{onClick:()=>se(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):g.jsx(wt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:g.jsxs(wt.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[g.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[g.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),g.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:g.jsx(si,{size:20})})]}),g.jsxs("form",{onSubmit:Fe,className:"flex-1 overflow-y-auto",children:[g.jsxs("div",{className:"p-5 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),Re?g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:Re,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),g.jsx("button",{type:"button",onClick:Ce,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:g.jsx(mc,{size:16})})]}):g.jsxs("button",{type:"button",onClick:me,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[g.jsx(mw,{size:32}),g.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),Q&&g.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[g.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[Q.lat.toFixed(6),"N, ",Q.lng.toFixed(6),"E"]}),g.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Ve==="gps"?" GPS locatie":Ve==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!Q&&g.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:g.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),g.jsxs("div",{className:"flex gap-2",children:[t&&Ve!=="gps"&&g.jsxs("button",{type:"button",onClick:ie,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[g.jsx(IC,{size:16}),"GPS"]}),g.jsxs("button",{type:"button",onClick:ne,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[g.jsx(Iv,{size:16}),"Kies op kaart"]})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:fe.map(le=>g.jsx("button",{type:"button",onClick:()=>O(le.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${N===le.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:le.name},le.id))})]}),N===ao&&g.jsx(FT,{label:"Type vondst",value:x,onChange:v,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),N!==ao&&g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",g.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),g.jsx("input",{type:"text",value:x,onChange:le=>v(le.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),N===ao&&g.jsxs(g.Fragment,{children:[g.jsx(FT,{label:"Materiaal",value:E,onChange:T,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),g.jsx(FT,{label:"Periode",value:b,onChange:A,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),g.jsxs("div",{className:"flex gap-3",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),g.jsx("input",{type:"number",value:U??"",onChange:le=>P(le.target.value?parseFloat(le.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),g.jsx("input",{type:"number",value:R??"",onChange:le=>k(le.target.value?parseFloat(le.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),g.jsx("textarea",{value:m,onChange:le=>y(le.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),g.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:g.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),g.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[g.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),g.jsx("button",{type:"submit",disabled:M||!Q||Se||!x,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:M?"Opslaan...":"Opslaan"})]})]})]})})}function hTe(){const{user:n,setUser:e,setLoading:t}=lw();return X.useEffect(()=>{const s=N6(p0,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await OZ(p0)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await L6(p0)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function dTe(){const{isAuthenticated:n,loginAnonymous:e}=hTe(),t=Gr(c=>c.vondstenLocalOnly),r=Gr(c=>c.showVondstButton),i=wr(c=>c.vondstFormOpen),s=wr(c=>c.vondstFormLocation),a=wr(c=>c.openVondstForm),o=wr(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return g.jsxs(g.Fragment,{children:[g.jsx(wt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:g.jsx(za,{size:22,strokeWidth:2})}),g.jsx(Un,{children:i&&g.jsx(GB,{onClose:o,initialLocation:s||void 0})})]})}function fTe(){const n=Gr(Ce=>Ce.showRouteRecordButton),e=wr(Ce=>Ce.toggleRouteDashboard),{state:t,startRecording:r,pauseRecording:i,resumeRecording:s,stopRecording:a,cancelRecording:o,addPoint:l,getCurrentDistance:c,getCurrentDuration:h,getAverageSpeed:f,currentPoints:m,savedRoutes:y,autoPauseEnabled:x,autoPauseSeconds:v}=vo(),[E,T]=X.useState(!1),[b,A]=X.useState(""),[M,D]=X.useState(!1),[U,P]=X.useState(!1),R=X.useRef(null),k=X.useRef(null),N=X.useRef(null),O=Ce=>{const Fe=Math.floor(Ce/1e3),fe=Math.floor(Fe/3600),le=Math.floor(Fe%3600/60),yt=Fe%60;return fe>0?`${fe}:${le.toString().padStart(2,"0")}:${yt.toString().padStart(2,"0")}`:`${le}:${yt.toString().padStart(2,"0")}`},z=Ce=>Ce<1e3?`${Math.round(Ce)} m`:`${(Ce/1e3).toFixed(2)} km`,j=Ce=>`${Ce.toFixed(1)} km/h`,Re=(Ce,Fe,fe,le)=>{const St=(le-Fe)*Math.PI/180,ln=(fe-Ce)*Math.PI/180,kt=Math.sin(St/2)*Math.sin(St/2)+Math.cos(Fe*Math.PI/180)*Math.cos(le*Math.PI/180)*Math.sin(ln/2)*Math.sin(ln/2);return 6371e3*(2*Math.atan2(Math.sqrt(kt),Math.sqrt(1-kt)))};if(X.useEffect(()=>(t==="recording"?(P(!1),"geolocation"in navigator&&R.current===null&&(R.current=navigator.geolocation.watchPosition(Ce=>{const Fe=Ce.coords.longitude,fe=Ce.coords.latitude,le=Date.now();l(Fe,fe,Ce.coords.accuracy),x&&k.current?Re(k.current.lon,k.current.lat,Fe,fe)>3?(k.current={lon:Fe,lat:fe,time:le},N.current&&(clearTimeout(N.current),N.current=null)):le-k.current.time>=v*1e3&&(i(),P(!0),k.current=null):k.current={lon:Fe,lat:fe,time:le}},Ce=>{console.error("GPS error:",Ce)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(R.current!==null&&(navigator.geolocation.clearWatch(R.current),R.current=null),N.current&&(clearTimeout(N.current),N.current=null)),()=>{R.current!==null&&(navigator.geolocation.clearWatch(R.current),R.current=null),N.current&&(clearTimeout(N.current),N.current=null)}),[t,l,x,v,i]),!n)return null;const Ne=()=>{r(),D(!0)},Ve=()=>{i()},Oe=()=>{s()},ce=()=>{A(`Route ${new Date().toLocaleDateString("nl-NL")}`),T(!0)},we=()=>{const Ce=a(b);T(!1),D(!1),A(""),Ce&&confirm(`Route "${Ce.name}" opgeslagen! (${z(Ce.totalDistance)})

Direct exporteren als GPX?`)&&VB(Ce)},Se=()=>{m.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(o(),T(!1),D(!1))},se=c(),V=h(),Q=f(),ne=Ce=>{switch(Ce){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-purple-500 hover:bg-purple-600"}},ie=Ce=>{switch(Ce){case"recording":return g.jsx(gce,{size:22,strokeWidth:2});case"paused":return g.jsx(vce,{size:22,strokeWidth:2});default:return g.jsx(Mv,{size:22,strokeWidth:2})}},me=()=>{switch(t){case"idle":Ne();break;case"recording":Ve();break;case"paused":Oe();break}};return g.jsxs(g.Fragment,{children:[g.jsxs(wt.button,{className:`fixed bottom-2 right-[114px] z-[1000] w-11 h-11 ${ne(t)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:me,title:t==="idle"?"Route opnemen":t==="recording"?"Pauzeren":"Hervatten",children:[ie(t),t==="recording"&&g.jsx(wt.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),g.jsx(Un,{children:t==="idle"&&y.length>0&&g.jsxs(wt.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-purple-400 hover:bg-purple-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e,title:`Mijn routes (${y.length})`,children:[g.jsx(Y7,{size:18,strokeWidth:2}),g.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-purple-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:y.length})]})}),g.jsx(Un,{children:(t==="recording"||t==="paused")&&g.jsx(wt.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ce,title:"Stoppen en opslaan",children:g.jsx(Hce,{size:18,strokeWidth:2,fill:"currentColor"})})}),g.jsx(Un,{children:M&&t!=="idle"&&g.jsxs(wt.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t==="recording"?" Opname":U?" Auto-pauze":" Gepauzeerd"}),g.jsx("button",{onClick:()=>D(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:g.jsx(si,{size:14})})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Wp,{size:16,className:"text-purple-500"}),g.jsx("span",{className:"text-lg font-semibold text-gray-800",children:z(se)})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Rv,{size:16,className:"text-blue-500"}),g.jsx(gTe,{duration:V,recordingState:t,formatTime:O})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx($le,{size:16,className:"text-green-500"}),g.jsx("span",{className:"text-sm text-gray-600",children:j(Q)})]}),g.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[m.length," punten opgenomen"]})]})]})}),g.jsx(Un,{children:E&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>T(!1)}),g.jsxs(wt.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Afstand:"}),g.jsx("span",{className:"font-medium",children:z(se)})]}),g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Duur:"}),g.jsx("span",{className:"font-medium",children:O(V)})]}),g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),g.jsx("span",{className:"font-medium",children:j(Q)})]}),g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Punten:"}),g.jsx("span",{className:"font-medium",children:m.length})]})]}),g.jsxs("div",{className:"mb-4",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),g.jsx("input",{type:"text",value:b,onChange:Ce=>A(Ce.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{onClick:Se,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),g.jsxs("button",{onClick:we,disabled:m.length<2,className:"flex-1 px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[g.jsx(Q7,{size:16}),"Opslaan"]})]}),m.length<2&&g.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function gTe({duration:n,recordingState:e,formatTime:t}){const[r,i]=X.useState(n);return X.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),X.useEffect(()=>{i(n)},[n]),g.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function mTe(){const n=pi(s=>s.map),{currentPoints:e,state:t}=vo(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new hc;i.current=s;const a=new Gu({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>Ir(a.coordinates));if(s.length>=2){const a=new vr({geometry:new bi(s)});a.setStyle(new mn({stroke:new Xn({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new vr({geometry:new gi(s[0])});a.setStyle(new mn({image:new Us({radius:8,fill:new er({color:"rgba(34, 197, 94, 1)"}),stroke:new Xn({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new vr({geometry:new gi(s[s.length-1])});a.setStyle(new mn({image:new Us({radius:6,fill:new er({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Xn({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const W5=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function pTe(){const n=pi(s=>s.map),{savedRoutes:e,visibleRouteIds:t}=vo(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new hc;i.current=s;const a=new Gu({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(a=>t.has(a.id)).forEach((a,o)=>{const l=W5[o%W5.length],c=a.points.map(v=>Ir(v.coordinates));if(c.length<2)return;const h=new vr({geometry:new bi(c),routeId:a.id,routeName:a.name});h.setStyle(new mn({stroke:new Xn({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(h);const f=new vr({geometry:new gi(c[0]),routeId:a.id,type:"start"});f.setStyle(new mn({image:new Us({radius:8,fill:new er({color:"#22c55e"}),stroke:new Xn({color:"white",width:2})}),text:new mo({text:"S",font:"bold 10px sans-serif",fill:new er({color:"white"}),offsetY:1})})),i.current.addFeature(f);const m=new vr({geometry:new gi(c[c.length-1]),routeId:a.id,type:"end"});m.setStyle(new mn({image:new Us({radius:8,fill:new er({color:"#ef4444"}),stroke:new Xn({color:"white",width:2})}),text:new mo({text:"E",font:"bold 10px sans-serif",fill:new er({color:"white"}),offsetY:1})})),i.current.addFeature(m);const y=Math.floor(c.length/2),x=new vr({geometry:new gi(c[y]),routeId:a.id,type:"label"});x.setStyle(new mn({text:new mo({text:a.name,font:"12px sans-serif",fill:new er({color:"#1f2937"}),stroke:new Xn({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(x)})},[e,t]),null}function yTe(){const n=pi(a=>a.map),{savedRoutes:e,visibleRouteIds:t,heatmapEnabled:r}=vo(),i=X.useRef(null),s=X.useRef(null);return X.useEffect(()=>{if(!n)return;const a=new hc;s.current=a;const o=new CK({source:a,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=o,n.addLayer(o),()=>{n&&i.current&&n.removeLayer(i.current)}},[n]),X.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const a=e.filter(l=>t.has(l.id)),o=[];for(const l of a)for(const c of l.points){const h=new vr({geometry:new gi(Ir(c.coordinates))});o.push(h)}s.current.addFeatures(o),i.current.setVisible(o.length>0)},[e,t,r]),null}function _Te(n,e,t,r){const i=[],s=e/111e3,a=e/(111e3*Math.cos(n[1]*Math.PI/180)),o=Math.floor(t/2),l=n[0]-o*a,c=n[0]+o*a,h=n[1]-o*s,f=n[1]+o*s;for(let v=-o;v<=o;v++){const E=n[0]+v*a,T=[Ir([E,h]),Ir([E,f])],b=new vr({geometry:new bi(T),type:"grid-line"});b.setStyle(new mn({stroke:new Xn({color:r,width:v===0?2:1,lineDash:v===0?void 0:[5,5]})})),i.push(b)}for(let v=-o;v<=o;v++){const E=n[1]+v*s,T=[Ir([l,E]),Ir([c,E])],b=new vr({geometry:new bi(T),type:"grid-line"});b.setStyle(new mn({stroke:new Xn({color:r,width:v===0?2:1,lineDash:v===0?void 0:[5,5]})})),i.push(b)}const m="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let v=-o;v<o;v++)for(let E=-o;E<o;E++){const T=n[0]+(E+.5)*a,b=n[1]+(v+.5)*s,A=v+o,M=E+o;if(A>=0&&A<m.length){const D=`${m[A]}${M+1}`,U=new vr({geometry:new bi([Ir([T,b]),Ir([T,b])]),type:"grid-label"});U.setStyle(new mn({text:new mo({text:D,font:"12px sans-serif",fill:new er({color:r}),stroke:new Xn({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(U)}}const y=new vr({geometry:new bi([Ir([n[0]-a*.2,n[1]]),Ir([n[0]+a*.2,n[1]])]),type:"grid-center"});y.setStyle(new mn({stroke:new Xn({color:"#ef4444",width:3})})),i.push(y);const x=new vr({geometry:new bi([Ir([n[0],n[1]-s*.2]),Ir([n[0],n[1]+s*.2])]),type:"grid-center"});return x.setStyle(new mn({stroke:new Xn({color:"#ef4444",width:3})})),i.push(x),i}function xTe(){const n=pi(l=>l.map),{gridEnabled:e,gridCenter:t,gridSize:r,gridCount:i,gridColor:s}=vo(),a=X.useRef(null),o=X.useRef(null);return X.useEffect(()=>{if(!n)return;const l=new hc;o.current=l;const c=new Gu({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return a.current=c,n.addLayer(c),()=>{a.current&&n&&n.removeLayer(a.current)}},[n]),X.useEffect(()=>{if(!o.current||!a.current)return;if(o.current.clear(),!e||!t){a.current.setVisible(!1);return}const l=_Te(t,r,i,s);o.current.addFeatures(l),a.current.setVisible(!0)},[e,t,r,i,s]),null}function vTe(n){const e=[];let t=0;return n.points.forEach((r,i)=>{if(i>0){const o=n.points[i-1],l=6371e3,c=(r.coordinates[1]-o.coordinates[1])*Math.PI/180,h=(r.coordinates[0]-o.coordinates[0])*Math.PI/180,f=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2),m=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f));t+=l*m}const s=5,a=Math.sin(t/50)*2+Math.sin(t/120)*1.5+Math.sin(t/30+r.coordinates[0]*1e3)*.5;e.push({distance:t,elevation:Math.max(0,s+a)})}),e}function ETe({route:n,onClose:e}){const t=X.useRef(null),[r,i]=X.useState([]),[s,a]=X.useState({min:0,max:0,gain:0,loss:0});X.useEffect(()=>{const l=vTe(n);if(i(l),l.length>0){const c=l.map(x=>x.elevation),h=Math.min(...c),f=Math.max(...c);let m=0,y=0;for(let x=1;x<l.length;x++){const v=l[x].elevation-l[x-1].elevation;v>0?m+=v:y+=Math.abs(v)}a({min:h,max:f,gain:m,loss:y})}},[n]),X.useEffect(()=>{const l=t.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const h=l.width,f=l.height,m={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,h,f);const y=Math.max(...r.map(D=>D.distance)),x=Math.min(...r.map(D=>D.elevation))-1,v=Math.max(...r.map(D=>D.elevation))+1,E=D=>m.left+D/y*(h-m.left-m.right),T=D=>f-m.bottom-(D-x)/(v-x)*(f-m.top-m.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const b=5;for(let D=0;D<=b;D++){const U=x+(v-x)*(D/b),P=T(U);c.beginPath(),c.moveTo(m.left,P),c.lineTo(h-m.right,P),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${U.toFixed(1)}m`,m.left-5,P+3)}const A=5;for(let D=0;D<=A;D++){const U=y/A*D,P=E(U);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(U<1e3?`${Math.round(U)}m`:`${(U/1e3).toFixed(1)}km`,P,f-10)}c.beginPath(),c.moveTo(E(r[0].distance),f-m.bottom),r.forEach(D=>{c.lineTo(E(D.distance),T(D.elevation))}),c.lineTo(E(r[r.length-1].distance),f-m.bottom),c.closePath();const M=c.createLinearGradient(0,m.top,0,f-m.bottom);M.addColorStop(0,"rgba(139, 92, 246, 0.3)"),M.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=M,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((D,U)=>{const P=E(D.distance),R=T(D.elevation);U===0?c.moveTo(P,R):c.lineTo(P,R)}),c.stroke()},[r]);const o=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return g.jsxs(wt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(q0,{size:20}),g.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),g.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[g.jsx("h3",{className:"font-medium text-gray-800 truncate",children:n.name}),g.jsx("p",{className:"text-xs text-gray-500",children:o(n.totalDistance)})]}),g.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:g.jsx(Z7,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:g.jsx(q0,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:g.jsx(sue,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:g.jsx(rue,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),g.jsx("div",{className:"flex-1 p-3",children:g.jsx("canvas",{ref:t,width:350,height:200,className:"w-full h-full"})}),g.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:g.jsxs("p",{className:"text-xs text-yellow-700",children:[g.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const wTe=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,STe=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},H5=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function TTe({route:n,onClose:e}){const{updateRouteNotes:t,addPhotoToRoute:r,removePhotoFromRoute:i}=vo(),[s,a]=X.useState(n.notes||""),[o,l]=X.useState("info"),c=X.useRef(null),h=()=>{t(n.id,s)},f=async x=>{const v=x.target.files?.[0];if(!v)return;const E=URL.createObjectURL(v);r(n.id,{url:E,caption:v.name}),c.current&&(c.current.value="")},m=x=>{confirm("Foto verwijderen?")&&i(n.id,x)},y=vo(x=>x.savedRoutes.find(v=>v.id===n.id))||n;return g.jsxs(wt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[g.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),g.jsxs(wt.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("h3",{className:"font-medium truncate",children:y.name}),g.jsx("p",{className:"text-xs text-purple-200",children:H5(y.createdAt)})]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:g.jsx(si,{size:18})})]}),g.jsxs("div",{className:"flex border-b border-gray-200",children:[g.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[g.jsx(za,{size:16,className:"inline mr-1"}),"Info"]}),g.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[g.jsx(mw,{size:16,className:"inline mr-1"}),"Foto's (",y.photos?.length||0,")"]}),g.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[g.jsx(SC,{size:16,className:"inline mr-1"}),"Notities"]})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o==="info"&&g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[g.jsx(Wp,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),g.jsx("p",{className:"text-lg font-semibold",children:wTe(y.totalDistance)})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[g.jsx(Rv,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),g.jsx("p",{className:"text-lg font-semibold",children:STe(y.totalDuration)})]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[g.jsx(za,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),g.jsxs("p",{className:"text-lg font-semibold",children:[y.points.length," GPS punten"]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[g.jsx(EC,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),g.jsx("p",{className:"text-sm",children:H5(y.createdAt)})]})]}),o==="photos"&&g.jsxs("div",{className:"space-y-4",children:[g.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:f,className:"hidden"}),g.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[g.jsx($a,{size:24}),g.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),y.photos&&y.photos.length>0?g.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.photos.map(x=>g.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[g.jsx("img",{src:x.url,alt:x.caption||"Route foto",className:"w-full h-full object-cover"}),g.jsx("button",{onClick:()=>m(x.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:g.jsx(mc,{size:12})}),x.caption&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:x.caption})]},x.id))}):g.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),o==="notes"&&g.jsxs("div",{className:"space-y-4",children:[g.jsx("textarea",{value:s,onChange:x=>a(x.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),g.jsx("button",{onClick:h,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function bTe({route:n,size:e=80}){const t=X.useRef(null);return X.useEffect(()=>{const r=t.current;if(!r||n.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=n.points.map(M=>M.coordinates[0]),a=n.points.map(M=>M.coordinates[1]),o=Math.min(...s),l=Math.max(...s),c=Math.min(...a),h=Math.max(...a),f=8,m=e-f*2,y=e-f*2,x=M=>l===o?e/2:f+(M-o)/(l-o)*m,v=M=>h===c?e/2:f+y-(M-c)/(h-c)*y;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),n.points.forEach((M,D)=>{const U=x(M.coordinates[0]),P=v(M.coordinates[1]);D===0?i.moveTo(U,P):i.lineTo(U,P)}),i.stroke();const E=x(n.points[0].coordinates[0]),T=v(n.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(E,T,4,0,Math.PI*2),i.fill();const b=x(n.points[n.points.length-1].coordinates[0]),A=v(n.points[n.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(b,A,4,0,Math.PI*2),i.fill()},[n,e]),n.points.length<2?g.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:g.jsx(za,{size:20})}):g.jsx("canvas",{ref:t,width:e,height:e,className:"rounded"})}const jT=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,VT=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},K5=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function ATe({isOpen:n,onClose:e,onViewRoute:t}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:a,visibleRouteIds:o,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:h,heatmapEnabled:f,toggleHeatmap:m,gridEnabled:y,toggleGrid:x,centerGridOnCurrentLocation:v,gridSize:E,setGridSize:T,autoPauseEnabled:b,setAutoPauseEnabled:A,autoPauseSeconds:M,setAutoPauseSeconds:D,importRouteFromGPX:U}=vo(),[P,R]=X.useState(null),[k,N]=X.useState(""),[O,z]=X.useState(!1),[j,Re]=X.useState(!1),[Ne,Ve]=X.useState(null),[Oe,ce]=X.useState(null),we=X.useRef(null),Se=async fe=>{const le=` ${fe.name}

 Afstand: ${jT(fe.totalDistance)}
 Duur: ${VT(fe.totalDuration)}
 ${fe.points.length} GPS punten
 ${K5(fe.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:fe.name,text:le});return}catch(yt){yt.name!=="AbortError"&&console.error("Share failed:",yt)}try{await navigator.clipboard.writeText(le),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",le)}},se=async fe=>{const le=fe.target.files?.[0];if(le){try{const yt=await le.text(),St=U(yt,le.name.replace(".gpx",""));St.success?alert(`Route gemporteerd: ${le.name}`):alert(`Import mislukt: ${St.error}`)}catch{alert("Fout bij lezen van bestand")}we.current&&(we.current.value="")}},V=fe=>{R(fe.id),N(fe.name)},Q=fe=>{k.trim()&&s(fe,k.trim()),R(null),N("")},ne=fe=>{confirm(`Weet je zeker dat je "${fe.name}" wilt verwijderen?`)&&i(fe.id)},ie=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&a()},me=fe=>{l(fe);const le=r.find(yt=>yt.id===fe);le&&t&&t(le)},Ce=r.reduce((fe,le)=>fe+le.totalDistance,0),Fe=r.reduce((fe,le)=>fe+le.totalDuration,0);return g.jsxs(g.Fragment,{children:[g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Mv,{size:20}),g.jsx("span",{className:"font-medium",children:"Mijn Routes"}),g.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),r.length>0&&g.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[g.jsx(Wp,{size:14}),g.jsxs("span",{children:["Totaal: ",jT(Ce)]})]}),g.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[g.jsx(Rv,{size:14}),g.jsx("span",{children:VT(Fe)})]})]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:()=>Re(!j),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${b?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:b?"Auto-pauze uit":"Auto-pauze aan",children:g.jsx(Qce,{size:14})}),g.jsx("button",{onClick:()=>z(!O),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${y?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:y?"Grid verbergen":"Grid tonen",children:g.jsx(q7,{size:14})}),g.jsx("button",{onClick:m,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${f?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:f?"Heatmap verbergen":"Heatmap tonen",children:g.jsx(Dle,{size:14})}),g.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:g.jsx(kv,{size:14})}),g.jsx("button",{onClick:h,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:g.jsx(Pv,{size:14})})]})]}),g.jsx(Un,{children:O&&g.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:g.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),g.jsx("button",{onClick:x,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${y?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:y?"Aan":"Uit"})]}),g.jsx("div",{className:"flex items-center gap-2",children:g.jsxs("button",{onClick:v,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[g.jsx(Iv,{size:14}),"Centreer op mijn locatie"]})}),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",E,"m"]}),g.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:E,onChange:fe=>T(Number(fe.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),g.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[g.jsx("span",{children:"5m"}),g.jsx("span",{children:"50m"})]})]}),g.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),g.jsx(Un,{children:j&&g.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:g.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),g.jsx("button",{onClick:()=>A(!b),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${b?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:b?"Aan":"Uit"})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",M<60?`${M}s`:`${Math.floor(M/60)}m ${M%60}s`]}),g.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:M,onChange:fe=>D(Number(fe.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),g.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[g.jsx("span",{children:"30s"}),g.jsx("span",{children:"5min"})]})]}),g.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",M<60?`${M} seconden`:`${Math.floor(M/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),g.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?g.jsxs("div",{className:"text-center py-12 text-gray-500",children:[g.jsx(Mv,{size:48,className:"mx-auto mb-3 text-gray-300"}),g.jsx("p",{className:"font-medium",children:"Nog geen routes"}),g.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(fe=>g.jsxs(wt.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[g.jsx(bTe,{route:fe,size:70}),g.jsxs("div",{className:"flex-1 min-w-0",children:[P===fe.id?g.jsx("input",{type:"text",value:k,onChange:le=>N(le.target.value),onKeyDown:le=>{le.key==="Enter"&&Q(fe.id),le.key==="Escape"&&R(null)},onBlur:()=>Q(fe.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):g.jsx("h3",{className:"font-medium text-gray-800 truncate",children:fe.name}),g.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(EC,{size:12}),K5(fe.createdAt)]})}),g.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(Wp,{size:12}),jT(fe.totalDistance)]}),g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(Rv,{size:12}),VT(fe.totalDuration)]}),g.jsxs("span",{children:[fe.points.length," punten"]})]})]}),g.jsxs("div",{className:"flex flex-col gap-1",children:[g.jsx("button",{onClick:()=>me(fe.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${o.has(fe.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:o.has(fe.id)?"Verbergen op kaart":"Tonen op kaart",children:o.has(fe.id)?g.jsx(kv,{size:16}):g.jsx(Pv,{size:16})}),g.jsx("button",{onClick:()=>V(fe),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:g.jsx(Y0,{size:16})}),g.jsx("button",{onClick:()=>ce(fe),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:g.jsx(TC,{size:16})}),g.jsx("button",{onClick:()=>Ve(fe),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:g.jsx(q0,{size:16})}),g.jsx("button",{onClick:()=>Se(fe),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:g.jsx(Dce,{size:16})}),g.jsx("button",{onClick:()=>VB(fe),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:g.jsx(Cv,{size:16})}),g.jsx("button",{onClick:()=>ne(fe),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:g.jsx(mc,{size:16})})]})]},fe.id))}),g.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[g.jsx("input",{ref:we,type:"file",accept:".gpx",onChange:se,className:"hidden"}),g.jsxs("button",{onClick:()=>we.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[g.jsx(z1,{size:16}),"GPX bestand importeren"]}),r.length>0&&g.jsx("button",{onClick:ie,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),g.jsx(Un,{children:Ne&&g.jsx(ETe,{route:Ne,onClose:()=>Ve(null)})}),g.jsx(Un,{children:Oe&&g.jsx(TTe,{route:Oe,onClose:()=>ce(null)})})]})}const X5={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},RTe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function ITe(){const n=pi(i=>i.map),e=ol(i=>i.vondsten),t=Gr(i=>i.showLocalVondsten),r=X.useRef(null);return X.useEffect(()=>{if(!n)return;const i=new hc;return e.forEach(s=>{const a=new vr({geometry:new gi(Ir([s.location.lng,s.location.lat])),vondst:s}),o=X5[s.objectType]||X5.Anders,l=RTe[s.objectType]||"?";a.setStyle((c,h)=>{let x=12;h>50?x=6:h>10?x=Math.max(6,12-(h-10)/10):h<2&&(x=14);const v=Math.max(8,Math.min(12,x-2));return new mn({image:new Us({radius:x,fill:new er({color:o}),stroke:new Xn({color:"#ffffff",width:x>8?2:1})}),text:x>=8?new mo({text:l,font:`bold ${v}px sans-serif`,fill:new er({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new Gu({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),X.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const CTe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function PTe(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?Ir(s):s.map(r),i=r(t);switch(e){case"Point":return new gi(i);case"LineString":return new bi(i);case"Polygon":return new Ba(i);case"MultiPoint":return new bd(i);case"MultiLineString":return new tc(i);case"MultiPolygon":return new nd(i);default:return new gi(Ir(t))}}function kTe(){const n=pi(i=>i.map),e=cs(i=>i.layers),t=Gr(i=>i.showCustomPointLayers),r=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new hc;s.points.forEach(l=>{let c;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?c=PTe(l.geometry):c=new gi(Ir(l.coordinates));const f=new vr({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),m=CTe[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;f.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new mn({fill:new er({color:s.color+"40"}),stroke:new Xn({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new mn({stroke:new Xn({color:s.color,width:3})}):new mn({image:new Us({radius:8,fill:new er({color:s.color}),stroke:new Xn({color:"#ffffff",width:2})})}))}else f.setStyle((y,x)=>{let b=12;x>50?b=6:x>10?b=Math.max(6,12-(x-10)/10):x<2&&(b=14);const A=Math.max(8,Math.min(12,b-2));return new mn({image:new Us({radius:b,fill:new er({color:s.color}),stroke:new Xn({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new mo({text:m,font:`bold ${A}px sans-serif`,fill:new er({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(f)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new Gu({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function MTe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=wr(),{addLayer:t}=cs(),r=Gr(),[i,s]=X.useState(""),[a,o]=X.useState([...eu]),[l,c]=X.useState(""),h=14*r.fontScale/100,f=()=>{const E=l.trim();E&&!a.includes(E)&&(o([...a,E]),c(""))},m=E=>{o(a.filter(T=>T!==E))},y=E=>{a.includes(E)?o(a.filter(T=>T!==E)):o([...a,E])},x=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...eu]),c(""),e())},v=()=>{s(""),o([...eu]),c(""),e()};return g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:v}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(yo,{size:18}),g.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:E=>r.setFontScale(parseInt(E.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:v,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),g.jsx("input",{type:"text",value:i,onChange:E=>s(E.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:eu.map(E=>g.jsx("button",{onClick:()=>y(E),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(E)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:E},E))})]}),a.filter(E=>!eu.includes(E)).length>0&&g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(E=>!eu.includes(E)).map(E=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("button",{onClick:()=>y(E),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:E}),g.jsx("button",{onClick:()=>m(E),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:g.jsx(mc,{size:12})})]},E))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"text",value:l,onChange:E=>c(E.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:E=>E.key==="Enter"&&f()}),g.jsx("button",{onClick:f,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:g.jsx($a,{size:20})})]})]})]}),g.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[g.jsx("button",{onClick:v,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),g.jsx("button",{onClick:x,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const BB=200,NTe=.7;async function LTe(n,e=BB){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(c=>{c?t(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",NTe)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function OTe(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function DTe(n){const e=await LTe(n,BB),t=await OTe(e);return{thumbnailBlob:e,thumbnailBase64:t}}function FTe(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const GT=5;function jTe({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=X.useRef(null),s=X.useRef(null),a=async l=>{const c=l.target.files;if(!c||c.length===0)return;const h=GT-n.length,f=Array.from(c).slice(0,h);for(const m of f)try{const{thumbnailBase64:y}=await DTe(m),x={id:FTe(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(x)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<GT;return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",GT,")"]}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>g.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[g.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&g.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:g.jsx(si,{size:12,className:"text-white"})}),l.pendingUpload&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[g.jsx(mw,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),g.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[g.jsx(qle,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),g.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),g.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function VTe(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=wr(),{addPoint:i,getLayer:s}=cs(),a=Gr(),[o,l]=X.useState(""),[c,h]=X.useState(""),[f,m]=X.useState(""),[y,x]=X.useState([]),v=e?s(e):null,E=14*a.fontScale/100,T=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:c.trim(),url:f.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),m(""),x([]),r())},b=()=>{l(""),h(""),m(""),x([]),r()};return v?g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(za,{size:18}),g.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:A=>a.setFontScale(parseInt(A.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsx("div",{className:"px-4 py-1.5",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:v.color}}),g.jsx("span",{className:"text-sm text-gray-600",children:v.name})]})}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${E}px`},children:[g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),g.jsx("input",{type:"text",value:o,onChange:A=>l(A.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),g.jsx(jTe,{photos:y,onAddPhoto:A=>x([...y,A]),onRemovePhoto:A=>x(y.filter(M=>M.id!==A))}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),g.jsx("textarea",{value:c,onChange:A=>h(A.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),g.jsx("input",{type:"url",value:f,onChange:A=>m(A.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),g.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${E}px`},children:[g.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),g.jsx("button",{onClick:T,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function GTe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=wr(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=cs(),h=Gr(),f=14*h.fontScale/100,[m,y]=X.useState(null),[x,v]=X.useState(null),[E,T]=X.useState(null),[b,A]=X.useState(!1),M=i.filter(j=>!j.archived),D=i.filter(j=>j.archived),U=b?D:M,P=j=>{x===j?(s(j),v(null)):(v(j),setTimeout(()=>v(null),3e3))},R=j=>{l(j)},k=async j=>{const Re=j.target.files?.[0];if(Re){try{const Ne=await Re.text(),Ve=c(Ne);Ve.success||(T(Ve.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}j.target.value=""}},N=()=>{y(null),v(null),T(null),A(!1),e()},O=j=>{r(j)},z=()=>{N(),t()};return g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:N}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(yo,{size:18}),g.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsxs("div",{className:"flex border-b border-gray-100",children:[g.jsxs("button",{onClick:()=>A(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",M.length,")"]}),g.jsxs("button",{onClick:()=>A(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[g.jsx($7,{size:14}),"Archief (",D.length,")"]})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${f}px`},children:[U.length===0?g.jsx("div",{className:"p-8 text-center text-gray-500",children:b?g.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),g.jsxs("button",{onClick:z,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[g.jsx($a,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):g.jsx("div",{className:"divide-y divide-gray-100",children:U.map(j=>g.jsx(UTe,{layer:j,isExpanded:m===j.id,onToggleExpand:()=>y(m===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>O(j.id),onExport:()=>R(j.id),onDelete:()=>P(j.id),confirmDelete:x===j.id,onRename:Re=>cs.getState().updateLayer(j.id,{name:Re}),onChangeColor:Re=>cs.getState().updateLayer(j.id,{color:Re})},j.id))}),E&&g.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:E})]}),g.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${f}px`},children:[g.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[g.jsx(z1,{size:16}),g.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),g.jsx("input",{type:"file",accept:".geojson,.json",onChange:k,className:"hidden"})]}),g.jsxs("button",{onClick:z,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[g.jsx($a,{size:16}),g.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const BTe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function UTe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:c,onChangeColor:h}){const[f,m]=X.useState(!1),[y,x]=X.useState(n.name),[v,E]=X.useState(!1),T=X.useRef(null);X.useEffect(()=>{f&&T.current&&(T.current.focus(),T.current.select())},[f]);const b=()=>{x(n.name),m(!0)},A=()=>{const R=y.trim();R&&R!==n.name&&c(R),m(!1)},M=()=>{x(n.name),m(!1)},D=R=>{R.key==="Enter"?A():R.key==="Escape"&&M()},U=n.points.filter(R=>R.status==="completed").length,P=n.points.length;return g.jsxs("div",{className:"bg-white",children:[g.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[g.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?g.jsx(wC,{size:16}):g.jsx(pw,{size:16})}),g.jsxs("div",{className:"relative",children:[g.jsx("button",{onClick:()=>E(!v),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),v&&g.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:BTe.map(R=>g.jsx("button",{onClick:()=>{h(R),E(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${R===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:R}},R))})]}),f?g.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[g.jsx("input",{ref:T,type:"text",value:y,onChange:R=>x(R.target.value),onKeyDown:D,onBlur:A,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),g.jsx("button",{onClick:A,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:g.jsx(oc,{size:16})})]}):g.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[g.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),g.jsx("div",{className:"text-xs text-gray-500",children:P>0?g.jsxs("span",{className:U===P?"text-green-600":"",children:[U,"/",P," voltooid"]}):"Geen punten"})]}),!f&&g.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:g.jsx(Y0,{size:16})}),g.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:g.jsx(Y7,{size:18})}),!n.archived&&g.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?g.jsx(kv,{size:18}):g.jsx(Pv,{size:18})}),g.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?g.jsx(nle,{size:18}):g.jsx($7,{size:18})}),g.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:g.jsx(Cv,{size:18})}),g.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:g.jsx(mc,{size:18})})]}),g.jsx(Un,{children:e&&g.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:g.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&g.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(R=>g.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:R},R))}),n.points.length>0&&g.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(R=>g.jsx("div",{className:"flex items-center gap-2",children:g.jsx("span",{className:`font-medium ${R.status==="completed"?"text-green-600 line-through":R.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:R.name})},R.id)),n.points.length>5&&g.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),g.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function zTe(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=wr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=cs(),o=Gr(),[l,c]=X.useState("all"),[h,f]=X.useState(null),[m,y]=X.useState(""),[x,v]=X.useState(null),E=e?r(e):null,T=14*o.fontScale/100;if(!E)return null;const b=E.points.filter(O=>l==="all"?!0:O.status===l),A=E.points.length,M=E.points.filter(O=>O.status==="completed").length,D=E.points.filter(O=>O.status==="todo").length,U=E.points.filter(O=>O.status==="skipped").length,P=(O,z)=>{i(E.id,O,z)},R=O=>{s(E.id,O,{notes:m}),f(null),y("")},k=O=>{x===O?(a(E.id,O),v(null)):(v(O),setTimeout(()=>v(null),3e3))},N=()=>{f(null),v(null),t()};return g.jsx(Un,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:N}),g.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:E.color}}),g.jsx("span",{className:"font-medium truncate",children:E.name})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:O=>o.setFontScale(parseInt(O.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[g.jsxs("span",{className:"text-orange-800 font-medium",children:[M,"/",A," voltooid"]}),g.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[g.jsxs("span",{className:"text-orange-600",children:[D," te doen"]}),U>0&&g.jsxs("span",{className:"text-gray-500",children:[U," overgeslagen"]})]})]}),g.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(O=>g.jsxs("button",{onClick:()=>c(O),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===O?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[O==="all"&&"Alles",O==="todo"&&"Te doen",O==="completed"&&"Voltooid",O==="skipped"&&"Overgeslagen"]},O))}),g.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:b.length===0?g.jsx("div",{className:"p-8 text-center text-gray-500",children:g.jsx("p",{children:"Geen punten gevonden"})}):g.jsx("div",{className:"divide-y divide-gray-100",children:b.map(O=>g.jsx("div",{className:"p-3",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[g.jsx("button",{onClick:()=>P(O.id,O.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:O.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:g.jsx(oc,{size:14,className:O.status==="completed"?"text-green-600":"text-gray-400"})}),g.jsx("button",{onClick:()=>P(O.id,O.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:O.status==="skipped"?"Markeer als te doen":"Overslaan",children:g.jsx(sle,{size:14,className:O.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),O.photos&&O.photos.length>0&&g.jsxs("div",{className:"relative flex-shrink-0",children:[g.jsx("img",{src:O.photos[0].thumbnailUrl||O.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),O.photos.length>1&&g.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",O.photos.length-1]})]}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:`font-medium truncate ${O.status==="completed"?"text-green-700 line-through":O.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:O.name}),O.sourceLayer&&g.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",O.sourceLayer]})]}),h===O.id?g.jsxs("div",{className:"mt-2",children:[g.jsx("textarea",{value:m,onChange:z=>y(z.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),g.jsxs("div",{className:"flex gap-2 mt-1",children:[g.jsx("button",{onClick:()=>R(O.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),g.jsx("button",{onClick:()=>{f(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):O.notes?g.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.notes}):null,O.url&&g.jsxs("a",{href:O.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[g.jsx(U1,{size:12}),"Link"]})]}),g.jsxs("div",{className:"flex flex-col gap-1",children:[g.jsx("button",{onClick:()=>{f(O.id),y(O.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:g.jsx(yce,{size:14})}),g.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${O.coordinates[1]},${O.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:g.jsx(za,{size:14})}),g.jsx("button",{onClick:()=>k(O.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${x===O.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:x===O.id?"Klik nogmaals":"Verwijderen",children:g.jsx(mc,{size:14})})]})]})},O.id))})})]})]})})}class q5{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function $Te(){const n=_s(c=>c.tracking),e=_s(c=>c.headingSource);_s(c=>c.speed);const t=_s(c=>c.setSmoothedHeading),r=X.useRef(new q5(6)),i=X.useRef(new q5(10)),s=X.useRef(0),a=X.useRef(null),o=33,l=X.useCallback((c,h)=>{const f=performance.now();if(f-s.current<o)return;const m=h==="gps"?r.current:i.current;m.add(c);const y=m.getSmoothed();y!==null&&(s.current=f,t(y))},[t]);X.useEffect(()=>{if(!n)return;const c=f=>{f.coords.heading!==null&&f.coords.speed!==null&&f.coords.speed>.8&&f.coords.accuracy<20&&l(f.coords.heading,"gps")},h=navigator.geolocation.watchPosition(c,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),X.useEffect(()=>{if(!n||e!=="compass")return;let c=0;const h=50,f=y=>{const x=performance.now();if(!(x-c<h)&&(c=x,y.alpha!==null)){const v=(360-y.alpha)%360;l(v,"compass")}},m=y=>{const x=performance.now();x-c<h||(c=x,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",f),window.addEventListener("deviceorientation",m),()=>{window.removeEventListener("deviceorientationabsolute",f),window.removeEventListener("deviceorientation",m)}},[n,e,l]),X.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),X.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function WTe(){const n=pi(i=>i.map),e=Ai(i=>i.setLayerOpacity),t=Ai(i=>i.visible),r=X.useRef(null);X.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const Y5=2e3;function HTe(){const n=lw(m=>m.user),{layers:e,clearAll:t}=cs(),{vondsten:r,clearAll:i}=ol(),s=X.useRef(null),a=X.useRef(!0),o=X.useRef(""),l=X.useRef(""),c=X.useCallback(async m=>{if(n)try{const y=g0(du,"users",n.uid);await t3(y,{layers:m,layersUpdatedAt:n3()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=X.useCallback(async m=>{if(n)try{const y=g0(du,"users",n.uid);await t3(y,{vondsten:m,vondstenUpdatedAt:n3()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),f=X.useCallback(async()=>{if(n)try{const m=g0(du,"users",n.uid),y=await Lne(m);if(y.exists()){const x=y.data();if(x.layers&&Array.isArray(x.layers)){const v=x.layers,E=cs.getState().layers,T=[...v],b=new Set(v.map(A=>A.id));E.forEach(A=>{b.has(A.id)||T.push(A)}),cs.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${v.length} lagen geladen uit cloud`)}if(x.vondsten&&Array.isArray(x.vondsten)){const v=x.vondsten,E=ol.getState().vondsten,T=[...v],b=new Set(v.map(A=>A.id));E.forEach(A=>{b.has(A.id)||T.push(A)}),ol.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${v.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await c(e),await h(r);a.current=!1}catch(m){console.error(" Fout bij laden uit cloud:",m),a.current=!1}},[n,e,r,c,h]);return X.useEffect(()=>{n?(a.current=!0,f()):(a.current=!0,o.current="",l.current="")},[n?.uid]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(e);if(m!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=m,c(e)},Y5),()=>{s.current&&clearTimeout(s.current)}},[n,e,c]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(r);if(m!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=m,h(r)},Y5),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:c,syncVondstenToCloud:h}}function KTe(){$Te(),WTe(),HTe();const e=14*Gr(o=>o.fontScale)/100,t=wr(o=>o.vondstFormOpen),r=wr(o=>o.vondstFormLocation),i=wr(o=>o.closeVondstForm),s=wr(o=>o.routeDashboardOpen),a=wr(o=>o.toggleRouteDashboard);return g.jsx(DSe,{children:g.jsxs("div",{style:{fontSize:`${e}px`},children:[g.jsx(Sre,{}),g.jsx(pue,{}),g.jsx(ITe,{}),g.jsx(USe,{}),g.jsx(kTe,{}),g.jsx(mTe,{}),g.jsx(pTe,{}),g.jsx(yTe,{}),g.jsx(xTe,{}),g.jsx(xSe,{}),g.jsx(ESe,{}),g.jsx(NSe,{}),g.jsx(gue,{}),g.jsx(dTe,{}),g.jsx(fTe,{}),g.jsx(LSe,{}),g.jsx(_ue,{}),g.jsx(Eue,{}),g.jsx(MSe,{}),g.jsx(sTe,{}),g.jsx(ISe,{}),g.jsx(oTe,{}),g.jsx(CSe,{}),g.jsx(tTe,{}),g.jsx(MTe,{}),g.jsx(VTe,{}),g.jsx(GTe,{}),g.jsx(zTe,{}),g.jsx(ATe,{isOpen:s,onClose:a}),g.jsx(Un,{children:t&&g.jsx(GB,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${aE}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");rz.createRoot(document.getElementById("root")).render(g.jsx(KTe,{}));export{Us as C,er as F,BC as G,NK as I,bi as L,gi as P,mn as S,vh as T,hc as V,gX as a,aX as b,Gu as c,Xn as d,mo as e,vr as f,Ir as g,m1 as h,bn as p,nG as r};
//# sourceMappingURL=index-C3RQCjZr.js.map
