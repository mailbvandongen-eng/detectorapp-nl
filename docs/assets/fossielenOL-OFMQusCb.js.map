{"version":3,"file":"fossielenOL-OFMQusCb.js","sources":["../../src/layers/fossielUtils.ts","../../src/layers/fossielenOL.ts"],"sourcesContent":["import { Vector as VectorLayer } from 'ol/layer'\nimport { Vector as VectorSource } from 'ol/source'\nimport Feature from 'ol/Feature'\nimport Point from 'ol/geom/Point'\nimport { fromLonLat } from 'ol/proj'\nimport { LAYER_STYLES } from './iconStyles'\n\n// Extended PBDB Occurrence interface with all useful fields\nexport interface PBDBOccurrence {\n  oid: string           // occurrence ID\n  tna: string           // taxon name\n  idn: string           // identified name (full species)\n  lng: string           // longitude\n  lat: string           // latitude\n  oei: string           // early interval (period)\n  eag: number           // early age (Ma)\n  lag: number           // late age (Ma)\n  ggc: string           // geographic context\n  phl: string           // phylum\n  cll: string           // class\n  odl: string           // order\n  fml: string           // family\n  gnl: string           // genus\n  cnm: string           // collection name\n  sfm: string           // formation\n  smb: string           // member\n  lt1: string           // lithology (rock type)\n  env: string           // environment\n}\n\nexport interface PBDBResponse<T> {\n  records: T[]\n}\n\nconst COUNTRY_NAMES: Record<string, string> = {\n  NL: 'Nederland',\n  BE: 'België',\n  DE: 'Duitsland',\n  FR: 'Frankrijk'\n}\n\n// Create fossil occurrences layer (individual fossil finds)\nexport async function createFossilOccurrenceLayer(\n  countryCode: string,\n  title: string\n): Promise<VectorLayer<VectorSource>> {\n  try {\n    const response = await fetch(\n      `https://paleobiodb.org/data1.2/occs/list.json?cc=${countryCode}&show=coords,loc,class,strat,lith,env`\n    )\n\n    if (!response.ok) {\n      throw new Error(`PBDB API error: ${response.status}`)\n    }\n\n    const data: PBDBResponse<PBDBOccurrence> = await response.json()\n\n    const features = data.records\n      .filter(record => record.lng && record.lat)\n      .map(record => {\n        const feature = new Feature({\n          geometry: new Point(fromLonLat([\n            parseFloat(record.lng),\n            parseFloat(record.lat)\n          ]))\n        })\n\n        // Build taxonomic hierarchy\n        const taxonomie = [record.phl, record.cll, record.odl, record.fml]\n          .filter(Boolean)\n          .join(' → ')\n\n        // Format age\n        let ouderdom = 'Onbekend'\n        if (record.eag && record.lag) {\n          ouderdom = record.eag === record.lag\n            ? `${record.eag} Ma`\n            : `${record.eag} - ${record.lag} Ma`\n        } else if (record.eag) {\n          ouderdom = `${record.eag} Ma`\n        }\n\n        feature.setProperties({\n          naam: record.idn || record.tna || 'Onbekend',\n          genus: record.gnl || '',\n          periode: record.oei || 'Onbekend',\n          ouderdom,\n          taxonomie: taxonomie || 'Onbekend',\n          klasse: record.cll || 'Onbekend',\n          formatie: record.sfm || '',\n          lid: record.smb || '',\n          gesteente: record.lt1 || '',\n          milieu: record.env || '',\n          vindplaats: record.cnm || '',\n          locatie: record.ggc || COUNTRY_NAMES[countryCode] || countryCode,\n          bron: 'Paleobiology Database'\n        })\n\n        return feature\n      })\n\n    const source = new VectorSource({ features })\n\n    const layer = new VectorLayer({\n      source,\n      properties: { title },\n      visible: false,\n      zIndex: 22,\n      style: LAYER_STYLES.fossil()\n    })\n\n    console.log(`✓ ${title} loaded (${features.length} occurrences from PBDB)`)\n    return layer\n\n  } catch (error) {\n    console.error(`❌ Failed to load ${title}:`, error)\n    return new VectorLayer({\n      source: new VectorSource(),\n      properties: { title },\n      visible: false,\n      zIndex: 22,\n      style: LAYER_STYLES.fossil()\n    })\n  }\n}\n","import { createFossilOccurrenceLayer } from './fossielUtils'\n\nexport async function createFossielenLayerOL() {\n  return createFossilOccurrenceLayer('NL', 'Fossielen Nederland')\n}\n"],"names":["COUNTRY_NAMES","createFossilOccurrenceLayer","countryCode","title","response","features","record","feature","Feature","Point","fromLonLat","taxonomie","ouderdom","source","VectorSource","layer","VectorLayer","LAYER_STYLES","error","createFossielenLayerOL"],"mappings":"kHAkCA,MAAMA,EAAwC,CAC5C,GAAI,YACJ,GAAI,SACJ,GAAI,YACJ,GAAI,WACN,EAGA,eAAsBC,EACpBC,EACAC,EACoC,CACpC,GAAI,CACF,MAAMC,EAAW,MAAM,MACrB,oDAAoDF,CAAW,uCAAA,EAGjE,GAAI,CAACE,EAAS,GACZ,MAAM,IAAI,MAAM,mBAAmBA,EAAS,MAAM,EAAE,EAKtD,MAAMC,GAFqC,MAAMD,EAAS,KAAA,GAEpC,QACnB,OAAOE,GAAUA,EAAO,KAAOA,EAAO,GAAG,EACzC,IAAIA,GAAU,CACb,MAAMC,EAAU,IAAIC,EAAQ,CAC1B,SAAU,IAAIC,EAAMC,EAAW,CAC7B,WAAWJ,EAAO,GAAG,EACrB,WAAWA,EAAO,GAAG,CAAA,CACtB,CAAC,CAAA,CACH,EAGKK,EAAY,CAACL,EAAO,IAAKA,EAAO,IAAKA,EAAO,IAAKA,EAAO,GAAG,EAC9D,OAAO,OAAO,EACd,KAAK,KAAK,EAGb,IAAIM,EAAW,WACf,OAAIN,EAAO,KAAOA,EAAO,IACvBM,EAAWN,EAAO,MAAQA,EAAO,IAC7B,GAAGA,EAAO,GAAG,MACb,GAAGA,EAAO,GAAG,MAAMA,EAAO,GAAG,MACxBA,EAAO,MAChBM,EAAW,GAAGN,EAAO,GAAG,OAG1BC,EAAQ,cAAc,CACpB,KAAMD,EAAO,KAAOA,EAAO,KAAO,WAClC,MAAOA,EAAO,KAAO,GACrB,QAASA,EAAO,KAAO,WACvB,SAAAM,EACA,UAAWD,GAAa,WACxB,OAAQL,EAAO,KAAO,WACtB,SAAUA,EAAO,KAAO,GACxB,IAAKA,EAAO,KAAO,GACnB,UAAWA,EAAO,KAAO,GACzB,OAAQA,EAAO,KAAO,GACtB,WAAYA,EAAO,KAAO,GAC1B,QAASA,EAAO,KAAON,EAAcE,CAAW,GAAKA,EACrD,KAAM,uBAAA,CACP,EAEMK,CACT,CAAC,EAEGM,EAAS,IAAIC,EAAa,CAAE,SAAAT,EAAU,EAEtCU,EAAQ,IAAIC,EAAY,CAC5B,OAAAH,EACA,WAAY,CAAE,MAAAV,CAAA,EACd,QAAS,GACT,OAAQ,GACR,MAAOc,EAAa,OAAA,CAAO,CAC5B,EAED,eAAQ,IAAI,KAAKd,CAAK,YAAYE,EAAS,MAAM,yBAAyB,EACnEU,CAET,OAASG,EAAO,CACd,eAAQ,MAAM,oBAAoBf,CAAK,IAAKe,CAAK,EAC1C,IAAIF,EAAY,CACrB,OAAQ,IAAIF,EACZ,WAAY,CAAE,MAAAX,CAAA,EACd,QAAS,GACT,OAAQ,GACR,MAAOc,EAAa,OAAA,CAAO,CAC5B,CACH,CACF,CC1HA,eAAsBE,GAAyB,CAC7C,OAAOlB,EAA4B,KAAM,qBAAqB,CAChE"}