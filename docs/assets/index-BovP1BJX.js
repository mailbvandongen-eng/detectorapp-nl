const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/amkOL-CUV9K-s8.js","assets/layerLoaderOL-B7bfrluY.js","assets/romeinsOL-CymOP1yQ.js","assets/kastelenOL-ogvVG7WZ.js","assets/iconStyles-DLgXdyu8.js","assets/hunebeddenOL-aaDz7Hid.js","assets/uikavArcheoPuntenOL-pBhxqYvY.js","assets/uikavVlakkenOL-COLC5Zi_.js","assets/uikavBufferlaagOL-CKyhCpOv.js","assets/uikavExpertOL-Crtqdaij.js","assets/uikavUiterwaardenOL-BK1ksnWk.js","assets/speeltuinenOL-FcagOfoa.js","assets/museaOL-9wbPMt9D.js","assets/strandjesOL-CLRXivPX.js","assets/parkenOL-CicDLTpN.js","assets/fossielenOL-ClAULRH6.js","assets/fossielUtils-hRfTmw1V.js","assets/fossielenBelgieOL-BPQpqc5E.js","assets/fossielenDuitslandOL-Bn_S6-MJ.js","assets/fossielenFrankrijkOL-BKZNmTsI.js","assets/bunkersOL-C08ZKy_F.js","assets/grafheuvelsOL-c30R6Ib1.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Ix(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var R1={exports:{}},Xd={},A1={exports:{}},st={};var _R;function Y5(){if(_R)return st;_R=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function m(K){return K===null||typeof K!="object"?null:(K=g&&K[g]||K["@@iterator"],typeof K=="function"?K:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,I={};function E(K,W,be){this.props=K,this.context=W,this.refs=I,this.updater=be||y}E.prototype.isReactComponent={},E.prototype.setState=function(K,W){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,W,"setState")},E.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function A(){}A.prototype=E.prototype;function b(K,W,be){this.props=K,this.context=W,this.refs=I,this.updater=be||y}var N=b.prototype=new A;N.constructor=b,w(N,E.prototype),N.isPureReactComponent=!0;var D=Array.isArray,O=Object.prototype.hasOwnProperty,$={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function C(K,W,be){var ie,X={},P=null,Ee=null;if(W!=null)for(ie in W.ref!==void 0&&(Ee=W.ref),W.key!==void 0&&(P=""+W.key),W)O.call(W,ie)&&!k.hasOwnProperty(ie)&&(X[ie]=W[ie]);var Y=arguments.length-2;if(Y===1)X.children=be;else if(1<Y){for(var Ie=Array(Y),Z=0;Z<Y;Z++)Ie[Z]=arguments[Z+2];X.children=Ie}if(K&&K.defaultProps)for(ie in Y=K.defaultProps,Y)X[ie]===void 0&&(X[ie]=Y[ie]);return{$$typeof:n,type:K,key:P,ref:Ee,props:X,_owner:$.current}}function L(K,W){return{$$typeof:n,type:K.type,key:W,ref:K.ref,props:K.props,_owner:K._owner}}function j(K){return typeof K=="object"&&K!==null&&K.$$typeof===n}function G(K){var W={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(be){return W[be]})}var z=/\/+/g;function V(K,W){return typeof K=="object"&&K!==null&&K.key!=null?G(""+K.key):W.toString(36)}function de(K,W,be,ie,X){var P=typeof K;(P==="undefined"||P==="boolean")&&(K=null);var Ee=!1;if(K===null)Ee=!0;else switch(P){case"string":case"number":Ee=!0;break;case"object":switch(K.$$typeof){case n:case e:Ee=!0}}if(Ee)return Ee=K,X=X(Ee),K=ie===""?"."+V(Ee,0):ie,D(X)?(be="",K!=null&&(be=K.replace(z,"$&/")+"/"),de(X,W,be,"",function(Z){return Z})):X!=null&&(j(X)&&(X=L(X,be+(!X.key||Ee&&Ee.key===X.key?"":(""+X.key).replace(z,"$&/")+"/")+K)),W.push(X)),1;if(Ee=0,ie=ie===""?".":ie+":",D(K))for(var Y=0;Y<K.length;Y++){P=K[Y];var Ie=ie+V(P,Y);Ee+=de(P,W,be,Ie,X)}else if(Ie=m(K),typeof Ie=="function")for(K=Ie.call(K),Y=0;!(P=K.next()).done;)P=P.value,Ie=ie+V(P,Y++),Ee+=de(P,W,be,Ie,X);else if(P==="object")throw W=String(K),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return Ee}function Pe(K,W,be){if(K==null)return K;var ie=[],X=0;return de(K,ie,"","",function(P){return W.call(be,P,X++)}),ie}function ue(K){if(K._status===-1){var W=K._result;W=W(),W.then(function(be){(K._status===0||K._status===-1)&&(K._status=1,K._result=be)},function(be){(K._status===0||K._status===-1)&&(K._status=2,K._result=be)}),K._status===-1&&(K._status=0,K._result=W)}if(K._status===1)return K._result.default;throw K._result}var fe={current:null},Q={transition:null},ge={ReactCurrentDispatcher:fe,ReactCurrentBatchConfig:Q,ReactCurrentOwner:$};function he(){throw Error("act(...) is not supported in production builds of React.")}return st.Children={map:Pe,forEach:function(K,W,be){Pe(K,function(){W.apply(this,arguments)},be)},count:function(K){var W=0;return Pe(K,function(){W++}),W},toArray:function(K){return Pe(K,function(W){return W})||[]},only:function(K){if(!j(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},st.Component=E,st.Fragment=t,st.Profiler=r,st.PureComponent=b,st.StrictMode=i,st.Suspense=c,st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ge,st.act=he,st.cloneElement=function(K,W,be){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var ie=w({},K.props),X=K.key,P=K.ref,Ee=K._owner;if(W!=null){if(W.ref!==void 0&&(P=W.ref,Ee=$.current),W.key!==void 0&&(X=""+W.key),K.type&&K.type.defaultProps)var Y=K.type.defaultProps;for(Ie in W)O.call(W,Ie)&&!k.hasOwnProperty(Ie)&&(ie[Ie]=W[Ie]===void 0&&Y!==void 0?Y[Ie]:W[Ie])}var Ie=arguments.length-2;if(Ie===1)ie.children=be;else if(1<Ie){Y=Array(Ie);for(var Z=0;Z<Ie;Z++)Y[Z]=arguments[Z+2];ie.children=Y}return{$$typeof:n,type:K.type,key:X,ref:P,props:ie,_owner:Ee}},st.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:s,_context:K},K.Consumer=K},st.createElement=C,st.createFactory=function(K){var W=C.bind(null,K);return W.type=K,W},st.createRef=function(){return{current:null}},st.forwardRef=function(K){return{$$typeof:a,render:K}},st.isValidElement=j,st.lazy=function(K){return{$$typeof:d,_payload:{_status:-1,_result:K},_init:ue}},st.memo=function(K,W){return{$$typeof:h,type:K,compare:W===void 0?null:W}},st.startTransition=function(K){var W=Q.transition;Q.transition={};try{K()}finally{Q.transition=W}},st.unstable_act=he,st.useCallback=function(K,W){return fe.current.useCallback(K,W)},st.useContext=function(K){return fe.current.useContext(K)},st.useDebugValue=function(){},st.useDeferredValue=function(K){return fe.current.useDeferredValue(K)},st.useEffect=function(K,W){return fe.current.useEffect(K,W)},st.useId=function(){return fe.current.useId()},st.useImperativeHandle=function(K,W,be){return fe.current.useImperativeHandle(K,W,be)},st.useInsertionEffect=function(K,W){return fe.current.useInsertionEffect(K,W)},st.useLayoutEffect=function(K,W){return fe.current.useLayoutEffect(K,W)},st.useMemo=function(K,W){return fe.current.useMemo(K,W)},st.useReducer=function(K,W,be){return fe.current.useReducer(K,W,be)},st.useRef=function(K){return fe.current.useRef(K)},st.useState=function(K){return fe.current.useState(K)},st.useSyncExternalStore=function(K,W,be){return fe.current.useSyncExternalStore(K,W,be)},st.useTransition=function(){return fe.current.useTransition()},st.version="18.3.1",st}var yR;function Vg(){return yR||(yR=1,A1.exports=Y5()),A1.exports}var vR;function X5(){if(vR)return Xd;vR=1;var n=Vg(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,c,h){var d,g={},m=null,y=null;h!==void 0&&(m=""+h),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(y=c.ref);for(d in c)i.call(c,d)&&!s.hasOwnProperty(d)&&(g[d]=c[d]);if(a&&a.defaultProps)for(d in c=a.defaultProps,c)g[d]===void 0&&(g[d]=c[d]);return{$$typeof:e,type:a,key:m,ref:y,props:g,_owner:r.current}}return Xd.Fragment=t,Xd.jsx=o,Xd.jsxs=o,Xd}var ER;function Q5(){return ER||(ER=1,R1.exports=X5()),R1.exports}var T=Q5(),bp={},P1={exports:{}},Mi={},C1={exports:{}},b1={};var wR;function Z5(){return wR||(wR=1,(function(n){function e(Q,ge){var he=Q.length;Q.push(ge);e:for(;0<he;){var K=he-1>>>1,W=Q[K];if(0<r(W,ge))Q[K]=ge,Q[he]=W,he=K;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var ge=Q[0],he=Q.pop();if(he!==ge){Q[0]=he;e:for(var K=0,W=Q.length,be=W>>>1;K<be;){var ie=2*(K+1)-1,X=Q[ie],P=ie+1,Ee=Q[P];if(0>r(X,he))P<W&&0>r(Ee,X)?(Q[K]=Ee,Q[P]=he,K=P):(Q[K]=X,Q[ie]=he,K=ie);else if(P<W&&0>r(Ee,he))Q[K]=Ee,Q[P]=he,K=P;else break e}}return ge}function r(Q,ge){var he=Q.sortIndex-ge.sortIndex;return he!==0?he:Q.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],h=[],d=1,g=null,m=3,y=!1,w=!1,I=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Q){for(var ge=t(h);ge!==null;){if(ge.callback===null)i(h);else if(ge.startTime<=Q)i(h),ge.sortIndex=ge.expirationTime,e(c,ge);else break;ge=t(h)}}function D(Q){if(I=!1,N(Q),!w)if(t(c)!==null)w=!0,ue(O);else{var ge=t(h);ge!==null&&fe(D,ge.startTime-Q)}}function O(Q,ge){w=!1,I&&(I=!1,A(C),C=-1),y=!0;var he=m;try{for(N(ge),g=t(c);g!==null&&(!(g.expirationTime>ge)||Q&&!G());){var K=g.callback;if(typeof K=="function"){g.callback=null,m=g.priorityLevel;var W=K(g.expirationTime<=ge);ge=n.unstable_now(),typeof W=="function"?g.callback=W:g===t(c)&&i(c),N(ge)}else i(c);g=t(c)}if(g!==null)var be=!0;else{var ie=t(h);ie!==null&&fe(D,ie.startTime-ge),be=!1}return be}finally{g=null,m=he,y=!1}}var $=!1,k=null,C=-1,L=5,j=-1;function G(){return!(n.unstable_now()-j<L)}function z(){if(k!==null){var Q=n.unstable_now();j=Q;var ge=!0;try{ge=k(!0,Q)}finally{ge?V():($=!1,k=null)}}else $=!1}var V;if(typeof b=="function")V=function(){b(z)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Pe=de.port2;de.port1.onmessage=z,V=function(){Pe.postMessage(null)}}else V=function(){E(z,0)};function ue(Q){k=Q,$||($=!0,V())}function fe(Q,ge){C=E(function(){Q(n.unstable_now())},ge)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){w||y||(w=!0,ue(O))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(Q){switch(m){case 1:case 2:case 3:var ge=3;break;default:ge=m}var he=m;m=ge;try{return Q()}finally{m=he}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,ge){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var he=m;m=Q;try{return ge()}finally{m=he}},n.unstable_scheduleCallback=function(Q,ge,he){var K=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?K+he:K):he=K,Q){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=he+W,Q={id:d++,callback:ge,priorityLevel:Q,startTime:he,expirationTime:W,sortIndex:-1},he>K?(Q.sortIndex=he,e(h,Q),t(c)===null&&Q===t(h)&&(I?(A(C),C=-1):I=!0,fe(D,he-K))):(Q.sortIndex=W,e(c,Q),w||y||(w=!0,ue(O))),Q},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(Q){var ge=m;return function(){var he=m;m=ge;try{return Q.apply(this,arguments)}finally{m=he}}}})(b1)),b1}var xR;function J5(){return xR||(xR=1,C1.exports=Z5()),C1.exports}var SR;function e6(){if(SR)return Mi;SR=1;var n=Vg(),e=J5();function t(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(l,u){o(l,u),o(l+"Capture",u)}function o(l,u){for(r[l]=u,l=0;l<u.length;l++)i.add(u[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function m(l){return c.call(g,l)?!0:c.call(d,l)?!1:h.test(l)?g[l]=!0:(d[l]=!0,!1)}function y(l,u,f,_){if(f!==null&&f.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return _?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function w(l,u,f,_){if(u===null||typeof u>"u"||y(l,u,f,_))return!0;if(_)return!1;if(f!==null)switch(f.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function I(l,u,f,_,v,x,M){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=_,this.attributeNamespace=v,this.mustUseProperty=f,this.propertyName=l,this.type=u,this.sanitizeURL=x,this.removeEmptyString=M}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){E[l]=new I(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];E[u]=new I(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){E[l]=new I(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){E[l]=new I(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){E[l]=new I(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){E[l]=new I(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){E[l]=new I(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){E[l]=new I(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){E[l]=new I(l,5,!1,l.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function b(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(A,b);E[u]=new I(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(A,b);E[u]=new I(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(A,b);E[u]=new I(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){E[l]=new I(l,1,!1,l.toLowerCase(),null,!1,!1)}),E.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){E[l]=new I(l,1,!1,l.toLowerCase(),null,!0,!0)});function N(l,u,f,_){var v=E.hasOwnProperty(u)?E[u]:null;(v!==null?v.type!==0:_||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(w(u,f,v,_)&&(f=null),_||v===null?m(u)&&(f===null?l.removeAttribute(u):l.setAttribute(u,""+f)):v.mustUseProperty?l[v.propertyName]=f===null?v.type===3?!1:"":f:(u=v.attributeName,_=v.attributeNamespace,f===null?l.removeAttribute(u):(v=v.type,f=v===3||v===4&&f===!0?"":""+f,_?l.setAttributeNS(_,u,f):l.setAttribute(u,f))))}var D=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),$=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),G=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),Pe=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),fe=Symbol.for("react.offscreen"),Q=Symbol.iterator;function ge(l){return l===null||typeof l!="object"?null:(l=Q&&l[Q]||l["@@iterator"],typeof l=="function"?l:null)}var he=Object.assign,K;function W(l){if(K===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);K=u&&u[1]||""}return`
`+K+l}var be=!1;function ie(l,u){if(!l||be)return"";be=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(re){var _=re}Reflect.construct(l,[],u)}else{try{u.call()}catch(re){_=re}l.call(u.prototype)}else{try{throw Error()}catch(re){_=re}l()}}catch(re){if(re&&_&&typeof re.stack=="string"){for(var v=re.stack.split(`
`),x=_.stack.split(`
`),M=v.length-1,B=x.length-1;1<=M&&0<=B&&v[M]!==x[B];)B--;for(;1<=M&&0<=B;M--,B--)if(v[M]!==x[B]){if(M!==1||B!==1)do if(M--,B--,0>B||v[M]!==x[B]){var H=`
`+v[M].replace(" at new "," at ");return l.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",l.displayName)),H}while(1<=M&&0<=B);break}}}finally{be=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?W(l):""}function X(l){switch(l.tag){case 5:return W(l.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return l=ie(l.type,!1),l;case 11:return l=ie(l.type.render,!1),l;case 1:return l=ie(l.type,!0),l;default:return""}}function P(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case k:return"Fragment";case $:return"Portal";case L:return"Profiler";case C:return"StrictMode";case V:return"Suspense";case de:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case G:return(l.displayName||"Context")+".Consumer";case j:return(l._context.displayName||"Context")+".Provider";case z:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Pe:return u=l.displayName||null,u!==null?u:P(l.type)||"Memo";case ue:u=l._payload,l=l._init;try{return P(l(u))}catch{}}return null}function Ee(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P(u);case 8:return u===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function Y(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ie(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Z(l){var u=Ie(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),_=""+l[u];if(!l.hasOwnProperty(u)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var v=f.get,x=f.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return v.call(this)},set:function(M){_=""+M,x.call(this,M)}}),Object.defineProperty(l,u,{enumerable:f.enumerable}),{getValue:function(){return _},setValue:function(M){_=""+M},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function U(l){l._valueTracker||(l._valueTracker=Z(l))}function ae(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var f=u.getValue(),_="";return l&&(_=Ie(l)?l.checked?"true":"false":l.value),l=_,l!==f?(u.setValue(l),!0):!1}function Xe(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function rt(l,u){var f=u.checked;return he({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function ht(l,u){var f=u.defaultValue==null?"":u.defaultValue,_=u.checked!=null?u.checked:u.defaultChecked;f=Y(u.value!=null?u.value:f),l._wrapperState={initialChecked:_,initialValue:f,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function Ft(l,u){u=u.checked,u!=null&&N(l,"checked",u,!1)}function an(l,u){Ft(l,u);var f=Y(u.value),_=u.type;if(f!=null)_==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(_==="submit"||_==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?Nt(l,u.type,f):u.hasOwnProperty("defaultValue")&&Nt(l,u.type,Y(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function ar(l,u,f){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var _=u.type;if(!(_!=="submit"&&_!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,f||u===l.value||(l.value=u),l.defaultValue=u}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function Nt(l,u,f){(u!=="number"||Xe(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var It=Array.isArray;function Mn(l,u,f,_){if(l=l.options,u){u={};for(var v=0;v<f.length;v++)u["$"+f[v]]=!0;for(f=0;f<l.length;f++)v=u.hasOwnProperty("$"+l[f].value),l[f].selected!==v&&(l[f].selected=v),v&&_&&(l[f].defaultSelected=!0)}else{for(f=""+Y(f),u=null,v=0;v<l.length;v++){if(l[v].value===f){l[v].selected=!0,_&&(l[v].defaultSelected=!0);return}u!==null||l[v].disabled||(u=l[v])}u!==null&&(u.selected=!0)}}function lr(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return he({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function $t(l,u){var f=u.value;if(f==null){if(f=u.children,u=u.defaultValue,f!=null){if(u!=null)throw Error(t(92));if(It(f)){if(1<f.length)throw Error(t(93));f=f[0]}u=f}u==null&&(u=""),f=u}l._wrapperState={initialValue:Y(f)}}function Go(l,u){var f=Y(u.value),_=Y(u.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),u.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),_!=null&&(l.defaultValue=""+_)}function cr(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function ns(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nr(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?ns(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var is,dl=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,f,_,v){MSApp.execUnsafeLocalFunction(function(){return l(u,f,_,v)})}:l})(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(is=is||document.createElement("div"),is.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=is.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function rs(l,u){if(u){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=u;return}}l.textContent=u}var ur={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yc=["Webkit","ms","Moz","O"];Object.keys(ur).forEach(function(l){Yc.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),ur[u]=ur[l]})});function ss(l,u,f){return u==null||typeof u=="boolean"||u===""?"":f||typeof u!="number"||u===0||ur.hasOwnProperty(l)&&ur[l]?(""+u).trim():u+"px"}function Qs(l,u){l=l.style;for(var f in u)if(u.hasOwnProperty(f)){var _=f.indexOf("--")===0,v=ss(f,u[f],_);f==="float"&&(f="cssFloat"),_?l.setProperty(f,v):l[f]=v}}var Uo=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gi(l,u){if(u){if(Uo[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function Zs(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var os=null;function as(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var mi=null,pi=null,Mt=null;function Bo(l){if(l=Od(l)){if(typeof mi!="function")throw Error(t(280));var u=l.stateNode;u&&(u=Wm(u),mi(l.stateNode,l.type,u))}}function Or(l){pi?Mt?Mt.push(l):Mt=[l]:pi=l}function ln(){if(pi){var l=pi,u=Mt;if(Mt=pi=null,Bo(l),u)for(l=0;l<u.length;l++)Bo(u[l])}}function hr(l,u){return l(u)}function Gn(){}var cn=!1;function Un(l,u,f){if(cn)return l(u,f);cn=!0;try{return hr(l,u,f)}finally{cn=!1,(pi!==null||Mt!==null)&&(Gn(),ln())}}function Bn(l,u){var f=l.stateNode;if(f===null)return null;var _=Wm(f);if(_===null)return null;f=_[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(l=l.type,_=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!_;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(t(231,u,typeof f));return f}var kn=!1;if(a)try{var _t={};Object.defineProperty(_t,"passive",{get:function(){kn=!0}}),window.addEventListener("test",_t,_t),window.removeEventListener("test",_t,_t)}catch{kn=!1}function gn(l,u,f,_,v,x,M,B,H){var re=Array.prototype.slice.call(arguments,3);try{u.apply(f,re)}catch(_e){this.onError(_e)}}var xn=!1,dr=null,Xc=!1,fr=null,Sm={onError:function(l){xn=!0,dr=l}};function Im(l,u,f,_,v,x,M,B,H){xn=!1,dr=null,gn.apply(Sm,arguments)}function cd(l,u,f,_,v,x,M,B,H){if(Im.apply(this,arguments),xn){if(xn){var re=dr;xn=!1,dr=null}else throw Error(t(198));Xc||(Xc=!0,fr=re)}}function Dr(l){var u=l,f=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(f=u.return),l=u.return;while(l)}return u.tag===3?f:null}function ud(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function Tm(l){if(Dr(l)!==l)throw Error(t(188))}function Rm(l){var u=l.alternate;if(!u){if(u=Dr(l),u===null)throw Error(t(188));return u!==l?null:l}for(var f=l,_=u;;){var v=f.return;if(v===null)break;var x=v.alternate;if(x===null){if(_=v.return,_!==null){f=_;continue}break}if(v.child===x.child){for(x=v.child;x;){if(x===f)return Tm(v),l;if(x===_)return Tm(v),u;x=x.sibling}throw Error(t(188))}if(f.return!==_.return)f=v,_=x;else{for(var M=!1,B=v.child;B;){if(B===f){M=!0,f=v,_=x;break}if(B===_){M=!0,_=v,f=x;break}B=B.sibling}if(!M){for(B=x.child;B;){if(B===f){M=!0,f=x,_=v;break}if(B===_){M=!0,_=x,f=v;break}B=B.sibling}if(!M)throw Error(t(189))}}if(f.alternate!==_)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?l:u}function Am(l){return l=Rm(l),l!==null?fl(l):null}function fl(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=fl(l);if(u!==null)return u;l=l.sibling}return null}var hd=e.unstable_scheduleCallback,Qc=e.unstable_cancelCallback,gl=e.unstable_shouldYield,Js=e.unstable_requestPaint,jt=e.unstable_now,iv=e.unstable_getCurrentPriorityLevel,Zc=e.unstable_ImmediatePriority,dd=e.unstable_UserBlockingPriority,ml=e.unstable_NormalPriority,fd=e.unstable_LowPriority,Jc=e.unstable_IdlePriority,pl=null,Bi=null;function Pm(l){if(Bi&&typeof Bi.onCommitFiberRoot=="function")try{Bi.onCommitFiberRoot(pl,l,void 0,(l.current.flags&128)===128)}catch{}}var zi=Math.clz32?Math.clz32:_l,ls=Math.log,gr=Math.LN2;function _l(l){return l>>>=0,l===0?32:31-(ls(l)/gr|0)|0}var cs=64,zo=4194304;function yt(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function eo(l,u){var f=l.pendingLanes;if(f===0)return 0;var _=0,v=l.suspendedLanes,x=l.pingedLanes,M=f&268435455;if(M!==0){var B=M&~v;B!==0?_=yt(B):(x&=M,x!==0&&(_=yt(x)))}else M=f&~v,M!==0?_=yt(M):x!==0&&(_=yt(x));if(_===0)return 0;if(u!==0&&u!==_&&(u&v)===0&&(v=_&-_,x=u&-u,v>=x||v===16&&(x&4194240)!==0))return u;if((_&4)!==0&&(_|=f&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=_;0<u;)f=31-zi(u),v=1<<f,_|=l[f],u&=~v;return _}function yl(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vl(l,u){for(var f=l.suspendedLanes,_=l.pingedLanes,v=l.expirationTimes,x=l.pendingLanes;0<x;){var M=31-zi(x),B=1<<M,H=v[M];H===-1?((B&f)===0||(B&_)!==0)&&(v[M]=yl(B,u)):H<=u&&(l.expiredLanes|=B),x&=~B}}function gd(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function md(){var l=cs;return cs<<=1,(cs&4194240)===0&&(cs=64),l}function pd(l){for(var u=[],f=0;31>f;f++)u.push(l);return u}function El(l,u,f){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-zi(u),l[u]=f}function rv(l,u){var f=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<f;){var v=31-zi(f),x=1<<v;u[v]=0,_[v]=-1,l[v]=-1,f&=~x}}function _d(l,u){var f=l.entangledLanes|=u;for(l=l.entanglements;f;){var _=31-zi(f),v=1<<_;v&u|l[_]&u&&(l[_]|=u),f&=~v}}var ct=0;function us(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var yd,eu,vd,Ed,wd,hs=!1,tu=[],ds=null,fs=null,zn=null,wl=new Map,to=new Map,$i=[],Cm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $o(l,u){switch(l){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":zn=null;break;case"pointerover":case"pointerout":wl.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":to.delete(u.pointerId)}}function Vr(l,u,f,_,v,x){return l===null||l.nativeEvent!==x?(l={blockedOn:u,domEventName:f,eventSystemFlags:_,nativeEvent:x,targetContainers:[v]},u!==null&&(u=Od(u),u!==null&&eu(u)),l):(l.eventSystemFlags|=_,u=l.targetContainers,v!==null&&u.indexOf(v)===-1&&u.push(v),l)}function bm(l,u,f,_,v){switch(u){case"focusin":return ds=Vr(ds,l,u,f,_,v),!0;case"dragenter":return fs=Vr(fs,l,u,f,_,v),!0;case"mouseover":return zn=Vr(zn,l,u,f,_,v),!0;case"pointerover":var x=v.pointerId;return wl.set(x,Vr(wl.get(x)||null,l,u,f,_,v)),!0;case"gotpointercapture":return x=v.pointerId,to.set(x,Vr(to.get(x)||null,l,u,f,_,v)),!0}return!1}function nu(l){var u=Tl(l.target);if(u!==null){var f=Dr(u);if(f!==null){if(u=f.tag,u===13){if(u=ud(f),u!==null){l.blockedOn=u,wd(l.priority,function(){vd(f)});return}}else if(u===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function kt(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var f=iu(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var _=new f.constructor(f.type,f);os=_,f.target.dispatchEvent(_),os=null}else return u=Od(f),u!==null&&eu(u),l.blockedOn=f,!1;u.shift()}return!0}function Mm(l,u,f){kt(l)&&f.delete(u)}function sv(){hs=!1,ds!==null&&kt(ds)&&(ds=null),fs!==null&&kt(fs)&&(fs=null),zn!==null&&kt(zn)&&(zn=null),wl.forEach(Mm),to.forEach(Mm)}function Wo(l,u){l.blockedOn===u&&(l.blockedOn=null,hs||(hs=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,sv)))}function Ho(l){function u(v){return Wo(v,l)}if(0<tu.length){Wo(tu[0],l);for(var f=1;f<tu.length;f++){var _=tu[f];_.blockedOn===l&&(_.blockedOn=null)}}for(ds!==null&&Wo(ds,l),fs!==null&&Wo(fs,l),zn!==null&&Wo(zn,l),wl.forEach(u),to.forEach(u),f=0;f<$i.length;f++)_=$i[f],_.blockedOn===l&&(_.blockedOn=null);for(;0<$i.length&&(f=$i[0],f.blockedOn===null);)nu(f),f.blockedOn===null&&$i.shift()}var no=D.ReactCurrentBatchConfig,io=!0;function gs(l,u,f,_){var v=ct,x=no.transition;no.transition=null;try{ct=1,xd(l,u,f,_)}finally{ct=v,no.transition=x}}function km(l,u,f,_){var v=ct,x=no.transition;no.transition=null;try{ct=4,xd(l,u,f,_)}finally{ct=v,no.transition=x}}function xd(l,u,f,_){if(io){var v=iu(l,u,f,_);if(v===null)pv(l,u,_,ms,f),$o(l,_);else if(bm(v,l,u,f,_))_.stopPropagation();else if($o(l,_),u&4&&-1<Cm.indexOf(l)){for(;v!==null;){var x=Od(v);if(x!==null&&yd(x),x=iu(l,u,f,_),x===null&&pv(l,u,_,ms,f),x===v)break;v=x}v!==null&&_.stopPropagation()}else pv(l,u,_,null,f)}}var ms=null;function iu(l,u,f,_){if(ms=null,l=as(_),l=Tl(l),l!==null)if(u=Dr(l),u===null)l=null;else if(f=u.tag,f===13){if(l=ud(u),l!==null)return l;l=null}else if(f===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return ms=l,null}function ru(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iv()){case Zc:return 1;case dd:return 4;case ml:case fd:return 16;case Jc:return 536870912;default:return 16}default:return 16}}var Wi=null,su=null,ro=null;function Lm(){if(ro)return ro;var l,u=su,f=u.length,_,v="value"in Wi?Wi.value:Wi.textContent,x=v.length;for(l=0;l<f&&u[l]===v[l];l++);var M=f-l;for(_=1;_<=M&&u[f-_]===v[x-_];_++);return ro=v.slice(l,1<_?1-_:void 0)}function xl(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function ps(){return!0}function Sd(){return!1}function ei(l){function u(f,_,v,x,M){this._reactName=f,this._targetInst=v,this.type=_,this.nativeEvent=x,this.target=M,this.currentTarget=null;for(var B in l)l.hasOwnProperty(B)&&(f=l[B],this[B]=f?f(x):x[B]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ps:Sd,this.isPropagationStopped=Sd,this}return he(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ps)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ps)},persist:function(){},isPersistent:ps}),u}var _s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sl=ei(_s),Ko=he({},_s,{view:0,detail:0}),ou=ei(Ko),au,lu,Hi,Il=he({},Ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:et,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Hi&&(Hi&&l.type==="mousemove"?(au=l.screenX-Hi.screenX,lu=l.screenY-Hi.screenY):lu=au=0,Hi=l),au)},movementY:function(l){return"movementY"in l?l.movementY:lu}}),Id=ei(Il),Nm=he({},Il,{dataTransfer:0}),Om=ei(Nm),cu=he({},Ko,{relatedTarget:0}),$n=ei(cu),Dm=he({},_s,{animationName:0,elapsedTime:0,pseudoElement:0}),Vm=ei(Dm),qo=he({},_s,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),p=ei(qo),S=he({},_s,{data:0}),R=ei(S),F={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},te={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},se={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xe(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=se[l])?!!u[l]:!1}function et(){return xe}var un=he({},Ko,{key:function(l){if(l.key){var u=F[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=xl(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?te[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:et,charCode:function(l){return l.type==="keypress"?xl(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?xl(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Tt=ei(un),mn=he({},Il,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ki=ei(mn),so=he({},Ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:et}),ys=ei(so),vs=he({},_s,{propertyName:0,elapsedTime:0,pseudoElement:0}),uu=ei(vs),Td=he({},Il,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),z3=ei(Td),$3=[9,13,27,32],ov=a&&"CompositionEvent"in window,Rd=null;a&&"documentMode"in document&&(Rd=document.documentMode);var W3=a&&"TextEvent"in window&&!Rd,cT=a&&(!ov||Rd&&8<Rd&&11>=Rd),uT=" ",hT=!1;function dT(l,u){switch(l){case"keyup":return $3.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fT(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var hu=!1;function H3(l,u){switch(l){case"compositionend":return fT(u);case"keypress":return u.which!==32?null:(hT=!0,uT);case"textInput":return l=u.data,l===uT&&hT?null:l;default:return null}}function K3(l,u){if(hu)return l==="compositionend"||!ov&&dT(l,u)?(l=Lm(),ro=su=Wi=null,hu=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return cT&&u.locale!=="ko"?null:u.data;default:return null}}var q3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gT(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!q3[l.type]:u==="textarea"}function mT(l,u,f,_){Or(_),u=Bm(u,"onChange"),0<u.length&&(f=new Sl("onChange","change",null,f,_),l.push({event:f,listeners:u}))}var Ad=null,Pd=null;function Y3(l){LT(l,0)}function Fm(l){var u=pu(l);if(ae(u))return l}function X3(l,u){if(l==="change")return u}var pT=!1;if(a){var av;if(a){var lv="oninput"in document;if(!lv){var _T=document.createElement("div");_T.setAttribute("oninput","return;"),lv=typeof _T.oninput=="function"}av=lv}else av=!1;pT=av&&(!document.documentMode||9<document.documentMode)}function yT(){Ad&&(Ad.detachEvent("onpropertychange",vT),Pd=Ad=null)}function vT(l){if(l.propertyName==="value"&&Fm(Pd)){var u=[];mT(u,Pd,l,as(l)),Un(Y3,u)}}function Q3(l,u,f){l==="focusin"?(yT(),Ad=u,Pd=f,Ad.attachEvent("onpropertychange",vT)):l==="focusout"&&yT()}function Z3(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Fm(Pd)}function J3(l,u){if(l==="click")return Fm(u)}function e5(l,u){if(l==="input"||l==="change")return Fm(u)}function t5(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Fr=typeof Object.is=="function"?Object.is:t5;function Cd(l,u){if(Fr(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var f=Object.keys(l),_=Object.keys(u);if(f.length!==_.length)return!1;for(_=0;_<f.length;_++){var v=f[_];if(!c.call(u,v)||!Fr(l[v],u[v]))return!1}return!0}function ET(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function wT(l,u){var f=ET(l);l=0;for(var _;f;){if(f.nodeType===3){if(_=l+f.textContent.length,l<=u&&_>=u)return{node:f,offset:u-l};l=_}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=ET(f)}}function xT(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?xT(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function ST(){for(var l=window,u=Xe();u instanceof l.HTMLIFrameElement;){try{var f=typeof u.contentWindow.location.href=="string"}catch{f=!1}if(f)l=u.contentWindow;else break;u=Xe(l.document)}return u}function cv(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function n5(l){var u=ST(),f=l.focusedElem,_=l.selectionRange;if(u!==f&&f&&f.ownerDocument&&xT(f.ownerDocument.documentElement,f)){if(_!==null&&cv(f)){if(u=_.start,l=_.end,l===void 0&&(l=u),"selectionStart"in f)f.selectionStart=u,f.selectionEnd=Math.min(l,f.value.length);else if(l=(u=f.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var v=f.textContent.length,x=Math.min(_.start,v);_=_.end===void 0?x:Math.min(_.end,v),!l.extend&&x>_&&(v=_,_=x,x=v),v=wT(f,x);var M=wT(f,_);v&&M&&(l.rangeCount!==1||l.anchorNode!==v.node||l.anchorOffset!==v.offset||l.focusNode!==M.node||l.focusOffset!==M.offset)&&(u=u.createRange(),u.setStart(v.node,v.offset),l.removeAllRanges(),x>_?(l.addRange(u),l.extend(M.node,M.offset)):(u.setEnd(M.node,M.offset),l.addRange(u)))}}for(u=[],l=f;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<u.length;f++)l=u[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var i5=a&&"documentMode"in document&&11>=document.documentMode,du=null,uv=null,bd=null,hv=!1;function IT(l,u,f){var _=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;hv||du==null||du!==Xe(_)||(_=du,"selectionStart"in _&&cv(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),bd&&Cd(bd,_)||(bd=_,_=Bm(uv,"onSelect"),0<_.length&&(u=new Sl("onSelect","select",null,u,f),l.push({event:u,listeners:_}),u.target=du)))}function jm(l,u){var f={};return f[l.toLowerCase()]=u.toLowerCase(),f["Webkit"+l]="webkit"+u,f["Moz"+l]="moz"+u,f}var fu={animationend:jm("Animation","AnimationEnd"),animationiteration:jm("Animation","AnimationIteration"),animationstart:jm("Animation","AnimationStart"),transitionend:jm("Transition","TransitionEnd")},dv={},TT={};a&&(TT=document.createElement("div").style,"AnimationEvent"in window||(delete fu.animationend.animation,delete fu.animationiteration.animation,delete fu.animationstart.animation),"TransitionEvent"in window||delete fu.transitionend.transition);function Gm(l){if(dv[l])return dv[l];if(!fu[l])return l;var u=fu[l],f;for(f in u)if(u.hasOwnProperty(f)&&f in TT)return dv[l]=u[f];return l}var RT=Gm("animationend"),AT=Gm("animationiteration"),PT=Gm("animationstart"),CT=Gm("transitionend"),bT=new Map,MT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yo(l,u){bT.set(l,u),s(u,[l])}for(var fv=0;fv<MT.length;fv++){var gv=MT[fv],r5=gv.toLowerCase(),s5=gv[0].toUpperCase()+gv.slice(1);Yo(r5,"on"+s5)}Yo(RT,"onAnimationEnd"),Yo(AT,"onAnimationIteration"),Yo(PT,"onAnimationStart"),Yo("dblclick","onDoubleClick"),Yo("focusin","onFocus"),Yo("focusout","onBlur"),Yo(CT,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Md="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Md));function kT(l,u,f){var _=l.type||"unknown-event";l.currentTarget=f,cd(_,u,void 0,l),l.currentTarget=null}function LT(l,u){u=(u&4)!==0;for(var f=0;f<l.length;f++){var _=l[f],v=_.event;_=_.listeners;e:{var x=void 0;if(u)for(var M=_.length-1;0<=M;M--){var B=_[M],H=B.instance,re=B.currentTarget;if(B=B.listener,H!==x&&v.isPropagationStopped())break e;kT(v,B,re),x=H}else for(M=0;M<_.length;M++){if(B=_[M],H=B.instance,re=B.currentTarget,B=B.listener,H!==x&&v.isPropagationStopped())break e;kT(v,B,re),x=H}}}if(Xc)throw l=fr,Xc=!1,fr=null,l}function Gt(l,u){var f=u[xv];f===void 0&&(f=u[xv]=new Set);var _=l+"__bubble";f.has(_)||(NT(u,l,2,!1),f.add(_))}function mv(l,u,f){var _=0;u&&(_|=4),NT(f,l,_,u)}var Um="_reactListening"+Math.random().toString(36).slice(2);function kd(l){if(!l[Um]){l[Um]=!0,i.forEach(function(f){f!=="selectionchange"&&(o5.has(f)||mv(f,!1,l),mv(f,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[Um]||(u[Um]=!0,mv("selectionchange",!1,u))}}function NT(l,u,f,_){switch(ru(u)){case 1:var v=gs;break;case 4:v=km;break;default:v=xd}f=v.bind(null,u,f,l),v=void 0,!kn||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(v=!0),_?v!==void 0?l.addEventListener(u,f,{capture:!0,passive:v}):l.addEventListener(u,f,!0):v!==void 0?l.addEventListener(u,f,{passive:v}):l.addEventListener(u,f,!1)}function pv(l,u,f,_,v){var x=_;if((u&1)===0&&(u&2)===0&&_!==null)e:for(;;){if(_===null)return;var M=_.tag;if(M===3||M===4){var B=_.stateNode.containerInfo;if(B===v||B.nodeType===8&&B.parentNode===v)break;if(M===4)for(M=_.return;M!==null;){var H=M.tag;if((H===3||H===4)&&(H=M.stateNode.containerInfo,H===v||H.nodeType===8&&H.parentNode===v))return;M=M.return}for(;B!==null;){if(M=Tl(B),M===null)return;if(H=M.tag,H===5||H===6){_=x=M;continue e}B=B.parentNode}}_=_.return}Un(function(){var re=x,_e=as(f),ye=[];e:{var me=bT.get(l);if(me!==void 0){var Ce=Sl,Le=l;switch(l){case"keypress":if(xl(f)===0)break e;case"keydown":case"keyup":Ce=Tt;break;case"focusin":Le="focus",Ce=$n;break;case"focusout":Le="blur",Ce=$n;break;case"beforeblur":case"afterblur":Ce=$n;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=Id;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=Om;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=ys;break;case RT:case AT:case PT:Ce=Vm;break;case CT:Ce=uu;break;case"scroll":Ce=ou;break;case"wheel":Ce=z3;break;case"copy":case"cut":case"paste":Ce=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=Ki}var Oe=(u&4)!==0,hn=!Oe&&l==="scroll",ee=Oe?me!==null?me+"Capture":null:me;Oe=[];for(var q=re,ne;q!==null;){ne=q;var we=ne.stateNode;if(ne.tag===5&&we!==null&&(ne=we,ee!==null&&(we=Bn(q,ee),we!=null&&Oe.push(Ld(q,we,ne)))),hn)break;q=q.return}0<Oe.length&&(me=new Ce(me,Le,null,f,_e),ye.push({event:me,listeners:Oe}))}}if((u&7)===0){e:{if(me=l==="mouseover"||l==="pointerover",Ce=l==="mouseout"||l==="pointerout",me&&f!==os&&(Le=f.relatedTarget||f.fromElement)&&(Tl(Le)||Le[oo]))break e;if((Ce||me)&&(me=_e.window===_e?_e:(me=_e.ownerDocument)?me.defaultView||me.parentWindow:window,Ce?(Le=f.relatedTarget||f.toElement,Ce=re,Le=Le?Tl(Le):null,Le!==null&&(hn=Dr(Le),Le!==hn||Le.tag!==5&&Le.tag!==6)&&(Le=null)):(Ce=null,Le=re),Ce!==Le)){if(Oe=Id,we="onMouseLeave",ee="onMouseEnter",q="mouse",(l==="pointerout"||l==="pointerover")&&(Oe=Ki,we="onPointerLeave",ee="onPointerEnter",q="pointer"),hn=Ce==null?me:pu(Ce),ne=Le==null?me:pu(Le),me=new Oe(we,q+"leave",Ce,f,_e),me.target=hn,me.relatedTarget=ne,we=null,Tl(_e)===re&&(Oe=new Oe(ee,q+"enter",Le,f,_e),Oe.target=ne,Oe.relatedTarget=hn,we=Oe),hn=we,Ce&&Le)t:{for(Oe=Ce,ee=Le,q=0,ne=Oe;ne;ne=gu(ne))q++;for(ne=0,we=ee;we;we=gu(we))ne++;for(;0<q-ne;)Oe=gu(Oe),q--;for(;0<ne-q;)ee=gu(ee),ne--;for(;q--;){if(Oe===ee||ee!==null&&Oe===ee.alternate)break t;Oe=gu(Oe),ee=gu(ee)}Oe=null}else Oe=null;Ce!==null&&OT(ye,me,Ce,Oe,!1),Le!==null&&hn!==null&&OT(ye,hn,Le,Oe,!0)}}e:{if(me=re?pu(re):window,Ce=me.nodeName&&me.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&me.type==="file")var De=X3;else if(gT(me))if(pT)De=e5;else{De=Z3;var ze=Q3}else(Ce=me.nodeName)&&Ce.toLowerCase()==="input"&&(me.type==="checkbox"||me.type==="radio")&&(De=J3);if(De&&(De=De(l,re))){mT(ye,De,f,_e);break e}ze&&ze(l,me,re),l==="focusout"&&(ze=me._wrapperState)&&ze.controlled&&me.type==="number"&&Nt(me,"number",me.value)}switch(ze=re?pu(re):window,l){case"focusin":(gT(ze)||ze.contentEditable==="true")&&(du=ze,uv=re,bd=null);break;case"focusout":bd=uv=du=null;break;case"mousedown":hv=!0;break;case"contextmenu":case"mouseup":case"dragend":hv=!1,IT(ye,f,_e);break;case"selectionchange":if(i5)break;case"keydown":case"keyup":IT(ye,f,_e)}var $e;if(ov)e:{switch(l){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else hu?dT(l,f)&&(He="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(He="onCompositionStart");He&&(cT&&f.locale!=="ko"&&(hu||He!=="onCompositionStart"?He==="onCompositionEnd"&&hu&&($e=Lm()):(Wi=_e,su="value"in Wi?Wi.value:Wi.textContent,hu=!0)),ze=Bm(re,He),0<ze.length&&(He=new R(He,l,null,f,_e),ye.push({event:He,listeners:ze}),$e?He.data=$e:($e=fT(f),$e!==null&&(He.data=$e)))),($e=W3?H3(l,f):K3(l,f))&&(re=Bm(re,"onBeforeInput"),0<re.length&&(_e=new R("onBeforeInput","beforeinput",null,f,_e),ye.push({event:_e,listeners:re}),_e.data=$e))}LT(ye,u)})}function Ld(l,u,f){return{instance:l,listener:u,currentTarget:f}}function Bm(l,u){for(var f=u+"Capture",_=[];l!==null;){var v=l,x=v.stateNode;v.tag===5&&x!==null&&(v=x,x=Bn(l,f),x!=null&&_.unshift(Ld(l,x,v)),x=Bn(l,u),x!=null&&_.push(Ld(l,x,v))),l=l.return}return _}function gu(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function OT(l,u,f,_,v){for(var x=u._reactName,M=[];f!==null&&f!==_;){var B=f,H=B.alternate,re=B.stateNode;if(H!==null&&H===_)break;B.tag===5&&re!==null&&(B=re,v?(H=Bn(f,x),H!=null&&M.unshift(Ld(f,H,B))):v||(H=Bn(f,x),H!=null&&M.push(Ld(f,H,B)))),f=f.return}M.length!==0&&l.push({event:u,listeners:M})}var a5=/\r\n?/g,l5=/\u0000|\uFFFD/g;function DT(l){return(typeof l=="string"?l:""+l).replace(a5,`
`).replace(l5,"")}function zm(l,u,f){if(u=DT(u),DT(l)!==u&&f)throw Error(t(425))}function $m(){}var _v=null,yv=null;function vv(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Ev=typeof setTimeout=="function"?setTimeout:void 0,c5=typeof clearTimeout=="function"?clearTimeout:void 0,VT=typeof Promise=="function"?Promise:void 0,u5=typeof queueMicrotask=="function"?queueMicrotask:typeof VT<"u"?function(l){return VT.resolve(null).then(l).catch(h5)}:Ev;function h5(l){setTimeout(function(){throw l})}function wv(l,u){var f=u,_=0;do{var v=f.nextSibling;if(l.removeChild(f),v&&v.nodeType===8)if(f=v.data,f==="/$"){if(_===0){l.removeChild(v),Ho(u);return}_--}else f!=="$"&&f!=="$?"&&f!=="$!"||_++;f=v}while(f);Ho(u)}function Xo(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function FT(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(u===0)return l;u--}else f==="/$"&&u++}l=l.previousSibling}return null}var mu=Math.random().toString(36).slice(2),Es="__reactFiber$"+mu,Nd="__reactProps$"+mu,oo="__reactContainer$"+mu,xv="__reactEvents$"+mu,d5="__reactListeners$"+mu,f5="__reactHandles$"+mu;function Tl(l){var u=l[Es];if(u)return u;for(var f=l.parentNode;f;){if(u=f[oo]||f[Es]){if(f=u.alternate,u.child!==null||f!==null&&f.child!==null)for(l=FT(l);l!==null;){if(f=l[Es])return f;l=FT(l)}return u}l=f,f=l.parentNode}return null}function Od(l){return l=l[Es]||l[oo],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function pu(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function Wm(l){return l[Nd]||null}var Sv=[],_u=-1;function Qo(l){return{current:l}}function Ut(l){0>_u||(l.current=Sv[_u],Sv[_u]=null,_u--)}function Ot(l,u){_u++,Sv[_u]=l.current,l.current=u}var Zo={},ti=Qo(Zo),Ri=Qo(!1),Rl=Zo;function yu(l,u){var f=l.type.contextTypes;if(!f)return Zo;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===u)return _.__reactInternalMemoizedMaskedChildContext;var v={},x;for(x in f)v[x]=u[x];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=v),v}function Ai(l){return l=l.childContextTypes,l!=null}function Hm(){Ut(Ri),Ut(ti)}function jT(l,u,f){if(ti.current!==Zo)throw Error(t(168));Ot(ti,u),Ot(Ri,f)}function GT(l,u,f){var _=l.stateNode;if(u=u.childContextTypes,typeof _.getChildContext!="function")return f;_=_.getChildContext();for(var v in _)if(!(v in u))throw Error(t(108,Ee(l)||"Unknown",v));return he({},f,_)}function Km(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Zo,Rl=ti.current,Ot(ti,l),Ot(Ri,Ri.current),!0}function UT(l,u,f){var _=l.stateNode;if(!_)throw Error(t(169));f?(l=GT(l,u,Rl),_.__reactInternalMemoizedMergedChildContext=l,Ut(Ri),Ut(ti),Ot(ti,l)):Ut(Ri),Ot(Ri,f)}var ao=null,qm=!1,Iv=!1;function BT(l){ao===null?ao=[l]:ao.push(l)}function g5(l){qm=!0,BT(l)}function Jo(){if(!Iv&&ao!==null){Iv=!0;var l=0,u=ct;try{var f=ao;for(ct=1;l<f.length;l++){var _=f[l];do _=_(!0);while(_!==null)}ao=null,qm=!1}catch(v){throw ao!==null&&(ao=ao.slice(l+1)),hd(Zc,Jo),v}finally{ct=u,Iv=!1}}return null}var vu=[],Eu=0,Ym=null,Xm=0,mr=[],pr=0,Al=null,lo=1,co="";function Pl(l,u){vu[Eu++]=Xm,vu[Eu++]=Ym,Ym=l,Xm=u}function zT(l,u,f){mr[pr++]=lo,mr[pr++]=co,mr[pr++]=Al,Al=l;var _=lo;l=co;var v=32-zi(_)-1;_&=~(1<<v),f+=1;var x=32-zi(u)+v;if(30<x){var M=v-v%5;x=(_&(1<<M)-1).toString(32),_>>=M,v-=M,lo=1<<32-zi(u)+v|f<<v|_,co=x+l}else lo=1<<x|f<<v|_,co=l}function Tv(l){l.return!==null&&(Pl(l,1),zT(l,1,0))}function Rv(l){for(;l===Ym;)Ym=vu[--Eu],vu[Eu]=null,Xm=vu[--Eu],vu[Eu]=null;for(;l===Al;)Al=mr[--pr],mr[pr]=null,co=mr[--pr],mr[pr]=null,lo=mr[--pr],mr[pr]=null}var qi=null,Yi=null,Wt=!1,jr=null;function $T(l,u){var f=Er(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=l,u=l.deletions,u===null?(l.deletions=[f],l.flags|=16):u.push(f)}function WT(l,u){switch(l.tag){case 5:var f=l.type;return u=u.nodeType!==1||f.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,qi=l,Yi=Xo(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,qi=l,Yi=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(f=Al!==null?{id:lo,overflow:co}:null,l.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=Er(18,null,null,0),f.stateNode=u,f.return=l,l.child=f,qi=l,Yi=null,!0):!1;default:return!1}}function Av(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Pv(l){if(Wt){var u=Yi;if(u){var f=u;if(!WT(l,u)){if(Av(l))throw Error(t(418));u=Xo(f.nextSibling);var _=qi;u&&WT(l,u)?$T(_,f):(l.flags=l.flags&-4097|2,Wt=!1,qi=l)}}else{if(Av(l))throw Error(t(418));l.flags=l.flags&-4097|2,Wt=!1,qi=l}}}function HT(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;qi=l}function Qm(l){if(l!==qi)return!1;if(!Wt)return HT(l),Wt=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!vv(l.type,l.memoizedProps)),u&&(u=Yi)){if(Av(l))throw KT(),Error(t(418));for(;u;)$T(l,u),u=Xo(u.nextSibling)}if(HT(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(u===0){Yi=Xo(l.nextSibling);break e}u--}else f!=="$"&&f!=="$!"&&f!=="$?"||u++}l=l.nextSibling}Yi=null}}else Yi=qi?Xo(l.stateNode.nextSibling):null;return!0}function KT(){for(var l=Yi;l;)l=Xo(l.nextSibling)}function wu(){Yi=qi=null,Wt=!1}function Cv(l){jr===null?jr=[l]:jr.push(l)}var m5=D.ReactCurrentBatchConfig;function Dd(l,u,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var _=f.stateNode}if(!_)throw Error(t(147,l));var v=_,x=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===x?u.ref:(u=function(M){var B=v.refs;M===null?delete B[x]:B[x]=M},u._stringRef=x,u)}if(typeof l!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,l))}return l}function Zm(l,u){throw l=Object.prototype.toString.call(u),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function qT(l){var u=l._init;return u(l._payload)}function YT(l){function u(ee,q){if(l){var ne=ee.deletions;ne===null?(ee.deletions=[q],ee.flags|=16):ne.push(q)}}function f(ee,q){if(!l)return null;for(;q!==null;)u(ee,q),q=q.sibling;return null}function _(ee,q){for(ee=new Map;q!==null;)q.key!==null?ee.set(q.key,q):ee.set(q.index,q),q=q.sibling;return ee}function v(ee,q){return ee=aa(ee,q),ee.index=0,ee.sibling=null,ee}function x(ee,q,ne){return ee.index=ne,l?(ne=ee.alternate,ne!==null?(ne=ne.index,ne<q?(ee.flags|=2,q):ne):(ee.flags|=2,q)):(ee.flags|=1048576,q)}function M(ee){return l&&ee.alternate===null&&(ee.flags|=2),ee}function B(ee,q,ne,we){return q===null||q.tag!==6?(q=E1(ne,ee.mode,we),q.return=ee,q):(q=v(q,ne),q.return=ee,q)}function H(ee,q,ne,we){var De=ne.type;return De===k?_e(ee,q,ne.props.children,we,ne.key):q!==null&&(q.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===ue&&qT(De)===q.type)?(we=v(q,ne.props),we.ref=Dd(ee,q,ne),we.return=ee,we):(we=xp(ne.type,ne.key,ne.props,null,ee.mode,we),we.ref=Dd(ee,q,ne),we.return=ee,we)}function re(ee,q,ne,we){return q===null||q.tag!==4||q.stateNode.containerInfo!==ne.containerInfo||q.stateNode.implementation!==ne.implementation?(q=w1(ne,ee.mode,we),q.return=ee,q):(q=v(q,ne.children||[]),q.return=ee,q)}function _e(ee,q,ne,we,De){return q===null||q.tag!==7?(q=Dl(ne,ee.mode,we,De),q.return=ee,q):(q=v(q,ne),q.return=ee,q)}function ye(ee,q,ne){if(typeof q=="string"&&q!==""||typeof q=="number")return q=E1(""+q,ee.mode,ne),q.return=ee,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case O:return ne=xp(q.type,q.key,q.props,null,ee.mode,ne),ne.ref=Dd(ee,null,q),ne.return=ee,ne;case $:return q=w1(q,ee.mode,ne),q.return=ee,q;case ue:var we=q._init;return ye(ee,we(q._payload),ne)}if(It(q)||ge(q))return q=Dl(q,ee.mode,ne,null),q.return=ee,q;Zm(ee,q)}return null}function me(ee,q,ne,we){var De=q!==null?q.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return De!==null?null:B(ee,q,""+ne,we);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case O:return ne.key===De?H(ee,q,ne,we):null;case $:return ne.key===De?re(ee,q,ne,we):null;case ue:return De=ne._init,me(ee,q,De(ne._payload),we)}if(It(ne)||ge(ne))return De!==null?null:_e(ee,q,ne,we,null);Zm(ee,ne)}return null}function Ce(ee,q,ne,we,De){if(typeof we=="string"&&we!==""||typeof we=="number")return ee=ee.get(ne)||null,B(q,ee,""+we,De);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case O:return ee=ee.get(we.key===null?ne:we.key)||null,H(q,ee,we,De);case $:return ee=ee.get(we.key===null?ne:we.key)||null,re(q,ee,we,De);case ue:var ze=we._init;return Ce(ee,q,ne,ze(we._payload),De)}if(It(we)||ge(we))return ee=ee.get(ne)||null,_e(q,ee,we,De,null);Zm(q,we)}return null}function Le(ee,q,ne,we){for(var De=null,ze=null,$e=q,He=q=0,On=null;$e!==null&&He<ne.length;He++){$e.index>He?(On=$e,$e=null):On=$e.sibling;var mt=me(ee,$e,ne[He],we);if(mt===null){$e===null&&($e=On);break}l&&$e&&mt.alternate===null&&u(ee,$e),q=x(mt,q,He),ze===null?De=mt:ze.sibling=mt,ze=mt,$e=On}if(He===ne.length)return f(ee,$e),Wt&&Pl(ee,He),De;if($e===null){for(;He<ne.length;He++)$e=ye(ee,ne[He],we),$e!==null&&(q=x($e,q,He),ze===null?De=$e:ze.sibling=$e,ze=$e);return Wt&&Pl(ee,He),De}for($e=_(ee,$e);He<ne.length;He++)On=Ce($e,ee,He,ne[He],we),On!==null&&(l&&On.alternate!==null&&$e.delete(On.key===null?He:On.key),q=x(On,q,He),ze===null?De=On:ze.sibling=On,ze=On);return l&&$e.forEach(function(la){return u(ee,la)}),Wt&&Pl(ee,He),De}function Oe(ee,q,ne,we){var De=ge(ne);if(typeof De!="function")throw Error(t(150));if(ne=De.call(ne),ne==null)throw Error(t(151));for(var ze=De=null,$e=q,He=q=0,On=null,mt=ne.next();$e!==null&&!mt.done;He++,mt=ne.next()){$e.index>He?(On=$e,$e=null):On=$e.sibling;var la=me(ee,$e,mt.value,we);if(la===null){$e===null&&($e=On);break}l&&$e&&la.alternate===null&&u(ee,$e),q=x(la,q,He),ze===null?De=la:ze.sibling=la,ze=la,$e=On}if(mt.done)return f(ee,$e),Wt&&Pl(ee,He),De;if($e===null){for(;!mt.done;He++,mt=ne.next())mt=ye(ee,mt.value,we),mt!==null&&(q=x(mt,q,He),ze===null?De=mt:ze.sibling=mt,ze=mt);return Wt&&Pl(ee,He),De}for($e=_(ee,$e);!mt.done;He++,mt=ne.next())mt=Ce($e,ee,He,mt.value,we),mt!==null&&(l&&mt.alternate!==null&&$e.delete(mt.key===null?He:mt.key),q=x(mt,q,He),ze===null?De=mt:ze.sibling=mt,ze=mt);return l&&$e.forEach(function(q5){return u(ee,q5)}),Wt&&Pl(ee,He),De}function hn(ee,q,ne,we){if(typeof ne=="object"&&ne!==null&&ne.type===k&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case O:e:{for(var De=ne.key,ze=q;ze!==null;){if(ze.key===De){if(De=ne.type,De===k){if(ze.tag===7){f(ee,ze.sibling),q=v(ze,ne.props.children),q.return=ee,ee=q;break e}}else if(ze.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===ue&&qT(De)===ze.type){f(ee,ze.sibling),q=v(ze,ne.props),q.ref=Dd(ee,ze,ne),q.return=ee,ee=q;break e}f(ee,ze);break}else u(ee,ze);ze=ze.sibling}ne.type===k?(q=Dl(ne.props.children,ee.mode,we,ne.key),q.return=ee,ee=q):(we=xp(ne.type,ne.key,ne.props,null,ee.mode,we),we.ref=Dd(ee,q,ne),we.return=ee,ee=we)}return M(ee);case $:e:{for(ze=ne.key;q!==null;){if(q.key===ze)if(q.tag===4&&q.stateNode.containerInfo===ne.containerInfo&&q.stateNode.implementation===ne.implementation){f(ee,q.sibling),q=v(q,ne.children||[]),q.return=ee,ee=q;break e}else{f(ee,q);break}else u(ee,q);q=q.sibling}q=w1(ne,ee.mode,we),q.return=ee,ee=q}return M(ee);case ue:return ze=ne._init,hn(ee,q,ze(ne._payload),we)}if(It(ne))return Le(ee,q,ne,we);if(ge(ne))return Oe(ee,q,ne,we);Zm(ee,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,q!==null&&q.tag===6?(f(ee,q.sibling),q=v(q,ne),q.return=ee,ee=q):(f(ee,q),q=E1(ne,ee.mode,we),q.return=ee,ee=q),M(ee)):f(ee,q)}return hn}var xu=YT(!0),XT=YT(!1),Jm=Qo(null),ep=null,Su=null,bv=null;function Mv(){bv=Su=ep=null}function kv(l){var u=Jm.current;Ut(Jm),l._currentValue=u}function Lv(l,u,f){for(;l!==null;){var _=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,_!==null&&(_.childLanes|=u)):_!==null&&(_.childLanes&u)!==u&&(_.childLanes|=u),l===f)break;l=l.return}}function Iu(l,u){ep=l,bv=Su=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(Pi=!0),l.firstContext=null)}function _r(l){var u=l._currentValue;if(bv!==l)if(l={context:l,memoizedValue:u,next:null},Su===null){if(ep===null)throw Error(t(308));Su=l,ep.dependencies={lanes:0,firstContext:l}}else Su=Su.next=l;return u}var Cl=null;function Nv(l){Cl===null?Cl=[l]:Cl.push(l)}function QT(l,u,f,_){var v=u.interleaved;return v===null?(f.next=f,Nv(u)):(f.next=v.next,v.next=f),u.interleaved=f,uo(l,_)}function uo(l,u){l.lanes|=u;var f=l.alternate;for(f!==null&&(f.lanes|=u),f=l,l=l.return;l!==null;)l.childLanes|=u,f=l.alternate,f!==null&&(f.childLanes|=u),f=l,l=l.return;return f.tag===3?f.stateNode:null}var ea=!1;function Ov(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ZT(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function ho(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function ta(l,u,f){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,(gt&2)!==0){var v=_.pending;return v===null?u.next=u:(u.next=v.next,v.next=u),_.pending=u,uo(l,f)}return v=_.interleaved,v===null?(u.next=u,Nv(_)):(u.next=v.next,v.next=u),_.interleaved=u,uo(l,f)}function tp(l,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var _=u.lanes;_&=l.pendingLanes,f|=_,u.lanes=f,_d(l,f)}}function JT(l,u){var f=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,f===_)){var v=null,x=null;if(f=f.firstBaseUpdate,f!==null){do{var M={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};x===null?v=x=M:x=x.next=M,f=f.next}while(f!==null);x===null?v=x=u:x=x.next=u}else v=x=u;f={baseState:_.baseState,firstBaseUpdate:v,lastBaseUpdate:x,shared:_.shared,effects:_.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=u}function np(l,u,f,_){var v=l.updateQueue;ea=!1;var x=v.firstBaseUpdate,M=v.lastBaseUpdate,B=v.shared.pending;if(B!==null){v.shared.pending=null;var H=B,re=H.next;H.next=null,M===null?x=re:M.next=re,M=H;var _e=l.alternate;_e!==null&&(_e=_e.updateQueue,B=_e.lastBaseUpdate,B!==M&&(B===null?_e.firstBaseUpdate=re:B.next=re,_e.lastBaseUpdate=H))}if(x!==null){var ye=v.baseState;M=0,_e=re=H=null,B=x;do{var me=B.lane,Ce=B.eventTime;if((_&me)===me){_e!==null&&(_e=_e.next={eventTime:Ce,lane:0,tag:B.tag,payload:B.payload,callback:B.callback,next:null});e:{var Le=l,Oe=B;switch(me=u,Ce=f,Oe.tag){case 1:if(Le=Oe.payload,typeof Le=="function"){ye=Le.call(Ce,ye,me);break e}ye=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Oe.payload,me=typeof Le=="function"?Le.call(Ce,ye,me):Le,me==null)break e;ye=he({},ye,me);break e;case 2:ea=!0}}B.callback!==null&&B.lane!==0&&(l.flags|=64,me=v.effects,me===null?v.effects=[B]:me.push(B))}else Ce={eventTime:Ce,lane:me,tag:B.tag,payload:B.payload,callback:B.callback,next:null},_e===null?(re=_e=Ce,H=ye):_e=_e.next=Ce,M|=me;if(B=B.next,B===null){if(B=v.shared.pending,B===null)break;me=B,B=me.next,me.next=null,v.lastBaseUpdate=me,v.shared.pending=null}}while(!0);if(_e===null&&(H=ye),v.baseState=H,v.firstBaseUpdate=re,v.lastBaseUpdate=_e,u=v.shared.interleaved,u!==null){v=u;do M|=v.lane,v=v.next;while(v!==u)}else x===null&&(v.shared.lanes=0);kl|=M,l.lanes=M,l.memoizedState=ye}}function e2(l,u,f){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var _=l[u],v=_.callback;if(v!==null){if(_.callback=null,_=f,typeof v!="function")throw Error(t(191,v));v.call(_)}}}var Vd={},ws=Qo(Vd),Fd=Qo(Vd),jd=Qo(Vd);function bl(l){if(l===Vd)throw Error(t(174));return l}function Dv(l,u){switch(Ot(jd,u),Ot(Fd,l),Ot(ws,Vd),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Nr(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=Nr(u,l)}Ut(ws),Ot(ws,u)}function Tu(){Ut(ws),Ut(Fd),Ut(jd)}function t2(l){bl(jd.current);var u=bl(ws.current),f=Nr(u,l.type);u!==f&&(Ot(Fd,l),Ot(ws,f))}function Vv(l){Fd.current===l&&(Ut(ws),Ut(Fd))}var Xt=Qo(0);function ip(l){for(var u=l;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Fv=[];function jv(){for(var l=0;l<Fv.length;l++)Fv[l]._workInProgressVersionPrimary=null;Fv.length=0}var rp=D.ReactCurrentDispatcher,Gv=D.ReactCurrentBatchConfig,Ml=0,Qt=null,Sn=null,Ln=null,sp=!1,Gd=!1,Ud=0,p5=0;function ni(){throw Error(t(321))}function Uv(l,u){if(u===null)return!1;for(var f=0;f<u.length&&f<l.length;f++)if(!Fr(l[f],u[f]))return!1;return!0}function Bv(l,u,f,_,v,x){if(Ml=x,Qt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,rp.current=l===null||l.memoizedState===null?E5:w5,l=f(_,v),Gd){x=0;do{if(Gd=!1,Ud=0,25<=x)throw Error(t(301));x+=1,Ln=Sn=null,u.updateQueue=null,rp.current=x5,l=f(_,v)}while(Gd)}if(rp.current=lp,u=Sn!==null&&Sn.next!==null,Ml=0,Ln=Sn=Qt=null,sp=!1,u)throw Error(t(300));return l}function zv(){var l=Ud!==0;return Ud=0,l}function xs(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?Qt.memoizedState=Ln=l:Ln=Ln.next=l,Ln}function yr(){if(Sn===null){var l=Qt.alternate;l=l!==null?l.memoizedState:null}else l=Sn.next;var u=Ln===null?Qt.memoizedState:Ln.next;if(u!==null)Ln=u,Sn=l;else{if(l===null)throw Error(t(310));Sn=l,l={memoizedState:Sn.memoizedState,baseState:Sn.baseState,baseQueue:Sn.baseQueue,queue:Sn.queue,next:null},Ln===null?Qt.memoizedState=Ln=l:Ln=Ln.next=l}return Ln}function Bd(l,u){return typeof u=="function"?u(l):u}function $v(l){var u=yr(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=Sn,v=_.baseQueue,x=f.pending;if(x!==null){if(v!==null){var M=v.next;v.next=x.next,x.next=M}_.baseQueue=v=x,f.pending=null}if(v!==null){x=v.next,_=_.baseState;var B=M=null,H=null,re=x;do{var _e=re.lane;if((Ml&_e)===_e)H!==null&&(H=H.next={lane:0,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),_=re.hasEagerState?re.eagerState:l(_,re.action);else{var ye={lane:_e,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null};H===null?(B=H=ye,M=_):H=H.next=ye,Qt.lanes|=_e,kl|=_e}re=re.next}while(re!==null&&re!==x);H===null?M=_:H.next=B,Fr(_,u.memoizedState)||(Pi=!0),u.memoizedState=_,u.baseState=M,u.baseQueue=H,f.lastRenderedState=_}if(l=f.interleaved,l!==null){v=l;do x=v.lane,Qt.lanes|=x,kl|=x,v=v.next;while(v!==l)}else v===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function Wv(l){var u=yr(),f=u.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=f.dispatch,v=f.pending,x=u.memoizedState;if(v!==null){f.pending=null;var M=v=v.next;do x=l(x,M.action),M=M.next;while(M!==v);Fr(x,u.memoizedState)||(Pi=!0),u.memoizedState=x,u.baseQueue===null&&(u.baseState=x),f.lastRenderedState=x}return[x,_]}function n2(){}function i2(l,u){var f=Qt,_=yr(),v=u(),x=!Fr(_.memoizedState,v);if(x&&(_.memoizedState=v,Pi=!0),_=_.queue,Hv(o2.bind(null,f,_,l),[l]),_.getSnapshot!==u||x||Ln!==null&&Ln.memoizedState.tag&1){if(f.flags|=2048,zd(9,s2.bind(null,f,_,v,u),void 0,null),Nn===null)throw Error(t(349));(Ml&30)!==0||r2(f,u,v)}return v}function r2(l,u,f){l.flags|=16384,l={getSnapshot:u,value:f},u=Qt.updateQueue,u===null?(u={lastEffect:null,stores:null},Qt.updateQueue=u,u.stores=[l]):(f=u.stores,f===null?u.stores=[l]:f.push(l))}function s2(l,u,f,_){u.value=f,u.getSnapshot=_,a2(u)&&l2(l)}function o2(l,u,f){return f(function(){a2(u)&&l2(l)})}function a2(l){var u=l.getSnapshot;l=l.value;try{var f=u();return!Fr(l,f)}catch{return!0}}function l2(l){var u=uo(l,1);u!==null&&zr(u,l,1,-1)}function c2(l){var u=xs();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bd,lastRenderedState:l},u.queue=l,l=l.dispatch=v5.bind(null,Qt,l),[u.memoizedState,l]}function zd(l,u,f,_){return l={tag:l,create:u,destroy:f,deps:_,next:null},u=Qt.updateQueue,u===null?(u={lastEffect:null,stores:null},Qt.updateQueue=u,u.lastEffect=l.next=l):(f=u.lastEffect,f===null?u.lastEffect=l.next=l:(_=f.next,f.next=l,l.next=_,u.lastEffect=l)),l}function u2(){return yr().memoizedState}function op(l,u,f,_){var v=xs();Qt.flags|=l,v.memoizedState=zd(1|u,f,void 0,_===void 0?null:_)}function ap(l,u,f,_){var v=yr();_=_===void 0?null:_;var x=void 0;if(Sn!==null){var M=Sn.memoizedState;if(x=M.destroy,_!==null&&Uv(_,M.deps)){v.memoizedState=zd(u,f,x,_);return}}Qt.flags|=l,v.memoizedState=zd(1|u,f,x,_)}function h2(l,u){return op(8390656,8,l,u)}function Hv(l,u){return ap(2048,8,l,u)}function d2(l,u){return ap(4,2,l,u)}function f2(l,u){return ap(4,4,l,u)}function g2(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function m2(l,u,f){return f=f!=null?f.concat([l]):null,ap(4,4,g2.bind(null,u,l),f)}function Kv(){}function p2(l,u){var f=yr();u=u===void 0?null:u;var _=f.memoizedState;return _!==null&&u!==null&&Uv(u,_[1])?_[0]:(f.memoizedState=[l,u],l)}function _2(l,u){var f=yr();u=u===void 0?null:u;var _=f.memoizedState;return _!==null&&u!==null&&Uv(u,_[1])?_[0]:(l=l(),f.memoizedState=[l,u],l)}function y2(l,u,f){return(Ml&21)===0?(l.baseState&&(l.baseState=!1,Pi=!0),l.memoizedState=f):(Fr(f,u)||(f=md(),Qt.lanes|=f,kl|=f,l.baseState=!0),u)}function _5(l,u){var f=ct;ct=f!==0&&4>f?f:4,l(!0);var _=Gv.transition;Gv.transition={};try{l(!1),u()}finally{ct=f,Gv.transition=_}}function v2(){return yr().memoizedState}function y5(l,u,f){var _=sa(l);if(f={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null},E2(l))w2(u,f);else if(f=QT(l,u,f,_),f!==null){var v=yi();zr(f,l,_,v),x2(f,u,_)}}function v5(l,u,f){var _=sa(l),v={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null};if(E2(l))w2(u,v);else{var x=l.alternate;if(l.lanes===0&&(x===null||x.lanes===0)&&(x=u.lastRenderedReducer,x!==null))try{var M=u.lastRenderedState,B=x(M,f);if(v.hasEagerState=!0,v.eagerState=B,Fr(B,M)){var H=u.interleaved;H===null?(v.next=v,Nv(u)):(v.next=H.next,H.next=v),u.interleaved=v;return}}catch{}f=QT(l,u,v,_),f!==null&&(v=yi(),zr(f,l,_,v),x2(f,u,_))}}function E2(l){var u=l.alternate;return l===Qt||u!==null&&u===Qt}function w2(l,u){Gd=sp=!0;var f=l.pending;f===null?u.next=u:(u.next=f.next,f.next=u),l.pending=u}function x2(l,u,f){if((f&4194240)!==0){var _=u.lanes;_&=l.pendingLanes,f|=_,u.lanes=f,_d(l,f)}}var lp={readContext:_r,useCallback:ni,useContext:ni,useEffect:ni,useImperativeHandle:ni,useInsertionEffect:ni,useLayoutEffect:ni,useMemo:ni,useReducer:ni,useRef:ni,useState:ni,useDebugValue:ni,useDeferredValue:ni,useTransition:ni,useMutableSource:ni,useSyncExternalStore:ni,useId:ni,unstable_isNewReconciler:!1},E5={readContext:_r,useCallback:function(l,u){return xs().memoizedState=[l,u===void 0?null:u],l},useContext:_r,useEffect:h2,useImperativeHandle:function(l,u,f){return f=f!=null?f.concat([l]):null,op(4194308,4,g2.bind(null,u,l),f)},useLayoutEffect:function(l,u){return op(4194308,4,l,u)},useInsertionEffect:function(l,u){return op(4,2,l,u)},useMemo:function(l,u){var f=xs();return u=u===void 0?null:u,l=l(),f.memoizedState=[l,u],l},useReducer:function(l,u,f){var _=xs();return u=f!==void 0?f(u):u,_.memoizedState=_.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},_.queue=l,l=l.dispatch=y5.bind(null,Qt,l),[_.memoizedState,l]},useRef:function(l){var u=xs();return l={current:l},u.memoizedState=l},useState:c2,useDebugValue:Kv,useDeferredValue:function(l){return xs().memoizedState=l},useTransition:function(){var l=c2(!1),u=l[0];return l=_5.bind(null,l[1]),xs().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,f){var _=Qt,v=xs();if(Wt){if(f===void 0)throw Error(t(407));f=f()}else{if(f=u(),Nn===null)throw Error(t(349));(Ml&30)!==0||r2(_,u,f)}v.memoizedState=f;var x={value:f,getSnapshot:u};return v.queue=x,h2(o2.bind(null,_,x,l),[l]),_.flags|=2048,zd(9,s2.bind(null,_,x,f,u),void 0,null),f},useId:function(){var l=xs(),u=Nn.identifierPrefix;if(Wt){var f=co,_=lo;f=(_&~(1<<32-zi(_)-1)).toString(32)+f,u=":"+u+"R"+f,f=Ud++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=p5++,u=":"+u+"r"+f.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},w5={readContext:_r,useCallback:p2,useContext:_r,useEffect:Hv,useImperativeHandle:m2,useInsertionEffect:d2,useLayoutEffect:f2,useMemo:_2,useReducer:$v,useRef:u2,useState:function(){return $v(Bd)},useDebugValue:Kv,useDeferredValue:function(l){var u=yr();return y2(u,Sn.memoizedState,l)},useTransition:function(){var l=$v(Bd)[0],u=yr().memoizedState;return[l,u]},useMutableSource:n2,useSyncExternalStore:i2,useId:v2,unstable_isNewReconciler:!1},x5={readContext:_r,useCallback:p2,useContext:_r,useEffect:Hv,useImperativeHandle:m2,useInsertionEffect:d2,useLayoutEffect:f2,useMemo:_2,useReducer:Wv,useRef:u2,useState:function(){return Wv(Bd)},useDebugValue:Kv,useDeferredValue:function(l){var u=yr();return Sn===null?u.memoizedState=l:y2(u,Sn.memoizedState,l)},useTransition:function(){var l=Wv(Bd)[0],u=yr().memoizedState;return[l,u]},useMutableSource:n2,useSyncExternalStore:i2,useId:v2,unstable_isNewReconciler:!1};function Gr(l,u){if(l&&l.defaultProps){u=he({},u),l=l.defaultProps;for(var f in l)u[f]===void 0&&(u[f]=l[f]);return u}return u}function qv(l,u,f,_){u=l.memoizedState,f=f(_,u),f=f==null?u:he({},u,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var cp={isMounted:function(l){return(l=l._reactInternals)?Dr(l)===l:!1},enqueueSetState:function(l,u,f){l=l._reactInternals;var _=yi(),v=sa(l),x=ho(_,v);x.payload=u,f!=null&&(x.callback=f),u=ta(l,x,v),u!==null&&(zr(u,l,v,_),tp(u,l,v))},enqueueReplaceState:function(l,u,f){l=l._reactInternals;var _=yi(),v=sa(l),x=ho(_,v);x.tag=1,x.payload=u,f!=null&&(x.callback=f),u=ta(l,x,v),u!==null&&(zr(u,l,v,_),tp(u,l,v))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var f=yi(),_=sa(l),v=ho(f,_);v.tag=2,u!=null&&(v.callback=u),u=ta(l,v,_),u!==null&&(zr(u,l,_,f),tp(u,l,_))}};function S2(l,u,f,_,v,x,M){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,x,M):u.prototype&&u.prototype.isPureReactComponent?!Cd(f,_)||!Cd(v,x):!0}function I2(l,u,f){var _=!1,v=Zo,x=u.contextType;return typeof x=="object"&&x!==null?x=_r(x):(v=Ai(u)?Rl:ti.current,_=u.contextTypes,x=(_=_!=null)?yu(l,v):Zo),u=new u(f,x),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=cp,l.stateNode=u,u._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=v,l.__reactInternalMemoizedMaskedChildContext=x),u}function T2(l,u,f,_){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,_),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,_),u.state!==l&&cp.enqueueReplaceState(u,u.state,null)}function Yv(l,u,f,_){var v=l.stateNode;v.props=f,v.state=l.memoizedState,v.refs={},Ov(l);var x=u.contextType;typeof x=="object"&&x!==null?v.context=_r(x):(x=Ai(u)?Rl:ti.current,v.context=yu(l,x)),v.state=l.memoizedState,x=u.getDerivedStateFromProps,typeof x=="function"&&(qv(l,u,x,f),v.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(u=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),u!==v.state&&cp.enqueueReplaceState(v,v.state,null),np(l,f,v,_),v.state=l.memoizedState),typeof v.componentDidMount=="function"&&(l.flags|=4194308)}function Ru(l,u){try{var f="",_=u;do f+=X(_),_=_.return;while(_);var v=f}catch(x){v=`
Error generating stack: `+x.message+`
`+x.stack}return{value:l,source:u,stack:v,digest:null}}function Xv(l,u,f){return{value:l,source:null,stack:f??null,digest:u??null}}function Qv(l,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var S5=typeof WeakMap=="function"?WeakMap:Map;function R2(l,u,f){f=ho(-1,f),f.tag=3,f.payload={element:null};var _=u.value;return f.callback=function(){pp||(pp=!0,d1=_),Qv(l,u)},f}function A2(l,u,f){f=ho(-1,f),f.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var v=u.value;f.payload=function(){return _(v)},f.callback=function(){Qv(l,u)}}var x=l.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(f.callback=function(){Qv(l,u),typeof _!="function"&&(ia===null?ia=new Set([this]):ia.add(this));var M=u.stack;this.componentDidCatch(u.value,{componentStack:M!==null?M:""})}),f}function P2(l,u,f){var _=l.pingCache;if(_===null){_=l.pingCache=new S5;var v=new Set;_.set(u,v)}else v=_.get(u),v===void 0&&(v=new Set,_.set(u,v));v.has(f)||(v.add(f),l=V5.bind(null,l,u,f),u.then(l,l))}function C2(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function b2(l,u,f,_,v){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=ho(-1,1),u.tag=2,ta(f,u,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=v,l)}var I5=D.ReactCurrentOwner,Pi=!1;function _i(l,u,f,_){u.child=l===null?XT(u,null,f,_):xu(u,l.child,f,_)}function M2(l,u,f,_,v){f=f.render;var x=u.ref;return Iu(u,v),_=Bv(l,u,f,_,x,v),f=zv(),l!==null&&!Pi?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~v,fo(l,u,v)):(Wt&&f&&Tv(u),u.flags|=1,_i(l,u,_,v),u.child)}function k2(l,u,f,_,v){if(l===null){var x=f.type;return typeof x=="function"&&!v1(x)&&x.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=x,L2(l,u,x,_,v)):(l=xp(f.type,null,_,u,u.mode,v),l.ref=u.ref,l.return=u,u.child=l)}if(x=l.child,(l.lanes&v)===0){var M=x.memoizedProps;if(f=f.compare,f=f!==null?f:Cd,f(M,_)&&l.ref===u.ref)return fo(l,u,v)}return u.flags|=1,l=aa(x,_),l.ref=u.ref,l.return=u,u.child=l}function L2(l,u,f,_,v){if(l!==null){var x=l.memoizedProps;if(Cd(x,_)&&l.ref===u.ref)if(Pi=!1,u.pendingProps=_=x,(l.lanes&v)!==0)(l.flags&131072)!==0&&(Pi=!0);else return u.lanes=l.lanes,fo(l,u,v)}return Zv(l,u,f,_,v)}function N2(l,u,f){var _=u.pendingProps,v=_.children,x=l!==null?l.memoizedState:null;if(_.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(Pu,Xi),Xi|=f;else{if((f&1073741824)===0)return l=x!==null?x.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,Ot(Pu,Xi),Xi|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=x!==null?x.baseLanes:f,Ot(Pu,Xi),Xi|=_}else x!==null?(_=x.baseLanes|f,u.memoizedState=null):_=f,Ot(Pu,Xi),Xi|=_;return _i(l,u,v,f),u.child}function O2(l,u){var f=u.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function Zv(l,u,f,_,v){var x=Ai(f)?Rl:ti.current;return x=yu(u,x),Iu(u,v),f=Bv(l,u,f,_,x,v),_=zv(),l!==null&&!Pi?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~v,fo(l,u,v)):(Wt&&_&&Tv(u),u.flags|=1,_i(l,u,f,v),u.child)}function D2(l,u,f,_,v){if(Ai(f)){var x=!0;Km(u)}else x=!1;if(Iu(u,v),u.stateNode===null)hp(l,u),I2(u,f,_),Yv(u,f,_,v),_=!0;else if(l===null){var M=u.stateNode,B=u.memoizedProps;M.props=B;var H=M.context,re=f.contextType;typeof re=="object"&&re!==null?re=_r(re):(re=Ai(f)?Rl:ti.current,re=yu(u,re));var _e=f.getDerivedStateFromProps,ye=typeof _e=="function"||typeof M.getSnapshotBeforeUpdate=="function";ye||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(B!==_||H!==re)&&T2(u,M,_,re),ea=!1;var me=u.memoizedState;M.state=me,np(u,_,M,v),H=u.memoizedState,B!==_||me!==H||Ri.current||ea?(typeof _e=="function"&&(qv(u,f,_e,_),H=u.memoizedState),(B=ea||S2(u,f,B,_,me,H,re))?(ye||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(u.flags|=4194308)):(typeof M.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=_,u.memoizedState=H),M.props=_,M.state=H,M.context=re,_=B):(typeof M.componentDidMount=="function"&&(u.flags|=4194308),_=!1)}else{M=u.stateNode,ZT(l,u),B=u.memoizedProps,re=u.type===u.elementType?B:Gr(u.type,B),M.props=re,ye=u.pendingProps,me=M.context,H=f.contextType,typeof H=="object"&&H!==null?H=_r(H):(H=Ai(f)?Rl:ti.current,H=yu(u,H));var Ce=f.getDerivedStateFromProps;(_e=typeof Ce=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(B!==ye||me!==H)&&T2(u,M,_,H),ea=!1,me=u.memoizedState,M.state=me,np(u,_,M,v);var Le=u.memoizedState;B!==ye||me!==Le||Ri.current||ea?(typeof Ce=="function"&&(qv(u,f,Ce,_),Le=u.memoizedState),(re=ea||S2(u,f,re,_,me,Le,H)||!1)?(_e||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(_,Le,H),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(_,Le,H)),typeof M.componentDidUpdate=="function"&&(u.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof M.componentDidUpdate!="function"||B===l.memoizedProps&&me===l.memoizedState||(u.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||B===l.memoizedProps&&me===l.memoizedState||(u.flags|=1024),u.memoizedProps=_,u.memoizedState=Le),M.props=_,M.state=Le,M.context=H,_=re):(typeof M.componentDidUpdate!="function"||B===l.memoizedProps&&me===l.memoizedState||(u.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||B===l.memoizedProps&&me===l.memoizedState||(u.flags|=1024),_=!1)}return Jv(l,u,f,_,x,v)}function Jv(l,u,f,_,v,x){O2(l,u);var M=(u.flags&128)!==0;if(!_&&!M)return v&&UT(u,f,!1),fo(l,u,x);_=u.stateNode,I5.current=u;var B=M&&typeof f.getDerivedStateFromError!="function"?null:_.render();return u.flags|=1,l!==null&&M?(u.child=xu(u,l.child,null,x),u.child=xu(u,null,B,x)):_i(l,u,B,x),u.memoizedState=_.state,v&&UT(u,f,!0),u.child}function V2(l){var u=l.stateNode;u.pendingContext?jT(l,u.pendingContext,u.pendingContext!==u.context):u.context&&jT(l,u.context,!1),Dv(l,u.containerInfo)}function F2(l,u,f,_,v){return wu(),Cv(v),u.flags|=256,_i(l,u,f,_),u.child}var e1={dehydrated:null,treeContext:null,retryLane:0};function t1(l){return{baseLanes:l,cachePool:null,transitions:null}}function j2(l,u,f){var _=u.pendingProps,v=Xt.current,x=!1,M=(u.flags&128)!==0,B;if((B=M)||(B=l!==null&&l.memoizedState===null?!1:(v&2)!==0),B?(x=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(v|=1),Ot(Xt,v&1),l===null)return Pv(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(M=_.children,l=_.fallback,x?(_=u.mode,x=u.child,M={mode:"hidden",children:M},(_&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=M):x=Sp(M,_,0,null),l=Dl(l,_,f,null),x.return=u,l.return=u,x.sibling=l,u.child=x,u.child.memoizedState=t1(f),u.memoizedState=e1,l):n1(u,M));if(v=l.memoizedState,v!==null&&(B=v.dehydrated,B!==null))return T5(l,u,M,_,B,v,f);if(x){x=_.fallback,M=u.mode,v=l.child,B=v.sibling;var H={mode:"hidden",children:_.children};return(M&1)===0&&u.child!==v?(_=u.child,_.childLanes=0,_.pendingProps=H,u.deletions=null):(_=aa(v,H),_.subtreeFlags=v.subtreeFlags&14680064),B!==null?x=aa(B,x):(x=Dl(x,M,f,null),x.flags|=2),x.return=u,_.return=u,_.sibling=x,u.child=_,_=x,x=u.child,M=l.child.memoizedState,M=M===null?t1(f):{baseLanes:M.baseLanes|f,cachePool:null,transitions:M.transitions},x.memoizedState=M,x.childLanes=l.childLanes&~f,u.memoizedState=e1,_}return x=l.child,l=x.sibling,_=aa(x,{mode:"visible",children:_.children}),(u.mode&1)===0&&(_.lanes=f),_.return=u,_.sibling=null,l!==null&&(f=u.deletions,f===null?(u.deletions=[l],u.flags|=16):f.push(l)),u.child=_,u.memoizedState=null,_}function n1(l,u){return u=Sp({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function up(l,u,f,_){return _!==null&&Cv(_),xu(u,l.child,null,f),l=n1(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function T5(l,u,f,_,v,x,M){if(f)return u.flags&256?(u.flags&=-257,_=Xv(Error(t(422))),up(l,u,M,_)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(x=_.fallback,v=u.mode,_=Sp({mode:"visible",children:_.children},v,0,null),x=Dl(x,v,M,null),x.flags|=2,_.return=u,x.return=u,_.sibling=x,u.child=_,(u.mode&1)!==0&&xu(u,l.child,null,M),u.child.memoizedState=t1(M),u.memoizedState=e1,x);if((u.mode&1)===0)return up(l,u,M,null);if(v.data==="$!"){if(_=v.nextSibling&&v.nextSibling.dataset,_)var B=_.dgst;return _=B,x=Error(t(419)),_=Xv(x,_,void 0),up(l,u,M,_)}if(B=(M&l.childLanes)!==0,Pi||B){if(_=Nn,_!==null){switch(M&-M){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(_.suspendedLanes|M))!==0?0:v,v!==0&&v!==x.retryLane&&(x.retryLane=v,uo(l,v),zr(_,l,v,-1))}return y1(),_=Xv(Error(t(421))),up(l,u,M,_)}return v.data==="$?"?(u.flags|=128,u.child=l.child,u=F5.bind(null,l),v._reactRetry=u,null):(l=x.treeContext,Yi=Xo(v.nextSibling),qi=u,Wt=!0,jr=null,l!==null&&(mr[pr++]=lo,mr[pr++]=co,mr[pr++]=Al,lo=l.id,co=l.overflow,Al=u),u=n1(u,_.children),u.flags|=4096,u)}function G2(l,u,f){l.lanes|=u;var _=l.alternate;_!==null&&(_.lanes|=u),Lv(l.return,u,f)}function i1(l,u,f,_,v){var x=l.memoizedState;x===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:_,tail:f,tailMode:v}:(x.isBackwards=u,x.rendering=null,x.renderingStartTime=0,x.last=_,x.tail=f,x.tailMode=v)}function U2(l,u,f){var _=u.pendingProps,v=_.revealOrder,x=_.tail;if(_i(l,u,_.children,f),_=Xt.current,(_&2)!==0)_=_&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&G2(l,f,u);else if(l.tag===19)G2(l,f,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(Ot(Xt,_),(u.mode&1)===0)u.memoizedState=null;else switch(v){case"forwards":for(f=u.child,v=null;f!==null;)l=f.alternate,l!==null&&ip(l)===null&&(v=f),f=f.sibling;f=v,f===null?(v=u.child,u.child=null):(v=f.sibling,f.sibling=null),i1(u,!1,v,f,x);break;case"backwards":for(f=null,v=u.child,u.child=null;v!==null;){if(l=v.alternate,l!==null&&ip(l)===null){u.child=v;break}l=v.sibling,v.sibling=f,f=v,v=l}i1(u,!0,f,null,x);break;case"together":i1(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function hp(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function fo(l,u,f){if(l!==null&&(u.dependencies=l.dependencies),kl|=u.lanes,(f&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(t(153));if(u.child!==null){for(l=u.child,f=aa(l,l.pendingProps),u.child=f,f.return=u;l.sibling!==null;)l=l.sibling,f=f.sibling=aa(l,l.pendingProps),f.return=u;f.sibling=null}return u.child}function R5(l,u,f){switch(u.tag){case 3:V2(u),wu();break;case 5:t2(u);break;case 1:Ai(u.type)&&Km(u);break;case 4:Dv(u,u.stateNode.containerInfo);break;case 10:var _=u.type._context,v=u.memoizedProps.value;Ot(Jm,_._currentValue),_._currentValue=v;break;case 13:if(_=u.memoizedState,_!==null)return _.dehydrated!==null?(Ot(Xt,Xt.current&1),u.flags|=128,null):(f&u.child.childLanes)!==0?j2(l,u,f):(Ot(Xt,Xt.current&1),l=fo(l,u,f),l!==null?l.sibling:null);Ot(Xt,Xt.current&1);break;case 19:if(_=(f&u.childLanes)!==0,(l.flags&128)!==0){if(_)return U2(l,u,f);u.flags|=128}if(v=u.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Ot(Xt,Xt.current),_)break;return null;case 22:case 23:return u.lanes=0,N2(l,u,f)}return fo(l,u,f)}var B2,r1,z2,$2;B2=function(l,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},r1=function(){},z2=function(l,u,f,_){var v=l.memoizedProps;if(v!==_){l=u.stateNode,bl(ws.current);var x=null;switch(f){case"input":v=rt(l,v),_=rt(l,_),x=[];break;case"select":v=he({},v,{value:void 0}),_=he({},_,{value:void 0}),x=[];break;case"textarea":v=lr(l,v),_=lr(l,_),x=[];break;default:typeof v.onClick!="function"&&typeof _.onClick=="function"&&(l.onclick=$m)}gi(f,_);var M;f=null;for(re in v)if(!_.hasOwnProperty(re)&&v.hasOwnProperty(re)&&v[re]!=null)if(re==="style"){var B=v[re];for(M in B)B.hasOwnProperty(M)&&(f||(f={}),f[M]="")}else re!=="dangerouslySetInnerHTML"&&re!=="children"&&re!=="suppressContentEditableWarning"&&re!=="suppressHydrationWarning"&&re!=="autoFocus"&&(r.hasOwnProperty(re)?x||(x=[]):(x=x||[]).push(re,null));for(re in _){var H=_[re];if(B=v?.[re],_.hasOwnProperty(re)&&H!==B&&(H!=null||B!=null))if(re==="style")if(B){for(M in B)!B.hasOwnProperty(M)||H&&H.hasOwnProperty(M)||(f||(f={}),f[M]="");for(M in H)H.hasOwnProperty(M)&&B[M]!==H[M]&&(f||(f={}),f[M]=H[M])}else f||(x||(x=[]),x.push(re,f)),f=H;else re==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,B=B?B.__html:void 0,H!=null&&B!==H&&(x=x||[]).push(re,H)):re==="children"?typeof H!="string"&&typeof H!="number"||(x=x||[]).push(re,""+H):re!=="suppressContentEditableWarning"&&re!=="suppressHydrationWarning"&&(r.hasOwnProperty(re)?(H!=null&&re==="onScroll"&&Gt("scroll",l),x||B===H||(x=[])):(x=x||[]).push(re,H))}f&&(x=x||[]).push("style",f);var re=x;(u.updateQueue=re)&&(u.flags|=4)}},$2=function(l,u,f,_){f!==_&&(u.flags|=4)};function $d(l,u){if(!Wt)switch(l.tailMode){case"hidden":u=l.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var _=null;f!==null;)f.alternate!==null&&(_=f),f=f.sibling;_===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function ii(l){var u=l.alternate!==null&&l.alternate.child===l.child,f=0,_=0;if(u)for(var v=l.child;v!==null;)f|=v.lanes|v.childLanes,_|=v.subtreeFlags&14680064,_|=v.flags&14680064,v.return=l,v=v.sibling;else for(v=l.child;v!==null;)f|=v.lanes|v.childLanes,_|=v.subtreeFlags,_|=v.flags,v.return=l,v=v.sibling;return l.subtreeFlags|=_,l.childLanes=f,u}function A5(l,u,f){var _=u.pendingProps;switch(Rv(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ii(u),null;case 1:return Ai(u.type)&&Hm(),ii(u),null;case 3:return _=u.stateNode,Tu(),Ut(Ri),Ut(ti),jv(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(Qm(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,jr!==null&&(m1(jr),jr=null))),r1(l,u),ii(u),null;case 5:Vv(u);var v=bl(jd.current);if(f=u.type,l!==null&&u.stateNode!=null)z2(l,u,f,_,v),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!_){if(u.stateNode===null)throw Error(t(166));return ii(u),null}if(l=bl(ws.current),Qm(u)){_=u.stateNode,f=u.type;var x=u.memoizedProps;switch(_[Es]=u,_[Nd]=x,l=(u.mode&1)!==0,f){case"dialog":Gt("cancel",_),Gt("close",_);break;case"iframe":case"object":case"embed":Gt("load",_);break;case"video":case"audio":for(v=0;v<Md.length;v++)Gt(Md[v],_);break;case"source":Gt("error",_);break;case"img":case"image":case"link":Gt("error",_),Gt("load",_);break;case"details":Gt("toggle",_);break;case"input":ht(_,x),Gt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!x.multiple},Gt("invalid",_);break;case"textarea":$t(_,x),Gt("invalid",_)}gi(f,x),v=null;for(var M in x)if(x.hasOwnProperty(M)){var B=x[M];M==="children"?typeof B=="string"?_.textContent!==B&&(x.suppressHydrationWarning!==!0&&zm(_.textContent,B,l),v=["children",B]):typeof B=="number"&&_.textContent!==""+B&&(x.suppressHydrationWarning!==!0&&zm(_.textContent,B,l),v=["children",""+B]):r.hasOwnProperty(M)&&B!=null&&M==="onScroll"&&Gt("scroll",_)}switch(f){case"input":U(_),ar(_,x,!0);break;case"textarea":U(_),cr(_);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(_.onclick=$m)}_=v,u.updateQueue=_,_!==null&&(u.flags|=4)}else{M=v.nodeType===9?v:v.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=ns(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=M.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof _.is=="string"?l=M.createElement(f,{is:_.is}):(l=M.createElement(f),f==="select"&&(M=l,_.multiple?M.multiple=!0:_.size&&(M.size=_.size))):l=M.createElementNS(l,f),l[Es]=u,l[Nd]=_,B2(l,u,!1,!1),u.stateNode=l;e:{switch(M=Zs(f,_),f){case"dialog":Gt("cancel",l),Gt("close",l),v=_;break;case"iframe":case"object":case"embed":Gt("load",l),v=_;break;case"video":case"audio":for(v=0;v<Md.length;v++)Gt(Md[v],l);v=_;break;case"source":Gt("error",l),v=_;break;case"img":case"image":case"link":Gt("error",l),Gt("load",l),v=_;break;case"details":Gt("toggle",l),v=_;break;case"input":ht(l,_),v=rt(l,_),Gt("invalid",l);break;case"option":v=_;break;case"select":l._wrapperState={wasMultiple:!!_.multiple},v=he({},_,{value:void 0}),Gt("invalid",l);break;case"textarea":$t(l,_),v=lr(l,_),Gt("invalid",l);break;default:v=_}gi(f,v),B=v;for(x in B)if(B.hasOwnProperty(x)){var H=B[x];x==="style"?Qs(l,H):x==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&dl(l,H)):x==="children"?typeof H=="string"?(f!=="textarea"||H!=="")&&rs(l,H):typeof H=="number"&&rs(l,""+H):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(r.hasOwnProperty(x)?H!=null&&x==="onScroll"&&Gt("scroll",l):H!=null&&N(l,x,H,M))}switch(f){case"input":U(l),ar(l,_,!1);break;case"textarea":U(l),cr(l);break;case"option":_.value!=null&&l.setAttribute("value",""+Y(_.value));break;case"select":l.multiple=!!_.multiple,x=_.value,x!=null?Mn(l,!!_.multiple,x,!1):_.defaultValue!=null&&Mn(l,!!_.multiple,_.defaultValue,!0);break;default:typeof v.onClick=="function"&&(l.onclick=$m)}switch(f){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return ii(u),null;case 6:if(l&&u.stateNode!=null)$2(l,u,l.memoizedProps,_);else{if(typeof _!="string"&&u.stateNode===null)throw Error(t(166));if(f=bl(jd.current),bl(ws.current),Qm(u)){if(_=u.stateNode,f=u.memoizedProps,_[Es]=u,(x=_.nodeValue!==f)&&(l=qi,l!==null))switch(l.tag){case 3:zm(_.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&zm(_.nodeValue,f,(l.mode&1)!==0)}x&&(u.flags|=4)}else _=(f.nodeType===9?f:f.ownerDocument).createTextNode(_),_[Es]=u,u.stateNode=_}return ii(u),null;case 13:if(Ut(Xt),_=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Wt&&Yi!==null&&(u.mode&1)!==0&&(u.flags&128)===0)KT(),wu(),u.flags|=98560,x=!1;else if(x=Qm(u),_!==null&&_.dehydrated!==null){if(l===null){if(!x)throw Error(t(318));if(x=u.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[Es]=u}else wu(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;ii(u),x=!1}else jr!==null&&(m1(jr),jr=null),x=!0;if(!x)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=f,u):(_=_!==null,_!==(l!==null&&l.memoizedState!==null)&&_&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(Xt.current&1)!==0?In===0&&(In=3):y1())),u.updateQueue!==null&&(u.flags|=4),ii(u),null);case 4:return Tu(),r1(l,u),l===null&&kd(u.stateNode.containerInfo),ii(u),null;case 10:return kv(u.type._context),ii(u),null;case 17:return Ai(u.type)&&Hm(),ii(u),null;case 19:if(Ut(Xt),x=u.memoizedState,x===null)return ii(u),null;if(_=(u.flags&128)!==0,M=x.rendering,M===null)if(_)$d(x,!1);else{if(In!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(M=ip(l),M!==null){for(u.flags|=128,$d(x,!1),_=M.updateQueue,_!==null&&(u.updateQueue=_,u.flags|=4),u.subtreeFlags=0,_=f,f=u.child;f!==null;)x=f,l=_,x.flags&=14680066,M=x.alternate,M===null?(x.childLanes=0,x.lanes=l,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=M.childLanes,x.lanes=M.lanes,x.child=M.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=M.memoizedProps,x.memoizedState=M.memoizedState,x.updateQueue=M.updateQueue,x.type=M.type,l=M.dependencies,x.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return Ot(Xt,Xt.current&1|2),u.child}l=l.sibling}x.tail!==null&&jt()>Cu&&(u.flags|=128,_=!0,$d(x,!1),u.lanes=4194304)}else{if(!_)if(l=ip(M),l!==null){if(u.flags|=128,_=!0,f=l.updateQueue,f!==null&&(u.updateQueue=f,u.flags|=4),$d(x,!0),x.tail===null&&x.tailMode==="hidden"&&!M.alternate&&!Wt)return ii(u),null}else 2*jt()-x.renderingStartTime>Cu&&f!==1073741824&&(u.flags|=128,_=!0,$d(x,!1),u.lanes=4194304);x.isBackwards?(M.sibling=u.child,u.child=M):(f=x.last,f!==null?f.sibling=M:u.child=M,x.last=M)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=jt(),u.sibling=null,f=Xt.current,Ot(Xt,_?f&1|2:f&1),u):(ii(u),null);case 22:case 23:return _1(),_=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(u.flags|=8192),_&&(u.mode&1)!==0?(Xi&1073741824)!==0&&(ii(u),u.subtreeFlags&6&&(u.flags|=8192)):ii(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function P5(l,u){switch(Rv(u),u.tag){case 1:return Ai(u.type)&&Hm(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Tu(),Ut(Ri),Ut(ti),jv(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return Vv(u),null;case 13:if(Ut(Xt),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(t(340));wu()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return Ut(Xt),null;case 4:return Tu(),null;case 10:return kv(u.type._context),null;case 22:case 23:return _1(),null;case 24:return null;default:return null}}var dp=!1,ri=!1,C5=typeof WeakSet=="function"?WeakSet:Set,Me=null;function Au(l,u){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(_){tn(l,u,_)}else f.current=null}function s1(l,u,f){try{f()}catch(_){tn(l,u,_)}}var W2=!1;function b5(l,u){if(_v=io,l=ST(),cv(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var _=f.getSelection&&f.getSelection();if(_&&_.rangeCount!==0){f=_.anchorNode;var v=_.anchorOffset,x=_.focusNode;_=_.focusOffset;try{f.nodeType,x.nodeType}catch{f=null;break e}var M=0,B=-1,H=-1,re=0,_e=0,ye=l,me=null;t:for(;;){for(var Ce;ye!==f||v!==0&&ye.nodeType!==3||(B=M+v),ye!==x||_!==0&&ye.nodeType!==3||(H=M+_),ye.nodeType===3&&(M+=ye.nodeValue.length),(Ce=ye.firstChild)!==null;)me=ye,ye=Ce;for(;;){if(ye===l)break t;if(me===f&&++re===v&&(B=M),me===x&&++_e===_&&(H=M),(Ce=ye.nextSibling)!==null)break;ye=me,me=ye.parentNode}ye=Ce}f=B===-1||H===-1?null:{start:B,end:H}}else f=null}f=f||{start:0,end:0}}else f=null;for(yv={focusedElem:l,selectionRange:f},io=!1,Me=u;Me!==null;)if(u=Me,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Me=l;else for(;Me!==null;){u=Me;try{var Le=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(Le!==null){var Oe=Le.memoizedProps,hn=Le.memoizedState,ee=u.stateNode,q=ee.getSnapshotBeforeUpdate(u.elementType===u.type?Oe:Gr(u.type,Oe),hn);ee.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var ne=u.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(we){tn(u,u.return,we)}if(l=u.sibling,l!==null){l.return=u.return,Me=l;break}Me=u.return}return Le=W2,W2=!1,Le}function Wd(l,u,f){var _=u.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var v=_=_.next;do{if((v.tag&l)===l){var x=v.destroy;v.destroy=void 0,x!==void 0&&s1(u,f,x)}v=v.next}while(v!==_)}}function fp(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&l)===l){var _=f.create;f.destroy=_()}f=f.next}while(f!==u)}}function o1(l){var u=l.ref;if(u!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof u=="function"?u(l):u.current=l}}function H2(l){var u=l.alternate;u!==null&&(l.alternate=null,H2(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[Es],delete u[Nd],delete u[xv],delete u[d5],delete u[f5])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function K2(l){return l.tag===5||l.tag===3||l.tag===4}function q2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||K2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function a1(l,u,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?f.nodeType===8?f.parentNode.insertBefore(l,u):f.insertBefore(l,u):(f.nodeType===8?(u=f.parentNode,u.insertBefore(l,f)):(u=f,u.appendChild(l)),f=f._reactRootContainer,f!=null||u.onclick!==null||(u.onclick=$m));else if(_!==4&&(l=l.child,l!==null))for(a1(l,u,f),l=l.sibling;l!==null;)a1(l,u,f),l=l.sibling}function l1(l,u,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?f.insertBefore(l,u):f.appendChild(l);else if(_!==4&&(l=l.child,l!==null))for(l1(l,u,f),l=l.sibling;l!==null;)l1(l,u,f),l=l.sibling}var Wn=null,Ur=!1;function na(l,u,f){for(f=f.child;f!==null;)Y2(l,u,f),f=f.sibling}function Y2(l,u,f){if(Bi&&typeof Bi.onCommitFiberUnmount=="function")try{Bi.onCommitFiberUnmount(pl,f)}catch{}switch(f.tag){case 5:ri||Au(f,u);case 6:var _=Wn,v=Ur;Wn=null,na(l,u,f),Wn=_,Ur=v,Wn!==null&&(Ur?(l=Wn,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):Wn.removeChild(f.stateNode));break;case 18:Wn!==null&&(Ur?(l=Wn,f=f.stateNode,l.nodeType===8?wv(l.parentNode,f):l.nodeType===1&&wv(l,f),Ho(l)):wv(Wn,f.stateNode));break;case 4:_=Wn,v=Ur,Wn=f.stateNode.containerInfo,Ur=!0,na(l,u,f),Wn=_,Ur=v;break;case 0:case 11:case 14:case 15:if(!ri&&(_=f.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){v=_=_.next;do{var x=v,M=x.destroy;x=x.tag,M!==void 0&&((x&2)!==0||(x&4)!==0)&&s1(f,u,M),v=v.next}while(v!==_)}na(l,u,f);break;case 1:if(!ri&&(Au(f,u),_=f.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=f.memoizedProps,_.state=f.memoizedState,_.componentWillUnmount()}catch(B){tn(f,u,B)}na(l,u,f);break;case 21:na(l,u,f);break;case 22:f.mode&1?(ri=(_=ri)||f.memoizedState!==null,na(l,u,f),ri=_):na(l,u,f);break;default:na(l,u,f)}}function X2(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new C5),u.forEach(function(_){var v=j5.bind(null,l,_);f.has(_)||(f.add(_),_.then(v,v))})}}function Br(l,u){var f=u.deletions;if(f!==null)for(var _=0;_<f.length;_++){var v=f[_];try{var x=l,M=u,B=M;e:for(;B!==null;){switch(B.tag){case 5:Wn=B.stateNode,Ur=!1;break e;case 3:Wn=B.stateNode.containerInfo,Ur=!0;break e;case 4:Wn=B.stateNode.containerInfo,Ur=!0;break e}B=B.return}if(Wn===null)throw Error(t(160));Y2(x,M,v),Wn=null,Ur=!1;var H=v.alternate;H!==null&&(H.return=null),v.return=null}catch(re){tn(v,u,re)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)Q2(u,l),u=u.sibling}function Q2(l,u){var f=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Br(u,l),Ss(l),_&4){try{Wd(3,l,l.return),fp(3,l)}catch(Oe){tn(l,l.return,Oe)}try{Wd(5,l,l.return)}catch(Oe){tn(l,l.return,Oe)}}break;case 1:Br(u,l),Ss(l),_&512&&f!==null&&Au(f,f.return);break;case 5:if(Br(u,l),Ss(l),_&512&&f!==null&&Au(f,f.return),l.flags&32){var v=l.stateNode;try{rs(v,"")}catch(Oe){tn(l,l.return,Oe)}}if(_&4&&(v=l.stateNode,v!=null)){var x=l.memoizedProps,M=f!==null?f.memoizedProps:x,B=l.type,H=l.updateQueue;if(l.updateQueue=null,H!==null)try{B==="input"&&x.type==="radio"&&x.name!=null&&Ft(v,x),Zs(B,M);var re=Zs(B,x);for(M=0;M<H.length;M+=2){var _e=H[M],ye=H[M+1];_e==="style"?Qs(v,ye):_e==="dangerouslySetInnerHTML"?dl(v,ye):_e==="children"?rs(v,ye):N(v,_e,ye,re)}switch(B){case"input":an(v,x);break;case"textarea":Go(v,x);break;case"select":var me=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!x.multiple;var Ce=x.value;Ce!=null?Mn(v,!!x.multiple,Ce,!1):me!==!!x.multiple&&(x.defaultValue!=null?Mn(v,!!x.multiple,x.defaultValue,!0):Mn(v,!!x.multiple,x.multiple?[]:"",!1))}v[Nd]=x}catch(Oe){tn(l,l.return,Oe)}}break;case 6:if(Br(u,l),Ss(l),_&4){if(l.stateNode===null)throw Error(t(162));v=l.stateNode,x=l.memoizedProps;try{v.nodeValue=x}catch(Oe){tn(l,l.return,Oe)}}break;case 3:if(Br(u,l),Ss(l),_&4&&f!==null&&f.memoizedState.isDehydrated)try{Ho(u.containerInfo)}catch(Oe){tn(l,l.return,Oe)}break;case 4:Br(u,l),Ss(l);break;case 13:Br(u,l),Ss(l),v=l.child,v.flags&8192&&(x=v.memoizedState!==null,v.stateNode.isHidden=x,!x||v.alternate!==null&&v.alternate.memoizedState!==null||(h1=jt())),_&4&&X2(l);break;case 22:if(_e=f!==null&&f.memoizedState!==null,l.mode&1?(ri=(re=ri)||_e,Br(u,l),ri=re):Br(u,l),Ss(l),_&8192){if(re=l.memoizedState!==null,(l.stateNode.isHidden=re)&&!_e&&(l.mode&1)!==0)for(Me=l,_e=l.child;_e!==null;){for(ye=Me=_e;Me!==null;){switch(me=Me,Ce=me.child,me.tag){case 0:case 11:case 14:case 15:Wd(4,me,me.return);break;case 1:Au(me,me.return);var Le=me.stateNode;if(typeof Le.componentWillUnmount=="function"){_=me,f=me.return;try{u=_,Le.props=u.memoizedProps,Le.state=u.memoizedState,Le.componentWillUnmount()}catch(Oe){tn(_,f,Oe)}}break;case 5:Au(me,me.return);break;case 22:if(me.memoizedState!==null){eR(ye);continue}}Ce!==null?(Ce.return=me,Me=Ce):eR(ye)}_e=_e.sibling}e:for(_e=null,ye=l;;){if(ye.tag===5){if(_e===null){_e=ye;try{v=ye.stateNode,re?(x=v.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(B=ye.stateNode,H=ye.memoizedProps.style,M=H!=null&&H.hasOwnProperty("display")?H.display:null,B.style.display=ss("display",M))}catch(Oe){tn(l,l.return,Oe)}}}else if(ye.tag===6){if(_e===null)try{ye.stateNode.nodeValue=re?"":ye.memoizedProps}catch(Oe){tn(l,l.return,Oe)}}else if((ye.tag!==22&&ye.tag!==23||ye.memoizedState===null||ye===l)&&ye.child!==null){ye.child.return=ye,ye=ye.child;continue}if(ye===l)break e;for(;ye.sibling===null;){if(ye.return===null||ye.return===l)break e;_e===ye&&(_e=null),ye=ye.return}_e===ye&&(_e=null),ye.sibling.return=ye.return,ye=ye.sibling}}break;case 19:Br(u,l),Ss(l),_&4&&X2(l);break;case 21:break;default:Br(u,l),Ss(l)}}function Ss(l){var u=l.flags;if(u&2){try{e:{for(var f=l.return;f!==null;){if(K2(f)){var _=f;break e}f=f.return}throw Error(t(160))}switch(_.tag){case 5:var v=_.stateNode;_.flags&32&&(rs(v,""),_.flags&=-33);var x=q2(l);l1(l,x,v);break;case 3:case 4:var M=_.stateNode.containerInfo,B=q2(l);a1(l,B,M);break;default:throw Error(t(161))}}catch(H){tn(l,l.return,H)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function M5(l,u,f){Me=l,Z2(l)}function Z2(l,u,f){for(var _=(l.mode&1)!==0;Me!==null;){var v=Me,x=v.child;if(v.tag===22&&_){var M=v.memoizedState!==null||dp;if(!M){var B=v.alternate,H=B!==null&&B.memoizedState!==null||ri;B=dp;var re=ri;if(dp=M,(ri=H)&&!re)for(Me=v;Me!==null;)M=Me,H=M.child,M.tag===22&&M.memoizedState!==null?tR(v):H!==null?(H.return=M,Me=H):tR(v);for(;x!==null;)Me=x,Z2(x),x=x.sibling;Me=v,dp=B,ri=re}J2(l)}else(v.subtreeFlags&8772)!==0&&x!==null?(x.return=v,Me=x):J2(l)}}function J2(l){for(;Me!==null;){var u=Me;if((u.flags&8772)!==0){var f=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:ri||fp(5,u);break;case 1:var _=u.stateNode;if(u.flags&4&&!ri)if(f===null)_.componentDidMount();else{var v=u.elementType===u.type?f.memoizedProps:Gr(u.type,f.memoizedProps);_.componentDidUpdate(v,f.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var x=u.updateQueue;x!==null&&e2(u,x,_);break;case 3:var M=u.updateQueue;if(M!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=u.child.stateNode;break;case 1:f=u.child.stateNode}e2(u,M,f)}break;case 5:var B=u.stateNode;if(f===null&&u.flags&4){f=B;var H=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&f.focus();break;case"img":H.src&&(f.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var re=u.alternate;if(re!==null){var _e=re.memoizedState;if(_e!==null){var ye=_e.dehydrated;ye!==null&&Ho(ye)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ri||u.flags&512&&o1(u)}catch(me){tn(u,u.return,me)}}if(u===l){Me=null;break}if(f=u.sibling,f!==null){f.return=u.return,Me=f;break}Me=u.return}}function eR(l){for(;Me!==null;){var u=Me;if(u===l){Me=null;break}var f=u.sibling;if(f!==null){f.return=u.return,Me=f;break}Me=u.return}}function tR(l){for(;Me!==null;){var u=Me;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{fp(4,u)}catch(H){tn(u,f,H)}break;case 1:var _=u.stateNode;if(typeof _.componentDidMount=="function"){var v=u.return;try{_.componentDidMount()}catch(H){tn(u,v,H)}}var x=u.return;try{o1(u)}catch(H){tn(u,x,H)}break;case 5:var M=u.return;try{o1(u)}catch(H){tn(u,M,H)}}}catch(H){tn(u,u.return,H)}if(u===l){Me=null;break}var B=u.sibling;if(B!==null){B.return=u.return,Me=B;break}Me=u.return}}var k5=Math.ceil,gp=D.ReactCurrentDispatcher,c1=D.ReactCurrentOwner,vr=D.ReactCurrentBatchConfig,gt=0,Nn=null,pn=null,Hn=0,Xi=0,Pu=Qo(0),In=0,Hd=null,kl=0,mp=0,u1=0,Kd=null,Ci=null,h1=0,Cu=1/0,go=null,pp=!1,d1=null,ia=null,_p=!1,ra=null,yp=0,qd=0,f1=null,vp=-1,Ep=0;function yi(){return(gt&6)!==0?jt():vp!==-1?vp:vp=jt()}function sa(l){return(l.mode&1)===0?1:(gt&2)!==0&&Hn!==0?Hn&-Hn:m5.transition!==null?(Ep===0&&(Ep=md()),Ep):(l=ct,l!==0||(l=window.event,l=l===void 0?16:ru(l.type)),l)}function zr(l,u,f,_){if(50<qd)throw qd=0,f1=null,Error(t(185));El(l,f,_),((gt&2)===0||l!==Nn)&&(l===Nn&&((gt&2)===0&&(mp|=f),In===4&&oa(l,Hn)),bi(l,_),f===1&&gt===0&&(u.mode&1)===0&&(Cu=jt()+500,qm&&Jo()))}function bi(l,u){var f=l.callbackNode;vl(l,u);var _=eo(l,l===Nn?Hn:0);if(_===0)f!==null&&Qc(f),l.callbackNode=null,l.callbackPriority=0;else if(u=_&-_,l.callbackPriority!==u){if(f!=null&&Qc(f),u===1)l.tag===0?g5(iR.bind(null,l)):BT(iR.bind(null,l)),u5(function(){(gt&6)===0&&Jo()}),f=null;else{switch(us(_)){case 1:f=Zc;break;case 4:f=dd;break;case 16:f=ml;break;case 536870912:f=Jc;break;default:f=ml}f=hR(f,nR.bind(null,l))}l.callbackPriority=u,l.callbackNode=f}}function nR(l,u){if(vp=-1,Ep=0,(gt&6)!==0)throw Error(t(327));var f=l.callbackNode;if(bu()&&l.callbackNode!==f)return null;var _=eo(l,l===Nn?Hn:0);if(_===0)return null;if((_&30)!==0||(_&l.expiredLanes)!==0||u)u=wp(l,_);else{u=_;var v=gt;gt|=2;var x=sR();(Nn!==l||Hn!==u)&&(go=null,Cu=jt()+500,Nl(l,u));do try{O5();break}catch(B){rR(l,B)}while(!0);Mv(),gp.current=x,gt=v,pn!==null?u=0:(Nn=null,Hn=0,u=In)}if(u!==0){if(u===2&&(v=gd(l),v!==0&&(_=v,u=g1(l,v))),u===1)throw f=Hd,Nl(l,0),oa(l,_),bi(l,jt()),f;if(u===6)oa(l,_);else{if(v=l.current.alternate,(_&30)===0&&!L5(v)&&(u=wp(l,_),u===2&&(x=gd(l),x!==0&&(_=x,u=g1(l,x))),u===1))throw f=Hd,Nl(l,0),oa(l,_),bi(l,jt()),f;switch(l.finishedWork=v,l.finishedLanes=_,u){case 0:case 1:throw Error(t(345));case 2:Ol(l,Ci,go);break;case 3:if(oa(l,_),(_&130023424)===_&&(u=h1+500-jt(),10<u)){if(eo(l,0)!==0)break;if(v=l.suspendedLanes,(v&_)!==_){yi(),l.pingedLanes|=l.suspendedLanes&v;break}l.timeoutHandle=Ev(Ol.bind(null,l,Ci,go),u);break}Ol(l,Ci,go);break;case 4:if(oa(l,_),(_&4194240)===_)break;for(u=l.eventTimes,v=-1;0<_;){var M=31-zi(_);x=1<<M,M=u[M],M>v&&(v=M),_&=~x}if(_=v,_=jt()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*k5(_/1960))-_,10<_){l.timeoutHandle=Ev(Ol.bind(null,l,Ci,go),_);break}Ol(l,Ci,go);break;case 5:Ol(l,Ci,go);break;default:throw Error(t(329))}}}return bi(l,jt()),l.callbackNode===f?nR.bind(null,l):null}function g1(l,u){var f=Kd;return l.current.memoizedState.isDehydrated&&(Nl(l,u).flags|=256),l=wp(l,u),l!==2&&(u=Ci,Ci=f,u!==null&&m1(u)),l}function m1(l){Ci===null?Ci=l:Ci.push.apply(Ci,l)}function L5(l){for(var u=l;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var _=0;_<f.length;_++){var v=f[_],x=v.getSnapshot;v=v.value;try{if(!Fr(x(),v))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function oa(l,u){for(u&=~u1,u&=~mp,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var f=31-zi(u),_=1<<f;l[f]=-1,u&=~_}}function iR(l){if((gt&6)!==0)throw Error(t(327));bu();var u=eo(l,0);if((u&1)===0)return bi(l,jt()),null;var f=wp(l,u);if(l.tag!==0&&f===2){var _=gd(l);_!==0&&(u=_,f=g1(l,_))}if(f===1)throw f=Hd,Nl(l,0),oa(l,u),bi(l,jt()),f;if(f===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,Ol(l,Ci,go),bi(l,jt()),null}function p1(l,u){var f=gt;gt|=1;try{return l(u)}finally{gt=f,gt===0&&(Cu=jt()+500,qm&&Jo())}}function Ll(l){ra!==null&&ra.tag===0&&(gt&6)===0&&bu();var u=gt;gt|=1;var f=vr.transition,_=ct;try{if(vr.transition=null,ct=1,l)return l()}finally{ct=_,vr.transition=f,gt=u,(gt&6)===0&&Jo()}}function _1(){Xi=Pu.current,Ut(Pu)}function Nl(l,u){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,c5(f)),pn!==null)for(f=pn.return;f!==null;){var _=f;switch(Rv(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Hm();break;case 3:Tu(),Ut(Ri),Ut(ti),jv();break;case 5:Vv(_);break;case 4:Tu();break;case 13:Ut(Xt);break;case 19:Ut(Xt);break;case 10:kv(_.type._context);break;case 22:case 23:_1()}f=f.return}if(Nn=l,pn=l=aa(l.current,null),Hn=Xi=u,In=0,Hd=null,u1=mp=kl=0,Ci=Kd=null,Cl!==null){for(u=0;u<Cl.length;u++)if(f=Cl[u],_=f.interleaved,_!==null){f.interleaved=null;var v=_.next,x=f.pending;if(x!==null){var M=x.next;x.next=v,_.next=M}f.pending=_}Cl=null}return l}function rR(l,u){do{var f=pn;try{if(Mv(),rp.current=lp,sp){for(var _=Qt.memoizedState;_!==null;){var v=_.queue;v!==null&&(v.pending=null),_=_.next}sp=!1}if(Ml=0,Ln=Sn=Qt=null,Gd=!1,Ud=0,c1.current=null,f===null||f.return===null){In=1,Hd=u,pn=null;break}e:{var x=l,M=f.return,B=f,H=u;if(u=Hn,B.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var re=H,_e=B,ye=_e.tag;if((_e.mode&1)===0&&(ye===0||ye===11||ye===15)){var me=_e.alternate;me?(_e.updateQueue=me.updateQueue,_e.memoizedState=me.memoizedState,_e.lanes=me.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var Ce=C2(M);if(Ce!==null){Ce.flags&=-257,b2(Ce,M,B,x,u),Ce.mode&1&&P2(x,re,u),u=Ce,H=re;var Le=u.updateQueue;if(Le===null){var Oe=new Set;Oe.add(H),u.updateQueue=Oe}else Le.add(H);break e}else{if((u&1)===0){P2(x,re,u),y1();break e}H=Error(t(426))}}else if(Wt&&B.mode&1){var hn=C2(M);if(hn!==null){(hn.flags&65536)===0&&(hn.flags|=256),b2(hn,M,B,x,u),Cv(Ru(H,B));break e}}x=H=Ru(H,B),In!==4&&(In=2),Kd===null?Kd=[x]:Kd.push(x),x=M;do{switch(x.tag){case 3:x.flags|=65536,u&=-u,x.lanes|=u;var ee=R2(x,H,u);JT(x,ee);break e;case 1:B=H;var q=x.type,ne=x.stateNode;if((x.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(ia===null||!ia.has(ne)))){x.flags|=65536,u&=-u,x.lanes|=u;var we=A2(x,B,u);JT(x,we);break e}}x=x.return}while(x!==null)}aR(f)}catch(De){u=De,pn===f&&f!==null&&(pn=f=f.return);continue}break}while(!0)}function sR(){var l=gp.current;return gp.current=lp,l===null?lp:l}function y1(){(In===0||In===3||In===2)&&(In=4),Nn===null||(kl&268435455)===0&&(mp&268435455)===0||oa(Nn,Hn)}function wp(l,u){var f=gt;gt|=2;var _=sR();(Nn!==l||Hn!==u)&&(go=null,Nl(l,u));do try{N5();break}catch(v){rR(l,v)}while(!0);if(Mv(),gt=f,gp.current=_,pn!==null)throw Error(t(261));return Nn=null,Hn=0,In}function N5(){for(;pn!==null;)oR(pn)}function O5(){for(;pn!==null&&!gl();)oR(pn)}function oR(l){var u=uR(l.alternate,l,Xi);l.memoizedProps=l.pendingProps,u===null?aR(l):pn=u,c1.current=null}function aR(l){var u=l;do{var f=u.alternate;if(l=u.return,(u.flags&32768)===0){if(f=A5(f,u,Xi),f!==null){pn=f;return}}else{if(f=P5(f,u),f!==null){f.flags&=32767,pn=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{In=6,pn=null;return}}if(u=u.sibling,u!==null){pn=u;return}pn=u=l}while(u!==null);In===0&&(In=5)}function Ol(l,u,f){var _=ct,v=vr.transition;try{vr.transition=null,ct=1,D5(l,u,f,_)}finally{vr.transition=v,ct=_}return null}function D5(l,u,f,_){do bu();while(ra!==null);if((gt&6)!==0)throw Error(t(327));f=l.finishedWork;var v=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var x=f.lanes|f.childLanes;if(rv(l,x),l===Nn&&(pn=Nn=null,Hn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||_p||(_p=!0,hR(ml,function(){return bu(),null})),x=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||x){x=vr.transition,vr.transition=null;var M=ct;ct=1;var B=gt;gt|=4,c1.current=null,b5(l,f),Q2(f,l),n5(yv),io=!!_v,yv=_v=null,l.current=f,M5(f),Js(),gt=B,ct=M,vr.transition=x}else l.current=f;if(_p&&(_p=!1,ra=l,yp=v),x=l.pendingLanes,x===0&&(ia=null),Pm(f.stateNode),bi(l,jt()),u!==null)for(_=l.onRecoverableError,f=0;f<u.length;f++)v=u[f],_(v.value,{componentStack:v.stack,digest:v.digest});if(pp)throw pp=!1,l=d1,d1=null,l;return(yp&1)!==0&&l.tag!==0&&bu(),x=l.pendingLanes,(x&1)!==0?l===f1?qd++:(qd=0,f1=l):qd=0,Jo(),null}function bu(){if(ra!==null){var l=us(yp),u=vr.transition,f=ct;try{if(vr.transition=null,ct=16>l?16:l,ra===null)var _=!1;else{if(l=ra,ra=null,yp=0,(gt&6)!==0)throw Error(t(331));var v=gt;for(gt|=4,Me=l.current;Me!==null;){var x=Me,M=x.child;if((Me.flags&16)!==0){var B=x.deletions;if(B!==null){for(var H=0;H<B.length;H++){var re=B[H];for(Me=re;Me!==null;){var _e=Me;switch(_e.tag){case 0:case 11:case 15:Wd(8,_e,x)}var ye=_e.child;if(ye!==null)ye.return=_e,Me=ye;else for(;Me!==null;){_e=Me;var me=_e.sibling,Ce=_e.return;if(H2(_e),_e===re){Me=null;break}if(me!==null){me.return=Ce,Me=me;break}Me=Ce}}}var Le=x.alternate;if(Le!==null){var Oe=Le.child;if(Oe!==null){Le.child=null;do{var hn=Oe.sibling;Oe.sibling=null,Oe=hn}while(Oe!==null)}}Me=x}}if((x.subtreeFlags&2064)!==0&&M!==null)M.return=x,Me=M;else e:for(;Me!==null;){if(x=Me,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Wd(9,x,x.return)}var ee=x.sibling;if(ee!==null){ee.return=x.return,Me=ee;break e}Me=x.return}}var q=l.current;for(Me=q;Me!==null;){M=Me;var ne=M.child;if((M.subtreeFlags&2064)!==0&&ne!==null)ne.return=M,Me=ne;else e:for(M=q;Me!==null;){if(B=Me,(B.flags&2048)!==0)try{switch(B.tag){case 0:case 11:case 15:fp(9,B)}}catch(De){tn(B,B.return,De)}if(B===M){Me=null;break e}var we=B.sibling;if(we!==null){we.return=B.return,Me=we;break e}Me=B.return}}if(gt=v,Jo(),Bi&&typeof Bi.onPostCommitFiberRoot=="function")try{Bi.onPostCommitFiberRoot(pl,l)}catch{}_=!0}return _}finally{ct=f,vr.transition=u}}return!1}function lR(l,u,f){u=Ru(f,u),u=R2(l,u,1),l=ta(l,u,1),u=yi(),l!==null&&(El(l,1,u),bi(l,u))}function tn(l,u,f){if(l.tag===3)lR(l,l,f);else for(;u!==null;){if(u.tag===3){lR(u,l,f);break}else if(u.tag===1){var _=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(ia===null||!ia.has(_))){l=Ru(f,l),l=A2(u,l,1),u=ta(u,l,1),l=yi(),u!==null&&(El(u,1,l),bi(u,l));break}}u=u.return}}function V5(l,u,f){var _=l.pingCache;_!==null&&_.delete(u),u=yi(),l.pingedLanes|=l.suspendedLanes&f,Nn===l&&(Hn&f)===f&&(In===4||In===3&&(Hn&130023424)===Hn&&500>jt()-h1?Nl(l,0):u1|=f),bi(l,u)}function cR(l,u){u===0&&((l.mode&1)===0?u=1:(u=zo,zo<<=1,(zo&130023424)===0&&(zo=4194304)));var f=yi();l=uo(l,u),l!==null&&(El(l,u,f),bi(l,f))}function F5(l){var u=l.memoizedState,f=0;u!==null&&(f=u.retryLane),cR(l,f)}function j5(l,u){var f=0;switch(l.tag){case 13:var _=l.stateNode,v=l.memoizedState;v!==null&&(f=v.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(u),cR(l,f)}var uR;uR=function(l,u,f){if(l!==null)if(l.memoizedProps!==u.pendingProps||Ri.current)Pi=!0;else{if((l.lanes&f)===0&&(u.flags&128)===0)return Pi=!1,R5(l,u,f);Pi=(l.flags&131072)!==0}else Pi=!1,Wt&&(u.flags&1048576)!==0&&zT(u,Xm,u.index);switch(u.lanes=0,u.tag){case 2:var _=u.type;hp(l,u),l=u.pendingProps;var v=yu(u,ti.current);Iu(u,f),v=Bv(null,u,_,l,v,f);var x=zv();return u.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Ai(_)?(x=!0,Km(u)):x=!1,u.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Ov(u),v.updater=cp,u.stateNode=v,v._reactInternals=u,Yv(u,_,l,f),u=Jv(null,u,_,!0,x,f)):(u.tag=0,Wt&&x&&Tv(u),_i(null,u,v,f),u=u.child),u;case 16:_=u.elementType;e:{switch(hp(l,u),l=u.pendingProps,v=_._init,_=v(_._payload),u.type=_,v=u.tag=U5(_),l=Gr(_,l),v){case 0:u=Zv(null,u,_,l,f);break e;case 1:u=D2(null,u,_,l,f);break e;case 11:u=M2(null,u,_,l,f);break e;case 14:u=k2(null,u,_,Gr(_.type,l),f);break e}throw Error(t(306,_,""))}return u;case 0:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),Zv(l,u,_,v,f);case 1:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),D2(l,u,_,v,f);case 3:e:{if(V2(u),l===null)throw Error(t(387));_=u.pendingProps,x=u.memoizedState,v=x.element,ZT(l,u),np(u,_,null,f);var M=u.memoizedState;if(_=M.element,x.isDehydrated)if(x={element:_,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){v=Ru(Error(t(423)),u),u=F2(l,u,_,f,v);break e}else if(_!==v){v=Ru(Error(t(424)),u),u=F2(l,u,_,f,v);break e}else for(Yi=Xo(u.stateNode.containerInfo.firstChild),qi=u,Wt=!0,jr=null,f=XT(u,null,_,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(wu(),_===v){u=fo(l,u,f);break e}_i(l,u,_,f)}u=u.child}return u;case 5:return t2(u),l===null&&Pv(u),_=u.type,v=u.pendingProps,x=l!==null?l.memoizedProps:null,M=v.children,vv(_,v)?M=null:x!==null&&vv(_,x)&&(u.flags|=32),O2(l,u),_i(l,u,M,f),u.child;case 6:return l===null&&Pv(u),null;case 13:return j2(l,u,f);case 4:return Dv(u,u.stateNode.containerInfo),_=u.pendingProps,l===null?u.child=xu(u,null,_,f):_i(l,u,_,f),u.child;case 11:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),M2(l,u,_,v,f);case 7:return _i(l,u,u.pendingProps,f),u.child;case 8:return _i(l,u,u.pendingProps.children,f),u.child;case 12:return _i(l,u,u.pendingProps.children,f),u.child;case 10:e:{if(_=u.type._context,v=u.pendingProps,x=u.memoizedProps,M=v.value,Ot(Jm,_._currentValue),_._currentValue=M,x!==null)if(Fr(x.value,M)){if(x.children===v.children&&!Ri.current){u=fo(l,u,f);break e}}else for(x=u.child,x!==null&&(x.return=u);x!==null;){var B=x.dependencies;if(B!==null){M=x.child;for(var H=B.firstContext;H!==null;){if(H.context===_){if(x.tag===1){H=ho(-1,f&-f),H.tag=2;var re=x.updateQueue;if(re!==null){re=re.shared;var _e=re.pending;_e===null?H.next=H:(H.next=_e.next,_e.next=H),re.pending=H}}x.lanes|=f,H=x.alternate,H!==null&&(H.lanes|=f),Lv(x.return,f,u),B.lanes|=f;break}H=H.next}}else if(x.tag===10)M=x.type===u.type?null:x.child;else if(x.tag===18){if(M=x.return,M===null)throw Error(t(341));M.lanes|=f,B=M.alternate,B!==null&&(B.lanes|=f),Lv(M,f,u),M=x.sibling}else M=x.child;if(M!==null)M.return=x;else for(M=x;M!==null;){if(M===u){M=null;break}if(x=M.sibling,x!==null){x.return=M.return,M=x;break}M=M.return}x=M}_i(l,u,v.children,f),u=u.child}return u;case 9:return v=u.type,_=u.pendingProps.children,Iu(u,f),v=_r(v),_=_(v),u.flags|=1,_i(l,u,_,f),u.child;case 14:return _=u.type,v=Gr(_,u.pendingProps),v=Gr(_.type,v),k2(l,u,_,v,f);case 15:return L2(l,u,u.type,u.pendingProps,f);case 17:return _=u.type,v=u.pendingProps,v=u.elementType===_?v:Gr(_,v),hp(l,u),u.tag=1,Ai(_)?(l=!0,Km(u)):l=!1,Iu(u,f),I2(u,_,v),Yv(u,_,v,f),Jv(null,u,_,!0,l,f);case 19:return U2(l,u,f);case 22:return N2(l,u,f)}throw Error(t(156,u.tag))};function hR(l,u){return hd(l,u)}function G5(l,u,f,_){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(l,u,f,_){return new G5(l,u,f,_)}function v1(l){return l=l.prototype,!(!l||!l.isReactComponent)}function U5(l){if(typeof l=="function")return v1(l)?1:0;if(l!=null){if(l=l.$$typeof,l===z)return 11;if(l===Pe)return 14}return 2}function aa(l,u){var f=l.alternate;return f===null?(f=Er(l.tag,u,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=u,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,u=l.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function xp(l,u,f,_,v,x){var M=2;if(_=l,typeof l=="function")v1(l)&&(M=1);else if(typeof l=="string")M=5;else e:switch(l){case k:return Dl(f.children,v,x,u);case C:M=8,v|=8;break;case L:return l=Er(12,f,u,v|2),l.elementType=L,l.lanes=x,l;case V:return l=Er(13,f,u,v),l.elementType=V,l.lanes=x,l;case de:return l=Er(19,f,u,v),l.elementType=de,l.lanes=x,l;case fe:return Sp(f,v,x,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case j:M=10;break e;case G:M=9;break e;case z:M=11;break e;case Pe:M=14;break e;case ue:M=16,_=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return u=Er(M,f,u,v),u.elementType=l,u.type=_,u.lanes=x,u}function Dl(l,u,f,_){return l=Er(7,l,_,u),l.lanes=f,l}function Sp(l,u,f,_){return l=Er(22,l,_,u),l.elementType=fe,l.lanes=f,l.stateNode={isHidden:!1},l}function E1(l,u,f){return l=Er(6,l,null,u),l.lanes=f,l}function w1(l,u,f){return u=Er(4,l.children!==null?l.children:[],l.key,u),u.lanes=f,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function B5(l,u,f,_,v){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pd(0),this.expirationTimes=pd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pd(0),this.identifierPrefix=_,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function x1(l,u,f,_,v,x,M,B,H){return l=new B5(l,u,f,B,H),u===1?(u=1,x===!0&&(u|=8)):u=0,x=Er(3,null,null,u),l.current=x,x.stateNode=l,x.memoizedState={element:_,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ov(x),l}function z5(l,u,f){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$,key:_==null?null:""+_,children:l,containerInfo:u,implementation:f}}function dR(l){if(!l)return Zo;l=l._reactInternals;e:{if(Dr(l)!==l||l.tag!==1)throw Error(t(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Ai(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(l.tag===1){var f=l.type;if(Ai(f))return GT(l,f,u)}return u}function fR(l,u,f,_,v,x,M,B,H){return l=x1(f,_,!0,l,v,x,M,B,H),l.context=dR(null),f=l.current,_=yi(),v=sa(f),x=ho(_,v),x.callback=u??null,ta(f,x,v),l.current.lanes=v,El(l,v,_),bi(l,_),l}function Ip(l,u,f,_){var v=u.current,x=yi(),M=sa(v);return f=dR(f),u.context===null?u.context=f:u.pendingContext=f,u=ho(x,M),u.payload={element:l},_=_===void 0?null:_,_!==null&&(u.callback=_),l=ta(v,u,M),l!==null&&(zr(l,v,M,x),tp(l,v,M)),M}function Tp(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function gR(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<u?f:u}}function S1(l,u){gR(l,u),(l=l.alternate)&&gR(l,u)}function $5(){return null}var mR=typeof reportError=="function"?reportError:function(l){console.error(l)};function I1(l){this._internalRoot=l}Rp.prototype.render=I1.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(t(409));Ip(l,u,null,null)},Rp.prototype.unmount=I1.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;Ll(function(){Ip(null,l,null,null)}),u[oo]=null}};function Rp(l){this._internalRoot=l}Rp.prototype.unstable_scheduleHydration=function(l){if(l){var u=Ed();l={blockedOn:null,target:l,priority:u};for(var f=0;f<$i.length&&u!==0&&u<$i[f].priority;f++);$i.splice(f,0,l),f===0&&nu(l)}};function T1(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Ap(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function pR(){}function W5(l,u,f,_,v){if(v){if(typeof _=="function"){var x=_;_=function(){var re=Tp(M);x.call(re)}}var M=fR(u,_,l,0,null,!1,!1,"",pR);return l._reactRootContainer=M,l[oo]=M.current,kd(l.nodeType===8?l.parentNode:l),Ll(),M}for(;v=l.lastChild;)l.removeChild(v);if(typeof _=="function"){var B=_;_=function(){var re=Tp(H);B.call(re)}}var H=x1(l,0,!1,null,null,!1,!1,"",pR);return l._reactRootContainer=H,l[oo]=H.current,kd(l.nodeType===8?l.parentNode:l),Ll(function(){Ip(u,H,f,_)}),H}function Pp(l,u,f,_,v){var x=f._reactRootContainer;if(x){var M=x;if(typeof v=="function"){var B=v;v=function(){var H=Tp(M);B.call(H)}}Ip(u,M,l,v)}else M=W5(f,u,l,v,_);return Tp(M)}yd=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var f=yt(u.pendingLanes);f!==0&&(_d(u,f|1),bi(u,jt()),(gt&6)===0&&(Cu=jt()+500,Jo()))}break;case 13:Ll(function(){var _=uo(l,1);if(_!==null){var v=yi();zr(_,l,1,v)}}),S1(l,1)}},eu=function(l){if(l.tag===13){var u=uo(l,134217728);if(u!==null){var f=yi();zr(u,l,134217728,f)}S1(l,134217728)}},vd=function(l){if(l.tag===13){var u=sa(l),f=uo(l,u);if(f!==null){var _=yi();zr(f,l,u,_)}S1(l,u)}},Ed=function(){return ct},wd=function(l,u){var f=ct;try{return ct=l,u()}finally{ct=f}},mi=function(l,u,f){switch(u){case"input":if(an(l,f),u=f.name,f.type==="radio"&&u!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<f.length;u++){var _=f[u];if(_!==l&&_.form===l.form){var v=Wm(_);if(!v)throw Error(t(90));ae(_),an(_,v)}}}break;case"textarea":Go(l,f);break;case"select":u=f.value,u!=null&&Mn(l,!!f.multiple,u,!1)}},hr=p1,Gn=Ll;var H5={usingClientEntryPoint:!1,Events:[Od,pu,Wm,Or,ln,p1]},Yd={findFiberByHostInstance:Tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},K5={bundleType:Yd.bundleType,version:Yd.version,rendererPackageName:Yd.rendererPackageName,rendererConfig:Yd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Am(l),l===null?null:l.stateNode},findFiberByHostInstance:Yd.findFiberByHostInstance||$5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cp.isDisabled&&Cp.supportsFiber)try{pl=Cp.inject(K5),Bi=Cp}catch{}}return Mi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H5,Mi.createPortal=function(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T1(u))throw Error(t(200));return z5(l,u,null,f)},Mi.createRoot=function(l,u){if(!T1(l))throw Error(t(299));var f=!1,_="",v=mR;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onRecoverableError!==void 0&&(v=u.onRecoverableError)),u=x1(l,1,!1,null,null,f,!1,_,v),l[oo]=u.current,kd(l.nodeType===8?l.parentNode:l),new I1(u)},Mi.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=Am(u),l=l===null?null:l.stateNode,l},Mi.flushSync=function(l){return Ll(l)},Mi.hydrate=function(l,u,f){if(!Ap(u))throw Error(t(200));return Pp(null,l,u,!0,f)},Mi.hydrateRoot=function(l,u,f){if(!T1(l))throw Error(t(405));var _=f!=null&&f.hydratedSources||null,v=!1,x="",M=mR;if(f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onRecoverableError!==void 0&&(M=f.onRecoverableError)),u=fR(u,null,l,1,f??null,v,!1,x,M),l[oo]=u.current,kd(l),_)for(l=0;l<_.length;l++)f=_[l],v=f._getVersion,v=v(f._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[f,v]:u.mutableSourceEagerHydrationData.push(f,v);return new Rp(u)},Mi.render=function(l,u,f){if(!Ap(u))throw Error(t(200));return Pp(null,l,u,!1,f)},Mi.unmountComponentAtNode=function(l){if(!Ap(l))throw Error(t(40));return l._reactRootContainer?(Ll(function(){Pp(null,null,l,!1,function(){l._reactRootContainer=null,l[oo]=null})}),!0):!1},Mi.unstable_batchedUpdates=p1,Mi.unstable_renderSubtreeIntoContainer=function(l,u,f,_){if(!Ap(f))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return Pp(l,u,f,!1,_)},Mi.version="18.3.1-next-f1338f8080-20240426",Mi}var IR;function t6(){if(IR)return P1.exports;IR=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),P1.exports=e6(),P1.exports}var TR;function n6(){if(TR)return bp;TR=1;var n=t6();return bp.createRoot=n.createRoot,bp.hydrateRoot=n.hydrateRoot,bp}var i6=n6();const r6=Ix(i6);var oe=Vg();const s6=Ix(oe),Li={ADD:"add",REMOVE:"remove"},Rh={PROPERTYCHANGE:"propertychange"},Qe={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class K_{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function o6(n,e,t){let i,r;t=t||xo;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function xo(n,e){return n>e?1:n<e?-1:0}function a6(n,e){return n<e?1:n>e?-1:0}function q_(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function l6(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function Ms(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function al(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function c6(n,e,t){const i=e||xo;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Xf(){return!0}function Y_(){return!1}function Qf(){}function NM(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!al(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function OM(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Fg(n){for(const e in n)delete n[e]}function gc(n){let e;for(e in n)return!1;return!e}class Ws{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let jg=class extends K_{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ws(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let c;for(let h=0,d=r.length;h<d;++h)if("handleEvent"in r[h]?c=r[h].handleEvent(s):c=r[h].call(this,s),c===!1||s.propagationStopped){c=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,Qf);delete o[i]}return c}disposeInternal(){this.listeners_&&Fg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Qf,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}};function ft(n,e,t,i,r){if(r){const o=t;t=function(a){return n.removeEventListener(e,t),o.call(i??this,a)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function L0(n,e,t,i){return ft(n,e,t,i,!0)}function Dt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Fg(n))}class Gg extends jg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Qe.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ft(this,e[s],t);return r}return ft(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=L0(this,e[s],t)}else i=L0(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)u6(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Gg.prototype.on;Gg.prototype.once;Gg.prototype.un;function u6(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Dt(n[e]);else Dt(n)}function qe(){throw new Error("Unimplemented abstract method.")}let h6=0;function pt(n){return n.ol_uid||(n.ol_uid=String(++h6))}class RR extends Ws{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class Hs extends Gg{constructor(e){super(),this.on,this.once,this.un,pt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new RR(i,e,t)),i=Rh.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new RR(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],gc(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const AR={LENGTH:"length"};class Mp extends Ws{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Ar extends Hs{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(AR.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Mp(Li.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Mp(Li.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Mp(Li.REMOVE,r,e)),this.dispatchEvent(new Mp(Li.ADD,t,e))}updateLength_(){this.set(AR.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function St(n,e){if(!n)throw new Error(e)}let mc=class DM extends Hs{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new DM(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Dt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=ft(e,Qe.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?d6(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function d6(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(St(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const Dn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function PR(n){const e=ir();for(let t=0,i=n.length;t<i;++t)Pf(e,n[t]);return e}function Zf(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function VM(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Dc(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function pc(n,e){return Tx(n,e[0],e[1])}function Pa(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function Tx(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function BE(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let c=Dn.UNKNOWN;return o<t?c=c|Dn.LEFT:o>r&&(c=c|Dn.RIGHT),a<i?c=c|Dn.BELOW:a>s&&(c=c|Dn.ABOVE),c===Dn.UNKNOWN&&(c=Dn.INTERSECTING),c}function ir(){return[1/0,1/0,-1/0,-1/0]}function Ha(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Ug(n){return Ha(1/0,1/0,-1/0,-1/0,n)}function FM(n,e){const t=n[0],i=n[1];return Ha(t,i,t,i,e)}function Rx(n,e,t,i,r){const s=Ug(r);return GM(s,n,e,t,i)}function Ah(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function jM(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Pf(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function GM(n,e,t,i,r){for(;t<i;t+=r)f6(n,e[t],e[t+1]);return n}function f6(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function UM(n,e){let t;return t=e(X_(n)),t||(t=e(Q_(n)),t)||(t=e(Z_(n)),t)||(t=e(Vc(n)),t)?t:!1}function zE(n){let e=0;return Zh(n)||(e=ot(n)*vn(n)),e}function X_(n){return[n[0],n[1]]}function Q_(n){return[n[2],n[1]]}function js(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function g6(n,e){let t;if(e==="bottom-left")t=X_(n);else if(e==="bottom-right")t=Q_(n);else if(e==="top-left")t=Vc(n);else if(e==="top-right")t=Z_(n);else throw new Error("Invalid corner");return t}function N0(n,e,t,i,r){const[s,o,a,c,h,d,g,m]=BM(n,e,t,i);return Ha(Math.min(s,a,h,g),Math.min(o,c,d,m),Math.max(s,a,h,g),Math.max(o,c,d,m),r)}function BM(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),c=r*o,h=r*a,d=s*o,g=s*a,m=n[0],y=n[1];return[m-c+g,y-h-d,m-c-g,y-h+d,m+c-g,y+h+d,m+c+g,y+h-d,m-c+g,y-h-d]}function vn(n){return n[3]-n[1]}function So(n,e,t){const i=t||ir();return Ei(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Ug(i),i}function Vc(n){return[n[0],n[3]]}function Z_(n){return[n[2],n[3]]}function ot(n){return n[2]-n[0]}function Ei(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Zh(n){return n[2]<n[0]||n[3]<n[1]}function m6(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function p6(n,e,t){let i=!1;const r=BE(n,e),s=BE(n,t);if(r===Dn.INTERSECTING||s===Dn.INTERSECTING)i=!0;else{const o=n[0],a=n[1],c=n[2],h=n[3],d=e[0],g=e[1],m=t[0],y=t[1],w=(y-g)/(m-d);let I,E;s&Dn.ABOVE&&!(r&Dn.ABOVE)&&(I=m-(y-h)/w,i=I>=o&&I<=c),!i&&s&Dn.RIGHT&&!(r&Dn.RIGHT)&&(E=y-(m-c)*w,i=E>=a&&E<=h),!i&&s&Dn.BELOW&&!(r&Dn.BELOW)&&(I=m-(y-a)/w,i=I>=o&&I<=c),!i&&s&Dn.LEFT&&!(r&Dn.LEFT)&&(E=y-(m-o)*w,i=E>=a&&E<=h)}return i}function zM(n,e){const t=e.getExtent(),i=js(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ot(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function $M(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];zM(n,e);const r=ot(i);if(ot(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Bt(n,e,t){return Math.min(Math.max(n,e),t)}function _6(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const c=((n-t)*o+(e-i)*a)/(o*o+a*a);c>1?(t=r,i=s):c>0&&(t+=o*c,i+=a*c)}return lc(n,e,t,i)}function lc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function y6(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const c=Math.abs(n[a][i]);c>s&&(s=c,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const c=-n[a][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[a][h]=0:n[a][h]+=c*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function CR(n){return n*180/Math.PI}function Da(n){return n*Math.PI/180}function Va(n,e){const t=n%e;return t*e<0?t+e:t}function Zi(n,e,t){return n+t*(e-n)}function Bg(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function O0(n,e){return Math.round(Bg(n,e))}function kp(n,e){return Math.floor(Bg(n,e))}function Ca(n,e){return Math.ceil(Bg(n,e))}function $E(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function WM(n,e){const t=(""+n).split("."),i=(""+e).split(".");for(let r=0;r<Math.max(t.length,i.length);r++){const s=parseInt(t[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function v6(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function D0(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Ax(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function E6(n,e){return n[0]*=e,n[1]*=e,n}function HM(n,e){if(e.canWrapX()){const t=ot(e.getExtent()),i=KM(n,e,t);i&&(n[0]-=i*t)}return n}function KM(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ot(i),r=Math.floor((n[0]-i[0])/t)),r}function qM(...n){console.warn(...n)}const Ph={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let J_=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ph[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const zg=6378137,rh=Math.PI*zg,w6=[-rh,-rh,rh,rh],x6=[-180,-85,180,85],Lp=zg*Math.log(Math.tan(Math.PI/2));class Mu extends J_{constructor(e){super({code:e,units:"m",extent:w6,global:!0,worldExtent:x6,getPointResolution:function(t,i){return t/Math.cosh(i[1]/zg)}})}}const bR=[new Mu("EPSG:3857"),new Mu("EPSG:102100"),new Mu("EPSG:102113"),new Mu("EPSG:900913"),new Mu("http://www.opengis.net/def/crs/EPSG/0/3857"),new Mu("http://www.opengis.net/gml/srs/epsg.xml#3857")];function S6(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=rh*n[s]/180;let o=zg*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Lp?o=Lp:o<-Lp&&(o=-Lp),e[s+1]=o}return e}function I6(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/rh,e[s+1]=360*Math.atan(Math.exp(n[s+1]/zg))/Math.PI-90;return e}const T6=6378137,MR=[-180,-90,180,90],R6=Math.PI*T6/180;class Vl extends J_{constructor(e,t){super({code:e,units:"degrees",extent:MR,axisOrientation:t,global:!0,metersPerUnit:R6,worldExtent:MR})}}const kR=[new Vl("CRS:84"),new Vl("EPSG:4326","neu"),new Vl("urn:ogc:def:crs:OGC:1.3:CRS84"),new Vl("urn:ogc:def:crs:OGC:2:84"),new Vl("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Vl("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Vl("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let WE={};function a0(n){return WE[n]||WE[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function A6(n,e){WE[n]=e}let mh={};function _c(n,e,t){const i=n.getCode(),r=e.getCode();i in mh||(mh[i]={}),mh[i][r]=t}function l0(n,e){return n in mh&&e in mh[n]?mh[n][e]:null}const V0=.9996,Mr=.00669438,ey=Mr*Mr,ty=ey*Mr,tc=Mr/(1-Mr),LR=Math.sqrt(1-Mr),Ch=(1-LR)/(1+LR),YM=Ch*Ch,Px=YM*Ch,Cx=Px*Ch,XM=Cx*Ch,QM=1-Mr/4-3*ey/64-5*ty/256,P6=3*Mr/8+3*ey/32+45*ty/1024,C6=15*ey/256+45*ty/1024,b6=35*ty/3072,M6=3/2*Ch-27/32*Px+269/512*XM,k6=21/16*YM-55/32*Cx,L6=151/96*Px-417/128*XM,N6=1097/512*Cx,F0=6378137;function O6(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/V0/(F0*QM),a=o+M6*Math.sin(2*o)+k6*Math.sin(4*o)+L6*Math.sin(6*o)+N6*Math.sin(8*o),c=Math.sin(a),h=c*c,d=Math.cos(a),g=c/d,m=g*g,y=m*m,w=1-Mr*h,I=Math.sqrt(1-Mr*h),E=F0/I,A=(1-Mr)/w,b=tc*d**2,N=b*b,D=i/(E*V0),O=D*D,$=O*D,k=$*D,C=k*D,L=C*D,j=a-g/A*(O/2-k/24*(5+3*m+10*b-4*N-9*tc))+L/720*(61+90*m+298*b+45*y-252*tc-3*N);let G=(D-$/6*(1+2*m+b)+C/120*(5-2*b+28*m-3*N+8*tc+24*y))/d;return G=$E(G+Da(ZM(t.number)),-Math.PI,Math.PI),[CR(G),CR(j)]}const NR=-80,OR=84,D6=-180,V6=180;function F6(n,e,t){n=$E(n,D6,V6),e<NR?e=NR:e>OR&&(e=OR);const i=Da(e),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,c=a*a,h=Da(n),d=ZM(t.number),g=Da(d),m=F0/Math.sqrt(1-Mr*r**2),y=tc*s**2,w=s*$E(h-g,-Math.PI,Math.PI),I=w*w,E=I*w,A=E*w,b=A*w,N=b*w,D=F0*(QM*i-P6*Math.sin(2*i)+C6*Math.sin(4*i)-b6*Math.sin(6*i)),O=V0*m*(w+E/6*(1-a+y)+b/120*(5-18*a+c+72*y-58*tc))+5e5;let $=V0*(D+m*o*(I/2+A/24*(5-a+9*y+4*y**2)+N/720*(61-58*a+c+600*y-330*tc)));return t.north||($+=1e7),[O,$]}function ZM(n){return(n-1)*6-180+3}const j6=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function JM(n){let e=0;for(const r of j6){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function DR(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let a=0;a<o;a+=s){const c=t[a],h=t[a+1],d=n(c,h,e);i[a]=d[0],i[a+1]=d[1]}return i}}function G6(n){return JM(n)?new J_({code:n,units:"m"}):null}function U6(n){const e=JM(n.getCode());return e?{forward:DR(F6,e),inverse:DR(O6,e)}:null}const B6=63710088e-1;function VR(n,e,t){t=t||B6;const i=Da(n[1]),r=Da(e[1]),s=(r-i)/2,o=Da(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const z6=[U6],$6=[G6];let HE=!0;function ek(n){HE=!1}function bx(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function j0(n){A6(n.getCode(),n),_c(n,n,bx)}function W6(n){n.forEach(j0)}function Vt(n){if(typeof n!="string")return n;const e=a0(n);if(e)return e;for(const t of $6){const i=t(n);if(i)return i}return null}function G0(n,e,t,i){n=Vt(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/Ph[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=kx(n,Vt("EPSG:4326"));if(!a&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=a(h,h,2);const d=VR(h.slice(0,2),h.slice(2,4)),g=VR(h.slice(4,6),h.slice(6,8));r=(d+g)/2}const c=i?Ph[i]:n.getMetersPerUnit();c!==void 0&&(r/=c)}}return r}function KE(n){W6(n),n.forEach(function(e){n.forEach(function(t){e!==t&&_c(e,t,bx)})})}function H6(n,e,t,i){n.forEach(function(r){e.forEach(function(s){_c(r,s,t),_c(s,r,i)})})}function Mx(n,e){return n?typeof n=="string"?Vt(n):n:Vt(e)}function qE(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const a=n(e.slice(o,o+i)),c=a.length;for(let h=0,d=r;h<d;++h)t[o+h]=h>=c?e[o+h]:a[h]}return t})}function K6(n,e,t,i){const r=Vt(n),s=Vt(e);_c(r,s,qE(t)),_c(s,r,qE(i))}function Ka(n,e){return ek(),$g(n,"EPSG:4326","EPSG:3857")}function Lt(n,e){const t=$g(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=Va(i+180,360)-180),t}function cc(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||kx(n,e)===bx)&&t}function kx(n,e){const t=n.getCode(),i=e.getCode();let r=l0(t,i);if(r)return r;let s=null,o=null;for(const c of z6)s||(s=c(n)),o||(o=c(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=M1(s.inverse,o.forward);else{const c=l0(t,a);c&&(r=M1(c,o.forward))}else{const c=l0(a,i);c&&(r=M1(s.inverse,c))}return r&&(j0(n),j0(e),_c(n,e,r)),r}function M1(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Jf(n,e){const t=Vt(n),i=Vt(e);return kx(t,i)}function $g(n,e,t){const i=Jf(e,t);if(!i){const r=Vt(e).getCode(),s=Vt(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function YE(n,e){return n}function _o(n,e){return HE&&!D0(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(HE=!1,qM("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function tk(n,e){return n}function As(n,e){return n}function FR(n,e,t){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),a=ot(o);i=i.slice(0),s=KM(i,n,a),s&&(i[0]=i[0]-s*a),i[0]=Bt(i[0],o[0],o[2]),i[1]=Bt(i[1],o[1],o[3]),r=t(i)}else r=t(i);return s&&e.canWrapX()&&(r[0]+=s*ot(e.getExtent())),r}}function q6(){KE(bR),KE(kR),H6(kR,bR,S6,I6)}q6();new Array(6);function Zr(){return[1,0,0,1,0,0]}function Y6(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Rn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Gs(n,e,t,i,r,s,o,a){const c=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*c,n[2]=-i*c,n[3]=r*h,n[4]=o*i*h-a*i*c+e,n[5]=o*r*c+a*r*h+t,n}function nk(n,e){const t=X6(e);St(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*c-o*a)/t,n[5]=-(i*c-r*a)/t,n}function X6(n){return n[0]*n[3]-n[1]*n[2]}const Q6=[1e5,1e5,1e5,1e5,2,2];function Z6(n){return"matrix("+n.join(", ")+")"}function XE(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function J6(n,e){const t=XE(n),i=XE(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*Q6[r])!==0)return!1;return!0}function Fa(n,e,t,i,r,s,o){s=s||[],o=o||2;let a=0;for(let c=e;c<t;c+=i){const h=n[c],d=n[c+1];s[a++]=r[0]*h+r[2]*d+r[4],s[a++]=r[1]*h+r[3]*d+r[5];for(let g=2;g<o;g++)s[a++]=n[c+g]}return s&&s.length!=a&&(s.length=a),s}function ik(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),c=Math.sin(r),h=s[0],d=s[1];let g=0;for(let m=e;m<t;m+=i){const y=n[m]-h,w=n[m+1]-d;o[g++]=h+y*a-w*c,o[g++]=d+y*c+w*a;for(let I=m+2;I<m+i;++I)o[g++]=n[I]}return o&&o.length!=g&&(o.length=g),o}function e8(n,e,t,i,r,s,o,a){a=a||[];const c=o[0],h=o[1];let d=0;for(let g=e;g<t;g+=i){const m=n[g]-c,y=n[g+1]-h;a[d++]=c+r*m,a[d++]=h+s*y;for(let w=g+2;w<g+i;++w)a[d++]=n[w]}return a&&a.length!=d&&(a.length=d),a}function t8(n,e,t,i,r,s,o){o=o||[];let a=0;for(let c=e;c<t;c+=i){o[a++]=n[c]+r,o[a++]=n[c+1]+s;for(let h=c+2;h<c+i;++h)o[a++]=n[h]}return o&&o.length!=a&&(o.length=a),o}const jR=Zr(),n8=[NaN,NaN];class rk extends Hs{constructor(){super(),this.extent_=ir(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=NM((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return qe()}closestPointXY(e,t,i,r){return qe()}containsXY(e,t){return this.closestPointXY(e,t,n8,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return qe()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Ug(t),this.extentRevision_=this.getRevision()}return m6(this.extent_,e)}rotate(e,t){qe()}scale(e,t,i){qe()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return qe()}getType(){return qe()}applyTransform(e){qe()}intersectsExtent(e){return qe()}translate(e,t){qe()}transform(e,t){const i=Vt(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const c=i.getExtent(),h=i.getWorldExtent(),d=vn(h)/vn(c);Gs(jR,h[0],h[3],d,-d,0,0,0);const g=Fa(s,0,s.length,a,jR,o),m=Jf(i,t);return m?m(g,g,a):g}:Jf(i,t);return this.applyTransform(r),this}}class Fc extends rk{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Rx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return qe()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=GR(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){qe()}setLayout(e,t,i){let r;if(e)r=GR(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=jc(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();ik(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=js(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();e8(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();t8(i,0,i.length,r,e,t,i),this.changed()}}}function jc(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function GR(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function i8(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Fa(i,0,i.length,r,e,t)}function UR(n,e,t,i,r,s,o){const a=n[e],c=n[e+1],h=n[t]-a,d=n[t+1]-c;let g;if(h===0&&d===0)g=e;else{const m=((r-a)*h+(s-c)*d)/(h*h+d*d);if(m>1)g=t;else if(m>0){for(let y=0;y<i;++y)o[y]=Zi(n[e+y],n[t+y],m);o.length=i;return}else g=e}for(let m=0;m<i;++m)o[m]=n[g+m];o.length=i}function Lx(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],c=n[e+1],h=lc(s,o,a,c);h>r&&(r=h),s=a,o=c}return r}function Nx(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=Lx(n,e,a,i,r),e=a}return r}function r8(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=Nx(n,e,a,i,r),e=a[a.length-1]}return r}function Ox(n,e,t,i,r,s,o,a,c,h,d){if(e==t)return h;let g,m;if(r===0){if(m=lc(o,a,n[e],n[e+1]),m<h){for(g=0;g<i;++g)c[g]=n[e+g];return c.length=i,m}return h}d=d||[NaN,NaN];let y=e+i;for(;y<t;)if(UR(n,y-i,y,i,o,a,d),m=lc(o,a,d[0],d[1]),m<h){for(h=m,g=0;g<i;++g)c[g]=d[g];c.length=i,y+=i}else y+=i*Math.max((Math.sqrt(m)-Math.sqrt(h))/r|0,1);if(s&&(UR(n,t-i,e,i,o,a,d),m=lc(o,a,d[0],d[1]),m<h)){for(h=m,g=0;g<i;++g)c[g]=d[g];c.length=i}return h}function Dx(n,e,t,i,r,s,o,a,c,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];h=Ox(n,e,y,i,r,s,o,a,c,h,d),e=y}return h}function s8(n,e,t,i,r,s,o,a,c,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];h=Dx(n,e,y,i,r,s,o,a,c,h,d),e=y[y.length-1]}return h}function o8(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function ny(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function Wg(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=ny(n,e,t[o],i);r[s++]=c,e=c}return r.length=s,r}function sk(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=Wg(n,e,t[o],i,r[s]);c.length===0&&(c[0]=e),r[s++]=c,e=c[c.length-1]}return r.length=s,r}function ba(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function eg(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o];r[s++]=ba(n,e,c,i,r[s]),e=c}return r.length=s,r}function QE(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o];r[s++]=c.length===1&&c[0]===e?[]:eg(n,e,c,i,r[s]),e=c[c.length-1]}return r.length=s,r}function U0(n,e,t,i,r,s,o){let a,c;const h=(t-e)/i;if(h===1)a=e;else if(h===2)a=e,c=r;else if(h!==0){let d=n[e],g=n[e+1],m=0;const y=[0];for(let E=e+i;E<t;E+=i){const A=n[E],b=n[E+1];m+=Math.sqrt((A-d)*(A-d)+(b-g)*(b-g)),y.push(m),d=A,g=b}const w=r*m,I=o6(y,w);I<0?(c=(w-y[-I-2])/(y[-I-1]-y[-I-2]),a=e+(-I-2)*i):a=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let d=0;d<o;++d)s[d]=a===void 0?NaN:c===void 0?n[a+d]:Zi(n[a+d],n[a+i+d],c);return s}function ZE(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,c=t/i;for(;a<c;){const m=a+c>>1;r<n[(m+1)*i-1]?c=m:a=m+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const d=n[(a+1)*i-1],g=(r-h)/(d-h);o=[];for(let m=0;m<i-1;++m)o.push(Zi(n[(a-1)*i+m],n[a*i+m],g));return o.push(r),o}function a8(n,e,t,i,r,s,o){if(o)return ZE(n,e,t[t.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let c=0,h=t.length;c<h;++c){const d=t[c];if(e!=d){if(r<n[e+i-1])return null;if(r<=n[d-1])return ZE(n,e,d,i,r,!1);e=d}}return null}function l8(n,e,t,i,r){return!UM(r,function(o){return!nc(n,e,t,i,o[0],o[1])})}function nc(n,e,t,i,r,s){let o=0,a=n[t-i],c=n[t-i+1];for(;e<t;e+=i){const h=n[e],d=n[e+1];c<=s?d>s&&(h-a)*(s-c)-(r-a)*(d-c)>0&&o++:d<=s&&(h-a)*(s-c)-(r-a)*(d-c)<0&&o--,a=h,c=d}return o!==0}function Vx(n,e,t,i,r,s){if(t.length===0||!nc(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(nc(n,t[o-1],t[o],i,r,s))return!1;return!0}function c8(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const c=t[o];if(Vx(n,e,c,i,r,s))return!0;e=c[c.length-1]}return!1}function ok(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function iy(n,e,t,i,r,s){return s=s??GM(ir(),n,e,t,i),Ei(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:ok(n,e,t,i,function(o,a){return p6(r,o,a)}):!1}function u8(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(iy(n,e,t[s],i,r))return!0;e=t[s]}return!1}function ak(n,e,t,i,r){return!!(iy(n,e,t,i,r)||nc(n,e,t,i,r[0],r[1])||nc(n,e,t,i,r[0],r[3])||nc(n,e,t,i,r[2],r[1])||nc(n,e,t,i,r[2],r[3]))}function lk(n,e,t,i,r){if(!ak(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(l8(n,t[s-1],t[s],i,r)&&!iy(n,t[s-1],t[s],i,r))return!1;return!0}function h8(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(lk(n,e,a,i,r))return!0;e=a[a.length-1]}return!1}function Fx(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const c=n[a],h=n[a+1];o+=Math.sqrt((c-r)*(c-r)+(h-s)*(h-s)),r=c,s=h}return o}function ry(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const c=new Array(a);c[0]=1,c[a-1]=1;const h=[e,t-i];let d=0;for(;h.length>0;){const g=h.pop(),m=h.pop();let y=0;const w=n[m],I=n[m+1],E=n[g],A=n[g+1];for(let b=m+i;b<g;b+=i){const N=n[b],D=n[b+1],O=_6(N,D,w,I,E,A);O>y&&(d=b,y=O)}y>r&&(c[(d-e)/i]=1,m+i<d&&h.push(m,d),d+i<g&&h.push(d,g))}for(let g=0;g<a;++g)c[g]&&(s[o++]=n[e+g*i],s[o++]=n[e+g*i+1]);return o}function ck(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c];o=ry(n,e,d,i,r,s,o),a.push(o),e=d}return o}function Ul(n,e){return e*Math.round(n/e)}function d8(n,e,t,i,r,s,o){if(e==t)return o;let a=Ul(n[e],r),c=Ul(n[e+1],r);e+=i,s[o++]=a,s[o++]=c;let h,d;do if(h=Ul(n[e],r),d=Ul(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=d,o;while(h==a&&d==c);for(;e<t;){const g=Ul(n[e],r),m=Ul(n[e+1],r);if(e+=i,g==h&&m==d)continue;const y=h-a,w=d-c,I=g-a,E=m-c;if(y*E==w*I&&(y<0&&I<y||y==I||y>0&&I>y)&&(w<0&&E<w||w==E||w>0&&E>w)){h=g,d=m;continue}s[o++]=h,s[o++]=d,a=h,c=d,h=g,d=m}return s[o++]=h,s[o++]=d,o}function jx(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c];o=d8(n,e,d,i,r,s,o),a.push(o),e=d}return o}function f8(n,e,t,i,r,s,o,a){for(let c=0,h=t.length;c<h;++c){const d=t[c],g=[];o=jx(n,e,d,i,r,s,o,g),a.push(g),e=d[d.length-1]}return o}class yc extends Fc{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Ms(this.flatCoordinates,e),this.changed()}clone(){const e=new yc(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Dc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Lx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ox(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return ok(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,ZE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return ba(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return U0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return Fx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=ry(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new yc(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return iy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ny(this.flatCoordinates,0,e,this.stride),this.changed()}}let qa=class uk extends Fc{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new uk(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=lc(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let c=0;c<a;++c)i[c]=s[c];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return FM(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Tx(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=o8(this.flatCoordinates,0,e,this.stride),this.changed()}};const Pr={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},vc=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",g8=vc.includes("safari")&&!vc.includes("chrom");g8&&(vc.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(vc));const m8=vc.includes("webkit")&&!vc.includes("edge"),hk=vc.includes("macintosh"),p8=typeof devicePixelRatio<"u"?devicePixelRatio:1,er=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Gx=typeof Image<"u"&&Image.prototype.decode,dk=typeof createImageBitmap=="function",fk=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ve={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Pn(n,e,t,i){let r;return t&&t.length?r=t.shift():er?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let k1;function B0(){return k1||(k1=Pn(1,1)),k1}function sy(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function BR(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function _8(n){for(;n.lastChild;)n.lastChild.remove()}function y8(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function gk(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Ma(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const Ux=[NaN,NaN,NaN,0];let L1;function v8(){return L1||(L1=Pn(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),L1}const E8=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,w8=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,x8=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,S8=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Np(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Cf(n){throw new Error('failed to parse "'+n+'" as color')}function mk(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(w8)||n.match(E8)||n.match(x8);if(s){const o=s[4],a=100/255;return[Bt(Np(s[1],a)+.5|0,0,255),Bt(Np(s[2],a)+.5|0,0,255),Bt(Np(s[3],a)+.5|0,0,255),o!==void 0?Bt(Np(o,100),0,1):1]}Cf(n)}if(n.startsWith("#")){if(S8.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let c=0,h=s.length;c<h;c+=o){let d=parseInt(s.substring(c,c+o),16);o===1&&(d+=d<<4),a[c/o]=d}return a[3]=a[3]/255,a}Cf(n)}const e=v8();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Cf(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return mk(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=Bg(r[3]/255,3),r}function I8(n){return typeof n=="string"?n:zx(n)}const T8=1024,Qd={};let N1=0;function R8(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function O1(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function D1(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function V1(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function F1(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function zR(n){const e=V1(n[0]),t=V1(n[1]),i=V1(n[2]),r=F1(e*.222488403+t*.716873169+i*.06060791),s=500*(F1(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-F1(e*.016863605+t*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function A8(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=D1(e),s=D1(e+t/500*Math.cos(i)),o=D1(e-t/200*Math.sin(i)),a=O1(s*3.021973625-r*1.617392459-o*.404875592),c=O1(s*-.943766287+r*1.916279586+o*.027607165),h=O1(s*.069407491-r*.22898585+o*1.159737864);return[Bt(a+.5|0,0,255),Bt(c+.5|0,0,255),Bt(h+.5|0,0,255),n[3]]}function Bx(n){if(n==="none")return Ux;if(Qd.hasOwnProperty(n))return Qd[n];if(N1>=T8){let t=0;for(const i in Qd)(t++&3)===0&&(delete Qd[i],--N1)}const e=mk(n);e.length!==4&&Cf(n);for(const t of e)isNaN(t)&&Cf(n);return Qd[n]=e,++N1,e}function bh(n){return Array.isArray(n)?n:Bx(n)}function zx(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class pk extends jg{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?Ve.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(Qe.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Ve.IDLE&&this.loader){this.state=Ve.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;OM(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||dk&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=Ve.LOADED}).catch(i=>{this.state=Ve.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function P8(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[L0(i,Qe.LOAD,function(){o=!0,s||e()})];return i.src&&Gx?(s=!0,i.decode().then(function(){r&&e()}).catch(function(c){r&&(o?e():t())})):a.push(L0(i,Qe.ERROR,t)),function(){r=!1,a.forEach(Dt)}}function C8(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function _k(n,e){return e&&(n.src=e),n.src&&Gx?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):C8(n)}function yk(n,e){return e&&(n.src=e),n.src&&Gx&&dk?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):_k(n)}class b8{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=j1(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=j1(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=j1(e,t,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ve.IDLE&&r.load(),r.getImageState()===Ve.LOADING?r.ready().then(()=>{this.patternCache_[o]=B0().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=B0().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function j1(n,e,t){const i=t?bh(t):"null";return e+":"+n+":"+i}const Cr=new b8;let Zd=null;class vk extends jg{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ve.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ve.LOADED){Zd||(Zd=Pn(1,1,void 0,{willReadFrequently:!0})),Zd.drawImage(this.image_,0,0);try{Zd.getImageData(0,0,1,1),this.tainted_=!1}catch{Zd=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Qe.CHANGE)}handleImageError_(){this.imageState_=Ve.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ve.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Pn(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ve.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ve.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&_k(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ve.LOADED)return;const t=this.image_,i=Pn(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=I8(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ve.LOADED||this.imageState_===Ve.ERROR)e();else{const t=()=>{(this.imageState_===Ve.LOADED||this.imageState_===Ve.ERROR)&&(this.removeEventListener(Qe.CHANGE,t),e())};this.addEventListener(Qe.CHANGE,t)}})),this.ready_}}function z0(n,e,t,i,r,s){let o=e===void 0?void 0:Cr.get(e,t,r);return o||(o=new vk(n,n&&"src"in n?n.src||void 0:e,t,i,r),Cr.set(e,t,r,o,s)),s&&o&&!Cr.getPattern(e,t,r)&&Cr.set(e,t,r,o,s),o}function Ps(n){return n?Array.isArray(n)?zx(n):typeof n=="object"&&"src"in n?M8(n):n:null}function M8(n){if(!n.offset||!n.size)return Cr.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Cr.getPattern(e,void 0,n.color);if(t)return t;const i=Cr.get(n.src,"anonymous",null);if(i.getImageState()!==Ve.LOADED)return null;const r=Pn(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),z0(r.canvas,e,void 0,Ve.LOADED,n.color,!0),Cr.getPattern(e,void 0,n.color)}class Ek{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Op="ol-hidden",Hg="ol-unselectable",$x="ol-control",$R="ol-collapsed",k8=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),WR=["style","variant","weight","size","lineHeight","family"],JE={normal:400,bold:700},ew=function(n){const e=n.match(k8);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=WR.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[WR[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in JE&&(t.weight=JE[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},wk="10px sans-serif",Ni="#000",Mh="round",Io=[],To=0,kh="round",tg=10,ng="#000",ig="center",$0="middle",ic=[0,0,0,0],rg=1,Hu=new Hs;let Jd=null,HR;const tw={},L8=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function N8(n,e,t){return`${n} ${e} 16px "${t}"`}const O8=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const a=ew(s),c=a.families[0].toLowerCase(),h=a.weight;return o.some(d=>{const g=d.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=JE[d.weight]||d.weight;return g===c&&d.style===a.style&&m==h})}async function r(){await t.ready;let s=!0;const o=Hu.getProperties(),a=Object.keys(o).filter(c=>o[c]<100);for(let c=a.length-1;c>=0;--c){const h=a[c];let d=o[h];d<100&&(await i(h)?(Fg(tw),Hu.set(h,100)):(d+=10,Hu.set(h,d,!0),d<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=er?self.fonts:document.fonts);const o=ew(s);if(!o)return;const a=o.families;let c=!1;for(const h of a){if(L8.has(h))continue;const d=N8(o.style,o.weight,h);Hu.get(d)===void 0&&(Hu.set(d,0,!0),c=!0)}c&&(clearTimeout(e),e=setTimeout(r,100))}})(),D8=(function(){let n;return function(e){let t=tw[e];if(t==null){if(er){const i=ew(e),r=xk(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);tw[e]=t}return t}})();function xk(n,e){return Jd||(Jd=Pn(1,1)),n!=HR&&(Jd.font=n,HR=Jd.font),Jd.measureText(e)}function Sk(n,e){return xk(n,e).width}function KR(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Sk(n,s)),0);return t[e]=i,i}function V8(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,c=0;for(let h=0,d=e.length;h<=d;h+=2){const g=e[h];if(g===`
`||h===d){s=Math.max(s,o),r.push(o),o=0,a+=c,c=0;continue}const m=e[h+1]||n.font,y=Sk(m,g);t.push(y),o+=y;const w=D8(m);i.push(w),c=Math.max(c,w)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function F8(n,e,t,i,r,s,o,a,c,h,d){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(c,h),n.scale(d[0],d[1]),j8(i,n)):d[0]<0||d[1]<0?(n.translate(c,h),n.scale(d[0],d[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,c,h,o*d[0],a*d[1]),n.restore()}function j8(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class G8 extends Ek{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Bg(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Zr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Fa(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,c=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=c*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let d=0,g=s.length;d<g;d+=2){const m=s[d]-this.imageAnchorX_,y=s[d+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const w=m+this.imageAnchorX_,I=y+this.imageAnchorY_;Gs(a,w,I,1,1,h,-w,-I),o.save(),o.transform.apply(o,a),o.translate(w,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=c)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Fa(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const c=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(c-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,c,h),this.textFillState_&&o.fillText(this.text_,c,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=Fa(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let c=a.length;s&&(c-=2);for(let h=2;h<c;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ei(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=i8(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ei(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Ei(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let c=0,h=o.length;c<h;++c)s=this.moveToLineTo_(r,s,o[c],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ei(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ei(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,c=s.length;a<c;++a){const h=s[a];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),al(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:ig;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Ps(i||Ni)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),c=t.getWidth(),h=t.getMiterLimit(),d=s||Io;this.strokeState_={lineCap:r!==void 0?r:Mh,lineDash:this.pixelRatio_===1?d:d.map(g=>g*this.pixelRatio_),lineDashOffset:(o||To)*this.pixelRatio_,lineJoin:a!==void 0?a:kh,lineWidth:(c!==void 0?c:rg)*this.pixelRatio_,miterLimit:h!==void 0?h:tg,strokeStyle:Ps(i||ng)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Ps(y||Ni)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const y=i.getColor(),w=i.getLineCap(),I=i.getLineDash(),E=i.getLineDashOffset(),A=i.getLineJoin(),b=i.getWidth(),N=i.getMiterLimit();this.textStrokeState_={lineCap:w!==void 0?w:Mh,lineDash:I||Io,lineDashOffset:E||To,lineJoin:A!==void 0?A:kh,lineWidth:b!==void 0?b:rg,miterLimit:N!==void 0?N:tg,strokeStyle:Ps(y||ng)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),c=e.getRotation(),h=e.getScaleArray(),d=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:r!==void 0?r:wk,textAlign:g!==void 0?g:ig,textBaseline:m!==void 0?m:$0},this.text_=d!==void 0?Array.isArray(d)?d.reduce((y,w,I)=>y+=I%2?" ":w,""):d:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=c!==void 0?c:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const U8=.5,Ik={Point:Y8,LineString:H8,Polygon:Q8,MultiPoint:X8,MultiLineString:K8,MultiPolygon:q8,GeometryCollection:W8,Circle:z8};function B8(n,e){return parseInt(pt(n),10)-parseInt(pt(e),10)}function qR(n,e){const t=Tk(n,e);return t*t}function Tk(n,e){return U8*n/e}function z8(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Circle");c.setFillStrokeStyle(s,o),c.drawCircle(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i)}}function YR(n,e,t,i,r,s,o,a){const c=[],h=t.getImage();if(h){let m=!0;const y=h.getImageState();y==Ve.LOADED||y==Ve.ERROR?m=!1:y==Ve.IDLE&&h.load(),m&&c.push(h.ready())}const d=t.getFill();d&&d.loading()&&c.push(d.ready());const g=c.length>0;return g&&Promise.all(c).then(()=>r(null)),$8(n,e,t,i,s,o,a),g}function $8(n,e,t,i,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const c=a.simplifyTransformed(i,r);if(t.getRenderer())Rk(n,c,t,e,o);else{const d=Ik[c.getType()];d(n,c,t,e,o,s)}}function Rk(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,c=o.length;a<c;++a)Rk(n,o[a],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function W8(n,e,t,i,r,s){const o=e.getGeometriesArray();let a,c;for(a=0,c=o.length;a<c;++a){const h=Ik[o[a].getType()];h(n,o[a],t,i,r,s)}}function H8(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function K8(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function q8(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawMultiPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i,r)}}function Y8(n,e,t,i,r,s){const o=t.getImage(),a=t.getText(),c=a&&a.getText(),h=s&&o&&c?{}:void 0;if(o){if(o.getImageState()!=Ve.LOADED)return;const d=n.getBuilder(t.getZIndex(),"Image");d.setImageStyle(o,h),d.drawPoint(e,i,r)}if(c){const d=n.getBuilder(t.getZIndex(),"Text");d.setTextStyle(a,h),d.drawText(e,i,r)}}function X8(n,e,t,i,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,c=t.getText(),h=c&&c.getText(),d=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=Ve.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(o,d),g.drawMultiPoint(e,i,r)}if(h){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(c,d),g.drawText(e,i,r)}}function Q8(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a),c.drawText(e,i,r)}}let Z8=!1;function J8(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=Z8,a.onload=function(c){if(!a.status||a.status>=200&&a.status<300){const h=e.getType();try{let d;h=="text"||h=="json"?d=a.responseText:h=="xml"?d=a.responseXML||a.responseText:h=="arraybuffer"&&(d=a.response),d?s(e.readFeatures(d,{extent:t,featureProjection:r}),e.readProjection(d)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function XR(n,e){return function(t,i,r,s,o){J8(n,e,t,i,r,(a,c)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function eV(n,e){return[[-1/0,-1/0,1/0,1/0]]}function Ak(n,e,t,i){const r=[];let s=ir();for(let o=0,a=t.length;o<a;++o){const c=t[o];s=Rx(n,e,c[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=c[c.length-1]}return r}function Wx(n,e,t,i,r,s,o){let a,c,h,d,g,m,y;const w=r[s+1],I=[];for(let b=0,N=t.length;b<N;++b){const D=t[b];for(d=n[D-i],m=n[D-i+1],a=e;a<D;a+=i)g=n[a],y=n[a+1],(w<=m&&y<=w||m<=w&&w<=y)&&(h=(w-m)/(y-m)*(g-d)+d,I.push(h)),d=g,m=y}let E=NaN,A=-1/0;for(I.sort(xo),d=I[0],a=1,c=I.length;a<c;++a){g=I[a];const b=Math.abs(g-d);b>A&&(h=(d+g)/2,Vx(n,e,t,i,h,w)&&(E=h,A=b)),d=g}return isNaN(E)&&(E=r[s]),o?(o.push(E,w,A),o):[E,w,A]}function Pk(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const c=t[o];s=Wx(n,e,c,i,r,2*o,s),e=c[c.length-1]}return s}function tV(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function Hx(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],c=n[e+1];r+=(a-s)*(c+o),s=a,o=c}return r===0?void 0:r>0}function Kx(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],c=Hx(n,e,a,i);if(s===0){if(r&&c||!r&&!c)return!1}else if(r&&!c||!r&&c)return!1;e=a}return!0}function Ck(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!Kx(n,e,a,i,r))return!1;a.length&&(e=a[a.length-1])}return!0}function W0(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],c=Hx(n,e,a,i);(s===0?r&&c||!r&&!c:r&&!c||!r&&c)&&tV(n,e,a,i),e=a}return e}function nw(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=W0(n,e,t[s],i,r);return e}function nV(n,e){const t=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const c=e[o],h=Hx(n,i,c,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=c}return t}class H0 extends rk{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Dt),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,i=e.length;t<i;++t)this.changeEventsKeys_.push(ft(e[t],Qe.CHANGE,this.changed,this))}clone(){const e=new H0(G1(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Dc(this.getExtent(),e,t))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(e,t,i,r);return r}containsXY(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(e,t))return!0;return!1}computeExtent(e){Ug(e);const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)jM(e,t[i].getExtent());return e}getGeometries(){return G1(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].getType()===this.getType()?e=e.concat(t[i].getGeometriesArrayRecursive()):e.push(t[i]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],c=a.getSimplifiedGeometry(e);t.push(c),c!==a&&(r=!0)}return r?new H0(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)if(t[i].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(e,t);this.changed()}scale(e,t,i){i||(i=js(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(e,t,i);this.changed()}setGeometries(e){this.setGeometriesArray(G1(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].applyTransform(e);this.changed()}translate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function G1(n){return n.map(e=>e.clone())}function bk(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let a=0,c=0;for(;e<t;e+=i){const h=n[e]-s,d=n[e+1]-o;r+=c*h-a*d,a=h,c=d}return r/2}function Mk(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=bk(n,e,a,i),e=a}return r}function iV(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Mk(n,e,a,i),e=a[a.length-1]}return r}class sg extends Fc{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new sg(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Dc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Lx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ox(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return bk(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return ba(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=ry(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new sg(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ny(this.flatCoordinates,0,e,this.stride),this.changed()}}class K0 extends Fc{constructor(e,t,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&i)this.setFlatCoordinates(t,e),this.ends_=i;else{const r=e,s=[],o=[];for(let c=0,h=r.length;c<h;++c){const d=r[c];Ms(s,d.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(e){Ms(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new K0(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Dc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Nx(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Dx(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,i,r))}getCoordinateAtM(e,t,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,i=i!==void 0?i:!1,a8(this.flatCoordinates,0,this.ends_,this.stride,e,t,i))}getCoordinates(){return eg(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new yc(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=t.length;o<a;++o){const c=t[o],h=new yc(e.slice(s,c),i);r.push(h),s=c}return r}getLength(){const e=this.ends_;let t=0,i=0;for(let r=0,s=e.length;r<s;++r)i+=Fx(this.flatCoordinates,t,e[r],this.stride),t=e[r];return i}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const c=r[o],h=U0(t,i,c,s,.5);Ms(e,h),i=c}return e}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=ck(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,i),new K0(t,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(e){return u8(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Wg(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class oy extends Fc{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Ms(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new oy(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Dc(this.getExtent(),e,t))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,c=s.length;a<c;a+=o){const h=lc(e,t,s[a],s[a+1]);if(h<r){r=h;for(let d=0;d<o;++d)i[d]=s[a+d];i.length=o}}return r}getCoordinates(){return ba(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new qa(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,i=this.stride,r=[];for(let s=0,o=e.length;s<o;s+=i){const a=new qa(e.slice(s,s+i),t);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,i=this.stride;for(let r=0,s=t.length;r<s;r+=i){const o=t[r],a=t[r+1];if(Tx(e,o,a))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ny(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ya extends Fc{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Ms(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ya(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Dc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Nx(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Dx(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return Vx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Mk(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),W0(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,eg(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=js(this.getExtent());this.flatInteriorPoint_=Wx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new qa(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new sg(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const c=i[o],h=new sg(t.slice(s,c),e);r.push(h),s=c}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Kx(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=W0(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=jx(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Ya(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return lk(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Wg(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function QR(n){if(Zh(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Ya(s,"XY",[s.length])}class q0 extends Fc{constructor(e,t,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){const r=e,s=[],o=[];for(let a=0,c=r.length;a<c;++a){const h=r[a],d=s.length,g=h.getEnds();for(let m=0,y=g.length;m<y;++m)g[m]+=d;Ms(s,h.getFlatCoordinates()),o.push(g)}t=r.length===0?this.getLayout():r[0].getLayout(),e=s,i=o}t!==void 0&&i?(this.setFlatCoordinates(t,e),this.endss_=i):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;Ms(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let r=0,s=t.length;r<s;++r)t[r]+=i}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let r=0;r<e;++r)t[r]=this.endss_[r].slice();const i=new q0(this.flatCoordinates.slice(),this.layout,t);return i.applyProperties(this),i}closestPointXY(e,t,i,r){return r<Dc(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(r8(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),s8(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return c8(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return iV(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),nw(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,QE(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=Ak(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Pk(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new oy(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Ck(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=nw(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=f8(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,i),new q0(t,"XY",i)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const i=this.endss_[e].slice(),r=i[i.length-1];if(t!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=t;return new Ya(this.flatCoordinates.slice(t,r),this.layout,i)}getPolygons(){const e=this.layout,t=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const c=i[o].slice(),h=c[c.length-1];if(s!==0)for(let g=0,m=c.length;g<m;++g)c[g]-=s;const d=new Ya(t.slice(s,h),e,c);r.push(d),s=h}return r}getType(){return"MultiPolygon"}intersectsExtent(e){return h8(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=sk(this.flatCoordinates,0,e,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const ZR=Zr();class Ji{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?FM(this.flatCoordinates_):Rx(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=js(this.getExtent());this.flatInteriorPoints_=Wx(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=nV(this.flatCoordinates_,this.ends_),t=Ak(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Pk(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=U0(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=U0(e,t,o,2,.5);Ms(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Vt(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=vn(i)/vn(t);Gs(ZR,i[0],i[3],r,-r,0,0,0),Fa(this.flatCoordinates_,0,this.flatCoordinates_.length,2,ZR,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ji(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=NM((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=ry(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=ck(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=jx(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new Ji(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ji.prototype.getFlatCoordinates=Ji.prototype.getOrientedFlatCoordinates;function kk(n,e,t=0,i=n.length-1,r=rV){for(;i>t;){if(i-t>600){const c=i-t+1,h=e-t+1,d=Math.log(c),g=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*g*(c-g)/c)*(h-c/2<0?-1:1),y=Math.max(t,Math.floor(e-h*g/c+m)),w=Math.min(i,Math.floor(e+(c-h)*g/c+m));kk(n,e,y,w,r)}const s=n[e];let o=t,a=i;for(ef(n,t,e),r(n[i],s)>0&&ef(n,t,i);o<a;){for(ef(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?ef(n,t,a):(a++,ef(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function ef(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function rV(n,e){return n<e?-1:n>e?1:0}let Lk=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Vp(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],c=t.leaf?r(a):a;Vp(e,c)&&(t.leaf?i.push(a):B1(e,c)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!Vp(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Vp(e,o)){if(t.leaf||B1(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Ku([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,c,h;for(;i||s.length;){if(i||(i=s.pop(),c=s[s.length-1],a=o.pop(),h=!0),i.leaf){const d=sV(e,i.children,t);if(d!==-1)return i.children.splice(d,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&B1(i,r)?(s.push(i),o.push(a),a=0,c=i,i=i.children[0]):c?(a++,i=c.children[a],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=Ku(e.slice(t,i+1)),ku(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Ku([]),a.leaf=!1,a.height=r;const c=Math.ceil(s/o),h=c*Math.ceil(Math.sqrt(o));JR(e,t,i,h,this.compareMinX);for(let d=t;d<=i;d+=h){const g=Math.min(d+h-1,i);JR(e,d,g,c,this.compareMinY);for(let m=d;m<=g;m+=c){const y=Math.min(m+c-1,g);a.children.push(this._build(e,m,y,r-1))}}return ku(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let c=0;c<t.children.length;c++){const h=t.children[c],d=U1(h),g=lV(e,h)-d;g<o?(o=g,s=d<s?d:s,a=h):g===o&&d<s&&(s=d,a=h)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),df(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Ku(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,ku(i,this.toBBox),ku(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=Ku([e,t]),this.data.height=e.height+1,this.data.leaf=!1,ku(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const c=hf(e,0,a,this.toBBox),h=hf(e,a,i,this.toBBox),d=cV(c,h),g=U1(c)+U1(h);d<s?(s=d,r=a,o=g<o?g:o):d===s&&g<o&&(o=g,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:oV,s=e.leaf?this.compareMinY:aV,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=hf(e,0,t,s),a=hf(e,i-t,i,s);let c=Dp(o)+Dp(a);for(let h=t;h<i-t;h++){const d=e.children[h];df(o,e.leaf?s(d):d),c+=Dp(o)}for(let h=i-t-1;h>=t;h--){const d=e.children[h];df(a,e.leaf?s(d):d),c+=Dp(a)}return c}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)df(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():ku(e[t],this.toBBox)}};function sV(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function ku(n,e){hf(n,0,n.children.length,e,n)}function hf(n,e,t,i,r){r||(r=Ku(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];df(r,n.leaf?i(o):o)}return r}function df(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function oV(n,e){return n.minX-e.minX}function aV(n,e){return n.minY-e.minY}function U1(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Dp(n){return n.maxX-n.minX+(n.maxY-n.minY)}function lV(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function cV(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function B1(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Vp(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Ku(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function JR(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;kk(n,o,e,t,r),s.push(e,o,o,t)}}class eA{constructor(e){this.rbush_=new Lk(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[pt(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],c={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=c,this.items_[pt(a)]=c}this.rbush_.load(i)}remove(e){const t=pt(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[pt(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Ah(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return gc(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Ha(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class qx extends Hs{constructor(e){super(),this.projection=Vt(e.projection),this.attributions_=tA(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=tA(e),this.changed()}setState(e){this.state_=e,this.changed()}}function tA(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const wr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class ca extends Ws{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class ay extends qx{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Qf,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(St(this.format_,"`format` must be set when `url` is set"),this.loader_=XR(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:eV;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new eA:null,this.loadedExtentsRtree_=new eA,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Ar(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=pt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new ca(wr.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ji||(this.featureChangeKeys_[e]=[ft(t,Qe.CHANGE,this.handleFeatureChange_,this),ft(t,Rh.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof Ji){const s=this.idIndex_[r];s instanceof Ji?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(St(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],c=pt(a);this.addToIndex_(c,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],c=pt(a);this.setupChangeEvents_(c,a);const h=a.getGeometry();if(h){const d=h.getExtent();t.push(d),r.push(a)}else this.nullGeometryFeatures_[c]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(wr.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new ca(wr.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(wr.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(wr.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Li.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Li.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Dt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new ca(wr.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof Ji||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof Ji||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),gc(this.nullGeometryFeatures_)||Ms(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=$M(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const c=[-1/0,-1/0,1/0,1/0];return t=t||Xf,this.featuresRtree_.forEachInExtent(c,function(h){if(t(h)){const d=h.getGeometry(),g=a;if(a=d instanceof Ji?0:d.closestPointXY(i,r,o,a),a<g){s=h;const m=Math.sqrt(a);c[0]=i-m,c[1]=r-m,c[2]=i+m,c[3]=r+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=pt(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new ca(wr.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:pt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&gc(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const c=s[o];r.forEachInExtent(c,function(d){return Pa(d.extent,c)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ca(wr.FEATURESLOADSTART)),this.loader_.call(this,c,t,i,d=>{--this.loadingExtentsCount_,this.dispatchEvent(new ca(wr.FEATURESLOADEND,void 0,d))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ca(wr.FEATURESLOADERROR))}),r.insert(c,{extent:c.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Ah(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=pt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Dt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(wr.REMOVEFEATURE)&&this.dispatchEvent(new ca(wr.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){St(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(XR(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class es{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new es({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=z0(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ve.IDLE&&t.load(),t.getImageState()===Ve.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?pt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:bh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Ro{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Ro({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function nA(n){return n[0]>0&&n[1]>0}function uV(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Fi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class ly{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Fi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ly({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return qe()}getImage(e){return qe()}getHitDetectionImage(){return qe()}getPixelRatio(e){return 1}getImageState(){return qe()}getImageSize(){return qe()}getOrigin(){return qe()}getSize(){return qe()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Fi(e)}listenImageChange(e){qe()}load(){qe()}unlistenImageChange(e){qe()}ready(){return Promise.resolve()}}class cy extends ly{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ve.LOADING:Ve.LOADED,this.imageState_===Ve.LOADING&&this.ready().then(()=>this.imageState_=Ve.LOADED),this.render()}clone(){const e=this.getScale(),t=new cy({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Cr.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=Pn(o,o);this.draw_(s,a,e),r=a.canvas,Cr.set(i,null,null,new vk(r,void 0,null,Ve.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const $=r;r=s,s=$}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,c=s*Math.sin(a),h=Math.sqrt(s*s-c*c),d=r-h,g=Math.sqrt(c*c+d*d),m=g/c;if(e==="miter"&&m<=i)return m*t;const y=t/2/m,w=t/2*(d/g),E=Math.sqrt((r+y)*(r+y)+w*w)-r;if(this.radius2_===void 0||e==="bevel")return E*2;const A=r*Math.sin(a),b=Math.sqrt(r*r-A*A),N=s-b,O=Math.sqrt(A*A+N*N)/A;if(O<=i){const $=O*t/2-s-r;return 2*Math.max(E,$)}return E*2}createRenderOptions(){let e=Mh,t=kh,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=Ps(this.stroke_.getColor()??ng),a=this.stroke_.getWidth()??rg,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??kh,e=this.stroke_.getLineCap()??Mh,i=this.stroke_.getMiterLimit()??tg);const c=this.calculateLineJoinSize_(t,a,i),h=Math.max(this.radius,this.radius2_||0),d=Math.ceil(2*h+c);return{strokeStyle:o,strokeWidth:a,size:d,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=Ni),t.fillStyle=Ps(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=bh(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Pn(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const c=s+a*o,h=a%2===0?i:r;e.lineTo(h*Math.cos(c),h*Math.sin(c))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Ni,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Gc extends cy{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Gc({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Ii{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=iA,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Ii({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=iA,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function hV(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(St(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let z1=null;function Nk(n,e){if(!z1){const t=new es({color:"rgba(255,255,255,0.4)"}),i=new Ro({color:"#3399CC",width:1.25});z1=[new Ii({image:new Gc({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return z1}function iA(n){return n.getGeometry()}const dV="#333";class uy{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Fi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new es({color:dV}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new uy({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof es?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Fi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Fn={ANIMATING:0,INTERACTING:1},Ue={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Fp=[Ue.FILL],ka=[Ue.STROKE],rc=[Ue.BEGIN_PATH],rA=[Ue.CLOSE_PATH];class Kg extends Ek{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,c=e.length;a<c;a+=t)r[0]=e[a],r[1]=e[a+1],pc(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let c=a.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let d=e[t],g=e[t+1];const m=this.tmpCoordinate_;let y=!0,w,I,E;for(w=t+r;w<i;w+=r)m[0]=e[w],m[1]=e[w+1],E=BE(h,m),E!==I?(y&&(a[c++]=d,a[c++]=g,y=!1),a[c++]=m[0],a[c++]=m[1]):E===Dn.INTERSECTING?(a[c++]=m[0],a[c++]=m[1],y=!1):y=!0,d=m[0],g=m[1],I=E;return(s&&y||w===t+r)&&(a[c++]=d,a[c++]=g),c}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const c=i[o],h=this.appendFlatLineCoordinates(e,t,c,r,!1,!1);s.push(h),t=c}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),c=this.coordinates.length;let h,d,g,m,y;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),m=[];const w=e.getEndss();y=0;for(let I=0,E=w.length;I<E;++I){const A=[];y=this.drawCustomCoordinates_(h,y,w[I],a,A),m.push(A)}this.instructions.push([Ue.CUSTOM,c,m,e,i,QE,s]),this.hitDetectionInstructions.push([Ue.CUSTOM,c,m,e,r||i,QE,s]);break;case"Polygon":case"MultiLineString":g=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(h,0,e.getEnds(),a,g),this.instructions.push([Ue.CUSTOM,c,g,e,i,eg,s]),this.hitDetectionInstructions.push([Ue.CUSTOM,c,g,e,r||i,eg,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),d=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([Ue.CUSTOM,c,d,e,i,ba,s]),this.hitDetectionInstructions.push([Ue.CUSTOM,c,d,e,r||i,ba,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),d=this.appendFlatPointCoordinates(h,a),d>c&&(this.instructions.push([Ue.CUSTOM,c,d,e,i,ba,s]),this.hitDetectionInstructions.push([Ue.CUSTOM,c,d,e,r||i,ba,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),d=this.coordinates.length,this.instructions.push([Ue.CUSTOM,c,d,e,i,void 0,s]),this.hitDetectionInstructions.push([Ue.CUSTOM,c,d,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ue.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ue.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ue.END_GEOMETRY?o=t:s==Ue.BEGIN_GEOMETRY&&(r[2]=t,l6(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Ps(i||Ni)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Ps(i||ng);const r=e.getLineCap();t.lineCap=r!==void 0?r:Mh;const s=e.getLineDash();t.lineDash=s?s.slice():Io;const o=e.getLineDashOffset();t.lineDashOffset=o||To;const a=e.getLineJoin();t.lineJoin=a!==void 0?a:kh;const c=e.getWidth();t.lineWidth=c!==void 0?c:rg;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:tg,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ue.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ue.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,c=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!al(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=c||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=c,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ue.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=VM(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Zf(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class fV extends Kg{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!pc(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ue.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ue.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let c=0,h=r.length;c<h;c+=e.getStride())(!this.maxExtent||pc(this.maxExtent,r.slice(c,c+2)))&&s.push(r[c],r[c+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ue.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ue.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class gV extends Kg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[Ue.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ue.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Io,To],rc);const a=e.getFlatCoordinates(),c=e.getStride();this.drawFlatCoordinates_(a,0,a.length,c),this.hitDetectionInstructions.push(ka),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ue.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Io,To],rc);const a=e.getEnds(),c=e.getFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinates_(c,d,a[g],h);this.hitDetectionInstructions.push(ka),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(ka),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(ka),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(rc)}}class sA extends Kg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,c=i.length;this.instructions.push(rc),this.hitDetectionInstructions.push(rc);for(let h=0;h<c;++h){const d=i[h],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,d,r,!0,!a),y=[Ue.MOVE_TO_LINE_TO,g,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),a&&(this.instructions.push(rA),this.hitDetectionInstructions.push(rA)),t=d}return o&&(this.instructions.push(Fp),this.hitDetectionInstructions.push(Fp)),a&&(this.instructions.push(ka),this.hitDetectionInstructions.push(ka)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ue.SET_FILL_STYLE,Ni]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ue.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Io,To]);const a=e.getFlatCoordinates(),c=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,c,!1,!1);const d=[Ue.CIRCLE,h];this.instructions.push(rc,d),this.hitDetectionInstructions.push(rc,d),r.fillStyle!==void 0&&(this.instructions.push(Fp),this.hitDetectionInstructions.push(Fp)),r.strokeStyle!==void 0&&(this.instructions.push(ka),this.hitDetectionInstructions.push(ka)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ue.SET_FILL_STYLE,Ni]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ue.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Io,To]);const a=e.getEnds(),c=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(c,0,a,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ue.SET_FILL_STYLE,Ni]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ue.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Io,To]);const a=e.getEndss(),c=e.getOrientedFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinatess_(c,d,a[g],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ul(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function mV(n,e,t,i,r){const s=[];let o=t,a=0,c=e.slice(t,2);for(;a<n&&o+r<i;){const[h,d]=c.slice(-2),g=e[o+r],m=e[o+r+1],y=Math.sqrt((g-h)*(g-h)+(m-d)*(m-d));if(a+=y,a>=n){const w=(n-a+y)/y,I=Zi(h,g,w),E=Zi(d,m,w);c.push(I,E),s.push(c),c=[I,E],a==n&&(o+=r),a=0}else if(a<n)c.push(e[o+r],e[o+r+1]),o+=r;else{const w=y-a,I=Zi(h,g,w/y),E=Zi(d,m,w/y);c.push(I,E),s.push(c),c=[I,E],a=0,o+=r}}return a>0&&s.push(c),s}function pV(n,e,t,i,r){let s=t,o=t,a=0,c=0,h=t,d,g,m,y,w,I,E,A,b,N;for(g=t;g<i;g+=r){const D=e[g],O=e[g+1];w!==void 0&&(b=D-w,N=O-I,y=Math.sqrt(b*b+N*N),E!==void 0&&(c+=m,d=Math.acos((E*b+A*N)/(m*y)),d>n&&(c>a&&(a=c,s=h,o=g),c=0,h=g-r)),m=y,E=b,A=N),w=D,I=O}return c+=y,c>a?[h,g]:[s,o]}const Y0={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class _V extends Kg{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Ni]={fillStyle:Ni},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let c=a.length;const h=e.getType();let d=null,g=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ei(this.maxExtent,e.getExtent()))return;let m;if(d=e.getFlatCoordinates(),h=="LineString")m=[d.length];else if(h=="MultiLineString")m=e.getEnds();else if(h=="Polygon")m=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const E=e.getEndss();m=[];for(let A=0,b=E.length;A<b;++A)m.push(E[A][0])}this.beginGeometry(e,t,i);const y=o.repeat,w=y?void 0:o.textAlign;let I=0;for(let E=0,A=m.length;E<A;++E){let b;y?b=mV(y*this.resolution,d,I,m[E],g):b=[d.slice(I,m[E])];for(let N=0,D=b.length;N<D;++N){const O=b[N];let $=0,k=O.length;if(w==null){const L=pV(o.maxAngle,O,0,O.length,2);$=L[0],k=L[1]}for(let L=$;L<k;L+=g)a.push(O[L],O[L+1]);const C=a.length;I=m[E],this.drawChars_(c,C),c=C}}this.endGeometry(t)}else{let m=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":d=e.getFlatCoordinates();break;case"LineString":d=e.getFlatMidpoint();break;case"Circle":d=e.getCenter();break;case"MultiLineString":d=e.getFlatMidpoints(),g=2;break;case"Polygon":d=e.getFlatInteriorPoint(),o.overflow||m.push(d[2]/this.resolution),g=3;break;case"MultiPolygon":const D=e.getFlatInteriorPoints();d=[];for(let O=0,$=D.length;O<$;O+=3)o.overflow||m.push(D[O+2]/this.resolution),d.push(D[O],D[O+1]);if(d.length===0)return;g=2;break}const y=this.appendFlatPointCoordinates(d,g);if(y===c)return;if(m&&(y-c)/2!==d.length/g){let D=c/2;m=m.filter((O,$)=>{const k=a[(D+$)*2]===d[$*g]&&a[(D+$)*2+1]===d[$*g+1];return k||--D,k})}this.saveTextStates_();const w=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let E=o.padding;if(E!=ic&&(o.scale[0]<0||o.scale[1]<0)){let D=o.padding[0],O=o.padding[1],$=o.padding[2],k=o.padding[3];o.scale[0]<0&&(O=-O,k=-k),o.scale[1]<0&&(D=-D,$=-$),E=[D,O,$,k]}const A=this.pixelRatio;this.instructions.push([Ue.DRAW_IMAGE,c,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==ic?ic:E.map(function(D){return D*A}),w,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const b=1/A,N=w?w.slice(0):null;N&&(N[1]=Ni),this.hitDetectionInstructions.push([Ue.DRAW_IMAGE,c,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,E,N,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Ni:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||ig,justify:t.justify,textBaseline:t.textBaseline||$0,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const c=this.pixelRatio,h=Y0[r.textBaseline],d=this.textOffsetY_*c,g=this.text_,m=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ue.DRAW_CHARS,e,t,h,r.overflow,a,r.maxAngle,c,d,s,m*c,g,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ue.DRAW_CHARS,e,t,h,r.overflow,a&&Ni,r.maxAngle,c,d,s,m*c,g,o,1/c,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Ps(o.getColor()||Ni)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=a.getLineDash(),E=a.getLineDashOffset(),A=a.getWidth(),b=a.getMiterLimit();s.lineCap=a.getLineCap()||Mh,s.lineDash=I?I.slice():Io,s.lineDashOffset=E===void 0?To:E,s.lineJoin=a.getLineJoin()||kh,s.lineWidth=A===void 0?rg:A,s.miterLimit=b===void 0?tg:b,s.strokeStyle=Ps(a.getColor()||ng)}i=this.textState_;const c=e.getFont()||wk;O8(c);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=c,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||$0,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||ic,i.scale=h===void 0?[1,1]:h;const d=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),y=e.getKeepUpright(),w=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=d===void 0?0:d,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=w===void 0?0:w,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:pt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+pt(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const yV={Circle:sA,Default:Kg,Image:fV,LineString:gV,Polygon:sA,Text:_V};class vV{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=yV[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function EV(n,e,t,i,r,s,o,a,c,h,d,g,m=!0){let y=n[e],w=n[e+1],I=0,E=0,A=0,b=0;function N(){I=y,E=w,e+=i,y=n[e],w=n[e+1],b+=A,A=Math.sqrt((y-I)*(y-I)+(w-E)*(w-E))}do N();while(e<t-i&&b+A<s);let D=A===0?0:(s-b)/A;const O=Zi(I,y,D),$=Zi(E,w,D),k=e-i,C=b,L=s+a*c(h,r,d);for(;e<t-i&&b+A<L;)N();D=A===0?0:(L-b)/A;const j=Zi(I,y,D),G=Zi(E,w,D);let z=!1;if(m)if(g){const fe=[O,$,j,G];ik(fe,0,4,2,g,fe,fe),z=fe[0]>fe[2]}else z=O>j;const V=Math.PI,de=[],Pe=k+i===e;e=k,A=0,b=C,y=n[e],w=n[e+1];let ue;if(Pe){N(),ue=Math.atan2(w-E,y-I),z&&(ue+=ue>0?-V:V);const fe=(j+O)/2,Q=(G+$)/2;return de[0]=[fe,Q,(L-s)/2,ue,r],de}r=r.replace(/\n/g," ");for(let fe=0,Q=r.length;fe<Q;){N();let ge=Math.atan2(w-E,y-I);if(z&&(ge+=ge>0?-V:V),ue!==void 0){let X=ge-ue;if(X+=X>V?-2*V:X<-V?2*V:0,Math.abs(X)>o)return null}ue=ge;const he=fe;let K=0;for(;fe<Q;++fe){const X=z?Q-fe-1:fe,P=a*c(h,r[X],d);if(e+i<t&&b+A<s+K+P/2)break;K+=P}if(fe===he)continue;const W=z?r.substring(Q-he,Q-fe):r.substring(he,fe);D=A===0?0:(s+K/2-b)/A;const be=Zi(I,y,D),ie=Zi(E,w,D);de.push([be,ie,K/2,ge,W]),s+=K}return de}class Ok{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(B0(),{get:(e,t)=>{if(typeof B0()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Lu=ir(),ua=[],mo=[],po=[],ha=[];function oA(n){return n[3].declutterBox}const aA=new RegExp("[-----]");function $1(n,e){return e==="start"?e=aA.test(n)?"right":"left":e==="end"&&(e=aA.test(n)?"left":"right"),Y0[e]}function wV(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function xV(n,e,t){return t%2===0&&(n+=e),n}class SV{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Zr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Ok:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,c=this.textStates[t],h=this.pixelRatio,d=[c.scale[0]*h,c.scale[1]*h],g=c.justify?Y0[c.justify]:$1(Array.isArray(e)?e[0]:e,c.textAlign||ig),m=r&&o.lineWidth?o.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(wV,[]),{width:w,height:I,widths:E,heights:A,lineWidths:b}=V8(c,y),N=w+m,D=[],O=(N+2)*d[0],$=(I+m)*d[1],k={width:O<0?Math.floor(O):Math.ceil(O),height:$<0?Math.floor($):Math.ceil($),contextInstructions:D};(d[0]!=1||d[1]!=1)&&D.push("scale",d),r&&(D.push("strokeStyle",o.strokeStyle),D.push("lineWidth",m),D.push("lineCap",o.lineCap),D.push("lineJoin",o.lineJoin),D.push("miterLimit",o.miterLimit),D.push("setLineDash",[o.lineDash]),D.push("lineDashOffset",o.lineDashOffset)),i&&D.push("fillStyle",a.fillStyle),D.push("textBaseline","middle"),D.push("textAlign","center");const C=.5-g;let L=g*N+C*m;const j=[],G=[];let z=0,V=0,de=0,Pe=0,ue;for(let fe=0,Q=y.length;fe<Q;fe+=2){const ge=y[fe];if(ge===`
`){V+=z,z=0,L=g*N+C*m,++Pe;continue}const he=y[fe+1]||c.font;he!==ue&&(r&&j.push("font",he),i&&G.push("font",he),ue=he),z=Math.max(z,A[de]);const K=[ge,L+C*E[de]+g*(E[de]-b[Pe]),.5*(m+z)+V];L+=E[de],r&&j.push("strokeText",K),i&&G.push("fillText",K),++de}return Array.prototype.push.apply(D,j),Array.prototype.push.apply(D,G),this.labels_[s]=k,k}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,c,h,d,g,m,y,w,I,E){a*=m[0],c*=m[1];let A=i-a,b=r-c;const N=s+h>e?e-h:s,D=o+d>t?t-d:o,O=w[3]+N*m[0]+w[1],$=w[0]+D*m[1]+w[2],k=A-w[3],C=b-w[0];(I||g!==0)&&(ua[0]=k,ha[0]=k,ua[1]=C,mo[1]=C,mo[0]=k+O,po[0]=mo[0],po[1]=C+$,ha[1]=po[1]);let L;return g!==0?(L=Gs(Zr(),i,r,1,1,g,-i,-r),Rn(L,ua),Rn(L,mo),Rn(L,po),Rn(L,ha),Ha(Math.min(ua[0],mo[0],po[0],ha[0]),Math.min(ua[1],mo[1],po[1],ha[1]),Math.max(ua[0],mo[0],po[0],ha[0]),Math.max(ua[1],mo[1],po[1],ha[1]),Lu)):Ha(Math.min(k,k+O),Math.min(C,C+$),Math.max(k,k+O),Math.max(C,C+$),Lu),y&&(A=Math.round(A),b=Math.round(b)),{drawImageX:A,drawImageY:b,drawImageW:N,drawImageH:D,originX:h,originY:d,declutterBox:{minX:Lu[0],minY:Lu[1],maxX:Lu[2],maxY:Lu[3],value:E},canvasTransform:L,scale:m}}replayImageOrLabel_(e,t,i,r,s,o,a){const c=!!(o||a),h=r.declutterBox,d=a?a[2]*r.scale[0]/2:0;return h.minX-d<=t[0]&&h.maxX+d>=0&&h.minY-d<=t[1]&&h.maxY+d>=0&&(c&&this.replayTextBackground_(e,ua,mo,po,ha,o,a),F8(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=Rn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],c=this.pixelRatio,h=$1(Array.isArray(e)?e[0]:e,s.textAlign||ig),d=Y0[s.textBaseline||$0],g=a&&a.lineWidth?a.lineWidth:0,m=o.width/c-2*s.scale[0],y=h*m+2*(.5-h)*g,w=d*o.height/c+2*(.5-d)*g;return{label:o,anchorX:y,anchorY:w}}execute_(e,t,i,r,s,o,a,c){const h=this.zIndexContext_;let d;this.pixelCoordinates_&&al(i,this.renderedTransform_)?d=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),d=Fa(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Y6(this.renderedTransform_,i));let g=0;const m=r.length;let y=0,w,I,E,A,b,N,D,O,$,k,C,L,j,G=0,z=0;const V=this.coordinateCache_,de=this.viewRotation_,Pe=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ue={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:de},fe=this.instructions!=r||this.overlaps?0:200;let Q,ge,he,K;for(;g<m;){const W=r[g];switch(W[0]){case Ue.BEGIN_GEOMETRY:Q=W[1],K=W[3],Q.getGeometry()?a!==void 0&&!Ei(a,K.getExtent())?g=W[2]+1:++g:g=W[2],h&&(h.zIndex=W[4]);break;case Ue.BEGIN_PATH:G>fe&&(this.fill_(e),G=0),z>fe&&(e.stroke(),z=0),!G&&!z&&(e.beginPath(),b=NaN,N=NaN),++g;break;case Ue.CIRCLE:y=W[1];const ie=d[y],X=d[y+1],P=d[y+2],Ee=d[y+3],Y=P-ie,Ie=Ee-X,Z=Math.sqrt(Y*Y+Ie*Ie);e.moveTo(ie+Z,X),e.arc(ie,X,Z,0,2*Math.PI,!0),++g;break;case Ue.CLOSE_PATH:e.closePath(),++g;break;case Ue.CUSTOM:y=W[1],w=W[2];const U=W[3],ae=W[4],Xe=W[5];ue.geometry=U,ue.feature=Q,g in V||(V[g]=[]);const rt=V[g];Xe?Xe(d,y,w,2,rt):(rt[0]=d[y],rt[1]=d[y+1],rt.length=2),h&&(h.zIndex=W[6]),ae(rt,ue),++g;break;case Ue.DRAW_IMAGE:y=W[1],w=W[2],$=W[3],I=W[4],E=W[5];let ht=W[6];const Ft=W[7],an=W[8],ar=W[9],Nt=W[10];let It=W[11];const Mn=W[12];let lr=W[13];A=W[14]||"declutter";const $t=W[15];if(!$&&W.length>=20){k=W[19],C=W[20],L=W[21],j=W[22];const ln=this.drawLabelWithPointPlacement_(k,C,L,j);$=ln.label,W[3]=$;const hr=W[23];I=(ln.anchorX-hr)*this.pixelRatio,W[4]=I;const Gn=W[24];E=(ln.anchorY-Gn)*this.pixelRatio,W[5]=E,ht=$.height,W[6]=ht,lr=$.width,W[13]=lr}let Go;W.length>25&&(Go=W[25]);let cr,ns,Nr;W.length>17?(cr=W[16],ns=W[17],Nr=W[18]):(cr=ic,ns=null,Nr=null),Nt&&Pe?It+=de:!Nt&&!Pe&&(It-=de);let is=0;for(;y<w;y+=2){if(Go&&Go[is++]<lr/this.pixelRatio)continue;const ln=this.calculateImageOrLabelDimensions_($.width,$.height,d[y],d[y+1],lr,ht,I,E,an,ar,It,Mn,s,cr,!!ns||!!Nr,Q),hr=[e,t,$,ln,Ft,ns,Nr];if(c){let Gn,cn,Un;if($t){const _t=w-y;if(!$t[_t]){$t[_t]={args:hr,declutterMode:A};continue}const gn=$t[_t];Gn=gn.args,cn=gn.declutterMode,delete $t[_t],Un=oA(Gn)}let Bn,kn;if(Gn&&(cn!=="declutter"||!c.collides(Un))&&(Bn=!0),(A!=="declutter"||!c.collides(ln.declutterBox))&&(kn=!0),cn==="declutter"&&A==="declutter"){const _t=Bn&&kn;Bn=_t,kn=_t}Bn&&(cn!=="none"&&c.insert(Un),this.replayImageOrLabel_.apply(this,Gn)),kn&&(A!=="none"&&c.insert(ln.declutterBox),this.replayImageOrLabel_.apply(this,hr))}else this.replayImageOrLabel_.apply(this,hr)}++g;break;case Ue.DRAW_CHARS:const dl=W[1],rs=W[2],ur=W[3],Yc=W[4];j=W[5];const ss=W[6],Qs=W[7],Uo=W[8];L=W[9];const gi=W[10];k=W[11],Array.isArray(k)&&(k=k.reduce(xV,"")),C=W[12];const Zs=[W[13],W[13]];A=W[14]||"declutter";const os=W[15],as=this.textStates[C],mi=as.font,pi=[as.scale[0]*Qs,as.scale[1]*Qs];let Mt;mi in this.widths_?Mt=this.widths_[mi]:(Mt={},this.widths_[mi]=Mt);const Bo=Fx(d,dl,rs,2),Or=Math.abs(pi[0])*KR(mi,k,Mt);if(Yc||Or<=Bo){const ln=this.textStates[C].textAlign,hr=(Bo-Or)*$1(k,ln),Gn=EV(d,dl,rs,2,k,hr,ss,Math.abs(pi[0]),KR,mi,Mt,Pe?0:this.viewRotation_,os);e:if(Gn){const cn=[];let Un,Bn,kn,_t,gn;if(L)for(Un=0,Bn=Gn.length;Un<Bn;++Un){gn=Gn[Un],kn=gn[4],_t=this.createLabel(kn,C,"",L),I=gn[2]+(pi[0]<0?-gi:gi),E=ur*_t.height+(.5-ur)*2*gi*pi[1]/pi[0]-Uo;const xn=this.calculateImageOrLabelDimensions_(_t.width,_t.height,gn[0],gn[1],_t.width,_t.height,I,E,0,0,gn[3],Zs,!1,ic,!1,Q);if(c&&A==="declutter"&&c.collides(xn.declutterBox))break e;cn.push([e,t,_t,xn,1,null,null])}if(j)for(Un=0,Bn=Gn.length;Un<Bn;++Un){gn=Gn[Un],kn=gn[4],_t=this.createLabel(kn,C,j,""),I=gn[2],E=ur*_t.height-Uo;const xn=this.calculateImageOrLabelDimensions_(_t.width,_t.height,gn[0],gn[1],_t.width,_t.height,I,E,0,0,gn[3],Zs,!1,ic,!1,Q);if(c&&A==="declutter"&&c.collides(xn.declutterBox))break e;cn.push([e,t,_t,xn,1,null,null])}c&&A!=="none"&&c.load(cn.map(oA));for(let xn=0,dr=cn.length;xn<dr;++xn)this.replayImageOrLabel_.apply(this,cn[xn])}}++g;break;case Ue.END_GEOMETRY:if(o!==void 0){Q=W[1];const ln=o(Q,K,A);if(ln)return ln}++g;break;case Ue.FILL:fe?G++:this.fill_(e),++g;break;case Ue.MOVE_TO_LINE_TO:for(y=W[1],w=W[2],ge=d[y],he=d[y+1],e.moveTo(ge,he),b=ge+.5|0,N=he+.5|0,y+=2;y<w;y+=2)ge=d[y],he=d[y+1],D=ge+.5|0,O=he+.5|0,(y==w-2||D!==b||O!==N)&&(e.lineTo(ge,he),b=D,N=O);++g;break;case Ue.SET_FILL_STYLE:this.alignAndScaleFill_=W[2],G&&(this.fill_(e),G=0,z&&(e.stroke(),z=0)),e.fillStyle=W[1],++g;break;case Ue.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,W),++g;break;case Ue.STROKE:fe?z++:e.stroke(),++g;break;default:++g;break}}G&&this.fill_(e),z&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Xl=["Polygon","Circle","LineString","Image","Text","Default"],Dk=["Image","Text"],IV=Xl.filter(n=>!Dk.includes(n));class TV{constructor(e,t,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Zr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new SV(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,c=Gs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Pn(a,a));const d=this.hitDetectionContext_;d.canvas.width!==a||d.canvas.height!==a?(d.canvas.width=a,d.canvas.height=a):h||d.clearRect(0,0,a,a);let g;this.renderBuffer_!==void 0&&(g=ir(),Pf(g,e),Zf(g,t*(this.renderBuffer_+r),g));const m=RV(r);let y;function w(O,$,k){const C=d.getImageData(0,0,a,a).data;for(let L=0,j=m.length;L<j;L++)if(C[m[L]]>0){if(!o||k==="none"||y!=="Image"&&y!=="Text"||o.includes(O)){const G=(m[L]-3)/4,z=r-G%a,V=r-(G/a|0),de=s(O,$,z*z+V*V);if(de)return de}d.clearRect(0,0,a,a);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(xo);let E,A,b,N,D;for(E=I.length-1;E>=0;--E){const O=I[E].toString();for(b=this.executorsByZIndex_[O],A=Xl.length-1;A>=0;--A)if(y=Xl[A],N=b[y],N!==void 0&&(D=N.executeHitDetection(d,c,i,w,g),D))return D}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return Fa(a,0,8,2,e,a),a}isEmpty(){return gc(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const c=Object.keys(this.executorsByZIndex_).map(Number);c.sort(a?a6:xo),o=o||Xl;const h=Xl.length;for(let d=0,g=c.length;d<g;++d){const m=c[d].toString(),y=this.executorsByZIndex_[m];for(let w=0,I=o.length;w<I;++w){const E=o[w],A=y[E];if(A!==void 0){const b=a===null?void 0:A.getZIndexContext(),N=b?b.getContext():e,D=this.maxExtent_&&E!=="Image"&&E!=="Text";if(D&&(N.save(),this.clip(N,i)),!b||E==="Text"||E==="Image"?A.execute(N,t,i,r,s,a):b.pushFunction(O=>A.execute(O,t,i,r,s,a)),D&&N.restore(),b){b.offset();const O=c[d]*h+Xl.indexOf(E);this.deferredZIndexContexts_[O]||(this.deferredZIndexContexts_[O]=[]),this.deferredZIndexContexts_[O].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(xo);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const W1={};function RV(n){if(W1[n]!==void 0)return W1[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let c=i[a];c||(c=[],i[a]=c),c.push(((n+s)*e+(n+o))*4+3),s>0&&c.push(((n-s)*e+(n+o))*4+3),o>0&&(c.push(((n+s)*e+(n-o))*4+3),s>0&&c.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return W1[n]=r,r}function lA(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let X0=class Vk extends ly{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;St(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||pt(o)),St(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),St(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(e.src!==void 0?c=Ve.IDLE:o!==void 0&&("complete"in o?o.complete?c=o.src?Ve.LOADED:Ve.IDLE:c=Ve.LOADING:c=Ve.LOADED),this.color_=e.color!==void 0?bh(e.color):null,this.iconImage_=z0(o,a,this.crossOrigin_,c,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,d;if(e.size)[h,d]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)h=g.width,d=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(lA(y[0],y[1],e.width,e.height))};this.listenImageChange(m);return}}h!==void 0&&this.setScale(lA(h,d,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Vk({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=z0(null,e,this.crossOrigin_,Ve.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ve.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ve.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Qe.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Qe.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Ts=.5;function AV(n,e,t,i,r,s,o,a,c){const h=r,d=n[0]*Ts,g=n[1]*Ts,m=Pn(d,g);m.imageSmoothingEnabled=!1;const y=m.canvas,w=new G8(m,Ts,r,null,o,a,null),I=t.length,E=Math.floor((256*256*256-1)/I),A={};for(let N=1;N<=I;++N){const D=t[N-1],O=D.getStyleFunction()||i;if(!O)continue;let $=O(D,s);if(!$)continue;Array.isArray($)||($=[$]);const C=(N*E).toString(16).padStart(7,"#00000");for(let L=0,j=$.length;L<j;++L){const G=$[L],z=G.getGeometryFunction()(D);if(!z||!Ei(h,z.getExtent()))continue;const V=G.clone(),de=V.getFill();de&&de.setColor(C);const Pe=V.getStroke();Pe&&(Pe.setColor(C),Pe.setLineDash(null)),V.setText(void 0);const ue=G.getImage();if(ue){const he=ue.getImageSize();if(!he)continue;const K=Pn(he[0],he[1],void 0,{alpha:!1}),W=K.canvas;K.fillStyle=C,K.fillRect(0,0,W.width,W.height),V.setImage(new X0({img:W,anchor:ue.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ue.getOrigin(),opacity:1,size:ue.getSize(),scale:ue.getScale(),rotation:ue.getRotation(),rotateWithView:ue.getRotateWithView()}))}const fe=V.getZIndex()||0;let Q=A[fe];Q||(Q={},A[fe]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const ge=z.getType();if(ge==="GeometryCollection"){const he=z.getGeometriesArrayRecursive();for(let K=0,W=he.length;K<W;++K){const be=he[K];Q[be.getType().replace("Multi","")].push(be,V)}}else Q[ge.replace("Multi","")].push(z,V)}}const b=Object.keys(A).map(Number).sort(xo);for(let N=0,D=b.length;N<D;++N){const O=A[b[N]];for(const $ in O){const k=O[$];for(let C=0,L=k.length;C<L;C+=2){w.setStyle(k[C+1]);for(let j=0,G=e.length;j<G;++j)w.setTransform(e[j]),w.drawGeometry(k[C])}}}return m.getImageData(0,0,y.width,y.height)}function PV(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Ts),s=Math.floor(Math.round(n[1])*Ts),o=(Bt(r,0,t.width-1)+Bt(s,0,t.height-1)*t.width)*4,a=t.data[o],c=t.data[o+1],d=t.data[o+2]+256*(c+256*a),g=Math.floor((256*256*256-1)/e.length);d&&d%g===0&&i.push(e[d/g-1])}return i}class Fk extends Ws{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const CV=5;class bV extends Gg{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=CV}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return qe()}getData(e){return null}prepareFrame(e){return qe()}renderFrame(e,t){return qe()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ve.LOADED||t.getState()===Ve.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ve.LOADED&&t!=Ve.ERROR&&e.addEventListener(Qe.CHANGE,this.boundHandleImageChange_),t==Ve.IDLE&&(e.load(),t=e.getState()),t==Ve.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const cA=[];let qu=null;function MV(){qu=Pn(1,1,void 0,{willReadFrequently:!0})}class Yx extends bV{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Zr(),this.pixelTransform=Zr(),this.inversePixelTransform=Zr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){qu||MV(),qu.clearRect(0,0,1,1);let r;try{qu.drawImage(e,t,i,1,1,0,0,1,1),r=qu.getImageData(0,0,1,1).data}catch{return qu=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&al(bh(e.style.backgroundColor),bh(i)))){const a=e.firstElementChild;Ma(a)&&(o=a.getContext("2d"))}if(o&&J6(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=er?gk():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Pn();const c=o.canvas;s.appendChild(c),a=c.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Vc(i),s=Z_(i),o=Q_(i),a=X_(i);Rn(t.coordinateToPixelTransform,r),Rn(t.coordinateToPixelTransform,s),Rn(t.coordinateToPixelTransform,o),Rn(t.coordinateToPixelTransform,a);const c=this.inversePixelTransform;Rn(c,r),Rn(c,s),Rn(c,o),Rn(c,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(ot(i)/r*o),c=Math.round(vn(i)/r*o);Gs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-c/2),nk(this.inversePixelTransform,this.pixelTransform);const h=Z6(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const d=this.context.canvas;d.width!=a||d.height!=c?(d.width=a,d.height=c):this.context.clearRect(0,0,a,c),h!==d.style.transform&&(d.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new Fk(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Pr.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Pr.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Ok),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Pr.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Pr.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,a){const c=s/2,h=o/2,d=r/t,g=-d,m=-e[0]+a,y=-e[1];return Gs(this.tempTransform,c,h,d,g,-i,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class kV extends Yx{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=ir(),this.wrappedRenderedExtent_=ir(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,c=s.projection,h=s.rotation,d=c.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),y=t.pixelRatio,w=t.viewHints,I=!(w[Fn.ANIMATING]||w[Fn.INTERACTING]),E=this.context,A=Math.round(ot(r)/a*y),b=Math.round(vn(r)/a*y),N=g.getWrapX()&&c.canWrapX(),D=N?ot(d):null,O=N?Math.ceil((r[2]-d[2])/D)+1:1;let $=N?Math.floor((r[0]-d[0])/D):0;do{let k=this.getRenderTransform(o,a,0,y,A,b,$*D);t.declutter&&(k=k.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],k,h,I,i===void 0?Xl:i?Dk:IV,i?m&&t.declutter[m]:void 0)}while(++$<O)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Pn(this.context.canvas.width,this.context.canvas.height,cA))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,sy(this.context),cA.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Pr.PRERENDER)||this.getLayer().hasListener(Pr.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const c=As(i.extent);a=Ei(c,e.extent),this.clipped_=a&&!Pa(c,e.extent),this.clipped_&&this.clipUnrotated(s,e,c)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,c=this.wrappedRenderedExtent_,h=this.getLayer(),d=[],g=i[0]*Ts,m=i[1]*Ts;d.push(this.getRenderTransform(r,s,o,Ts,g,m,0).slice());const y=h.getSource(),w=a.getExtent();if(y.getWrapX()&&a.canWrapX()&&!Pa(w,c)){let I=c[0];const E=ot(w);let A=0,b;for(;I<w[0];)--A,b=E*A,d.push(this.getRenderTransform(r,s,o,Ts,g,m,b).slice()),I+=E;for(A=0,I=c[2];I>w[2];)++A,b=E*A,d.push(this.getRenderTransform(r,s,o,Ts,g,m,b).slice()),I-=E}this.hitDetectionImageData_=AV(i,d,this.renderedFeatures_,h.getStyleFunction(),c,s,o,qR(s,this.renderedPixelRatio_))}t(PV(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,c=this.getLayer(),h={},d=function(m,y,w){const I=pt(m),E=h[I];if(E){if(E!==!0&&w<E.distanceSq){if(w===0)return h[I]=!0,s.splice(s.lastIndexOf(E),1),r(m,c,y);E.geometry=y,E.distanceSq=w}}else{if(w===0)return h[I]=!0,r(m,c,y);s.push(h[I]={feature:m,layer:c,geometry:y,distanceSq:w,callback:r})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,d,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Fn.ANIMATING],s=e.viewHints[Fn.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const c=e.extent,h=e.viewState,d=h.projection,g=h.resolution,m=e.pixelRatio,y=t.getRevision(),w=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=B8);const E=h.center.slice(),A=Zf(c,w*g),b=A.slice(),N=[A.slice()],D=d.getExtent();if(i.getWrapX()&&d.canWrapX()&&!Pa(D,e.extent)){const de=ot(D),Pe=Math.max(ot(A)/2,de);A[0]=D[0]-Pe,A[2]=D[2]+Pe,HM(E,d);const ue=zM(N[0],d);ue[0]<D[0]&&ue[2]<D[2]?N.push([ue[0]+de,ue[1],ue[2]+de,ue[3]]):ue[0]>D[0]&&ue[2]>D[2]&&N.push([ue[0]-de,ue[1],ue[2]-de,ue[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==y&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Pa(this.wrappedRenderedExtent_,A))return al(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const O=new vV(Tk(g,m),A,g,m);let $;for(let de=0,Pe=N.length;de<Pe;++de)i.loadFeatures(N[de],g,d);const k=qR(g,m);let C=!0;const L=(de,Pe)=>{let ue;const fe=de.getStyleFunction()||t.getStyleFunction();if(fe&&(ue=fe(de,g)),ue){const Q=this.renderFeature(de,k,ue,O,$,this.getLayer().getDeclutter(),Pe);C=C&&!Q}},j=tk(A),G=i.getFeaturesInExtent(j);I&&G.sort(I);for(let de=0,Pe=G.length;de<Pe;++de)L(G[de],de);this.renderedFeatures_=G,this.ready=C;const z=O.finish(),V=new TV(A,g,m,i.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=y,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=A,this.renderedCenter_=E,this.renderedProjection_=d,this.renderedPixelRatio_=m,this.replayGroup_=V,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,a){if(!i)return!1;let c=!1;if(Array.isArray(i))for(let h=0,d=i.length;h<d;++h)c=YR(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,a)||c;else c=YR(r,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return c}}let Uc=0;const vi=1<<Uc++,ut=1<<Uc++,Oi=1<<Uc++,qr=1<<Uc++,Ec=1<<Uc++,ff=1<<Uc++,jp=Math.pow(2,Uc)-1,Xx={[vi]:"boolean",[ut]:"number",[Oi]:"string",[qr]:"color",[Ec]:"number[]",[ff]:"size"},LV=Object.keys(Xx).map(Number).sort(xo);function NV(n){return n in Xx}function gf(n){const e=[];for(const t of LV)mf(n,t)&&e.push(Xx[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function mf(n,e){return(n&e)===e}function da(n,e){return n===e}class Tn{constructor(e,t){if(!NV(e))throw new Error(`literal expressions must have a specific type, got ${gf(e)}`);this.type=e,this.value=t}}class OV{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function jk(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Zn(n,e,t){switch(typeof n){case"boolean":{if(da(e,Oi))return new Tn(Oi,n?"true":"false");if(!mf(e,vi))throw new Error(`got a boolean, but expected ${gf(e)}`);return new Tn(vi,n)}case"number":{if(da(e,ff))return new Tn(ff,Fi(n));if(da(e,vi))return new Tn(vi,!!n);if(da(e,Oi))return new Tn(Oi,n.toString());if(!mf(e,ut))throw new Error(`got a number, but expected ${gf(e)}`);return new Tn(ut,n)}case"string":{if(da(e,qr))return new Tn(qr,Bx(n));if(da(e,vi))return new Tn(vi,!!n);if(!mf(e,Oi))throw new Error(`got a string, but expected ${gf(e)}`);return new Tn(Oi,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return HV(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(da(e,ff)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Tn(ff,n)}if(da(e,qr)){if(n.length===3)return new Tn(qr,[...n,1]);if(n.length===4)return new Tn(qr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!mf(e,Ec))throw new Error(`got an array of numbers, but expected ${gf(e)}`);return new Tn(Ec,n)}const ce={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},DV={[ce.Get]:Ke(nt(1,1/0),uA),[ce.Var]:Ke(nt(1,1),VV),[ce.Has]:Ke(nt(1,1/0),uA),[ce.Id]:Ke(FV,Nu),[ce.Concat]:Ke(nt(2,1/0),vt(Oi)),[ce.GeometryType]:Ke(jV,Nu),[ce.LineMetric]:Ke(Nu),[ce.Resolution]:Ke(H1,Nu),[ce.Zoom]:Ke(H1,Nu),[ce.Time]:Ke(H1,Nu),[ce.Any]:Ke(nt(2,1/0),vt(vi)),[ce.All]:Ke(nt(2,1/0),vt(vi)),[ce.Not]:Ke(nt(1,1),vt(vi)),[ce.Equal]:Ke(nt(2,2),vt(jp)),[ce.NotEqual]:Ke(nt(2,2),vt(jp)),[ce.GreaterThan]:Ke(nt(2,2),vt(ut)),[ce.GreaterThanOrEqualTo]:Ke(nt(2,2),vt(ut)),[ce.LessThan]:Ke(nt(2,2),vt(ut)),[ce.LessThanOrEqualTo]:Ke(nt(2,2),vt(ut)),[ce.Multiply]:Ke(nt(2,1/0),hA),[ce.Coalesce]:Ke(nt(2,1/0),hA),[ce.Divide]:Ke(nt(2,2),vt(ut)),[ce.Add]:Ke(nt(2,1/0),vt(ut)),[ce.Subtract]:Ke(nt(2,2),vt(ut)),[ce.Clamp]:Ke(nt(3,3),vt(ut)),[ce.Mod]:Ke(nt(2,2),vt(ut)),[ce.Pow]:Ke(nt(2,2),vt(ut)),[ce.Abs]:Ke(nt(1,1),vt(ut)),[ce.Floor]:Ke(nt(1,1),vt(ut)),[ce.Ceil]:Ke(nt(1,1),vt(ut)),[ce.Round]:Ke(nt(1,1),vt(ut)),[ce.Sin]:Ke(nt(1,1),vt(ut)),[ce.Cos]:Ke(nt(1,1),vt(ut)),[ce.Atan]:Ke(nt(1,2),vt(ut)),[ce.Sqrt]:Ke(nt(1,1),vt(ut)),[ce.Match]:Ke(nt(4,1/0),dA,UV),[ce.Between]:Ke(nt(3,3),vt(ut)),[ce.Interpolate]:Ke(nt(6,1/0),dA,BV),[ce.Case]:Ke(nt(3,1/0),GV,zV),[ce.In]:Ke(nt(2,2),$V),[ce.Number]:Ke(nt(1,1/0),vt(jp)),[ce.String]:Ke(nt(1,1/0),vt(jp)),[ce.Array]:Ke(nt(1,1/0),vt(ut)),[ce.Color]:Ke(nt(1,4),vt(ut)),[ce.Band]:Ke(nt(1,3),vt(ut)),[ce.Palette]:Ke(nt(2,2),WV),[ce.ToString]:Ke(nt(1,1),vt(vi|ut|Oi|qr))};function uA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Tn(ut,o);break}case"string":{r[s]=new Tn(Oi,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function VV(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Tn(Oi,i)]}function FV(n,e,t){t.featureId=!0}function jV(n,e,t){t.geometryType=!0}function H1(n,e,t){t.mapState=!0}function Nu(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function nt(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>e){const a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function hA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Zn(n[s+1],e,t);r[s]=o}return r}function vt(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Zn(e[o+1],n,i);s[o]=a}return s}}function GV(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function dA(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function UV(n,e,t){const i=n.length-1,r=Oi|ut|vi,s=Zn(n[1],r,t),o=Zn(n[n.length-1],e,t),a=new Array(i-2);for(let c=0;c<i-2;c+=2){try{const h=Zn(n[c+2],s.type,t);a[c]=h}catch(h){throw new Error(`failed to parse argument ${c+1} of match expression: ${h.message}`)}try{const h=Zn(n[c+3],o.type,t);a[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+2} of match expression: ${h.message}`)}}return[s,...a,o]}function BV(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const c=i[1];if(typeof c!="number"||c<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(c)} instead`);r=c;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Tn(ut,r);let o;try{o=Zn(n[2],ut,t)}catch(c){throw new Error(`failed to parse argument 1 in interpolate expression: ${c.message}`)}const a=new Array(n.length-3);for(let c=0;c<a.length;c+=2){try{const h=Zn(n[c+3],ut,t);a[c]=h}catch(h){throw new Error(`failed to parse argument ${c+2} for interpolate expression: ${h.message}`)}try{const h=Zn(n[c+4],e,t);a[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+3} for interpolate expression: ${h.message}`)}}return[s,o,...a]}function zV(n,e,t){const i=Zn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Zn(n[s+1],vi,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Zn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function $V(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Oi}else r=ut;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const c=Zn(i[a],r,t);s[a]=c}catch(c){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${c.message}`)}return[Zn(n[1],r,t),...s]}function WV(n,e,t){let i;try{i=Zn(n[1],ut,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Zn(r[o],qr,t)}catch(c){throw new Error(`failed to parse color at index ${o} in palette expression: ${c.message}`)}if(!(a instanceof Tn))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function Ke(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const a=n[o](e,t,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new OV(t,r,...s)}}function HV(n,e,t){const i=n[0],r=DV[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function Gk(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Gk(n.getGeometries()[0]);default:return""}}function Uk(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Do(n,e,t){const i=Zn(n,e,t);return ts(i)}function ts(n,e){if(n instanceof Tn){if(n.type===qr&&typeof n.value=="string"){const i=Bx(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case ce.Number:case ce.String:case ce.Coalesce:return KV(n);case ce.Get:case ce.Var:case ce.Has:return qV(n);case ce.Id:return i=>i.featureId;case ce.GeometryType:return i=>i.geometryType;case ce.Concat:{const i=n.args.map(r=>ts(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case ce.Resolution:return i=>i.resolution;case ce.Any:case ce.All:case ce.Between:case ce.In:case ce.Not:return XV(n);case ce.Equal:case ce.NotEqual:case ce.LessThan:case ce.LessThanOrEqualTo:case ce.GreaterThan:case ce.GreaterThanOrEqualTo:return YV(n);case ce.Multiply:case ce.Divide:case ce.Add:case ce.Subtract:case ce.Clamp:case ce.Mod:case ce.Pow:case ce.Abs:case ce.Floor:case ce.Ceil:case ce.Round:case ce.Sin:case ce.Cos:case ce.Atan:case ce.Sqrt:return QV(n);case ce.Case:return ZV(n);case ce.Match:return JV(n);case ce.Interpolate:return eF(n);case ce.ToString:return tF(n);default:throw new Error(`Unsupported operator ${t}`)}}function KV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ts(n.args[s]);switch(t){case ce.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case ce.Number:case ce.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function qV(n,e){const i=n.args[0].value;switch(n.operator){case ce.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,c=s.length;a<c;++a){const d=s[a].value;o=o[d]}return o};case ce.Var:return r=>r.variables[i];case ce.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,c=s.length;a<c;++a){const d=s[a].value;if(!o||!Object.hasOwn(o,d))return!1;o=o[d]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function YV(n,e){const t=n.operator,i=ts(n.args[0]),r=ts(n.args[1]);switch(t){case ce.Equal:return s=>i(s)===r(s);case ce.NotEqual:return s=>i(s)!==r(s);case ce.LessThan:return s=>i(s)<r(s);case ce.LessThanOrEqualTo:return s=>i(s)<=r(s);case ce.GreaterThan:return s=>i(s)>r(s);case ce.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function XV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ts(n.args[s]);switch(t){case ce.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case ce.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case ce.Between:return s=>{const o=r[0](s),a=r[1](s),c=r[2](s);return o>=a&&o<=c};case ce.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case ce.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function QV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ts(n.args[s]);switch(t){case ce.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case ce.Divide:return s=>r[0](s)/r[1](s);case ce.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case ce.Subtract:return s=>r[0](s)-r[1](s);case ce.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const c=r[2](s);return o>c?c:o};case ce.Mod:return s=>r[0](s)%r[1](s);case ce.Pow:return s=>Math.pow(r[0](s),r[1](s));case ce.Abs:return s=>Math.abs(r[0](s));case ce.Floor:return s=>Math.floor(r[0](s));case ce.Ceil:return s=>Math.ceil(r[0](s));case ce.Round:return s=>Math.round(r[0](s));case ce.Sin:return s=>Math.sin(r[0](s));case ce.Cos:return s=>Math.cos(r[0](s));case ce.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case ce.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function ZV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=ts(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function JV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=ts(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function eF(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=ts(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,c;for(let h=2;h<t;h+=2){const d=i[h](r);let g=i[h+1](r);const m=Array.isArray(g);if(m&&(g=R8(g)),d>=o)return h===2?g:m?nF(s,o,a,c,d,g):pf(s,o,a,c,d,g);a=d,c=g}return c}}function tF(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=ts(n.args[s]);switch(t){case ce.ToString:return s=>{const o=r[0](s);return n.args[0].type===qr?zx(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function pf(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const a=e-t,c=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+c*(s-i)}function nF(n,e,t,i,r,s){if(r-t===0)return i;const a=zR(i),c=zR(s);let h=c[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const d=[pf(n,e,t,a[0],r,c[0]),pf(n,e,t,a[1],r,c[1]),a[2]+pf(n,e,t,0,r,h),pf(n,e,t,i[3],r,s[3])];return A8(d)}function iF(n){return!0}function rF(n){const e=jk(),t=sF(n,e),i=Uk();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Gk(r.getGeometry())),t(i)}}function fA(n){const e=jk(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=iw(n[o],e);const r=Uk(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let c=0;for(let h=0;h<t;++h){const d=i[h](r);d&&(s[c]=d,c+=1)}return s.length=c,s}}function sF(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Do(s.filter,vi,e):iF;let a;if(Array.isArray(s.style)){const c=s.style.length;a=new Array(c);for(let h=0;h<c;++h)a[h]=iw(s.style[h],e)}else a=[iw(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const c=i[a].filter;if(c(r)&&!(n[a].else&&o)){o=!0;for(const h of i[a].styles){const d=h(r);d&&s.push(d)}}}return s}}function iw(n,e){const t=og(n,"",e),i=ag(n,"",e),r=oF(n,e),s=aF(n,e),o=Di(n,"z-index",e);if(!t&&!i&&!r&&!s&&!gc(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Ii;return function(c){let h=!0;if(t){const d=t(c);d&&(h=!1),a.setFill(d)}if(i){const d=i(c);d&&(h=!1),a.setStroke(d)}if(r){const d=r(c);d&&(h=!1),a.setText(d)}if(s){const d=s(c);d&&(h=!1),a.setImage(d)}return o&&a.setZIndex(o(c)),h?null:a}}function og(n,e,t){let i;if(e+"fill-pattern-src"in n)i=hF(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=Qx(n,e+"fill-color",t)}if(!i)return null;const r=new es;return function(s){const o=i(s);return o===Ux?null:(r.setColor(o),r)}}function ag(n,e,t){const i=Di(n,e+"stroke-width",t),r=Qx(n,e+"stroke-color",t);if(!i&&!r)return null;const s=yo(n,e+"stroke-line-cap",t),o=yo(n,e+"stroke-line-join",t),a=Bk(n,e+"stroke-line-dash",t),c=Di(n,e+"stroke-line-dash-offset",t),h=Di(n,e+"stroke-miter-limit",t),d=new Ro;return function(g){if(r){const m=r(g);if(m===Ux)return null;d.setColor(m)}if(i&&d.setWidth(i(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");d.setLineCap(m)}if(o){const m=o(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");d.setLineJoin(m)}return a&&d.setLineDash(a(g)),c&&d.setLineDashOffset(c(g)),h&&d.setMiterLimit(h(g)),d}}function oF(n,e){const t="text-",i=yo(n,t+"value",e);if(!i)return null;const r=og(n,t,e),s=og(n,t+"background-",e),o=ag(n,t,e),a=ag(n,t+"background-",e),c=yo(n,t+"font",e),h=Di(n,t+"max-angle",e),d=Di(n,t+"offset-x",e),g=Di(n,t+"offset-y",e),m=ph(n,t+"overflow",e),y=yo(n,t+"placement",e),w=Di(n,t+"repeat",e),I=hy(n,t+"scale",e),E=ph(n,t+"rotate-with-view",e),A=Di(n,t+"rotation",e),b=yo(n,t+"align",e),N=yo(n,t+"justify",e),D=yo(n,t+"baseline",e),O=ph(n,t+"keep-upright",e),$=Bk(n,t+"padding",e),k=dy(n,t+"declutter-mode"),C=new uy({declutterMode:k});return function(L){if(C.setText(i(L)),r&&C.setFill(r(L)),s&&C.setBackgroundFill(s(L)),o&&C.setStroke(o(L)),a&&C.setBackgroundStroke(a(L)),c&&C.setFont(c(L)),h&&C.setMaxAngle(h(L)),d&&C.setOffsetX(d(L)),g&&C.setOffsetY(g(L)),m&&C.setOverflow(m(L)),y){const j=y(L);if(j!=="point"&&j!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(j)}if(w&&C.setRepeat(w(L)),I&&C.setScale(I(L)),E&&C.setRotateWithView(E(L)),A&&C.setRotation(A(L)),b){const j=b(L);if(j!=="left"&&j!=="center"&&j!=="right"&&j!=="end"&&j!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(j)}if(N){const j=N(L);if(j!=="left"&&j!=="right"&&j!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(j)}if(D){const j=D(L);if(j!=="bottom"&&j!=="top"&&j!=="middle"&&j!=="alphabetic"&&j!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(j)}return $&&C.setPadding($(L)),O&&C.setKeepUpright(O(L)),C}}function aF(n,e){return"icon-src"in n?lF(n,e):"shape-points"in n?cF(n,e):"circle-radius"in n?uF(n,e):null}function lF(n,e){const t="icon-",i=t+"src",r=zk(n[i],i),s=Q0(n,t+"anchor",e),o=hy(n,t+"scale",e),a=Di(n,t+"opacity",e),c=Q0(n,t+"displacement",e),h=Di(n,t+"rotation",e),d=ph(n,t+"rotate-with-view",e),g=mA(n,t+"anchor-origin"),m=pA(n,t+"anchor-x-units"),y=pA(n,t+"anchor-y-units"),w=mF(n,t+"color"),I=fF(n,t+"cross-origin"),E=gF(n,t+"offset"),A=mA(n,t+"offset-origin"),b=Z0(n,t+"width"),N=Z0(n,t+"height"),D=dF(n,t+"size"),O=dy(n,t+"declutter-mode"),$=new X0({src:r,anchorOrigin:g,anchorXUnits:m,anchorYUnits:y,color:w,crossOrigin:I,offset:E,offsetOrigin:A,height:N,width:b,size:D,declutterMode:O});return function(k){return a&&$.setOpacity(a(k)),c&&$.setDisplacement(c(k)),h&&$.setRotation(h(k)),d&&$.setRotateWithView(d(k)),o&&$.setScale(o(k)),s&&$.setAnchor(s(k)),$}}function cF(n,e){const t="shape-",i=t+"points",r=t+"radius",s=rw(n[i],i),o=rw(n[r],r),a=og(n,t,e),c=ag(n,t,e),h=hy(n,t+"scale",e),d=Q0(n,t+"displacement",e),g=Di(n,t+"rotation",e),m=ph(n,t+"rotate-with-view",e),y=Z0(n,t+"radius2"),w=Z0(n,t+"angle"),I=dy(n,t+"declutter-mode"),E=new cy({points:s,radius:o,radius2:y,angle:w,declutterMode:I});return function(A){return a&&E.setFill(a(A)),c&&E.setStroke(c(A)),d&&E.setDisplacement(d(A)),g&&E.setRotation(g(A)),m&&E.setRotateWithView(m(A)),h&&E.setScale(h(A)),E}}function uF(n,e){const t="circle-",i=og(n,t,e),r=ag(n,t,e),s=Di(n,t+"radius",e),o=hy(n,t+"scale",e),a=Q0(n,t+"displacement",e),c=Di(n,t+"rotation",e),h=ph(n,t+"rotate-with-view",e),d=dy(n,t+"declutter-mode"),g=new Gc({radius:5,declutterMode:d});return function(m){return s&&g.setRadius(s(m)),i&&g.setFill(i(m)),r&&g.setStroke(r(m)),a&&g.setDisplacement(a(m)),c&&g.setRotation(c(m)),h&&g.setRotateWithView(h(m)),o&&g.setScale(o(m)),g}}function Di(n,e,t){if(!(e in n))return;const i=Do(n[e],ut,t);return function(r){return rw(i(r),e)}}function yo(n,e,t){if(!(e in n))return null;const i=Do(n[e],Oi,t);return function(r){return zk(i(r),e)}}function hF(n,e,t){const i=yo(n,e+"pattern-src",t),r=gA(n,e+"pattern-offset",t),s=gA(n,e+"pattern-size",t),o=Qx(n,e+"color",t);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function ph(n,e,t){if(!(e in n))return null;const i=Do(n[e],vi,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Qx(n,e,t){if(!(e in n))return null;const i=Do(n[e],qr,t);return function(r){return $k(i(r),e)}}function Bk(n,e,t){if(!(e in n))return null;const i=Do(n[e],Ec,t);return function(r){return qg(i(r),e)}}function Q0(n,e,t){if(!(e in n))return null;const i=Do(n[e],Ec,t);return function(r){const s=qg(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function gA(n,e,t){if(!(e in n))return null;const i=Do(n[e],Ec,t);return function(r){return Wk(i(r),e)}}function hy(n,e,t){if(!(e in n))return null;const i=Do(n[e],Ec|ut,t);return function(r){return pF(i(r),e)}}function Z0(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function dF(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Fi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function fF(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function mA(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function pA(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function gF(n,e){const t=n[e];if(t!==void 0)return qg(t,e)}function dy(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function mF(n,e){const t=n[e];if(t!==void 0)return $k(t,e)}function qg(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function zk(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function rw(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function $k(n,e){if(typeof n=="string")return n;const t=qg(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function Wk(n,e){const t=qg(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function pF(n,e){return typeof n=="number"?n:Wk(n,e)}const $r={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function _A(n,e,t){return(function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const c=e?0:s[0]*r,h=e?0:s[1]*r,d=a?a[0]:0,g=a?a[1]:0;let m=n[0]+c/2+d,y=n[2]-c/2+d,w=n[1]+h/2+g,I=n[3]-h/2+g;m>y&&(m=(y+m)/2,y=m),w>I&&(w=(I+w)/2,I=w);let E=Bt(i[0],m,y),A=Bt(i[1],w,I);if(o&&t&&r){const b=30*r;E+=-b*Math.log(1+Math.max(0,m-i[0])/b)+b*Math.log(1+Math.max(0,i[0]-y)/b),A+=-b*Math.log(1+Math.max(0,w-i[1])/b)+b*Math.log(1+Math.max(0,i[1]-I)/b)}return[E,A]})}function _F(n){return n}function Hk(n){return Math.pow(n,3)}function Jh(n){return 1-Hk(1-n)}function yF(n){return 3*n*n-2*n*n*n}function vF(n){return n}function Zx(n,e,t,i){const r=ot(e)/t[0],s=vn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Jx(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Bt(i,t/2,e*2)}function EF(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,a){if(r!==void 0){const c=n[0],h=n[n.length-1],d=t?Zx(c,t,o,i):c;if(a)return e?Jx(r,d,h):Bt(r,h,d);const g=Math.min(d,r),m=Math.floor(q_(n,g,s));return n[m]>d&&m<n.length-1?n[m+1]:n[m]}})}function wF(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,a,c,h){if(o!==void 0){const d=r?Zx(e,r,c,s):e;if(h)return i?Jx(o,d,t):Bt(o,t,d);const g=1e-9,m=Math.ceil(Math.log(e/d)/Math.log(n)-g),y=-a*(.5-g)+.5,w=Math.min(d,o),I=Math.floor(Math.log(e/w)/Math.log(n)+y),E=Math.max(m,I),A=e/Math.pow(n,E);return Bt(A,t,d)}})}function yA(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,a,c){if(s!==void 0){const h=i?Zx(n,i,a,r):n;return!t||!c?Bt(s,e,h):Jx(s,h,e)}})}function eS(n){if(n!==void 0)return 0}function vA(n){if(n!==void 0)return n}function xF(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function SF(n){const e=Da(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const IF=42,tS=256,K1=0;class Rs extends Hs{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Mx(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&ek(),e.center&&(e.center=_o(e.center,this.projection_)),e.extent&&(e.extent=As(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in $r)delete t[a];this.setProperties(t,!0);const i=RF(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=TF(e),s=i.constraint,o=AF(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=_o(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=_o(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const d=arguments[r];d.center&&this.setCenterInternal(d.center),d.zoom!==void 0?this.setZoom(d.zoom):d.resolution&&this.setResolution(d.resolution),d.rotation!==void 0&&this.setRotation(d.rotation)}if(r===t){i&&Gp(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,c=this.targetRotation_;const h=[];for(;r<t;++r){const d=arguments[r],g={start:s,complete:!1,anchor:d.anchor,duration:d.duration!==void 0?d.duration:1e3,easing:d.easing||yF,callback:i};if(d.center&&(g.sourceCenter=o,g.targetCenter=d.center.slice(),o=g.targetCenter),d.zoom!==void 0?(g.sourceResolution=a,g.targetResolution=this.getResolutionForZoom(d.zoom),a=g.targetResolution):d.resolution&&(g.sourceResolution=a,g.targetResolution=d.resolution,a=g.targetResolution),d.rotation!==void 0){g.sourceRotation=c;const m=Va(d.rotation-c+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=c+m,c=g.targetRotation}PF(g)?g.complete=!0:s+=g.duration,h.push(g)}this.animations_.push(h),this.setHint(Fn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Fn.ANIMATING]>0}getInteracting(){return this.hints_[Fn.INTERACTING]>0}cancelAnimations(){this.setHint(Fn.ANIMATING,-this.hints_[Fn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Gp(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const c=r[o];if(c.complete)continue;const h=e-c.start;let d=c.duration>0?h/c.duration:1;d>=1?(c.complete=!0,d=1):s=!1;const g=c.easing(d);if(c.sourceCenter){const m=c.sourceCenter[0],y=c.sourceCenter[1],w=c.targetCenter[0],I=c.targetCenter[1];this.nextCenter_=c.targetCenter;const E=m+g*(w-m),A=y+g*(I-y);this.targetCenter_=[E,A]}if(c.sourceResolution&&c.targetResolution){const m=g===1?c.targetResolution:c.sourceResolution+g*(c.targetResolution-c.sourceResolution);if(c.anchor){const y=this.getViewportSize_(this.getRotation()),w=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(w,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const m=g===1?Va(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+g*(c.targetRotation-c.sourceRotation);if(c.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!c.complete)break}if(s){this.animations_[i]=null,this.setHint(Fn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Gp(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Ax(i,e-this.getRotation()),v6(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&YE(e,this.getProjection())}getCenterInternal(){return this.get($r.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return tk(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();St(t,"The view center is not defined");const i=this.getResolution();St(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return St(r!==void 0,"The view rotation is not defined"),N0(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get($r.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(As(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ot(e)/t[0],r=vn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get($r.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=q1(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=q_(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Bt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Bt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(St(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){St(!Zh(e),"Cannot fit empty extent provided as `geometry`");const r=As(e,this.getProjection());i=QR(r)}else if(e.getType()==="Circle"){const r=As(e.getExtent(),this.getProjection());i=QR(r),i.rotate(this.getRotation(),js(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,c=1/0,h=-1/0,d=-1/0;for(let g=0,m=s.length;g<m;g+=o){const y=s[g]*i-s[g+1]*r,w=s[g]*r+s[g+1]*i;a=Math.min(a,y),c=Math.min(c,w),h=Math.max(h,y),d=Math.max(d,w)}return[a,c,h,d]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let c=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);c=isNaN(c)?o:Math.max(c,o),c=this.getConstrainedResolution(c,s?0:1);const h=this.getRotation(),d=Math.sin(h),g=Math.cos(h),m=js(a);m[0]+=(r[1]-r[3])/2*c,m[1]+=(r[0]-r[2])/2*c;const y=m[0]*g-m[1]*d,w=m[1]*g+m[0]*d,I=this.getConstrainedCenter([y,w],c),E=t.callback?t.callback:Qf;t.duration!==void 0?this.animateInternal({resolution:c,center:I,duration:t.duration,easing:t.easing},E):(this.targetResolution_=c,this.targetCenter_=I,this.applyTargetState_(!1,!0),Gp(E,!0))}centerOn(e,t,i){this.centerOnInternal(_o(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(q1(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),c=q1(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-c[0],e[1]-c[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=YE(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&_o(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=_o(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&_o(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get($r.ROTATION)!==r&&this.set($r.ROTATION,r),this.get($r.RESOLUTION)!==o&&(this.set($r.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get($r.CENTER)||!D0(this.get($r.CENTER),a))&&this.set($r.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),c=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=c,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!D0(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:c,resolution:a,duration:e,easing:Jh,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Fn.INTERACTING,1)}endInteraction(e,t,i){i=i&&_o(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Fn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Gp(n,e){setTimeout(function(){n(e)},0)}function TF(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return _A(n.extent,n.constrainOnlyCenter,t)}const e=Mx(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,_A(t,!1,!1)}return _F}function RF(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:K1,a=n.maxZoom!==void 0?n.maxZoom:28;const c=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,d=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=Mx(n.projection,"EPSG:3857"),y=m.getExtent();let w=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&m.isGlobal()&&(w=!1,I=y),n.resolutions!==void 0){const E=n.resolutions;t=E[o],i=E[a]!==void 0?E[a]:E[E.length-1],n.constrainResolution?e=EF(E,d,!w&&I,g):e=yA(t,i,d,!w&&I,g)}else{const A=(y?Math.max(ot(y),vn(y)):360*Ph.degrees/m.getMetersPerUnit())/tS/Math.pow(2,K1),b=A/Math.pow(2,28-K1);t=n.maxResolution,t!==void 0?o=0:t=A/Math.pow(c,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(c,a):i=A/Math.pow(c,a):i=b),a=o+Math.floor(Math.log(t/i)/Math.log(c)),i=t/Math.pow(c,a-o),n.constrainResolution?e=wF(c,t,i,d,!w&&I,g):e=yA(t,i,d,!w&&I,g)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:c}}function AF(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?SF():t===!1?vA:typeof t=="number"?xF(t):vA}return eS}function PF(n){return!(n.sourceCenter&&n.targetCenter&&!D0(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function q1(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,c=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,c+=(t[1]-e[1]/2)*i,o=-o;const h=a*s-c*o,d=c*s+a*o;return[h,d]}const Rt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Kk extends Hs{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Rt.OPACITY]=e.opacity!==void 0?e.opacity:1,St(typeof t[Rt.OPACITY]=="number","Layer opacity must be a number"),t[Rt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Rt.Z_INDEX]=e.zIndex,t[Rt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Rt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Rt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Rt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Bt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return qe()}getLayerStatesArray(e){return qe()}getExtent(){return this.get(Rt.EXTENT)}getMaxResolution(){return this.get(Rt.MAX_RESOLUTION)}getMinResolution(){return this.get(Rt.MIN_RESOLUTION)}getMinZoom(){return this.get(Rt.MIN_ZOOM)}getMaxZoom(){return this.get(Rt.MAX_ZOOM)}getOpacity(){return this.get(Rt.OPACITY)}getSourceState(){return qe()}getVisible(){return this.get(Rt.VISIBLE)}getZIndex(){return this.get(Rt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Rt.EXTENT,e)}setMaxResolution(e){this.set(Rt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Rt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Rt.MAX_ZOOM,e)}setMinZoom(e){this.set(Rt.MIN_ZOOM,e)}setOpacity(e){St(typeof e=="number","Layer opacity must be a number"),this.set(Rt.OPACITY,e)}setVisible(e){this.set(Rt.VISIBLE,e)}setZIndex(e){this.set(Rt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Yg extends Kk{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Rt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Rt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Dt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=ft(e,Qe.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Rs?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return nS(r,t.viewState)&&(!s||Ei(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Rs?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Rt.MAP,e)}getMapInternal(){return this.get(Rt.MAP)}setMap(e){this.mapPrecomposeKey_&&(Dt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Dt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=ft(e,Pr.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=ft(this,Qe.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);St(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(Rt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function nS(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const EA={RENDER_ORDER:"renderOrder"};class qk extends Yg{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(EA.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new Lk(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(EA.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Nk:e;const t=CF(e);this.styleFunction_=e===null?void 0:hV(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function CF(n){if(n===void 0)return Nk;if(!n)return null;if(typeof n=="function"||n instanceof Ii)return n;if(!Array.isArray(n))return fA([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Ii){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Ii))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return rF(r)}return fA(n)}class fy extends qk{constructor(e){super(e)}createRenderer(){return new kV(this)}}const fa={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class xa extends Ws{constructor(e,t){super(e),this.layer=t}}const Y1={LAYERS:"layers"};let gy=class Yk extends Kk{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Y1.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Ar(i.slice(),{unique:!0}):St(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Ar(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Dt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(ft(e,Li.ADD,this.handleLayersAdd_,this),ft(e,Li.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Dt);Fg(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new xa(fa.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[ft(e,Rh.PROPERTYCHANGE,this.handleLayerChange_,this),ft(e,Qe.CHANGE,this.handleLayerChange_,this)];e instanceof Yk&&t.push(ft(e,fa.ADDLAYER,this.handleLayerGroupAdd_,this),ft(e,fa.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[pt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new xa(fa.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new xa(fa.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new xa(fa.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=pt(t);this.listenerKeys_[i].forEach(Dt),delete this.listenerKeys_[i],this.dispatchEvent(new xa(fa.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(Y1.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new xa(fa.REMOVELAYER,i[r]))}this.set(Y1.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const c=t[o];c.opacity*=r.opacity,c.visible=c.visible&&r.visible,c.maxResolution=Math.min(c.maxResolution,r.maxResolution),c.minResolution=Math.max(c.minResolution,r.minResolution),c.minZoom=Math.max(c.minZoom,r.minZoom),c.maxZoom=Math.min(c.maxZoom,r.maxZoom),r.extent!==void 0&&(c.extent!==void 0?c.extent=So(c.extent,r.extent):c.extent=r.extent),c.zIndex===void 0&&(c.zIndex=s)}return t}getSourceState(){return"ready"}};const Be={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class iS extends jg{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Qe.CHANGE)}release(){this.setState(Be.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Be.EMPTY){if(this.state!==Be.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){qe()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:Hk(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function sw(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const bF=new Error("disposed"),MF=[256,256];class wA extends iS{constructor(e){const t=Be.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=sw(this.data_);return e?[e.width,e.height]:MF}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Be.IDLE&&this.state!==Be.ERROR)return;this.state=Be.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Be.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Be.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(bF),this.controller_=null),super.disposeInternal()}}class Xk extends iS{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,er?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Be.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Be.ERROR,this.unlistenImage_(),this.image_=kF(),this.changed()}handleImageLoad_(){if(er)this.state=Be.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Be.LOADED:this.state=Be.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Be.ERROR&&(this.state=Be.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Be.IDLE&&(this.state=Be.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=P8(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function kF(){const n=Pn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let X1;const _h=[];function xA(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function Q1(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function LF(){if(X1===void 0){const n=Pn(6,6,_h);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",xA(n,4,5,4,0),xA(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;X1=Q1(e,0)||Q1(e,4)||Q1(e,8),sy(n),_h.push(n.canvas)}return X1}function J0(n,e,t,i){const r=$g(t,e,n);let s=G0(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const c=n.getExtent();if(!c||pc(c,r)){const h=G0(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function NF(n,e,t,i){const r=js(t);let s=J0(n,e,r,i);return(!isFinite(s)||s<=0)&&UM(t,function(o){return s=J0(n,e,o,i),isFinite(s)&&s>0}),s}function Qk(n,e,t,i,r,s,o,a,c,h,d,g,m,y){const w=Pn(Math.round(t*n),Math.round(t*e),_h);if(g||(w.imageSmoothingEnabled=!1),c.length===0)return w.canvas;w.scale(t,t);function I(O){return Math.round(O*t)/t}w.globalCompositeOperation="lighter";const E=ir();c.forEach(function(O,$,k){jM(E,O.extent)});let A;const b=t/i,N=(g?1:1+Math.pow(2,-24))/b;(!m||c.length!==1||h!==0)&&(A=Pn(Math.round(ot(E)*b),Math.round(vn(E)*b),_h),g||(A.imageSmoothingEnabled=!1),c.forEach(function(O,$,k){if(O.image.width>0&&O.image.height>0){if(O.clipExtent){A.save();const z=(O.clipExtent[0]-E[0])*b,V=-(O.clipExtent[3]-E[3])*b,de=ot(O.clipExtent)*b,Pe=vn(O.clipExtent)*b;A.rect(g?z:Math.round(z),g?V:Math.round(V),g?de:Math.round(z+de)-Math.round(z),g?Pe:Math.round(V+Pe)-Math.round(V)),A.clip()}const C=(O.extent[0]-E[0])*b,L=-(O.extent[3]-E[3])*b,j=ot(O.extent)*b,G=vn(O.extent)*b;A.drawImage(O.image,h,h,O.image.width-2*h,O.image.height-2*h,g?C:Math.round(C),g?L:Math.round(L),g?j:Math.round(C+j)-Math.round(C),g?G:Math.round(L+G)-Math.round(L)),O.clipExtent&&A.restore()}}));const D=Vc(o);return a.getTriangles().forEach(function(O,$,k){const C=O.source,L=O.target;let j=C[0][0],G=C[0][1],z=C[1][0],V=C[1][1],de=C[2][0],Pe=C[2][1];const ue=I((L[0][0]-D[0])/s),fe=I(-(L[0][1]-D[1])/s),Q=I((L[1][0]-D[0])/s),ge=I(-(L[1][1]-D[1])/s),he=I((L[2][0]-D[0])/s),K=I(-(L[2][1]-D[1])/s),W=j,be=G;j=0,G=0,z-=W,V-=be,de-=W,Pe-=be;const ie=[[z,V,0,0,Q-ue],[de,Pe,0,0,he-ue],[0,0,z,V,ge-fe],[0,0,de,Pe,K-fe]],X=y6(ie);if(!X)return;if(w.save(),w.beginPath(),LF()||!g){w.moveTo(Q,ge);const Ee=4,Y=ue-Q,Ie=fe-ge;for(let Z=0;Z<Ee;Z++)w.lineTo(Q+I((Z+1)*Y/Ee),ge+I(Z*Ie/(Ee-1))),Z!=Ee-1&&w.lineTo(Q+I((Z+1)*Y/Ee),ge+I((Z+1)*Ie/(Ee-1)));w.lineTo(he,K)}else w.moveTo(Q,ge),w.lineTo(ue,fe),w.lineTo(he,K);w.clip(),w.transform(X[0],X[2],X[1],X[3],ue,fe),w.translate(E[0]-W,E[3]-be);let P;if(A)P=A.canvas,w.scale(N,-N);else{const Ee=c[0],Y=Ee.extent;P=Ee.image,w.scale(ot(Y)/P.width,-vn(Y)/P.height)}w.drawImage(P,0,0),w.restore()}),A&&(sy(A),_h.push(A.canvas)),d&&(w.save(),w.globalCompositeOperation="source-over",w.strokeStyle="black",w.lineWidth=1,a.getTriangles().forEach(function(O,$,k){const C=O.target,L=(C[0][0]-D[0])/s,j=-(C[0][1]-D[1])/s,G=(C[1][0]-D[0])/s,z=-(C[1][1]-D[1])/s,V=(C[2][0]-D[0])/s,de=-(C[2][1]-D[1])/s;w.beginPath(),w.moveTo(G,z),w.lineTo(L,j),w.lineTo(V,de),w.closePath(),w.stroke()}),w.restore()),w.canvas}const OF=10,SA=.25;class Zk{constructor(e,t,i,r,s,o,a){this.sourceProj_=e,this.targetProj_=t;let c={};const h=a?qE(N=>Rn(a,$g(N,this.targetProj_,this.sourceProj_))):Jf(this.targetProj_,this.sourceProj_);this.transformInv_=function(N){const D=N[0]+"/"+N[1];return c[D]||(c[D]=h(N)),c[D]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ot(r)>=ot(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ot(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ot(this.targetProj_.getExtent()):null;const d=Vc(i),g=Z_(i),m=Q_(i),y=X_(i),w=this.transformInv_(d),I=this.transformInv_(g),E=this.transformInv_(m),A=this.transformInv_(y),b=OF+(o?Math.max(0,Math.ceil(Math.log2(zE(i)/(o*o*256*256)))):0);if(this.addQuad_(d,g,m,y,w,I,E,A,b),this.wrapsXInSource_){let N=1/0;this.triangles_.forEach(function(D,O,$){N=Math.min(N,D.source[0][0],D.source[1][0],D.source[2][0])}),this.triangles_.forEach(D=>{if(Math.max(D.source[0][0],D.source[1][0],D.source[2][0])-N>this.sourceWorldWidth_/2){const O=[[D.source[0][0],D.source[0][1]],[D.source[1][0],D.source[1][1]],[D.source[2][0],D.source[2][1]]];O[0][0]-N>this.sourceWorldWidth_/2&&(O[0][0]-=this.sourceWorldWidth_),O[1][0]-N>this.sourceWorldWidth_/2&&(O[1][0]-=this.sourceWorldWidth_),O[2][0]-N>this.sourceWorldWidth_/2&&(O[2][0]-=this.sourceWorldWidth_);const $=Math.min(O[0][0],O[1][0],O[2][0]);Math.max(O[0][0],O[1][0],O[2][0])-$<this.sourceWorldWidth_/2&&(D.source=O)}})}c={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,c,h){const d=PR([s,o,a,c]),g=this.sourceWorldWidth_?ot(d)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&g>.5&&g<1;let w=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=PR([e,t,i,r]);w=ot(E)/this.targetWorldWidth_>SA||w}!y&&this.sourceProj_.isGlobal()&&g&&(w=g>SA||w)}if(!w&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!Ei(d,this.maxSourceExtent_))return;let I=0;if(!w&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(c[0])||!isFinite(c[1]))){if(h>0)w=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!w){const E=[(e[0]+i[0])/2,(e[1]+i[1])/2],A=this.transformInv_(E);let b;y?b=(Va(s[0],m)+Va(a[0],m))/2-Va(A[0],m):b=(s[0]+a[0])/2-A[0];const N=(s[1]+a[1])/2-A[1];w=b*b+N*N>this.errorThresholdSquared_}if(w){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const E=[(t[0]+i[0])/2,(t[1]+i[1])/2],A=this.transformInv_(E),b=[(r[0]+e[0])/2,(r[1]+e[1])/2],N=this.transformInv_(b);this.addQuad_(e,t,E,b,s,o,A,N,h-1),this.addQuad_(b,E,i,r,N,A,a,c,h-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],A=this.transformInv_(E),b=[(i[0]+r[0])/2,(i[1]+r[1])/2],N=this.transformInv_(b);this.addQuad_(e,E,b,r,s,A,N,c,h-1),this.addQuad_(E,t,i,b,A,o,a,N,h-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,a,c),(I&14)==0&&this.addTriangle_(e,i,t,s,a,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,c,s),(I&7)==0&&this.addTriangle_(t,r,i,o,c,a))}calculateSourceExtent(){const e=ir();return this.triangles_.forEach(function(t,i,r){const s=t.source;Pf(e,s[0]),Pf(e,s[1]),Pf(e,s[2])}),e}getTriangles(){return this.triangles_}}const Jk=.5;class e4 extends iS{constructor(e,t,i,r,s,o,a,c,h,d,g,m){super(s,Be.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=a,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=r.getTileCoordExtent(this.wrappedTileCoord_),w=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const E=w?So(y,w):y;if(zE(E)===0){this.state=Be.EMPTY;return}const A=e.getExtent();A&&(I?I=So(I,A):I=A);const b=r.getResolution(this.wrappedTileCoord_[0]),N=NF(e,i,E,b);if(!isFinite(N)||N<=0){this.state=Be.EMPTY;return}const D=d!==void 0?d:Jk;if(this.triangulation_=new Zk(e,i,E,I,N*D,b),this.triangulation_.getTriangles().length===0){this.state=Be.EMPTY;return}this.sourceZ_=t.getZForResolution(N);let O=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(O[1]=Bt(O[1],I[1],I[3]),O[3]=Bt(O[3],I[1],I[3])):O=So(O,I)),!zE(O))this.state=Be.EMPTY;else{let $=0,k=0;e.canWrapX()&&($=ot(A),k=Math.floor((O[0]-A[0])/$)),$M(O.slice(),e,!0).forEach(L=>{const j=t.getTileRangeForExtentAndZ(L,this.sourceZ_);for(let G=j.minX;G<=j.maxX;G++)for(let z=j.minY;z<=j.maxY;z++){const V=h(this.sourceZ_,G,z,a);if(V){const de=k*$;this.sourceTiles_.push({tile:V,offset:de})}}++k}),this.sourceTiles_.length===0&&(this.state=Be.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Be.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Be.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Qk(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,c,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Be.LOADED}this.changed()}load(){if(this.state==Be.IDLE){this.state=Be.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Be.IDLE||i==Be.LOADING){e++;const r=ft(t,Qe.CHANGE,s=>{const o=t.getState();(o==Be.LOADED||o==Be.ERROR||o==Be.EMPTY)&&(Dt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Be.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Dt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(sy(this.canvas_.getContext("2d")),_h.push(this.canvas_),this.canvas_=null),super.release()}}class rS{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ou(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new rS(n,e,t,i)}class IA{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof K_&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return St(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return St(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){St(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function e_(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function DF(n,e,t){return n+"/"+e+"/"+t}function c0(n,e,t,i,r){return`${pt(n)},${e},${DF(t,i,r)}`}function t4(n){return VF(n[0],n[1],n[2])}function VF(n,e,t){return(e<<n)+t}function FF(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}class jF extends Yx{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],i=e.pixelRatio,r=e.viewState,s=r.resolution,o=this.getLayer().getSource(),a=e.viewHints;let c=e.extent;if(t.extent!==void 0&&(c=So(c,As(t.extent,r.projection))),!a[Fn.ANIMATING]&&!a[Fn.INTERACTING]&&!Zh(c))if(o){const h=r.projection,d=o.getImage(c,s,i,h);d&&(this.loadImage(d)?this.image=d:d.getState()===Ve.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Rn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!pc(s,r))return null;const o=this.image.getExtent(),a=this.image.getImage(),c=ot(o),h=Math.floor(a.width*((r[0]-o[0])/c));if(h<0||h>=a.width)return null;const d=vn(o),g=Math.floor(a.height*((o[3]-r[1])/d));return g<0||g>=a.height?null:this.getImageData(a,h,g)}renderFrame(e,t){const i=this.image,r=i.getExtent(),s=i.getResolution(),[o,a]=Array.isArray(s)?s:[s,s],c=i.getPixelRatio(),h=e.layerStatesArray[e.layerIndex],d=e.pixelRatio,g=e.viewState,m=g.center,y=g.resolution,w=d*o/(y*c),I=d*a/(y*c);this.prepareContainer(e,t);const E=this.context.canvas.width,A=this.context.canvas.height,b=this.getRenderContext(e);let N=!1,D=!0;if(h.extent){const L=As(h.extent,g.projection);D=Ei(L,e.extent),N=D&&!Pa(L,e.extent),N&&this.clipUnrotated(b,e,L)}const O=i.getImage(),$=Gs(this.tempTransform,E/2,A/2,w,I,0,c*(r[0]-m[0])/o,c*(m[1]-r[3])/a);this.renderedResolution=a*d/c;const k=O.width*$[0],C=O.height*$[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),D&&k>=.5&&C>=.5){const L=$[4],j=$[5],G=h.opacity;G!==1&&(b.save(),b.globalAlpha=G),b.drawImage(O,0,0,+O.width,+O.height,L,j,k,C),G!==1&&b.restore()}return this.postRender(this.context,e),N&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class GF extends Yg{constructor(e){e=e||{},super(e)}}class UF extends GF{constructor(e){super(e)}createRenderer(){return new jF(this)}getData(e){return super.getData(e)}}function Z1(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function BF(n,e,t){const i=n[t];return i?i.delete(e):!1}function TA(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=So(e,As(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=So(e,r))}return e}class zF extends Yx{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=ir(),this.tempTileRange_=new rS(0,0,0,0),this.tempTileCoord_=e_(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new IA(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new IA(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),c=c0(a,a.getKey(),e,t,i);let h;if(s.containsKey(c))h=s.get(c);else{const d=r.viewState.projection,g=a.getProjection();if(h=a.getTile(e,t,i,r.pixelRatio,d,!g||cc(g,d)?void 0:this.getSourceTileCache()),!h)return null;s.set(c,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Rn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!pc(s,r))return null;const o=t.viewState,a=i.getRenderSource(),c=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(t.pixelRatio);for(let d=c.getZForResolution(o.resolution);d>=c.getMinZoom();--d){const g=c.getTileCoordForCoordAndZ(r,d),m=this.getTile(d,g[1],g[2],t);if(!m||m.getState()!==Be.LOADED)continue;const y=c.getOrigin(d),w=Fi(c.getTileSize(d)),I=c.getResolution(d);let E;if(m instanceof Xk||m instanceof e4)E=m.getImage();else if(m instanceof wA){if(E=sw(m.getData()),!E)continue}else continue;const A=Math.floor(h*((r[0]-y[0])/I-g[1]*w[0])),b=Math.floor(h*((y[1]-r[1])/I-g[2]*w[1])),N=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(E,A+N,b+N)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),c=a.getRenderSource(),h=c.getTileGridForProjection(o.projection),d=pt(c);d in e.wantedTiles||(e.wantedTiles[d]={});const g=e.wantedTiles[d],m=a.getMapInternal(),y=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),c.zDirection)),w=o.rotation,I=w?BM(o.center,o.resolution,w,e.size):void 0;for(let E=i;E>=y;--E){const A=h.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),b=h.getResolution(E);for(let N=A.minX;N<=A.maxX;++N)for(let D=A.minY;D<=A.maxY;++D){if(w&&!h.tileCoordIntersectsViewport([E,N,D],I))continue;const O=this.getTile(E,N,D,e);if(!O||!Z1(r,O,E))continue;const k=O.getKey();if(g[k]=!0,O.getState()===Be.IDLE&&!e.tileQueue.isKeyQueued(k)){const C=e_(E,N,D,this.tempTileCoord_);e.tileQueue.enqueue([O,d,h.getTileCoordCenter(C),b])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let c=0;c<a.length;++c){const h=c0(this.getLayer().getSource(),a[c],r,s,o);if(i.containsKey(h)){const d=i.peek(h);if(d.getState()===Be.LOADED)return d.endTransition(pt(this)),Z1(t,d,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,c=this.getLayer().getRenderSource(),h=c.getKey();for(let d=s.minX;d<=s.maxX;++d)for(let g=s.minY;g<=s.maxY;++g){const m=c0(c,h,i,d,g);let y=!1;if(a.containsKey(m)){const w=a.peek(m);w.getState()===Be.LOADED&&(Z1(r,w,i),y=!0)}y||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,c=e.pixelRatio,h=this.getLayer(),d=h.getSource(),g=d.getTileGridForProjection(s),m=g.getZForResolution(o,d.zDirection),y=g.getResolution(m),w=d.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==w&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=w):this.renderedSourceKey_=w;let I=e.extent;const E=d.getTilePixelRatio(c);this.prepareContainer(e,t);const A=this.context.canvas.width,b=this.context.canvas.height,N=i.extent&&As(i.extent);N&&(I=So(I,As(i.extent)));const D=y*A/2/E,O=y*b/2/E,$=[a[0]-D,a[1]-O,a[0]+D,a[1]+O],k={};this.renderedTiles.length=0;const C=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=g.getZForResolution(r.nextResolution,d.zDirection),ge=TA(e,e.nextExtent);this.enqueueTiles(e,ge,Q,k,C)}const L=TA(e,I);if(this.enqueueTiles(e,L,m,k,0),C>0&&setTimeout(()=>{this.enqueueTiles(e,L,m-1,k,C-1)},0),!(m in k))return this.container;const j=pt(this),G=e.time;for(const Q of k[m]){const ge=Q.getState();if(ge===Be.EMPTY)continue;const he=Q.tileCoord;if(ge===Be.LOADED&&Q.getAlpha(j,G)===1){Q.endTransition(j);continue}if(ge!==Be.ERROR&&(this.renderComplete=!1),this.findStaleTile_(he,k)){BF(k,Q,m),e.animate=!0;continue}if(this.findAltTiles_(g,he,m+1,k))continue;const be=g.getMinZoom();for(let ie=m-1;ie>=be&&!this.findAltTiles_(g,he,ie,k);--ie);}const z=y/o*c/E,V=this.getRenderContext(e);Gs(this.tempTransform,A/2,b/2,z,z,0,-A/2,-b/2),i.extent&&this.clipUnrotated(V,e,N),d.getInterpolate()||(V.imageSmoothingEnabled=!1),this.preRender(V,e);const de=Object.keys(k).map(Number);de.sort(xo);let Pe;const ue=[],fe=[];for(let Q=de.length-1;Q>=0;--Q){const ge=de[Q],he=d.getTilePixelSize(ge,c,s),W=g.getResolution(ge)/y,be=he[0]*W*z,ie=he[1]*W*z,X=g.getTileCoordForCoordAndZ(Vc($),ge),P=g.getTileCoordExtent(X),Ee=Rn(this.tempTransform,[E*(P[0]-$[0])/y,E*($[3]-P[3])/y]),Y=E*d.getGutterForProjection(s);for(const Ie of k[ge]){if(Ie.getState()!==Be.LOADED)continue;const Z=Ie.tileCoord,U=X[1]-Z[1],ae=Math.round(Ee[0]-(U-1)*be),Xe=X[2]-Z[2],rt=Math.round(Ee[1]-(Xe-1)*ie),ht=Math.round(Ee[0]-U*be),Ft=Math.round(Ee[1]-Xe*ie),an=ae-ht,ar=rt-Ft,Nt=de.length===1;let It=!1;Pe=[ht,Ft,ht+an,Ft,ht+an,Ft+ar,ht,Ft+ar];for(let Mn=0,lr=ue.length;Mn<lr;++Mn)if(!Nt&&ge<fe[Mn]){const $t=ue[Mn];Ei([ht,Ft,ht+an,Ft+ar],[$t[0],$t[3],$t[4],$t[7]])&&(It||(V.save(),It=!0),V.beginPath(),V.moveTo(Pe[0],Pe[1]),V.lineTo(Pe[2],Pe[3]),V.lineTo(Pe[4],Pe[5]),V.lineTo(Pe[6],Pe[7]),V.moveTo($t[6],$t[7]),V.lineTo($t[4],$t[5]),V.lineTo($t[2],$t[3]),V.lineTo($t[0],$t[1]),V.clip())}ue.push(Pe),fe.push(ge),this.drawTile(Ie,e,ht,Ft,an,ar,Y,Nt),It&&V.restore(),this.renderedTiles.unshift(Ie),this.updateUsedTiles(e.usedTiles,d,Ie)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!Ah(this.renderedExtent_,$),this.renderedExtent_=$,this.renderedPixelRatio=c,this.postRender(this.context,e),i.extent&&V.restore(),V.imageSmoothingEnabled=!0,this.renderComplete){const Q=(ge,he)=>{const K=pt(d),W=he.wantedTiles[K],be=W?Object.keys(W).length:0;this.updateCacheSize(be),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,a,c){let h;if(e instanceof wA){if(h=sw(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const d=this.getRenderContext(t),g=pt(this),m=t.layerStatesArray[t.layerIndex],y=m.opacity*(c?e.getAlpha(g,t.time):1),w=y!==d.globalAlpha;w&&(d.save(),d.globalAlpha=y),d.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),w&&d.restore(),y!==m.opacity?t.animate=!0:c&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=pt(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Up={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class $F extends Yg{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Up.PRELOAD)}setPreload(e){this.set(Up.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Up.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Up.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Bl extends $F{constructor(e){super(e)}createRenderer(){return new zF(this,{cacheSize:this.getCacheSize()})}}function ow(n){return Array.isArray(n)?Math.min(...n):n}const Du=[0,0,0],ga=5;class n4{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,St(c6(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,St(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Vc(i)),St(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,St(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:tS,St(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new rS(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,c=r.maxY;a<=c;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,c=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):c=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Ou(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(c,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ou(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ou(s,o,s,o,i);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*c),d=Math.floor(o*c);if(t<r)return Ou(h,h,d,d,i);const g=Math.floor(c*(s+1))-1,m=Math.floor(c*(o+1))-1;return Ou(h,g,d,m,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Du);const r=Du[1],s=Du[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Du);const o=Du[1],a=Du[2];return Ou(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=Fi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=Fi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,c=o+s[0]*r,h=a+s[1]*r;return Ha(o,a,c,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),c=this.getOrigin(o),h=Fi(this.getTileSize(o),this.tmpSize_);let d=a*(e-c[0])/i/h[0],g=a*(c[1]-t)/i/h[1];return r?(d=Ca(d,ga)-1,g=Ca(g,ga)-1):(d=kp(d,ga),g=kp(g,ga)),e_(o,d,g,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),c=Fi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/a/c[0],d=(o[1]-t)/a/c[1];return r?(h=Ca(h,ga)-1,d=Ca(d,ga)-1):(h=kp(h,ga),d=kp(d,ga)),e_(i,h,d,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=q_(this.resolutions_,e,t||0);return Bt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return ak(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function i4(n){let e=n.getDefaultTileGrid();return e||(e=qF(n),n.setDefaultTileGrid(e)),e}function WF(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=sS(t);if(!pc(s,r)){const o=ot(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function HF(n,e,t,i){i=i!==void 0?i:"top-left";const r=r4(n,e,t);return new n4({extent:n,origin:g6(n,i),resolutions:r,tileSize:t})}function KF(n){const e=n||{},t=e.extent||Vt("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:r4(t,e.maxZoom,e.tileSize,e.maxResolution)};return new n4(i)}function r4(n,e,t,i){e=e!==void 0?e:IF,t=Fi(t!==void 0?t:tS);const r=vn(n),s=ot(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let c=0;c<o;++c)a[c]=i/Math.pow(2,c);return a}function qF(n,e,t,i){const r=sS(n);return HF(r,e,t,i)}function sS(n){n=Vt(n);let e=n.getExtent();if(!e){const t=180*Ph.degrees/n.getMetersPerUnit();e=Ha(-t,-t,t,t)}return e}function oS(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const YF=/\{z\}/g,XF=/\{x\}/g,QF=/\{y\}/g,ZF=/\{-y\}/g;function JF(n,e,t,i,r){return n.replace(YF,e.toString()).replace(XF,t.toString()).replace(QF,i.toString()).replace(ZF,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function e9(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function t9(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return JF(n,o,t[1],t[2],s)})}function n9(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=t9(n[r],e);return i9(i)}function i9(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=t4(e),s=Va(r,n.length);return n[s](e,t,i)})}class r9 extends qx{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Fi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||pt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return qe()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:i4(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=Fi(r.getTileSize(e),this.tmpSize);return s==1?o:uV(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=WF(r,e,i)),FF(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class s9 extends Ws{constructor(e,t){super(e),this.tile=t}}const J1={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class aS extends r9{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===aS.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=pt(t),r=t.getState();let s;r==Be.LOADING?(this.tileLoadingKeys_[i]=!0,s=J1.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Be.ERROR?J1.TILELOADERROR:r==Be.LOADED?J1.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new s9(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=e9(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(n9(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class s4 extends aS{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:o4,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Xk,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!cc(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||cc(t,e)))return this.tileGrid;const i=pt(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=i4(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],c=this.getTileCoordForTileUrlFunction(a,s),h=c?this.tileUrlFunction(c,r,s):void 0,d=new this.tileClass(a,h!==void 0?Be.IDLE:Be.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=o,d.addEventListener(Qe.CHANGE,this.handleTileChange.bind(this)),d}getTile(e,t,i,r,s,o){const a=this.getProjection();if(!a||!s||cc(a,s))return this.getTileInternal(e,t,i,r,a||s);const c=[e,t,i],h=this.getKey(),d=this.getTileGridForProjection(a),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(c,s),y=new e4(a,d,s,g,c,m,this.getTilePixelRatio(r),this.getGutter(),(w,I,E,A)=>this.getTileInternal(w,I,E,A,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=h,y}getTileInternal(e,t,i,r,s,o){const a=this.getKey(),c=c0(this,a,e,t,i);if(o&&o.containsKey(c))return o.get(c);const h=this.createTile_(e,t,i,r,s,a);return o?.set(c,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=Vt(e);if(i){const r=pt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function o4(n,e){if(er){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Yu extends s4{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:KF({extent:sS(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const o9="modulepreload",a9=function(n){return"/detectorapp-nl/"+n},RA={},Fe=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=c(t.map(h=>{if(h=a9(h),h in RA)return;RA[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":o9,d||(m.as="script"),m.crossOrigin="",m.href=h,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((y,w)=>{m.addEventListener("load",y),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};class l9 extends pk{constructor(e,t,i,r,s,o,a){let c=e.getExtent();c&&e.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);let h=t.getExtent();h&&t.canWrapX()&&(h=h.slice(),h[0]=-1/0,h[2]=1/0);const d=h?So(i,h):i,g=js(d),m=J0(e,t,g,r),y=Jk,w=new Zk(e,t,d,c,m*y,r),I=w.calculateSourceExtent(),E=Zh(I)?null:o(I,m,s),A=E?Ve.IDLE:Ve.EMPTY,b=E?E.getPixelRatio():1;super(i,r,b,A),this.targetProj_=t,this.maxSourceExtent_=c,this.triangulation_=w,this.targetResolution_=r,this.targetExtent_=i,this.sourceImage_=E,this.sourcePixelRatio_=b,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Ve.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Ve.LOADED){const t=ot(this.targetExtent_)/this.targetResolution_,i=vn(this.targetExtent_)/this.targetResolution_;this.canvas_=Qk(t,i,this.sourcePixelRatio_,ow(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Ve.IDLE){this.state=Ve.LOADING,this.changed();const e=this.sourceImage_.getState();e==Ve.LOADED||e==Ve.ERROR?this.reproject_():(this.sourceListenerKey_=ft(this.sourceImage_,Qe.CHANGE,t=>{const i=this.sourceImage_.getState();(i==Ve.LOADED||i==Ve.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){Dt(this.sourceListenerKey_),this.sourceListenerKey_=null}}const La=4,eE={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class c9 extends Ws{constructor(e,t){super(e),this.image=t}}class u9 extends qx{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const i=q_(t,e,0);e=t[i]}return e}getImage(e,t,i,r){const s=this.getProjection();if(!s||!r||cc(s,r))return s&&(r=s),this.getImageInternal(e,t,i,r);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&cc(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==t&&Ah(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new l9(s,r,e,t,i,(o,a,c)=>this.getImageInternal(o,a,c,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,i,r){if(this.loader){const s=a4(e,t,i,1),o=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===r&&(this.wantedExtent_&&Pa(this.wantedExtent_,s)||Pa(this.image.getExtent(),s))&&(this.wantedResolution_&&ow(this.wantedResolution_)===o||ow(this.image.getResolution())===o)))return this.image;this.wantedProjection_=r,this.wantedExtent_=s,this.wantedResolution_=o,this.image=new pk(s,o,i,this.loader),this.image.addEventListener(Qe.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let i;switch(t.getState()){case Ve.LOADING:this.loading=!0,i=eE.IMAGELOADSTART;break;case Ve.LOADED:this.loading=!1,i=eE.IMAGELOADEND;break;case Ve.ERROR:this.loading=!1,i=eE.IMAGELOADERROR;break;default:return}this.hasListener(i)&&this.dispatchEvent(new c9(i,t))}}function h9(n,e){n.getImage().src=e}function a4(n,e,t,i){const r=e/t,s=js(n),o=Ca(ot(n)/r,La),a=Ca(vn(n)/r,La),c=Ca((i-1)*o/2,La),h=o+2*c,d=Ca((i-1)*a/2,La),g=a+2*d;return N0(s,r,0,[h,g])}function d9(n,e,t,i,r,s){const o=r.getCode().split(/:(?=\d+$)/).pop(),a=t/i,c=[O0(ot(e)/a,La),O0(vn(e)/a,La)];s.SIZE=c[0]+","+c[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*i:90*i);const h=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return oS(h,s)}function f9(n){const e=n.load?n.load:yk,t=Vt(n.projection||"EPSG:3857"),i=n.ratio??1.5,r=n.crossOrigin??null;return function(s,o,a){a=n.hidpi?a:1;const c={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(c,n.params),s=a4(s,o,a,i);const h=d9(n.url,s,o,a,t,c),d=new Image;return d.crossOrigin=r,e(d,h).then(g=>{const m=ot(s)/g.width*a;return{image:g,extent:s,resolution:m,pixelRatio:a}})}}class g9 extends u9{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:h9,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,i,r){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==r)&&(this.loaderProjection_=r,this.loader=f9({crossOrigin:this.crossOrigin_,params:this.params_,projection:r,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,o)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,o),yk(s))})),super.getImageInternal(e,t,i,r))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const aw="1.3.0";function m9(n,e,t,i,r){r.WIDTH=t[0],r.HEIGHT=t[1];const s=i.getAxisOrientation(),o=WM(r.VERSION,"1.3")>=0;r[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return r.BBOX=a.join(","),oS(n,r)}function p9(n,e,t,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/t,c=[O0(ot(n)/a,La),O0(vn(n)/a,La)];if(t!=1)switch(o){case"geoserver":const d=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+d:s.FORMAT_OPTIONS="dpi:"+d;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return m9(r,n,c,i,s)}function AA(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:aw,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const _9='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class y9 extends Yu{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[_9];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!er&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||o4)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const t_=1/0;class v9{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Fg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){St(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=t_?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const c=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),d=h<r&&i[h]<i[c]?h:c;t[e]=t[d],i[e]=i[d],e=d}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,c;for(a=0;a<s;++a)o=t[a],c=e(o),c==t_?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=c,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class E9 extends v9{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Qe.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Be.LOADED||i===Be.ERROR||i===Be.EMPTY){i!==Be.ERROR&&t.removeEventListener(Qe.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Be.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function w9(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return t_;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class x9 extends s4{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=ir(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=Vt(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const c=$g(e,s,o),h=J0(o,s,e,t),d=a.getZForResolution(h,this.zDirection),g=a.getResolution(d),m=a.getTileCoordForCoordAndZ(c,d);if(a.getResolutions().length<=m[0])return;let y=a.getTileCoordExtent(m,this.tmpExtent_);const w=this.gutter_;w!==0&&(y=Zf(y,g*w,y));const I={QUERY_LAYERS:this.params_.LAYERS};Object.assign(I,AA(this.params_,"GetFeatureInfo"),r);const E=Math.floor((c[0]-y[0])/g),A=Math.floor((y[3]-c[1])/g);return I[this.v13_?"I":"X"]=E,I[this.v13_?"J":"Y"]=A,this.getRequestUrl_(m,y,1,o||s,I)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:aw,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),oS(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const c=Va(t4(e),o.length);a=o[c]}return p9(t,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(e[0]),i,r,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||aw;this.v13_=WM(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Zf(o,s*a,o));const c=Object.assign({},AA(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,i,c)}}class Xu extends Ws{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class va extends Xu{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const nn={SINGLECLICK:"singleclick",CLICK:Qe.CLICK,DBLCLICK:Qe.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},lw={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class S9 extends jg{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=ft(i,lw.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=ft(i,lw.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Qe.TOUCHMOVE,this.boundHandleTouchMove_,fk?{passive:!1}:!1)}emulateClick_(e){let t=new va(nn.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new va(nn.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new va(nn.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==nn.POINTERUP||t.type==nn.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==nn.POINTERDOWN||t.type==nn.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new va(nn.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Dt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new va(nn.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(ft(i,nn.POINTERMOVE,this.handlePointerMove_,this),ft(i,nn.POINTERUP,this.handlePointerUp_,this),ft(this.element_,nn.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(ft(this.element_.getRootNode(),nn.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new va(nn.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new va(nn.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Dt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Qe.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Dt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Dt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Ea={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},oi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class my extends Hs{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Dt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Qf&&this.listenerKeys.push(ft(e,Ea.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class I9 extends my{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(Qe.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+Hg+" "+$x+(this.collapsed_&&this.collapsible_?" "+$R:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=h,d.appendChild(this.toggleButton_),d.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>OM(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!al(t,this.renderedAttributions_)){_8(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle($R),this.collapsed_?BR(this.collapseLabel_,this.label_):BR(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class T9 extends my{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Qe.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+Hg+" "+$x,c=this.element;c.className=a,c.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Op)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Jh}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Op);!s&&i===0?this.element.classList.add(Op):s&&i!==0&&this.element.classList.remove(Op)}this.label_.style.transform=r}this.rotation_=i}}class R9 extends my{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",c=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=r,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof o=="string"?document.createTextNode(o):o),d.addEventListener(Qe.CLICK,this.handleClick_.bind(this,i),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=h,g.appendChild(typeof a=="string"?document.createTextNode(a):a),g.addEventListener(Qe.CLICK,this.handleClick_.bind(this,-i),!1);const m=t+" "+Hg+" "+$x,y=this.element;y.className=m,y.appendChild(d),y.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Jh})):i.setZoom(s)}}}function A9(n){n=n||{};const e=new Ar;return(n.zoom===void 0||n.zoom)&&e.push(new R9(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new T9(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new I9(n.attributionOptions)),e}class P9{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const PA={ACTIVE:"active"};class Xg extends Hs{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(PA.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(PA.ACTIVE,e)}setMap(e){this.map_=e}}function C9(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:vF,center:n.getConstrainedCenter(r)})}}function lS(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Jh})}class b9 extends Xg{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==nn.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();lS(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function cw(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const M9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},k9=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},l4=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?k9(n):!0},L9=Xf,c4=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(m8&&hk&&e.ctrlKey)},u4=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},N9=function(n){const e=n.originalEvent;return hk?e.metaKey:e.ctrlKey},O9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},h4=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},tE=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},D9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Qg extends Xg{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==nn.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==nn.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==nn.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==nn.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function cS(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class V9 extends Qg{constructor(e){super({stopDown:Y_}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:cw(u4,D9);this.condition_=e.onFocusOnly?cw(l4,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(cS(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();E6(s,a.getResolution()),Ax(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),c=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(c),duration:500,easing:Jh})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class F9 extends Qg{constructor(e){e=e||{},super({stopDown:Y_}),this.condition_=e.condition?e.condition:M9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!tE(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===eS)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return tE(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return tE(e)&&c4(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class j9 extends K_{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Ya([r])}getGeometry(){return this.geometry_}}const Vu={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class tf extends Ws{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class G9 extends Qg{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new j9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??c4,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new tf(Vu.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new tf(t?Vu.BOXEND:Vu.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new tf(Vu.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new tf(Vu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new tf(Vu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class U9 extends G9{constructor(e){e=e||{};const t=e.condition?e.condition:O9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Jh})}}const Fl={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class B9 extends Xg{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return u4(t)&&h4(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Qe.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Fl.DOWN||r==Fl.LEFT||r==Fl.RIGHT||r==Fl.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let c=0,h=0;r==Fl.DOWN?h=-a:r==Fl.LEFT?c=-a:r==Fl.RIGHT?c=a:h=a;const d=[c,h];Ax(d,o.getRotation()),C9(o,d,this.duration_),i.preventDefault(),t=!0}}return!t}}class z9 extends Xg{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!N9(t)&&h4(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Qe.KEYDOWN||e.type==Qe.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();lS(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const $9=40,W9=300;class H9 extends Xg{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:L9;this.condition_=e.onFocusOnly?cw(l4,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Qe.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=$9;break;case WheelEvent.DOM_DELTA_PAGE:s*=W9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const c=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),c),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Bt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),lS(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class K9 extends Qg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Y_),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const c=s-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=c}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==eS&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(cS(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class q9 extends Qg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Y_),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const c=e.map,h=c.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(cS(this.targetPointers))),c.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function Y9(n){n=n||{};const e=new Ar,t=new P9(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new F9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new b9({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new V9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new K9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new q9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new B9),e.push(new z9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new H9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new U9({duration:n.zoomDuration})),e}class X9 extends K_{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){qe()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Gs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),nk(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,c){let h;const d=t.viewState;function g(D,O,$,k){return s.call(o,O,D?$:null,k)}const m=d.projection,y=HM(e.slice(),m),w=[[0,0]];if(m.canWrapX()&&r){const D=m.getExtent(),O=ot(D);w.push([-O,0],[O,0])}const I=t.layerStatesArray,E=I.length,A=[],b=[];for(let D=0;D<w.length;D++)for(let O=E-1;O>=0;--O){const $=I[O],k=$.layer;if(k.hasRenderer()&&nS($,d)&&a.call(c,k)){const C=k.getRenderer(),L=k.getSource();if(C&&L){const j=L.getWrapX()?y:e,G=g.bind(null,$.managed);b[0]=j[0]+w[D][0],b[1]=j[1]+w[D][1],h=C.forEachFeatureAtCoordinate(b,t,i,G,A)}if(h)return h}}if(A.length===0)return;const N=1/A.length;return A.forEach((D,O)=>D.distanceSq+=O*N),A.sort((D,O)=>D.distanceSq-O.distanceSq),A.some(D=>h=D.callback(D.feature,D.layer,D.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Xf,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){qe()}scheduleExpireIconCache(e){Cr.canExpireCache()&&e.postRenderFunctions.push(Q9)}}function Q9(n,e){Cr.expire()}class Z9 extends X9{constructor(e){super(e),this.fontChangeListenerKey_=ft(Hu,Rh.PROPERTYCHANGE,e.redrawText,e),this.element_=er?gk():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Hg+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new Fk(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Dt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Pr.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,d)=>h.zIndex-d.zIndex);t.some(h=>h.layer instanceof qk&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,d=t.length;h<d;++h){const g=t[h];e.layerIndex=h;const m=g.layer,y=m.getSourceState();if(!nS(g,r)||y!="ready"&&y!="undefined"){m.unrender();continue}const w=m.render(e,o);w&&(w!==o&&(this.children_.push(w),o=w),s.push(g))}this.declutter(e,s),y8(this.element_,this.children_);const c=this.getMap().getTargetElement();if(Ma(c)){const h=c.getContext("2d");for(const d of this.children_){const g=d.firstElementChild||d,m=d.style.backgroundColor;if(m&&(!Ma(g)||g.width>0)&&(h.fillStyle=m,h.fillRect(0,0,c.width,c.height)),Ma(g)&&g.width>0){const y=d.style.opacity||g.style.opacity;h.globalAlpha=y===""?1:Number(y);const w=g.style.transform;if(w)h.setTransform(...XE(w));else{const I=parseFloat(g.style.width)/g.width,E=parseFloat(g.style.height)/g.height;h.setTransform(I,0,0,E,0,0)}h.drawImage(g,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Pr.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function d4(n){if(n instanceof Yg){n.setMapInternal(null);return}n instanceof gy&&n.getLayers().forEach(d4)}function f4(n,e){if(n instanceof Yg){n.setMapInternal(e);return}if(n instanceof gy){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)f4(t[i],e)}}let J9=class extends Hs{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=ej(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:p8,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Zr(),this.pixelToCoordinateTransform_=Zr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,er||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,er||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(er?new Ar:A9()),this.interactions=t.interactions||(er?new Ar:Y9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new E9(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(oi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(oi.VIEW,this.handleViewChanged_),this.addChangeListener(oi.SIZE,this.handleSizeChanged_),this.addChangeListener(oi.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Rs)&&e.view.then(function(r){i.setView(new Rs(r))}),this.controls.addEventListener(Li.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Li.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Li.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Li.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Li.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Li.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){f4(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Xf,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof gy?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Xf,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(oi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return YE(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Rn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(oi.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ar){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=_o(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Rn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(oi.SIZE)}getView(){return this.get(oi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return w9(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new va(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===lw.POINTERDOWN||i===Qe.WHEEL||i===Qe.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Fn.ANIMATING]||o[Fn.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Pr.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Pr.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Xu(Ea.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Xu(Ea.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Dt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Qe.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Qe.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ma(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ma(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Z9(this)),!Ma(t)){this.mapBrowserEventHandler_=new S9(this,this.moveTolerance_);for(const r in nn)this.mapBrowserEventHandler_.addEventListener(nn[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Qe.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Qe.WHEEL,this.boundHandleBrowserEvent_,fk?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[ft(i,Qe.KEYDOWN,this.handleBrowserEvent,this),ft(i,Qe.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Dt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Dt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=ft(e,Rh.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=ft(e,Qe.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Dt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new xa("addlayer",e)),this.layerGroupPropertyListenerKeys_=[ft(e,Rh.PROPERTYCHANGE,this.render,this),ft(e,Qe.CHANGE,this.render,this),ft(e,"addlayer",this.handleLayerAdd_,this),ft(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){d4(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&nA(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:N0(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:pt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const c=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=N0(a.nextCenter,a.nextResolution,c,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Zh(this.previousExtent_)&&!Ah(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Xu(Ea.MOVESTART,this,r)),this.previousExtent_=Ug(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Fn.ANIMATING]&&!s.viewHints[Fn.INTERACTING]&&!Ah(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Xu(Ea.MOVEEND,this,s)),VM(s.extent,this.previousExtent_))),this.dispatchEvent(new Xu(Ea.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Ea.LOADSTART)||this.hasListener(Ea.LOADEND)||this.hasListener(Pr.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new xa("removelayer",t)),this.set(oi.LAYERGROUP,e)}setSize(e){this.set(oi.SIZE,e)}setTarget(e){this.set(oi.TARGET,e)}setView(e){if(!e||e instanceof Rs){this.set(oi.VIEW,e);return}this.set(oi.VIEW,new Rs);const t=this;e.then(function(i){t.setView(new Rs(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Ma(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!nA(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&qM("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!al(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function ej(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new gy({layers:n.layers});t[oi.LAYERGROUP]=i,t[oi.TARGET]=n.target,t[oi.VIEW]=n.view instanceof Rs?n.view:new Rs;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ar(n.controls.slice()):(St(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ar(n.interactions.slice()):(St(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Ar(n.overlays.slice()):(St(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Ar,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const nE="units",tj=[1,2,5],nf=25.4/.28;class nj extends my{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Hg,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(nE,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(nE)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(nE,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=G0(i,e.resolution,t,s);const a=this.minWidth_*(this.dpi_||nf)/nf,c=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||nf)/nf:void 0;let h=a*o,d="";if(r=="degrees"){const N=Ph.degrees;h*=N,h<N/60?(d="",o*=3600):h<N?(d="",o*=60):d=""}else if(r=="imperial")h<.9144?(d="in",o/=.0254):h<1609.344?(d="ft",o/=.3048):(d="mi",o/=1609.344);else if(r=="nautical")o/=1852,d="NM";else if(r=="metric")h<1e-6?(d="nm",o*=1e9):h<.001?(d="m",o*=1e6):h<1?(d="mm",o*=1e3):h<1e3?d="m":(d="km",o/=1e3);else if(r=="us")h<.9144?(d="in",o*=39.37):h<1609.344?(d="ft",o/=.30480061):(d="mi",o/=1609.3472);else throw new Error("Invalid units");let g=3*Math.floor(Math.log(a*o)/Math.log(10)),m,y,w,I=0,E,A;for(;;){w=Math.floor(g/3);const N=Math.pow(10,w);if(m=tj[(g%3+3)%3]*N,y=Math.round(m/o),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(c!==void 0&&y>=c){m=I,y=E,w=A;break}else if(y>=a)break;I=m,E=y,A=w,++g}const b=this.scaleBar_?this.createScaleBar(y,m,d):m.toFixed(w<0?-w:0)+" "+d;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,a=e/o,c=[this.createMarker("absolute")];for(let d=0;d<o;++d){const g=d%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";c.push(`<div><div class="ol-scale-singlebar ${g}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(d%2===0||o===2?this.createStepText(d,e,!1,t,i):"")+"</div>")}return c.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+c.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const a=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),c=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${c}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=G0(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||nf,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const ij={},CA=n=>{let e;const t=new Set,i=(d,g)=>{const m=typeof d=="function"?d(e):d;if(!Object.is(m,e)){const y=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(w=>w(e,y))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(ij?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},rj=n=>n?CA(n):CA;var iE={exports:{}},rE={},sE={exports:{}},oE={};var bA;function sj(){if(bA)return oE;bA=1;var n=Vg();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function a(g,m){var y=m(),w=i({inst:{value:y,getSnapshot:m}}),I=w[0].inst,E=w[1];return s(function(){I.value=y,I.getSnapshot=m,c(I)&&E({inst:I})},[g,y,m]),r(function(){return c(I)&&E({inst:I}),g(function(){c(I)&&E({inst:I})})},[g]),o(y),y}function c(g){var m=g.getSnapshot;g=g.value;try{var y=m();return!t(g,y)}catch{return!0}}function h(g,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:a;return oE.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,oE}var MA;function oj(){return MA||(MA=1,sE.exports=sj()),sE.exports}var kA;function aj(){if(kA)return rE;kA=1;var n=Vg(),e=oj();function t(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,a=n.useMemo,c=n.useDebugValue;return rE.useSyncExternalStoreWithSelector=function(h,d,g,m,y){var w=s(null);if(w.current===null){var I={hasValue:!1,value:null};w.current=I}else I=w.current;w=a(function(){function A($){if(!b){if(b=!0,N=$,$=m($),y!==void 0&&I.hasValue){var k=I.value;if(y(k,$))return D=k}return D=$}if(k=D,i(N,$))return k;var C=m($);return y!==void 0&&y(k,C)?(N=$,k):(N=$,D=C)}var b=!1,N,D,O=g===void 0?null:g;return[function(){return A(d())},O===null?void 0:function(){return A(O())}]},[d,g,m,y]);var E=r(h,w[0],w[1]);return o(function(){I.hasValue=!0,I.value=E},[E]),c(E),E},rE}var LA;function lj(){return LA||(LA=1,iE.exports=aj()),iE.exports}var cj=lj();const uj=Ix(cj),g4={},{useDebugValue:hj}=s6,{useSyncExternalStoreWithSelector:dj}=uj;let NA=!1;const fj=n=>n;function gj(n,e=fj,t){(g4?"production":void 0)!=="production"&&t&&!NA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),NA=!0);const i=dj(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return hj(i),i}const mj=n=>{(g4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?rj(n):n,t=(i,r)=>gj(e,i,r);return Object.assign(t,e),t},Ks=n=>mj;var m4=Symbol.for("immer-nothing"),OA=Symbol.for("immer-draftable"),rr=Symbol.for("immer-state");function Yr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var lg=Object.getPrototypeOf;function Lh(n){return!!n&&!!n[rr]}function wc(n){return n?p4(n)||Array.isArray(n)||!!n[OA]||!!n.constructor?.[OA]||Zg(n)||_y(n):!1}var pj=Object.prototype.constructor.toString(),DA=new WeakMap;function p4(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=DA.get(t);return i===void 0&&(i=Function.toString.call(t),DA.set(t,i)),i===pj}function n_(n,e,t=!0){py(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function py(n){const e=n[rr];return e?e.type_:Array.isArray(n)?1:Zg(n)?2:_y(n)?3:0}function uw(n,e){return py(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function _4(n,e,t){const i=py(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function _j(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Zg(n){return n instanceof Map}function _y(n){return n instanceof Set}function zl(n){return n.copy_||n.base_}function hw(n,e){if(Zg(n))return new Map(n);if(_y(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=p4(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[rr];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],a=i[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(i[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(lg(n),i)}else{const i=lg(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function uS(n,e=!1){return yy(n)||Lh(n)||!wc(n)||(py(n)>1&&Object.defineProperties(n,{set:Bp,add:Bp,clear:Bp,delete:Bp}),Object.freeze(n),e&&Object.values(n).forEach(t=>uS(t,!0))),n}function yj(){Yr(2)}var Bp={value:yj};function yy(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var vj={};function xc(n){const e=vj[n];return e||Yr(0,n),e}var cg;function y4(){return cg}function Ej(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function VA(n,e){e&&(xc("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function dw(n){fw(n),n.drafts_.forEach(wj),n.drafts_=null}function fw(n){n===cg&&(cg=n.parent_)}function FA(n){return cg=Ej(cg,n)}function wj(n){const e=n[rr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function jA(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[rr].modified_&&(dw(e),Yr(4)),wc(n)&&(n=i_(e,n),e.parent_||r_(e,n)),e.patches_&&xc("Patches").generateReplacementPatches_(t[rr].base_,n,e.patches_,e.inversePatches_)):n=i_(e,t,[]),dw(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==m4?n:void 0}function i_(n,e,t){if(yy(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[rr];if(!r)return n_(e,(s,o)=>GA(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return r_(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),n_(o,(c,h)=>GA(n,r,s,c,h,t,a),i),r_(n,s,!1),t&&n.patches_&&xc("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function GA(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const a=yy(r);if(!(a&&!o)){if(Lh(r)){const c=s&&e&&e.type_!==3&&!uw(e.assigned_,i)?s.concat(i):void 0,h=i_(n,r,c);if(_4(t,i,h),Lh(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(wc(r)&&!a){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&a)return;i_(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Zg(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&r_(n,r)}}}function r_(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&uS(e,t)}function xj(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:y4(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=hS;t&&(r=[i],s=ug);const{revoke:o,proxy:a}=Proxy.revocable(r,s);return i.draft_=a,i.revoke_=o,a}var hS={get(n,e){if(e===rr)return n;const t=zl(n);if(!uw(t,e))return Sj(n,t,e);const i=t[e];return n.finalized_||!wc(i)?i:i===aE(n.base_,e)?(lE(n),n.copy_[e]=mw(i,n)):i},has(n,e){return e in zl(n)},ownKeys(n){return Reflect.ownKeys(zl(n))},set(n,e,t){const i=v4(zl(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=aE(zl(n),e),s=r?.[rr];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(_j(t,r)&&(t!==void 0||uw(n.base_,e)))return!0;lE(n),gw(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return aE(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,lE(n),gw(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=zl(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){Yr(11)},getPrototypeOf(n){return lg(n.base_)},setPrototypeOf(){Yr(12)}},ug={};n_(hS,(n,e)=>{ug[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ug.deleteProperty=function(n,e){return ug.set.call(this,n,e,void 0)};ug.set=function(n,e,t){return hS.set.call(this,n[0],e,t,n[0])};function aE(n,e){const t=n[rr];return(t?zl(t):n)[e]}function Sj(n,e,t){const i=v4(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function v4(n,e){if(!(e in n))return;let t=lg(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=lg(t)}}function gw(n){n.modified_||(n.modified_=!0,n.parent_&&gw(n.parent_))}function lE(n){n.copy_||(n.copy_=hw(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Ij=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(c=s,...h){return o.produce(c,d=>t.call(this,d,...h))}}typeof t!="function"&&Yr(6),i!==void 0&&typeof i!="function"&&Yr(7);let r;if(wc(e)){const s=FA(this),o=mw(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?dw(s):fw(s)}return VA(s,i),jA(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===m4&&(r=void 0),this.autoFreeze_&&uS(r,!0),i){const s=[],o=[];xc("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else Yr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,c=>e(c,...a));let i,r;return[this.produce(e,t,(o,a)=>{i=o,r=a}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){wc(n)||Yr(8),Lh(n)&&(n=Tj(n));const e=FA(this),t=mw(n,void 0);return t[rr].isManual_=!0,fw(e),t}finishDraft(n,e){const t=n&&n[rr];(!t||!t.isManual_)&&Yr(9);const{scope_:i}=t;return VA(i,e),jA(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=xc("Patches").applyPatches_;return Lh(n)?i(n,e):this.produce(n,r=>i(r,e))}};function mw(n,e){const t=Zg(n)?xc("MapSet").proxyMap_(n,e):_y(n)?xc("MapSet").proxySet_(n,e):xj(n,e);return(e?e.scope_:y4()).drafts_.push(t),t}function Tj(n){return Lh(n)||Yr(10,n),E4(n)}function E4(n){if(!wc(n)||yy(n))return n;const e=n[rr];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=hw(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=hw(n,!0);return n_(t,(r,s)=>{_4(t,r,E4(s))},i),e&&(e.finalized_=!1),t}var Rj=new Ij,Aj=Rj.produce;const Pj=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const a=typeof r=="function"?Aj(r):r;return e(a,s,...o)},n(i.setState,t,i)),Bc=Pj,Ht=Ks()(Bc((n,e)=>({tracking:!1,navigationMode:"free",position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},toggleMode:()=>{n(t=>{t.navigationMode=t.navigationMode==="free"?"drive":"free",console.log(` Navigation mode: ${t.navigationMode}`)})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){i.headingSource="gps";const a=t.coords.heading;e().updateHeading(a,"gps")}else i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const{smoothHeading:s,config:o}=e();if(s===null){r.smoothHeading=t,r.heading=t;return}let a=t-s;a>180&&(a-=360),a<-180&&(a+=360);const c=i==="compass"?8:o.minRotationSpeed;if(Math.abs(a)<c)return;const h=s+a*o.smoothingFactor;r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),w4={"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await Fe(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await Fe(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await Fe(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await Fe(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await Fe(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await Fe(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await Fe(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await Fe(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await Fe(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await Fe(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-NmVs8cBK.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await Fe(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-O723n6h4.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await Fe(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-O723n6h4.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await Fe(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-O723n6h4.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await Fe(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-DIUrFK7S.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await Fe(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-DIUrFK7S.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await Fe(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-DIUrFK7S.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await Fe(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-DIUrFK7S.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await Fe(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-DIUrFK7S.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await Fe(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-DIUrFK7S.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await Fe(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-DIUrFK7S.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await Fe(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-CbgSD_PE.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await Fe(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-CAeG89cW.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await Fe(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-CAeG89cW.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await Fe(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-CAeG89cW.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"World Hillshade":{name:"World Hillshade",factory:async()=>{const{createWorldHillshadeLayerOL:n}=await Fe(async()=>{const{createWorldHillshadeLayerOL:e}=await import("./hillshadeLayers-CAeG89cW.js");return{createWorldHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await Fe(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await Fe(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await Fe(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await Fe(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await Fe(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createRomeinseFortenLayerOL:e}},[]);return n()},immediateLoad:!0},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await Fe(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await Fe(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await Fe(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await Fe(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await Fe(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await Fe(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await Fe(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-pNdHqmtj.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await Fe(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-CUV9K-s8.js");return{createAMKLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse wegen":{name:"Romeinse wegen",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await Fe(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-CymOP1yQ.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await Fe(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-ogvVG7WZ.js");return{createKastelenLayerOL:e}},__vite__mapDeps([3,4]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await Fe(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-Cjt81iwE.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await Fe(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-aaDz7Hid.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([5,4]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await Fe(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-pBhxqYvY.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([6,1,4]));return n()},immediateLoad:!1},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await Fe(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-COLC5Zi_.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await Fe(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-CKyhCpOv.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([8,1]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await Fe(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-Crtqdaij.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([9,1]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await Fe(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-BK1ksnWk.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([10,1]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await Fe(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-FcagOfoa.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([11,1,4]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await Fe(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-9wbPMt9D.js");return{createMuseaLayerOL:e}},__vite__mapDeps([12,1,4]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await Fe(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-CLRXivPX.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([13,1]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await Fe(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-CicDLTpN.js");return{createParkenLayerOL:e}},__vite__mapDeps([14,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await Fe(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-ClAULRH6.js");return{createFossielenLayerOL:e}},__vite__mapDeps([15,16,4]));return n()},immediateLoad:!1},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await Fe(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-BPQpqc5E.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([17,16,4]));return n()},immediateLoad:!1},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await Fe(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-Bn_S6-MJ.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([18,16,4]));return n()},immediateLoad:!1},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await Fe(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-BKZNmTsI.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([19,16,4]));return n()},immediateLoad:!1},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await Fe(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-C08ZKy_F.js");return{createBunkersLayerOL:e}},__vite__mapDeps([20,4]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await Fe(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-c30R6Ib1.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([21,4]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await Fe(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-VUzya23a.js");return{createSlagveldenLayerOL:e}},[]);return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await Fe(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-CyV3aF2g.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function Cj(){return Object.values(w4).filter(n=>n.immediateLoad)}const di=Ks()(Bc((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Jn=Ks()(Bc((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"Romeinse wegen":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,"World Hillshade":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN 0.5m":.7,Geomorfologie:.5,Bodemkaart:.6,IKAW:.5,"Archeo Landschappen":.5,"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"World Hillshade":.7,Terpen:.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Paleokaart 800 n.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 9000 v.Chr.":.7,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},unregisterLayer:t=>{n(i=>{delete i.layers[t],delete i.loadingState[t]})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=w4[t];if(!r){console.warn(` Layer "${t}" not found in registry`);return}const s=di.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const a=e();o.setVisible(a.visible[t]??!1),a.opacity[t]!==void 0&&o.setOpacity(a.opacity[t]),s.addLayer(o),n(c=>{c.layers[t]=o,c.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(o){console.error(` Failed to load layer "${t}":`,o),n(a=>{a.loadingState[t]="error"})}}}))),Nh=Ks()(Bc((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const i=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const i=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const i=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const i=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const i=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,i||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(i=>{i.collapsedCategories.has(t)?i.collapsedCategories.delete(t):i.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(i=>{i.layerControlOpen=t})},setLegendOpen:t=>{n(i=>{i.legendOpen=t})}}))),x4=Ks()(Bc(n=>({user:null,loading:!0,error:null,setUser:e=>{n(t=>{t.user=e,t.loading=!1})},setLoading:e=>{n(t=>{t.loading=e})},setError:e=>{n(t=>{t.error=e})}}))),bj=()=>{};var UA={};const S4=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Mj=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},I4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,h=c?n[r+2]:0,d=s>>2,g=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,y=h&63;c||(y=64,o||(m=64)),i.push(t[d],t[g],t[m],t[y])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(S4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Mj(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const g=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||g==null)throw new kj;const m=s<<2|a>>4;if(i.push(m),h!==64){const y=a<<4&240|h>>2;if(i.push(y),g!==64){const w=h<<6&192|g;i.push(w)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class kj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Lj=function(n){const e=S4(n);return I4.encodeByteArray(e,!0)},s_=function(n){return Lj(n).replace(/\./g,"")},T4=function(n){try{return I4.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function R4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Nj=()=>R4().__FIREBASE_DEFAULTS__,Oj=()=>{if(typeof process>"u"||typeof UA>"u")return;const n=UA.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Dj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&T4(n[1]);return e&&JSON.parse(e)},vy=()=>{try{return bj()||Nj()||Oj()||Dj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},A4=n=>vy()?.emulatorHosts?.[n],P4=n=>{const e=A4(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},C4=()=>vy()?.config,b4=n=>vy()?.[`_${n}`];class Vj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function zc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dS(n){return(await fetch(n,{credentials:"include"})).ok}function M4(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[s_(JSON.stringify(t)),s_(JSON.stringify(o)),""].join(".")}const bf={};function Fj(){const n={prod:[],emulator:[]};for(const e of Object.keys(bf))bf[e]?n.emulator.push(e):n.prod.push(e);return n}function jj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let BA=!1;function fS(n,e){if(typeof window>"u"||typeof document>"u"||!zc(window.location.host)||bf[n]===e||bf[n]||BA)return;bf[n]=e;function t(m){return`__firebase__banner__${m}`}const i="__firebase__banner",s=Fj().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{BA=!0,o()},m}function d(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=jj(i),y=t("text"),w=document.getElementById(y)||document.createElement("span"),I=t("learnmore"),E=document.getElementById(I)||document.createElement("a"),A=t("preprendIcon"),b=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const N=m.element;a(N),d(E,I);const D=h();c(b,A),N.append(b,w,E,D),document.body.appendChild(N)}s?(w.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Cn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cn())}function k4(){const n=vy()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Uj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Bj(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function zj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $j(){const n=Cn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function L4(){return!k4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function N4(){return!k4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function O4(){try{return typeof indexedDB=="object"}catch{return!1}}function Wj(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const Hj="FirebaseError";class qs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Hj,Object.setPrototypeOf(this,qs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jg.prototype.create)}}class Jg{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Kj(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new qs(r,a,i)}}function Kj(n,e){return n.replace(qj,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const qj=/\{\$([^}]+)}/g;function Yj(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Sc(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(zA(s)&&zA(o)){if(!Sc(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function zA(n){return n!==null&&typeof n=="object"}function em(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Xj(n,e){const t=new Qj(n,e);return t.subscribe.bind(t)}class Qj{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Zj(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=cE),r.error===void 0&&(r.error=cE),r.complete===void 0&&(r.complete=cE);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Zj(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function cE(){}function jn(n){return n&&n._delegate?n._delegate:n}class Xa{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const $l="[DEFAULT]";class Jj{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Vj;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tG(e))try{this.getOrInitializeService({instanceIdentifier:$l})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=$l){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$l){return this.instances.has(e)}getOptions(e=$l){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:eG(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=$l){return this.component?this.component.multipleInstances?e:$l:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eG(n){return n===$l?void 0:n}function tG(n){return n.instantiationMode==="EAGER"}class nG{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Jj(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var at;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(at||(at={}));const iG={debug:at.DEBUG,verbose:at.VERBOSE,info:at.INFO,warn:at.WARN,error:at.ERROR,silent:at.SILENT},rG=at.INFO,sG={[at.DEBUG]:"log",[at.VERBOSE]:"log",[at.INFO]:"info",[at.WARN]:"warn",[at.ERROR]:"error"},oG=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=sG[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gS{constructor(e){this.name=e,this._logLevel=rG,this._logHandler=oG,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in at))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iG[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,at.DEBUG,...e),this._logHandler(this,at.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,at.VERBOSE,...e),this._logHandler(this,at.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,at.INFO,...e),this._logHandler(this,at.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,at.WARN,...e),this._logHandler(this,at.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,at.ERROR,...e),this._logHandler(this,at.ERROR,...e)}}const aG=(n,e)=>e.some(t=>n instanceof t);let $A,WA;function lG(){return $A||($A=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cG(){return WA||(WA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const D4=new WeakMap,pw=new WeakMap,V4=new WeakMap,uE=new WeakMap,mS=new WeakMap;function uG(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ja(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&D4.set(t,n)}).catch(()=>{}),mS.set(e,n),e}function hG(n){if(pw.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});pw.set(n,e)}let _w={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return pw.get(n);if(e==="objectStoreNames")return n.objectStoreNames||V4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ja(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function dG(n){_w=n(_w)}function fG(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(hE(this),e,...t);return V4.set(i,e.sort?e.sort():[e]),ja(i)}:cG().includes(n)?function(...e){return n.apply(hE(this),e),ja(D4.get(this))}:function(...e){return ja(n.apply(hE(this),e))}}function gG(n){return typeof n=="function"?fG(n):(n instanceof IDBTransaction&&hG(n),aG(n,lG())?new Proxy(n,_w):n)}function ja(n){if(n instanceof IDBRequest)return uG(n);if(uE.has(n))return uE.get(n);const e=gG(n);return e!==n&&(uE.set(n,e),mS.set(e,n)),e}const hE=n=>mS.get(n);function mG(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=ja(o);return i&&o.addEventListener("upgradeneeded",c=>{i(ja(o.result),c.oldVersion,c.newVersion,ja(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const pG=["get","getKey","getAll","getAllKeys","count"],_G=["put","add","delete","clear"],dE=new Map;function HA(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(dE.get(e))return dE.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=_G.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||pG.includes(t)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&c.done]))[0]};return dE.set(e,s),s}dG(n=>({...n,get:(e,t,i)=>HA(e,t)||n.get(e,t,i),has:(e,t)=>!!HA(e,t)||n.has(e,t)}));class yG{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(vG(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function vG(n){return n.getComponent()?.type==="VERSION"}const yw="@firebase/app",KA="0.14.6";const bo=new gS("@firebase/app"),EG="@firebase/app-compat",wG="@firebase/analytics-compat",xG="@firebase/analytics",SG="@firebase/app-check-compat",IG="@firebase/app-check",TG="@firebase/auth",RG="@firebase/auth-compat",AG="@firebase/database",PG="@firebase/data-connect",CG="@firebase/database-compat",bG="@firebase/functions",MG="@firebase/functions-compat",kG="@firebase/installations",LG="@firebase/installations-compat",NG="@firebase/messaging",OG="@firebase/messaging-compat",DG="@firebase/performance",VG="@firebase/performance-compat",FG="@firebase/remote-config",jG="@firebase/remote-config-compat",GG="@firebase/storage",UG="@firebase/storage-compat",BG="@firebase/firestore",zG="@firebase/ai",$G="@firebase/firestore-compat",WG="firebase",HG="12.6.0";const vw="[DEFAULT]",KG={[yw]:"fire-core",[EG]:"fire-core-compat",[xG]:"fire-analytics",[wG]:"fire-analytics-compat",[IG]:"fire-app-check",[SG]:"fire-app-check-compat",[TG]:"fire-auth",[RG]:"fire-auth-compat",[AG]:"fire-rtdb",[PG]:"fire-data-connect",[CG]:"fire-rtdb-compat",[bG]:"fire-fn",[MG]:"fire-fn-compat",[kG]:"fire-iid",[LG]:"fire-iid-compat",[NG]:"fire-fcm",[OG]:"fire-fcm-compat",[DG]:"fire-perf",[VG]:"fire-perf-compat",[FG]:"fire-rc",[jG]:"fire-rc-compat",[GG]:"fire-gcs",[UG]:"fire-gcs-compat",[BG]:"fire-fst",[$G]:"fire-fst-compat",[zG]:"fire-vertex","fire-js":"fire-js",[WG]:"fire-js-all"};const o_=new Map,qG=new Map,Ew=new Map;function qA(n,e){try{n.container.addComponent(e)}catch(t){bo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ic(n){const e=n.name;if(Ew.has(e))return bo.debug(`There were multiple attempts to register component ${e}.`),!1;Ew.set(e,n);for(const t of o_.values())qA(t,n);for(const t of qG.values())qA(t,n);return!0}function Ey(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Tr(n){return n==null?!1:n.settings!==void 0}const YG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ga=new Jg("app","Firebase",YG);class XG{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Xa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ga.create("app-deleted",{appName:this._name})}}const $c=HG;function F4(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:vw,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Ga.create("bad-app-name",{appName:String(r)});if(t||(t=C4()),!t)throw Ga.create("no-options");const s=o_.get(r);if(s){if(Sc(t,s.options)&&Sc(i,s.config))return s;throw Ga.create("duplicate-app",{appName:r})}const o=new nG(r);for(const c of Ew.values())o.addComponent(c);const a=new XG(t,i,o);return o_.set(r,a),a}function pS(n=vw){const e=o_.get(n);if(!e&&n===vw&&C4())return F4();if(!e)throw Ga.create("no-app",{appName:n});return e}function ks(n,e,t){let i=KG[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bo.warn(o.join(" "));return}Ic(new Xa(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const QG="firebase-heartbeat-database",ZG=1,hg="firebase-heartbeat-store";let fE=null;function j4(){return fE||(fE=mG(QG,ZG,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(hg)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ga.create("idb-open",{originalErrorMessage:n.message})})),fE}async function JG(n){try{const t=(await j4()).transaction(hg),i=await t.objectStore(hg).get(G4(n));return await t.done,i}catch(e){if(e instanceof qs)bo.warn(e.message);else{const t=Ga.create("idb-get",{originalErrorMessage:e?.message});bo.warn(t.message)}}}async function YA(n,e){try{const i=(await j4()).transaction(hg,"readwrite");await i.objectStore(hg).put(e,G4(n)),await i.done}catch(t){if(t instanceof qs)bo.warn(t.message);else{const i=Ga.create("idb-set",{originalErrorMessage:t?.message});bo.warn(i.message)}}}function G4(n){return`${n.name}!${n.options.appId}`}const e7=1024,t7=30;class n7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new r7(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=XA();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>t7){const r=s7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){bo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=XA(),{heartbeatsToSend:t,unsentEntries:i}=i7(this._heartbeatsCache.heartbeats),r=s_(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return bo.warn(e),""}}}function XA(){return new Date().toISOString().substring(0,10)}function i7(n,e=e7){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),QA(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),QA(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class r7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return O4()?Wj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await JG(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return YA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return YA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function QA(n){return s_(JSON.stringify({version:2,heartbeats:n})).length}function s7(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function o7(n){Ic(new Xa("platform-logger",e=>new yG(e),"PRIVATE")),Ic(new Xa("heartbeat",e=>new n7(e),"PRIVATE")),ks(yw,KA,n),ks(yw,KA,"esm2020"),ks("fire-js","")}o7("");var ZA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ua,U4;(function(){var n;function e(k,C){function L(){}L.prototype=C.prototype,k.F=C.prototype,k.prototype=new L,k.prototype.constructor=k,k.D=function(j,G,z){for(var V=Array(arguments.length-2),de=2;de<arguments.length;de++)V[de-2]=arguments[de];return C.prototype[G].apply(j,V)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,C,L){L||(L=0);const j=Array(16);if(typeof C=="string")for(var G=0;G<16;++G)j[G]=C.charCodeAt(L++)|C.charCodeAt(L++)<<8|C.charCodeAt(L++)<<16|C.charCodeAt(L++)<<24;else for(G=0;G<16;++G)j[G]=C[L++]|C[L++]<<8|C[L++]<<16|C[L++]<<24;C=k.g[0],L=k.g[1],G=k.g[2];let z=k.g[3],V;V=C+(z^L&(G^z))+j[0]+3614090360&4294967295,C=L+(V<<7&4294967295|V>>>25),V=z+(G^C&(L^G))+j[1]+3905402710&4294967295,z=C+(V<<12&4294967295|V>>>20),V=G+(L^z&(C^L))+j[2]+606105819&4294967295,G=z+(V<<17&4294967295|V>>>15),V=L+(C^G&(z^C))+j[3]+3250441966&4294967295,L=G+(V<<22&4294967295|V>>>10),V=C+(z^L&(G^z))+j[4]+4118548399&4294967295,C=L+(V<<7&4294967295|V>>>25),V=z+(G^C&(L^G))+j[5]+1200080426&4294967295,z=C+(V<<12&4294967295|V>>>20),V=G+(L^z&(C^L))+j[6]+2821735955&4294967295,G=z+(V<<17&4294967295|V>>>15),V=L+(C^G&(z^C))+j[7]+4249261313&4294967295,L=G+(V<<22&4294967295|V>>>10),V=C+(z^L&(G^z))+j[8]+1770035416&4294967295,C=L+(V<<7&4294967295|V>>>25),V=z+(G^C&(L^G))+j[9]+2336552879&4294967295,z=C+(V<<12&4294967295|V>>>20),V=G+(L^z&(C^L))+j[10]+4294925233&4294967295,G=z+(V<<17&4294967295|V>>>15),V=L+(C^G&(z^C))+j[11]+2304563134&4294967295,L=G+(V<<22&4294967295|V>>>10),V=C+(z^L&(G^z))+j[12]+1804603682&4294967295,C=L+(V<<7&4294967295|V>>>25),V=z+(G^C&(L^G))+j[13]+4254626195&4294967295,z=C+(V<<12&4294967295|V>>>20),V=G+(L^z&(C^L))+j[14]+2792965006&4294967295,G=z+(V<<17&4294967295|V>>>15),V=L+(C^G&(z^C))+j[15]+1236535329&4294967295,L=G+(V<<22&4294967295|V>>>10),V=C+(G^z&(L^G))+j[1]+4129170786&4294967295,C=L+(V<<5&4294967295|V>>>27),V=z+(L^G&(C^L))+j[6]+3225465664&4294967295,z=C+(V<<9&4294967295|V>>>23),V=G+(C^L&(z^C))+j[11]+643717713&4294967295,G=z+(V<<14&4294967295|V>>>18),V=L+(z^C&(G^z))+j[0]+3921069994&4294967295,L=G+(V<<20&4294967295|V>>>12),V=C+(G^z&(L^G))+j[5]+3593408605&4294967295,C=L+(V<<5&4294967295|V>>>27),V=z+(L^G&(C^L))+j[10]+38016083&4294967295,z=C+(V<<9&4294967295|V>>>23),V=G+(C^L&(z^C))+j[15]+3634488961&4294967295,G=z+(V<<14&4294967295|V>>>18),V=L+(z^C&(G^z))+j[4]+3889429448&4294967295,L=G+(V<<20&4294967295|V>>>12),V=C+(G^z&(L^G))+j[9]+568446438&4294967295,C=L+(V<<5&4294967295|V>>>27),V=z+(L^G&(C^L))+j[14]+3275163606&4294967295,z=C+(V<<9&4294967295|V>>>23),V=G+(C^L&(z^C))+j[3]+4107603335&4294967295,G=z+(V<<14&4294967295|V>>>18),V=L+(z^C&(G^z))+j[8]+1163531501&4294967295,L=G+(V<<20&4294967295|V>>>12),V=C+(G^z&(L^G))+j[13]+2850285829&4294967295,C=L+(V<<5&4294967295|V>>>27),V=z+(L^G&(C^L))+j[2]+4243563512&4294967295,z=C+(V<<9&4294967295|V>>>23),V=G+(C^L&(z^C))+j[7]+1735328473&4294967295,G=z+(V<<14&4294967295|V>>>18),V=L+(z^C&(G^z))+j[12]+2368359562&4294967295,L=G+(V<<20&4294967295|V>>>12),V=C+(L^G^z)+j[5]+4294588738&4294967295,C=L+(V<<4&4294967295|V>>>28),V=z+(C^L^G)+j[8]+2272392833&4294967295,z=C+(V<<11&4294967295|V>>>21),V=G+(z^C^L)+j[11]+1839030562&4294967295,G=z+(V<<16&4294967295|V>>>16),V=L+(G^z^C)+j[14]+4259657740&4294967295,L=G+(V<<23&4294967295|V>>>9),V=C+(L^G^z)+j[1]+2763975236&4294967295,C=L+(V<<4&4294967295|V>>>28),V=z+(C^L^G)+j[4]+1272893353&4294967295,z=C+(V<<11&4294967295|V>>>21),V=G+(z^C^L)+j[7]+4139469664&4294967295,G=z+(V<<16&4294967295|V>>>16),V=L+(G^z^C)+j[10]+3200236656&4294967295,L=G+(V<<23&4294967295|V>>>9),V=C+(L^G^z)+j[13]+681279174&4294967295,C=L+(V<<4&4294967295|V>>>28),V=z+(C^L^G)+j[0]+3936430074&4294967295,z=C+(V<<11&4294967295|V>>>21),V=G+(z^C^L)+j[3]+3572445317&4294967295,G=z+(V<<16&4294967295|V>>>16),V=L+(G^z^C)+j[6]+76029189&4294967295,L=G+(V<<23&4294967295|V>>>9),V=C+(L^G^z)+j[9]+3654602809&4294967295,C=L+(V<<4&4294967295|V>>>28),V=z+(C^L^G)+j[12]+3873151461&4294967295,z=C+(V<<11&4294967295|V>>>21),V=G+(z^C^L)+j[15]+530742520&4294967295,G=z+(V<<16&4294967295|V>>>16),V=L+(G^z^C)+j[2]+3299628645&4294967295,L=G+(V<<23&4294967295|V>>>9),V=C+(G^(L|~z))+j[0]+4096336452&4294967295,C=L+(V<<6&4294967295|V>>>26),V=z+(L^(C|~G))+j[7]+1126891415&4294967295,z=C+(V<<10&4294967295|V>>>22),V=G+(C^(z|~L))+j[14]+2878612391&4294967295,G=z+(V<<15&4294967295|V>>>17),V=L+(z^(G|~C))+j[5]+4237533241&4294967295,L=G+(V<<21&4294967295|V>>>11),V=C+(G^(L|~z))+j[12]+1700485571&4294967295,C=L+(V<<6&4294967295|V>>>26),V=z+(L^(C|~G))+j[3]+2399980690&4294967295,z=C+(V<<10&4294967295|V>>>22),V=G+(C^(z|~L))+j[10]+4293915773&4294967295,G=z+(V<<15&4294967295|V>>>17),V=L+(z^(G|~C))+j[1]+2240044497&4294967295,L=G+(V<<21&4294967295|V>>>11),V=C+(G^(L|~z))+j[8]+1873313359&4294967295,C=L+(V<<6&4294967295|V>>>26),V=z+(L^(C|~G))+j[15]+4264355552&4294967295,z=C+(V<<10&4294967295|V>>>22),V=G+(C^(z|~L))+j[6]+2734768916&4294967295,G=z+(V<<15&4294967295|V>>>17),V=L+(z^(G|~C))+j[13]+1309151649&4294967295,L=G+(V<<21&4294967295|V>>>11),V=C+(G^(L|~z))+j[4]+4149444226&4294967295,C=L+(V<<6&4294967295|V>>>26),V=z+(L^(C|~G))+j[11]+3174756917&4294967295,z=C+(V<<10&4294967295|V>>>22),V=G+(C^(z|~L))+j[2]+718787259&4294967295,G=z+(V<<15&4294967295|V>>>17),V=L+(z^(G|~C))+j[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(G+(V<<21&4294967295|V>>>11))&4294967295,k.g[2]=k.g[2]+G&4294967295,k.g[3]=k.g[3]+z&4294967295}i.prototype.v=function(k,C){C===void 0&&(C=k.length);const L=C-this.blockSize,j=this.C;let G=this.h,z=0;for(;z<C;){if(G==0)for(;z<=L;)r(this,k,z),z+=this.blockSize;if(typeof k=="string"){for(;z<C;)if(j[G++]=k.charCodeAt(z++),G==this.blockSize){r(this,j),G=0;break}}else for(;z<C;)if(j[G++]=k[z++],G==this.blockSize){r(this,j),G=0;break}}this.h=G,this.o+=C},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;C=this.o*8;for(var L=k.length-8;L<k.length;++L)k[L]=C&255,C/=256;for(this.v(k),k=Array(16),C=0,L=0;L<4;++L)for(let j=0;j<32;j+=8)k[C++]=this.g[L]>>>j&255;return k};function s(k,C){var L=a;return Object.prototype.hasOwnProperty.call(L,k)?L[k]:L[k]=C(k)}function o(k,C){this.h=C;const L=[];let j=!0;for(let G=k.length-1;G>=0;G--){const z=k[G]|0;j&&z==C||(L[G]=z,j=!1)}this.g=L}var a={};function c(k){return-128<=k&&k<128?s(k,function(C){return new o([C|0],C<0?-1:0)}):new o([k|0],k<0?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return g;if(k<0)return E(h(-k));const C=[];let L=1;for(let j=0;k>=L;j++)C[j]=k/L|0,L*=4294967296;return new o(C,0)}function d(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return E(d(k.substring(1),C));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=h(Math.pow(C,8));let j=g;for(let z=0;z<k.length;z+=8){var G=Math.min(8,k.length-z);const V=parseInt(k.substring(z,z+G),C);G<8?(G=h(Math.pow(C,G)),j=j.j(G).add(h(V))):(j=j.j(L),j=j.add(h(V)))}return j}var g=c(0),m=c(1),y=c(16777216);n=o.prototype,n.m=function(){if(I(this))return-E(this).m();let k=0,C=1;for(let L=0;L<this.g.length;L++){const j=this.i(L);k+=(j>=0?j:4294967296+j)*C,C*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(w(this))return"0";if(I(this))return"-"+E(this).toString(k);const C=h(Math.pow(k,6));var L=this;let j="";for(;;){const G=D(L,C).g;L=A(L,G.j(C));let z=((L.g.length>0?L.g[0]:L.h)>>>0).toString(k);if(L=G,w(L))return z+j;for(;z.length<6;)z="0"+z;j=z+j}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function w(k){if(k.h!=0)return!1;for(let C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function I(k){return k.h==-1}n.l=function(k){return k=A(this,k),I(k)?-1:w(k)?0:1};function E(k){const C=k.g.length,L=[];for(let j=0;j<C;j++)L[j]=~k.g[j];return new o(L,~k.h).add(m)}n.abs=function(){return I(this)?E(this):this},n.add=function(k){const C=Math.max(this.g.length,k.g.length),L=[];let j=0;for(let G=0;G<=C;G++){let z=j+(this.i(G)&65535)+(k.i(G)&65535),V=(z>>>16)+(this.i(G)>>>16)+(k.i(G)>>>16);j=V>>>16,z&=65535,V&=65535,L[G]=V<<16|z}return new o(L,L[L.length-1]&-2147483648?-1:0)};function A(k,C){return k.add(E(C))}n.j=function(k){if(w(this)||w(k))return g;if(I(this))return I(k)?E(this).j(E(k)):E(E(this).j(k));if(I(k))return E(this.j(E(k)));if(this.l(y)<0&&k.l(y)<0)return h(this.m()*k.m());const C=this.g.length+k.g.length,L=[];for(var j=0;j<2*C;j++)L[j]=0;for(j=0;j<this.g.length;j++)for(let G=0;G<k.g.length;G++){const z=this.i(j)>>>16,V=this.i(j)&65535,de=k.i(G)>>>16,Pe=k.i(G)&65535;L[2*j+2*G]+=V*Pe,b(L,2*j+2*G),L[2*j+2*G+1]+=z*Pe,b(L,2*j+2*G+1),L[2*j+2*G+1]+=V*de,b(L,2*j+2*G+1),L[2*j+2*G+2]+=z*de,b(L,2*j+2*G+2)}for(k=0;k<C;k++)L[k]=L[2*k+1]<<16|L[2*k];for(k=C;k<2*C;k++)L[k]=0;return new o(L,0)};function b(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function N(k,C){this.g=k,this.h=C}function D(k,C){if(w(C))throw Error("division by zero");if(w(k))return new N(g,g);if(I(k))return C=D(E(k),C),new N(E(C.g),E(C.h));if(I(C))return C=D(k,E(C)),new N(E(C.g),C.h);if(k.g.length>30){if(I(k)||I(C))throw Error("slowDivide_ only works with positive integers.");for(var L=m,j=C;j.l(k)<=0;)L=O(L),j=O(j);var G=$(L,1),z=$(j,1);for(j=$(j,2),L=$(L,2);!w(j);){var V=z.add(j);V.l(k)<=0&&(G=G.add(L),z=V),j=$(j,1),L=$(L,1)}return C=A(k,G.j(C)),new N(G,C)}for(G=g;k.l(C)>=0;){for(L=Math.max(1,Math.floor(k.m()/C.m())),j=Math.ceil(Math.log(L)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),z=h(L),V=z.j(C);I(V)||V.l(k)>0;)L-=j,z=h(L),V=z.j(C);w(z)&&(z=m),G=G.add(z),k=A(k,V)}return new N(G,k)}n.B=function(k){return D(this,k).h},n.and=function(k){const C=Math.max(this.g.length,k.g.length),L=[];for(let j=0;j<C;j++)L[j]=this.i(j)&k.i(j);return new o(L,this.h&k.h)},n.or=function(k){const C=Math.max(this.g.length,k.g.length),L=[];for(let j=0;j<C;j++)L[j]=this.i(j)|k.i(j);return new o(L,this.h|k.h)},n.xor=function(k){const C=Math.max(this.g.length,k.g.length),L=[];for(let j=0;j<C;j++)L[j]=this.i(j)^k.i(j);return new o(L,this.h^k.h)};function O(k){const C=k.g.length+1,L=[];for(let j=0;j<C;j++)L[j]=k.i(j)<<1|k.i(j-1)>>>31;return new o(L,k.h)}function $(k,C){const L=C>>5;C%=32;const j=k.g.length-L,G=[];for(let z=0;z<j;z++)G[z]=C>0?k.i(z+L)>>>C|k.i(z+L+1)<<32-C:k.i(z+L);return new o(G,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,U4=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,Ua=o}).apply(typeof ZA<"u"?ZA:typeof self<"u"?self:typeof window<"u"?window:{});var zp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var B4,_f,z4,u0,ww,$4,W4,H4;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof zp=="object"&&zp];for(var S=0;S<p.length;++S){var R=p[S];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var i=t(this);function r(p,S){if(S)e:{var R=i;p=p.split(".");for(var F=0;F<p.length-1;F++){var te=p[F];if(!(te in R))break e;R=R[te]}p=p[p.length-1],F=R[p],S=S(F),S!=F&&S!=null&&e(R,p,{configurable:!0,writable:!0,value:S})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(S){var R=[],F;for(F in S)Object.prototype.hasOwnProperty.call(S,F)&&R.push([F,S[F]]);return R}});var s=s||{},o=this||self;function a(p){var S=typeof p;return S=="object"&&p!=null||S=="function"}function c(p,S,R){return p.call.apply(p.bind,arguments)}function h(p,S,R){return h=c,h.apply(null,arguments)}function d(p,S){var R=Array.prototype.slice.call(arguments,1);return function(){var F=R.slice();return F.push.apply(F,arguments),p.apply(this,F)}}function g(p,S){function R(){}R.prototype=S.prototype,p.Z=S.prototype,p.prototype=new R,p.prototype.constructor=p,p.Ob=function(F,te,se){for(var xe=Array(arguments.length-2),et=2;et<arguments.length;et++)xe[et-2]=arguments[et];return S.prototype[te].apply(F,xe)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function y(p){const S=p.length;if(S>0){const R=Array(S);for(let F=0;F<S;F++)R[F]=p[F];return R}return[]}function w(p,S){for(let F=1;F<arguments.length;F++){const te=arguments[F];var R=typeof te;if(R=R!="object"?R:te?Array.isArray(te)?"array":R:"null",R=="array"||R=="object"&&typeof te.length=="number"){R=p.length||0;const se=te.length||0;p.length=R+se;for(let xe=0;xe<se;xe++)p[R+xe]=te[xe]}else p.push(te)}}class I{constructor(S,R){this.i=S,this.j=R,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function E(p){o.setTimeout(()=>{throw p},0)}function A(){var p=k;let S=null;return p.g&&(S=p.g,p.g=p.g.next,p.g||(p.h=null),S.next=null),S}class b{constructor(){this.h=this.g=null}add(S,R){const F=N.get();F.set(S,R),this.h?this.h.next=F:this.g=F,this.h=F}}var N=new I(()=>new D,p=>p.reset());class D{constructor(){this.next=this.g=this.h=null}set(S,R){this.h=S,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let O,$=!1,k=new b,C=()=>{const p=Promise.resolve(void 0);O=()=>{p.then(L)}};function L(){for(var p;p=A();){try{p.h.call(p.g)}catch(R){E(R)}var S=N;S.j(p),S.h<100&&(S.h++,p.next=S.g,S.g=p)}$=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(p,S){this.type=p,this.g=this.target=S,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,S=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const R=()=>{};o.addEventListener("test",R,S),o.removeEventListener("test",R,S)}catch{}return p})();function V(p){return/^[\s\xa0]*$/.test(p)}function de(p,S){G.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,S)}g(de,G),de.prototype.init=function(p,S){const R=this.type=p.type,F=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=S,S=p.relatedTarget,S||(R=="mouseover"?S=p.fromElement:R=="mouseout"&&(S=p.toElement)),this.relatedTarget=S,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Pe="closure_listenable_"+(Math.random()*1e6|0),ue=0;function fe(p,S,R,F,te){this.listener=p,this.proxy=null,this.src=S,this.type=R,this.capture=!!F,this.ha=te,this.key=++ue,this.da=this.fa=!1}function Q(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ge(p,S,R){for(const F in p)S.call(R,p[F],F,p)}function he(p,S){for(const R in p)S.call(void 0,p[R],R,p)}function K(p){const S={};for(const R in p)S[R]=p[R];return S}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function be(p,S){let R,F;for(let te=1;te<arguments.length;te++){F=arguments[te];for(R in F)p[R]=F[R];for(let se=0;se<W.length;se++)R=W[se],Object.prototype.hasOwnProperty.call(F,R)&&(p[R]=F[R])}}function ie(p){this.src=p,this.g={},this.h=0}ie.prototype.add=function(p,S,R,F,te){const se=p.toString();p=this.g[se],p||(p=this.g[se]=[],this.h++);const xe=P(p,S,F,te);return xe>-1?(S=p[xe],R||(S.fa=!1)):(S=new fe(S,this.src,se,!!F,te),S.fa=R,p.push(S)),S};function X(p,S){const R=S.type;if(R in p.g){var F=p.g[R],te=Array.prototype.indexOf.call(F,S,void 0),se;(se=te>=0)&&Array.prototype.splice.call(F,te,1),se&&(Q(S),p.g[R].length==0&&(delete p.g[R],p.h--))}}function P(p,S,R,F){for(let te=0;te<p.length;++te){const se=p[te];if(!se.da&&se.listener==S&&se.capture==!!R&&se.ha==F)return te}return-1}var Ee="closure_lm_"+(Math.random()*1e6|0),Y={};function Ie(p,S,R,F,te){if(Array.isArray(S)){for(let se=0;se<S.length;se++)Ie(p,S[se],R,F,te);return null}return R=ar(R),p&&p[Pe]?p.J(S,R,a(F)?!!F.capture:!1,te):Z(p,S,R,!1,F,te)}function Z(p,S,R,F,te,se){if(!S)throw Error("Invalid event type");const xe=a(te)?!!te.capture:!!te;let et=Ft(p);if(et||(p[Ee]=et=new ie(p)),R=et.add(S,R,F,xe,se),R.proxy)return R;if(F=U(),R.proxy=F,F.src=p,F.listener=R,p.addEventListener)z||(te=xe),te===void 0&&(te=!1),p.addEventListener(S.toString(),F,te);else if(p.attachEvent)p.attachEvent(rt(S.toString()),F);else if(p.addListener&&p.removeListener)p.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return R}function U(){function p(R){return S.call(p.src,p.listener,R)}const S=ht;return p}function ae(p,S,R,F,te){if(Array.isArray(S))for(var se=0;se<S.length;se++)ae(p,S[se],R,F,te);else F=a(F)?!!F.capture:!!F,R=ar(R),p&&p[Pe]?(p=p.i,se=String(S).toString(),se in p.g&&(S=p.g[se],R=P(S,R,F,te),R>-1&&(Q(S[R]),Array.prototype.splice.call(S,R,1),S.length==0&&(delete p.g[se],p.h--)))):p&&(p=Ft(p))&&(S=p.g[S.toString()],p=-1,S&&(p=P(S,R,F,te)),(R=p>-1?S[p]:null)&&Xe(R))}function Xe(p){if(typeof p!="number"&&p&&!p.da){var S=p.src;if(S&&S[Pe])X(S.i,p);else{var R=p.type,F=p.proxy;S.removeEventListener?S.removeEventListener(R,F,p.capture):S.detachEvent?S.detachEvent(rt(R),F):S.addListener&&S.removeListener&&S.removeListener(F),(R=Ft(S))?(X(R,p),R.h==0&&(R.src=null,S[Ee]=null)):Q(p)}}}function rt(p){return p in Y?Y[p]:Y[p]="on"+p}function ht(p,S){if(p.da)p=!0;else{S=new de(S,this);const R=p.listener,F=p.ha||p.src;p.fa&&Xe(p),p=R.call(F,S)}return p}function Ft(p){return p=p[Ee],p instanceof ie?p:null}var an="__closure_events_fn_"+(Math.random()*1e9>>>0);function ar(p){return typeof p=="function"?p:(p[an]||(p[an]=function(S){return p.handleEvent(S)}),p[an])}function Nt(){j.call(this),this.i=new ie(this),this.M=this,this.G=null}g(Nt,j),Nt.prototype[Pe]=!0,Nt.prototype.removeEventListener=function(p,S,R,F){ae(this,p,S,R,F)};function It(p,S){var R,F=p.G;if(F)for(R=[];F;F=F.G)R.push(F);if(p=p.M,F=S.type||S,typeof S=="string")S=new G(S,p);else if(S instanceof G)S.target=S.target||p;else{var te=S;S=new G(F,p),be(S,te)}te=!0;let se,xe;if(R)for(xe=R.length-1;xe>=0;xe--)se=S.g=R[xe],te=Mn(se,F,!0,S)&&te;if(se=S.g=p,te=Mn(se,F,!0,S)&&te,te=Mn(se,F,!1,S)&&te,R)for(xe=0;xe<R.length;xe++)se=S.g=R[xe],te=Mn(se,F,!1,S)&&te}Nt.prototype.N=function(){if(Nt.Z.N.call(this),this.i){var p=this.i;for(const S in p.g){const R=p.g[S];for(let F=0;F<R.length;F++)Q(R[F]);delete p.g[S],p.h--}}this.G=null},Nt.prototype.J=function(p,S,R,F){return this.i.add(String(p),S,!1,R,F)},Nt.prototype.K=function(p,S,R,F){return this.i.add(String(p),S,!0,R,F)};function Mn(p,S,R,F){if(S=p.i.g[String(S)],!S)return!0;S=S.concat();let te=!0;for(let se=0;se<S.length;++se){const xe=S[se];if(xe&&!xe.da&&xe.capture==R){const et=xe.listener,un=xe.ha||xe.src;xe.fa&&X(p.i,xe),te=et.call(un,F)!==!1&&te}}return te&&!F.defaultPrevented}function lr(p,S){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(p,S||0)}function $t(p){p.g=lr(()=>{p.g=null,p.i&&(p.i=!1,$t(p))},p.l);const S=p.h;p.h=null,p.m.apply(null,S)}class Go extends j{constructor(S,R){super(),this.m=S,this.l=R,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:$t(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cr(p){j.call(this),this.h=p,this.g={}}g(cr,j);var ns=[];function Nr(p){ge(p.g,function(S,R){this.g.hasOwnProperty(R)&&Xe(S)},p),p.g={}}cr.prototype.N=function(){cr.Z.N.call(this),Nr(this)},cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var is=o.JSON.stringify,dl=o.JSON.parse,rs=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function ur(){}function Yc(){}var ss={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Qs(){G.call(this,"d")}g(Qs,G);function Uo(){G.call(this,"c")}g(Uo,G);var gi={},Zs=null;function os(){return Zs=Zs||new Nt}gi.Ia="serverreachability";function as(p){G.call(this,gi.Ia,p)}g(as,G);function mi(p){const S=os();It(S,new as(S))}gi.STAT_EVENT="statevent";function pi(p,S){G.call(this,gi.STAT_EVENT,p),this.stat=S}g(pi,G);function Mt(p){const S=os();It(S,new pi(S,p))}gi.Ja="timingevent";function Bo(p,S){G.call(this,gi.Ja,p),this.size=S}g(Bo,G);function Or(p,S){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},S)}function ln(){this.g=!0}ln.prototype.ua=function(){this.g=!1};function hr(p,S,R,F,te,se){p.info(function(){if(p.g)if(se){var xe="",et=se.split("&");for(let Tt=0;Tt<et.length;Tt++){var un=et[Tt].split("=");if(un.length>1){const mn=un[0];un=un[1];const Ki=mn.split("_");xe=Ki.length>=2&&Ki[1]=="type"?xe+(mn+"="+un+"&"):xe+(mn+"=redacted&")}}}else xe=null;else xe=se;return"XMLHTTP REQ ("+F+") [attempt "+te+"]: "+S+`
`+R+`
`+xe})}function Gn(p,S,R,F,te,se,xe){p.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+te+"]: "+S+`
`+R+`
`+se+" "+xe})}function cn(p,S,R,F){p.info(function(){return"XMLHTTP TEXT ("+S+"): "+Bn(p,R)+(F?" "+F:"")})}function Un(p,S){p.info(function(){return"TIMEOUT: "+S})}ln.prototype.info=function(){};function Bn(p,S){if(!p.g)return S;if(!S)return null;try{const se=JSON.parse(S);if(se){for(p=0;p<se.length;p++)if(Array.isArray(se[p])){var R=se[p];if(!(R.length<2)){var F=R[1];if(Array.isArray(F)&&!(F.length<1)){var te=F[0];if(te!="noop"&&te!="stop"&&te!="close")for(let xe=1;xe<F.length;xe++)F[xe]=""}}}}return is(se)}catch{return S}}var kn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_t={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},gn;function xn(){}g(xn,ur),xn.prototype.g=function(){return new XMLHttpRequest},gn=new xn;function dr(p){return encodeURIComponent(String(p))}function Xc(p){var S=1;p=p.split(":");const R=[];for(;S>0&&p.length;)R.push(p.shift()),S--;return p.length&&R.push(p.join(":")),R}function fr(p,S,R,F){this.j=p,this.i=S,this.l=R,this.S=F||1,this.V=new cr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Sm}function Sm(){this.i=null,this.g="",this.h=!1}var Im={},cd={};function Dr(p,S,R){p.M=1,p.A=eo(gr(S)),p.u=R,p.R=!0,ud(p,null)}function ud(p,S){p.F=Date.now(),fl(p),p.B=gr(p.A);var R=p.B,F=p.S;Array.isArray(F)||(F=[String(F)]),Ed(R.i,"t",F),p.C=0,R=p.j.L,p.h=new Sm,p.g=Nm(p.j,R?S:null,!p.u),p.P>0&&(p.O=new Go(h(p.Y,p,p.g),p.P)),S=p.V,R=p.g,F=p.ba;var te="readystatechange";Array.isArray(te)||(te&&(ns[0]=te.toString()),te=ns);for(let se=0;se<te.length;se++){const xe=Ie(R,te[se],F||S.handleEvent,!1,S.h||S);if(!xe)break;S.g[xe.key]=xe}S=p.J?K(p.J):{},p.u?(p.v||(p.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,S)):(p.v="GET",p.g.ea(p.B,p.v,null,S)),mi(),hr(p.i,p.v,p.B,p.l,p.S,p.u)}fr.prototype.ba=function(p){p=p.target;const S=this.O;S&&gs(p)==3?S.j():this.Y(p)},fr.prototype.Y=function(p){try{if(p==this.g)e:{const et=gs(this.g),un=this.g.ya(),Tt=this.g.ca();if(!(et<3)&&(et!=3||this.g&&(this.h.h||this.g.la()||km(this.g)))){this.K||et!=4||un==7||(un==8||Tt<=0?mi(3):mi(2)),Qc(this);var S=this.g.ca();this.X=S;var R=Tm(this);if(this.o=S==200,Gn(this.i,this.v,this.B,this.l,this.S,et,S),this.o){if(this.U&&!this.L){t:{if(this.g){var F,te=this.g;if((F=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(F)){var se=F;break t}}se=null}if(p=se)cn(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,jt(this,p);else{this.o=!1,this.m=3,Mt(12),Js(this),gl(this);break e}}if(this.R){p=!0;let mn;for(;!this.K&&this.C<R.length;)if(mn=Am(this,R),mn==cd){et==4&&(this.m=4,Mt(14),p=!1),cn(this.i,this.l,null,"[Incomplete Response]");break}else if(mn==Im){this.m=4,Mt(15),cn(this.i,this.l,R,"[Invalid Chunk]"),p=!1;break}else cn(this.i,this.l,mn,null),jt(this,mn);if(Rm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),et!=4||R.length!=0||this.h.h||(this.m=1,Mt(16),p=!1),this.o=this.o&&p,!p)cn(this.i,this.l,R,"[Invalid Chunked Response]"),Js(this),gl(this);else if(R.length>0&&!this.W){this.W=!0;var xe=this.j;xe.g==this&&xe.aa&&!xe.P&&(xe.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),Sl(xe),xe.P=!0,Mt(11))}}else cn(this.i,this.l,R,null),jt(this,R);et==4&&Js(this),this.o&&!this.K&&(et==4?au(this.j,this):(this.o=!1,fl(this)))}else xd(this.g),S==400&&R.indexOf("Unknown SID")>0?(this.m=3,Mt(12)):(this.m=0,Mt(13)),Js(this),gl(this)}}}catch{}};function Tm(p){if(!Rm(p))return p.g.la();const S=km(p.g);if(S==="")return"";let R="";const F=S.length,te=gs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Js(p),gl(p),"";p.h.i=new o.TextDecoder}for(let se=0;se<F;se++)p.h.h=!0,R+=p.h.i.decode(S[se],{stream:!(te&&se==F-1)});return S.length=0,p.h.g+=R,p.C=0,p.h.g}function Rm(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Am(p,S){var R=p.C,F=S.indexOf(`
`,R);return F==-1?cd:(R=Number(S.substring(R,F)),isNaN(R)?Im:(F+=1,F+R>S.length?cd:(S=S.slice(F,F+R),p.C=F+R,S)))}fr.prototype.cancel=function(){this.K=!0,Js(this)};function fl(p){p.T=Date.now()+p.H,hd(p,p.H)}function hd(p,S){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Or(h(p.aa,p),S)}function Qc(p){p.D&&(o.clearTimeout(p.D),p.D=null)}fr.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Un(this.i,this.B),this.M!=2&&(mi(),Mt(17)),Js(this),this.m=2,gl(this)):hd(this,this.T-p)};function gl(p){p.j.I==0||p.K||au(p.j,p)}function Js(p){Qc(p);var S=p.O;S&&typeof S.dispose=="function"&&S.dispose(),p.O=null,Nr(p.V),p.g&&(S=p.g,p.g=null,S.abort(),S.dispose())}function jt(p,S){try{var R=p.j;if(R.I!=0&&(R.g==p||fd(R.h,p))){if(!p.L&&fd(R.h,p)&&R.I==3){try{var F=R.Ba.g.parse(S)}catch{F=null}if(Array.isArray(F)&&F.length==3){var te=F;if(te[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<p.F)ou(R),Wi(R);else break e;_s(R),Mt(18)}}else R.xa=te[1],0<R.xa-R.K&&te[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=Or(h(R.Va,R),6e3));ml(R.h)<=1&&R.ta&&(R.ta=void 0)}else Hi(R,11)}else if((p.L||R.g==p)&&ou(R),!V(S))for(te=R.Ba.g.parse(S),S=0;S<te.length;S++){let Tt=te[S];const mn=Tt[0];if(!(mn<=R.K))if(R.K=mn,Tt=Tt[1],R.I==2)if(Tt[0]=="c"){R.M=Tt[1],R.ba=Tt[2];const Ki=Tt[3];Ki!=null&&(R.ka=Ki,R.j.info("VER="+R.ka));const so=Tt[4];so!=null&&(R.za=so,R.j.info("SVER="+R.za));const ys=Tt[5];ys!=null&&typeof ys=="number"&&ys>0&&(F=1.5*ys,R.O=F,R.j.info("backChannelRequestTimeoutMs_="+F)),F=R;const vs=p.g;if(vs){const uu=vs.g?vs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(uu){var se=F.h;se.g||uu.indexOf("spdy")==-1&&uu.indexOf("quic")==-1&&uu.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(Jc(se,se.h),se.h=null))}if(F.G){const Td=vs.g?vs.g.getResponseHeader("X-HTTP-Session-Id"):null;Td&&(F.wa=Td,yt(F.J,F.G,Td))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-p.F,R.j.info("Handshake RTT: "+R.T+"ms")),F=R;var xe=p;if(F.na=Id(F,F.L?F.ba:null,F.W),xe.L){pl(F.h,xe);var et=xe,un=F.O;un&&(et.H=un),et.D&&(Qc(et),fl(et)),F.g=xe}else ei(F);R.i.length>0&&ro(R)}else Tt[0]!="stop"&&Tt[0]!="close"||Hi(R,7);else R.I==3&&(Tt[0]=="stop"||Tt[0]=="close"?Tt[0]=="stop"?Hi(R,7):ru(R):Tt[0]!="noop"&&R.l&&R.l.qa(Tt),R.A=0)}}mi(4)}catch{}}var iv=class{constructor(p,S){this.g=p,this.map=S}};function Zc(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function dd(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function ml(p){return p.h?1:p.g?p.g.size:0}function fd(p,S){return p.h?p.h==S:p.g?p.g.has(S):!1}function Jc(p,S){p.g?p.g.add(S):p.h=S}function pl(p,S){p.h&&p.h==S?p.h=null:p.g&&p.g.has(S)&&p.g.delete(S)}Zc.prototype.cancel=function(){if(this.i=Bi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Bi(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let S=p.i;for(const R of p.g.values())S=S.concat(R.G);return S}return y(p.i)}var Pm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zi(p,S){if(p){p=p.split("&");for(let R=0;R<p.length;R++){const F=p[R].indexOf("=");let te,se=null;F>=0?(te=p[R].substring(0,F),se=p[R].substring(F+1)):te=p[R],S(te,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function ls(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;p instanceof ls?(this.l=p.l,_l(this,p.j),this.o=p.o,this.g=p.g,cs(this,p.u),this.h=p.h,zo(this,wd(p.i)),this.m=p.m):p&&(S=String(p).match(Pm))?(this.l=!1,_l(this,S[1]||"",!0),this.o=yl(S[2]||""),this.g=yl(S[3]||"",!0),cs(this,S[4]),this.h=yl(S[5]||"",!0),zo(this,S[6]||"",!0),this.m=yl(S[7]||"")):(this.l=!1,this.i=new ct(null,this.l))}ls.prototype.toString=function(){const p=[];var S=this.j;S&&p.push(vl(S,md,!0),":");var R=this.g;return(R||S=="file")&&(p.push("//"),(S=this.o)&&p.push(vl(S,md,!0),"@"),p.push(dr(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&p.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&p.push("/"),p.push(vl(R,R.charAt(0)=="/"?El:pd,!0))),(R=this.i.toString())&&p.push("?",R),(R=this.m)&&p.push("#",vl(R,_d)),p.join("")},ls.prototype.resolve=function(p){const S=gr(this);let R=!!p.j;R?_l(S,p.j):R=!!p.o,R?S.o=p.o:R=!!p.g,R?S.g=p.g:R=p.u!=null;var F=p.h;if(R)cs(S,p.u);else if(R=!!p.h){if(F.charAt(0)!="/")if(this.g&&!this.h)F="/"+F;else{var te=S.h.lastIndexOf("/");te!=-1&&(F=S.h.slice(0,te+1)+F)}if(te=F,te==".."||te==".")F="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){F=te.lastIndexOf("/",0)==0,te=te.split("/");const se=[];for(let xe=0;xe<te.length;){const et=te[xe++];et=="."?F&&xe==te.length&&se.push(""):et==".."?((se.length>1||se.length==1&&se[0]!="")&&se.pop(),F&&xe==te.length&&se.push("")):(se.push(et),F=!0)}F=se.join("/")}else F=te}return R?S.h=F:R=p.i.toString()!=="",R?zo(S,wd(p.i)):R=!!p.m,R&&(S.m=p.m),S};function gr(p){return new ls(p)}function _l(p,S,R){p.j=R?yl(S,!0):S,p.j&&(p.j=p.j.replace(/:$/,""))}function cs(p,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);p.u=S}else p.u=null}function zo(p,S,R){S instanceof ct?(p.i=S,tu(p.i,p.l)):(R||(S=vl(S,rv)),p.i=new ct(S,p.l))}function yt(p,S,R){p.i.set(S,R)}function eo(p){return yt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function yl(p,S){return p?S?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function vl(p,S,R){return typeof p=="string"?(p=encodeURI(p).replace(S,gd),R&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function gd(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var md=/[#\/\?@]/g,pd=/[#\?:]/g,El=/[#\?]/g,rv=/[#\?@]/g,_d=/#/g;function ct(p,S){this.h=this.g=null,this.i=p||null,this.j=!!S}function us(p){p.g||(p.g=new Map,p.h=0,p.i&&zi(p.i,function(S,R){p.add(decodeURIComponent(S.replace(/\+/g," ")),R)}))}n=ct.prototype,n.add=function(p,S){us(this),this.i=null,p=hs(this,p);let R=this.g.get(p);return R||this.g.set(p,R=[]),R.push(S),this.h+=1,this};function yd(p,S){us(p),S=hs(p,S),p.g.has(S)&&(p.i=null,p.h-=p.g.get(S).length,p.g.delete(S))}function eu(p,S){return us(p),S=hs(p,S),p.g.has(S)}n.forEach=function(p,S){us(this),this.g.forEach(function(R,F){R.forEach(function(te){p.call(S,te,F,this)},this)},this)};function vd(p,S){us(p);let R=[];if(typeof S=="string")eu(p,S)&&(R=R.concat(p.g.get(hs(p,S))));else for(p=Array.from(p.g.values()),S=0;S<p.length;S++)R=R.concat(p[S]);return R}n.set=function(p,S){return us(this),this.i=null,p=hs(this,p),eu(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[S]),this.h+=1,this},n.get=function(p,S){return p?(p=vd(this,p),p.length>0?String(p[0]):S):S};function Ed(p,S,R){yd(p,S),R.length>0&&(p.i=null,p.g.set(hs(p,S),y(R)),p.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],S=Array.from(this.g.keys());for(let F=0;F<S.length;F++){var R=S[F];const te=dr(R);R=vd(this,R);for(let se=0;se<R.length;se++){let xe=te;R[se]!==""&&(xe+="="+dr(R[se])),p.push(xe)}}return this.i=p.join("&")};function wd(p){const S=new ct;return S.i=p.i,p.g&&(S.g=new Map(p.g),S.h=p.h),S}function hs(p,S){return S=String(S),p.j&&(S=S.toLowerCase()),S}function tu(p,S){S&&!p.j&&(us(p),p.i=null,p.g.forEach(function(R,F){const te=F.toLowerCase();F!=te&&(yd(this,F),Ed(this,te,R))},p)),p.j=S}function ds(p,S){const R=new ln;if(o.Image){const F=new Image;F.onload=d(zn,R,"TestLoadImage: loaded",!0,S,F),F.onerror=d(zn,R,"TestLoadImage: error",!1,S,F),F.onabort=d(zn,R,"TestLoadImage: abort",!1,S,F),F.ontimeout=d(zn,R,"TestLoadImage: timeout",!1,S,F),o.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=p}else S(!1)}function fs(p,S){const R=new ln,F=new AbortController,te=setTimeout(()=>{F.abort(),zn(R,"TestPingServer: timeout",!1,S)},1e4);fetch(p,{signal:F.signal}).then(se=>{clearTimeout(te),se.ok?zn(R,"TestPingServer: ok",!0,S):zn(R,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(te),zn(R,"TestPingServer: error",!1,S)})}function zn(p,S,R,F,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),F(R)}catch{}}function wl(){this.g=new rs}function to(p){this.i=p.Sb||null,this.h=p.ab||!1}g(to,ur),to.prototype.g=function(){return new $i(this.i,this.h)};function $i(p,S){Nt.call(this),this.H=p,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g($i,Nt),n=$i.prototype,n.open=function(p,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=S,this.readyState=1,Vr(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(S.body=p),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,$o(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Vr(this)),this.g&&(this.readyState=3,Vr(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cm(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cm(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var S=p.value?p.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!p.done}))&&(this.response=this.responseText+=S)}p.done?$o(this):Vr(this),this.readyState==3&&Cm(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,$o(this))},n.Na=function(p){this.g&&(this.response=p,$o(this))},n.ga=function(){this.g&&$o(this)};function $o(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Vr(p)}n.setRequestHeader=function(p,S){this.A.append(p,S)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],S=this.h.entries();for(var R=S.next();!R.done;)R=R.value,p.push(R[0]+": "+R[1]),R=S.next();return p.join(`\r
`)};function Vr(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty($i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function bm(p){let S="";return ge(p,function(R,F){S+=F,S+=":",S+=R,S+=`\r
`}),S}function nu(p,S,R){e:{for(F in R){var F=!1;break e}F=!0}F||(R=bm(R),typeof p=="string"?R!=null&&dr(R):yt(p,S,R))}function kt(p){Nt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(kt,Nt);var Mm=/^https?$/i,sv=["POST","PUT"];n=kt.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,S,R,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);S=S?S.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():gn.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(S,String(p),!0),this.B=!1}catch(se){Wo(this,se);return}if(p=R||"",R=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var te in F)R.set(te,F[te]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const se of F.keys())R.set(se,F.get(se));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(R.keys()).find(se=>se.toLowerCase()=="content-type"),te=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(sv,S,void 0)>=0)||F||te||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,xe]of R)this.g.setRequestHeader(se,xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(se){Wo(this,se)}};function Wo(p,S){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=S,p.o=5,Ho(p),io(p)}function Ho(p){p.A||(p.A=!0,It(p,"complete"),It(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,It(this,"complete"),It(this,"abort"),io(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),io(this,!0)),kt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?no(this):this.Xa())},n.Xa=function(){no(this)};function no(p){if(p.h&&typeof s<"u"){if(p.v&&gs(p)==4)setTimeout(p.Ca.bind(p),0);else if(It(p,"readystatechange"),gs(p)==4){p.h=!1;try{const se=p.ca();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var R;if(!(R=S)){var F;if(F=se===0){let xe=String(p.D).match(Pm)[1]||null;!xe&&o.self&&o.self.location&&(xe=o.self.location.protocol.slice(0,-1)),F=!Mm.test(xe?xe.toLowerCase():"")}R=F}if(R)It(p,"complete"),It(p,"success");else{p.o=6;try{var te=gs(p)>2?p.g.statusText:""}catch{te=""}p.l=te+" ["+p.ca()+"]",Ho(p)}}finally{io(p)}}}}function io(p,S){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const R=p.g;p.g=null,S||It(p,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function gs(p){return p.g?p.g.readyState:0}n.ca=function(){try{return gs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var S=this.g.responseText;return p&&S.indexOf(p)==0&&(S=S.substring(p.length)),dl(S)}};function km(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function xd(p){const S={};p=(p.g&&gs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<p.length;F++){if(V(p[F]))continue;var R=Xc(p[F]);const te=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const se=S[te]||[];S[te]=se,se.push(R)}he(S,function(F){return F.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ms(p,S,R){return R&&R.internalChannelParams&&R.internalChannelParams[p]||S}function iu(p){this.za=0,this.i=[],this.j=new ln,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ms("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ms("baseRetryDelayMs",5e3,p),this.Za=ms("retryDelaySeedMs",1e4,p),this.Ta=ms("forwardChannelMaxRetries",2,p),this.va=ms("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Zc(p&&p.concurrentRequestLimit),this.Ba=new wl,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=iu.prototype,n.ka=8,n.I=1,n.connect=function(p,S,R,F){Mt(0),this.W=p,this.H=S||{},R&&F!==void 0&&(this.H.OSID=R,this.H.OAID=F),this.F=this.X,this.J=Id(this,null,this.W),ro(this)};function ru(p){if(su(p),p.I==3){var S=p.V++,R=gr(p.J);if(yt(R,"SID",p.M),yt(R,"RID",S),yt(R,"TYPE","terminate"),ps(p,R),S=new fr(p,p.j,S),S.M=2,S.A=eo(gr(R)),R=!1,o.navigator&&o.navigator.sendBeacon)try{R=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!R&&o.Image&&(new Image().src=S.A,R=!0),R||(S.g=Nm(S.j,null),S.g.ea(S.A)),S.F=Date.now(),fl(S)}Il(p)}function Wi(p){p.g&&(Sl(p),p.g.cancel(),p.g=null)}function su(p){Wi(p),p.v&&(o.clearTimeout(p.v),p.v=null),ou(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function ro(p){if(!dd(p.h)&&!p.m){p.m=!0;var S=p.Ea;O||C(),$||(O(),$=!0),k.add(S,p),p.D=0}}function Lm(p,S){return ml(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=S.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Or(h(p.Ea,p,S),lu(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const te=new fr(this,this.j,p);let se=this.o;if(this.U&&(se?(se=K(se),be(se,this.U)):se=this.U),this.u!==null||this.R||(te.J=se,se=null),this.S)e:{for(var S=0,R=0;R<this.i.length;R++){t:{var F=this.i[R];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(S+=F,S>4096){S=R;break e}if(S===4096||R===this.i.length-1){S=R+1;break e}}S=1e3}else S=1e3;S=Sd(this,te,S),R=gr(this.J),yt(R,"RID",p),yt(R,"CVER",22),this.G&&yt(R,"X-HTTP-Session-Id",this.G),ps(this,R),se&&(this.R?S="headers="+dr(bm(se))+"&"+S:this.u&&nu(R,this.u,se)),Jc(this.h,te),this.Ra&&yt(R,"TYPE","init"),this.S?(yt(R,"$req",S),yt(R,"SID","null"),te.U=!0,Dr(te,R,null)):Dr(te,R,S),this.I=2}}else this.I==3&&(p?xl(this,p):this.i.length==0||dd(this.h)||xl(this))};function xl(p,S){var R;S?R=S.l:R=p.V++;const F=gr(p.J);yt(F,"SID",p.M),yt(F,"RID",R),yt(F,"AID",p.K),ps(p,F),p.u&&p.o&&nu(F,p.u,p.o),R=new fr(p,p.j,R,p.D+1),p.u===null&&(R.J=p.o),S&&(p.i=S.G.concat(p.i)),S=Sd(p,R,1e3),R.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Jc(p.h,R),Dr(R,F,S)}function ps(p,S){p.H&&ge(p.H,function(R,F){yt(S,F,R)}),p.l&&ge({},function(R,F){yt(S,F,R)})}function Sd(p,S,R){R=Math.min(p.i.length,R);const F=p.l?h(p.l.Ka,p.l,p):null;e:{var te=p.i;let et=-1;for(;;){const un=["count="+R];et==-1?R>0?(et=te[0].g,un.push("ofs="+et)):et=0:un.push("ofs="+et);let Tt=!0;for(let mn=0;mn<R;mn++){var se=te[mn].g;const Ki=te[mn].map;if(se-=et,se<0)et=Math.max(0,te[mn].g-100),Tt=!1;else try{se="req"+se+"_"||"";try{var xe=Ki instanceof Map?Ki:Object.entries(Ki);for(const[so,ys]of xe){let vs=ys;a(ys)&&(vs=is(ys)),un.push(se+so+"="+encodeURIComponent(vs))}}catch(so){throw un.push(se+"type="+encodeURIComponent("_badmap")),so}}catch{F&&F(Ki)}}if(Tt){xe=un.join("&");break e}}xe=void 0}return p=p.i.splice(0,R),S.G=p,xe}function ei(p){if(!p.g&&!p.v){p.Y=1;var S=p.Da;O||C(),$||(O(),$=!0),k.add(S,p),p.A=0}}function _s(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Or(h(p.Da,p),lu(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Ko(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Or(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Mt(10),Wi(this),Ko(this))};function Sl(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Ko(p){p.g=new fr(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var S=gr(p.na);yt(S,"RID","rpc"),yt(S,"SID",p.M),yt(S,"AID",p.K),yt(S,"CI",p.F?"0":"1"),!p.F&&p.ia&&yt(S,"TO",p.ia),yt(S,"TYPE","xmlhttp"),ps(p,S),p.u&&p.o&&nu(S,p.u,p.o),p.O&&(p.g.H=p.O);var R=p.g;p=p.ba,R.M=1,R.A=eo(gr(S)),R.u=null,R.R=!0,ud(R,p)}n.Va=function(){this.C!=null&&(this.C=null,Wi(this),_s(this),Mt(19))};function ou(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function au(p,S){var R=null;if(p.g==S){ou(p),Sl(p),p.g=null;var F=2}else if(fd(p.h,S))R=S.G,pl(p.h,S),F=1;else return;if(p.I!=0){if(S.o)if(F==1){R=S.u?S.u.length:0,S=Date.now()-S.F;var te=p.D;F=os(),It(F,new Bo(F,R)),ro(p)}else ei(p);else if(te=S.m,te==3||te==0&&S.X>0||!(F==1&&Lm(p,S)||F==2&&_s(p)))switch(R&&R.length>0&&(S=p.h,S.i=S.i.concat(R)),te){case 1:Hi(p,5);break;case 4:Hi(p,10);break;case 3:Hi(p,6);break;default:Hi(p,2)}}}function lu(p,S){let R=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(R*=2),R*S}function Hi(p,S){if(p.j.info("Error code "+S),S==2){var R=h(p.bb,p),F=p.Ua;const te=!F;F=new ls(F||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||_l(F,"https"),eo(F),te?ds(F.toString(),R):fs(F.toString(),R)}else Mt(2);p.I=0,p.l&&p.l.pa(S),Il(p),su(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))};function Il(p){if(p.I=0,p.ja=[],p.l){const S=Bi(p.h);(S.length!=0||p.i.length!=0)&&(w(p.ja,S),w(p.ja,p.i),p.h.i.length=0,y(p.i),p.i.length=0),p.l.oa()}}function Id(p,S,R){var F=R instanceof ls?gr(R):new ls(R);if(F.g!="")S&&(F.g=S+"."+F.g),cs(F,F.u);else{var te=o.location;F=te.protocol,S=S?S+"."+te.hostname:te.hostname,te=+te.port;const se=new ls(null);F&&_l(se,F),S&&(se.g=S),te&&cs(se,te),R&&(se.h=R),F=se}return R=p.G,S=p.wa,R&&S&&yt(F,R,S),yt(F,"VER",p.ka),ps(p,F),F}function Nm(p,S,R){if(S&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=p.Aa&&!p.ma?new kt(new to({ab:R})):new kt(p.ma),S.Fa(p.L),S}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Om(){}n=Om.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function cu(){}cu.prototype.g=function(p,S){return new $n(p,S)};function $n(p,S){Nt.call(this),this.g=new iu(S),this.l=p,this.h=S&&S.messageUrlParams||null,p=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(p?p["X-WebChannel-Content-Type"]=S.messageContentType:p={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(p?p["X-WebChannel-Client-Profile"]=S.sa:p={"X-WebChannel-Client-Profile":S.sa}),this.g.U=p,(p=S&&S.Qb)&&!V(p)&&(this.g.u=p),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!V(S)&&(this.g.G=S,p=this.h,p!==null&&S in p&&(p=this.h,S in p&&delete p[S])),this.j=new qo(this)}g($n,Nt),$n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){ru(this.g)},$n.prototype.o=function(p){var S=this.g;if(typeof p=="string"){var R={};R.__data__=p,p=R}else this.v&&(R={},R.__data__=is(p),p=R);S.i.push(new iv(S.Ya++,p)),S.I==3&&ro(S)},$n.prototype.N=function(){this.g.l=null,delete this.j,ru(this.g),delete this.g,$n.Z.N.call(this)};function Dm(p){Qs.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var S=p.__sm__;if(S){e:{for(const R in S){p=R;break e}p=void 0}(this.i=p)&&(p=this.i,S=S!==null&&p in S?S[p]:void 0),this.data=S}else this.data=p}g(Dm,Qs);function Vm(){Uo.call(this),this.status=1}g(Vm,Uo);function qo(p){this.g=p}g(qo,Om),qo.prototype.ra=function(){It(this.g,"a")},qo.prototype.qa=function(p){It(this.g,new Dm(p))},qo.prototype.pa=function(p){It(this.g,new Vm)},qo.prototype.oa=function(){It(this.g,"b")},cu.prototype.createWebChannel=cu.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,H4=function(){return new cu},W4=function(){return os()},$4=gi,ww={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},kn.NO_ERROR=0,kn.TIMEOUT=8,kn.HTTP_ERROR=6,u0=kn,_t.COMPLETE="complete",z4=_t,Yc.EventType=ss,ss.OPEN="a",ss.CLOSE="b",ss.ERROR="c",ss.MESSAGE="d",Nt.prototype.listen=Nt.prototype.J,_f=Yc,kt.prototype.listenOnce=kt.prototype.K,kt.prototype.getLastError=kt.prototype.Ha,kt.prototype.getLastErrorCode=kt.prototype.ya,kt.prototype.getStatus=kt.prototype.ca,kt.prototype.getResponseJson=kt.prototype.La,kt.prototype.getResponseText=kt.prototype.la,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Fa,B4=kt}).apply(typeof zp<"u"?zp:typeof self<"u"?self:typeof window<"u"?window:{});const JA="@firebase/firestore",eP="4.9.3";class Xn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xn.UNAUTHENTICATED=new Xn(null),Xn.GOOGLE_CREDENTIALS=new Xn("google-credentials-uid"),Xn.FIRST_PARTY=new Xn("first-party-uid"),Xn.MOCK_USER=new Xn("mock-user");let ed="12.7.0";const Tc=new gS("@firebase/firestore");function Qu(){return Tc.logLevel}function ve(n,...e){if(Tc.logLevel<=at.DEBUG){const t=e.map(_S);Tc.debug(`Firestore (${ed}): ${n}`,...t)}}function wi(n,...e){if(Tc.logLevel<=at.ERROR){const t=e.map(_S);Tc.error(`Firestore (${ed}): ${n}`,...t)}}function Rc(n,...e){if(Tc.logLevel<=at.WARN){const t=e.map(_S);Tc.warn(`Firestore (${ed}): ${n}`,...t)}}function _S(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ne(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,K4(n,i,t)}function K4(n,e,t){let i=`FIRESTORE (${ed}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw wi(i),new Error(i)}function je(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||K4(e,r,i)}function Je(n,e){return n}const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends qs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ao{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class q4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class a7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Xn.UNAUTHENTICATED)))}shutdown(){}}class l7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class c7{constructor(e){this.t=e,this.currentUser=Xn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){je(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let s=new Ao;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ao,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await r(this.currentUser)}))},a=c=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ao)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(je(typeof i.accessToken=="string",31837,{l:i}),new q4(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string",2055,{h:e}),new Xn(e)}}class u7{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Xn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class h7{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new u7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Xn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class d7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){je(this.o===void 0,3512);const i=s=>{s.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ve("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tP(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tP(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function f7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class yS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=f7(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Ze(n,e){return n<e?-1:n>e?1:0}function xw(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return gE(r)===gE(s)?Ze(r,s):gE(r)?1:-1}return Ze(n.length,e.length)}const g7=55296,m7=57343;function gE(n){const e=n.charCodeAt(0);return e>=g7&&e<=m7}function Oh(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Y4(n){return n+"\0"}const nP="__name__";class Is{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ne(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ne(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Is.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Is?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Is.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Ze(e.length,t.length)}static compareSegments(e,t){const i=Is.isNumericId(e),r=Is.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Is.extractNumericId(e).compare(Is.extractNumericId(t)):xw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ua.fromString(e.substring(4,e.length-2))}}class Et extends Is{construct(e,t,i){return new Et(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Te(le.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Et(t)}static emptyPath(){return new Et([])}}const p7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jt extends Is{construct(e,t,i){return new Jt(e,t,i)}static isValidIdentifier(e){return p7.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nP}static keyField(){return new Jt([nP])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Te(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Te(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Te(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Te(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jt(t)}static emptyPath(){return new Jt([])}}class Re{constructor(e){this.path=e}static fromPath(e){return new Re(Et.fromString(e))}static fromName(e){return new Re(Et.fromString(e).popFirst(5))}static empty(){return new Re(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Et.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Re(new Et(e.slice()))}}function X4(n,e,t){if(!t)throw new Te(le.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function _7(n,e,t,i){if(e===!0&&i===!0)throw new Te(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iP(n){if(!Re.isDocumentKey(n))throw new Te(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rP(n){if(Re.isDocumentKey(n))throw new Te(le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Q4(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wy(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ne(12329,{type:typeof n})}function Qa(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Te(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wy(n);throw new Te(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function En(n,e){const t={typeString:n};return e&&(t.value=e),t}function tm(n,e){if(!Q4(n))throw new Te(le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Te(le.INVALID_ARGUMENT,t);return!0}const sP=-62135596800,oP=1e6;class Pt{static now(){return Pt.fromMillis(Date.now())}static fromDate(e){return Pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*oP);return new Pt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<sP)throw new Te(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/oP}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(tm(e,Pt._jsonSchema))return new Pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sP;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pt._jsonSchemaVersion="firestore/timestamp/1.0",Pt._jsonSchema={type:En("string",Pt._jsonSchemaVersion),seconds:En("number"),nanoseconds:En("number")};class Ge{static fromTimestamp(e){return new Ge(e)}static min(){return new Ge(new Pt(0,0))}static max(){return new Ge(new Pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const dg=-1;class a_{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Sw(n){return n.fields.find((e=>e.kind===2))}function Wl(n){return n.fields.filter((e=>e.kind!==2))}a_.UNKNOWN_ID=-1;class h0{constructor(e,t){this.fieldPath=e,this.kind=t}}class fg{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new fg(0,sr.min())}}function y7(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ge.fromTimestamp(i===1e9?new Pt(t+1,0):new Pt(t,i));return new sr(r,Re.empty(),e)}function Z4(n){return new sr(n.readTime,n.key,dg)}class sr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new sr(Ge.min(),Re.empty(),dg)}static max(){return new sr(Ge.max(),Re.empty(),dg)}}function vS(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Re.comparator(n.documentKey,e.documentKey),t!==0?t:Ze(n.largestBatchId,e.largestBatchId))}const J4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Wc(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==J4)throw n;ve("LocalStore","Unexpectedly lost primary lease")}class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new J(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof J?t:J.resolve(t)}catch(t){return J.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):J.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):J.reject(t)}static resolve(e){return new J(((t,i)=>{t(e)}))}static reject(e){return new J(((t,i)=>{i(e)}))}static waitFor(e){return new J(((t,i)=>{let r=0,s=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&t()}),(c=>i(c)))})),o=!0,s===r&&t()}))}static or(e){let t=J.resolve(!1);for(const i of e)t=t.next((r=>r?J.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new J(((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next((d=>{o[h]=d,++a,a===s&&i(o)}),(d=>r(d)))}}))}static doWhile(e,t){return new J(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const Qi="SimpleDb";class xy{static open(e,t,i,r){try{return new xy(t,e.transaction(r,i))}catch(s){throw new Mf(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ao,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Mf(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=ES(i.target.error);this.S.reject(new Mf(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ve(Qi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new E7(t)}}class Ba{static delete(e){return ve(Qi,"Removing database:",e),Ql(R4().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!O4())return!1;if(Ba.F())return!0;const e=Cn(),t=Ba.M(e),i=0<t&&t<10,r=tL(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Ba.M(Cn())===12.2&&wi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ve(Qi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new Mf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Te(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Te(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new Mf(e,o))},r.onupgradeneeded=s=>{ve(Qi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{ve(Qi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=xy.open(this.db,e,s?"readonly":"readwrite",i),c=r(a).next((h=>(a.C(),h))).catch((h=>(a.abort(h),J.reject(h)))).toPromise();return c.catch((()=>{})),await a.D,c}catch(a){const c=a,h=c.name!=="FirebaseError"&&o<3;if(ve(Qi,"Transaction failed with error:",c.message,"Retrying:",h),this.close(),!h)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tL(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class v7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ql(this.U.delete())}}class Mf extends Te{constructor(e,t){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ll(n){return n.name==="IndexedDbTransactionError"}class E7{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ve(Qi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ve(Qi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ql(i)}add(e){return ve(Qi,"ADD",this.store.name,e,e),Ql(this.store.add(e))}get(e){return Ql(this.store.get(e)).next((t=>(t===void 0&&(t=null),ve(Qi,"GET",this.store.name,e,t),t)))}delete(e){return ve(Qi,"DELETE",this.store.name,e),Ql(this.store.delete(e))}count(){return ve(Qi,"COUNT",this.store.name),Ql(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new J(((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((a,c)=>{o.push(c)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new J(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){ve(Qi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,a)=>a.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new J(((i,r)=>{t.onerror=s=>{const o=ES(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():i()})):i()}}))}H(e,t){const i=[];return new J(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new v7(a),h=t(a.primaryKey,a.value,c);if(h instanceof J){const d=h.catch((g=>(c.done(),J.reject(g))));i.push(d)}c.isDone?r():c.G===null?a.continue():a.continue(c.G)}})).next((()=>J.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ql(n){return new J(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=ES(i.target.error);t(r)}}))}let aP=!1;function ES(n){const e=Ba.M(Cn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Te("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return aP||(aP=!0,setTimeout((()=>{throw i}),0)),i}}return n}const kf="IndexBackfiller";class w7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ve(kf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ve(kf,`Documents written: ${t}`)}catch(t){ll(t)?ve(kf,"Ignoring IndexedDB error during index backfill: ",t):await Wc(t)}await this.re(6e4)}))}}class x7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return J.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return ve(kf,`Processing collection: ${o}`),this.oe(e,o,r).next((a=>{r-=a,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((a=>(ve(kf,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Z4(s);vS(o,i)>0&&(i=o)})),new sr(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class br{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}br.ce=-1;const uc=-1;function Sy(n){return n==null}function gg(n){return n===0&&1/n==-1/0}function S7(n){return typeof n=="number"&&Number.isInteger(n)&&!gg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const l_="";function fi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lP(e)),e=I7(n.get(t),e);return lP(e)}function I7(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case l_:t+="";break;default:t+=s}}return t}function lP(n){return n+l_+""}function Cs(n){const e=n.length;if(je(e>=2,64408,{path:n}),e===2)return je(n.charAt(0)===l_&&n.charAt(1)==="",56145,{path:n}),Et.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(l_,s);switch((o<0||o>t)&&Ne(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),i.push(c);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Ne(61167,{path:n})}s=o+2}return new Et(i)}const Hl="remoteDocuments",nm="owner",Fu="owner",mg="mutationQueues",T7="userId",Kr="mutations",cP="batchId",sc="userMutationsIndex",uP=["userId","batchId"];function d0(n,e){return[n,fi(e)]}function nL(n,e,t){return[n,fi(e),t]}const R7={},Dh="documentMutations",c_="remoteDocumentsV14",A7=["prefixPath","collectionGroup","readTime","documentId"],f0="documentKeyIndex",P7=["prefixPath","collectionGroup","documentId"],iL="collectionGroupIndex",C7=["collectionGroup","readTime","prefixPath","documentId"],pg="remoteDocumentGlobal",Iw="remoteDocumentGlobalKey",Vh="targets",rL="queryTargetsIndex",b7=["canonicalId","targetId"],Fh="targetDocuments",M7=["targetId","path"],wS="documentTargetsIndex",k7=["path","targetId"],u_="targetGlobalKey",hc="targetGlobal",_g="collectionParents",L7=["collectionId","parent"],jh="clientMetadata",N7="clientId",Iy="bundles",O7="bundleId",Ty="namedQueries",D7="name",xS="indexConfiguration",V7="indexId",Tw="collectionGroupIndex",F7="collectionGroup",Lf="indexState",j7=["indexId","uid"],sL="sequenceNumberIndex",G7=["uid","sequenceNumber"],Nf="indexEntries",U7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],oL="documentKeyIndex",B7=["indexId","uid","orderedDocumentKey"],Ry="documentOverlays",z7=["userId","collectionPath","documentId"],Rw="collectionPathOverlayIndex",$7=["userId","collectionPath","largestBatchId"],aL="collectionGroupOverlayIndex",W7=["userId","collectionGroup","largestBatchId"],SS="globals",H7="name",lL=[mg,Kr,Dh,Hl,Vh,nm,hc,Fh,jh,pg,_g,Iy,Ty],K7=[...lL,Ry],cL=[mg,Kr,Dh,c_,Vh,nm,hc,Fh,jh,pg,_g,Iy,Ty,Ry],uL=cL,IS=[...uL,xS,Lf,Nf],q7=IS,hL=[...IS,SS],Y7=hL;class Aw extends eL{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function bn(n,e){const t=Je(n);return Ba.O(t.le,e)}function hP(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function cl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function dL(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class qt{constructor(e,t){this.comparator=e,this.root=t||Qn.EMPTY}insert(e,t){return new qt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qn.BLACK,null,null))}remove(e){return new qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $p(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $p(this.root,e,this.comparator,!1)}getReverseIterator(){return new $p(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $p(this.root,e,this.comparator,!0)}}class $p{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Qn.RED,this.left=r??Qn.EMPTY,this.right=s??Qn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Qn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Qn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Qn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ne(27949);return e+(this.isRed()?0:1)}}Qn.EMPTY=null,Qn.RED=!0,Qn.BLACK=!1;Qn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne(57766)}get value(){throw Ne(16141)}get color(){throw Ne(16727)}get left(){throw Ne(29726)}get right(){throw Ne(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Qn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class bt{constructor(e){this.comparator=e,this.data=new qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dP(this.data.getIterator())}getIteratorFrom(e){return new dP(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new bt(this.comparator);return t.data=e,t}}class dP{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ju(n){return n.hasNext()?n.getNext():void 0}class ji{constructor(e){this.fields=e,e.sort(Jt.comparator)}static empty(){return new ji([])}unionWith(e){let t=new bt(Jt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ji(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oh(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class fL extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class wn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new fL("Invalid base64 string: "+s):s}})(e);return new wn(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new wn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wn.EMPTY_BYTE_STRING=new wn("");const X7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mo(n){if(je(!!n,39018),typeof n=="string"){let e=0;const t=X7.exec(n);if(je(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Kt(n.seconds),nanos:Kt(n.nanos)}}function Kt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ko(n){return typeof n=="string"?wn.fromBase64String(n):wn.fromUint8Array(n)}const gL="server_timestamp",mL="__type__",pL="__previous_value__",_L="__local_write_time__";function TS(n){return(n?.mapValue?.fields||{})[mL]?.stringValue===gL}function Ay(n){const e=n.mapValue.fields[pL];return TS(e)?Ay(e):e}function yg(n){const e=Mo(n.mapValue.fields[_L].timestampValue);return new Pt(e.seconds,e.nanos)}class Q7{constructor(e,t,i,r,s,o,a,c,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=d}}const h_="(default)";class Ac{constructor(e,t){this.projectId=e,this.database=t||h_}static empty(){return new Ac("","")}get isDefaultDatabase(){return this.database===h_}isEqual(e){return e instanceof Ac&&e.projectId===this.projectId&&e.database===this.database}}const RS="__type__",yL="__max__",Na={mapValue:{fields:{__type__:{stringValue:yL}}}},AS="__vector__",Gh="value",g0={nullValue:"NULL_VALUE"};function Za(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?TS(n)?4:vL(n)?9007199254740991:Py(n)?10:11:Ne(28295,{value:n})}function Us(n,e){if(n===e)return!0;const t=Za(n);if(t!==Za(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return yg(n).isEqual(yg(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Mo(r.timestampValue),a=Mo(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return ko(r.bytesValue).isEqual(ko(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Kt(r.geoPointValue.latitude)===Kt(s.geoPointValue.latitude)&&Kt(r.geoPointValue.longitude)===Kt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Kt(r.integerValue)===Kt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Kt(r.doubleValue),a=Kt(s.doubleValue);return o===a?gg(o)===gg(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return Oh(n.arrayValue.values||[],e.arrayValue.values||[],Us);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(hP(o)!==hP(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Us(o[c],a[c])))return!1;return!0})(n,e);default:return Ne(52216,{left:n})}}function vg(n,e){return(n.values||[]).find((t=>Us(t,e)))!==void 0}function Ja(n,e){if(n===e)return 0;const t=Za(n),i=Za(e);if(t!==i)return Ze(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ze(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=Kt(s.integerValue||s.doubleValue),c=Kt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return fP(n.timestampValue,e.timestampValue);case 4:return fP(yg(n),yg(e));case 5:return xw(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=ko(s),c=ko(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),c=o.split("/");for(let h=0;h<a.length&&h<c.length;h++){const d=Ze(a[h],c[h]);if(d!==0)return d}return Ze(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=Ze(Kt(s.latitude),Kt(o.latitude));return a!==0?a:Ze(Kt(s.longitude),Kt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return gP(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},c=o.fields||{},h=a[Gh]?.arrayValue,d=c[Gh]?.arrayValue,g=Ze(h?.values?.length||0,d?.values?.length||0);return g!==0?g:gP(h,d)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Na.mapValue&&o===Na.mapValue)return 0;if(s===Na.mapValue)return 1;if(o===Na.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),h=o.fields||{},d=Object.keys(h);c.sort(),d.sort();for(let g=0;g<c.length&&g<d.length;++g){const m=xw(c[g],d[g]);if(m!==0)return m;const y=Ja(a[c[g]],h[d[g]]);if(y!==0)return y}return Ze(c.length,d.length)})(n.mapValue,e.mapValue);default:throw Ne(23264,{he:t})}}function fP(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ze(n,e);const t=Mo(n),i=Mo(e),r=Ze(t.seconds,i.seconds);return r!==0?r:Ze(t.nanos,i.nanos)}function gP(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=Ja(t[r],i[r]);if(s)return s}return Ze(t.length,i.length)}function Uh(n){return Pw(n)}function Pw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Mo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ko(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Re.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=Pw(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Pw(t.fields[o])}`;return r+"}"})(n.mapValue):Ne(61005,{value:n})}function m0(n){switch(Za(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ay(n);return e?16+m0(e):16;case 5:return 2*n.stringValue.length;case 6:return ko(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+m0(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return cl(i.fields,((s,o)=>{r+=s.length+m0(o)})),r})(n.mapValue);default:throw Ne(13486,{value:n})}}function Eg(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Cw(n){return!!n&&"integerValue"in n}function wg(n){return!!n&&"arrayValue"in n}function mP(n){return!!n&&"nullValue"in n}function pP(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function p0(n){return!!n&&"mapValue"in n}function Py(n){return(n?.mapValue?.fields||{})[RS]?.stringValue===AS}function Of(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return cl(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Of(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Of(n.arrayValue.values[t]);return e}return{...n}}function vL(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===yL}const EL={mapValue:{fields:{[RS]:{stringValue:AS},[Gh]:{arrayValue:{}}}}};function Z7(n){return"nullValue"in n?g0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Eg(Ac.empty(),Re.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Py(n)?EL:{mapValue:{}}:Ne(35942,{value:n})}function J7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Eg(Ac.empty(),Re.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?EL:"mapValue"in n?Py(n)?{mapValue:{}}:Na:Ne(61959,{value:n})}function _P(n,e){const t=Ja(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function yP(n,e){const t=Ja(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ui{constructor(e){this.value=e}static empty(){return new ui({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!p0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Of(t)}setAll(e){let t=Jt.emptyPath(),i={},r=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Of(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());p0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Us(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];p0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){cl(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new ui(Of(this.value))}}function wL(n){const e=[];return cl(n.fields,((t,i)=>{const r=new Jt([t]);if(p0(i)){const s=wL(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new ji(e)}class on{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new on(e,0,Ge.min(),Ge.min(),Ge.min(),ui.empty(),0)}static newFoundDocument(e,t,i,r){return new on(e,1,t,Ge.min(),i,r,0)}static newNoDocument(e,t){return new on(e,2,t,Ge.min(),Ge.min(),ui.empty(),0)}static newUnknownDocument(e,t){return new on(e,3,t,Ge.min(),Ge.min(),ui.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ui.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ui.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof on&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new on(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bh{constructor(e,t){this.position=e,this.inclusive=t}}function vP(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Re.comparator(Re.fromName(o.referenceValue),t.key):i=Ja(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function EP(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Us(n.position[t],e.position[t]))return!1;return!0}class d_{constructor(e,t="asc"){this.field=e,this.dir=t}}function eU(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class xL{}class lt extends xL{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new tU(e,t,i):t==="array-contains"?new rU(e,i):t==="in"?new PL(e,i):t==="not-in"?new sU(e,i):t==="array-contains-any"?new oU(e,i):new lt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new nU(e,i):new iU(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ja(t,this.value)):t!==null&&Za(this.value)===Za(t)&&this.matchesComparison(Ja(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ct extends xL{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ct(e,t)}matches(e){return zh(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function zh(n){return n.op==="and"}function bw(n){return n.op==="or"}function PS(n){return SL(n)&&zh(n)}function SL(n){for(const e of n.filters)if(e instanceof Ct)return!1;return!0}function Mw(n){if(n instanceof lt)return n.field.canonicalString()+n.op.toString()+Uh(n.value);if(PS(n))return n.filters.map((e=>Mw(e))).join(",");{const e=n.filters.map((t=>Mw(t))).join(",");return`${n.op}(${e})`}}function IL(n,e){return n instanceof lt?(function(i,r){return r instanceof lt&&i.op===r.op&&i.field.isEqual(r.field)&&Us(i.value,r.value)})(n,e):n instanceof Ct?(function(i,r){return r instanceof Ct&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&IL(o,r.filters[a])),!0):!1})(n,e):void Ne(19439)}function TL(n,e){const t=n.filters.concat(e);return Ct.create(t,n.op)}function RL(n){return n instanceof lt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Uh(t.value)}`})(n):n instanceof Ct?(function(t){return t.op.toString()+" {"+t.getFilters().map(RL).join(" ,")+"}"})(n):"Filter"}class tU extends lt{constructor(e,t,i){super(e,t,i),this.key=Re.fromName(i.referenceValue)}matches(e){const t=Re.comparator(e.key,this.key);return this.matchesComparison(t)}}class nU extends lt{constructor(e,t){super(e,"in",t),this.keys=AL("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class iU extends lt{constructor(e,t){super(e,"not-in",t),this.keys=AL("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function AL(n,e){return(e.arrayValue?.values||[]).map((t=>Re.fromName(t.referenceValue)))}class rU extends lt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return wg(t)&&vg(t.arrayValue,this.value)}}class PL extends lt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&vg(this.value.arrayValue,t)}}class sU extends lt{constructor(e,t){super(e,"not-in",t)}matches(e){if(vg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!vg(this.value.arrayValue,t)}}class oU extends lt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!wg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>vg(this.value.arrayValue,i)))}}class aU{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function kw(n,e=null,t=[],i=[],r=null,s=null,o=null){return new aU(n,e,t,i,r,s,o)}function Pc(n){const e=Je(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Mw(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),Sy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Uh(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Uh(i))).join(",")),e.Te=t}return e.Te}function im(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!eU(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!IL(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!EP(n.startAt,e.startAt)&&EP(n.endAt,e.endAt)}function f_(n){return Re.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function g_(n,e){return n.filters.filter((t=>t instanceof lt&&t.field.isEqual(e)))}function wP(n,e,t){let i=g0,r=!0;for(const s of g_(n,e)){let o=g0,a=!0;switch(s.op){case"<":case"<=":o=Z7(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=g0}_P({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];_P({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function xP(n,e,t){let i=Na,r=!0;for(const s of g_(n,e)){let o=Na,a=!0;switch(s.op){case">=":case">":o=J7(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Na}yP({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];yP({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class rm{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function lU(n,e,t,i,r,s,o,a){return new rm(n,e,t,i,r,s,o,a)}function CS(n){return new rm(n)}function SP(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function CL(n){return n.collectionGroup!==null}function Df(n){const e=Je(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new bt(Jt.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new d_(s,i))})),t.has(Jt.keyField().canonicalString())||e.Ie.push(new d_(Jt.keyField(),i))}return e.Ie}function kr(n){const e=Je(n);return e.Ee||(e.Ee=cU(e,Df(n))),e.Ee}function cU(n,e){if(n.limitType==="F")return kw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new d_(r.field,s)}));const t=n.endAt?new Bh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Bh(n.startAt.position,n.startAt.inclusive):null;return kw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Lw(n,e){const t=n.filters.concat([e]);return new rm(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Nw(n,e,t){return new rm(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Cy(n,e){return im(kr(n),kr(e))&&n.limitType===e.limitType}function bL(n){return`${Pc(kr(n))}|lt:${n.limitType}`}function Zu(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>RL(r))).join(", ")}]`),Sy(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Uh(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Uh(r))).join(",")),`Target(${i})`})(kr(n))}; limitType=${n.limitType})`}function sm(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Re.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of Df(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,c){const h=vP(o,a,c);return o.inclusive?h<=0:h<0})(i.startAt,Df(i),r)||i.endAt&&!(function(o,a,c){const h=vP(o,a,c);return o.inclusive?h>=0:h>0})(i.endAt,Df(i),r))})(n,e)}function uU(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ML(n){return(e,t)=>{let i=!1;for(const r of Df(n)){const s=hU(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function hU(n,e,t){const i=n.field.isKeyField()?Re.comparator(e.key,t.key):(function(s,o,a){const c=o.data.field(s),h=a.data.field(s);return c!==null&&h!==null?Ja(c,h):Ne(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ne(19790,{direction:n.dir})}}class Vo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){cl(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return dL(this.inner)}size(){return this.innerSize}}const dU=new qt(Re.comparator);function tr(){return dU}const kL=new qt(Re.comparator);function yf(...n){let e=kL;for(const t of n)e=e.insert(t.key,t);return e}function LL(n){let e=kL;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function bs(){return Vf()}function NL(){return Vf()}function Vf(){return new Vo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const fU=new qt(Re.comparator),gU=new bt(Re.comparator);function it(...n){let e=gU;for(const t of n)e=e.add(t);return e}const mU=new bt(Ze);function pU(){return mU}function bS(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gg(e)?"-0":e}}function OL(n){return{integerValue:""+n}}function _U(n,e){return S7(e)?OL(e):bS(n,e)}class by{constructor(){this._=void 0}}function yU(n,e,t){return n instanceof xg?(function(r,s){const o={fields:{[mL]:{stringValue:gL},[_L]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&TS(s)&&(s=Ay(s)),s&&(o.fields[pL]=s),{mapValue:o}})(t,e):n instanceof $h?VL(n,e):n instanceof Wh?FL(n,e):(function(r,s){const o=DL(r,s),a=IP(o)+IP(r.Ae);return Cw(o)&&Cw(r.Ae)?OL(a):bS(r.serializer,a)})(n,e)}function vU(n,e,t){return n instanceof $h?VL(n,e):n instanceof Wh?FL(n,e):t}function DL(n,e){return n instanceof Sg?(function(i){return Cw(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class xg extends by{}class $h extends by{constructor(e){super(),this.elements=e}}function VL(n,e){const t=jL(e);for(const i of n.elements)t.some((r=>Us(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Wh extends by{constructor(e){super(),this.elements=e}}function FL(n,e){let t=jL(e);for(const i of n.elements)t=t.filter((r=>!Us(r,i)));return{arrayValue:{values:t}}}class Sg extends by{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function IP(n){return Kt(n.integerValue||n.doubleValue)}function jL(n){return wg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class EU{constructor(e,t){this.field=e,this.transform=t}}function wU(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof $h&&r instanceof $h||i instanceof Wh&&r instanceof Wh?Oh(i.elements,r.elements,Us):i instanceof Sg&&r instanceof Sg?Us(i.Ae,r.Ae):i instanceof xg&&r instanceof xg})(n.transform,e.transform)}class xU{constructor(e,t){this.version=e,this.transformResults=t}}class xi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xi}static exists(e){return new xi(void 0,e)}static updateTime(e){return new xi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class My{}function GL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ky(n.key,xi.none()):new td(n.key,n.data,xi.none());{const t=n.data,i=ui.empty();let r=new bt(Jt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Fo(n.key,i,new ji(r.toArray()),xi.none())}}function SU(n,e,t){n instanceof td?(function(r,s,o){const a=r.value.clone(),c=RP(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Fo?(function(r,s,o){if(!_0(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=RP(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(UL(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Ff(n,e,t,i){return n instanceof td?(function(s,o,a,c){if(!_0(s.precondition,o))return a;const h=s.value.clone(),d=AP(s.fieldTransforms,c,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Fo?(function(s,o,a,c){if(!_0(s.precondition,o))return a;const h=AP(s.fieldTransforms,c,o),d=o.data;return d.setAll(UL(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,i):(function(s,o,a){return _0(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function IU(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=DL(i.transform,r||null);s!=null&&(t===null&&(t=ui.empty()),t.set(i.field,s))}return t||null}function TP(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Oh(i,r,((s,o)=>wU(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class td extends My{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Fo extends My{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function UL(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function RP(n,e,t){const i=new Map;je(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,vU(o,a,t[r]))}return i}function AP(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,yU(s,o,e))}return i}class ky extends My{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BL extends My{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class MS{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&SU(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Ff(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Ff(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=NL();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const c=GL(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(Ge.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),it())}isEqual(e){return this.batchId===e.batchId&&Oh(this.mutations,e.mutations,((t,i)=>TP(t,i)))&&Oh(this.baseMutations,e.baseMutations,((t,i)=>TP(t,i)))}}class kS{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){je(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return fU})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new kS(e,t,i,r)}}class LS{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class TU{constructor(e,t){this.count=e,this.unchangedNames=t}}var _n,dt;function RU(n){switch(n){case le.OK:return Ne(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Ne(15467,{code:n})}}function zL(n){if(n===void 0)return wi("GRPC error has no .code"),le.UNKNOWN;switch(n){case _n.OK:return le.OK;case _n.CANCELLED:return le.CANCELLED;case _n.UNKNOWN:return le.UNKNOWN;case _n.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case _n.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case _n.INTERNAL:return le.INTERNAL;case _n.UNAVAILABLE:return le.UNAVAILABLE;case _n.UNAUTHENTICATED:return le.UNAUTHENTICATED;case _n.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case _n.NOT_FOUND:return le.NOT_FOUND;case _n.ALREADY_EXISTS:return le.ALREADY_EXISTS;case _n.PERMISSION_DENIED:return le.PERMISSION_DENIED;case _n.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case _n.ABORTED:return le.ABORTED;case _n.OUT_OF_RANGE:return le.OUT_OF_RANGE;case _n.UNIMPLEMENTED:return le.UNIMPLEMENTED;case _n.DATA_LOSS:return le.DATA_LOSS;default:return Ne(39323,{code:n})}}(dt=_n||(_n={}))[dt.OK=0]="OK",dt[dt.CANCELLED=1]="CANCELLED",dt[dt.UNKNOWN=2]="UNKNOWN",dt[dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",dt[dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",dt[dt.NOT_FOUND=5]="NOT_FOUND",dt[dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",dt[dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",dt[dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",dt[dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",dt[dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",dt[dt.ABORTED=10]="ABORTED",dt[dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",dt[dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",dt[dt.INTERNAL=13]="INTERNAL",dt[dt.UNAVAILABLE=14]="UNAVAILABLE",dt[dt.DATA_LOSS=15]="DATA_LOSS";function AU(){return new TextEncoder}const PU=new Ua([4294967295,4294967295],0);function PP(n){const e=AU().encode(n),t=new U4;return t.update(e),new Uint8Array(t.digest())}function CP(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ua([t,i],0),new Ua([r,s],0)]}class NS{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new vf(`Invalid padding: ${t}`);if(i<0)throw new vf(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new vf(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new vf(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ua.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(Ua.fromNumber(i)));return r.compare(PU)===1&&(r=new Ua([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=PP(e),[i,r]=CP(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new NS(s,r,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=PP(e),[i,r]=CP(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class vf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ly{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,om.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ly(Ge.min(),r,new qt(Ze),tr(),it())}}class om{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new om(i,t,it(),it(),it())}}class y0{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class $L{constructor(e,t){this.targetId=e,this.Ce=t}}class WL{constructor(e,t,i=wn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class bP{constructor(){this.ve=0,this.Fe=MP(),this.Me=wn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=it(),t=it(),i=it();return this.Fe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Ne(38017,{changeType:s})}})),new om(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=MP()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,je(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class CU{constructor(e){this.Ge=e,this.ze=new Map,this.je=tr(),this.Je=Wp(),this.He=Wp(),this.Ye=new qt(Ze)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ne(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(f_(s))if(i===0){const o=new Re(s.path);this.et(t,o,on.newNoDocument(o,Ge.min()))}else je(i===1,20013,{expectedCount:i});else{const o=this._t(t);if(o!==i){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=ko(i).toUint8Array()}catch(c){if(c instanceof fL)return Rc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new NS(o,r,s)}catch(c){return Rc(c instanceof vf?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&f_(a.target)){const c=new Re(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,on.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let i=it();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const r=new Ly(e,t,this.Ye,this.je,i);return this.je=tr(),this.Je=Wp(),this.He=Wp(),this.Ye=new qt(Ze),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new bP,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new bt(Ze),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new bt(Ze),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new bP),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Wp(){return new qt(Re.comparator)}function MP(){return new qt(Re.comparator)}const bU={asc:"ASCENDING",desc:"DESCENDING"},MU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kU={and:"AND",or:"OR"};class LU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ow(n,e){return n.useProto3Json||Sy(e)?e:{value:e}}function Hh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function HL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function NU(n,e){return Hh(n,e.toTimestamp())}function Ti(n){return je(!!n,49232),Ge.fromTimestamp((function(t){const i=Mo(t);return new Pt(i.seconds,i.nanos)})(n))}function OS(n,e){return Dw(n,e).canonicalString()}function Dw(n,e){const t=(function(r){return new Et(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function KL(n){const e=Et.fromString(n);return je(nN(e),10190,{key:e.toString()}),e}function m_(n,e){return OS(n.databaseId,e.path)}function dc(n,e){const t=KL(e);if(t.get(1)!==n.databaseId.projectId)throw new Te(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Te(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Re(XL(t))}function qL(n,e){return OS(n.databaseId,e)}function YL(n){const e=KL(n);return e.length===4?Et.emptyPath():XL(e)}function Vw(n){return new Et(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function XL(n){return je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function kP(n,e,t){return{name:m_(n,e),fields:t.value.mapValue.fields}}function OU(n,e,t){const i=dc(n,e.name),r=Ti(e.updateTime),s=e.createTime?Ti(e.createTime):Ge.min(),o=new ui({mapValue:{fields:e.fields}}),a=on.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function DU(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ne(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(je(d===void 0||typeof d=="string",58123),wn.fromBase64String(d||"")):(je(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),wn.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(h){const d=h.code===void 0?le.UNKNOWN:zL(h.code);return new Te(d,h.message||"")})(o);t=new WL(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=dc(n,i.document.name),s=Ti(i.document.updateTime),o=i.document.createTime?Ti(i.document.createTime):Ge.min(),a=new ui({mapValue:{fields:i.document.fields}}),c=on.newFoundDocument(r,s,o,a),h=i.targetIds||[],d=i.removedTargetIds||[];t=new y0(h,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=dc(n,i.document),s=i.readTime?Ti(i.readTime):Ge.min(),o=on.newNoDocument(r,s),a=i.removedTargetIds||[];t=new y0([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=dc(n,i.document),s=i.removedTargetIds||[];t=new y0([],s,r,null)}else{if(!("filter"in e))return Ne(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new TU(r,s),a=i.targetId;t=new $L(a,o)}}return t}function p_(n,e){let t;if(e instanceof td)t={update:kP(n,e.key,e.value)};else if(e instanceof ky)t={delete:m_(n,e.key)};else if(e instanceof Fo)t={update:kP(n,e.key,e.data),updateMask:BU(e.fieldMask)};else{if(!(e instanceof BL))return Ne(16599,{Vt:e.type});t={verify:m_(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof xg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof $h)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Wh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Sg)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Ne(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:NU(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ne(27497)})(n,e.precondition)),t}function Fw(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?xi.updateTime(Ti(s.updateTime)):s.exists!==void 0?xi.exists(s.exists):xi.none()})(e.currentDocument):xi.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,a){let c=null;if("setToServerValue"in a)je(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new xg;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];c=new $h(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];c=new Wh(d)}else"increment"in a?c=new Sg(o,a.increment):Ne(16584,{proto:a});const h=Jt.fromServerFormat(a.fieldPath);return new EU(h,c)})(n,r))):[];if(e.update){e.update.name;const r=dc(n,e.update.name),s=new ui({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const h=c.fieldPaths||[];return new ji(h.map((d=>Jt.fromServerFormat(d))))})(e.updateMask);return new Fo(r,s,o,t,i)}return new td(r,s,t,i)}if(e.delete){const r=dc(n,e.delete);return new ky(r,t)}if(e.verify){const r=dc(n,e.verify);return new BL(r,t)}return Ne(1463,{proto:e})}function VU(n,e){return n&&n.length>0?(je(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Ti(r.updateTime):Ti(s);return o.isEqual(Ge.min())&&(o=Ti(s)),new xU(o,r.transformResults||[])})(t,e)))):[]}function QL(n,e){return{documents:[qL(n,e.path)]}}function ZL(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=qL(n,r);const s=(function(h){if(h.length!==0)return tN(Ct.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:Ju(m.field),direction:jU(m.dir)}})(d)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Ow(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function JL(n){let e=YL(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){je(i===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=(function(g){const m=eN(g);return m instanceof Ct&&PS(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map((m=>(function(w){return new d_(eh(w.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(g){let m;return m=typeof g=="object"?g.value:g,Sy(m)?null:m})(t.limit));let c=null;t.startAt&&(c=(function(g){const m=!!g.before,y=g.values||[];return new Bh(y,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,y=g.values||[];return new Bh(y,m)})(t.endAt)),lU(e,r,o,s,a,"F",c,h)}function FU(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function eN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=eh(t.unaryFilter.field);return lt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=eh(t.unaryFilter.field);return lt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=eh(t.unaryFilter.field);return lt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=eh(t.unaryFilter.field);return lt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ne(61313);default:return Ne(60726)}})(n):n.fieldFilter!==void 0?(function(t){return lt.create(eh(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ne(58110);default:return Ne(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ct.create(t.compositeFilter.filters.map((i=>eN(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ne(1026)}})(t.compositeFilter.op))})(n):Ne(30097,{filter:n})}function jU(n){return bU[n]}function GU(n){return MU[n]}function UU(n){return kU[n]}function Ju(n){return{fieldPath:n.canonicalString()}}function eh(n){return Jt.fromServerFormat(n.fieldPath)}function tN(n){return n instanceof lt?(function(t){if(t.op==="=="){if(pP(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NAN"}};if(mP(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(pP(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NOT_NAN"}};if(mP(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ju(t.field),op:GU(t.op),value:t.value}}})(n):n instanceof Ct?(function(t){const i=t.getFilters().map((r=>tN(r)));return i.length===1?i[0]:{compositeFilter:{op:UU(t.op),filters:i}}})(n):Ne(54877,{filter:n})}function BU(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function nN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class vo{constructor(e,t,i,r,s=Ge.min(),o=Ge.min(),a=wn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new vo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class iN{constructor(e){this.yt=e}}function zU(n,e){let t;if(e.document)t=OU(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Re.fromSegments(e.noDocument.path),r=bc(e.noDocument.readTime);t=on.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ne(56709);{const i=Re.fromSegments(e.unknownDocument.path),r=bc(e.unknownDocument.version);t=on.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new Pt(r[0],r[1]);return Ge.fromTimestamp(s)})(e.readTime)),t}function LP(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:__(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:m_(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Hh(s,o.version.toTimestamp()),createTime:Hh(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cc(e.version)};else{if(!e.isUnknownDocument())return Ne(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cc(e.version)}}return i}function __(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function bc(n){const e=new Pt(n.seconds,n.nanoseconds);return Ge.fromTimestamp(e)}function Zl(n,e){const t=(e.baseMutations||[]).map((s=>Fw(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>Fw(n.yt,s))),r=Pt.fromMillis(e.localWriteTimeMs);return new MS(e.batchId,r,t,i)}function Ef(n){const e=bc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?bc(n.lastLimboFreeSnapshotVersion):Ge.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return je(o===1,1966,{count:o}),kr(CS(YL(s.documents[0])))})(n.query):(function(s){return kr(JL(s))})(n.query),new vo(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,wn.fromBase64String(n.resumeToken))}function rN(n,e){const t=Cc(e.snapshotVersion),i=Cc(e.lastLimboFreeSnapshotVersion);let r;r=f_(e.target)?QL(n.yt,e.target):ZL(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Pc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function sN(n){const e=JL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Nw(e,e.limit,"L"):e}function mE(n,e){return new LS(e.largestBatchId,Fw(n.yt,e.overlayMutation))}function NP(n,e){const t=e.path.lastSegment();return[n,fi(e.path.popLast()),t]}function OP(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cc(i.readTime),documentKey:fi(i.documentKey.path),largestBatchId:i.largestBatchId}}class $U{getBundleMetadata(e,t){return DP(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:bc(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return DP(e).put((function(r){return{bundleId:r.id,createTime:Cc(Ti(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return VP(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:sN(s.bundledQuery),readTime:bc(s.readTime)}})(i)}))}saveNamedQuery(e,t){return VP(e).put((function(r){return{name:r.name,readTime:Cc(Ti(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function DP(n){return bn(n,Iy)}function VP(n){return bn(n,Ty)}class Ny{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new Ny(e,i)}getOverlay(e,t){return rf(e).get(NP(this.userId,t)).next((i=>i?mE(this.serializer,i):null))}getOverlays(e,t){const i=bs();return J.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const a=new LS(t,o);r.push(this.St(e,a))})),J.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(fi(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(rf(e).Z(Rw,a))})),J.waitFor(s)}getOverlaysForCollection(e,t,i){const r=bs(),s=fi(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return rf(e).J(Rw,o).next((a=>{for(const c of a){const h=mE(this.serializer,c);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=bs();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return rf(e).ee({index:aL,range:a},((c,h,d)=>{const g=mE(this.serializer,h);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):d.done()})).next((()=>s))}St(e,t){return rf(e).put((function(r,s,o){const[a,c,h]=NP(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:p_(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function rf(n){return bn(n,Ry)}class WU{bt(e){return bn(e,SS)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?wn.fromUint8Array(i):wn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Jl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Kt(e.integerValue));else if("doubleValue"in e){const i=Kt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),gg(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Mo(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ko(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?vL(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Py(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ne(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=Gh,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Kt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Re.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Jl.Kt=new Jl;const Gu=255;function HU(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function FP(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=HU(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class KU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=FP(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=FP(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Gu),this.sn(255)}_n(){this.an(Gu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Gu?(this.sn(Gu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Gu?(this.an(Gu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class qU{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class YU{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class sf{constructor(){this.cn=new KU,this.ln=new qU(this.cn),this.hn=new YU(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class ec{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new ec(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:v0(this.En),directionalValue:v0(this.dn),orderedDocumentKey:v0(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function ma(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=jP(n.En,e.En),t!==0?t:(t=jP(n.dn,e.dn),t!==0?t:Re.comparator(n.In,e.In)))}function jP(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function v0(n){return N4()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function GP(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class UP{constructor(e){this.mn=new bt(((t,i)=>Jt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(je(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Sw(e);if(t!==void 0&&!this.wn(t))return!1;const i=Wl(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!r.has(a.field.canonicalString())){const c=i[s];if(!this.Sn(a,c)||!this.bn(this.fn[o++],c))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new bt(Jt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new h0(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new h0(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new h0(i.field,i.dir==="asc"?0:1)));return new a_(a_.UNKNOWN_ID,this.collectionId,t,fg.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function oN(n){if(je(n instanceof lt||n instanceof Ct,20012),n instanceof lt){if(n instanceof PL){const t=n.value.arrayValue?.values?.map((i=>lt.create(n.field,"==",i)))||[];return Ct.create(t,"or")}return n}const e=n.filters.map((t=>oN(t)));return Ct.create(e,n.op)}function XU(n){if(n.getFilters().length===0)return[];const e=Uw(oN(n));return je(aN(e),7391),jw(e)||Gw(e)?[e]:e.getFilters()}function jw(n){return n instanceof lt}function Gw(n){return n instanceof Ct&&PS(n)}function aN(n){return jw(n)||Gw(n)||(function(t){if(t instanceof Ct&&bw(t)){for(const i of t.getFilters())if(!jw(i)&&!Gw(i))return!1;return!0}return!1})(n)}function Uw(n){if(je(n instanceof lt||n instanceof Ct,34018),n instanceof lt)return n;if(n.filters.length===1)return Uw(n.filters[0]);const e=n.filters.map((i=>Uw(i)));let t=Ct.create(e,n.op);return t=y_(t),aN(t)?t:(je(t instanceof Ct,64498),je(zh(t),40251),je(t.filters.length>1,57927),t.filters.reduce(((i,r)=>DS(i,r))))}function DS(n,e){let t;return je(n instanceof lt||n instanceof Ct,38388),je(e instanceof lt||e instanceof Ct,25473),t=n instanceof lt?e instanceof lt?(function(r,s){return Ct.create([r,s],"and")})(n,e):BP(n,e):e instanceof lt?BP(e,n):(function(r,s){if(je(r.filters.length>0&&s.filters.length>0,48005),zh(r)&&zh(s))return TL(r,s.getFilters());const o=bw(r)?r:s,a=bw(r)?s:r,c=o.filters.map((h=>DS(h,a)));return Ct.create(c,"or")})(n,e),y_(t)}function BP(n,e){if(zh(e))return TL(e,n.getFilters());{const t=e.filters.map((i=>DS(n,i)));return Ct.create(t,"or")}}function y_(n){if(je(n instanceof lt||n instanceof Ct,11850),n instanceof lt)return n;const e=n.getFilters();if(e.length===1)return y_(e[0]);if(SL(n))return n;const t=e.map((r=>y_(r))),i=[];return t.forEach((r=>{r instanceof lt?i.push(r):r instanceof Ct&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:Ct.create(i,n.op)}class QU{constructor(){this.Cn=new VS}addToCollectionParentIndex(e,t){return this.Cn.add(t),J.resolve()}getCollectionParents(e,t){return J.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return J.resolve()}deleteFieldIndex(e,t){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,t){return J.resolve()}getDocumentsMatchingTarget(e,t){return J.resolve(null)}getIndexType(e,t){return J.resolve(0)}getFieldIndexes(e,t){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,t){return J.resolve(sr.min())}getMinOffsetFromCollectionGroup(e,t){return J.resolve(sr.min())}updateCollectionGroup(e,t,i){return J.resolve()}updateIndexEntries(e,t){return J.resolve()}}class VS{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new bt(Et.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new bt(Et.comparator)).toArray()}}const zP="IndexedDbIndexManager",Hp=new Uint8Array(0);class ZU{constructor(e,t){this.databaseId=t,this.vn=new VS,this.Fn=new Vo((i=>Pc(i)),((i,r)=>im(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:fi(r)};return $P(e).put(s)}return J.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Y4(t),""],!1,!0);return $P(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Cs(o.parent))}return i}))}addFieldIndex(e,t){const i=of(e),r=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Bu(e);return s.next((a=>{o.put(OP(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=of(e),r=Bu(e),s=Uu(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=of(e),i=Uu(e),r=Bu(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return J.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new UP(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Uu(e);let r=!0;const s=new Map;return J.forEach(this.Mn(t),(o=>this.xn(e,o).next((a=>{r&&(r=!!a),s.set(o,a)})))).next((()=>{if(r){let o=it();const a=[];return J.forEach(s,((c,h)=>{ve(zP,`Using index ${(function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map((D=>`${D.fieldPath}:${D.kind}`)).join(",")}`})(c)} to execute ${Pc(t)}`);const d=(function(N,D){const O=Sw(D);if(O===void 0)return null;for(const $ of g_(N,O.fieldPath))switch($.op){case"array-contains-any":return $.value.arrayValue.values||[];case"array-contains":return[$.value]}return null})(h,c),g=(function(N,D){const O=new Map;for(const $ of Wl(D))for(const k of g_(N,$.fieldPath))switch(k.op){case"==":case"in":O.set($.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return O.set($.fieldPath.canonicalString(),k.value),Array.from(O.values())}return null})(h,c),m=(function(N,D){const O=[];let $=!0;for(const k of Wl(D)){const C=k.kind===0?wP(N,k.fieldPath,N.startAt):xP(N,k.fieldPath,N.startAt);O.push(C.value),$&&($=C.inclusive)}return new Bh(O,$)})(h,c),y=(function(N,D){const O=[];let $=!0;for(const k of Wl(D)){const C=k.kind===0?xP(N,k.fieldPath,N.endAt):wP(N,k.fieldPath,N.endAt);O.push(C.value),$&&($=C.inclusive)}return new Bh(O,$)})(h,c),w=this.On(c,h,m),I=this.On(c,h,y),E=this.Nn(c,h,g),A=this.Bn(c.indexId,d,w,m.inclusive,I,y.inclusive,E);return J.forEach(A,(b=>i.Y(b,t.limit).next((N=>{N.forEach((D=>{const O=Re.fromSegments(D.documentKey);o.has(O)||(o=o.add(O),a.push(O))}))}))))})).next((()=>a))}return J.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=XU(Ct.create(e.filters,"and")).map((i=>kw(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,a){const c=(t!=null?t.length:1)*Math.max(i.length,s.length),h=c/(t!=null?t.length:1),d=[];for(let g=0;g<c;++g){const m=t?this.Ln(t[g/h]):Hp,y=this.kn(e,m,i[g%h],r),w=this.qn(e,m,s[g%h],o),I=a.map((E=>this.kn(e,m,E,!0)));d.push(...this.createRange(y,w,I))}return d}kn(e,t,i,r){const s=new ec(e,Re.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new ec(e,Re.empty(),t,i);return r?s.An():s}xn(e,t){const i=new UP(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const a of s)i.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return J.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(c){let h=new bt(Jt.comparator),d=!1;for(const g of c.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const g of c.orderBy)g.field.isKeyField()||(h=h.add(g.field));return h.size+(d?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new sf;for(const r of Wl(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Jl.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new sf;return Jl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new sf;return Jl.Kt.Dt(Eg(this.databaseId,t),i.Pn((function(s){const o=Wl(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new sf);let s=0;for(const o of Wl(e)){const a=i[s++];for(const c of r)if(this.Un(t,o.fieldPath)&&wg(a))r=this.Kn(r,o,a);else{const h=c.Pn(o.kind);Jl.Kt.Dt(a,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const c=new sf;c.seed(a.un()),Jl.Kt.Dt(o,c.Pn(t.kind)),s.push(c)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof lt&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=of(e),r=Bu(e);return(t?i.J(Tw,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return J.forEach(s,(a=>r.get([a.indexId,this.uid]).next((c=>{o.push((function(d,g){const m=g?new fg(g.sequenceNumber,new sr(bc(g.readTime),new Re(Cs(g.documentKey)),g.largestBatchId)):fg.empty(),y=d.fields.map((([w,I])=>new h0(Jt.fromServerFormat(w),I)));return new a_(d.indexId,d.collectionGroup,y,m)})(a,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Ze(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=of(e),s=Bu(e);return this.Gn(e).next((o=>r.J(Tw,IDBKeyRange.bound(t,t)).next((a=>J.forEach(a,(c=>s.put(OP(c.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return J.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?J.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((a=>(i.set(r.collectionGroup,a),J.forEach(a,(c=>this.zn(e,r,c).next((h=>{const d=this.jn(s,c);return h.isEqual(d)?J.resolve():this.Jn(e,s,c,h,d)})))))))}))}Hn(e,t,i,r){return Uu(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Uu(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Uu(e);let s=new bt(ma);return r.ee({index:oL,range:IDBKeyRange.only([i.indexId,this.uid,v0(this.$n(i,t))])},((o,a)=>{s=s.add(new ec(i.indexId,t,GP(a.arrayValue),GP(a.directionalValue)))})).next((()=>s))}jn(e,t){let i=new bt(ma);const r=this.Qn(t,e);if(r==null)return i;const s=Sw(t);if(s!=null){const o=e.data.field(s.fieldPath);if(wg(o))for(const a of o.arrayValue.values||[])i=i.add(new ec(t.indexId,e.key,this.Ln(a),r))}else i=i.add(new ec(t.indexId,e.key,Hp,r));return i}Jn(e,t,i,r,s){ve(zP,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,h,d,g,m){const y=c.getIterator(),w=h.getIterator();let I=ju(y),E=ju(w);for(;I||E;){let A=!1,b=!1;if(I&&E){const N=d(I,E);N<0?b=!0:N>0&&(A=!0)}else I!=null?b=!0:A=!0;A?(g(E),E=ju(w)):b?(m(I),I=ju(y)):(I=ju(y),E=ju(w))}})(r,s,ma,(a=>{o.push(this.Hn(e,t,i,a))}),(a=>{o.push(this.Yn(e,t,i,a))})),J.waitFor(o)}Gn(e){let t=1;return Bu(e).ee({index:sL,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,a)=>ma(o,a))).filter(((o,a,c)=>!a||ma(o,c[a-1])!==0));const r=[];r.push(e);for(const o of i){const a=ma(o,e),c=ma(o,t);if(a===0)r[0]=e.An();else if(a>0&&c<0)r.push(o),r.push(o.An());else if(c>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const a=r[o].Vn(this.uid,Hp,Re.empty()),c=r[o+1].Vn(this.uid,Hp,Re.empty());s.push(IDBKeyRange.bound(a,c))}return s}Zn(e,t){return ma(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(WP)}getMinOffset(e,t){return J.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Ne(44426))))).next(WP)}}function $P(n){return bn(n,_g)}function Uu(n){return bn(n,Nf)}function of(n){return bn(n,xS)}function Bu(n){return bn(n,Lf)}function WP(n){je(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;vS(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new sr(e.readTime,e.documentKey,t)}const HP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lN=41943040;class li{static withCacheSize(e){return new li(e,li.DEFAULT_COLLECTION_PERCENTILE,li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function cN(n,e,t){const i=n.store(Kr),r=n.store(Dh),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=i.ee({range:o},((d,g,m)=>(a++,m.delete())));s.push(c.next((()=>{je(a===1,47070,{batchId:t.batchId})})));const h=[];for(const d of t.mutations){const g=nL(e,d.key.path,t.batchId);s.push(r.delete(g)),h.push(d.key)}return J.waitFor(s).next((()=>h))}function v_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ne(14731);e=n.noDocument}return JSON.stringify(e).length}li.DEFAULT_COLLECTION_PERCENTILE=10,li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,li.DEFAULT=new li(lN,li.DEFAULT_COLLECTION_PERCENTILE,li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),li.DISABLED=new li(-1,0,0);class Oy{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){je(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Oy(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pa(e).ee({index:sc,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=th(e),o=pa(e);return o.add({}).next((a=>{je(typeof a=="number",49019);const c=new MS(a,t,i,r),h=(function(y,w,I){const E=I.baseMutations.map((b=>p_(y.yt,b))),A=I.mutations.map((b=>p_(y.yt,b)));return{userId:w,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:E,mutations:A}})(this.serializer,this.userId,c),d=[];let g=new bt(((m,y)=>Ze(m.canonicalString(),y.canonicalString())));for(const m of r){const y=nL(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),d.push(o.put(h)),d.push(s.put(y,R7))}return g.forEach((m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[a]=c.keys()})),J.waitFor(d).next((()=>c))}))}lookupMutationBatch(e,t){return pa(e).get(t).next((i=>i?(je(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Zl(this.serializer,i)):null))}er(e,t){return this.Xn[t]?J.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return pa(e).ee({index:sc,range:r},((o,a,c)=>{a.userId===this.userId&&(je(a.batchId>=i,47524,{tr:i}),s=Zl(this.serializer,a)),c.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=uc;return pa(e).ee({index:sc,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,uc],[this.userId,Number.POSITIVE_INFINITY]);return pa(e).J(sc,t).next((i=>i.map((r=>Zl(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=d0(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return th(e).ee({range:r},((o,a,c)=>{const[h,d,g]=o,m=Cs(d);if(h===this.userId&&t.path.isEqual(m))return pa(e).get(g).next((y=>{if(!y)throw Ne(61480,{nr:o,batchId:g});je(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:g}),s.push(Zl(this.serializer,y))}));c.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new bt(Ze);const r=[];return t.forEach((s=>{const o=d0(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=th(e).ee({range:a},((h,d,g)=>{const[m,y,w]=h,I=Cs(y);m===this.userId&&s.path.isEqual(I)?i=i.add(w):g.done()}));r.push(c)})),J.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=d0(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new bt(Ze);return th(e).ee({range:o},((c,h,d)=>{const[g,m,y]=c,w=Cs(m);g===this.userId&&i.isPrefixOf(w)?w.length===r&&(a=a.add(y)):d.done()})).next((()=>this.rr(e,a)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(pa(e).get(s).next((o=>{if(o===null)throw Ne(35274,{batchId:s});je(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Zl(this.serializer,o))})))})),J.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return cN(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),J.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return J.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return th(e).ee({range:i},((s,o,a)=>{if(s[0]===this.userId){const c=Cs(s[1]);r.push(c)}else a.done()})).next((()=>{je(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return uN(e,this.userId,t)}_r(e){return hN(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:uc,lastStreamToken:""}))}}function uN(n,e,t){const i=d0(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return th(n).ee({range:s,X:!0},((a,c,h)=>{const[d,g,m]=a;d===e&&g===r&&(o=!0),h.done()})).next((()=>o))}function pa(n){return bn(n,Kr)}function th(n){return bn(n,Dh)}function hN(n){return bn(n,mg)}class Mc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Mc(0)}static cr(){return new Mc(-1)}}class JU{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Mc(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ge.fromTimestamp(new Pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>zu(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(je(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return zu(e).ee(((o,a)=>{const c=Ef(a);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))})).next((()=>J.waitFor(s))).next((()=>r))}forEachTarget(e,t){return zu(e).ee(((i,r)=>{const s=Ef(r);t(s)}))}lr(e){return KP(e).get(u_).next((t=>(je(t!==null,2888),t)))}hr(e,t){return KP(e).put(u_,t)}Pr(e,t){return zu(e).put(rN(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Pc(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return zu(e).ee({range:r,index:rL},((o,a,c)=>{const h=Ef(a);im(t,h.target)&&(s=h,c.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Sa(e);return t.forEach((o=>{const a=fi(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))})),J.waitFor(r)}removeMatchingKeys(e,t,i){const r=Sa(e);return J.forEach(t,(s=>{const o=fi(s.path);return J.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Sa(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Sa(e);let s=it();return r.ee({range:i,X:!0},((o,a,c)=>{const h=Cs(o[1]),d=new Re(h);s=s.add(d)})).next((()=>s))}containsKey(e,t){const i=fi(t.path),r=IDBKeyRange.bound([i],[Y4(i)],!1,!0);let s=0;return Sa(e).ee({index:wS,X:!0,range:r},(([o,a],c,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return zu(e).get(t).next((i=>i?Ef(i):null))}}function zu(n){return bn(n,Vh)}function KP(n){return bn(n,hc)}function Sa(n){return bn(n,Fh)}const qP="LruGarbageCollector",eB=1048576;function YP([n,e],[t,i]){const r=Ze(n,t);return r===0?Ze(e,i):r}class tB{constructor(e){this.Ir=e,this.buffer=new bt(YP),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();YP(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dN{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ve(qP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ll(t)?ve(qP,"Ignoring IndexedDB error during garbage collection: ",t):await Wc(t)}await this.Vr(3e5)}))}}class nB{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return J.resolve(br.ce);const i=new tB(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),J.resolve(HP)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HP):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,a,c,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r)))).next((g=>(i=g,a=Date.now(),this.removeTargets(e,i,t)))).next((g=>(s=g,c=Date.now(),this.removeOrphanedDocuments(e,i)))).next((g=>(h=Date.now(),Qu()<=at.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${g} documents in `+(h-c)+`ms
Total Duration: ${h-d}ms`),J.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g}))))}}function fN(n,e){return new nB(n,e)}class iB{constructor(e,t){this.db=e,this.garbageCollector=fN(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Kp(e,i)}removeReference(e,t,i){return Kp(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Kp(e,t)}br(e,t){return(function(r,s){let o=!1;return hN(r).te((a=>uN(r,a,s).next((c=>(c&&(o=!0),J.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=t){const c=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Ge.min()),Sa(e).delete((function(g){return[0,fi(g.path)]})(o)))))}));r.push(c)}})).next((()=>J.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Kp(e,t)}Sr(e,t){const i=Sa(e);let r,s=br.ce;return i.ee({index:wS},(([o,a],{path:c,sequenceNumber:h})=>{o===0?(s!==br.ce&&t(new Re(Cs(r)),s),s=h,r=c):s=br.ce})).next((()=>{s!==br.ce&&t(new Re(Cs(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kp(n,e){return Sa(n).put((function(i,r){return{targetId:0,path:fi(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class gN{constructor(){this.changes=new Vo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,on.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?J.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class rB{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return jl(e).put(i)}removeEntry(e,t,i){return jl(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],__(o),a[a.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=on.newInvalidDocument(t);return jl(e).ee({index:f0,range:IDBKeyRange.only(af(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:on.newInvalidDocument(t)};return jl(e).ee({index:f0,range:IDBKeyRange.only(af(t))},((r,s)=>{i={document:this.Cr(t,s),size:v_(s)}})).next((()=>i))}getEntries(e,t){let i=tr();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=tr(),r=new qt(Re.comparator);return this.Fr(e,t,((s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a),r=r.insert(s,v_(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return J.resolve();let r=new bt(ZP);t.forEach((c=>r=r.add(c)));const s=IDBKeyRange.bound(af(r.first()),af(r.last())),o=r.getIterator();let a=o.getNext();return jl(e).ee({index:f0,range:s},((c,h,d)=>{const g=Re.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&ZP(a,g)<0;)i(a,null),a=o.getNext();a&&a.isEqual(g)&&(i(a,h),a=o.hasNext()?o.getNext():null),a?d.j(af(a)):d.done()})).next((()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),__(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return jl(e).J(IDBKeyRange.bound(a,c,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let d=tr();for(const g of h){const m=this.Cr(Re.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(sm(t,m)||r.has(m.key))&&(d=d.insert(m.key,m))}return d}))}getAllFromCollectionGroup(e,t,i,r){let s=tr();const o=QP(t,i),a=QP(t,sr.max());return jl(e).ee({index:iL,range:IDBKeyRange.bound(o,a,!0)},((c,h,d)=>{const g=this.Cr(Re.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(g.key,g),s.size===r&&d.done()})).next((()=>s))}newChangeBuffer(e){return new sB(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return XP(e).get(Iw).next((t=>(je(!!t,20021),t)))}Dr(e,t){return XP(e).put(Iw,t)}Cr(e,t){if(t){const i=zU(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ge.min())))return i}return on.newInvalidDocument(e)}}function mN(n){return new rB(n)}class sB extends gN{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Vo((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new bt(((s,o)=>Ze(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=LP(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=v_(c);i+=h-a.size,t.push(this.Nr.addEntry(e,s,c))}else if(i-=a.size,this.trackRemovals){const c=LP(this.Nr.serializer,o.convertToNoDocument(Ge.min()));t.push(this.Nr.addEntry(e,s,c))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),J.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function XP(n){return bn(n,pg)}function jl(n){return bn(n,c_)}function af(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function QP(n,e){const t=e.documentKey.path.toArray();return[n,__(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ZP(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Ze(t[s],i[s]),r)return r;return r=Ze(t.length,i.length),r||(r=Ze(t[t.length-2],i[i.length-2]),r||Ze(t[t.length-1],i[i.length-1]))}class oB{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class pN{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Ff(i.mutation,r,ji.empty(),Pt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,it()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=it()){const r=bs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=yf();return s.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=bs();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,it())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,r){let s=tr();const o=Vf(),a=(function(){return Vf()})();return t.forEach(((c,h)=>{const d=i.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof Fo)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),Ff(d.mutation,h,d.mutation.getFieldMask(),Pt.now())):o.set(h.key,ji.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((h,d)=>o.set(h,d))),t.forEach(((h,d)=>a.set(h,new oB(d,o.get(h)??null)))),a)))}recalculateAndSaveOverlays(e,t){const i=Vf();let r=new qt(((o,a)=>o-a)),s=it();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((c=>{const h=t.get(c);if(h===null)return;let d=i.get(c)||ji.empty();d=a.applyToLocalView(h,d),i.set(c,d);const g=(r.get(a.batchId)||it()).add(c);r=r.insert(a.batchId,g)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,d=c.value,g=NL();d.forEach((m=>{if(!s.has(m)){const y=GL(t.get(m),i.get(m));y!==null&&g.set(m,y),s=s.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return J.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Re.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):CL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):J.resolve(bs());let a=dg,c=s;return o.next((h=>J.forEach(h,((d,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(d)?J.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{c=c.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,c,h,it()))).next((d=>({batchId:a,changes:LL(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Re(t)).next((i=>{let r=yf();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=yf();return this.indexManager.getCollectionParents(e,s).next((a=>J.forEach(a,(c=>{const h=(function(g,m){return new rm(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((d=>{d.forEach(((g,m)=>{o=o.insert(g,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((c,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,on.newInvalidDocument(d)))}));let a=yf();return o.forEach(((c,h)=>{const d=s.get(c);d!==void 0&&Ff(d.mutation,h,ji.empty(),Pt.now()),sm(t,h)&&(a=a.insert(c,h))})),a}))}}class aB{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return J.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Ti(r.createTime)}})(t)),J.resolve()}getNamedQuery(e,t){return J.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:sN(r.bundledQuery),readTime:Ti(r.readTime)}})(t)),J.resolve()}}class lB{constructor(){this.overlays=new qt(Re.comparator),this.qr=new Map}getOverlay(e,t){return J.resolve(this.overlays.get(t))}getOverlays(e,t){const i=bs();return J.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),J.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),J.resolve()}getOverlaysForCollection(e,t,i){const r=bs(),s=t.length+1,o=new Re(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return J.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new qt(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let d=s.get(h.largestBatchId);d===null&&(d=bs(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=bs(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,d)=>a.set(h,d))),!(a.size()>=r)););return J.resolve(a)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new LS(t,i));let s=this.qr.get(t);s===void 0&&(s=it(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class cB{constructor(){this.sessionToken=wn.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,J.resolve()}}class FS{constructor(){this.Qr=new bt(Vn.$r),this.Ur=new bt(Vn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Vn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new Vn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Re(new Et([])),i=new Vn(t,e),r=new Vn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Re(new Et([])),i=new Vn(t,e),r=new Vn(t,e+1);let s=it();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new Vn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Vn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Re.comparator(e.key,t.key)||Ze(e.Yr,t.Yr)}static Kr(e,t){return Ze(e.Yr,t.Yr)||Re.comparator(e.key,t.key)}}class uB{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new bt(Vn.$r)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new MS(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Vn(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return J.resolve(o)}lookupMutationBatch(e,t){return J.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return J.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?uc:this.tr-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Vn(t,0),r=new Vn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const a=this.Xr(o.Yr);s.push(a)})),J.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new bt(Ze);return t.forEach((r=>{const s=new Vn(r,0),o=new Vn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{i=i.add(a.Yr)}))})),J.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Re.isDocumentKey(s)||(s=s.child(""));const o=new Vn(new Re(s),0);let a=new bt(Ze);return this.Zr.forEachWhile((c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(c.Yr)),!0)}),o),J.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){je(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return J.forEach(t.mutations,(r=>{const s=new Vn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new Vn(t,0),r=this.Zr.firstAfterOrEqual(i);return J.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class hB{constructor(e){this.ri=e,this.docs=(function(){return new qt(Re.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return J.resolve(i?i.document.mutableCopy():on.newInvalidDocument(t))}getEntries(e,t){let i=tr();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():on.newInvalidDocument(r))})),J.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=tr();const o=t.path,a=new Re(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:d}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||vS(Z4(d),i)<=0||(r.has(d.key)||sm(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return J.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Ne(9500)}ii(e,t){return J.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new dB(this)}getSize(e){return J.resolve(this.size)}}class dB extends gN{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),J.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class fB{constructor(e){this.persistence=e,this.si=new Vo((t=>Pc(t)),im),this.lastRemoteSnapshotVersion=Ge.min(),this.highestTargetId=0,this.oi=0,this._i=new FS,this.targetCount=0,this.ai=Mc.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),J.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Mc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,J.resolve()}updateTargetData(e,t){return this.Pr(t),J.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),J.waitFor(s).next((()=>r))}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return J.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),J.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),J.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),J.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return J.resolve(i)}containsKey(e,t){return J.resolve(this._i.containsKey(t))}}class jS{constructor(e,t){this.ui={},this.overlays={},this.ci=new br(0),this.li=!1,this.li=!0,this.hi=new cB,this.referenceDelegate=e(this),this.Pi=new fB(this),this.indexManager=new QU,this.remoteDocumentCache=(function(r){return new hB(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new iN(t),this.Ii=new aB(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new lB,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new uB(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ve("MemoryPersistence","Starting transaction:",e);const r=new gB(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return J.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class gB extends eL{constructor(e){super(),this.currentSequenceNumber=e}}class Dy{constructor(e){this.persistence=e,this.Ri=new FS,this.Vi=null}static mi(e){return new Dy(e)}get fi(){if(this.Vi)return this.Vi;throw Ne(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),J.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),J.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),J.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.fi,(i=>{const r=Re.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Ge.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return J.or([()=>J.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class E_{constructor(e,t){this.persistence=e,this.pi=new Vo((i=>fi(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=fN(this,t)}static mi(e,t){return new E_(e,t)}Ei(){}di(e){return J.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return J.forEach(this.pi,((i,r)=>this.br(e,i,r).next((s=>s?J.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,t).next((a=>{a||(i++,s.removeEntry(o,Ge.min()))})))).next((()=>s.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),J.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),J.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),J.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),J.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=m0(e.data.value)),t}br(e,t,i){return J.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return J.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class mB{constructor(e){this.serializer=e}k(e,t,i,r){const s=new xy("createOrUpgrade",t);i<1&&r>=1&&((function(c){c.createObjectStore(nm)})(e),(function(c){c.createObjectStore(mg,{keyPath:T7}),c.createObjectStore(Kr,{keyPath:cP,autoIncrement:!0}).createIndex(sc,uP,{unique:!0}),c.createObjectStore(Dh)})(e),JP(e),(function(c){c.createObjectStore(Hl)})(e));let o=J.resolve();return i<3&&r>=3&&(i!==0&&((function(c){c.deleteObjectStore(Fh),c.deleteObjectStore(Vh),c.deleteObjectStore(hc)})(e),JP(e)),o=o.next((()=>(function(c){const h=c.store(hc),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ge.min().toTimestamp(),targetCount:0};return h.put(u_,d)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(c,h){return h.store(Kr).J().next((g=>{c.deleteObjectStore(Kr),c.createObjectStore(Kr,{keyPath:cP,autoIncrement:!0}).createIndex(sc,uP,{unique:!0});const m=h.store(Kr),y=g.map((w=>m.put(w)));return J.waitFor(y)}))})(e,s)))),o=o.next((()=>{(function(c){c.createObjectStore(jh,{keyPath:N7})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(c){c.createObjectStore(pg)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(Iy,{keyPath:O7})})(e),(function(c){c.createObjectStore(Ty,{keyPath:D7})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(c){const h=c.createObjectStore(Ry,{keyPath:z7});h.createIndex(Rw,$7,{unique:!1}),h.createIndex(aL,W7,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(c){const h=c.createObjectStore(c_,{keyPath:A7});h.createIndex(f0,P7),h.createIndex(iL,C7)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Hl)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(c){c.createObjectStore(xS,{keyPath:V7,autoIncrement:!0}).createIndex(Tw,F7,{unique:!1}),c.createObjectStore(Lf,{keyPath:j7}).createIndex(sL,G7,{unique:!1}),c.createObjectStore(Nf,{keyPath:U7}).createIndex(oL,B7,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(Lf).clear()})).next((()=>{t.objectStore(Nf).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(SS,{keyPath:H7})})(e)}))),i<18&&r>=18&&N4()&&(o=o.next((()=>{t.objectStore(Lf).clear()})).next((()=>{t.objectStore(Nf).clear()}))),o}wi(e){let t=0;return e.store(Hl).ee(((i,r)=>{t+=v_(r)})).next((()=>{const i={byteSize:t};return e.store(pg).put(Iw,i)}))}yi(e){const t=e.store(mg),i=e.store(Kr);return t.J().next((r=>J.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,uc],[s.userId,s.lastAcknowledgedBatchId]);return i.J(sc,o).next((a=>J.forEach(a,(c=>{je(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const h=Zl(this.serializer,c);return cN(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(Fh),i=e.store(Hl);return e.store(hc).get(u_).next((r=>{const s=[];return i.ee(((o,a)=>{const c=new Et(o),h=(function(g){return[0,fi(g)]})(c);s.push(t.get(h).next((d=>d?J.resolve():(g=>t.put({targetId:0,path:fi(g),sequenceNumber:r.highestListenSequenceNumber}))(c))))})).next((()=>J.waitFor(s)))}))}bi(e,t){e.createObjectStore(_g,{keyPath:L7});const i=t.store(_g),r=new VS,s=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:fi(c)})}};return t.store(Hl).ee({X:!0},((o,a)=>{const c=new Et(o);return s(c.popLast())})).next((()=>t.store(Dh).ee({X:!0},(([o,a,c],h)=>{const d=Cs(a);return s(d.popLast())}))))}Di(e){const t=e.store(Vh);return t.ee(((i,r)=>{const s=Ef(r),o=rN(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Hl),r=[];return i.ee(((s,o)=>{const a=t.store(c_),c=(function(g){return g.document?new Re(Et.fromString(g.document.name).popFirst(5)):g.noDocument?Re.fromSegments(g.noDocument.path):g.unknownDocument?Re.fromSegments(g.unknownDocument.path):Ne(36783)})(o).path.toArray(),h={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(h))})).next((()=>J.waitFor(r)))}Fi(e,t){const i=t.store(Kr),r=mN(this.serializer),s=new jS(Dy.mi,this.serializer.yt);return i.J().next((o=>{const a=new Map;return o.forEach((c=>{let h=a.get(c.userId)??it();Zl(this.serializer,c).keys().forEach((d=>h=h.add(d))),a.set(c.userId,h)})),J.forEach(a,((c,h)=>{const d=new Xn(h),g=Ny.wt(this.serializer,d),m=s.getIndexManager(d),y=Oy.wt(d,this.serializer,m,s.referenceDelegate);return new pN(r,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new Aw(t,br.ce),c).next()}))}))}}function JP(n){n.createObjectStore(Fh,{keyPath:M7}).createIndex(wS,k7,{unique:!0}),n.createObjectStore(Vh,{keyPath:"targetId"}).createIndex(rL,b7,{unique:!0}),n.createObjectStore(hc)}const _a="IndexedDbPersistence",pE=18e5,_E=5e3,yE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",pB="main";class GS{constructor(e,t,i,r,s,o,a,c,h,d,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=a,this.xi=h,this.Oi=d,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!GS.v())throw new Te(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new iB(this,r),this.$i=t+pB,this.serializer=new iN(c),this.Ui=new Ba(this.$i,this.Ni,new mB(this.serializer)),this.hi=new WU,this.Pi=new JU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=mN(this.serializer),this.Ii=new $U,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&wi(_a,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Te(le.FAILED_PRECONDITION,yE);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new br(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>qp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(ll(e))return ve(_a,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ve(_a,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return lf(e).get(Fu).next((t=>J.resolve(this.es(t))))}ts(e){return qp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,pE)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=bn(t,jh);return i.J().next((r=>{const s=this.ss(r,pE),o=r.filter((a=>s.indexOf(a)===-1));return J.forEach(o,(a=>i.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?J.resolve(!0):lf(e).get(Fu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,_E)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Te(le.FAILED_PRECONDITION,yE);return!1}}return!(!this.networkEnabled||!this.inForeground)||qp(e).J().next((i=>this.ss(i,_E).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ve(_a,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[nm,jh],(e=>{const t=new Aw(e,br.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>qp(e).J().next((t=>this.ss(t,pE).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Oy.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ZU(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Ny.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ve(_a,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?Y7:c===17?hL:c===16?q7:c===15?IS:c===14?uL:c===13?cL:c===12?K7:c===11?lL:void Ne(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(a=>(o=new Aw(a,this.ci?this.ci.next():br.ce),t==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw wi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Te(le.FAILED_PRECONDITION,J4);return i(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>i(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return lf(e).get(Fu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,_E)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Te(le.FAILED_PRECONDITION,yE)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return lf(e).put(Fu,t)}static v(){return Ba.v()}Zi(e){const t=lf(e);return t.get(Fu).next((i=>this.es(i)?(ve(_a,"Releasing primary lease."),t.delete(Fu)):J.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(wi(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;L4()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ve(_a,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return wi(_a,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){wi("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function lf(n){return bn(n,nm)}function qp(n){return bn(n,jh)}function _B(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class US{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=it(),r=it();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new US(e,t.fromCache,i,r)}}class yB{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class _N{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return L4()?8:tL(Cn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new yB;return this.Ss(e,t,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Qu()<=at.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Zu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),J.resolve()):(Qu()<=at.DEBUG&&ve("QueryEngine","Query:",Zu(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Qu()<=at.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Zu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kr(t))):J.resolve())}ys(e,t){if(SP(t))return J.resolve(null);let i=kr(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=Nw(t,null,"F"),i=kr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=it(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((c=>{const h=this.Ds(t,a);return this.Cs(t,h,o,c.readTime)?this.ys(e,Nw(t,null,"F")):this.vs(e,h,t,c)}))))})))))}ws(e,t,i,r){return SP(t)||r.isEqual(Ge.min())?J.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?J.resolve(null):(Qu()<=at.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Zu(t)),this.vs(e,o,t,y7(r,dg)).next((a=>a)))}))}Ds(e,t){let i=new bt(ML(e));return t.forEach(((r,s)=>{sm(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Qu()<=at.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Zu(t)),this.ps.getDocumentsMatchingQuery(e,t,sr.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const BS="LocalStore",vB=3e8;class EB{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new qt(Ze),this.xs=new Vo((s=>Pc(s)),im),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pN(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function yN(n,e,t,i){return new EB(n,e,t,i)}async function vN(n,e){const t=Je(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let c=it();for(const h of r){o.push(h.batchId);for(const d of h.mutations)c=c.add(d.key)}for(const h of s){a.push(h.batchId);for(const d of h.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(i,c).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function wB(n,e){const t=Je(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,h,d){const g=h.batch,m=g.keys();let y=J.resolve();return m.forEach((w=>{y=y.next((()=>d.getEntry(c,w))).next((I=>{const E=h.docVersions.get(w);je(E!==null,48541),I.version.compareTo(E)<0&&(g.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),d.addEntry(I)))}))})),y.next((()=>a.mutationQueue.removeMutationBatch(c,g)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=it();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(c=c.add(a.batch.mutations[h].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function EN(n){const e=Je(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function xB(n,e){const t=Je(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const a=[];e.targetChanges.forEach(((d,g)=>{const m=r.get(g);if(!m)return;a.push(t.Pi.removeMatchingKeys(s,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,d.addedDocuments,g))));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?y=y.withResumeToken(wn.EMPTY_BYTE_STRING,Ge.min()).withLastLimboFreeSnapshotVersion(Ge.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,i)),r=r.insert(g,y),(function(I,E,A){return I.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=vB?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0})(m,y,d)&&a.push(t.Pi.updateTargetData(s,y))}));let c=tr(),h=it();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))})),a.push(SB(s,o,e.documentUpdates).next((d=>{c=d.ks,h=d.qs}))),!i.isEqual(Ge.min())){const d=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(d)}return J.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,c,h))).next((()=>c))})).then((s=>(t.Ms=r,s)))}function SB(n,e,t){let i=it(),r=it();return t.forEach((s=>i=i.add(s))),e.getEntries(n,i).next((s=>{let o=tr();return t.forEach(((a,c)=>{const h=s.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(Ge.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):ve(BS,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)})),{ks:o,qs:r}}))}function IB(n,e){const t=Je(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=uc),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function TB(n,e){const t=Je(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((s=>s?(r=s,J.resolve(r)):t.Pi.allocateTargetId(i).next((o=>(r=new vo(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function Bw(n,e,t){const i=Je(n),r=i.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!ll(o))throw o;ve(BS,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function eC(n,e,t){const i=Je(n);let r=Ge.min(),s=it();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,h,d){const g=Je(c),m=g.xs.get(d);return m!==void 0?J.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(i,o,kr(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{s=c}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,e,t?r:Ge.min(),t?s:it()))).next((a=>(RB(i,uU(e),a),{documents:a,Qs:s})))))}function RB(n,e,t){let i=n.Os.get(e)||Ge.min();t.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.Os.set(e,i)}class tC{constructor(){this.activeTargetIds=pU()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wN{constructor(){this.Mo=new tC,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new tC,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class AB{Oo(e){}shutdown(){}}const nC="ConnectivityMonitor";class iC{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ve(nC,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ve(nC,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Yp=null;function zw(){return Yp===null?Yp=(function(){return 268435456+Math.round(2147483648*Math.random())})():Yp++,"0x"+Yp.toString(16)}const vE="RestConnection",PB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CB{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===h_?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=zw(),a=this.zo(e,t.toUriEncodedString());ve(vE,`Sending RPC '${e}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,s);const{host:h}=new URL(a),d=zc(h);return this.Jo(e,a,c,i,d).then((g=>(ve(vE,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw Rc(vE,`RPC '${e}' ${o} failed with error: `,g,"url: ",a,"request:",i),g}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ed})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=PB[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class bB{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const si="WebChannelConnection";class MB extends CB{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=zw();return new Promise(((a,c)=>{const h=new B4;h.setWithCredentials(!0),h.listenOnce(z4.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case u0.NO_ERROR:const g=h.getResponseJson();ve(si,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case u0.TIMEOUT:ve(si,`RPC '${e}' ${o} timed out`),c(new Te(le.DEADLINE_EXCEEDED,"Request time out"));break;case u0.HTTP_ERROR:const m=h.getStatus();if(ve(si,`RPC '${e}' ${o} failed with status:`,m,"response text:",h.getResponseText()),m>0){let y=h.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y?.error;if(w&&w.status&&w.message){const I=(function(A){const b=A.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(b)>=0?b:le.UNKNOWN})(w.status);c(new Te(I,w.message))}else c(new Te(le.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new Te(le.UNAVAILABLE,"Connection failed."));break;default:Ne(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ve(si,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(r);ve(si,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",d,i,15)}))}T_(e,t,i){const r=zw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=H4(),a=W4(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const d=s.join("");ve(si,`Creating RPC '${e}' stream ${r}: ${d}`,c);const g=o.createWebChannel(d,c);this.I_(g);let m=!1,y=!1;const w=new bB({Yo:E=>{y?ve(si,`Not sending because RPC '${e}' stream ${r} is closed:`,E):(m||(ve(si,`Opening RPC '${e}' stream ${r} transport.`),g.open(),m=!0),ve(si,`RPC '${e}' stream ${r} sending:`,E),g.send(E))},Zo:()=>g.close()}),I=(E,A,b)=>{E.listen(A,(N=>{try{b(N)}catch(D){setTimeout((()=>{throw D}),0)}}))};return I(g,_f.EventType.OPEN,(()=>{y||(ve(si,`RPC '${e}' stream ${r} transport opened.`),w.o_())})),I(g,_f.EventType.CLOSE,(()=>{y||(y=!0,ve(si,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(g))})),I(g,_f.EventType.ERROR,(E=>{y||(y=!0,Rc(si,`RPC '${e}' stream ${r} transport errored. Name:`,E.name,"Message:",E.message),w.a_(new Te(le.UNAVAILABLE,"The operation could not be completed")))})),I(g,_f.EventType.MESSAGE,(E=>{if(!y){const A=E.data[0];je(!!A,16349);const b=A,N=b?.error||b[0]?.error;if(N){ve(si,`RPC '${e}' stream ${r} received error:`,N);const D=N.status;let O=(function(C){const L=_n[C];if(L!==void 0)return zL(L)})(D),$=N.message;O===void 0&&(O=le.INTERNAL,$="Unknown error status: "+D+" with message "+N.message),y=!0,w.a_(new Te(O,$)),g.close()}else ve(si,`RPC '${e}' stream ${r} received:`,A),w.u_(A)}})),I(a,$4.STAT_EVENT,(E=>{E.stat===ww.PROXY?ve(si,`RPC '${e}' stream ${r} detected buffering proxy`):E.stat===ww.NOPROXY&&ve(si,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function kB(){return typeof window<"u"?window:null}function E0(){return typeof document<"u"?document:null}function Vy(n){return new LU(n,!0)}class xN{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&ve("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const rC="PersistentStream";class SN{constructor(e,t,i,r,s,o,a,c){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new xN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(wi(t.toString()),wi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Te(le.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ve(rC,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ve(rC,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class LB extends SN{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=DU(this.serializer,e),i=(function(s){if(!("targetChange"in s))return Ge.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ge.min():o.readTime?Ti(o.readTime):Ge.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=Vw(this.serializer),t.addTarget=(function(s,o){let a;const c=o.target;if(a=f_(c)?{documents:QL(s,c)}:{query:ZL(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=HL(s,o.resumeToken);const h=Ow(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Ge.min())>0){a.readTime=Hh(s,o.snapshotVersion.toTimestamp());const h=Ow(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,e);const i=FU(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=Vw(this.serializer),t.removeTarget=e,this.q_(t)}}class NB extends SN{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=VU(e.writeResults,e.commitTime),i=Ti(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Vw(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>p_(this.serializer,i)))};this.q_(t)}}class OB{}class DB extends OB{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Te(le.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,Dw(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(le.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,Dw(t,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Te(le.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class VB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(wi(t),this.aa=!1):ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const kc="RemoteStore";class FB{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Hc(this)&&(ve(kc,"Restarting streams for network reachability change."),await(async function(c){const h=Je(c);h.Ea.add(4),await am(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Fy(h)})(this))}))})),this.Ra=new VB(i,r)}}async function Fy(n){if(Hc(n))for(const e of n.da)await e(!0)}async function am(n){for(const e of n.da)await e(!1)}function IN(n,e){const t=Je(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),HS(t)?WS(t):nd(t).O_()&&$S(t,e))}function zS(n,e){const t=Je(n),i=nd(t);t.Ia.delete(e),i.O_()&&TN(t,e),t.Ia.size===0&&(i.O_()?i.L_():Hc(t)&&t.Ra.set("Unknown"))}function $S(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ge.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nd(n).Y_(e)}function TN(n,e){n.Va.Ue(e),nd(n).Z_(e)}function WS(n){n.Va=new CU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),nd(n).start(),n.Ra.ua()}function HS(n){return Hc(n)&&!nd(n).x_()&&n.Ia.size>0}function Hc(n){return Je(n).Ea.size===0}function RN(n){n.Va=void 0}async function jB(n){n.Ra.set("Online")}async function GB(n){n.Ia.forEach(((e,t)=>{$S(n,e)}))}async function UB(n,e){RN(n),HS(n)?(n.Ra.ha(e),WS(n)):n.Ra.set("Unknown")}async function BB(n,e,t){if(n.Ra.set("Online"),e instanceof WL&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))})(n,e)}catch(i){ve(kc,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await w_(n,i)}else if(e instanceof y0?n.Va.Ze(e):e instanceof $L?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ge.min()))try{const i=await EN(n.localStore);t.compareTo(i)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,h)=>{const d=s.Ia.get(c);if(!d)return;s.Ia.set(c,d.withResumeToken(wn.EMPTY_BYTE_STRING,d.snapshotVersion)),TN(s,c);const g=new vo(d.target,c,h,d.sequenceNumber);$S(s,g)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){ve(kc,"Failed to raise snapshot:",i),await w_(n,i)}}async function w_(n,e,t){if(!ll(e))throw e;n.Ea.add(1),await am(n),n.Ra.set("Offline"),t||(t=()=>EN(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ve(kc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Fy(n)}))}function AN(n,e){return e().catch((t=>w_(n,t,e)))}async function lm(n){const e=Je(n),t=el(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:uc;for(;zB(e);)try{const r=await IB(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,$B(e,r)}catch(r){await w_(e,r)}PN(e)&&CN(e)}function zB(n){return Hc(n)&&n.Ta.length<10}function $B(n,e){n.Ta.push(e);const t=el(n);t.O_()&&t.X_&&t.ea(e.mutations)}function PN(n){return Hc(n)&&!el(n).x_()&&n.Ta.length>0}function CN(n){el(n).start()}async function WB(n){el(n).ra()}async function HB(n){const e=el(n);for(const t of n.Ta)e.ea(t.mutations)}async function KB(n,e,t){const i=n.Ta.shift(),r=kS.from(i,e,t);await AN(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await lm(n)}async function qB(n,e){e&&el(n).X_&&await(async function(i,r){if((function(o){return RU(o)&&o!==le.ABORTED})(r.code)){const s=i.Ta.shift();el(i).B_(),await AN(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await lm(i)}})(n,e),PN(n)&&CN(n)}async function sC(n,e){const t=Je(n);t.asyncQueue.verifyOperationInProgress(),ve(kc,"RemoteStore received new credentials");const i=Hc(t);t.Ea.add(3),await am(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Fy(t)}async function YB(n,e){const t=Je(n);e?(t.Ea.delete(2),await Fy(t)):e||(t.Ea.add(2),await am(t),t.Ra.set("Unknown"))}function nd(n){return n.ma||(n.ma=(function(t,i,r){const s=Je(t);return s.sa(),new LB(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:jB.bind(null,n),t_:GB.bind(null,n),r_:UB.bind(null,n),H_:BB.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),HS(n)?WS(n):n.Ra.set("Unknown")):(await n.ma.stop(),RN(n))}))),n.ma}function el(n){return n.fa||(n.fa=(function(t,i,r){const s=Je(t);return s.sa(),new NB(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:WB.bind(null,n),r_:qB.bind(null,n),ta:HB.bind(null,n),na:KB.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await lm(n)):(await n.fa.stop(),n.Ta.length>0&&(ve(kc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class KS{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Ao,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new KS(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qS(n,e){if(wi("AsyncQueue",`${e}: ${n}`),ll(n))return new Te(le.UNAVAILABLE,`${e}: ${n}`);throw n}class yh{static emptySet(e){return new yh(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Re.comparator(t.key,i.key):(t,i)=>Re.comparator(t.key,i.key),this.keyedMap=yf(),this.sortedSet=new qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof yh)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new yh;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class oC{constructor(){this.ga=new qt(Re.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ne(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Kh{constructor(e,t,i,r,s,o,a,c,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Kh(e,t,yh.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class XB{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class QB{constructor(){this.queries=aC(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Je(t),s=r.queries;r.queries=aC(),s.forEach(((o,a)=>{for(const c of a.Sa)c.onError(i)}))})(this,new Te(le.ABORTED,"Firestore shutting down"))}}function aC(){return new Vo((n=>bL(n)),Cy)}async function ZB(n,e){const t=Je(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.ba()&&e.Da()&&(i=2):(s=new XB,i=e.Da()?0:1);try{switch(i){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=qS(o,`Initialization of query '${Zu(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&YS(t)}async function JB(n,e){const t=Je(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function ez(n,e){const t=Je(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Fa(r)&&(i=!0);o.wa=r}}i&&YS(t)}function tz(n,e,t){const i=Je(n),r=i.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);i.queries.delete(e)}function YS(n){n.Ca.forEach((e=>{e.next()}))}var $w,lC;(lC=$w||($w={})).Ma="default",lC.Cache="cache";class nz{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Kh(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Kh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==$w.Cache}}class bN{constructor(e){this.key=e}}class MN{constructor(e){this.key=e}}class iz{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=it(),this.mutatedKeys=it(),this.eu=ML(e),this.tu=new yh(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new oC,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((d,g)=>{const m=r.get(d),y=sm(this.query,g)?g:null,w=!!m&&this.mutatedKeys.has(m.key),I=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;m&&y?m.data.isEqual(y.data)?w!==I&&(i.track({type:3,doc:y}),E=!0):this.su(m,y)||(i.track({type:2,doc:y}),E=!0,(c&&this.eu(y,c)>0||h&&this.eu(y,h)<0)&&(a=!0)):!m&&y?(i.track({type:0,doc:y}),E=!0):m&&!y&&(i.track({type:1,doc:m}),E=!0,(c||h)&&(a=!0)),E&&(y?(o=o.add(y),s=I?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{tu:o,iu:i,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(y,w){const I=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne(20277,{Rt:E})}};return I(y)-I(w)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(i),r=r??!1;const a=t&&!r?this._u():[],c=this.Xa.size===0&&this.current&&!r?1:0,h=c!==this.Za;return this.Za=c,o.length!==0||h?{snapshot:new Kh(this.query,e.tu,s,o,e.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oC,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=it(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new MN(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new bN(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=it();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Kh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const XS="SyncEngine";class rz{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class sz{constructor(e){this.key=e,this.hu=!1}}class oz{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Vo((a=>bL(a)),Cy),this.Iu=new Map,this.Eu=new Set,this.du=new qt(Re.comparator),this.Au=new Map,this.Ru=new FS,this.Vu={},this.mu=new Map,this.fu=Mc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function az(n,e,t=!0){const i=VN(n);let r;const s=i.Tu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await kN(i,e,t,!0),r}async function lz(n,e){const t=VN(n);await kN(t,e,!0,!1)}async function kN(n,e,t,i){const r=await TB(n.localStore,kr(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await cz(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&IN(n.remoteStore,r),a}async function cz(n,e,t,i,r){n.pu=(g,m,y)=>(async function(I,E,A,b){let N=E.view.ru(A);N.Cs&&(N=await eC(I.localStore,E.query,!1).then((({documents:k})=>E.view.ru(k,N))));const D=b&&b.targetChanges.get(E.targetId),O=b&&b.targetMismatches.get(E.targetId)!=null,$=E.view.applyChanges(N,I.isPrimaryClient,D,O);return uC(I,E.targetId,$.au),$.snapshot})(n,g,m,y);const s=await eC(n.localStore,e,!0),o=new iz(e,s.Qs),a=o.ru(s.documents),c=om.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,c);uC(n,t,h.au);const d=new rz(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function uz(n,e,t){const i=Je(n),r=i.Tu.get(e),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter((o=>!Cy(o,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Bw(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&zS(i.remoteStore,r.targetId),Ww(i,r.targetId)})).catch(Wc)):(Ww(i,r.targetId),await Bw(i.localStore,r.targetId,!0))}async function hz(n,e){const t=Je(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),zS(t.remoteStore,i.targetId))}async function dz(n,e,t){const i=FN(n);try{const r=await(function(o,a){const c=Je(o),h=Pt.now(),d=a.reduce(((y,w)=>y.add(w.key)),it());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let w=tr(),I=it();return c.Ns.getEntries(y,d).next((E=>{w=E,w.forEach(((A,b)=>{b.isValidDocument()||(I=I.add(A))}))})).next((()=>c.localDocuments.getOverlayedDocuments(y,w))).next((E=>{g=E;const A=[];for(const b of a){const N=IU(b,g.get(b.key).overlayedDocument);N!=null&&A.push(new Fo(b.key,N,wL(N.value.mapValue),xi.exists(!0)))}return c.mutationQueue.addMutationBatch(y,h,A,a)})).next((E=>{m=E;const A=E.applyToLocalDocumentSet(g,I);return c.documentOverlayCache.saveOverlays(y,E.batchId,A)}))})).then((()=>({batchId:m.batchId,changes:LL(g)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,c){let h=o.Vu[o.currentUser.toKey()];h||(h=new qt(Ze)),h=h.insert(a,c),o.Vu[o.currentUser.toKey()]=h})(i,r.batchId,t),await cm(i,r.changes),await lm(i.remoteStore)}catch(r){const s=qS(r,"Failed to persist write");t.reject(s)}}async function LN(n,e){const t=Je(n);try{const i=await xB(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Au.get(s);o&&(je(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?je(o.hu,14607):r.removedDocuments.size>0&&(je(o.hu,42227),o.hu=!1))})),await cm(t,i,e)}catch(i){await Wc(i)}}function cC(n,e,t){const i=Je(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const c=Je(o);c.onlineState=a;let h=!1;c.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(a)&&(h=!0)})),h&&YS(c)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function fz(n,e,t){const i=Je(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),s=r&&r.key;if(s){let o=new qt(Re.comparator);o=o.insert(s,on.newNoDocument(s,Ge.min()));const a=it().add(s),c=new Ly(Ge.min(),new Map,new qt(Ze),o,a);await LN(i,c),i.du=i.du.remove(s),i.Au.delete(e),QS(i)}else await Bw(i.localStore,e,!1).then((()=>Ww(i,e,t))).catch(Wc)}async function gz(n,e){const t=Je(n),i=e.batch.batchId;try{const r=await wB(t.localStore,e);ON(t,i,null),NN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await cm(t,r)}catch(r){await Wc(r)}}async function mz(n,e,t){const i=Je(n);try{const r=await(function(o,a){const c=Je(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return c.mutationQueue.lookupMutationBatch(h,a).next((g=>(je(g!==null,37113),d=g.keys(),c.mutationQueue.removeMutationBatch(h,g)))).next((()=>c.mutationQueue.performConsistencyCheck(h))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(h,d,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>c.localDocuments.getDocuments(h,d)))}))})(i.localStore,e);ON(i,e,t),NN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await cm(i,r)}catch(r){await Wc(r)}}function NN(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ON(n,e,t){const i=Je(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function Ww(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||DN(n,i)}))}function DN(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(zS(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),QS(n))}function uC(n,e,t){for(const i of t)i instanceof bN?(n.Ru.addReference(i.key,e),pz(n,i)):i instanceof MN?(ve(XS,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||DN(n,i.key)):Ne(19791,{wu:i})}function pz(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(ve(XS,"New document in limbo: "+t),n.Eu.add(i),QS(n))}function QS(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Re(Et.fromString(e)),i=n.fu.next();n.Au.set(i,new sz(t)),n.du=n.du.insert(t,i),IN(n.remoteStore,new vo(kr(CS(t.path)),i,"TargetPurposeLimboResolution",br.ce))}}async function cm(n,e,t){const i=Je(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,c)=>{o.push(i.pu(c,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(h){r.push(h);const d=US.As(c.targetId,h);s.push(d)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(c,h){const d=Je(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>J.forEach(h,(m=>J.forEach(m.Es,(y=>d.persistence.referenceDelegate.addReference(g,m.targetId,y))).next((()=>J.forEach(m.ds,(y=>d.persistence.referenceDelegate.removeReference(g,m.targetId,y)))))))))}catch(g){if(!ll(g))throw g;ve(BS,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const y=d.Ms.get(m),w=y.snapshotVersion,I=y.withLastLimboFreeSnapshotVersion(w);d.Ms=d.Ms.insert(m,I)}}})(i.localStore,s))}async function _z(n,e){const t=Je(n);if(!t.currentUser.isEqual(e)){ve(XS,"User change. New user:",e.toKey());const i=await vN(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((c=>{c.reject(new Te(le.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await cm(t,i.Ls)}}function yz(n,e){const t=Je(n),i=t.Au.get(e);if(i&&i.hu)return it().add(i.key);{let r=it();const s=t.Iu.get(e);if(!s)return r;for(const o of s){const a=t.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function VN(n){const e=Je(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=LN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=fz.bind(null,e),e.Pu.H_=ez.bind(null,e.eventManager),e.Pu.yu=tz.bind(null,e.eventManager),e}function FN(n){const e=Je(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mz.bind(null,e),e}class Ig{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vy(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return yN(this.persistence,new _N,e.initialUser,this.serializer)}Cu(e){return new jS(Dy.mi,this.serializer)}Du(e){return new wN}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ig.provider={build:()=>new Ig};class vz extends Ig{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){je(this.persistence.referenceDelegate instanceof E_,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new dN(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?li.withCacheSize(this.cacheSizeBytes):li.DEFAULT;return new jS((i=>E_.mi(i,t)),this.serializer)}}class Ez extends Ig{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await FN(this.xu.syncEngine),await lm(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return yN(this.persistence,new _N,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new dN(i,e.asyncQueue,t)}Mu(e,t){const i=new x7(t,this.persistence);return new w7(e.asyncQueue,i)}Cu(e){const t=_B(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?li.withCacheSize(this.cacheSizeBytes):li.DEFAULT;return new GS(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,kB(),E0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new wN}}class x_{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>cC(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=_z.bind(null,this.syncEngine),await YB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new QB})()}createDatastore(e){const t=Vy(e.databaseInfo.databaseId),i=(function(s){return new MB(s)})(e.databaseInfo);return(function(s,o,a,c){return new DB(s,o,a,c)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,a){return new FB(i,r,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>cC(this.syncEngine,t,0)),(function(){return iC.v()?new iC:new AB})())}createSyncEngine(e,t){return(function(r,s,o,a,c,h,d){const g=new oz(r,s,o,a,c,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Je(t);ve(kc,"RemoteStore shutting down."),i.Ea.add(5),await am(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}x_.provider={build:()=>new x_};class wz{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):wi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const tl="FirestoreClient";class xz{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Xn.UNAUTHENTICATED,this.clientId=yS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{ve(tl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(ve(tl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ao;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=qS(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function EE(n,e){n.asyncQueue.verifyOperationInProgress(),ve(tl,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await vN(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function hC(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Sz(n);ve(tl,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>sC(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>sC(e.remoteStore,r))),n._onlineComponents=e}async function Sz(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve(tl,"Using user provided OfflineComponentProvider");try{await EE(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===le.FAILED_PRECONDITION||r.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Rc("Error using user provided cache. Falling back to memory cache: "+t),await EE(n,new Ig)}}else ve(tl,"Using default OfflineComponentProvider"),await EE(n,new vz(void 0));return n._offlineComponents}async function jN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve(tl,"Using user provided OnlineComponentProvider"),await hC(n,n._uninitializedComponentsProvider._online)):(ve(tl,"Using default OnlineComponentProvider"),await hC(n,new x_))),n._onlineComponents}function Iz(n){return jN(n).then((e=>e.syncEngine))}async function Tz(n){const e=await jN(n),t=e.eventManager;return t.onListen=az.bind(null,e.syncEngine),t.onUnlisten=uz.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=lz.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=hz.bind(null,e.syncEngine),t}function Rz(n,e,t={}){const i=new Ao;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,h){const d=new wz({next:m=>{d.Nu(),o.enqueueAndForget((()=>JB(s,g))),m.fromCache&&c.source==="server"?h.reject(new Te(le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new nz(a,d,{includeMetadataChanges:!0,qa:!0});return ZB(s,g)})(await Tz(n),n.asyncQueue,e,t,i))),i.promise}function GN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const dC=new Map;const UN="firestore.googleapis.com",fC=!0;class gC{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=UN,this.ssl=fC}else this.host=e.host,this.ssl=e.ssl??fC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<eB)throw new Te(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Te(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jy{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gC({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gC(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new a7;switch(i.type){case"firstParty":return new h7(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Te(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=dC.get(t);i&&(ve("ComponentProvider","Removing Datastore"),dC.delete(t),i.terminate())})(this),Promise.resolve()}}function Az(n,e,t,i={}){n=Qa(n,jy);const r=zc(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;r&&(dS(`https://${a}`),fS("Firestore",!0)),s.host!==UN&&s.host!==a&&Rc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:r,emulatorOptions:i};if(!Sc(c,o)&&(n._setSettings(c),i.mockUserToken)){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Xn.MOCK_USER;else{h=M4(i.mockUserToken,n._app?.options.projectId);const g=i.mockUserToken.sub||i.mockUserToken.user_id;if(!g)throw new Te(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Xn(g)}n._authCredentials=new l7(new q4(h,d))}}class id{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new id(this.firestore,e,this._query)}}class An{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new za(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new An(this.firestore,e,this._key)}toJSON(){return{type:An._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(tm(t,An._jsonSchema))return new An(e,i||null,new Re(Et.fromString(t.referencePath)))}}An._jsonSchemaVersion="firestore/documentReference/1.0",An._jsonSchema={type:En("string",An._jsonSchemaVersion),referencePath:En("string")};class za extends id{constructor(e,t,i){super(e,t,CS(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new An(this.firestore,null,new Re(e))}withConverter(e){return new za(this.firestore,e,this._path)}}function mC(n,e,...t){if(n=jn(n),X4("collection","path",e),n instanceof jy){const i=Et.fromString(e,...t);return rP(i),new za(n,null,i)}{if(!(n instanceof An||n instanceof za))throw new Te(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Et.fromString(e,...t));return rP(i),new za(n.firestore,null,i)}}function Hw(n,e,...t){if(n=jn(n),arguments.length===1&&(e=yS.newId()),X4("doc","path",e),n instanceof jy){const i=Et.fromString(e,...t);return iP(i),new An(n,null,new Re(i))}{if(!(n instanceof An||n instanceof za))throw new Te(le.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Et.fromString(e,...t));return iP(i),new An(n.firestore,n instanceof za?n.converter:null,new Re(i))}}const pC="AsyncQueue";class _C{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new xN(this,"async_queue_retry"),this._c=()=>{const i=E0();i&&ve(pC,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=E0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=E0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ao;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ll(e))throw e;ve(pC,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,wi("INTERNAL UNHANDLED ERROR: ",yC(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=KS.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Ne(47125,{Pc:yC(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function yC(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class rd extends jy{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new _C,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _C(e),this._firestoreClient=void 0,await e}}}function Pz(n,e){const t=typeof n=="object"?n:pS(),i=typeof n=="string"?n:h_,r=Ey(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=P4("firestore");s&&Az(r,...s)}return r}function BN(n){if(n._terminated)throw new Te(le.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||zN(n),n._firestoreClient}function zN(n){const e=n._freezeSettings(),t=(function(r,s,o,a){return new Q7(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,GN(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new xz(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function Cz(n,e){Rc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return bz(n,x_.provider,{build:i=>new Ez(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function bz(n,e,t){if((n=Qa(n,rd))._firestoreClient||n._terminated)throw new Te(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Te(le.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},zN(n)}class Rr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rr(wn.fromBase64String(e))}catch(t){throw new Te(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Rr(wn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Rr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(tm(e,Rr._jsonSchema))return Rr.fromBase64String(e.bytes)}}Rr._jsonSchemaVersion="firestore/bytes/1.0",Rr._jsonSchema={type:En("string",Rr._jsonSchemaVersion),bytes:En("string")};class Gy{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Te(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ZS{constructor(e){this._methodName=e}}class Ls{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ls._jsonSchemaVersion}}static fromJSON(e){if(tm(e,Ls._jsonSchema))return new Ls(e.latitude,e.longitude)}}Ls._jsonSchemaVersion="firestore/geoPoint/1.0",Ls._jsonSchema={type:En("string",Ls._jsonSchemaVersion),latitude:En("number"),longitude:En("number")};class Ns{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ns._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(tm(e,Ns._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ns(e.vectorValues);throw new Te(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ns._jsonSchemaVersion="firestore/vectorValue/1.0",Ns._jsonSchema={type:En("string",Ns._jsonSchemaVersion),vectorValues:En("object")};const Mz=/^__.*__$/;class kz{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Fo(e,this.data,this.fieldMask,t,this.fieldTransforms):new td(e,this.data,t,this.fieldTransforms)}}class $N{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Fo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function WN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne(40011,{Ac:n})}}class JS{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new JS({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return S_(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(WN(this.Ac)&&Mz.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Lz{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Vy(e)}Cc(e,t,i,r=!1){return new JS({Ac:e,methodName:t,Dc:i,path:Jt.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function eI(n){const e=n._freezeSettings(),t=Vy(n._databaseId);return new Lz(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Nz(n,e,t,i,r,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,r);tI("Data must be an object, but it was:",o,i);const a=HN(i,o);let c,h;if(s.merge)c=new ji(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const g of s.mergeFields){const m=Kw(e,g,t);if(!o.contains(m))throw new Te(le.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);qN(d,m)||d.push(m)}c=new ji(d),h=o.fieldTransforms.filter((g=>c.covers(g.field)))}else c=null,h=o.fieldTransforms;return new kz(new ui(a),c,h)}class Uy extends ZS{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Uy}}function Oz(n,e,t,i){const r=n.Cc(1,e,t);tI("Data must be an object, but it was:",r,i);const s=[],o=ui.empty();cl(i,((c,h)=>{const d=nI(e,c,t);h=jn(h);const g=r.yc(d);if(h instanceof Uy)s.push(d);else{const m=um(h,g);m!=null&&(s.push(d),o.set(d,m))}}));const a=new ji(s);return new $N(o,a,r.fieldTransforms)}function Dz(n,e,t,i,r,s){const o=n.Cc(1,e,t),a=[Kw(e,i,t)],c=[r];if(s.length%2!=0)throw new Te(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(Kw(e,s[m])),c.push(s[m+1]);const h=[],d=ui.empty();for(let m=a.length-1;m>=0;--m)if(!qN(h,a[m])){const y=a[m];let w=c[m];w=jn(w);const I=o.yc(y);if(w instanceof Uy)h.push(y);else{const E=um(w,I);E!=null&&(h.push(y),d.set(y,E))}}const g=new ji(h);return new $N(d,g,o.fieldTransforms)}function Vz(n,e,t,i=!1){return um(t,n.Cc(i?4:3,e))}function um(n,e){if(KN(n=jn(n)))return tI("Unsupported field value:",e,n),HN(n,e);if(n instanceof ZS)return(function(i,r){if(!WN(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let c=um(a,r.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=jn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return _U(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=Pt.fromDate(i);return{timestampValue:Hh(r.serializer,s)}}if(i instanceof Pt){const s=new Pt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Hh(r.serializer,s)}}if(i instanceof Ls)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Rr)return{bytesValue:HL(r.serializer,i._byteString)};if(i instanceof An){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:OS(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ns)return(function(o,a){return{mapValue:{fields:{[RS]:{stringValue:AS},[Gh]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return bS(a.serializer,h)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${wy(i)}`)})(n,e)}function HN(n,e){const t={};return dL(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cl(n,((i,r)=>{const s=um(r,e.mc(i));s!=null&&(t[i]=s)})),{mapValue:{fields:t}}}function KN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pt||n instanceof Ls||n instanceof Rr||n instanceof An||n instanceof ZS||n instanceof Ns)}function tI(n,e,t){if(!KN(t)||!Q4(t)){const i=wy(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function Kw(n,e,t){if((e=jn(e))instanceof Gy)return e._internalPath;if(typeof e=="string")return nI(n,e);throw S_("Field path arguments must be of type string or ",n,!1,void 0,t)}const Fz=new RegExp("[~\\*/\\[\\]]");function nI(n,e,t){if(e.search(Fz)>=0)throw S_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gy(...e.split("."))._internalPath}catch{throw S_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function S_(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Te(le.INVALID_ARGUMENT,a+n+c)}function qN(n,e){return n.some((t=>t.isEqual(e)))}class YN{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new An(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(iI("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class jz extends YN{data(){return super.data()}}function iI(n,e){return typeof e=="string"?nI(n,e):e instanceof Gy?e._internalPath:e._delegate._internalPath}function Gz(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Te(le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rI{}class Uz extends rI{}function Bz(n,e,...t){let i=[];e instanceof rI&&i.push(e),i=i.concat(t),(function(s){const o=s.filter((c=>c instanceof sI)).length,a=s.filter((c=>c instanceof By)).length;if(o>1||o>0&&a>0)throw new Te(le.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class By extends Uz{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new By(e,t,i)}_apply(e){const t=this._parse(e);return XN(e._query,t),new id(e.firestore,e.converter,Lw(e._query,t))}_parse(e){const t=eI(e.firestore);return(function(s,o,a,c,h,d,g){let m;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Te(le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){EC(g,d);const w=[];for(const I of g)w.push(vC(c,s,I));m={arrayValue:{values:w}}}else m=vC(c,s,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||EC(g,d),m=Vz(a,o,g,d==="in"||d==="not-in");return lt.create(h,d,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function zz(n,e,t){const i=e,r=iI("where",n);return By._create(r,i,t)}class sI extends rI{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new sI(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Ct.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const c of a)XN(o,c),o=Lw(o,c)})(e._query,t),new id(e.firestore,e.converter,Lw(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function vC(n,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new Te(le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!CL(e)&&t.indexOf("/")!==-1)throw new Te(le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Et.fromString(t));if(!Re.isDocumentKey(i))throw new Te(le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Eg(n,new Re(i))}if(t instanceof An)return Eg(n,t._key);throw new Te(le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wy(t)}.`)}function EC(n,e){if(!Array.isArray(n)||n.length===0)throw new Te(le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XN(n,e){const t=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Te(le.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(le.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class $z{convertValue(e,t="none"){switch(Za(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ko(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ne(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return cl(e,((r,s)=>{i[r]=this.convertValue(s,t)})),i}convertVectorValue(e){const t=e.fields?.[Gh].arrayValue?.values?.map((i=>Kt(i.doubleValue)));return new Ns(t)}convertGeoPoint(e){return new Ls(Kt(e.latitude),Kt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Ay(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(yg(e));default:return null}}convertTimestamp(e){const t=Mo(e);return new Pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Et.fromString(e);je(nN(i),9688,{name:e});const r=new Ac(i.get(1),i.get(3)),s=new Re(i.popFirst(5));return r.isEqual(t)||wi(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Wz(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Xp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vh extends YN{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new w0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(iI("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=vh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}vh._jsonSchemaVersion="firestore/documentSnapshot/1.0",vh._jsonSchema={type:En("string",vh._jsonSchemaVersion),bundleSource:En("string","DocumentSnapshot"),bundleName:En("string"),bundle:En("string")};class w0 extends vh{data(e={}){return super.data(e)}}class Eh{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Xp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new w0(this._firestore,this._userDataWriter,i.key,i,new Xp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const c=new w0(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Xp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const c=new w0(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Xp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:Hz(a.type),doc:c,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Eh._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=yS.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Hz(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne(61501,{type:n})}}Eh._jsonSchemaVersion="firestore/querySnapshot/1.0",Eh._jsonSchema={type:En("string",Eh._jsonSchemaVersion),bundleSource:En("string","QuerySnapshot"),bundleName:En("string"),bundle:En("string")};class Kz extends $z{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new An(this.firestore,null,t)}}function qz(n){n=Qa(n,id);const e=Qa(n.firestore,rd),t=BN(e),i=new Kz(e);return Gz(n._query),Rz(t,n._query).then((r=>new Eh(e,i,n,r)))}function Yz(n,e,t,...i){n=Qa(n,An);const r=Qa(n.firestore,rd),s=eI(r);let o;return o=typeof(e=jn(e))=="string"||e instanceof Gy?Dz(s,"updateDoc",n._key,e,t,i):Oz(s,"updateDoc",n._key,e),oI(r,[o.toMutation(n._key,xi.exists(!0))])}function Xz(n){return oI(Qa(n.firestore,rd),[new ky(n._key,xi.none())])}function Qz(n,e){const t=Qa(n.firestore,rd),i=Hw(n),r=Wz(n.converter,e);return oI(t,[Nz(eI(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,xi.exists(!1))]).then((()=>i))}function oI(n,e){return(function(i,r){const s=new Ao;return i.asyncQueue.enqueueAndForget((async()=>dz(await Iz(i),r,s))),s.promise})(BN(n),e)}(function(e,t=!0){(function(r){ed=r})($c),Ic(new Xa("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new rd(new c7(i.getProvider("auth-internal")),new d7(o,i.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Te(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ac(h.options.projectId,d)})(o,r),o);return s={useFetchStreams:t,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),ks(JA,eP,e),ks(JA,eP,"esm2020")})();var Zz="firebase",Jz="12.7.0";ks(Zz,Jz,"app");function QN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const e$=QN,ZN=new Jg("auth","Firebase",QN());const I_=new gS("@firebase/auth");function t$(n,...e){I_.logLevel<=at.WARN&&I_.warn(`Auth (${$c}): ${n}`,...e)}function x0(n,...e){I_.logLevel<=at.ERROR&&I_.error(`Auth (${$c}): ${n}`,...e)}function Lo(n,...e){throw aI(n,...e)}function Os(n,...e){return aI(n,...e)}function JN(n,e,t){const i={...e$(),[e]:t};return new Jg("auth","Firebase",i).create(e,{appName:n.name})}function $a(n){return JN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function aI(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ZN.create(n,...e)}function Ye(n,e,...t){if(!n)throw aI(e,...t)}function Eo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw x0(e),new Error(e)}function No(n,e){n||Eo(e)}function qw(){return typeof self<"u"&&self.location?.href||""}function n$(){return wC()==="http:"||wC()==="https:"}function wC(){return typeof self<"u"&&self.location?.protocol||null}function i$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(n$()||Bj()||"connection"in navigator)?navigator.onLine:!0}function r$(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class hm{constructor(e,t){this.shortDelay=e,this.longDelay=t,No(t>e,"Short delay should be less than long delay!"),this.isMobile=Gj()||zj()}get(){return i$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function lI(n,e){No(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class eO{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Eo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Eo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Eo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const s$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const o$=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],a$=new hm(3e4,6e4);function zy(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function sd(n,e,t,i,r={}){return tO(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=em({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:c,...s};return Uj()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&zc(n.emulatorConfig.host)&&(h.credentials="include"),eO.fetch()(await iO(n,n.config.apiHost,t,a),h)})}async function tO(n,e,t){n._canInitEmulator=!1;const i={...s$,...e};try{const r=new l$(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Qp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Qp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Qp(n,"user-disabled",o);const d=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw JN(n,d,h);Lo(n,d)}}catch(r){if(r instanceof qs)throw r;Lo(n,"network-request-failed",{message:String(r)})}}async function nO(n,e,t,i,r={}){const s=await sd(n,e,t,i,r);return"mfaPendingCredential"in s&&Lo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function iO(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?lI(n.config,r):`${n.config.apiScheme}://${r}`;return o$.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class l${clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Os(this.auth,"network-request-failed")),a$.get())})}}function Qp(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Os(n,e,i);return r.customData._tokenResponse=t,r}async function c$(n,e){return sd(n,"POST","/v1/accounts:delete",e)}async function T_(n,e){return sd(n,"POST","/v1/accounts:lookup",e)}function jf(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function u$(n,e=!1){const t=jn(n),i=await t.getIdToken(e),r=cI(i);Ye(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:jf(wE(r.auth_time)),issuedAtTime:jf(wE(r.iat)),expirationTime:jf(wE(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function wE(n){return Number(n)*1e3}function cI(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return x0("JWT malformed, contained fewer than 3 sections"),null;try{const r=T4(t);return r?JSON.parse(r):(x0("Failed to decode base64 JWT payload"),null)}catch(r){return x0("Caught error parsing JWT payload as JSON",r?.toString()),null}}function xC(n){const e=cI(n);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Tg(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof qs&&h$(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function h$({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class d${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Yw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jf(this.lastLoginAt),this.creationTime=jf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function R_(n){const e=n.auth,t=await n.getIdToken(),i=await Tg(n,T_(e,{idToken:t}));Ye(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?rO(r.providerUserInfo):[],o=g$(n.providerData,s),a=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!o?.length,h=a?c:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Yw(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function f$(n){const e=jn(n);await R_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function g$(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function rO(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function m$(n,e){const t=await tO(n,{},async()=>{const i=em({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await iO(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return n.emulatorConfig&&zc(n.emulatorConfig.host)&&(c.credentials="include"),eO.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function p$(n,e){return sd(n,"POST","/v2/accounts:revokeToken",zy(n,e))}class wh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const t=xC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await m$(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new wh;return i&&(Ye(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Ye(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Ye(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wh,this.toJSON())}_performRefresh(){return Eo("not implemented")}}function ya(n,e){Ye(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Xr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new d$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Yw(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Tg(this,this.stsTokenManager.getToken(this.auth,e));return Ye(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return u$(this,e)}reload(){return f$(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await R_(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Tr(this.auth.app))return Promise.reject($a(this.auth));const e=await this.getIdToken();return await Tg(this,c$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,c=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:y,providerData:w,stsTokenManager:I}=t;Ye(g&&I,e,"internal-error");const E=wh.fromJSON(this.name,I);Ye(typeof g=="string",e,"internal-error"),ya(i,e.name),ya(r,e.name),Ye(typeof m=="boolean",e,"internal-error"),Ye(typeof y=="boolean",e,"internal-error"),ya(s,e.name),ya(o,e.name),ya(a,e.name),ya(c,e.name),ya(h,e.name),ya(d,e.name);const A=new Xr({uid:g,auth:e,email:r,emailVerified:m,displayName:i,isAnonymous:y,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:E,createdAt:h,lastLoginAt:d});return w&&Array.isArray(w)&&(A.providerData=w.map(b=>({...b}))),c&&(A._redirectEventId=c),A}static async _fromIdTokenResponse(e,t,i=!1){const r=new wh;r.updateFromServerResponse(t);const s=new Xr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await R_(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Ye(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?rO(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new wh;a.updateFromIdToken(i);const c=new Xr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Yw(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(c,h),c}}const SC=new Map;function wo(n){No(n instanceof Function,"Expected a class definition");let e=SC.get(n);return e?(No(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,SC.set(n,e),e)}class sO{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}sO.type="NONE";const IC=sO;function S0(n,e,t){return`firebase:${n}:${e}:${t}`}class xh{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=S0(this.userKey,r.apiKey,s),this.fullPersistenceKey=S0("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await T_(this.auth,{idToken:e}).catch(()=>{});return t?Xr._fromGetAccountInfoResponse(this.auth,t,e):null}return Xr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new xh(wo(IC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||wo(IC);const o=S0(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const m=await T_(e,{idToken:d}).catch(()=>{});if(!m)break;g=await Xr._fromGetAccountInfoResponse(e,m,d)}else g=Xr._fromJSON(e,d);h!==s&&(a=g),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new xh(s,e,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new xh(s,e,i))}}function TC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(oO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hO(e))return"Blackberry";if(dO(e))return"Webos";if(aO(e))return"Safari";if((e.includes("chrome/")||lO(e))&&!e.includes("edge/"))return"Chrome";if(uO(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function oO(n=Cn()){return/firefox\//i.test(n)}function aO(n=Cn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lO(n=Cn()){return/crios\//i.test(n)}function cO(n=Cn()){return/iemobile/i.test(n)}function uO(n=Cn()){return/android/i.test(n)}function hO(n=Cn()){return/blackberry/i.test(n)}function dO(n=Cn()){return/webos/i.test(n)}function uI(n=Cn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function _$(n=Cn()){return uI(n)&&!!window.navigator?.standalone}function y$(){return $j()&&document.documentMode===10}function fO(n=Cn()){return uI(n)||uO(n)||dO(n)||hO(n)||/windows phone/i.test(n)||cO(n)}function gO(n,e=[]){let t;switch(n){case"Browser":t=TC(Cn());break;case"Worker":t=`${TC(Cn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$c}/${i}`}class v${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function E$(n,e={}){return sd(n,"GET","/v2/passwordPolicy",zy(n,e))}const w$=6;class x${constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??w$,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class S${constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new RC(this),this.idTokenSubscription=new RC(this),this.beforeStateQueue=new v$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ZN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wo(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await xh.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await T_(this,{idToken:e}),i=await Xr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Tr(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await R_(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=r$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Tr(this.app))return Promise.reject($a(this));const t=e?jn(e):null;return t&&Ye(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Tr(this.app)?Promise.reject($a(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Tr(this.app)?Promise.reject($a(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await E$(this),t=new x$(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jg("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await p$(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&wo(e)||this._popupRedirectResolver;Ye(t,this,"argument-error"),this.redirectPersistenceManager=await xh.create(this,[wo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gO(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&t$(`Error while retrieving App Check token: ${e.error}`),e?.token}}function $y(n){return jn(n)}class RC{constructor(e){this.auth=e,this.observer=null,this.addObserver=Xj(t=>this.observer=t)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function I$(n){hI=n}function T$(n){return hI.loadJS(n)}function R$(){return hI.gapiScript}function A$(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function P$(n,e){const t=Ey(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(Sc(s,e??{}))return r;Lo(r,"already-initialized")}return t.initialize({options:e})}function C$(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(wo);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function b$(n,e,t){const i=$y(n);Ye(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=mO(e),{host:o,port:a}=M$(e),c=a===null?"":`:${a}`,h={url:`${s}//${o}${c}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Ye(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ye(Sc(h,i.config.emulator)&&Sc(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,zc(o)?(dS(`${s}//${o}${c}`),fS("Auth",!0)):k$()}function mO(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function M$(n){const e=mO(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:AC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:AC(o)}}}function AC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function k$(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class pO{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Eo("not implemented")}_getIdTokenResponse(e){return Eo("not implemented")}_linkToIdToken(e,t){return Eo("not implemented")}_getReauthenticationResolver(e){return Eo("not implemented")}}async function Sh(n,e){return nO(n,"POST","/v1/accounts:signInWithIdp",zy(n,e))}const L$="http://localhost";class Lc extends pO{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Lc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Lo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Lc(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Sh(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Sh(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Sh(e,t)}buildRequest(){const e={requestUri:L$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=em(t)}return e}}class _O{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class dm extends _O{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ia extends dm{constructor(){super("facebook.com")}static credential(e){return Lc._fromParams({providerId:Ia.PROVIDER_ID,signInMethod:Ia.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ia.credentialFromTaggedObject(e)}static credentialFromError(e){return Ia.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ia.credential(e.oauthAccessToken)}catch{return null}}}Ia.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ia.PROVIDER_ID="facebook.com";class Ta extends dm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Lc._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ta.credential(t,i)}catch{return null}}}Ta.GOOGLE_SIGN_IN_METHOD="google.com";Ta.PROVIDER_ID="google.com";class Ra extends dm{constructor(){super("github.com")}static credential(e){return Lc._fromParams({providerId:Ra.PROVIDER_ID,signInMethod:Ra.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ra.credentialFromTaggedObject(e)}static credentialFromError(e){return Ra.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ra.credential(e.oauthAccessToken)}catch{return null}}}Ra.GITHUB_SIGN_IN_METHOD="github.com";Ra.PROVIDER_ID="github.com";class Aa extends dm{constructor(){super("twitter.com")}static credential(e,t){return Lc._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Aa.credential(t,i)}catch{return null}}}Aa.TWITTER_SIGN_IN_METHOD="twitter.com";Aa.PROVIDER_ID="twitter.com";async function N$(n,e){return nO(n,"POST","/v1/accounts:signUp",zy(n,e))}class nl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Xr._fromIdTokenResponse(e,i,r),o=PC(i);return new nl({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=PC(i);return new nl({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function PC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function O$(n){if(Tr(n.app))return Promise.reject($a(n));const e=$y(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new nl({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await N$(e,{returnSecureToken:!0}),i=await nl._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(i.user),i}class A_ extends qs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,A_.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new A_(e,t,i,r)}}function yO(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?A_._fromErrorAndOperation(n,s,e,i):s})}async function D$(n,e,t=!1){const i=await Tg(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return nl._forOperation(n,"link",i)}async function V$(n,e,t=!1){const{auth:i}=n;if(Tr(i.app))return Promise.reject($a(i));const r="reauthenticate";try{const s=await Tg(n,yO(i,r,e,n),t);Ye(s.idToken,i,"internal-error");const o=cI(s.idToken);Ye(o,i,"internal-error");const{sub:a}=o;return Ye(n.uid===a,i,"user-mismatch"),nl._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&Lo(i,"user-mismatch"),s}}async function F$(n,e,t=!1){if(Tr(n.app))return Promise.reject($a(n));const i="signIn",r=await yO(n,i,e),s=await nl._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function j$(n,e,t,i){return jn(n).onIdTokenChanged(e,t,i)}function G$(n,e,t){return jn(n).beforeAuthStateChanged(e,t)}function U$(n,e,t,i){return jn(n).onAuthStateChanged(e,t,i)}function B$(n){return jn(n).signOut()}const P_="__sak";class vO{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(P_,"1"),this.storage.removeItem(P_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const z$=1e3,$$=10;class EO extends vO{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fO(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);y$()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,$$):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},z$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}EO.type="LOCAL";const W$=EO;class wO extends vO{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}wO.type="SESSION";const xO=wO;function H$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Wy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Wy(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),c=await H$(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wy.receivers=[];function dI(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class K${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const h=dI("",20);r.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ds(){return window}function q$(n){Ds().location.href=n}function SO(){return typeof Ds().WorkerGlobalScope<"u"&&typeof Ds().importScripts=="function"}async function Y$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function X$(){return navigator?.serviceWorker?.controller||null}function Q$(){return SO()?self:null}const IO="firebaseLocalStorageDb",Z$=1,C_="firebaseLocalStorage",TO="fbase_key";class fm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Hy(n,e){return n.transaction([C_],e?"readwrite":"readonly").objectStore(C_)}function J$(){const n=indexedDB.deleteDatabase(IO);return new fm(n).toPromise()}function Xw(){const n=indexedDB.open(IO,Z$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(C_,{keyPath:TO})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(C_)?e(i):(i.close(),await J$(),e(await Xw()))})})}async function CC(n,e,t){const i=Hy(n,!0).put({[TO]:e,value:t});return new fm(i).toPromise()}async function eW(n,e){const t=Hy(n,!1).get(e),i=await new fm(t).toPromise();return i===void 0?null:i.value}function bC(n,e){const t=Hy(n,!0).delete(e);return new fm(t).toPromise()}const tW=800,nW=3;class RO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>nW)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wy._getInstance(Q$()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Y$(),!this.activeServiceWorker)return;this.sender=new K$(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||X$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xw();return await CC(e,P_,"1"),await bC(e,P_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>CC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>eW(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>bC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Hy(r,!1).getAll();return new fm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}RO.type="LOCAL";const iW=RO;new hm(3e4,6e4);function rW(n,e){return e?wo(e):(Ye(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class fI extends pO{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Sh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Sh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Sh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function sW(n){return F$(n.auth,new fI(n),n.bypassAuthState)}function oW(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),V$(t,new fI(n),n.bypassAuthState)}async function aW(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),D$(t,new fI(n),n.bypassAuthState)}class AO{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sW;case"linkViaPopup":case"linkViaRedirect":return aW;case"reauthViaPopup":case"reauthViaRedirect":return oW;default:Lo(this.auth,"internal-error")}}resolve(e){No(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){No(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const lW=new hm(2e3,1e4);class sh extends AO{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,sh.currentPopupAction&&sh.currentPopupAction.cancel(),sh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){No(this.filter.length===1,"Popup operations only handle one event");const e=dI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Os(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Os(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,sh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Os(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,lW.get())};e()}}sh.currentPopupAction=null;const cW="pendingRedirect",I0=new Map;class uW extends AO{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=I0.get(this.auth._key());if(!e){try{const i=await hW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}I0.set(this.auth._key(),e)}return this.bypassAuthState||I0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function hW(n,e){const t=gW(e),i=fW(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function dW(n,e){I0.set(n._key(),e)}function fW(n){return wo(n._redirectPersistence)}function gW(n){return S0(cW,n.config.apiKey,n.name)}async function mW(n,e,t=!1){if(Tr(n.app))return Promise.reject($a(n));const i=$y(n),r=rW(i,e),o=await new uW(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const pW=600*1e3;class _W{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yW(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!PO(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Os(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pW&&this.cachedEventUids.clear(),this.cachedEventUids.has(MC(e))}saveEventToCache(e){this.cachedEventUids.add(MC(e)),this.lastProcessedEventTime=Date.now()}}function MC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function PO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function yW(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PO(n);default:return!1}}async function vW(n,e={}){return sd(n,"GET","/v1/projects",e)}const EW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wW=/^https?/;async function xW(n){if(n.config.emulator)return;const{authorizedDomains:e}=await vW(n);for(const t of e)try{if(SW(t))return}catch{}Lo(n,"unauthorized-domain")}function SW(n){const e=qw(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!wW.test(t))return!1;if(EW.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const IW=new hm(3e4,6e4);function kC(){const n=Ds().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function TW(n){return new Promise((e,t)=>{function i(){kC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{kC(),t(Os(n,"network-request-failed"))},timeout:IW.get()})}if(Ds().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ds().gapi?.load)i();else{const r=A$("iframefcb");return Ds()[r]=()=>{gapi.load?i():t(Os(n,"network-request-failed"))},T$(`${R$()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw T0=null,e})}let T0=null;function RW(n){return T0=T0||TW(n),T0}const AW=new hm(5e3,15e3),PW="__/auth/iframe",CW="emulator/auth/iframe",bW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},MW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kW(n){const e=n.config;Ye(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?lI(e,CW):`https://${n.config.authDomain}/${PW}`,i={apiKey:e.apiKey,appName:n.name,v:$c},r=MW.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${em(i).slice(1)}`}async function LW(n){const e=await RW(n),t=Ds().gapi;return Ye(t,n,"internal-error"),e.open({where:document.body,url:kW(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bW,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Os(n,"network-request-failed"),a=Ds().setTimeout(()=>{s(o)},AW.get());function c(){Ds().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}const NW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OW=500,DW=600,VW="_blank",FW="http://localhost";class LC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jW(n,e,t,i=OW,r=DW){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...NW,width:i.toString(),height:r.toString(),top:s,left:o},h=Cn().toLowerCase();t&&(a=lO(h)?VW:t),oO(h)&&(e=e||FW,c.scrollbars="yes");const d=Object.entries(c).reduce((m,[y,w])=>`${m}${y}=${w},`,"");if(_$(h)&&a!=="_self")return GW(e||"",a),new LC(null);const g=window.open(e||"",a,d);Ye(g,n,"popup-blocked");try{g.focus()}catch{}return new LC(g)}function GW(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const UW="__/auth/handler",BW="emulator/auth/handler",zW=encodeURIComponent("fac");async function NC(n,e,t,i,r,s){Ye(n.config.authDomain,n,"auth-domain-config-required"),Ye(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:$c,eventId:r};if(e instanceof _O){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Yj(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof dm){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const c=await n._getAppCheckToken(),h=c?`#${zW}=${encodeURIComponent(c)}`:"";return`${$W(n)}?${em(a).slice(1)}${h}`}function $W({config:n}){return n.emulator?lI(n,BW):`https://${n.authDomain}/${UW}`}const xE="webStorageSupport";class WW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xO,this._completeRedirectFn=mW,this._overrideRedirectResult=dW}async _openPopup(e,t,i,r){No(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await NC(e,t,i,qw(),r);return jW(e,s,dI())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await NC(e,t,i,qw(),r);return q$(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(No(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await LW(e),i=new _W(e);return t.register("authEvent",r=>(Ye(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(xE,{type:xE},r=>{const s=r?.[0]?.[xE];s!==void 0&&t(!!s),Lo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=xW(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return fO()||aO()||uI()}}const HW=WW;var OC="@firebase/auth",DC="1.12.0";class KW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function qW(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function YW(n){Ic(new Xa("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Ye(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gO(n)},h=new S$(i,r,s,c);return C$(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ic(new Xa("auth-internal",e=>{const t=$y(e.getProvider("auth").getImmediate());return(i=>new KW(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ks(OC,DC,qW(n)),ks(OC,DC,"esm2020")}const XW=300,QW=b4("authIdTokenMaxAge")||XW;let VC=null;const ZW=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>QW)return;const r=t?.token;VC!==r&&(VC=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function JW(n=pS()){const e=Ey(n,"auth");if(e.isInitialized())return e.getImmediate();const t=P$(n,{popupRedirectResolver:HW,persistence:[iW,W$,xO]}),i=b4("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=ZW(s.toString());G$(t,o,()=>o(t.currentUser)),j$(t,a=>o(a))}}const r=A4("auth");return r&&b$(t,`http://${r}`),t}function eH(){return document.getElementsByTagName("head")?.[0]??document}I$({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Os("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",eH().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});YW("Browser");const CO="firebasestorage.googleapis.com",tH="storageBucket",nH=120*1e3,iH=600*1e3;class Ys extends qs{constructor(e,t,i=0){super(SE(e),`Firebase Storage: ${t} (${SE(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ys.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return SE(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Bs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Bs||(Bs={}));function SE(n){return"storage/"+n}function rH(){const n="An unknown error occurred, please check the error payload for server response.";return new Ys(Bs.UNKNOWN,n)}function sH(){return new Ys(Bs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function oH(){return new Ys(Bs.CANCELED,"User canceled the upload/download.")}function aH(n){return new Ys(Bs.INVALID_URL,"Invalid URL '"+n+"'.")}function lH(n){return new Ys(Bs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function FC(n){return new Ys(Bs.INVALID_ARGUMENT,n)}function bO(){return new Ys(Bs.APP_DELETED,"The Firebase app was deleted.")}function cH(n){return new Ys(Bs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Qr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Qr.makeFromUrl(e,t)}catch{return new Qr(e,"")}if(i.path==="")return i;throw lH(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(D){D.path_=decodeURIComponent(D.path)}const d="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${g}/${d}/b/${r}/o${m}`,"i"),w={bucket:1,path:3},I=t===CO?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",A=new RegExp(`^https?://${I}/${r}/${E}`,"i"),N=[{regex:a,indices:c,postModify:s},{regex:y,indices:w,postModify:h},{regex:A,indices:{bucket:1,path:2},postModify:h}];for(let D=0;D<N.length;D++){const O=N[D],$=O.regex.exec(e);if($){const k=$[O.indices.bucket];let C=$[O.indices.path];C||(C=""),i=new Qr(k,C),O.postModify(i);break}}if(i==null)throw aH(e);return i}}class uH{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function hH(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let h=!1;function d(...E){h||(h=!0,e.apply(null,E))}function g(E){r=setTimeout(()=>{r=null,n(y,c())},E)}function m(){s&&clearTimeout(s)}function y(E,...A){if(h){m();return}if(E){m(),d.call(null,E,...A);return}if(c()||o){m(),d.call(null,E,...A);return}i<64&&(i*=2);let N;a===1?(a=2,N=0):N=(i+Math.random())*1e3,g(N)}let w=!1;function I(E){w||(w=!0,m(),!h&&(r!==null?(E||(a=2),clearTimeout(r),g(0)):E||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function dH(n){n(!1)}function fH(n){return n!==void 0}function jC(n,e,t,i){if(i<e)throw FC(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw FC(`Invalid value for '${n}'. Expected ${t} or less.`)}function gH(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var b_;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(b_||(b_={}));function mH(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class pH{constructor(e,t,i,r,s,o,a,c,h,d,g,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,I)=>{this.resolve_=w,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Zp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===b_.NO_ERROR,c=s.getStatus();if(!a||mH(c,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===b_.ABORT;i(!1,new Zp(!1,null,d));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new Zp(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());fH(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=rH();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?bO():oH();o(c)}else{const c=sH();o(c)}};this.canceled_?t(!1,new Zp(!1,null,!0)):this.backoffId_=hH(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dH(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Zp{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function _H(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function yH(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vH(n,e){e&&(n["X-Firebase-GMPID"]=e)}function EH(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function wH(n,e,t,i,r,s,o=!0,a=!1){const c=gH(n.urlParams),h=n.url+c,d=Object.assign({},n.headers);return vH(d,e),_H(d,t),yH(d,s),EH(d,i),new pH(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}function xH(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function SH(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class M_{constructor(e,t){this._service=e,t instanceof Qr?this._location=t:this._location=Qr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new M_(e,t)}get root(){const e=new Qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return SH(this._location.path)}get storage(){return this._service}get parent(){const e=xH(this._location.path);if(e===null)return null;const t=new Qr(this._location.bucket,e);return new M_(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw cH(e)}}function GC(n,e){const t=e?.[tH];return t==null?null:Qr.makeFromBucketSpec(t,n)}function IH(n,e,t,i={}){n.host=`${e}:${t}`;const r=zc(e);r&&(dS(`https://${n.host}/b`),fS("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:M4(s,n.app.options.projectId))}class TH{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=CO,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=nH,this._maxUploadRetryTime=iH,this._requests=new Set,r!=null?this._bucket=Qr.makeFromBucketSpec(r,this._host):this._bucket=GC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qr.makeFromBucketSpec(this._url,e):this._bucket=GC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new M_(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new uH(bO());{const o=wH(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const UC="@firebase/storage",BC="0.14.0";const MO="storage";function RH(n=pS(),e){n=jn(n);const i=Ey(n,MO).getImmediate({identifier:e}),r=P4("storage");return r&&AH(i,...r),i}function AH(n,e,t,i={}){IH(n,e,t,i)}function PH(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new TH(t,i,r,e,$c)}function CH(){Ic(new Xa(MO,PH,"PUBLIC").setMultipleInstances(!0)),ks(UC,BC,""),ks(UC,BC,"esm2020")}CH();const bH={apiKey:"REPLACE_WITH_YOUR_API_KEY",authDomain:"your-project.firebaseapp.com",projectId:"your-project-id",storageBucket:"your-project.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef"},gI=F4(bH),IE=JW(gI),wf=Pz(gI);RH(gI);Cz(wf).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const MH=Ks()(Bc((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(i=>{i.loading=!0});try{const i=Bz(mC(wf,"vondsten"),zz("userId","==",t)),s=(await qz(i)).docs.map(o=>({id:o.id,...o.data()}));n(o=>{o.vondsten=s,o.loading=!1})}catch(i){n(r=>{r.error=i.message,r.loading=!1})}},addVondst:async t=>{const i=new Date().toISOString(),r={...t,createdAt:i,updatedAt:i},s=await Qz(mC(wf,"vondsten"),r);return n(o=>{o.vondsten.push({...r,id:s.id})}),s.id},updateVondst:async(t,i)=>{const r=Hw(wf,"vondsten",t);await Yz(r,{...i,updatedAt:new Date().toISOString()}),n(s=>{const o=s.vondsten.findIndex(a=>a.id===t);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...i})})},deleteVondst:async t=>{await Xz(Hw(wf,"vondsten",t)),n(i=>{i.vondsten=i.vondsten.filter(r=>r.id!==t)})}}))),kH={};function LH(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=c=>c===null?null:JSON.parse(c,void 0),a=(s=t.getItem(r))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Rg=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Rg(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Rg(i)(t)}}}},NH=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,A)=>({...A,...E}),...e},o=!1;const a=new Set,c=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...E)},i,r);const d=Rg(s.serialize),g=()=>{const E=s.partialize({...i()});let A;const b=d({state:E,version:s.version}).then(N=>h.setItem(s.name,N)).catch(N=>{A=N});if(A)throw A;return b},m=r.setState;r.setState=(E,A)=>{m(E,A),g()};const y=n((...E)=>{t(...E),g()},i,r);let w;const I=()=>{var E;if(!h)return;o=!1,a.forEach(b=>b(i()));const A=((E=s.onRehydrateStorage)==null?void 0:E.call(s,i()))||void 0;return Rg(h.getItem.bind(h))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var N;return w=s.merge(b,(N=i())!=null?N:y),t(w,!0),g()}).then(()=>{A?.(w,void 0),o=!0,c.forEach(b=>b(w))}).catch(b=>{A?.(void 0,b)})};return r.persist={setOptions:E=>{s={...s,...E},E.getStorage&&(h=E.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:E=>(a.add(E),()=>{a.delete(E)}),onFinishHydration:E=>(c.add(E),()=>{c.delete(E)})},I(),w||y},OH=(n,e)=>(t,i,r)=>{let s={storage:LH(()=>localStorage),partialize:I=>I,version:0,merge:(I,E)=>({...E,...I}),...e},o=!1;const a=new Set,c=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const d=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},g=r.setState;r.setState=(I,E)=>{g(I,E),d()};const m=n((...I)=>{t(...I),d()},i,r);r.getInitialState=()=>m;let y;const w=()=>{var I,E;if(!h)return;o=!1,a.forEach(b=>{var N;return b((N=i())!=null?N:m)});const A=((E=s.onRehydrateStorage)==null?void 0:E.call(s,(I=i())!=null?I:m))||void 0;return Rg(h.getItem.bind(h))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var N;const[D,O]=b;if(y=s.merge(O,(N=i())!=null?N:m),t(y,!0),D)return d()}).then(()=>{A?.(y,void 0),y=i(),o=!0,c.forEach(b=>b(y))}).catch(b=>{A?.(void 0,b)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:I=>(a.add(I),()=>{a.delete(I)}),onFinishHydration:I=>(c.add(I),()=>{c.delete(I)})},s.skipHydration||w(),y||m},DH=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((kH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),NH(n,e)):OH(n,e),mI=DH,zs=Ks()(mI(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,headingUpMode:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,fontSize:"small",setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setHeadingUpMode:e=>n({headingUpMode:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setFontSize:e=>n({fontSize:e})}),{name:"detectorapp-settings"})),zC=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AHN4 Multi-Hillshade NL","AHN 0.5m","Geomorfologie","AMK Monumenten"],isBuiltIn:!0},{id:"uiterwaarden",name:"Uiterwaarden",icon:"Waves",layers:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],isBuiltIn:!1},{id:"recreatie",name:"Recreatie",icon:"TreePalm",layers:["Parken","Speeltuinen","Strandjes"],isBuiltIn:!1},{id:"hillshade",name:"Hillshade",icon:"Mountain",layers:["AHN 0.5m","Geomorfologie","AHN4 Multi-Hillshade NL"],isBuiltIn:!1},{id:"analyse",name:"Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AMK Monumenten"],isBuiltIn:!1},{id:"woii",name:"WOII",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten"],isBuiltIn:!1},{id:"percelen",name:"Percelen",icon:"Grid",layers:["Gewaspercelen","Kadastrale Grenzen","AMK Monumenten"],isBuiltIn:!1}],$C=["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","Romeinse wegen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","Religieus Erfgoed","UIKAV Punten","UIKAV Vlakken","UIKAV Buffer","UIKAV Expert","UIKAV Indeling","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","World Hillshade","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],kO=Ks()(mI((n,e)=>({presets:[...zC].map(t=>({...t,isBuiltIn:t.id==="detectie"})),applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Jn.getState();$C.forEach(s=>r.setLayerVisibility(s,!1)),i.layers.forEach(s=>r.setLayerVisibility(s,!0)),console.log(` Preset toegepast: ${i.name}`)},createPreset:(t,i)=>{const r=Jn.getState(),s=Object.entries(r.visible).filter(([a,c])=>c&&$C.includes(a)).map(([a])=>a),o={id:`custom-${Date.now()}`,name:t,icon:i,layers:s,isBuiltIn:!1};n(a=>({presets:[...a.presets,o]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t&&!s.isBuiltIn?{...s,...i}:s)}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...zC]})}}),{name:"detectorapp-presets",version:2,migrate:(n,e)=>{const t=n;return e<2?{...t,presets:t.presets.map(i=>({...i,isBuiltIn:i.id==="detectie"}))}:t}}));function VH({target:n,viewOptions:e}){const t=oe.useRef(null),i=oe.useRef(null),r=di(o=>o.setMap),s=zs(o=>o.showScaleBar);return oe.useEffect(()=>{if(!t.current){const o={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},a=new J9({target:n,controls:[],view:new Rs({center:Ka(o.center),zoom:o.zoom,rotation:o.rotation,minZoom:o.minZoom,maxZoom:o.maxZoom})});t.current=a,r(a),window.__olMap=a}return()=>{t.current&&(t.current.setTarget(void 0),r(null),window.__olMap=null)}},[n,e,r]),oe.useEffect(()=>{const o=t.current;o&&(s?i.current||(i.current=new nj({units:"metric",bar:!1,text:!0,minWidth:80}),o.addControl(i.current)):i.current&&(o.removeControl(i.current),i.current=null))},[s]),t.current}const WC=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function FH(){const n=oe.useRef(null),e=oe.useRef(!1);VH({target:"map"});const t=di(g=>g.map),i=Jn(g=>g.registerLayer),r=Jn(g=>g.setLayerVisibility),s=zs(g=>g.defaultBackground);oe.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const g=new Bl({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new y9}),m=new Bl({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Yu({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new Bl({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Yu({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:" Esri, Maxar, Earthstar Geographics",maxZoom:19})}),w=new Bl({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Yu({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),I=new Bl({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Yu({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),E=new Bl({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Yu({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(g),t.addLayer(m),t.addLayer(y),t.addLayer(w),t.addLayer(I),t.addLayer(E),console.log(" Base layers added:",{osm:g.getVisible(),cartodb:m.getVisible(),satellite:y.getVisible()}),i("OpenStreetMap",g),i("CartoDB (licht)",m),i("Luchtfoto",y),i("Labels Overlay",w),i("TMK 1850",I),i("Bonnebladen 1900",E),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),o()},[t,i]);async function o(){if(!t){console.error(" Cannot load layers: map is null");return}const g=Cj();console.log(` Loading ${g.length} immediate-load layers (WMS/Tile)...`);const m=await Promise.allSettled(g.map(async w=>{try{const I=await w.factory();return I?{name:w.name,layer:I}:null}catch(I){return console.warn(` Failed to create ${w.name}:`,I),null}}));let y=0;m.forEach(w=>{if(w.status==="fulfilled"&&w.value){const{name:I,layer:E}=w.value;t.addLayer(E),i(I,E),y++,console.log(`   ${I}`)}}),console.log(` Immediate layers loaded: ${y}/${g.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}oe.useEffect(()=>{if(!t||e.current)return;const g=setTimeout(()=>{const m=s||"CartoDB (licht)";WC.forEach(y=>{r(y,!1)}),WC.includes(m)?r(m,!0):r("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${m}`)},100);return()=>clearTimeout(g)},[t,s,r]);const a=zs(g=>g.gpsAutoStart),c=Ht(g=>g.startTracking),h=oe.useRef(!1);oe.useEffect(()=>{if(!(!t||h.current)&&a){const g=setTimeout(()=>{c(),h.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(g)}},[t,a,c]);const d={width:"100%",height:"100vh"};return T.jsx("div",{id:"map",ref:n,style:d})}const pI=oe.createContext({});function _I(n){const e=oe.useRef(null);return e.current===null&&(e.current=n()),e.current}const Ky=oe.createContext(null),yI=oe.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class jH extends oe.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function GH({children:n,isPresent:e}){const t=oe.useId(),i=oe.useRef(null),r=oe.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=oe.useContext(yI);return oe.useInsertionEffect(()=>{const{width:o,height:a,top:c,left:h}=r.current;if(e||!i.current||!o||!a)return;i.current.dataset.motionPopId=t;const d=document.createElement("style");return s&&(d.nonce=s),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${c}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),T.jsx(jH,{isPresent:e,childRef:i,sizeRef:r,children:oe.cloneElement(n,{ref:i})})}const UH=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const a=_I(BH),c=oe.useId(),h=oe.useCallback(g=>{a.set(g,!0);for(const m of a.values())if(!m)return;i&&i()},[a,i]),d=oe.useMemo(()=>({id:c,initial:e,isPresent:t,custom:r,onExitComplete:h,register:g=>(a.set(g,!1),()=>a.delete(g))}),s?[Math.random(),h]:[t,h]);return oe.useMemo(()=>{a.forEach((g,m)=>a.set(m,!1))},[t]),oe.useEffect(()=>{!t&&!a.size&&i&&i()},[t]),o==="popLayout"&&(n=T.jsx(GH,{isPresent:t,children:n})),T.jsx(Ky.Provider,{value:d,children:n})};function BH(){return new Map}function LO(n=!0){const e=oe.useContext(Ky);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=oe.useId();oe.useEffect(()=>{n&&r(s)},[n]);const o=oe.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Jp=n=>n.key||"";function HC(n){const e=[];return oe.Children.forEach(n,t=>{oe.isValidElement(t)&&e.push(t)}),e}const vI=typeof window<"u",NO=vI?oe.useLayoutEffect:oe.useEffect,Xs=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[a,c]=LO(o),h=oe.useMemo(()=>HC(n),[n]),d=o&&!a?[]:h.map(Jp),g=oe.useRef(!0),m=oe.useRef(h),y=_I(()=>new Map),[w,I]=oe.useState(h),[E,A]=oe.useState(h);NO(()=>{g.current=!1,m.current=h;for(let D=0;D<E.length;D++){const O=Jp(E[D]);d.includes(O)?y.delete(O):y.get(O)!==!0&&y.set(O,!1)}},[E,d.length,d.join("-")]);const b=[];if(h!==w){let D=[...h];for(let O=0;O<E.length;O++){const $=E[O],k=Jp($);d.includes(k)||(D.splice(O,0,$),b.push($))}s==="wait"&&b.length&&(D=b),A(HC(D)),I(h);return}const{forceRender:N}=oe.useContext(pI);return T.jsx(T.Fragment,{children:E.map(D=>{const O=Jp(D),$=o&&!a?!1:h===E||d.includes(O),k=()=>{if(y.has(O))y.set(O,!0);else return;let C=!0;y.forEach(L=>{L||(C=!1)}),C&&(N?.(),A(m.current),o&&c?.(),i&&i())};return T.jsx(UH,{isPresent:$,initial:!g.current||t?void 0:!1,custom:$?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:$?void 0:k,children:D},O)})})},nr=n=>n;let OO=nr;function EI(n){let e;return()=>(e===void 0&&(e=n()),e)}const qh=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},Po=n=>n*1e3,Co=n=>n/1e3,zH={useManualTiming:!1};function $H(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(h){s.has(h)&&(c.schedule(h),n()),h(o)}const c={schedule:(h,d=!1,g=!1)=>{const y=g&&i?e:t;return d&&s.add(h),y.has(h)||y.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(a),e.clear(),i=!1,r&&(r=!1,c.process(h))}};return c}const e0=["read","resolveKeyframes","update","preRender","render","postRender"],WH=40;function DO(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=e0.reduce((A,b)=>(A[b]=$H(s),A),{}),{read:a,resolveKeyframes:c,update:h,preRender:d,render:g,postRender:m}=o,y=()=>{const A=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(A-r.timestamp,WH),1),r.timestamp=A,r.isProcessing=!0,a.process(r),c.process(r),h.process(r),d.process(r),g.process(r),m.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(y))},w=()=>{t=!0,i=!0,r.isProcessing||n(y)};return{schedule:e0.reduce((A,b)=>{const N=o[b];return A[b]=(D,O=!1,$=!1)=>(t||w(),N.schedule(D,O,$)),A},{}),cancel:A=>{for(let b=0;b<e0.length;b++)o[e0[b]].cancel(A)},state:r,steps:o}}const{schedule:zt,cancel:il,state:Yn,steps:TE}=DO(typeof requestAnimationFrame<"u"?requestAnimationFrame:nr,!0),VO=oe.createContext({strict:!1}),KC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Yh={};for(const n in KC)Yh[n]={isEnabled:e=>KC[n].some(t=>!!e[t])};function HH(n){for(const e in n)Yh[e]={...Yh[e],...n[e]}}const KH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function k_(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||KH.has(n)}let FO=n=>!k_(n);function qH(n){n&&(FO=e=>e.startsWith("on")?!k_(e):n(e))}try{qH(require("@emotion/is-prop-valid").default)}catch{}function YH(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(FO(r)||t===!0&&k_(r)||!e&&!k_(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function XH(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const qy=oe.createContext({});function Ag(n){return typeof n=="string"||Array.isArray(n)}function Yy(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const wI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],xI=["initial",...wI];function Xy(n){return Yy(n.animate)||xI.some(e=>Ag(n[e]))}function jO(n){return!!(Xy(n)||n.variants)}function QH(n,e){if(Xy(n)){const{initial:t,animate:i}=n;return{initial:t===!1||Ag(t)?t:void 0,animate:Ag(i)?i:void 0}}return n.inherit!==!1?e:{}}function ZH(n){const{initial:e,animate:t}=QH(n,oe.useContext(qy));return oe.useMemo(()=>({initial:e,animate:t}),[qC(e),qC(t)])}function qC(n){return Array.isArray(n)?n.join(" "):n}const JH=Symbol.for("motionComponentSymbol");function oh(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function eK(n,e,t){return oe.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):oh(t)&&(t.current=i))},[e])}const SI=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),tK="framerAppearId",GO="data-"+SI(tK),{schedule:II}=DO(queueMicrotask,!1),UO=oe.createContext({});function nK(n,e,t,i,r){var s,o;const{visualElement:a}=oe.useContext(qy),c=oe.useContext(VO),h=oe.useContext(Ky),d=oe.useContext(yI).reducedMotion,g=oe.useRef(null);i=i||c.renderer,!g.current&&i&&(g.current=i(n,{visualState:e,parent:a,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:d}));const m=g.current,y=oe.useContext(UO);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&iK(g.current,t,r,y);const w=oe.useRef(!1);oe.useInsertionEffect(()=>{m&&w.current&&m.update(t,h)});const I=t[GO],E=oe.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return NO(()=>{m&&(w.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),II.render(m.render),E.current&&m.animationState&&m.animationState.animateChanges())}),oe.useEffect(()=>{m&&(!E.current&&m.animationState&&m.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var A;(A=window.MotionHandoffMarkAsComplete)===null||A===void 0||A.call(window,I)}),E.current=!1))}),m}function iK(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:BO(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&oh(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:c,layoutRoot:h})}function BO(n){if(n)return n.options.allowProjection!==!1?n.projection:BO(n.parent)}function rK({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&HH(n);function a(h,d){let g;const m={...oe.useContext(yI),...h,layoutId:sK(h)},{isStatic:y}=m,w=ZH(h),I=i(h,y);if(!y&&vI){oK();const E=aK(m);g=E.MeasureLayout,w.visualElement=nK(r,I,m,e,E.ProjectionNode)}return T.jsxs(qy.Provider,{value:w,children:[g&&w.visualElement?T.jsx(g,{visualElement:w.visualElement,...m}):null,t(r,h,eK(I,w.visualElement,d),I,y,w.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const c=oe.forwardRef(a);return c[JH]=r,c}function sK({layoutId:n}){const e=oe.useContext(pI).id;return e&&n!==void 0?e+"-"+n:n}function oK(n,e){oe.useContext(VO).strict}function aK(n){const{drag:e,layout:t}=Yh;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const lK=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function TI(n){return typeof n!="string"||n.includes("-")?!1:!!(lK.indexOf(n)>-1||/[A-Z]/u.test(n))}function YC(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function RI(n,e,t,i){if(typeof e=="function"){const[r,s]=YC(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=YC(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const Qw=n=>Array.isArray(n),cK=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),uK=n=>Qw(n)?n[n.length-1]||0:n,hi=n=>!!(n&&n.getVelocity);function R0(n){const e=hi(n)?n.get():n;return cK(e)?e.toValue():e}function hK({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:dK(i,r,s,n),renderState:e()};return t&&(o.onMount=a=>t({props:i,current:a,...o}),o.onUpdate=a=>t(a)),o}const zO=n=>(e,t)=>{const i=oe.useContext(qy),r=oe.useContext(Ky),s=()=>hK(n,e,i,r);return t?s():_I(s)};function dK(n,e,t,i){const r={},s=i(n,{});for(const m in s)r[m]=R0(s[m]);let{initial:o,animate:a}=n;const c=Xy(n),h=jO(n);e&&h&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const g=d?a:o;if(g&&typeof g!="boolean"&&!Yy(g)){const m=Array.isArray(g)?g:[g];for(let y=0;y<m.length;y++){const w=RI(n,m[y]);if(w){const{transitionEnd:I,transition:E,...A}=w;for(const b in A){let N=A[b];if(Array.isArray(N)){const D=d?N.length-1:0;N=N[D]}N!==null&&(r[b]=N)}for(const b in I)r[b]=I[b]}}}return r}const od=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Kc=new Set(od),$O=n=>e=>typeof e=="string"&&e.startsWith(n),WO=$O("--"),fK=$O("var(--"),AI=n=>fK(n)?gK.test(n.split("/*")[0].trim()):!1,gK=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,HO=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Oo=(n,e,t)=>t>e?e:t<n?n:t,ad={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Pg={...ad,transform:n=>Oo(0,1,n)},t0={...ad,default:1},gm=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),wa=gm("deg"),Vs=gm("%"),We=gm("px"),mK=gm("vh"),pK=gm("vw"),XC={...Vs,parse:n=>Vs.parse(n)/100,transform:n=>Vs.transform(n*100)},_K={borderWidth:We,borderTopWidth:We,borderRightWidth:We,borderBottomWidth:We,borderLeftWidth:We,borderRadius:We,radius:We,borderTopLeftRadius:We,borderTopRightRadius:We,borderBottomRightRadius:We,borderBottomLeftRadius:We,width:We,maxWidth:We,height:We,maxHeight:We,top:We,right:We,bottom:We,left:We,padding:We,paddingTop:We,paddingRight:We,paddingBottom:We,paddingLeft:We,margin:We,marginTop:We,marginRight:We,marginBottom:We,marginLeft:We,backgroundPositionX:We,backgroundPositionY:We},yK={rotate:wa,rotateX:wa,rotateY:wa,rotateZ:wa,scale:t0,scaleX:t0,scaleY:t0,scaleZ:t0,skew:wa,skewX:wa,skewY:wa,distance:We,translateX:We,translateY:We,translateZ:We,x:We,y:We,z:We,perspective:We,transformPerspective:We,opacity:Pg,originX:XC,originY:XC,originZ:We},QC={...ad,transform:Math.round},PI={..._K,...yK,zIndex:QC,size:We,fillOpacity:Pg,strokeOpacity:Pg,numOctaves:QC},vK={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},EK=od.length;function wK(n,e,t){let i="",r=!0;for(let s=0;s<EK;s++){const o=od[s],a=n[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||t){const h=HO(a,PI[o]);if(!c){r=!1;const d=vK[o]||o;i+=`${d}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function CI(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const c in e){const h=e[c];if(Kc.has(c)){o=!0;continue}else if(WO(c)){r[c]=h;continue}else{const d=HO(h,PI[c]);c.startsWith("origin")?(a=!0,s[c]=d):i[c]=d}}if(e.transform||(o||t?i.transform=wK(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:c="50%",originY:h="50%",originZ:d=0}=s;i.transformOrigin=`${c} ${h} ${d}`}}const xK={offset:"stroke-dashoffset",array:"stroke-dasharray"},SK={offset:"strokeDashoffset",array:"strokeDasharray"};function IK(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?xK:SK;n[s.offset]=We.transform(-i);const o=We.transform(e),a=We.transform(t);n[s.array]=`${o} ${a}`}function ZC(n,e,t){return typeof n=="string"?n:We.transform(e+t*n)}function TK(n,e,t){const i=ZC(e,n.x,n.width),r=ZC(t,n.y,n.height);return`${i} ${r}`}function bI(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:c=0,...h},d,g){if(CI(n,h,g),d){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:w}=n;m.transform&&(w&&(y.transform=m.transform),delete m.transform),w&&(r!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=TK(w,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),i!==void 0&&(m.scale=i),o!==void 0&&IK(m,o,a,c,!1)}const MI=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),KO=()=>({...MI(),attrs:{}}),kI=n=>typeof n=="string"&&n.toLowerCase()==="svg";function qO(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const YO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function XO(n,e,t,i){qO(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(YO.has(r)?r:SI(r),e.attrs[r])}const L_={};function RK(n){Object.assign(L_,n)}function QO(n,{layout:e,layoutId:t}){return Kc.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!L_[n]||n==="opacity")}function LI(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(hi(r[o])||e.style&&hi(e.style[o])||QO(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function ZO(n,e,t){const i=LI(n,e,t);for(const r in n)if(hi(n[r])||hi(e[r])){const s=od.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function AK(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const JC=["x","y","width","height","cx","cy","r"],PK={useVisualState:zO({scrapeMotionValuesFromProps:ZO,createRenderState:KO,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const a in r)if(Kc.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<JC.length;a++){const c=JC[a];n[c]!==e[c]&&(o=!0)}o&&zt.read(()=>{AK(t,i),zt.render(()=>{bI(i,r,kI(t.tagName),n.transformTemplate),XO(t,i)})})}})},CK={useVisualState:zO({scrapeMotionValuesFromProps:LI,createRenderState:MI})};function JO(n,e,t){for(const i in e)!hi(e[i])&&!QO(i,t)&&(n[i]=e[i])}function bK({transformTemplate:n},e){return oe.useMemo(()=>{const t=MI();return CI(t,e,n),Object.assign({},t.vars,t.style)},[e])}function MK(n,e){const t=n.style||{},i={};return JO(i,t,n),Object.assign(i,bK(n,e)),i}function kK(n,e){const t={},i=MK(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function LK(n,e,t,i){const r=oe.useMemo(()=>{const s=KO();return bI(s,e,kI(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};JO(s,n.style,n),r.style={...s,...r.style}}return r}function NK(n=!1){return(t,i,r,{latestValues:s},o)=>{const c=(TI(t)?LK:kK)(i,s,o,t),h=YH(i,typeof t=="string",n),d=t!==oe.Fragment?{...h,...c,ref:r}:{},{children:g}=i,m=oe.useMemo(()=>hi(g)?g.get():g,[g]);return oe.createElement(t,{...d,children:m})}}function OK(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...TI(i)?PK:CK,preloadedFeatures:n,useRender:NK(r),createVisualElement:e,Component:i};return rK(o)}}function eD(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Qy(n,e,t){const i=n.getProps();return RI(i,e,t!==void 0?t:i.custom,n)}const DK=EI(()=>window.ScrollTimeline!==void 0);class VK{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(DK()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class FK extends VK{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function NI(n,e){return n?n[e]||n.default||n:void 0}const Zw=2e4;function tD(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<Zw;)e+=t,i=n.next(e);return e>=Zw?1/0:e}function OI(n){return typeof n=="function"}function eb(n,e){n.timeline=e,n.onfinish=null}const DI=n=>Array.isArray(n)&&typeof n[0]=="number",jK={linearEasing:void 0};function GK(n,e){const t=EI(n);return()=>{var i;return(i=jK[e])!==null&&i!==void 0?i:t()}}const N_=GK(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nD=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(qh(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function iD(n){return!!(typeof n=="function"&&N_()||!n||typeof n=="string"&&(n in Jw||N_())||DI(n)||Array.isArray(n)&&n.every(iD))}const xf=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,Jw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:xf([0,.65,.55,1]),circOut:xf([.55,0,1,.45]),backIn:xf([.31,.01,.66,-.59]),backOut:xf([.33,1.53,.69,.99])};function rD(n,e){if(n)return typeof n=="function"&&N_()?nD(n,e):DI(n)?xf(n):Array.isArray(n)?n.map(t=>rD(t,e)||Jw.easeOut):Jw[n]}const Wr={x:!1,y:!1};function sD(){return Wr.x||Wr.y}function UK(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function oD(n,e){const t=UK(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function tb(n){return e=>{e.pointerType==="touch"||sD()||n(e)}}function BK(n,e,t={}){const[i,r,s]=oD(n,t),o=tb(a=>{const{target:c}=a,h=e(a);if(typeof h!="function"||!c)return;const d=tb(g=>{h(g),c.removeEventListener("pointerleave",d)});c.addEventListener("pointerleave",d,r)});return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const aD=(n,e)=>e?n===e?!0:aD(n,e.parentElement):!1,VI=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,zK=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function $K(n){return zK.has(n.tagName)||n.tabIndex!==-1}const Sf=new WeakSet;function nb(n){return e=>{e.key==="Enter"&&n(e)}}function RE(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const WK=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=nb(()=>{if(Sf.has(t))return;RE(t,"down");const r=nb(()=>{RE(t,"up")}),s=()=>RE(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function ib(n){return VI(n)&&!sD()}function HK(n,e,t={}){const[i,r,s]=oD(n,t),o=a=>{const c=a.currentTarget;if(!ib(a)||Sf.has(c))return;Sf.add(c);const h=e(a),d=(y,w)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!ib(y)||!Sf.has(c))&&(Sf.delete(c),typeof h=="function"&&h(y,{success:w}))},g=y=>{d(y,t.useGlobalTarget||aD(c,y.target))},m=y=>{d(y,!1)};window.addEventListener("pointerup",g,r),window.addEventListener("pointercancel",m,r)};return i.forEach(a=>{!$K(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",h=>WK(h,r),r)}),s}function KK(n){return n==="x"||n==="y"?Wr[n]?null:(Wr[n]=!0,()=>{Wr[n]=!1}):Wr.x||Wr.y?null:(Wr.x=Wr.y=!0,()=>{Wr.x=Wr.y=!1})}const lD=new Set(["width","height","top","left","right","bottom",...od]);let A0;function qK(){A0=void 0}const Fs={now:()=>(A0===void 0&&Fs.set(Yn.isProcessing||zH.useManualTiming?Yn.timestamp:performance.now()),A0),set:n=>{A0=n,queueMicrotask(qK)}};function FI(n,e){n.indexOf(e)===-1&&n.push(e)}function jI(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class GI{constructor(){this.subscriptions=[]}add(e){return FI(this.subscriptions,e),()=>jI(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function cD(n,e){return e?n*(1e3/e):0}const rb=30,YK=n=>!isNaN(parseFloat(n));class XK{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=Fs.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Fs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=YK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new GI);const i=this.events[e].add(t);return e==="change"?()=>{i(),zt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Fs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>rb)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,rb);return cD(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Cg(n,e){return new XK(n,e)}function QK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Cg(t))}function ZK(n,e){const t=Qy(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=uK(s[o]);QK(n,o,a)}}function JK(n){return!!(hi(n)&&n.add)}function ex(n,e){const t=n.getValue("willChange");if(JK(t))return t.add(e)}function uD(n){return n.props[GO]}const hD=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,eq=1e-7,tq=12;function nq(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=hD(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>eq&&++a<tq);return o}function mm(n,e,t,i){if(n===e&&t===i)return nr;const r=s=>nq(s,0,1,n,t);return s=>s===0||s===1?s:hD(r(s),e,i)}const dD=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,fD=n=>e=>1-n(1-e),gD=mm(.33,1.53,.69,.99),UI=fD(gD),mD=dD(UI),pD=n=>(n*=2)<1?.5*UI(n):.5*(2-Math.pow(2,-10*(n-1))),BI=n=>1-Math.sin(Math.acos(n)),_D=fD(BI),yD=dD(BI),vD=n=>/^0[^.\s]+$/u.test(n);function iq(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||vD(n):!0}const Gf=n=>Math.round(n*1e5)/1e5,zI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function rq(n){return n==null}const sq=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,$I=(n,e)=>t=>!!(typeof t=="string"&&sq.test(t)&&t.startsWith(n)||e&&!rq(t)&&Object.prototype.hasOwnProperty.call(t,e)),ED=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(zI);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},oq=n=>Oo(0,255,n),AE={...ad,transform:n=>Math.round(oq(n))},oc={test:$I("rgb","red"),parse:ED("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+AE.transform(n)+", "+AE.transform(e)+", "+AE.transform(t)+", "+Gf(Pg.transform(i))+")"};function aq(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const tx={test:$I("#"),parse:aq,transform:oc.transform},ah={test:$I("hsl","hue"),parse:ED("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+Vs.transform(Gf(e))+", "+Vs.transform(Gf(t))+", "+Gf(Pg.transform(i))+")"},ai={test:n=>oc.test(n)||tx.test(n)||ah.test(n),parse:n=>oc.test(n)?oc.parse(n):ah.test(n)?ah.parse(n):tx.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?oc.transform(n):ah.transform(n)},lq=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function cq(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(zI))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(lq))===null||t===void 0?void 0:t.length)||0)>0}const wD="number",xD="color",uq="var",hq="var(",sb="${}",dq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function bg(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(dq,c=>(ai.test(c)?(i.color.push(s),r.push(xD),t.push(ai.parse(c))):c.startsWith(hq)?(i.var.push(s),r.push(uq),t.push(c)):(i.number.push(s),r.push(wD),t.push(parseFloat(c))),++s,sb)).split(sb);return{values:t,split:a,indexes:i,types:r}}function SD(n){return bg(n).values}function ID(n){const{split:e,types:t}=bg(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===wD?s+=Gf(r[o]):a===xD?s+=ai.transform(r[o]):s+=r[o]}return s}}const fq=n=>typeof n=="number"?0:n;function gq(n){const e=SD(n);return ID(n)(e.map(fq))}const rl={test:cq,parse:SD,createTransformer:ID,getAnimatableNone:gq},mq=new Set(["brightness","contrast","saturate","opacity"]);function pq(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(zI)||[];if(!i)return n;const r=t.replace(i,"");let s=mq.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const _q=/\b([a-z-]*)\(.*?\)/gu,nx={...rl,getAnimatableNone:n=>{const e=n.match(_q);return e?e.map(pq).join(" "):n}},yq={...PI,color:ai,backgroundColor:ai,outlineColor:ai,fill:ai,stroke:ai,borderColor:ai,borderTopColor:ai,borderRightColor:ai,borderBottomColor:ai,borderLeftColor:ai,filter:nx,WebkitFilter:nx},WI=n=>yq[n];function TD(n,e){let t=WI(n);return t!==nx&&(t=rl),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const vq=new Set(["auto","none","0"]);function Eq(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!vq.has(s)&&bg(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=TD(t,r)}const ob=n=>n===ad||n===We,ab=(n,e)=>parseFloat(n.split(", ")[e]),lb=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return ab(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?ab(s[1],n):0}},wq=new Set(["x","y","z"]),xq=od.filter(n=>!wq.has(n));function Sq(n){const e=[];return xq.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const Xh={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:lb(4,13),y:lb(5,14)};Xh.translateX=Xh.x;Xh.translateY=Xh.y;const fc=new Set;let ix=!1,rx=!1;function RD(){if(rx){const n=Array.from(fc).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=Sq(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))===null||a===void 0||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}rx=!1,ix=!1,fc.forEach(n=>n.complete()),fc.clear()}function AD(){fc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(rx=!0)})}function Iq(){AD(),RD()}class HI{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(fc.add(this),ix||(ix=!0,zt.read(AD),zt.resolveKeyframes(RD))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const c=i.readValue(t,a);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),fc.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,fc.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const PD=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Tq=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Rq(n){const e=Tq.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function CD(n,e,t=1){const[i,r]=Rq(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return PD(o)?parseFloat(o):o}return AI(r)?CD(r,e,t+1):r}const bD=n=>e=>e.test(n),Aq={test:n=>n==="auto",parse:n=>n},MD=[ad,We,Vs,wa,pK,mK,Aq],cb=n=>MD.find(bD(n));class kD extends HI{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),AI(h))){const d=CD(h,t.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!lD.has(i)||e.length!==2)return;const[r,s]=e,o=cb(r),a=cb(s);if(o!==a)if(ob(o)&&ob(a))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)iq(e[r])&&i.push(r);i.length&&Eq(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Xh[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Xh[i](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}const ub=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(rl.test(n)||n==="0")&&!n.startsWith("url("));function Pq(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Cq(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=ub(r,e),a=ub(s,e);return!o||!a?!1:Pq(n)||(t==="spring"||OI(t))&&i}const bq=n=>n!==null;function Zy(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(bq),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const Mq=40;class LD{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Fs.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Mq?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Iq(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Fs.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:a,onUpdate:c,isGenerator:h}=this.options;if(!h&&!Cq(e,i,r,s))if(o)this.options.duration=0;else{c&&c(Zy(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const d=this.initPlayback(e,t);d!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...d},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const en=(n,e,t)=>n+(e-n)*t;function PE(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function kq({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;r=PE(c,a,n+1/3),s=PE(c,a,n),o=PE(c,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function O_(n,e){return t=>t>0?e:n}const CE=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},Lq=[tx,oc,ah],Nq=n=>Lq.find(e=>e.test(n));function hb(n){const e=Nq(n);if(!e)return!1;let t=e.parse(n);return e===ah&&(t=kq(t)),t}const db=(n,e)=>{const t=hb(n),i=hb(e);if(!t||!i)return O_(n,e);const r={...t};return s=>(r.red=CE(t.red,i.red,s),r.green=CE(t.green,i.green,s),r.blue=CE(t.blue,i.blue,s),r.alpha=en(t.alpha,i.alpha,s),oc.transform(r))},Oq=(n,e)=>t=>e(n(t)),pm=(...n)=>n.reduce(Oq),sx=new Set(["none","hidden"]);function Dq(n,e){return sx.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Vq(n,e){return t=>en(n,e,t)}function KI(n){return typeof n=="number"?Vq:typeof n=="string"?AI(n)?O_:ai.test(n)?db:Gq:Array.isArray(n)?ND:typeof n=="object"?ai.test(n)?db:Fq:O_}function ND(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>KI(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function Fq(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=KI(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function jq(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=n.indexes[o][r[o]],c=(t=n.values[a])!==null&&t!==void 0?t:0;i[s]=c,r[o]++}return i}const Gq=(n,e)=>{const t=rl.createTransformer(e),i=bg(n),r=bg(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?sx.has(n)&&!r.values.length||sx.has(e)&&!i.values.length?Dq(n,e):pm(ND(jq(i,r),r.values),t):O_(n,e)};function OD(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?en(n,e,t):KI(n)(n,e)}const Uq=5;function DD(n,e,t){const i=Math.max(e-Uq,0);return cD(t-n(i),e-i)}const sn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},bE=.001;function Bq({duration:n=sn.duration,bounce:e=sn.bounce,velocity:t=sn.velocity,mass:i=sn.mass}){let r,s,o=1-e;o=Oo(sn.minDamping,sn.maxDamping,o),n=Oo(sn.minDuration,sn.maxDuration,Co(n)),o<1?(r=h=>{const d=h*o,g=d*n,m=d-t,y=ox(h,o),w=Math.exp(-g);return bE-m/y*w},s=h=>{const g=h*o*n,m=g*t+t,y=Math.pow(o,2)*Math.pow(h,2)*n,w=Math.exp(-g),I=ox(Math.pow(h,2),o);return(-r(h)+bE>0?-1:1)*((m-y)*w)/I}):(r=h=>{const d=Math.exp(-h*n),g=(h-t)*n+1;return-bE+d*g},s=h=>{const d=Math.exp(-h*n),g=(t-h)*(n*n);return d*g});const a=5/n,c=$q(r,s,a);if(n=Po(n),isNaN(c))return{stiffness:sn.stiffness,damping:sn.damping,duration:n};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const zq=12;function $q(n,e,t){let i=t;for(let r=1;r<zq;r++)i=i-n(i)/e(i);return i}function ox(n,e){return n*Math.sqrt(1-e*e)}const Wq=["duration","bounce"],Hq=["stiffness","damping","mass"];function fb(n,e){return e.some(t=>n[t]!==void 0)}function Kq(n){let e={velocity:sn.velocity,stiffness:sn.stiffness,damping:sn.damping,mass:sn.mass,isResolvedFromDuration:!1,...n};if(!fb(n,Hq)&&fb(n,Wq))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Oo(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:sn.mass,stiffness:r,damping:s}}else{const t=Bq(n);e={...e,...t,mass:sn.mass},e.isResolvedFromDuration=!0}return e}function VD(n=sn.visualDuration,e=sn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:c,damping:h,mass:d,duration:g,velocity:m,isResolvedFromDuration:y}=Kq({...t,velocity:-Co(t.velocity||0)}),w=m||0,I=h/(2*Math.sqrt(c*d)),E=o-s,A=Co(Math.sqrt(c/d)),b=Math.abs(E)<5;i||(i=b?sn.restSpeed.granular:sn.restSpeed.default),r||(r=b?sn.restDelta.granular:sn.restDelta.default);let N;if(I<1){const O=ox(A,I);N=$=>{const k=Math.exp(-I*A*$);return o-k*((w+I*A*E)/O*Math.sin(O*$)+E*Math.cos(O*$))}}else if(I===1)N=O=>o-Math.exp(-A*O)*(E+(w+A*E)*O);else{const O=A*Math.sqrt(I*I-1);N=$=>{const k=Math.exp(-I*A*$),C=Math.min(O*$,300);return o-k*((w+I*A*E)*Math.sinh(C)+O*E*Math.cosh(C))/O}}const D={calculatedDuration:y&&g||null,next:O=>{const $=N(O);if(y)a.done=O>=g;else{let k=0;I<1&&(k=O===0?Po(w):DD(N,O,$));const C=Math.abs(k)<=i,L=Math.abs(o-$)<=r;a.done=C&&L}return a.value=a.done?o:$,a},toString:()=>{const O=Math.min(tD(D),Zw),$=nD(k=>D.next(O*k).value,O,30);return O+"ms "+$}};return D}function gb({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:c,restDelta:h=.5,restSpeed:d}){const g=n[0],m={done:!1,value:g},y=C=>a!==void 0&&C<a||c!==void 0&&C>c,w=C=>a===void 0?c:c===void 0||Math.abs(a-C)<Math.abs(c-C)?a:c;let I=t*e;const E=g+I,A=o===void 0?E:o(E);A!==E&&(I=A-g);const b=C=>-I*Math.exp(-C/i),N=C=>A+b(C),D=C=>{const L=b(C),j=N(C);m.done=Math.abs(L)<=h,m.value=m.done?A:j};let O,$;const k=C=>{y(m.value)&&(O=C,$=VD({keyframes:[m.value,w(m.value)],velocity:DD(N,C,m.value),damping:r,stiffness:s,restDelta:h,restSpeed:d}))};return k(0),{calculatedDuration:null,next:C=>{let L=!1;return!$&&O===void 0&&(L=!0,D(C),k(C)),O!==void 0&&C>=O?$.next(C-O):(!L&&D(C),m)}}}const qq=mm(.42,0,1,1),Yq=mm(0,0,.58,1),FD=mm(.42,0,.58,1),Xq=n=>Array.isArray(n)&&typeof n[0]!="number",Qq={linear:nr,easeIn:qq,easeInOut:FD,easeOut:Yq,circIn:BI,circInOut:yD,circOut:_D,backIn:UI,backInOut:mD,backOut:gD,anticipate:pD},mb=n=>{if(DI(n)){OO(n.length===4);const[e,t,i,r]=n;return mm(e,t,i,r)}else if(typeof n=="string")return Qq[n];return n};function Zq(n,e,t){const i=[],r=t||OD,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||nr:e;a=pm(c,a)}i.push(a)}return i}function Jq(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(OO(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=Zq(e,i,r),c=a.length,h=d=>{if(o&&d<n[0])return e[0];let g=0;if(c>1)for(;g<n.length-2&&!(d<n[g+1]);g++);const m=qh(n[g],n[g+1],d);return a[g](m)};return t?d=>h(Oo(n[0],n[s-1],d)):h}function eY(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=qh(0,e,i);n.push(en(t,1,r))}}function tY(n){const e=[0];return eY(e,n.length-1),e}function nY(n,e){return n.map(t=>t*e)}function iY(n,e){return n.map(()=>e||FD).splice(0,n.length-1)}function D_({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=Xq(i)?i.map(mb):mb(i),s={done:!1,value:e[0]},o=nY(t&&t.length===e.length?t:tY(e),n),a=Jq(o,e,{ease:Array.isArray(r)?r:iY(e,r)});return{calculatedDuration:n,next:c=>(s.value=a(c),s.done=c>=n,s)}}const rY=n=>{const e=({timestamp:t})=>n(t);return{start:()=>zt.update(e,!0),stop:()=>il(e),now:()=>Yn.isProcessing?Yn.timestamp:Fs.now()}},sY={decay:gb,inertia:gb,tween:D_,keyframes:D_,spring:VD},oY=n=>n/100;class qI extends LD{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||HI,a=(c,h)=>this.onKeyframesResolved(c,h);this.resolver=new o(s,a,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,a=OI(t)?t:sY[t]||D_;let c,h;a!==D_&&typeof e[0]!="number"&&(c=pm(oY,OD(e[0],e[1])),e=[0,100]);const d=a({...this.options,keyframes:e});s==="mirror"&&(h=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=tD(d));const{calculatedDuration:g}=d,m=g+r,y=m*(i+1)-r;return{generator:d,mirroredGenerator:h,mapPercentToKeyframes:c,calculatedDuration:g,resolvedDuration:m,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:c,calculatedDuration:h,totalDuration:d,resolvedDuration:g}=i;if(this.startTime===null)return s.next(0);const{delay:m,repeat:y,repeatType:w,repeatDelay:I,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-d/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const A=this.currentTime-m*(this.speed>=0?1:-1),b=this.speed>=0?A<0:A>d;this.currentTime=Math.max(A,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let N=this.currentTime,D=s;if(y){const C=Math.min(this.currentTime,d)/g;let L=Math.floor(C),j=C%1;!j&&C>=1&&(j=1),j===1&&L--,L=Math.min(L,y+1),L%2&&(w==="reverse"?(j=1-j,I&&(j-=I/g)):w==="mirror"&&(D=o)),N=Oo(0,1,j)*g}const O=b?{done:!1,value:c[0]}:D.next(N);a&&(O.value=a(O.value));let{done:$}=O;!b&&h!==null&&($=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&$);return k&&r!==void 0&&(O.value=Zy(c,this.options,r)),E&&E(O.value),k&&this.finish(),O}get duration(){const{resolved:e}=this;return e?Co(e.calculatedDuration):0}get time(){return Co(this.currentTime)}set time(e){e=Po(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Co(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=rY,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const aY=new Set(["opacity","clipPath","filter","transform"]);function lY(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:c}={}){const h={[e]:t};c&&(h.offset=c);const d=rD(a,r);return Array.isArray(d)&&(h.easing=d),n.animate(h,{delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const cY=EI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),V_=10,uY=2e4;function hY(n){return OI(n.type)||n.type==="spring"||!iD(n.ease)}function dY(n,e){const t=new qI({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<uY;)i=t.sample(s),r.push(i.value),s+=V_;return{times:void 0,keyframes:r,duration:s-V_,ease:"linear"}}const jD={anticipate:pD,backInOut:mD,circInOut:yD};function fY(n){return n in jD}class pb extends LD{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new kD(s,(o,a)=>this.onKeyframesResolved(o,a),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:a,name:c,startTime:h}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&N_()&&fY(s)&&(s=jD[s]),hY(this.options)){const{onComplete:g,onUpdate:m,motionValue:y,element:w,...I}=this.options,E=dY(e,I);e=E.keyframes,e.length===1&&(e[1]=e[0]),i=E.duration,r=E.times,s=E.ease,o="keyframes"}const d=lY(a.owner.current,c,e,{...this.options,duration:i,times:r,ease:s});return d.startTime=h??this.calcStartTime(),this.pendingTimeline?(eb(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:g}=this.options;a.set(Zy(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Co(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Co(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=Po(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return nr;const{animation:i}=t;eb(i,e)}return nr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:d,onComplete:g,element:m,...y}=this.options,w=new qI({...y,keyframes:i,duration:r,type:s,ease:o,times:a,isGenerator:!0}),I=Po(this.time);h.setWithVelocity(w.sample(I-V_).value,w.sample(I).value,V_)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=t.owner.getProps();return cY()&&i&&aY.has(i)&&!c&&!h&&!r&&s!=="mirror"&&o!==0&&a!=="inertia"}}const gY={type:"spring",stiffness:500,damping:25,restSpeed:10},mY=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),pY={type:"keyframes",duration:.8},_Y={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},yY=(n,{keyframes:e})=>e.length>2?pY:Kc.has(n)?n.startsWith("scale")?mY(e[1]):gY:_Y;function vY({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:c,elapsed:h,...d}){return!!Object.keys(d).length}const YI=(n,e,t,i={},r,s)=>o=>{const a=NI(i,n)||{},c=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-Po(c);let d={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};vY(a)||(d={...d,...yY(n,d)}),d.duration&&(d.duration=Po(d.duration)),d.repeatDelay&&(d.repeatDelay=Po(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=Zy(d.keyframes,a);if(m!==void 0)return zt.update(()=>{d.onUpdate(m),d.onComplete()}),new FK([])}return!s&&pb.supports(d)?new pb(d):new qI(d)};function EY({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function GD(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:a,...c}=e;i&&(o=i);const h=[],d=r&&n.animationState&&n.animationState.getState()[r];for(const g in c){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),y=c[g];if(y===void 0||d&&EY(d,g))continue;const w={delay:t,...NI(o||{},g)};let I=!1;if(window.MotionHandoffAnimation){const A=uD(n);if(A){const b=window.MotionHandoffAnimation(A,g,zt);b!==null&&(w.startTime=b,I=!0)}}ex(n,g),m.start(YI(g,m,y,n.shouldReduceMotion&&lD.has(g)?{type:!1}:w,n,I));const E=m.animation;E&&h.push(E)}return a&&Promise.all(h).then(()=>{zt.update(()=>{a&&ZK(n,a)})}),h}function ax(n,e,t={}){var i;const r=Qy(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(GD(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:m}=s;return wY(n,e,d+h,g,m,t)}:()=>Promise.resolve(),{when:c}=s;if(c){const[h,d]=c==="beforeChildren"?[o,a]:[a,o];return h().then(()=>d())}else return Promise.all([o(),a(t.delay)])}function wY(n,e,t=0,i=0,r=1,s){const o=[],a=(n.variantChildren.size-1)*i,c=r===1?(h=0)=>h*i:(h=0)=>a-h*i;return Array.from(n.variantChildren).sort(xY).forEach((h,d)=>{h.notify("AnimationStart",e),o.push(ax(h,e,{...s,delay:t+c(d)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function xY(n,e){return n.sortNodePosition(e)}function SY(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>ax(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=ax(n,e,t);else{const r=typeof e=="function"?Qy(n,e,t.custom):e;i=Promise.all(GD(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const IY=xI.length;function UD(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?UD(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<IY;t++){const i=xI[t],r=n.props[i];(Ag(r)||r===!1)&&(e[i]=r)}return e}const TY=[...wI].reverse(),RY=wI.length;function AY(n){return e=>Promise.all(e.map(({animation:t,options:i})=>SY(n,t,i)))}function PY(n){let e=AY(n),t=_b(),i=!0;const r=c=>(h,d)=>{var g;const m=Qy(n,d,c==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:y,transitionEnd:w,...I}=m;h={...h,...I,...w}}return h};function s(c){e=c(n)}function o(c){const{props:h}=n,d=UD(n.parent)||{},g=[],m=new Set;let y={},w=1/0;for(let E=0;E<RY;E++){const A=TY[E],b=t[A],N=h[A]!==void 0?h[A]:d[A],D=Ag(N),O=A===c?b.isActive:null;O===!1&&(w=E);let $=N===d[A]&&N!==h[A]&&D;if($&&i&&n.manuallyAnimateOnMount&&($=!1),b.protectedKeys={...y},!b.isActive&&O===null||!N&&!b.prevProp||Yy(N)||typeof N=="boolean")continue;const k=CY(b.prevProp,N);let C=k||A===c&&b.isActive&&!$&&D||E>w&&D,L=!1;const j=Array.isArray(N)?N:[N];let G=j.reduce(r(A),{});O===!1&&(G={});const{prevResolvedValues:z={}}=b,V={...z,...G},de=fe=>{C=!0,m.has(fe)&&(L=!0,m.delete(fe)),b.needsAnimating[fe]=!0;const Q=n.getValue(fe);Q&&(Q.liveStyle=!1)};for(const fe in V){const Q=G[fe],ge=z[fe];if(y.hasOwnProperty(fe))continue;let he=!1;Qw(Q)&&Qw(ge)?he=!eD(Q,ge):he=Q!==ge,he?Q!=null?de(fe):m.add(fe):Q!==void 0&&m.has(fe)?de(fe):b.protectedKeys[fe]=!0}b.prevProp=N,b.prevResolvedValues=G,b.isActive&&(y={...y,...G}),i&&n.blockInitialAnimation&&(C=!1),C&&(!($&&k)||L)&&g.push(...j.map(fe=>({animation:fe,options:{type:A}})))}if(m.size){const E={};m.forEach(A=>{const b=n.getBaseTarget(A),N=n.getValue(A);N&&(N.liveStyle=!0),E[A]=b??null}),g.push({animation:E})}let I=!!g.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(g):Promise.resolve()}function a(c,h){var d;if(t[c].isActive===h)return Promise.resolve();(d=n.variantChildren)===null||d===void 0||d.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(c,h)}),t[c].isActive=h;const g=o(c);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=_b(),i=!0}}}function CY(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!eD(e,n):!1}function Gl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function _b(){return{animate:Gl(!0),whileInView:Gl(),whileHover:Gl(),whileTap:Gl(),whileDrag:Gl(),whileFocus:Gl(),exit:Gl()}}class ul{constructor(e){this.isMounted=!1,this.node=e}update(){}}class bY extends ul{constructor(e){super(e),e.animationState||(e.animationState=PY(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Yy(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let MY=0;class kY extends ul{constructor(){super(...arguments),this.id=MY++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const LY={animation:{Feature:bY},exit:{Feature:kY}};function Mg(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function _m(n){return{point:{x:n.pageX,y:n.pageY}}}const NY=n=>e=>VI(e)&&n(e,_m(e));function Uf(n,e,t,i){return Mg(n,e,NY(t),i)}const yb=(n,e)=>Math.abs(n-e);function OY(n,e){const t=yb(n.x,e.x),i=yb(n.y,e.y);return Math.sqrt(t**2+i**2)}class BD{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=kE(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=OY(g.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:w}=g,{timestamp:I}=Yn;this.history.push({...w,timestamp:I});const{onStart:E,onMove:A}=this.handlers;m||(E&&E(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=ME(m,this.transformPagePoint),zt.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:y,onSessionEnd:w,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=kE(g.type==="pointercancel"?this.lastMoveEventInfo:ME(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(g,E),w&&w(g,E)},!VI(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=_m(e),a=ME(o,this.transformPagePoint),{point:c}=a,{timestamp:h}=Yn;this.history=[{...c,timestamp:h}];const{onSessionStart:d}=t;d&&d(e,kE(a,this.history)),this.removeListeners=pm(Uf(this.contextWindow,"pointermove",this.handlePointerMove),Uf(this.contextWindow,"pointerup",this.handlePointerUp),Uf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),il(this.updatePoint)}}function ME(n,e){return e?{point:e(n.point)}:n}function vb(n,e){return{x:n.x-e.x,y:n.y-e.y}}function kE({point:n},e){return{point:n,delta:vb(n,zD(e)),offset:vb(n,DY(e)),velocity:VY(e,.1)}}function DY(n){return n[0]}function zD(n){return n[n.length-1]}function VY(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=zD(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>Po(e)));)t--;if(!i)return{x:0,y:0};const s=Co(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const $D=1e-4,FY=1-$D,jY=1+$D,WD=.01,GY=0-WD,UY=0+WD;function or(n){return n.max-n.min}function BY(n,e,t){return Math.abs(n-e)<=t}function Eb(n,e,t,i=.5){n.origin=i,n.originPoint=en(e.min,e.max,n.origin),n.scale=or(t)/or(e),n.translate=en(t.min,t.max,n.origin)-n.originPoint,(n.scale>=FY&&n.scale<=jY||isNaN(n.scale))&&(n.scale=1),(n.translate>=GY&&n.translate<=UY||isNaN(n.translate))&&(n.translate=0)}function Bf(n,e,t,i){Eb(n.x,e.x,t.x,i?i.originX:void 0),Eb(n.y,e.y,t.y,i?i.originY:void 0)}function wb(n,e,t){n.min=t.min+e.min,n.max=n.min+or(e)}function zY(n,e,t){wb(n.x,e.x,t.x),wb(n.y,e.y,t.y)}function xb(n,e,t){n.min=e.min-t.min,n.max=n.min+or(e)}function zf(n,e,t){xb(n.x,e.x,t.x),xb(n.y,e.y,t.y)}function $Y(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?en(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?en(t,n,i.max):Math.min(n,t)),n}function Sb(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function WY(n,{top:e,left:t,bottom:i,right:r}){return{x:Sb(n.x,t,r),y:Sb(n.y,e,i)}}function Ib(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function HY(n,e){return{x:Ib(n.x,e.x),y:Ib(n.y,e.y)}}function KY(n,e){let t=.5;const i=or(n),r=or(e);return r>i?t=qh(e.min,e.max-i,n.min):i>r&&(t=qh(n.min,n.max-r,e.min)),Oo(0,1,t)}function qY(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const lx=.35;function YY(n=lx){return n===!1?n=0:n===!0&&(n=lx),{x:Tb(n,"left","right"),y:Tb(n,"top","bottom")}}function Tb(n,e,t){return{min:Rb(n,e),max:Rb(n,t)}}function Rb(n,e){return typeof n=="number"?n:n[e]||0}const Ab=()=>({translate:0,scale:1,origin:0,originPoint:0}),lh=()=>({x:Ab(),y:Ab()}),Pb=()=>({min:0,max:0}),dn=()=>({x:Pb(),y:Pb()});function Sr(n){return[n("x"),n("y")]}function HD({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function XY({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function QY(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function LE(n){return n===void 0||n===1}function cx({scale:n,scaleX:e,scaleY:t}){return!LE(n)||!LE(e)||!LE(t)}function Kl(n){return cx(n)||KD(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function KD(n){return Cb(n.x)||Cb(n.y)}function Cb(n){return n&&n!=="0%"}function F_(n,e,t){const i=n-t,r=e*i;return t+r}function bb(n,e,t,i,r){return r!==void 0&&(n=F_(n,r,i)),F_(n,t,i)+e}function ux(n,e=0,t=1,i,r){n.min=bb(n.min,e,t,i,r),n.max=bb(n.max,e,t,i,r)}function qD(n,{x:e,y:t}){ux(n.x,e.translate,e.scale,e.originPoint),ux(n.y,t.translate,t.scale,t.originPoint)}const Mb=.999999999999,kb=1.0000000000001;function ZY(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&uh(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,qD(n,o)),i&&Kl(s.latestValues)&&uh(n,s.latestValues))}e.x<kb&&e.x>Mb&&(e.x=1),e.y<kb&&e.y>Mb&&(e.y=1)}function ch(n,e){n.min=n.min+e,n.max=n.max+e}function Lb(n,e,t,i,r=.5){const s=en(n.min,n.max,r);ux(n,e,t,s,i)}function uh(n,e){Lb(n.x,e.x,e.scaleX,e.scale,e.originX),Lb(n.y,e.y,e.scaleY,e.scale,e.originY)}function YD(n,e){return HD(QY(n.getBoundingClientRect(),e))}function JY(n,e,t){const i=YD(n,t),{scroll:r}=e;return r&&(ch(i.x,r.offset.x),ch(i.y,r.offset.y)),i}const XD=({current:n})=>n?n.ownerDocument.defaultView:null,eX=new WeakMap;class tX{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=dn(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(_m(d).point)},s=(d,g)=>{const{drag:m,dragPropagation:y,onDragStart:w}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=KK(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Sr(E=>{let A=this.getAxisMotionValue(E).get()||0;if(Vs.test(A)){const{projection:b}=this.visualElement;if(b&&b.layout){const N=b.layout.layoutBox[E];N&&(A=or(N)*(parseFloat(A)/100))}}this.originPoint[E]=A}),w&&zt.postRender(()=>w(d,g)),ex(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(d,g)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:w,onDrag:I}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:E}=g;if(y&&this.currentDirection===null){this.currentDirection=nX(E),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",g.point,E),this.updateAxis("y",g.point,E),this.visualElement.render(),I&&I(d,g)},a=(d,g)=>this.stop(d,g),c=()=>Sr(d=>{var g;return this.getAnimationState(d)==="paused"&&((g=this.getAxisMotionValue(d).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new BD(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:XD(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&zt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!n0(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=$Y(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&oh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=WY(r.layoutBox,t):this.constraints=!1,this.elastic=YY(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Sr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=qY(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!oh(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=JY(i,r.root,this.visualElement.getTransformPagePoint());let o=HY(r.layout.layoutBox,s);if(t){const a=t(XY(o));this.hasMutatedConstraints=!!a,a&&(o=HD(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},h=Sr(d=>{if(!n0(d,t,this.currentDirection))return;let g=c&&c[d]||{};o&&(g={min:0,max:0});const m=r?200:1e6,y=r?40:1e7,w={type:"inertia",velocity:i?e[d]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(d,w)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return ex(this.visualElement,e),i.start(YI(e,i,0,t,this.visualElement,!1))}stopAnimation(){Sr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Sr(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Sr(t=>{const{drag:i}=this.getProps();if(!n0(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-en(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!oh(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Sr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();r[o]=KY({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Sr(o=>{if(!n0(o,e,null))return;const a=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];a.set(en(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;eX.set(this.visualElement,this);const e=this.visualElement.current,t=Uf(e,"pointerdown",c=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();oh(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),zt.read(i);const o=Mg(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(Sr(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=c[d].translate,g.set(g.get()+c[d].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=lx,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function n0(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function nX(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class iX extends ul{constructor(e){super(e),this.removeGroupControls=nr,this.removeListeners=nr,this.controls=new tX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||nr}unmount(){this.removeGroupControls(),this.removeListeners()}}const Nb=n=>(e,t)=>{n&&zt.postRender(()=>n(e,t))};class rX extends ul{constructor(){super(...arguments),this.removePointerDownListener=nr}onPointerDown(e){this.session=new BD(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:XD(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:Nb(e),onStart:Nb(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&zt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Uf(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const P0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ob(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const cf={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(We.test(n))n=parseFloat(n);else return n;const t=Ob(n,e.target.x),i=Ob(n,e.target.y);return`${t}% ${i}%`}},sX={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=rl.parse(n);if(r.length>5)return i;const s=rl.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=c;const h=en(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class oX extends oe.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;RK(aX),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),P0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||zt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),II.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function QD(n){const[e,t]=LO(),i=oe.useContext(pI);return T.jsx(oX,{...n,layoutGroup:i,switchLayoutGroup:oe.useContext(UO),isPresent:e,safeToRemove:t})}const aX={borderRadius:{...cf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:cf,borderTopRightRadius:cf,borderBottomLeftRadius:cf,borderBottomRightRadius:cf,boxShadow:sX};function lX(n,e,t){const i=hi(n)?n:Cg(n);return i.start(YI("",i,e,t)),i.animation}function cX(n){return n instanceof SVGElement&&n.tagName!=="svg"}const uX=(n,e)=>n.depth-e.depth;class hX{constructor(){this.children=[],this.isDirty=!1}add(e){FI(this.children,e),this.isDirty=!0}remove(e){jI(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(uX),this.isDirty=!1,this.children.forEach(e)}}function dX(n,e){const t=Fs.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(il(i),n(s-e))};return zt.read(i,!0),()=>il(i)}const ZD=["TopLeft","TopRight","BottomLeft","BottomRight"],fX=ZD.length,Db=n=>typeof n=="string"?parseFloat(n):n,Vb=n=>typeof n=="number"||We.test(n);function gX(n,e,t,i,r,s){r?(n.opacity=en(0,t.opacity!==void 0?t.opacity:1,mX(i)),n.opacityExit=en(e.opacity!==void 0?e.opacity:1,0,pX(i))):s&&(n.opacity=en(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<fX;o++){const a=`border${ZD[o]}Radius`;let c=Fb(e,a),h=Fb(t,a);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||Vb(c)===Vb(h)?(n[a]=Math.max(en(Db(c),Db(h),i),0),(Vs.test(h)||Vs.test(c))&&(n[a]+="%")):n[a]=h}(e.rotate||t.rotate)&&(n.rotate=en(e.rotate||0,t.rotate||0,i))}function Fb(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const mX=JD(0,.5,_D),pX=JD(.5,.95,nr);function JD(n,e,t){return i=>i<n?0:i>e?1:t(qh(n,e,i))}function jb(n,e){n.min=e.min,n.max=e.max}function xr(n,e){jb(n.x,e.x),jb(n.y,e.y)}function Gb(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function Ub(n,e,t,i,r){return n-=e,n=F_(n,1/t,i),r!==void 0&&(n=F_(n,1/r,i)),n}function _X(n,e=0,t=1,i=.5,r,s=n,o=n){if(Vs.test(e)&&(e=parseFloat(e),e=en(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=en(s.min,s.max,i);n===s&&(a-=e),n.min=Ub(n.min,e,t,a,r),n.max=Ub(n.max,e,t,a,r)}function Bb(n,e,[t,i,r],s,o){_X(n,e[t],e[i],e[r],e.scale,s,o)}const yX=["x","scaleX","originX"],vX=["y","scaleY","originY"];function zb(n,e,t,i){Bb(n.x,e,yX,t?t.x:void 0,i?i.x:void 0),Bb(n.y,e,vX,t?t.y:void 0,i?i.y:void 0)}function $b(n){return n.translate===0&&n.scale===1}function e3(n){return $b(n.x)&&$b(n.y)}function Wb(n,e){return n.min===e.min&&n.max===e.max}function EX(n,e){return Wb(n.x,e.x)&&Wb(n.y,e.y)}function Hb(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function t3(n,e){return Hb(n.x,e.x)&&Hb(n.y,e.y)}function Kb(n){return or(n.x)/or(n.y)}function qb(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class wX{constructor(){this.members=[]}add(e){FI(this.members,e),e.scheduleRender()}remove(e){if(jI(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function xX(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:d,rotateX:g,rotateY:m,skewX:y,skewY:w}=t;h&&(i=`perspective(${h}px) ${i}`),d&&(i+=`rotate(${d}deg) `),g&&(i+=`rotateX(${g}deg) `),m&&(i+=`rotateY(${m}deg) `),y&&(i+=`skewX(${y}deg) `),w&&(i+=`skewY(${w}deg) `)}const a=n.x.scale*e.x,c=n.y.scale*e.y;return(a!==1||c!==1)&&(i+=`scale(${a}, ${c})`),i||"none"}const ql={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},If=typeof window<"u"&&window.MotionDebug!==void 0,NE=["","X","Y","Z"],SX={visibility:"hidden"},Yb=1e3;let IX=0;function OE(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function n3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=uD(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",zt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&n3(i)}function i3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e?.()){this.id=IX++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,If&&(ql.totalNodes=ql.resolvedTargetDeltas=ql.recalculatedProjection=0),this.nodes.forEach(AX),this.nodes.forEach(kX),this.nodes.forEach(LX),this.nodes.forEach(PX),If&&window.MotionDebug.record(ql)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new hX)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new GI),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=cX(o),this.instance=o;const{layoutId:c,layout:h,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(h||c)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=dX(m,250),P0.hasAnimatedSinceResize&&(P0.hasAnimatedSinceResize=!1,this.nodes.forEach(Qb))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:y,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||d.getDefaultTransition()||FX,{onLayoutAnimationStart:E,onLayoutAnimationComplete:A}=d.getProps(),b=!this.targetLayout||!t3(this.targetLayout,w)||y,N=!m&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,N);const D={...NI(I,"layout"),onPlay:E,onComplete:A};(d.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D)}else m||Qb(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,il(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(NX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&n3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Xb);return}this.isUpdating||this.nodes.forEach(bX),this.isUpdating=!1,this.nodes.forEach(MX),this.nodes.forEach(TX),this.nodes.forEach(RX),this.clearAllSnapshots();const a=Fs.now();Yn.delta=Oo(0,1e3/60,a-Yn.timestamp),Yn.timestamp=a,Yn.isProcessing=!0,TE.update.process(Yn),TE.preRender.process(Yn),TE.render.process(Yn),Yn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,II.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(CX),this.sharedNodes.forEach(OX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,zt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){zt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=dn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!e3(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&(a||Kl(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),jX(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return dn();const c=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(GX))){const{scroll:d}=this.root;d&&(ch(c.x,d.offset.x),ch(c.y,d.offset.y))}return c}removeElementScroll(o){var a;const c=dn();if(xr(c,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return c;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:g,options:m}=d;d!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&xr(c,o),ch(c.x,g.offset.x),ch(c.y,g.offset.y))}return c}applyTransform(o,a=!1){const c=dn();xr(c,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&uh(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Kl(d.latestValues)&&uh(c,d.latestValues)}return Kl(this.latestValues)&&uh(c,this.latestValues),c}removeTransform(o){const a=dn();xr(a,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!Kl(h.latestValues))continue;cx(h.latestValues)&&h.updateSnapshot();const d=dn(),g=h.measurePageBox();xr(d,g),zb(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Kl(this.latestValues)&&zb(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Yn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==c;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=Yn.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),zf(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),xr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=dn(),this.targetWithTransforms=dn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),zY(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):xr(this.target,this.layout.layoutBox),qD(this.target,this.targetDelta)):xr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),zf(this.relativeTargetOrigin,this.target,y.target),xr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}If&&ql.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||cx(this.parent.latestValues)||KD(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),c=!!this.resumingFrom||this!==a;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===Yn.timestamp&&(h=!1),h)return;const{layout:d,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||g))return;xr(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,y=this.treeScale.y;ZY(this.layoutCorrected,this.treeScale,this.path,c),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=dn());const{target:w}=a;if(!w){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Gb(this.prevProjectionDelta.x,this.projectionDelta.x),Gb(this.prevProjectionDelta.y,this.projectionDelta.y)),Bf(this.projectionDelta,this.layoutCorrected,w,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==y||!qb(this.projectionDelta.x,this.prevProjectionDelta.x)||!qb(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",w)),If&&ql.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=lh(),this.projectionDelta=lh(),this.projectionDeltaWithTransform=lh()}setAnimationOrigin(o,a=!1){const c=this.snapshot,h=c?c.latestValues:{},d={...this.latestValues},g=lh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=dn(),y=c?c.source:void 0,w=this.layout?this.layout.source:void 0,I=y!==w,E=this.getStack(),A=!E||E.members.length<=1,b=!!(I&&!A&&this.options.crossfade===!0&&!this.path.some(VX));this.animationProgress=0;let N;this.mixTargetDelta=D=>{const O=D/1e3;Zb(g.x,o.x,O),Zb(g.y,o.y,O),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(zf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),DX(this.relativeTarget,this.relativeTargetOrigin,m,O),N&&EX(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=dn()),xr(N,this.relativeTarget)),I&&(this.animationValues=d,gX(d,h,this.latestValues,O,b,A)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(il(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=zt.update(()=>{P0.hasAnimatedSinceResize=!0,this.currentAnimation=lX(0,Yb,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Yb),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:h,latestValues:d}=o;if(!(!a||!c||!h)){if(this!==o&&this.layout&&h&&r3(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||dn();const g=or(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+g;const m=or(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+m}xr(a,c),uh(a,d),Bf(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new wX),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const h={};c.z&&OE("z",o,h,this.animationValues);for(let d=0;d<NE.length;d++)OE(`rotate${NE[d]}`,o,h,this.animationValues),OE(`skew${NE[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}getProjectionStyles(o){var a,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return SX;const h={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=R0(o?.pointerEvents)||"",h.transform=d?d(this.latestValues,""):"none",h;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=R0(o?.pointerEvents)||""),this.hasProjected&&!Kl(this.latestValues)&&(I.transform=d?d({},""):"none",this.hasProjected=!1),I}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),h.transform=xX(this.projectionDeltaWithTransform,this.treeScale,m),d&&(h.transform=d(m,h.transform));const{x:y,y:w}=this.projectionDelta;h.transformOrigin=`${y.origin*100}% ${w.origin*100}% 0`,g.animationValues?h.opacity=g===this?(c=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:h.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const I in L_){if(m[I]===void 0)continue;const{correct:E,applyTo:A}=L_[I],b=h.transform==="none"?m[I]:E(m[I],g);if(A){const N=A.length;for(let D=0;D<N;D++)h[A[D]]=b}else h[I]=b}return this.options.layoutId&&(h.pointerEvents=g===this?R0(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(Xb),this.root.sharedNodes.clear()}}}function TX(n){n.updateLayout()}function RX(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Sr(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],y=or(m);m.min=i[g].min,m.max=m.min+y}):r3(s,t.layoutBox,i)&&Sr(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],y=or(i[g]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+y)});const a=lh();Bf(a,i,t.layoutBox);const c=lh();o?Bf(c,n.applyTransform(r,!0),t.measuredBox):Bf(c,i,t.layoutBox);const h=!e3(a);let d=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:y}=g;if(m&&y){const w=dn();zf(w,t.layoutBox,m.layoutBox);const I=dn();zf(I,i,y.layoutBox),t3(w,I)||(d=!0),g.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=w,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:a,hasLayoutChanged:h,hasRelativeTargetChanged:d})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function AX(n){If&&ql.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function PX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function CX(n){n.clearSnapshot()}function Xb(n){n.clearMeasurements()}function bX(n){n.isLayoutDirty=!1}function MX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function Qb(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function kX(n){n.resolveTargetDelta()}function LX(n){n.calcProjection()}function NX(n){n.resetSkewAndRotation()}function OX(n){n.removeLeadSnapshot()}function Zb(n,e,t){n.translate=en(e.translate,0,t),n.scale=en(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function Jb(n,e,t,i){n.min=en(e.min,t.min,i),n.max=en(e.max,t.max,i)}function DX(n,e,t,i){Jb(n.x,e.x,t.x,i),Jb(n.y,e.y,t.y,i)}function VX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const FX={duration:.45,ease:[.4,0,.1,1]},eM=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),tM=eM("applewebkit/")&&!eM("chrome/")?Math.round:nr;function nM(n){n.min=tM(n.min),n.max=tM(n.max)}function jX(n){nM(n.x),nM(n.y)}function r3(n,e,t){return n==="position"||n==="preserve-aspect"&&!BY(Kb(e),Kb(t),.2)}function GX(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const UX=i3({attachResizeListener:(n,e)=>Mg(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),DE={current:void 0},s3=i3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!DE.current){const n=new UX({});n.mount(window),n.setOptions({layoutScroll:!0}),DE.current=n}return DE.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),BX={pan:{Feature:rX},drag:{Feature:iX,ProjectionNode:s3,MeasureLayout:QD}};function iM(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&zt.postRender(()=>s(e,_m(e)))}class zX extends ul{mount(){const{current:e}=this.node;e&&(this.unmount=BK(e,t=>(iM(this.node,t,"Start"),i=>iM(this.node,i,"End"))))}unmount(){}}class $X extends ul{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pm(Mg(this.node.current,"focus",()=>this.onFocus()),Mg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function rM(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&zt.postRender(()=>s(e,_m(e)))}class WX extends ul{mount(){const{current:e}=this.node;e&&(this.unmount=HK(e,t=>(rM(this.node,t,"Start"),(i,{success:r})=>rM(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const hx=new WeakMap,VE=new WeakMap,HX=n=>{const e=hx.get(n.target);e&&e(n)},KX=n=>{n.forEach(HX)};function qX({root:n,...e}){const t=n||document;VE.has(t)||VE.set(t,{});const i=VE.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(KX,{root:n,...e})),i[r]}function YX(n,e,t){const i=qX(e);return hx.set(n,t),i.observe(n),()=>{hx.delete(n),i.unobserve(n)}}const XX={some:0,all:1};class QX extends ul{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:XX[r]},a=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),m=h?d:g;m&&m(c)};return YX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(ZX(e,t))&&this.startObserver()}unmount(){}}function ZX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const JX={inView:{Feature:QX},tap:{Feature:WX},focus:{Feature:$X},hover:{Feature:zX}},eQ={layout:{ProjectionNode:s3,MeasureLayout:QD}},dx={current:null},o3={current:!1};function tQ(){if(o3.current=!0,!!vI)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>dx.current=n.matches;n.addListener(e),e()}else dx.current=!1}const nQ=[...MD,ai,rl],iQ=n=>nQ.find(bD(n)),sM=new WeakMap;function rQ(n,e,t){for(const i in e){const r=e[i],s=t[i];if(hi(r))n.addValue(i,r);else if(hi(s))n.addValue(i,Cg(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,Cg(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const oM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class sQ{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=HI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=Fs.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,zt.render(this.render,!1,!0))};const{latestValues:c,renderState:h,onUpdate:d}=o;this.onUpdate=d,this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=Xy(t),this.isVariantNode=jO(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in m){const w=m[y];c[y]!==void 0&&hi(w)&&w.set(c[y],!1)}}mount(e){this.current=e,sM.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),o3.current||tQ(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:dx.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){sM.delete(this.current),this.projection&&this.projection.unmount(),il(this.notifyUpdate),il(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Kc.has(e),r=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&zt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Yh){const t=Yh[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):dn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<oM.length;i++){const r=oM[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=rQ(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=Cg(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(PD(r)||vD(r))?r=parseFloat(r):!iQ(r)&&rl.test(t)&&(r=TD(e,t)),this.setBaseTarget(e,hi(r)?r.get():r)),hi(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=RI(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!hi(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new GI),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class a3 extends sQ{constructor(){super(...arguments),this.KeyframeResolver=kD}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;hi(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function oQ(n){return window.getComputedStyle(n)}class aQ extends a3{constructor(){super(...arguments),this.type="html",this.renderInstance=qO}readValueFromInstance(e,t){if(Kc.has(t)){const i=WI(t);return i&&i.default||0}else{const i=oQ(e),r=(WO(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return YD(e,t)}build(e,t,i){CI(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return LI(e,t,i)}}class lQ extends a3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=dn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Kc.has(t)){const i=WI(t);return i&&i.default||0}return t=YO.has(t)?t:SI(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return ZO(e,t,i)}build(e,t,i){bI(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){XO(e,t,i,r)}mount(e){this.isSVGTag=kI(e.tagName),super.mount(e)}}const cQ=(n,e)=>TI(n)?new lQ(e):new aQ(e,{allowProjection:n!==oe.Fragment}),uQ=OK({...LY,...JX,...BX,...eQ},cQ),Yt=XH(uQ);const hQ=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),dQ=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),aM=n=>{const e=dQ(n);return e.charAt(0).toUpperCase()+e.slice(1)},l3=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),fQ=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var gQ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mQ=oe.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},c)=>oe.createElement("svg",{ref:c,...gQ,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:l3("lucide",r),...!s&&!fQ(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,d])=>oe.createElement(h,d)),...Array.isArray(s)?s:[s]]));const tt=(n,e)=>{const t=oe.forwardRef(({className:i,...r},s)=>oe.createElement(mQ,{ref:s,iconNode:e,className:l3(`lucide-${hQ(aM(n))}`,`lucide-${n}`,i),...r}));return t.displayName=aM(n),t};const pQ=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],_Q=tt("arrow-left",pQ);const yQ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],vQ=tt("arrow-right",yQ);const EQ=[["path",{d:"M7 17V7h10",key:"11bw93"}],["path",{d:"M17 17 7 7",key:"2786uv"}]],wQ=tt("arrow-up-left",EQ);const xQ=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],SQ=tt("arrow-up-right",xQ);const IQ=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],TQ=tt("arrow-up",IQ);const RQ=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],AQ=tt("check",RQ);const PQ=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],CQ=tt("chevron-down",PQ);const bQ=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],MQ=tt("chevron-left",bQ);const kQ=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],c3=tt("chevron-right",kQ);const LQ=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],u3=tt("chevron-up",LQ);const NQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],OQ=tt("circle-alert",NQ);const DQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],VQ=tt("circle",DQ);const FQ=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],jQ=tt("compass",FQ);const GQ=[["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}],["path",{d:"M9 14 4 9l5-5",key:"102s5s"}]],UQ=tt("corner-up-left",GQ);const BQ=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]],zQ=tt("corner-up-right",BQ);const $Q=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],WQ=tt("download",$Q);const HQ=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],KQ=tt("folder-open",HQ);const qQ=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],YQ=tt("folder",qQ);const XQ=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],QQ=tt("grid-3x3",XQ);const ZQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],JQ=tt("info",ZQ);const eZ=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],kg=tt("layers",eZ);const tZ=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],h3=tt("loader-circle",tZ);const nZ=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],iZ=tt("locate-fixed",nZ);const rZ=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Jy=tt("map-pin",rZ);const sZ=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],d3=tt("map",sZ);const oZ=[["path",{d:"M5 12h14",key:"1ays0h"}]],aZ=tt("minus",oZ);const lZ=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],fx=tt("mountain",lZ);const cZ=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],ev=tt("navigation",cZ);const uZ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],f3=tt("plus",uZ);const hZ=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],gx=tt("rotate-ccw",hZ);const dZ=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],g3=tt("search",dZ);const fZ=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],m3=tt("settings",fZ);const gZ=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],mZ=tt("sliders-horizontal",gZ);const pZ=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],_Z=tt("smartphone",pZ);const yZ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],vZ=tt("target",yZ);const EZ=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],p3=tt("trash-2",EZ);const wZ=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],xZ=tt("tree-palm",wZ);const SZ=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],IZ=tt("type",SZ);const TZ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],RZ=tt("volume-2",TZ);const AZ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],PZ=tt("volume-x",AZ);const CZ=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],bZ=tt("waves",CZ);const MZ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],qc=tt("x",MZ);function kZ(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r,resetFirstFix:s}=Ht(),o=oe.useCallback(c=>{i(c)},[i]),a=oe.useCallback(c=>{console.error("GPS error:",c),alert(`GPS fout: ${c.message}`),t()},[t]);return oe.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const c=navigator.geolocation.watchPosition(o,a,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(c),()=>{navigator.geolocation.clearWatch(c)}},[n,o,a,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function LZ(){const{tracking:n,toggle:e}=kZ();return T.jsx(Yt.button,{className:`
        fixed bottom-[45px] md:bottom-[55px] right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:T.jsx(iZ,{size:22,strokeWidth:2})})}const lM="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
    <polygon points="20,4 32,32 20,26 8,32" fill="#4285F4" stroke="white" stroke-width="2.5" stroke-linejoin="round"/>
  </svg>`);function NZ(){const n=di(E=>E.map),e=di(E=>E.rotation),t=Ht(E=>E.position),i=Ht(E=>E.accuracy),r=Ht(E=>E.tracking),s=Ht(E=>E.smoothHeading),o=zs(E=>E.headingUpMode),a=Ht(E=>E.firstFix),c=Ht(E=>E.resetFirstFix),h=Ht(E=>E.config.centerOnUser),d=Ht(E=>E.config.animationDuration),g=oe.useRef(null),m=oe.useRef(null),y=oe.useRef(null),w=oe.useRef(0),I=oe.useMemo(()=>new Ii({image:new X0({src:lM,scale:1,rotation:0,rotateWithView:!1,anchor:[.5,.5]})}),[]);return oe.useEffect(()=>{if(!n||!r&&!t)return;const E=Ka([5.1214,52.0907]);return g.current=new mc({geometry:new qa(E)}),g.current.setStyle(I),m.current=new mc({geometry:new qa(E)}),y.current=new fy({source:new ay({features:[m.current,g.current]}),zIndex:1e3}),n.addLayer(y.current),()=>{y.current&&n&&n.removeLayer(y.current)}},[n,r,t,I]),oe.useEffect(()=>{if(!n||!t||!g.current||!m.current)return;const E=Ka([t.lng,t.lat]);if(g.current.getGeometry()?.setCoordinates(E),m.current.getGeometry()?.setCoordinates(E),i){const A=n.getView().getResolution()||1,b=i/A;m.current.setStyle(new Ii({image:new Gc({radius:Math.min(b,100),fill:new es({color:"rgba(66, 133, 244, 0.1)"})})}))}a&&r&&(n.getView().setCenter(E),n.getView().setZoom(17),c(),console.log(" GPS locked - jumped to position + street level")),r&&h&&!a&&n.getView().animate({center:E,duration:d})},[n,r,t,i,a,c,h,d]),oe.useEffect(()=>{if(!n||!g.current)return;const A=n.getView().getRotation();let b;o?b=-A:b=s!==null?s*Math.PI/180:0;const N=5*Math.PI/180;let D=b-w.current;D>Math.PI&&(D-=2*Math.PI),D<-Math.PI&&(D+=2*Math.PI),!(Math.abs(D)<N)&&(w.current=b,g.current.setStyle(new Ii({image:new X0({src:lM,scale:1,rotation:b,rotateWithView:!1,anchor:[.5,.5]})})))},[n,o,s,e]),null}function OZ(){const n=Nh(t=>t.themesPanelOpen),e=Nh(t=>t.toggleThemesPanel);return T.jsx(Yt.button,{className:`
        fixed bottom-[100px] md:bottom-[110px] right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:T.jsx(d3,{size:22,strokeWidth:2})})}function DZ(){return T.jsx(OZ,{})}function Kn({title:n,children:e,defaultExpanded:t=!0,layerNames:i}){const[r,s]=oe.useState(t),o=Jn(y=>y.visible),a=Jn(y=>y.setLayerVisibility),c=i?.filter(y=>o[y]).length||0,h=i?.length||0,d=h>0&&c===h,g=c>0&&c<h,m=y=>{if(y.stopPropagation(),!i)return;const w=!d;i.forEach(I=>{a(I,w)})};return T.jsxs("div",{className:"mb-0.5",children:[T.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[T.jsxs("button",{onClick:()=>s(!r),className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",children:[T.jsx(Yt.span,{animate:{rotate:r?90:0},transition:{duration:.15},className:"text-gray-400",children:T.jsx(c3,{size:14})}),r?T.jsx(KQ,{size:16,className:"text-blue-500"}):T.jsx(YQ,{size:16,className:"text-blue-500"}),T.jsx("span",{className:"text-sm text-gray-700 font-medium",children:n}),c>0&&T.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-[10px] font-medium bg-blue-100 text-blue-600 rounded-full",children:c})]}),i&&i.length>0&&T.jsx("button",{onClick:m,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:d?"#3b82f6":g?"#93c5fd":"white",border:d?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(d||g)&&T.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:T.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),T.jsx(Xs,{initial:!1,children:r&&T.jsx(Yt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function ke({name:n,type:e}){const t=Jn(d=>d.visible[n]),i=Jn(d=>d.loadingState[n]),r=Jn(d=>d.toggleLayer),s=Jn(d=>d.setLayerVisibility),o=i==="loading",a=i==="error",c=()=>{o||(e==="overlay"?r(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(g=>{s(g,g===n)}))},h=t??!1;return T.jsxs("button",{onClick:c,disabled:o,className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${o?"opacity-70 cursor-wait bg-transparent":h?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,children:[T.jsxs("span",{className:`text-sm ${a?"text-red-500":"text-gray-600"}`,children:[n,a&&T.jsx(OQ,{size:12,className:"inline ml-1 text-red-500"})]}),T.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:o?"#93c5fd":h?"#3b82f6":"white",border:o?"2px solid #93c5fd":h?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:o?T.jsx(h3,{size:10,strokeWidth:3,className:"animate-spin"}):h?T.jsx(AQ,{size:12,strokeWidth:3}):null})]})}function VZ(){const{themesPanelOpen:n,toggleThemesPanel:e}=Nh();return T.jsx(Xs,{children:n&&T.jsxs(T.Fragment,{children:[T.jsx(Yt.div,{className:"fixed inset-0 z-[998]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),T.jsxs(Yt.div,{className:"fixed top-2.5 right-2.5 z-[999] bg-white rounded-lg shadow-lg overflow-hidden w-[240px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[T.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(kg,{size:14}),T.jsx("span",{className:"font-medium text-sm",children:"Kaartlagen"})]}),T.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none hover:bg-white/20 transition-colors",children:T.jsx(qc,{size:16})})]}),T.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[T.jsx("div",{className:"mb-2 pb-1 border-b border-gray-100",children:T.jsx(ke,{name:"Mijn Vondsten",type:"overlay"})}),T.jsxs(Kn,{title:"Achtergronden",defaultExpanded:!0,children:[T.jsx(ke,{name:"CartoDB (licht)",type:"base"}),T.jsx(ke,{name:"OpenStreetMap",type:"base"}),T.jsx(ke,{name:"Luchtfoto",type:"base"}),T.jsx(ke,{name:"Labels Overlay",type:"overlay"}),T.jsx(ke,{name:"TMK 1850",type:"base"}),T.jsx(ke,{name:"Bonnebladen 1900",type:"base"})]}),T.jsxs(Kn,{title:"Thema's",defaultExpanded:!1,children:[T.jsxs(Kn,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen"],children:[T.jsx(ke,{name:"Hunebedden",type:"overlay"}),T.jsx(ke,{name:"FAMKE Steentijd",type:"overlay"}),T.jsx(ke,{name:"Grafheuvels",type:"overlay"}),T.jsx(ke,{name:"Terpen",type:"overlay"})]}),T.jsxs(Kn,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","Romeinse wegen","IKAW","Archeo Landschappen"],children:[T.jsx(ke,{name:"AMK Monumenten",type:"overlay"}),T.jsx(ke,{name:"Romeinse wegen",type:"overlay"}),T.jsx(ke,{name:"IKAW",type:"overlay"}),T.jsx(ke,{name:"Archeo Landschappen",type:"overlay"})]}),T.jsxs(Kn,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen"],children:[T.jsx(ke,{name:"Rijksmonumenten",type:"overlay"}),T.jsx(ke,{name:"Werelderfgoed",type:"overlay"}),T.jsx(ke,{name:"Religieus Erfgoed",type:"overlay"}),T.jsx(ke,{name:"Kastelen",type:"overlay"})]}),T.jsxs(Kn,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[T.jsx(ke,{name:"WWII Bunkers",type:"overlay"}),T.jsx(ke,{name:"Slagvelden",type:"overlay"}),T.jsx(ke,{name:"Militaire Vliegvelden",type:"overlay"}),T.jsx(ke,{name:"Verdedigingslinies",type:"overlay"}),T.jsx(ke,{name:"Militaire Objecten",type:"overlay"}),T.jsx(ke,{name:"Inundatiegebieden",type:"overlay"})]}),T.jsxs(Kn,{title:"Paleokaarten (tijdreizen)",defaultExpanded:!1,layerNames:["Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr."],children:[T.jsx(ke,{name:"Paleokaart 800 n.Chr.",type:"overlay"}),T.jsx(ke,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),T.jsx(ke,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),T.jsx(ke,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),T.jsx(ke,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),T.jsx(ke,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),T.jsx(ke,{name:"Paleokaart 9000 v.Chr.",type:"overlay"})]}),T.jsxs(Kn,{title:"Uiterwaarden (UIKAV)",defaultExpanded:!1,layerNames:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[T.jsx(ke,{name:"UIKAV Punten",type:"overlay"}),T.jsx(ke,{name:"UIKAV Vlakken",type:"overlay"}),T.jsx(ke,{name:"UIKAV Expert",type:"overlay"}),T.jsx(ke,{name:"UIKAV Buffer",type:"overlay"}),T.jsx(ke,{name:"UIKAV Indeling",type:"overlay"})]}),T.jsxs(Kn,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","World Hillshade"],children:[T.jsx(ke,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),T.jsx(ke,{name:"AHN4 Hillshade NL",type:"overlay"}),T.jsx(ke,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),T.jsx(ke,{name:"AHN 0.5m",type:"overlay"}),T.jsx(ke,{name:"World Hillshade",type:"overlay"})]}),T.jsxs(Kn,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart"],children:[T.jsx(ke,{name:"Veengebieden",type:"overlay"}),T.jsx(ke,{name:"Geomorfologie",type:"overlay"}),T.jsx(ke,{name:"Bodemkaart",type:"overlay"})]}),T.jsxs(Kn,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[T.jsx(ke,{name:"Gewaspercelen",type:"overlay"}),T.jsx(ke,{name:"Kadastrale Grenzen",type:"overlay"})]}),T.jsxs(Kn,{title:"Provinciale Kaarten",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[T.jsxs(Kn,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[T.jsx(ke,{name:"Scheepswrakken",type:"overlay"}),T.jsx(ke,{name:"Woonheuvels ZH",type:"overlay"}),T.jsx(ke,{name:"Romeinse Forten",type:"overlay"}),T.jsx(ke,{name:"Windmolens",type:"overlay"}),T.jsx(ke,{name:"Erfgoedlijnen",type:"overlay"}),T.jsx(ke,{name:"Oude Kernen",type:"overlay"})]}),T.jsxs(Kn,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[T.jsx(ke,{name:"Relictenkaart Punten",type:"overlay"}),T.jsx(ke,{name:"Relictenkaart Lijnen",type:"overlay"}),T.jsx(ke,{name:"Relictenkaart Vlakken",type:"overlay"})]}),T.jsx(Kn,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:T.jsx(ke,{name:"Verdronken Dorpen",type:"overlay"})})]}),T.jsxs(Kn,{title:"Fossielen (vondsten)",defaultExpanded:!1,layerNames:["Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[T.jsx(ke,{name:"Fossielen Nederland",type:"overlay"}),T.jsx(ke,{name:"Fossielen Belgi",type:"overlay"}),T.jsx(ke,{name:"Fossielen Duitsland",type:"overlay"}),T.jsx(ke,{name:"Fossielen Frankrijk",type:"overlay"})]}),T.jsxs(Kn,{title:"Recreatie",defaultExpanded:!1,layerNames:["Parken","Speeltuinen","Musea","Strandjes"],children:[T.jsx(ke,{name:"Parken",type:"overlay"}),T.jsx(ke,{name:"Speeltuinen",type:"overlay"}),T.jsx(ke,{name:"Musea",type:"overlay"}),T.jsx(ke,{name:"Strandjes",type:"overlay"})]})]})]})]})]})})}function FZ(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var Nc=1,Oc=2,Ih=3,jZ=4,mx=5,cM=6378137,GZ=6356752314e-3,uM=.0066943799901413165,$f=484813681109536e-20,pe=Math.PI/2,UZ=.16666666666666666,BZ=.04722222222222222,zZ=.022156084656084655,Se=1e-10,rn=.017453292519943295,Gi=57.29577951308232,wt=Math.PI/4,Lg=Math.PI*2,fn=3.14159265359,Ui={};Ui.greenwich=0;Ui.lisbon=-9.131906111111;Ui.paris=2.337229166667;Ui.bogota=-74.080916666667;Ui.madrid=-3.687938888889;Ui.rome=12.452333333333;Ui.bern=7.439583333333;Ui.jakarta=106.807719444444;Ui.ferro=-17.666666666667;Ui.brussels=4.367975;Ui.stockholm=18.058277777778;Ui.athens=23.7163375;Ui.oslo=10.722916666667;const $Z={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var hM=/[\s_\-\/\(\)]/g;function sl(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(hM,""),r=-1,s,o;++r<t.length;)if(s=t[r],o=s.toLowerCase().replace(hM,""),o===i)return n[s]}function px(n){var e={},t=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,c){var h=c.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),i,r,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*rn},lat_1:function(a){e.lat1=a*rn},lat_2:function(a){e.lat2=a*rn},lat_ts:function(a){e.lat_ts=a*rn},lon_0:function(a){e.long0=a*rn},lon_1:function(a){e.long1=a*rn},lon_2:function(a){e.long2=a*rn},alpha:function(a){e.alpha=parseFloat(a)*rn},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*rn},lonc:function(a){e.longc=a*rn},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(c){return parseFloat(c)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var c=sl($Z,a);c&&(e.to_meter=c.to_meter)},from_greenwich:function(a){e.from_greenwich=a*rn},pm:function(a){var c=sl(Ui,a);e.from_greenwich=(c||parseFloat(a))*rn},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var c="ewnsud";a.length===3&&c.indexOf(a.substr(0,1))!==-1&&c.indexOf(a.substr(1,1))!==-1&&c.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(i in t)r=t[i],i in o?(s=o[i],typeof s=="function"?s(r):e[s]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class _3{static getId(e){const t=e.find(i=>Array.isArray(i)&&i[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const i=e[1],r=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:i,conversion_factor:r,id:o}}static convertAxis(e){const t=e[1]||"Unknown";let i;const r=t.match(/^\((.)\)$/);if(r){const h=r[1].toUpperCase();if(h==="E")i="east";else if(h==="N")i="north";else if(h==="U")i="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else i=e[2]?e[2].toLowerCase():"unknown";const s=e.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),c=this.convertUnit(a);return{name:t,direction:i,unit:c,order:o}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,i)=>(t.order||0)-(i.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const i=e.find(m=>Array.isArray(m)&&m[0]==="CS");i&&(t.coordinate_system={type:i[1],axis:this.extractAxes(e)});const r=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(r){const m=this.convertUnit(r);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const y=e.find(w=>Array.isArray(w)&&w[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(m.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const o=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");o&&(t.accuracy=parseFloat(o[1]));const a=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");a&&(t.ellipsoid=this.convert(a)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const c=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(c){const m=c.find(y=>Array.isArray(y));t.source_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(h){const m=h.find(y=>Array.isArray(y));t.target_crs=m?this.convert(m):null}const d=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");d?t.transformation=this.convert(d):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class WZ extends _3{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class HZ extends _3{static convert(e,t={}){super.convert(e,t);const i=e.find(s=>Array.isArray(s)&&s[0]==="CS");i&&(t.coordinate_system={subtype:i[1],axis:this.extractAxes(e)});const r=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(r){const s=r.find(c=>Array.isArray(c)&&c[0]==="SCOPE"),o=r.find(c=>Array.isArray(c)&&c[0]==="AREA"),a=r.find(c=>Array.isArray(c)&&c[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),o&&(t.usage.area=o[1]),a&&(t.usage.bbox=a.slice(1))}return t}}function KZ(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function qZ(n){return(KZ(n)==="2019"?HZ:WZ).convert(n)}function YZ(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Ng=1,y3=2,v3=3,j_=4,E3=5,XI=-1,XZ=/\s/,QZ=/[A-Za-z]/,ZZ=/[A-Za-z84_]/,tv=/[,\]]/,w3=/[\d\.E\-\+]/;function jo(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Ng}jo.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==j_)for(;XZ.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Ng:return this.neutral(n);case y3:return this.keyword(n);case j_:return this.quoted(n);case E3:return this.afterquote(n);case v3:return this.number(n);case XI:return}};jo.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=j_;return}if(tv.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};jo.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Ng;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Ng,this.currentObject=this.stack.pop(),this.currentObject||(this.state=XI);return}};jo.prototype.number=function(n){if(w3.test(n)){this.word+=n;return}if(tv.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};jo.prototype.quoted=function(n){if(n==='"'){this.state=E3;return}this.word+=n};jo.prototype.keyword=function(n){if(ZZ.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Ng;return}if(tv.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};jo.prototype.neutral=function(n){if(QZ.test(n)){this.word=n,this.state=y3;return}if(n==='"'){this.word="",this.state=j_;return}if(w3.test(n)){this.word=n,this.state=v3;return}if(tv.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};jo.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===XI)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function JZ(n){var e=new jo(n);return e.output()}function FE(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(s,o){return hh(o,s),s},i);e&&(n[e]=r)}function hh(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},hh(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&hh(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&hh(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],FE(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],FE(e,t,n),e[t].type=t;return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return hh(n,e[t]);return FE(e,t,n)}}var eJ=.017453292519943295;function Hr(n){return n*eJ}function x3(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Hr(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Hr(n.lat0>0?90:-90),delete n.lat1)}function dM(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function fM(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function gM(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=fM(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-fM(n.ellipsoid.semi_minor_axis))))}function G_(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(G_(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const i=n[t];if(i!==null)switch(t){case"name":if(e.srsCode)break;e.name=i,e.srsCode=i;break;case"type":i==="GeographicCRS"?e.projName="longlat":i==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(e.ellps=i.ellipsoid.name,gM(i,e)),i.prime_meridian&&(e.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=i.name,gM(i,e);break;case"prime_meridian":e.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis){if(e.axis=i.axis.map(r=>{const s=r.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",i.unit){const{units:r,to_meter:s}=dM(i.unit);e.units=r,e.to_meter=s}else if(i.axis[0]&&i.axis[0].unit){const{units:r,to_meter:s}=dM(i.axis[0].unit);e.units=r,e.to_meter=s}}break;case"id":i.authority&&i.code&&(e.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(e.projName=i.method.name),i.parameters&&i.parameters.forEach(r=>{const s=r.name.toLowerCase().replace(/\s+/g,"_"),o=r.value;r.unit&&r.unit.conversion_factor?e[s]=o*r.unit.conversion_factor:r.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":i.name&&(e.units=i.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),i.conversion_factor&&(e.to_meter=i.conversion_factor);break;case"base_crs":G_(i,e),e.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),x3(e),e)}var tJ=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function nJ(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function S3(n){for(var e=Object.keys(n),t=0,i=e.length;t<i;++t){var r=e[t];tJ.indexOf(r)!==-1&&iJ(n[r]),typeof n[r]=="object"&&S3(n[r])}}function iJ(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",i=0,r=n.AXIS.length;i<r;++i){var s=[n.AXIS[i][0].toLowerCase(),n.AXIS[i][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var o=n.GEOGCS;n.type==="GEOGCS"&&(o=n),o&&(o.DATUM?n.datumCode=o.DATUM.name.toLowerCase():n.datumCode=o.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(n.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=o.DATUM.SPHEROID.a,n.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(n.datum_params=o.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Hr(n.rectified_grid_angle));function a(d){var g=n.to_meter||1;return d*g}var c=function(d){return nJ(n,d)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Hr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Hr],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Hr],["lat0","latitude_of_origin",Hr],["lat0","standard_parallel_1",Hr],["lat1","standard_parallel_1",Hr],["lat2","standard_parallel_2",Hr],["azimuth","Azimuth"],["alpha","azimuth",Hr],["srsCode","name"]];h.forEach(c),x3(n)}function U_(n){if(typeof n=="object")return G_(n);const e=YZ(n);var t=JZ(n);if(e==="WKT2"){const s=qZ(t);return G_(s)}var i=t[0],r={};return hh(t,r),S3(r),r[i]}function qn(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?qn[n]=px(arguments[1]):qn[n]=U_(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?qn[n]=U_(arguments[1]):(qn[n]=t,t||delete qn[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){return Array.isArray(i)?qn.apply(e,i):qn(i)});if(typeof n=="string"){if(n in qn)return qn[n]}else"EPSG"in n?qn["EPSG:"+n.EPSG]=n:"ESRI"in n?qn["ESRI:"+n.ESRI]=n:"IAU2000"in n?qn["IAU2000:"+n.IAU2000]=n:console.log(n);return}}FZ(qn);function rJ(n){return typeof n=="string"}function sJ(n){return n in qn}function oJ(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var aJ=["3857","900913","3785","102113"];function lJ(n){var e=sl(n,"authority");if(e){var t=sl(e,"epsg");return t&&aJ.indexOf(t)>-1}}function cJ(n){var e=sl(n,"extension");if(e)return sl(e,"proj4")}function uJ(n){return n[0]==="+"}function hJ(n){if(rJ(n)){if(sJ(n))return qn[n];if(oJ(n)){var e=U_(n);if(lJ(e))return qn["EPSG:3857"];var t=cJ(e);return t?px(t):e}if(uJ(n))return px(n)}else return"projName"in n?n:U_(n)}function mM(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function $s(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function ym(n){return n<0?-1:1}function Ae(n,e){return e||Math.abs(n)<=fn?n:n-ym(n)*Lg}function Jr(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(pe-e))/i}function Og(n,e){for(var t=.5*n,i,r,s=pe-2*Math.atan(e),o=0;o<=15;o++)if(i=n*Math.sin(s),r=pe-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-s,s+=r,Math.abs(r)<=1e-10)return s;return-9999}function dJ(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=$s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function fJ(n){var e=n.x,t=n.y;if(t*Gi>90&&t*Gi<-90&&e*Gi>180&&e*Gi<-180)return null;var i,r;if(Math.abs(Math.abs(t)-pe)<=Se)return null;if(this.sphere)i=this.x0+this.a*this.k0*Ae(e-this.long0,this.over),r=this.y0+this.a*this.k0*Math.log(Math.tan(wt+.5*t));else{var s=Math.sin(t),o=Jr(this.e,t,s);i=this.x0+this.a*this.k0*Ae(e-this.long0,this.over),r=this.y0-this.a*this.k0*Math.log(o)}return n.x=i,n.y=r,n}function gJ(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=pe-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(r=Og(this.e,s),r===-9999)return null}return i=Ae(this.long0+e/(this.a*this.k0),this.over),n.x=i,n.y=r,n}var mJ=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const pJ={init:dJ,forward:fJ,inverse:gJ,names:mJ};function _J(){}function pM(n){return n}var I3=["longlat","identity"];const yJ={init:_J,forward:pM,inverse:pM,names:I3};var vJ=[pJ,yJ],Yl={},dh=[];function T3(n,e){var t=dh.length;return n.names?(dh[t]=n,n.names.forEach(function(i){Yl[i.toLowerCase()]=t}),this):(console.log(e),!0)}function R3(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function EJ(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Yl[e]<"u"&&dh[Yl[e]]||(e=R3(e),e in Yl&&dh[Yl[e]]))return dh[Yl[e]]}function wJ(){vJ.forEach(T3)}const xJ={start:wJ,add:T3,get:EJ};var A3={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const SJ=A3.WGS84;function IJ(n,e,t,i){var r=n*n,s=e*e,o=(r-s)/r,a=0;i?(n*=1-o*(UZ+o*(BZ+o*zZ)),r=n*n,o=0):a=Math.sqrt(o);var c=(r-s)/s;return{es:o,e:a,ep2:c}}function TJ(n,e,t,i,r){if(!n){var s=sl(A3,i);s||(s=SJ),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<Se)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var C0={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var RJ in C0){var jE=C0[RJ];jE.datumName&&(C0[jE.datumName]=jE)}function AJ(n,e,t,i,r,s,o){var a={};return n===void 0||n==="none"?a.datum_type=mx:a.datum_type=jZ,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=Nc),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=Oc,a.datum_params[3]*=$f,a.datum_params[4]*=$f,a.datum_params[5]*=$f,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=Ih,a.grids=o),a.a=t,a.b=i,a.es=r,a.ep2=s,a}var QI={};function PJ(n,e,t){return e instanceof ArrayBuffer?CJ(n,e,t):{ready:bJ(n,e)}}function CJ(n,e,t){var i=!0;t!==void 0&&t.includeErrorFields===!1&&(i=!1);var r=new DataView(e),s=LJ(r),o=NJ(r,s),a=OJ(r,o,s,i),c={header:o,subgrids:a};return QI[n]=c,c}async function bJ(n,e){for(var t=[],i=await e.getImageCount(),r=i-1;r>=0;r--){var s=await e.getImage(r),o=await s.readRasters(),a=o,c=[s.getWidth(),s.getHeight()],h=s.getBoundingBox().map(_M),d=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(_M),g=h[0]+(c[0]-1)*d[0],m=h[3]-(c[1]-1)*d[1],y=a[0],w=a[1],I=[];for(let b=c[1]-1;b>=0;b--)for(let N=c[0]-1;N>=0;N--){var E=b*c[0]+N;I.push([-Oa(w[E]),Oa(y[E])])}t.push({del:d,lim:c,ll:[-g,m],cvs:I})}var A={header:{nSubgrids:i},subgrids:t};return QI[n]=A,A}function MJ(n){if(n===void 0)return null;var e=n.split(",");return e.map(kJ)}function kJ(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:QI[n]||null,isNull:!1}}function _M(n){return n*Math.PI/180}function Oa(n){return n/3600*Math.PI/180}function LJ(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function NJ(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:_x(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function _x(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function OJ(n,e,t,i){for(var r=176,s=[],o=0;o<e.nSubgrids;o++){var a=VJ(n,r,t),c=FJ(n,r,a,t,i),h=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),d=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[Oa(a.lowerLongitude),Oa(a.lowerLatitude)],del:[Oa(a.longitudeInterval),Oa(a.latitudeInterval)],lim:[h,d],count:a.gridNodeCount,cvs:DJ(c)});var g=16;i===!1&&(g=8),r+=176+a.gridNodeCount*g}return s}function DJ(n){return n.map(function(e){return[Oa(e.longitudeShift),Oa(e.latitudeShift)]})}function VJ(n,e,t){return{name:_x(n,e+8,e+16).trim(),parent:_x(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function FJ(n,e,t,i,r){var s=e+176,o=16;r===!1&&(o=8);for(var a=[],c=0;c<t.gridNodeCount;c++){var h={latitudeShift:n.getFloat32(s+c*o,i),longitudeShift:n.getFloat32(s+c*o+4,i)};r!==!1&&(h.latitudeAccuracy=n.getFloat32(s+c*o+8,i),h.longitudeAccuracy=n.getFloat32(s+c*o+12,i)),a.push(h)}return a}function Lr(n,e){if(!(this instanceof Lr))return new Lr(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(h){if(h)throw h};var t=hJ(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var i=Lr.projections.get(t.projName);if(!i){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var r=sl(C0,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=TJ(t.a,t.b,t.rf,t.ellps,t.sphere),o=IJ(s.a,s.b,s.rf,t.R_A),a=MJ(t.nadgrids),c=t.datum||AJ(t.datumCode,t.datum_params,s.a,s.b,o.es,o.ep2,a);mM(this,t),mM(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=c,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Lr.projections=xJ;Lr.projections.start();function jJ(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===Nc?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===Oc?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function P3(n,e,t){var i=n.x,r=n.y,s=n.z?n.z:0,o,a,c,h;if(r<-pe&&r>-1.001*pe)r=-pe;else if(r>pe&&r<1.001*pe)r=pe;else{if(r<-pe)return{x:-1/0,y:-1/0,z:n.z};if(r>pe)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(r),h=Math.cos(r),c=a*a,o=t/Math.sqrt(1-e*c),{x:(o+s)*h*Math.cos(i),y:(o+s)*h*Math.sin(i),z:(o*(1-e)+s)*a}}function C3(n,e,t,i){var r=1e-12,s=r*r,o=30,a,c,h,d,g,m,y,w,I,E,A,b,N,D=n.x,O=n.y,$=n.z?n.z:0,k,C,L;if(a=Math.sqrt(D*D+O*O),c=Math.sqrt(D*D+O*O+$*$),a/t<r){if(k=0,c/t<r)return C=pe,L=-i,{x:n.x,y:n.y,z:n.z}}else k=Math.atan2(O,D);h=$/c,d=a/c,g=1/Math.sqrt(1-e*(2-e)*d*d),w=d*(1-e)*g,I=h*g,N=0;do N++,y=t/Math.sqrt(1-e*I*I),L=a*w+$*I-y*(1-e*I*I),m=e*y/(y+L),g=1/Math.sqrt(1-m*(2-m)*d*d),E=d*(1-m)*g,A=h*g,b=A*w-E*I,w=E,I=A;while(b*b>s&&N<o);return C=Math.atan(A/Math.abs(E)),{x:k,y:C,z:L}}function GJ(n,e,t){if(e===Nc)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===Oc){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=t[5],h=t[6];return{x:h*(n.x-c*n.y+a*n.z)+i,y:h*(c*n.x+n.y-o*n.z)+r,z:h*(-a*n.x+o*n.y+n.z)+s}}}function UJ(n,e,t){if(e===Nc)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===Oc){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=t[5],h=t[6],d=(n.x-i)/h,g=(n.y-r)/h,m=(n.z-s)/h;return{x:d+c*g-a*m,y:-c*d+g+o*m,z:a*d-o*g+m}}}function i0(n){return n===Nc||n===Oc}function BJ(n,e,t){if(jJ(n,e)||n.datum_type===mx||e.datum_type===mx)return t;var i=n.a,r=n.es;if(n.datum_type===Ih){var s=yM(n,!1,t);if(s!==0)return;i=cM,r=uM}var o=e.a,a=e.b,c=e.es;if(e.datum_type===Ih&&(o=cM,a=GZ,c=uM),r===c&&i===o&&!i0(n.datum_type)&&!i0(e.datum_type))return t;if(t=P3(t,r,i),i0(n.datum_type)&&(t=GJ(t,n.datum_type,n.datum_params)),i0(e.datum_type)&&(t=UJ(t,e.datum_type,e.datum_params)),t=C3(t,c,o,a),e.datum_type===Ih){var h=yM(e,!0,t);if(h!==0)return}return t}function yM(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var c=a.grid.subgrids,h=0,d=c.length;h<d;h++){var g=c[h],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,y=g.ll[0]-m,w=g.ll[1]-m,I=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,E=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(w>i.y||y>i.x||E<i.y||I<i.x)&&(r=zJ(i,e,g),!isNaN(r.x)))break e}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*Gi+" "+i.y*Gi+" tried: '"+s+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function zJ(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=Ae(r.x-Math.PI)+Math.PI;var s=vM(r,t);if(e){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o=9,a=1e-12,c,h;do{if(h=vM(s,t),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}c={x:r.x-(h.x+s.x),y:r.y-(h.y+s.y)},s.x+=c.x,s.y+=c.y}while(o--&&Math.abs(c.x)>a&&Math.abs(c.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=Ae(s.x+t.ll[0]),i.y=s.y+t.ll[1]}else isNaN(s.x)||(i.x=n.x+s.x,i.y=n.y+s.y);return i}function vM(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},s={x:Number.NaN,y:Number.NaN},o;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return s;o=i.y*e.lim[0]+i.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var c={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var h={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var d={x:e.cvs[o][0],y:e.cvs[o][1]},g=r.x*r.y,m=r.x*(1-r.y),y=(1-r.x)*(1-r.y),w=(1-r.x)*r.y;return s.x=y*a.x+m*c.x+w*d.x+g*h.x,s.y=y*a.y+m*c.y+w*d.y+g*h.y,s}function EM(n,e,t){var i=t.x,r=t.y,s=t.z||0,o,a,c,h={};for(c=0;c<3;c++)if(!(e&&c===2&&t.z===void 0))switch(c===0?(o=i,"ew".indexOf(n.axis[c])!==-1?a="x":a="y"):c===1?(o=r,"ns".indexOf(n.axis[c])!==-1?a="y":a="x"):(o=s,a="z"),n.axis[c]){case"e":h[a]=o;break;case"w":h[a]=-o;break;case"n":h[a]=o;break;case"s":h[a]=-o;break;case"u":t[a]!==void 0&&(h.z=o);break;case"d":t[a]!==void 0&&(h.z=-o);break;default:return null}return h}function b3(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function $J(n){wM(n.x),wM(n.y)}function wM(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function WJ(n,e){return(n.datum.datum_type===Nc||n.datum.datum_type===Oc||n.datum.datum_type===Ih)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Nc||e.datum.datum_type===Oc||e.datum.datum_type===Ih)&&n.datumCode!=="WGS84"}function B_(n,e,t,i){var r;Array.isArray(t)?t=b3(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if($J(t),n.datum&&e.datum&&WJ(n,e)&&(r=new Lr("WGS84"),t=B_(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=EM(n,!1,t)),n.projName==="longlat")t={x:t.x*rn,y:t.y*rn,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=BJ(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Gi,y:t.y*Gi,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?EM(e,!0,t):(t&&!s&&delete t.z,t)}var xM=Lr("WGS84");function GE(n,e,t,i){var r,s,o;return Array.isArray(t)?(r=B_(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.slice(3)):[r.x,r.y,t[2]].concat(t.slice(3)):[r.x,r.y].concat(t.slice(2)):[r.x,r.y]):(s=B_(n,e,t,i),o=Object.keys(t),o.length===2||o.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=t[a]}),s)}function r0(n){return n instanceof Lr?n:typeof n=="object"&&"oProj"in n?n.oProj:Lr(n)}function HJ(n,e,t){var i,r,s=!1,o;return typeof e>"u"?(r=r0(n),i=xM,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,r=r0(n),i=xM,s=!0),i||(i=r0(n)),r||(r=r0(e)),t?GE(i,r,t):(o={forward:function(a,c){return GE(i,r,a,c)},inverse:function(a,c){return GE(r,i,a,c)}},s&&(o.oProj=r),o)}var SM=6,M3="AJSAJS",k3="AFAFAF",fh=65,ki=73,Ir=79,Tf=86,Rf=90;const KJ={forward:L3,inverse:qJ,toPoint:N3};function L3(n,e){return e=e||5,QJ(YJ({lat:n[1],lon:n[0]}),e)}function qJ(n){var e=ZI(D3(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function N3(n){var e=ZI(D3(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function UE(n){return n*(Math.PI/180)}function IM(n){return 180*(n/Math.PI)}function YJ(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,s=.9996,o,a,c,h,d,g,m,y=UE(e),w=UE(t),I,E;E=Math.floor((t+180)/6)+1,t===180&&(E=60),e>=56&&e<64&&t>=3&&t<12&&(E=32),e>=72&&e<84&&(t>=0&&t<9?E=31:t>=9&&t<21?E=33:t>=21&&t<33?E=35:t>=33&&t<42&&(E=37)),o=(E-1)*6-180+3,I=UE(o),a=r/(1-r),c=i/Math.sqrt(1-r*Math.sin(y)*Math.sin(y)),h=Math.tan(y)*Math.tan(y),d=a*Math.cos(y)*Math.cos(y),g=Math.cos(y)*(w-I),m=i*((1-r/4-3*r*r/64-5*r*r*r/256)*y-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*y)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*y)-35*r*r*r/3072*Math.sin(6*y));var A=s*c*(g+(1-h+d)*g*g*g/6+(5-18*h+h*h+72*d-58*a)*g*g*g*g*g/120)+5e5,b=s*(m+c*Math.tan(y)*(g*g/2+(5-h+9*d+4*d*d)*g*g*g*g/24+(61-58*h+h*h+600*d-330*a)*g*g*g*g*g*g/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(A),zoneNumber:E,zoneLetter:XJ(e)}}function ZI(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var s=.9996,o=6378137,a=.00669438,c,h=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),d,g,m,y,w,I,E,A,b,N=t-5e5,D=e;i<"N"&&(D-=1e7),E=(r-1)*6-180+3,c=a/(1-a),I=D/s,A=I/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),b=A+(3*h/2-27*h*h*h/32)*Math.sin(2*A)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*A)+151*h*h*h/96*Math.sin(6*A),d=o/Math.sqrt(1-a*Math.sin(b)*Math.sin(b)),g=Math.tan(b)*Math.tan(b),m=c*Math.cos(b)*Math.cos(b),y=o*(1-a)/Math.pow(1-a*Math.sin(b)*Math.sin(b),1.5),w=N/(d*s);var O=b-d*Math.tan(b)/y*(w*w/2-(5+3*g+10*m-4*m*m-9*c)*w*w*w*w/24+(61+90*g+298*m+45*g*g-252*c-3*m*m)*w*w*w*w*w*w/720);O=IM(O);var $=(w-(1+2*g+m)*w*w*w/6+(5-2*m+28*g-3*m*m+8*c+24*g*g)*w*w*w*w*w/120)/Math.cos(b);$=E+IM($);var k;if(n.accuracy){var C=ZI({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});k={top:C.lat,right:C.lon,bottom:O,left:$}}else k={lat:O,lon:$};return k}function XJ(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function QJ(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+ZJ(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function ZJ(n,e,t){var i=O3(t),r=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return JJ(r,s,i)}function O3(n){var e=n%SM;return e===0&&(e=SM),e}function JJ(n,e,t){var i=t-1,r=M3.charCodeAt(i),s=k3.charCodeAt(i),o=r+n-1,a=s+e,c=!1;o>Rf&&(o=o-Rf+fh-1,c=!0),(o===ki||r<ki&&o>ki||(o>ki||r<ki)&&c)&&o++,(o===Ir||r<Ir&&o>Ir||(o>Ir||r<Ir)&&c)&&(o++,o===ki&&o++),o>Rf&&(o=o-Rf+fh-1),a>Tf?(a=a-Tf+fh-1,c=!0):c=!1,(a===ki||s<ki&&a>ki||(a>ki||s<ki)&&c)&&a++,(a===Ir||s<Ir&&a>Ir||(a>Ir||s<Ir)&&c)&&(a++,a===ki&&a++),a>Tf&&(a=a-Tf+fh-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function D3(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,s=0;!/[A-Z]/.test(r=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,s++}var o=parseInt(i,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;t=n.substring(s,s+=2);for(var c=O3(o),h=eee(t.charAt(0),c),d=tee(t.charAt(1),c);d<nee(a);)d+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,y=0,w=0,I,E,A,b,N;return m>0&&(I=1e5/Math.pow(10,m),E=n.substring(s,s+m),y=parseFloat(E)*I,A=n.substring(s+m),w=parseFloat(A)*I),b=y+h,N=w+d,{easting:b,northing:N,zoneLetter:a,zoneNumber:o,accuracy:I}}function eee(n,e){for(var t=M3.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===ki&&t++,t===Ir&&t++,t>Rf){if(r)throw"Bad character: "+n;t=fh,r=!0}i+=1e5}return i}function tee(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=k3.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===ki&&t++,t===Ir&&t++,t>Tf){if(r)throw"Bad character: "+n;t=fh,r=!0}i+=1e5}return i}function nee(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function Qh(n,e,t){if(!(this instanceof Qh))return new Qh(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var i=n.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Qh.fromMGRS=function(n){return new Qh(N3(n))};Qh.prototype.toMGRS=function(n){return L3([this.x,this.y],n)};var iee=1,ree=.25,TM=.046875,RM=.01953125,AM=.01068115234375,see=.75,oee=.46875,aee=.013020833333333334,lee=.007120768229166667,cee=.3645833333333333,uee=.005696614583333333,hee=.3076171875;function JI(n){var e=[];e[0]=iee-n*(ree+n*(TM+n*(RM+n*AM))),e[1]=n*(see-n*(TM+n*(RM+n*AM)));var t=n*n;return e[2]=t*(oee-n*(aee+n*lee)),t*=n,e[3]=t*(cee-n*uee),e[4]=t*n*hee,e}function ld(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var dee=20;function eT(n,e,t){for(var i=1/(1-e),r=n,s=dee;s;--s){var o=Math.sin(r),a=1-e*o*o;if(a=(ld(r,o,Math.cos(r),t)-n)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<Se)return r}return r}function fee(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=JI(this.es),this.ml0=ld(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function gee(n){var e=n.x,t=n.y,i=Ae(e-this.long0,this.over),r,s,o,a=Math.sin(t),c=Math.cos(t);if(this.es){var d=c*i,g=Math.pow(d,2),m=this.ep2*Math.pow(c,2),y=Math.pow(m,2),w=Math.abs(c)>Se?Math.tan(t):0,I=Math.pow(w,2),E=Math.pow(I,2);r=1-this.es*Math.pow(a,2),d=d/Math.sqrt(r);var A=ld(t,a,c,this.en);s=this.a*(this.k0*d*(1+g/6*(1-I+m+g/20*(5-18*I+E+14*m-58*I*m+g/42*(61+179*E-E*I-479*I)))))+this.x0,o=this.a*(this.k0*(A-this.ml0+a*i*d/2*(1+g/12*(5-I+9*m+4*y+g/30*(61+E-58*I+270*m-330*I*m+g/56*(1385+543*E-E*I-3111*I))))))+this.y0}else{var h=c*Math.sin(i);if(Math.abs(Math.abs(h)-1)<Se)return 93;if(s=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=c*Math.cos(i)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>Se)return 93;o=0}else o=Math.acos(o);t<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return n.x=s,n.y=o,n}function mee(n){var e,t,i,r,s=(n.x-this.x0)*(1/this.a),o=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,t=eT(e,this.es,this.en),Math.abs(t)<pe){var g=Math.sin(t),m=Math.cos(t),y=Math.abs(m)>Se?Math.tan(t):0,w=this.ep2*Math.pow(m,2),I=Math.pow(w,2),E=Math.pow(y,2),A=Math.pow(E,2);e=1-this.es*Math.pow(g,2);var b=s*Math.sqrt(e)/this.k0,N=Math.pow(b,2);e=e*y,i=t-e*N/(1-this.es)*.5*(1-N/12*(5+3*E-9*w*E+w-4*I-N/30*(61+90*E-252*w*E+45*A+46*w-N/56*(1385+3633*E+4095*A+1574*A*E)))),r=Ae(this.long0+b*(1-N/6*(1+2*E+w-N/20*(5+28*E+24*A+8*w*E+6*w-N/42*(61+662*E+1320*A+720*A*E))))/m,this.over)}else i=pe*ym(o),r=0;else{var a=Math.exp(s/this.k0),c=.5*(a-1/a),h=this.lat0+o/this.k0,d=Math.cos(h);e=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(c,2))),i=Math.asin(e),o<0&&(i=-i),c===0&&d===0?r=0:r=Ae(Math.atan2(c,d)+this.long0,this.over)}return n.x=r,n.y=i,n}var pee=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const b0={init:fee,forward:gee,inverse:mee,names:pee};function V3(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Vi(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function _ee(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function yee(n){var e=Math.abs(n);return e=_ee(e*(1+e/(Vi(1,e)+1))),n<0?-e:e}function tT(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return e+o*Math.sin(2*e)}function vee(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return Math.sin(e)*o}function Eee(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function F3(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),s=V3(t),o=Eee(t),a=2*r*o,c=-2*i*s,h=n.length-1,d=n[h],g=0,m=0,y=0,w,I;--h>=0;)w=m,I=g,m=d,g=y,d=-w+a*m-c*g+n[h],y=-I+c*m+a*g;return a=i*o,c=r*s,[a*d-c*y,a*y+c*d]}function wee(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(b0.init.apply(this),this.forward=b0.forward,this.inverse=b0.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=tT(this.cbg,this.lat0);this.Zb=-this.Qn*(i+vee(this.gtu,2*i))}function xee(n){var e=Ae(n.x-this.long0,this.over),t=n.y;t=tT(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),s=Math.sin(e),o=Math.cos(e);t=Math.atan2(i,o*r),e=Math.atan2(s*r,Vi(i,r*o)),e=yee(Math.tan(e));var a=F3(this.gtu,2*t,2*e);t=t+a[0],e=e+a[1];var c,h;return Math.abs(e)<=2.623395162778?(c=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*t+this.Zb)+this.y0):(c=1/0,h=1/0),n.x=c,n.y=h,n}function See(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var s=F3(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(V3(e));var o=Math.sin(t),a=Math.cos(t),c=Math.sin(e),h=Math.cos(e);t=Math.atan2(o*h,Vi(c,h*a)),e=Math.atan2(c,h*a),i=Ae(e+this.long0,this.over),r=tT(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var Iee=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const M0={init:wee,forward:xee,inverse:See,names:Iee};function Tee(n,e){if(n===void 0){if(n=Math.floor((Ae(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var Ree="etmerc";function Aee(){var n=Tee(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*rn,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,M0.init.apply(this),this.forward=M0.forward,this.inverse=M0.inverse}var Pee=["Universal Transverse Mercator System","utm"];const Cee={init:Aee,names:Pee,dependsOn:Ree};function nT(n,e){return Math.pow((1-n)/(1+n),e)}var bee=20;function Mee(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+wt)/(Math.pow(Math.tan(.5*this.lat0+wt),this.C)*nT(this.e*n,this.ratexp))}function kee(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+wt),this.C)*nT(this.e*Math.sin(t),this.ratexp))-pe,n.x=this.C*e,n}function Lee(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+wt)/this.K,1/this.C),s=bee;s>0&&(i=2*Math.atan(r*nT(this.e*Math.sin(n.y),-.5*this.e))-pe,!(Math.abs(i-n.y)<e));--s)n.y=i;return s?(n.x=t,n.y=i,n):null}const iT={init:Mee,forward:kee,inverse:Lee};function Nee(){iT.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Oee(n){var e,t,i,r;return n.x=Ae(n.x-this.long0,this.over),iT.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Dee(n){var e,t,i,r,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Vi(n.x,n.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),t=Math.cos(o),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),i=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,iT.inverse.apply(this,[n]),n.x=Ae(n.x+this.long0,this.over),n}var Vee=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Fee={init:Nee,forward:Oee,inverse:Dee,names:Vee};function rT(n,e,t){return e*=t,Math.tan(.5*(pe+n))*Math.pow((1-e)/(1+e),.5*t)}function jee(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Se&&(this.k0=.5*(1+ym(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Se&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Se&&Math.abs(Math.cos(this.lat_ts))>Se&&(this.k0=.5*this.cons*$s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Jr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=$s(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(rT(this.lat0,this.sinlat0,this.e))-pe,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Gee(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),s,o,a,c,h,d,g=Ae(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=Se&&Math.abs(t+this.lat0)<=Se?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(g)),n.x=this.a*s*r*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*i-this.sinlat0*r*Math.cos(g))+this.y0,n):(o=2*Math.atan(rT(t,i,this.e))-pe,c=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=Se?(h=Jr(this.e,t*this.con,this.con*i),d=2*this.a*this.k0*h/this.cons,n.x=this.x0+d*Math.sin(e-this.long0),n.y=this.y0-this.con*d*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<Se?(s=2*this.a*this.k0/(1+c*Math.cos(g)),n.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*c*Math.cos(g))),n.y=s*(this.cosX0*a-this.sinX0*c*Math.cos(g))+this.y0),n.x=s*c*Math.sin(g)+this.x0,n))}function Uee(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,t=this.lat0,o<=Se?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(a)*this.sinlat0+n.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<Se?this.lat0>0?e=Ae(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=Ae(this.long0+Math.atan2(n.x,n.y),this.over):e=Ae(this.long0+Math.atan2(n.x*Math.sin(a),o*this.coslat0*Math.cos(a)-n.y*this.sinlat0*Math.sin(a)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=Se){if(o<=Se)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=o*this.cons/(2*this.a*this.k0),t=this.con*Og(this.e,i),e=this.con*Ae(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=Se?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/o),e=Ae(this.long0+Math.atan2(n.x*Math.sin(r),o*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)),this.over)),t=-1*Og(this.e,Math.tan(.5*(pe+s)));return n.x=e,n.y=t,n}var Bee=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const zee={init:jee,forward:Gee,inverse:Uee,names:Bee,ssfn_:rT};function $ee(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,s=2*r-Math.pow(r,2),o=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),c=Math.log(Math.tan(Math.PI/4+n/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*c+this.alpha*o/2*h}function Wee(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,n.x=this.R*o+this.x0,n}function Hee(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,c=0,h=s,d=-1e3,g=0;Math.abs(h-d)>1e-7;){if(++g>20)return;c=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),d=h,h=2*Math.atan(Math.exp(c))-Math.PI/2}return n.x=a,n.y=h,n}var Kee=["somerc"];const qee={init:$ee,forward:Wee,inverse:Hee,names:Kee};var nh=1e-7;function Yee(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(R3(t))!==-1}function Xee(){var n,e,t,i,r,s,o,a,c,h,d=0,g,m=0,y=0,w=0,I=0,E=0,A=0;this.no_off=Yee(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var N=!1;if("rectified_grid_angle"in this&&(N=!0),b&&(A=this.alpha),N&&(d=this.rectified_grid_angle),b||N)m=this.longc;else if(y=this.long1,I=this.lat1,w=this.long2,E=this.lat2,Math.abs(I-E)<=nh||(n=Math.abs(I))<=nh||Math.abs(n-pe)<=nh||Math.abs(Math.abs(this.lat0)-pe)<=nh||Math.abs(Math.abs(E)-pe)<=nh)throw new Error;var D=1-this.es;e=Math.sqrt(D),Math.abs(this.lat0)>Se?(a=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*a*a,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/D),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Jr(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),b||N?(b?(g=Math.asin(Math.sin(A)/i),N||(d=A)):(g=d,A=Math.asin(i*Math.sin(g))),this.lam0=m-Math.asin(.5*(r-1/r)*Math.tan(g))/this.B):(s=Math.pow(Jr(this.e,I,Math.sin(I)),this.B),o=Math.pow(Jr(this.e,E,Math.sin(E)),this.B),r=this.E/s,c=(o-s)/(o+s),h=this.E*this.E,h=(h-o*s)/(h+o*s),n=y-w,n<-Math.PI?w-=Lg:n>Math.PI&&(w+=Lg),this.lam0=Ae(.5*(y+w)-Math.atan(h*Math.tan(.5*this.B*(y-w))/c)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*Ae(y-this.lam0,this.over))/(r-1/r)),d=A=Math.asin(i*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(A))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(wt-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(wt+r))}function Qee(n){var e={},t,i,r,s,o,a,c,h;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-pe)>Se){if(o=this.E/Math.pow(Jr(this.e,n.y,Math.sin(n.y)),this.B),a=1/o,t=.5*(o-a),i=.5*(o+a),s=Math.sin(this.B*n.x),r=(t*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(r)-1)<Se)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),a=Math.cos(this.B*n.x),Math.abs(a)<nh?c=this.A*n.x:c=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,a)}else h=n.y>0?this.v_pole_n:this.v_pole_s,c=this.ArB*n.y;return this.no_rot?(e.x=c,e.y=h):(c-=this.u_0,e.x=h*this.cosrot+c*this.sinrot,e.y=c*this.cosrot-h*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Zee(n){var e,t,i,r,s,o,a,c={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),s=.5*(i+1/i),o=Math.sin(this.BrA*e),a=(o*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<Se)c.x=0,c.y=a<0?-pe:pe;else{if(c.y=this.E/Math.sqrt((1+a)/(1-a)),c.y=Og(this.e,Math.pow(c.y,1/this.B)),c.y===1/0)throw new Error;c.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return c.x+=this.lam0,c}var Jee=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const ete={init:Xee,forward:Qee,inverse:Zee,names:Jee};function tte(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Se)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=$s(this.e,e,t),r=Jr(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=$s(this.e,s,o),c=Jr(this.e,this.lat2,s),h=Math.abs(Math.abs(this.lat0)-pe)<Se?0:Jr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Se?this.ns=Math.log(i/a)/Math.log(r/c):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function nte(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=Se&&(t=ym(t)*(pe-2*Se));var i=Math.abs(Math.abs(t)-pe),r,s;if(i>Se)r=Jr(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;s=0}var o=this.ns*Ae(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(o))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,n}function ite(n){var e,t,i,r,s,o=(n.x-this.x0)/this.k0,a=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),t=1):(e=-Math.sqrt(o*o+a*a),t=-1);var c=0;if(e!==0&&(c=Math.atan2(t*o,t*a)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=Og(this.e,i),r===-9999)return null}else r=-pe;return s=Ae(c/this.ns+this.long0,this.over),n.x=s,n.y=r,n}var rte=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const ste={init:tte,forward:nte,inverse:ite,names:rte};function ote(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function ate(n){var e,t,i,r,s,o,a,c=n.x,h=n.y,d=Ae(c-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),i=-d*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),s=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=a*Math.cos(o)/1,n.x=a*Math.sin(o)/1,this.czech||(n.y*=-1,n.x*=-1),n}function lte(n){var e,t,i,r,s,o,a,c,h=n.x;n.x=n.y,n.y=h,this.czech||(n.y*=-1,n.x*=-1),o=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),r=s/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,a=e,c=0;var d=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-n.y)<1e-10&&(c=1),a=n.y,d+=1;while(c===0&&d<15);return d>=15?null:n}var cte=["Krovak","krovak"];const ute={init:ote,forward:ate,inverse:lte,names:cte};function Si(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function vm(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Em(n){return .375*n*(1+.25*n*(1+.46875*n))}function wm(n){return .05859375*n*n*(1+.75*n)}function xm(n){return n*n*n*(35/3072)}function sT(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function hl(n){return Math.abs(n)<pe?n:n-ym(n)*Math.PI}function z_(n,e,t,i,r){var s,o;s=n/e;for(var a=0;a<15;a++)if(o=(n-(e*s-t*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function hte(){this.sphere||(this.e0=vm(this.es),this.e1=Em(this.es),this.e2=wm(this.es),this.e3=xm(this.es),this.ml0=this.a*Si(this.e0,this.e1,this.e2,this.e3,this.lat0))}function dte(n){var e,t,i=n.x,r=n.y;if(i=Ae(i-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=sT(this.a,this.e,s),c=Math.tan(r)*Math.tan(r),h=i*Math.cos(r),d=h*h,g=this.es*o*o/(1-this.es),m=this.a*Si(this.e0,this.e1,this.e2,this.e3,r);e=a*h*(1-d*c*(1/6-(8-c+8*g)*d/120)),t=m-this.ml0+a*s/o*d*(.5+(5-c+6*g)*d/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function fte(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var s=t+this.lat0;i=Math.asin(Math.sin(s)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+t,a=z_(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-pe)<=Se)return n.x=this.long0,n.y=pe,t<0&&(n.y*=-1),n;var c=sT(this.a,this.e,Math.sin(a)),h=c*c*c/this.a/this.a*(1-this.es),d=Math.pow(Math.tan(a),2),g=e*this.a/c,m=g*g;i=a-c*Math.tan(a)/h*g*g*(.5-(1+3*d)*g*g/24),r=g*(1-m*(d/3+(1+3*d)*d*m/15))/Math.cos(a)}return n.x=Ae(r+this.long0,this.over),n.y=hl(i),n}var gte=["Cassini","Cassini_Soldner","cass"];const mte={init:hte,forward:dte,inverse:fte,names:gte};function Wa(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var yx=1,vx=2,Ex=3,k0=4;function pte(){var n=Math.abs(this.lat0);if(Math.abs(n-pe)<Se?this.mode=this.lat0<0?yx:vx:Math.abs(n)<Se?this.mode=Ex:this.mode=k0,this.es>0){var e;switch(this.qp=Wa(this.e,1),this.mmf=.5/(1-this.es),this.apa=Tte(this.es),this.mode){case vx:this.dd=1;break;case yx:this.dd=1;break;case Ex:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case k0:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Wa(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===k0&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function _te(n){var e,t,i,r,s,o,a,c,h,d,g=n.x,m=n.y;if(g=Ae(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),d=Math.cos(m),i=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+d*i:1+this.sinph0*s+this.cosph0*d*i,t<=Se)return null;t=Math.sqrt(2/t),e=t*d*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*d*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(m+this.lat0)<Se)return null;t=wt-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=i}}else{switch(a=0,c=0,h=0,i=Math.cos(g),r=Math.sin(g),s=Math.sin(m),o=Wa(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,c=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*c*i;break;case this.EQUIT:h=1+c*i;break;case this.N_POLE:h=pe+m,o=this.qp-o;break;case this.S_POLE:h=m-pe,o=this.qp+o;break}if(Math.abs(h)<Se)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?t=this.ymf*h*(this.cosb1*a-this.sinb1*c*i):t=(h=Math.sqrt(2/(1+c*i)))*a*this.ymf,e=this.xmf*h*c*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*r,t=i*(this.mode===this.S_POLE?h:-h)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function yte(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,s,o,a,c,h;if(this.sphere){var d=0,g,m=0;if(g=Math.sqrt(e*e+t*t),r=g*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(g)<=Se?0:Math.asin(t*m/g),e*=m,t=d*g;break;case this.OBLIQ:r=Math.abs(g)<=Se?this.lat0:Math.asin(d*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(d-Math.sin(r)*this.sinph0)*g;break;case this.N_POLE:t=-t,r=pe-r;break;case this.S_POLE:r-=pe;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,c=Math.sqrt(e*e+t*t),c<Se)return n.x=this.long0,n.y=this.lat0,n;o=2*Math.asin(.5*c/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(h=s*this.sinb1+t*o*this.cosb1/c,a=this.qp*h,t=c*this.cosb1*s-t*this.sinb1*o):(h=t*o/c,a=this.qp*h,t=c*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),a=e*e+t*t,!a)return n.x=this.long0,n.y=this.lat0,n;h=1-a/this.qp,this.mode===this.S_POLE&&(h=-h)}i=Math.atan2(e,t),r=Rte(Math.asin(h),this.apa)}return n.x=Ae(this.long0+i,this.over),n.y=r,n}var vte=.3333333333333333,Ete=.17222222222222222,wte=.10257936507936508,xte=.06388888888888888,Ste=.0664021164021164,Ite=.016415012942191543;function Tte(n){var e,t=[];return t[0]=n*vte,e=n*n,t[0]+=e*Ete,t[1]=e*xte,e*=n,t[0]+=e*wte,t[1]+=e*Ste,t[2]=e*Ite,t}function Rte(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Ate=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Pte={init:pte,forward:_te,inverse:yte,names:Ate,S_POLE:yx,N_POLE:vx,EQUIT:Ex,OBLIQ:k0};function ol(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Cte(){Math.abs(this.lat1+this.lat2)<Se||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=$s(this.e3,this.sin_po,this.cos_po),this.qs1=Wa(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=$s(this.e3,this.sin_po,this.cos_po),this.qs2=Wa(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Wa(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Se?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function bte(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=Wa(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*Ae(e-this.long0,this.over),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return n.x=o,n.y=a,n}function Mte(n){var e,t,i,r,s,o;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,t)),s=Ae(r/this.ns0+this.long0,this.over),n.x=s,n.y=o,n}function kte(n,e){var t,i,r,s,o,a=ol(.5*e);if(n<Se)return a;for(var c=n*n,h=1;h<=25;h++)if(t=Math.sin(a),i=Math.cos(a),r=n*t,s=1-r*r,o=.5*s*s/i*(e/(1-c)-t/s+.5/n*Math.log((1-r)/(1+r))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var Lte=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Nte={init:Cte,forward:bte,inverse:Mte,names:Lte,phi1z:kte};function Ote(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Dte(n){var e,t,i,r,s,o,a,c,h=n.x,d=n.y;return i=Ae(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,o>0||Math.abs(o)<=Se?(a=this.x0+this.a*s*t*Math.sin(i)/o,c=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)/o):(a=this.x0+this.infinity_dist*t*Math.sin(i),c=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=c,n}function Vte(n){var e,t,i,r,s,o;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),o=ol(i*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),s=Ae(this.long0+s,this.over)):(o=this.phic0,s=0),n.x=s,n.y=o,n}var Fte=["gnom"];const jte={init:Ote,forward:Dte,inverse:Vte,names:Fte};function Gte(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*pe:pe;for(var i=Math.asin(.5*e),r,s,o,a,c=0;c<30;c++)if(s=Math.sin(i),o=Math.cos(i),a=n*s,r=Math.pow(1-a*a,2)/(2*o)*(e/(1-n*n)-s/(1-a*a)+.5/n*Math.log((1-a)/(1+a))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function Ute(){this.sphere||(this.k0=$s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Bte(n){var e=n.x,t=n.y,i,r,s=Ae(e-this.long0,this.over);if(this.sphere)i=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var o=Wa(this.e,Math.sin(t));i=this.x0+this.a*this.k0*s,r=this.y0+this.a*o*.5/this.k0}return n.x=i,n.y=r,n}function zte(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=Ae(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=Gte(this.e,2*n.y*this.k0/this.a),e=Ae(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var $te=["cea"];const Wte={init:Ute,forward:Bte,inverse:zte,names:$te};function Hte(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Kte(n){var e=n.x,t=n.y,i=Ae(e-this.long0,this.over),r=hl(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function qte(n){var e=n.x,t=n.y;return n.x=Ae(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=hl(this.lat0+(t-this.y0)/this.a),n}var Yte=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Xte={init:Hte,forward:Kte,inverse:qte,names:Yte};var PM=20;function Qte(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=vm(this.es),this.e1=Em(this.es),this.e2=wm(this.es),this.e3=xm(this.es),this.ml0=this.a*Si(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Zte(n){var e=n.x,t=n.y,i,r,s,o=Ae(e-this.long0,this.over);if(s=o*Math.sin(t),this.sphere)Math.abs(t)<=Se?(i=this.a*o,r=-1*this.a*this.lat0):(i=this.a*Math.sin(s)/Math.tan(t),r=this.a*(hl(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=Se)i=this.a*o,r=-1*this.ml0;else{var a=sT(this.a,this.e,Math.sin(t))/Math.tan(t);i=a*Math.sin(s),r=this.a*Si(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+a*(1-Math.cos(s))}return n.x=i+this.x0,n.y=r+this.y0,n}function Jte(n){var e,t,i,r,s,o,a,c,h;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=Se)e=Ae(i/this.a+this.long0,this.over),t=0;else{o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,c=o;var d;for(s=PM;s;--s)if(d=Math.tan(c),h=-1*(o*(c*d+1)-c-.5*(c*c+a)*d)/((c-o)/d-1),c+=h,Math.abs(h)<=Se){t=c;break}e=Ae(this.long0+Math.asin(i*Math.tan(c)/this.a)/Math.sin(t),this.over)}else if(Math.abs(r+this.ml0)<=Se)t=0,e=Ae(this.long0+i/this.a,this.over);else{o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,c=o;var g,m,y,w,I;for(s=PM;s;--s)if(I=this.e*Math.sin(c),g=Math.sqrt(1-I*I)*Math.tan(c),m=this.a*Si(this.e0,this.e1,this.e2,this.e3,c),y=this.e0-2*this.e1*Math.cos(2*c)+4*this.e2*Math.cos(4*c)-6*this.e3*Math.cos(6*c),w=m/this.a,h=(o*(g*w+1)-w-.5*g*(w*w+a))/(this.es*Math.sin(2*c)*(w*w+a-2*o*w)/(4*g)+(o-w)*(g*y-2/Math.sin(2*c))-y),c-=h,Math.abs(h)<=Se){t=c;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=Ae(this.long0+Math.asin(i*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var ene=["Polyconic","American_Polyconic","poly"];const tne={init:Qte,forward:Zte,inverse:Jte,names:ene};function nne(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function ine(n){var e,t=n.x,i=n.y,r=i-this.lat0,s=t-this.long0,o=r/$f*1e-5,a=s,c=1,h=0;for(e=1;e<=10;e++)c=c*o,h=h+this.A[e]*c;var d=h,g=a,m=1,y=0,w,I,E=0,A=0;for(e=1;e<=6;e++)w=m*d-y*g,I=y*d+m*g,m=w,y=I,E=E+this.B_re[e]*m-this.B_im[e]*y,A=A+this.B_im[e]*m+this.B_re[e]*y;return n.x=A*this.a+this.x0,n.y=E*this.a+this.y0,n}function rne(n){var e,t=n.x,i=n.y,r=t-this.x0,s=i-this.y0,o=s/this.a,a=r/this.a,c=1,h=0,d,g,m=0,y=0;for(e=1;e<=6;e++)d=c*o-h*a,g=h*o+c*a,c=d,h=g,m=m+this.C_re[e]*c-this.C_im[e]*h,y=y+this.C_im[e]*c+this.C_re[e]*h;for(var w=0;w<this.iterations;w++){var I=m,E=y,A,b,N=o,D=a;for(e=2;e<=6;e++)A=I*m-E*y,b=E*m+I*y,I=A,E=b,N=N+(e-1)*(this.B_re[e]*I-this.B_im[e]*E),D=D+(e-1)*(this.B_im[e]*I+this.B_re[e]*E);I=1,E=0;var O=this.B_re[1],$=this.B_im[1];for(e=2;e<=6;e++)A=I*m-E*y,b=E*m+I*y,I=A,E=b,O=O+e*(this.B_re[e]*I-this.B_im[e]*E),$=$+e*(this.B_im[e]*I+this.B_re[e]*E);var k=O*O+$*$;m=(N*O+D*$)/k,y=(D*O-N*$)/k}var C=m,L=y,j=1,G=0;for(e=1;e<=9;e++)j=j*C,G=G+this.D[e]*j;var z=this.lat0+G*$f*1e5,V=this.long0+L;return n.x=V,n.y=z,n}var sne=["New_Zealand_Map_Grid","nzmg"];const one={init:nne,forward:ine,inverse:rne,names:sne};function ane(){}function lne(n){var e=n.x,t=n.y,i=Ae(e-this.long0,this.over),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=s,n}function cne(n){n.x-=this.x0,n.y-=this.y0;var e=Ae(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var une=["Miller_Cylindrical","mill"];const hne={init:ane,forward:lne,inverse:cne,names:une};var dne=20;function fne(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=JI(this.es)}function gne(n){var e,t,i=n.x,r=n.y;if(i=Ae(i-this.long0,this.over),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var s=this.n*Math.sin(r),o=dne;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<Se)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var c=Math.sin(r),h=Math.cos(r);t=this.a*ld(r,c,h,this.en),e=this.a*i*h/Math.sqrt(1-this.es*c*c)}return n.x=e,n.y=t,n}function mne(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=ol((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=ol(Math.sin(e)/this.n)),i=Ae(i+this.long0,this.over),e=hl(e)):(e=eT(n.y/this.a,this.es,this.en),r=Math.abs(e),r<pe?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=Ae(t,this.over)):r-Se<pe&&(i=this.long0)),n.x=i,n.y=e,n}var pne=["Sinusoidal","sinu"];const _ne={init:fne,forward:gne,inverse:mne,names:pne};function yne(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function vne(n){for(var e=n.x,t=n.y,i=Ae(e-this.long0,this.over),r=t,s=Math.PI*Math.sin(t);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<Se)break}r/=2,Math.PI/2-Math.abs(t)<Se&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,c=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=a,n.y=c,n}function Ene(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=Ae(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var wne=["Mollweide","moll"];const xne={init:yne,forward:vne,inverse:Ene,names:wne};function Sne(){Math.abs(this.lat1+this.lat2)<Se||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=vm(this.es),this.e1=Em(this.es),this.e2=wm(this.es),this.e3=xm(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=$s(this.e,this.sin_phi,this.cos_phi),this.ml1=Si(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Se?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=$s(this.e,this.sin_phi,this.cos_phi),this.ml2=Si(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Si(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Ine(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=Si(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var s=this.ns*Ae(e-this.long0,this.over),o=this.x0+i*Math.sin(s),a=this.y0+this.rh-i*Math.cos(s);return n.x=o,n.y=a,n}function Tne(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=Ae(this.long0+s/this.ns,this.over),i=hl(this.g-t/this.a),n.x=r,n.y=i,n;var o=this.g-t/this.a;return i=z_(o,this.e0,this.e1,this.e2,this.e3),r=Ae(this.long0+s/this.ns,this.over),n.x=r,n.y=i,n}var Rne=["Equidistant_Conic","eqdc"];const Ane={init:Sne,forward:Ine,inverse:Tne,names:Rne};function Pne(){this.R=this.a}function Cne(n){var e=n.x,t=n.y,i=Ae(e-this.long0,this.over),r,s;Math.abs(t)<=Se&&(r=this.x0+this.R*i,s=this.y0);var o=ol(2*Math.abs(t/Math.PI));(Math.abs(i)<=Se||Math.abs(Math.abs(t)-pe)<=Se)&&(r=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/i-i/Math.PI),c=a*a,h=Math.sin(o),d=Math.cos(o),g=d/(h+d-1),m=g*g,y=g*(2/h-1),w=y*y,I=Math.PI*this.R*(a*(g-w)+Math.sqrt(c*(g-w)*(g-w)-(w+c)*(m-w)))/(w+c);i<0&&(I=-I),r=this.x0+I;var E=c+g;return I=Math.PI*this.R*(y*E-a*Math.sqrt((w+c)*(c+1)-E*E))/(w+c),t>=0?s=this.y0+I:s=this.y0-I,n.x=r,n.y=s,n}function bne(n){var e,t,i,r,s,o,a,c,h,d,g,m,y;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,i=n.x/g,r=n.y/g,s=i*i+r*r,o=-Math.abs(r)*(1+s),a=o-2*r*r+i*i,c=-2*o+1+2*r*r+s*s,y=r*r/c+(2*a*a*a/c/c/c-9*o*a/c/c)/27,h=(o-a*a/3/c)/c,d=2*Math.sqrt(-h/3),g=3*y/h/d,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-d*Math.cos(m+Math.PI/3)-a/3/c)*Math.PI:t=-(-d*Math.cos(m+Math.PI/3)-a/3/c)*Math.PI,Math.abs(i)<Se?e=this.long0:e=Ae(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i,this.over),n.x=e,n.y=t,n}var Mne=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const kne={init:Pne,forward:Cne,inverse:bne,names:Mne};function Lne(n,e,t,i,r,s){const o=i-e,a=Math.atan((1-s)*Math.tan(n)),c=Math.atan((1-s)*Math.tan(t)),h=Math.sin(a),d=Math.cos(a),g=Math.sin(c),m=Math.cos(c);let y=o,w,I=100,E,A,b,N,D,O,$,k,C,L,j,G,z,V;do{if(E=Math.sin(y),A=Math.cos(y),b=Math.sqrt(m*E*(m*E)+(d*g-h*m*A)*(d*g-h*m*A)),b===0)return{azi1:0,s12:0};N=h*g+d*m*A,D=Math.atan2(b,N),O=d*m*E/b,$=1-O*O,k=$!==0?N-2*h*g/$:0,C=s/16*$*(4+s*(4-3*$)),w=y,y=o+(1-C)*s*O*(D+C*b*(k+C*N*(-1+2*k*k)))}while(Math.abs(y-w)>1e-12&&--I>0);return I===0?{azi1:NaN,s12:NaN}:(L=$*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),j=1+L/16384*(4096+L*(-768+L*(320-175*L))),G=L/1024*(256+L*(-128+L*(74-47*L))),z=G*b*(k+G/4*(N*(-1+2*k*k)-G/6*k*(-3+4*b*b)*(-3+4*k*k))),V=r*(1-s)*j*(D-z),{azi1:Math.atan2(m*E,d*g-h*m*A),s12:V})}function Nne(n,e,t,i,r,s){const o=Math.atan((1-s)*Math.tan(n)),a=Math.sin(o),c=Math.cos(o),h=Math.sin(t),d=Math.cos(t),g=Math.atan2(a,c*d),m=c*h,y=1-m*m,w=y*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),I=1+w/16384*(4096+w*(-768+w*(320-175*w))),E=w/1024*(256+w*(-128+w*(74-47*w)));let A=i/(r*(1-s)*I),b,N=100,D,O,$,k;do D=Math.cos(2*g+A),O=Math.sin(A),$=Math.cos(A),k=E*O*(D+E/4*($*(-1+2*D*D)-E/6*D*(-3+4*O*O)*(-3+4*D*D))),b=A,A=i/(r*(1-s)*I)+k;while(Math.abs(A-b)>1e-12&&--N>0);if(N===0)return{lat2:NaN,lon2:NaN};const C=a*O-c*$*d,L=Math.atan2(a*$+c*O*d,(1-s)*Math.sqrt(m*m+C*C)),j=Math.atan2(O*h,c*$-a*O*d),G=s/16*y*(4+s*(4-3*y)),z=j-(1-G)*s*m*(A+G*O*(D+G*$*(-1+2*D*D))),V=e+z;return{lat2:L,lon2:V}}function One(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Dne(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),s=Ae(e-this.long0,this.over),o,a,c,h,d,g,m,y,w,I,E;return this.sphere?Math.abs(this.sin_p12-1)<=Se?(n.x=this.x0+this.a*(pe-t)*Math.sin(s),n.y=this.y0-this.a*(pe-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=Se?(n.x=this.x0+this.a*(pe+t)*Math.sin(s),n.y=this.y0+this.a*(pe+t)*Math.cos(s),n):(w=this.sin_p12*i+this.cos_p12*r*Math.cos(s),m=Math.acos(w),y=m?m/Math.sin(m):1,n.x=this.x0+this.a*y*r*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*i-this.sin_p12*r*Math.cos(s)),n):(o=vm(this.es),a=Em(this.es),c=wm(this.es),h=xm(this.es),Math.abs(this.sin_p12-1)<=Se?(d=this.a*Si(o,a,c,h,pe),g=this.a*Si(o,a,c,h,t),n.x=this.x0+(d-g)*Math.sin(s),n.y=this.y0-(d-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=Se?(d=this.a*Si(o,a,c,h,pe),g=this.a*Si(o,a,c,h,t),n.x=this.x0+(d+g)*Math.sin(s),n.y=this.y0+(d+g)*Math.cos(s),n):Math.abs(e)<Se&&Math.abs(t-this.lat0)<Se?(n.x=n.y=0,n):(I=Lne(this.lat0,this.long0,t,e,this.a,this.f),E=I.azi1,n.x=I.s12*Math.sin(E),n.y=I.s12*Math.cos(E),n))}function Vne(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o,a,c,h,d,g,m,y,w,I,E;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*pe*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),s=this.long0,Math.abs(e)<=Se?o=this.lat0:(o=ol(r*this.sin_p12+n.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-pe,Math.abs(a)<=Se?this.lat0>=0?s=Ae(this.long0+Math.atan2(n.x,-n.y),this.over):s=Ae(this.long0-Math.atan2(-n.x,n.y),this.over):s=Ae(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i),this.over)),n.x=s,n.y=o,n)):(c=vm(this.es),h=Em(this.es),d=wm(this.es),g=xm(this.es),Math.abs(this.sin_p12-1)<=Se?(m=this.a*Si(c,h,d,g,pe),e=Math.sqrt(n.x*n.x+n.y*n.y),y=m-e,o=z_(y/this.a,c,h,d,g),s=Ae(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=o,n):Math.abs(this.sin_p12+1)<=Se?(m=this.a*Si(c,h,d,g,pe),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-m,o=z_(y/this.a,c,h,d,g),s=Ae(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=o,n):(w=Math.atan2(n.x,n.y),I=Math.sqrt(n.x*n.x+n.y*n.y),E=Nne(this.lat0,this.long0,w,I,this.a,this.f),n.x=E.lon2,n.y=E.lat2,n))}var Fne=["Azimuthal_Equidistant","aeqd"];const jne={init:One,forward:Dne,inverse:Vne,names:Fne};function Gne(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Une(n){var e,t,i,r,s,o,a,c,h=n.x,d=n.y;return i=Ae(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,(o>0||Math.abs(o)<=Se)&&(a=this.a*s*t*Math.sin(i),c=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=c,n}function Bne(n){var e,t,i,r,s,o,a;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=ol(e/this.a),i=Math.sin(t),r=Math.cos(t),o=this.long0,Math.abs(e)<=Se?(a=this.lat0,n.x=o,n.y=a,n):(a=ol(r*this.sin_p14+n.y*i*this.cos_p14/e),s=Math.abs(this.lat0)-pe,Math.abs(s)<=Se?(this.lat0>=0?o=Ae(this.long0+Math.atan2(n.x,-n.y),this.over):o=Ae(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=o,n.y=a,n):(o=Ae(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i),this.over),n.x=o,n.y=a,n))}var zne=["ortho"];const $ne={init:Gne,forward:Une,inverse:Bne,names:zne};var Zt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},xt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Wne(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=pe-wt/2?this.face=Zt.TOP:this.lat0<=-(pe-wt/2)?this.face=Zt.BOTTOM:Math.abs(this.long0)<=wt?this.face=Zt.FRONT:Math.abs(this.long0)<=pe+wt?this.face=this.long0>0?Zt.RIGHT:Zt.LEFT:this.face=Zt.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Hne(n){var e={x:0,y:0},t,i,r,s,o,a,c={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===Zt.TOP)s=pe-t,i>=wt&&i<=pe+wt?(c.value=xt.AREA_0,r=i-pe):i>pe+wt||i<=-(pe+wt)?(c.value=xt.AREA_1,r=i>0?i-fn:i+fn):i>-(pe+wt)&&i<=-wt?(c.value=xt.AREA_2,r=i+pe):(c.value=xt.AREA_3,r=i);else if(this.face===Zt.BOTTOM)s=pe+t,i>=wt&&i<=pe+wt?(c.value=xt.AREA_0,r=-i+pe):i<wt&&i>=-wt?(c.value=xt.AREA_1,r=-i):i<-wt&&i>=-(pe+wt)?(c.value=xt.AREA_2,r=-i-pe):(c.value=xt.AREA_3,r=i>0?-i+fn:-i-fn);else{var h,d,g,m,y,w,I;this.face===Zt.RIGHT?i=Th(i,+pe):this.face===Zt.BACK?i=Th(i,+fn):this.face===Zt.LEFT&&(i=Th(i,-pe)),m=Math.sin(t),y=Math.cos(t),w=Math.sin(i),I=Math.cos(i),h=y*I,d=y*w,g=m,this.face===Zt.FRONT?(s=Math.acos(h),r=s0(s,g,d,c)):this.face===Zt.RIGHT?(s=Math.acos(d),r=s0(s,g,-h,c)):this.face===Zt.BACK?(s=Math.acos(-h),r=s0(s,g,-d,c)):this.face===Zt.LEFT?(s=Math.acos(-d),r=s0(s,g,h,c)):(s=r=0,c.value=xt.AREA_0)}return a=Math.atan(12/fn*(r+Math.acos(Math.sin(r)*Math.cos(wt))-pe)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),c.value===xt.AREA_1?a+=pe:c.value===xt.AREA_2?a+=fn:c.value===xt.AREA_3&&(a+=1.5*fn),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function Kne(n){var e={lam:0,phi:0},t,i,r,s,o,a,c,h,d,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=xt.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=xt.AREA_1,t-=pe):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=xt.AREA_2,t=t<0?t+fn:t-fn):(g.value=xt.AREA_3,t+=pe),d=fn/12*Math.tan(t),o=Math.sin(d)/(Math.cos(d)-1/Math.sqrt(2)),a=Math.atan(o),r=Math.cos(t),s=Math.tan(i),c=1-r*r*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),c<-1?c=-1:c>1&&(c=1),this.face===Zt.TOP)h=Math.acos(c),e.phi=pe-h,g.value===xt.AREA_0?e.lam=a+pe:g.value===xt.AREA_1?e.lam=a<0?a+fn:a-fn:g.value===xt.AREA_2?e.lam=a-pe:e.lam=a;else if(this.face===Zt.BOTTOM)h=Math.acos(c),e.phi=h-pe,g.value===xt.AREA_0?e.lam=-a+pe:g.value===xt.AREA_1?e.lam=-a:g.value===xt.AREA_2?e.lam=-a-pe:e.lam=a<0?-a-fn:-a+fn;else{var m,y,w;m=c,d=m*m,d>=1?w=0:w=Math.sqrt(1-d)*Math.sin(a),d+=w*w,d>=1?y=0:y=Math.sqrt(1-d),g.value===xt.AREA_1?(d=y,y=-w,w=d):g.value===xt.AREA_2?(y=-y,w=-w):g.value===xt.AREA_3&&(d=y,y=w,w=-d),this.face===Zt.RIGHT?(d=m,m=-y,y=d):this.face===Zt.BACK?(m=-m,y=-y):this.face===Zt.LEFT&&(d=m,m=y,y=-d),e.phi=Math.acos(-w)-pe,e.lam=Math.atan2(y,m),this.face===Zt.RIGHT?e.lam=Th(e.lam,-pe):this.face===Zt.BACK?e.lam=Th(e.lam,-fn):this.face===Zt.LEFT&&(e.lam=Th(e.lam,+pe))}if(this.es!==0){var I,E,A;I=e.phi<0?1:0,E=Math.tan(e.phi),A=this.b/Math.sqrt(E*E+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-A*A)/(this.one_minus_f*A)),I&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function s0(n,e,t,i){var r;return n<Se?(i.value=xt.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=wt?i.value=xt.AREA_0:r>wt&&r<=pe+wt?(i.value=xt.AREA_1,r-=pe):r>pe+wt||r<=-(pe+wt)?(i.value=xt.AREA_2,r=r>=0?r-fn:r+fn):(i.value=xt.AREA_3,r+=pe)),r}function Th(n,e){var t=n+e;return t<-fn?t+=Lg:t>+fn&&(t-=Lg),t}var qne=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Yne={init:Wne,forward:Hne,inverse:Kne,names:qne};var wx=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Af=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],j3=.8487,G3=1.3523,U3=Gi/5,Xne=1/U3,gh=18,$_=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Qne=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function Zne(n,e,t,i){for(var r=e;i;--i){var s=n(r);if(r-=s,Math.abs(s)<t)break}return r}function Jne(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function eie(n){var e=Ae(n.x-this.long0,this.over),t=Math.abs(n.y),i=Math.floor(t*U3);i<0?i=0:i>=gh&&(i=gh-1),t=Gi*(t-Xne*i);var r={x:$_(wx[i],t)*e,y:$_(Af[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*j3+this.x0,r.y=r.y*this.a*G3+this.y0,r}function tie(n){var e={x:(n.x-this.x0)/(this.a*j3),y:Math.abs(n.y-this.y0)/(this.a*G3)};if(e.y>=1)e.x/=wx[gh][0],e.y=n.y<0?-pe:pe;else{var t=Math.floor(e.y*gh);for(t<0?t=0:t>=gh&&(t=gh-1);;)if(Af[t][0]>e.y)--t;else if(Af[t+1][0]<=e.y)++t;else break;var i=Af[t],r=5*(e.y-i[0])/(Af[t+1][0]-i[0]);r=Zne(function(s){return($_(i,s)-e.y)/Qne(i,s)},r,Se,100),e.x/=$_(wx[t],r),e.y=(5*t+r)*rn,n.y<0&&(e.y=-e.y)}return e.x=Ae(e.x+this.long0,this.over),e}var nie=["Robinson","robin"];const iie={init:Jne,forward:eie,inverse:tie,names:nie};function rie(){this.name="geocent"}function sie(n){var e=P3(n,this.es,this.a);return e}function oie(n){var e=C3(n,this.es,this.a,this.b);return e}var aie=["Geocentric","geocentric","geocent","Geocent"];const lie={init:rie,forward:sie,inverse:oie,names:aie};var ci={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},uf={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function cie(){if(Object.keys(uf).forEach((function(t){if(typeof this[t]>"u")this[t]=uf[t].def;else{if(uf[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);uf[t].num&&(this[t]=parseFloat(this[t]))}uf[t].degrees&&(this[t]=this[t]*rn)}).bind(this)),Math.abs(Math.abs(this.lat0)-pe)<Se?this.mode=this.lat0<0?ci.S_POLE:ci.N_POLE:Math.abs(this.lat0)<Se?this.mode=ci.EQUIT:(this.mode=ci.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function uie(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,s;switch(this.mode){case ci.OBLIQ:s=this.sinph0*e+this.cosph0*t*i;break;case ci.EQUIT:s=t*i;break;case ci.S_POLE:s=-e;break;case ci.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),r=s*t*Math.sin(n.x),this.mode){case ci.OBLIQ:s*=this.cosph0*e-this.sinph0*t*i;break;case ci.EQUIT:s*=e;break;case ci.N_POLE:s*=-(t*i);break;case ci.S_POLE:s*=t*i;break}var o,a;return o=s*this.cg+r*this.sg,a=1/(o*this.sw*this.h1+this.cw),r=(r*this.cg-s*this.sg)*this.cw*a,s=o*a,n.x=r*this.a,n.y=s*this.a,n}function hie(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var s=Vi(n.x,n.y);if(Math.abs(s)<Se)e.x=0,e.y=n.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case ci.OBLIQ:e.y=Math.asin(o*this.sinph0+n.y*a*this.cosph0/s),n.y=(o-this.sinph0*Math.sin(e.y))*s,n.x*=a*this.cosph0;break;case ci.EQUIT:e.y=Math.asin(n.y*a/s),n.y=o*s,n.x*=a;break;case ci.N_POLE:e.y=Math.asin(o),n.y=-n.y;break;case ci.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var die=["Tilted_Perspective","tpers"];const fie={init:cie,forward:uie,inverse:hie,names:die};function gie(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function mie(n){var e=n.x,t=n.y,i,r,s,o;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var a=this.radius_p/Vi(this.radius_p*Math.cos(t),Math.sin(t));if(r=a*Math.cos(e)*Math.cos(t),s=a*Math.sin(e)*Math.cos(t),o=a*Math.sin(t),(this.radius_g-r)*r-s*s-o*o*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Vi(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Vi(s,i)))}else this.shape==="sphere"&&(i=Math.cos(t),r=Math.cos(e)*i,s=Math.sin(e)*i,o=Math.sin(t),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Vi(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Vi(s,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function pie(n){var e=-1,t=0,i=0,r,s,o,a;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Vi(1,i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Vi(1,t));var c=i/this.radius_p;if(r=t*t+c*c+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),r=t*t+i*i+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var _ie=["Geostationary Satellite View","Geostationary_Satellite","geos"];const yie={init:gie,forward:mie,inverse:pie,names:_ie};var Wf=1.340264,Hf=-.081106,Kf=893e-6,qf=.003796,W_=Math.sqrt(3)/2;function vie(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Eie(n){var e=Ae(n.x-this.long0,this.over),t=n.y,i=Math.asin(W_*Math.sin(t)),r=i*i,s=r*r*r;return n.x=e*Math.cos(i)/(W_*(Wf+3*Hf*r+s*(7*Kf+9*qf*r))),n.y=i*(Wf+Hf*r+s*(Kf+qf*r)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function wie(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,i=n.y,r,s,o,a,c,h;for(h=0;h<t&&(r=i*i,s=r*r*r,o=i*(Wf+Hf*r+s*(Kf+qf*r))-n.y,a=Wf+3*Hf*r+s*(7*Kf+9*qf*r),i-=c=o/a,!(Math.abs(c)<e));++h);return r=i*i,s=r*r*r,n.x=W_*n.x*(Wf+3*Hf*r+s*(7*Kf+9*qf*r))/Math.cos(i),n.y=Math.asin(Math.sin(i)/W_),n.x=Ae(n.x+this.long0,this.over),n}var xie=["eqearth","Equal Earth","Equal_Earth"];const Sie={init:vie,forward:Eie,inverse:wie,names:xie};var Dg=1e-10;function Iie(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<Dg)throw new Error;this.es?(this.en=JI(this.es),this.m1=ld(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Rie,this.forward=Tie):(Math.abs(this.phi1)+Dg>=pe?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Pie,this.forward=Aie)}function Tie(n){var e=Ae(n.x-(this.long0||0),this.over),t=n.y,i,r,s;return i=this.am1+this.m1-ld(t,r=Math.sin(t),s=Math.cos(t),this.en),r=s*e/(i*Math.sqrt(1-this.es*r*r)),n.x=i*Math.sin(r),n.y=this.am1-i*Math.cos(r),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Rie(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i,r;if(t=Vi(n.x,n.y=this.am1-n.y),r=eT(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(r))<pe)e=Math.sin(r),i=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(r);else if(Math.abs(e-pe)<=Dg)i=0;else throw new Error;return n.x=Ae(i+(this.long0||0),this.over),n.y=hl(r),n}function Aie(n){var e=Ae(n.x-(this.long0||0),this.over),t=n.y,i,r;return r=this.cphi1+this.phi1-t,Math.abs(r)>Dg?(n.x=r*Math.sin(i=e*Math.cos(t)/r),n.y=this.cphi1-r*Math.cos(i)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Pie(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i=Vi(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-i,Math.abs(t)>pe)throw new Error;return Math.abs(Math.abs(t)-pe)<=Dg?e=0:e=i*Math.atan2(n.x,n.y)/Math.cos(t),n.x=Ae(e+(this.long0||0),this.over),n.y=hl(t),n}var Cie=["bonne","Bonne (Werner lat_1=90)"];const bie={init:Iie,names:Cie},CM={OBLIQUE:{forward:Oie,inverse:Vie},TRANSVERSE:{forward:Die,inverse:Fie}},H_={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Mie(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=I3.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Lr(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const i=Object.keys(H_),r=a=>{if(typeof this[a]>"u")return;const c=parseFloat(this[a])*rn;if(isNaN(c))throw new Error("Invalid value for "+a+": "+this[a]);return c};for(let a=0;a<i.length;a++){const c=i[a],h=H_[c],d=Object.entries(h);if(d.some(([m])=>typeof this[m]<"u")){t=h;for(let m=0;m<d.length;m++){const[y,w]=d[m],I=r(y);if(typeof I>"u")throw new Error("Missing parameter: "+y+".");this[w]=I}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=Nie(this,t);this.lamp=s,Math.abs(o)>Se?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=CM.OBLIQUE):this.projectionType=CM.TRANSVERSE}function kie(n){return this.projectionType.forward(this,n)}function Lie(n){return this.projectionType.inverse(this,n)}function Nie(n,e){let t,i;if(e===H_.ROTATE){let r=n.oLongC,s=n.oLatC,o=n.oAlpha;if(Math.abs(Math.abs(s)-pe)<=Se)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");i=r+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===H_.NEW_POLE)i=n.oLongP,t=n.oLatP;else{let r=n.oLong1,s=n.oLat1,o=n.oLong2,a=n.oLat2,c=Math.abs(s);if(Math.abs(s)>pe-Se)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(a)>pe-Se)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-a)<Se)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(c<Se)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");i=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(r)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(r)),t=Math.atan(-1*Math.cos(i-r)/Math.tan(s))}return{lamp:i,phip:t}}function Oie(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(t),s=Math.sin(i),o=Math.cos(i);e.x=Ae(Math.atan2(o*Math.sin(t),n.sphip*o*r+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*o*r);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Gi,a.y*=Gi),a}function Die(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(i),s=Math.cos(t);e.x=Ae(Math.atan2(r*Math.sin(t),Math.sin(i))+n.lamp),e.y=Math.asin(-1*r*s);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Gi,o.y*=Gi),o}function Vie(n,e){n.isIdentity&&(e.x*=rn,e.y*=rn);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){i-=n.lamp;const s=Math.cos(i),o=Math.sin(r),a=Math.cos(r);e.x=Math.atan2(a*Math.sin(i),n.sphip*a*s-n.cphip*o),e.y=Math.asin(n.sphip*o+n.cphip*a*s)}return e.x=Ae(e.x+n.long0),e}function Fie(n,e){n.isIdentity&&(e.x*=rn,e.y*=rn);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){const s=Math.cos(r);i-=n.lamp,e.x=Math.atan2(s*Math.sin(i),-1*Math.sin(r)),e.y=Math.asin(s*Math.cos(i))}return e.x=Ae(e.x+n.long0),e}var jie=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Gie={init:Mie,forward:kie,inverse:Lie,names:jie};function Uie(n){n.Proj.projections.add(b0),n.Proj.projections.add(M0),n.Proj.projections.add(Cee),n.Proj.projections.add(Fee),n.Proj.projections.add(zee),n.Proj.projections.add(qee),n.Proj.projections.add(ete),n.Proj.projections.add(ste),n.Proj.projections.add(ute),n.Proj.projections.add(mte),n.Proj.projections.add(Pte),n.Proj.projections.add(Nte),n.Proj.projections.add(jte),n.Proj.projections.add(Wte),n.Proj.projections.add(Xte),n.Proj.projections.add(tne),n.Proj.projections.add(one),n.Proj.projections.add(hne),n.Proj.projections.add(_ne),n.Proj.projections.add(xne),n.Proj.projections.add(Ane),n.Proj.projections.add(kne),n.Proj.projections.add(jne),n.Proj.projections.add($ne),n.Proj.projections.add(Yne),n.Proj.projections.add(iie),n.Proj.projections.add(lie),n.Proj.projections.add(fie),n.Proj.projections.add(yie),n.Proj.projections.add(Sie),n.Proj.projections.add(bie),n.Proj.projections.add(Gie)}const At=Object.assign(HJ,{defaultDatum:"WGS84",Proj:Lr,WGS84:new Lr("WGS84"),Point:Qh,toPoint:b3,defs:qn,nadgrid:PJ,transform:B_,mgrs:KJ,version:"__VERSION__"});Uie(At);class Bie{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=mc,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let i=t.dataProjection?Vt(t.dataProjection):this.readProjection(e);t.extent&&i&&i.getUnits()==="tile-pixels"&&(i=Vt(i),i.setWorldExtent(t.extent)),t={dataProjection:i,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return qe()}readFeature(e,t){return qe()}readFeatures(e,t){return qe()}readGeometry(e,t){return qe()}readProjection(e){return qe()}writeFeature(e,t){return qe()}writeFeatures(e,t){return qe()}writeGeometry(e,t){return qe()}}function oT(n,e,t){const i=t?Vt(t.featureProjection):null,r=t?Vt(t.dataProjection):null;let s=n;if(i&&r&&!cc(i,r)){e&&(s=n.clone());const o=e?i:r,a=e?r:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(Jf(o,a))}if(e&&t&&t.decimals!==void 0){const o=Math.pow(10,t.decimals),a=function(c){for(let h=0,d=c.length;h<d;++h)c[h]=Math.round(c[h]*o)/o;return c};s===n&&(s=n.clone()),s.applyTransform(a)}return s}const zie={Point:qa,LineString:yc,Polygon:Ya,MultiPoint:oy,MultiLineString:K0,MultiPolygon:q0};function $ie(n,e,t){return Array.isArray(e[0])?(Ck(n,0,e,t)||(n=n.slice(),nw(n,0,e,t)),n):(Kx(n,0,e,t)||(n=n.slice(),W0(n,0,e,t)),n)}function B3(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>B3({...n,geometry:s})).flat();const i=t.type==="MultiPolygon"?"Polygon":t.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const r=t.layout.length;return oT(new Ji(i,i==="Polygon"?$ie(t.flatCoordinates,t.ends,r):t.flatCoordinates,t.ends?.flat(),r,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function aT(n,e){if(!n)return null;if(Array.isArray(n)){const i=n.map(r=>aT(r,e));return new H0(i)}const t=zie[n.type];return oT(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class Wie extends Bie{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(o0(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(o0(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return qe()}readFeaturesFromObject(e,t){return qe()}readGeometry(e,t){return this.readGeometryFromObject(o0(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return qe()}readProjection(e){return this.readProjectionFromObject(o0(e))}readProjectionFromObject(e){return qe()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return qe()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return qe()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return qe()}}function o0(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class Hie extends Wie{constructor(e){e=e||{},super(),this.dataProjection=Vt(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Vt(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let i=null;e.type==="Feature"?i=e:i={type:"Feature",geometry:e,properties:null};const r=lT(i.geometry);if(this.featureClass===Ji)return B3({geometry:r,id:i.id,properties:i.properties},t);const s=new mc;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry(aT(r,t)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(e,t){const i=e;let r=null;if(i.type==="FeatureCollection"){const s=e;r=[];const o=s.features;for(let a=0,c=o.length;a<c;++a){const h=this.readFeatureFromObject(o[a],t);h&&r.push(h)}}else r=[this.readFeatureFromObject(e,t)];return r.flat()}readGeometryFromObject(e,t){return Kie(e,t)}readProjectionFromObject(e){const t=e.crs;let i;if(t)if(t.type=="name")i=Vt(t.properties.name);else if(t.type==="EPSG")i=Vt("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(e,t){t=this.adaptOptions(t);const i={type:"Feature",geometry:null,properties:null},r=e.getId();if(r!==void 0&&(i.id=r),!e.hasProperties())return i;const s=e.getProperties(),o=e.getGeometry();return o&&(i.geometry=xx(o,t),delete s[e.getGeometryName()]),gc(s)||(i.properties=s),i}writeFeaturesObject(e,t){t=this.adaptOptions(t);const i=[];for(let r=0,s=e.length;r<s;++r)i.push(this.writeFeatureObject(e[r],t));return{type:"FeatureCollection",features:i}}writeGeometryObject(e,t){return xx(e,this.adaptOptions(t))}}function lT(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=Yie(n);break}case"LineString":{t=Xie(n);break}case"Polygon":{t=ere(n);break}case"MultiPoint":{t=Zie(n);break}case"MultiLineString":{t=Qie(n);break}case"MultiPolygon":{t=Jie(n);break}case"GeometryCollection":{t=qie(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function Kie(n,e){const t=lT(n);return aT(t,e)}function qie(n,e){return n.geometries.map(function(i){return lT(i)})}function Yie(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:jc(e.length)}}function Xie(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:jc(e[0]?.length||2)}}function Qie(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,i=[],r=Wg(i,0,e,t);return{type:"MultiLineString",flatCoordinates:i,ends:r,layout:jc(t)}}function Zie(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:jc(e[0]?.length||2)}}function Jie(n){const e=n.coordinates,t=[],i=e[0]?.[0]?.[0].length||2,r=sk(t,0,e,i);return{type:"MultiPolygon",flatCoordinates:t,ends:r,layout:jc(i)}}function ere(n){const e=n.coordinates,t=[],i=e[0]?.[0]?.length,r=Wg(t,0,e,i);return{type:"Polygon",flatCoordinates:t,ends:r,layout:jc(i)}}function xx(n,e){n=oT(n,!0,e);const t=n.getType();let i;switch(t){case"Point":{i=ore(n);break}case"LineString":{i=nre(n);break}case"Polygon":{i=are(n,e);break}case"MultiPoint":{i=rre(n);break}case"MultiLineString":{i=ire(n);break}case"MultiPolygon":{i=sre(n,e);break}case"GeometryCollection":{i=tre(n,e);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return i}function tre(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return xx(i,e)})}}function nre(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function ire(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function rre(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function sre(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function ore(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function are(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}function lre(n){const e=Object.keys(n.defs),t=e.length;let i,r;for(i=0;i<t;++i){const s=e[i];if(!a0(s)){const o=n.defs(s);let a=o.units;!a&&o.projName==="longlat"&&(a="degrees"),j0(new J_({code:s,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:a}))}}for(i=0;i<t;++i){const s=e[i],o=a0(s);for(r=0;r<t;++r){const a=e[r],c=a0(a);if(!l0(s,a))if(n.defs[s]===n.defs[a])KE([o,c]);else{const h=n(s,a);K6(o,c,FR(o,c,h.forward),FR(c,o,h.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");At.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");lre(At);let ac=null,Yf=null,ih=null;function Sx(n){ac&&(n.removeLayer(ac),ac=null),Yf&&(n.removeLayer(Yf),Yf=null),ih=null}async function cre(n,e){try{const t=Lt(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const i=At("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${i?i[0].toFixed(0)+", "+i[1].toFixed(0):"FAILED"}`),!i||i[0]<7e3||i[0]>3e5||i[1]<289e3||i[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",i),!1;Sx(n);const r=1,s=`${i[0]-r},${i[1]-r},${i[0]+r},${i[1]+r}`,o=Date.now(),a=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${o}`;console.log(" WFS URL:",a);const c=new AbortController,h=setTimeout(()=>c.abort(),1e4),d=await fetch(a,{signal:c.signal});if(clearTimeout(h),!d.ok)return console.error("WFS request failed:",d.status),!1;const g=await d.json();if(console.log(" WFS RESPONSE:",JSON.stringify(g).substring(0,500)),!g.features||g.features.length===0)return console.log("No parcel found at location"),!1;const m=g.features[0];console.log(" PARCEL ID:",m.id||m.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(m.bbox||"geen bbox"));const w=new Hie().readFeature(m,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),I=w.getGeometry();if(!I)return console.log("No geometry in parcel feature"),!1;const E=m.properties||{};console.log(` Parcel: ${E.category||"unknown"} - ${E.gewasnaam||E.gewas||"geen gewas"}`),console.log(` Geometry type: ${I.getType()}, extent: ${I.getExtent().map(L=>L.toFixed(0)).join(", ")}`);const A=I.getExtent(),b=A[2]-A[0],N=A[3]-A[1],D=Math.max(b,N)*.05,O=[A[0]-D,A[1]-D,A[2]+D,A[3]+D],$=Math.max(b,N)*.3,k=[A[0]-$,A[1]-$,A[2]+$,A[3]+$];ih=I,ac=new UF({source:new g9({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:O,zIndex:998}),ac.on("prerender",L=>{if(!ih)return;const j=L.context;if(!j)return;const G=L.frameState;if(!G)return;j.save(),j.beginPath(),(ih.getType()==="Polygon"?ih.getCoordinates()[0]:ih.getCoordinates()[0][0]).forEach((V,de)=>{const Pe=n.getPixelFromCoordinate(V);if(!Pe)return;const ue=G.pixelRatio,fe=Pe[0]*ue,Q=Pe[1]*ue;de===0?j.moveTo(fe,Q):j.lineTo(fe,Q)}),j.closePath(),j.clip()}),ac.on("postrender",L=>{const j=L.context;j&&j.restore()}),n.addLayer(ac);const C=new ay({features:[w]});return Yf=new fy({source:C,style:new Ii({fill:new es({color:"rgba(0, 0, 0, 0)"}),stroke:new Ro({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(Yf),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}const nv=Ks()(mI((n,e)=>({vondsten:[],addVondst:t=>n(i=>({vondsten:[...i.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(i=>({vondsten:i.vondsten.filter(r=>r.id!==t)})),updateVondst:(t,i)=>n(r=>({vondsten:r.vondsten.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(a=>({type:"Feature",geometry:{type:"Point",coordinates:[a.location.lng,a.location.lat]},properties:{id:a.id,objectType:a.objectType,material:a.material,period:a.period,depth:a.depth,notes:a.notes,timestamp:a.timestamp}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"detectorapp-local-vondsten"}));At.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");async function ure(n){try{const e=Lt(n),t=At("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const i=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-i},${t[1]-i},${t[0]+i},${t[1]+i}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,a=await(await fetch(s)).json();if(a.features&&a.features.length>0){const c=a.features[0].properties,h=c?.value_list??c?.GRAY_INDEX??c?.value??c?.gray_index;if(h!=null){const d=typeof h=="number"?h:parseFloat(h);if(!isNaN(d))return d}}}catch(e){console.warn("AHN height query failed:",e)}return null}const hre={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},dre={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function fre(){const n=di(V=>V.map),e=nv(V=>V.removeVondst),[t,i]=oe.useState([]),[r,s]=oe.useState(0),[o,a]=oe.useState(!1),[c,h]=oe.useState(null),[d,g]=oe.useState(!1),[m,y]=oe.useState(!1),[w,I]=oe.useState(null),E=t[r]||"",A=t.length>1,b=V=>{const de=V.match(/<strong[^>]*>(.*?)<\/strong>/);if(de){const Pe=de[1].replace(/<[^>]+>/g,""),ue=V.replace(de[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:Pe,contentWithoutTitle:ue}}return{title:"",contentWithoutTitle:V}},{title:N,contentWithoutTitle:D}=b(E),O=E.includes("Landbouwperceel"),$=E.includes("data-vondst-id="),k=()=>{s(V=>(V-1+t.length)%t.length)},C=()=>{s(V=>(V+1)%t.length)},L=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",c),!n||!c||m){console.log(" STOP - map:",!!n,"coord:",c,"loading:",m);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${c[0]}, ${c[1]}]`),y(!0);try{await cre(n,c)&&g(!0)}catch(V){console.error("Failed to load height map:",V)}finally{y(!1)}},j=()=>{n&&(Sx(n),g(!1))};oe.useEffect(()=>{if(!n)return;const V=ue=>{let fe='<strong class="text-purple-800">AMK Monument</strong>';if(ue.toponiem&&(fe+=`<br/><span class="text-sm font-semibold">${ue.toponiem}</span>`),ue.kwaliteitswaarde&&(fe+=`<br/><span class="text-sm text-purple-700">${ue.kwaliteitswaarde}</span>`),ue.omschrijving&&(fe+=`<br/><span class="text-xs text-gray-600 mt-1 block">${ue.omschrijving}</span>`),ue.txt_label){const Q=ue.txt_label.split(", ").slice(0,3).join(", ");fe+=`<br/><span class="text-xs text-gray-500 italic">${Q}${ue.txt_label.split(", ").length>3?"...":""}</span>`}return fe},de=async(ue,fe)=>{const Q=[],ge=n.getLayers().getArray().filter(he=>he instanceof Bl&&he.getVisible()?he.getSource()instanceof x9:!1);for(const he of ge){const K=he.getSource();if(!K)continue;const W=he.get("title")||"";if(W==="Archeo Landschappen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-green-800">Archeologisch Landschap</strong>';(U.landschapsnaam||U.naam)&&(ae+=`<br/><span class="text-sm font-semibold">${U.landschapsnaam||U.naam}</span>`),U.omschrijving&&(ae+=`<br/><span class="text-xs text-gray-600">${U.omschrijving}</span>`),Q.push(ae)}}catch(ie){console.warn("Archeo Landschappen WMS query failed:",ie)}continue}if(W==="FAMKE Steentijd"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';(U.advies||U.Advies)&&(ae+=`<br/><span class="text-sm text-amber-700">${U.advies||U.Advies}</span>`),Q.push(ae)}}catch(ie){console.warn("FAMKE WMS query failed:",ie)}continue}if(W==="Archeo Onderzoeken"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';if(U.type_onderzoek&&(ae+=`<br/><span class="text-sm font-semibold">${U.type_onderzoek}</span>`),U.onderzoeksmeldingnummer&&(ae+=`<br/><span class="text-xs text-gray-500">Melding: ${U.onderzoeksmeldingnummer}</span>`),U.uitvoerder&&(ae+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${U.uitvoerder}</span>`),U.startdatum||U.einddatum){const Xe=[U.startdatum,U.einddatum].filter(Boolean).join(" - ");ae+=`<br/><span class="text-xs text-gray-600">Periode: ${Xe}</span>`}if(U.gemeente&&(ae+=`<br/><span class="text-xs text-gray-500">${U.gemeente}</span>`),U.type_uri){const Xe=U.type_uri.replace("type_uri:","").trim();Xe.startsWith("http")&&(ae+=`<br/><a href="${Xe}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">Meer informatie </a>`)}for(const[Xe,rt]of Object.entries(U))if(Xe.toLowerCase().includes("uri")&&typeof rt=="string"&&Xe!=="type_uri"){const ht=rt.replace(/^[a-z_]+:/i,"").trim();ht.startsWith("http")&&(ae+=`<br/><a href="${ht}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">${Xe.replace("_uri","")} </a>`)}Q.push(ae)}}catch(ie){console.warn("Archeo Onderzoeken WMS query failed:",ie)}continue}if(W==="IKAW"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=500,Y=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties,ae=Math.round(U.PALETTE_INDEX||U.palette_index||0),Xe=dre[ae]||`Trefkans onbekend (${ae})`;let rt='<strong class="text-orange-800">IKAW (2008)</strong>';rt+=`<br/><span class="text-sm text-orange-700">${Xe}</span>`,Q.push(rt)}}catch(ie){console.warn("IKAW WMS query failed:",ie)}continue}if(W==="Inundatiegebieden"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-blue-800">Inundatiegebied</strong>';(U["linie-naam"]||U.linie_naam)&&(ae+=`<br/><span class="text-sm font-semibold text-blue-700">${U["linie-naam"]||U.linie_naam}</span>`),U.naam&&(ae+=`<br/><span class="text-sm text-gray-700">${U.naam}</span>`),U.periode&&(ae+=`<br/><span class="text-xs text-gray-500">${U.periode}</span>`),U.lin_period&&(ae+=`<br/><span class="text-xs text-gray-400">${U.lin_period}</span>`),Q.push(ae)}}catch(ie){console.warn("Inundatiegebieden WMS query failed:",ie)}continue}if(W==="Militaire Objecten"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=50,Y=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-stone-800">Militair Object</strong>';U.obj_soort&&(ae+=`<br/><span class="text-sm font-semibold text-stone-700">${U.obj_soort}</span>`),U.obj_naam&&(ae+=`<br/><span class="text-sm text-gray-700">${U.obj_naam}</span>`),U.lin_period&&(ae+=`<br/><span class="text-xs text-gray-500">${U.lin_period}</span>`),Q.push(ae)}}catch(ie){console.warn("Militaire Objecten WMS query failed:",ie)}continue}if(W==="Verdedigingslinies"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-amber-800">Verdedigingslinie</strong>';(U.naam||U.lin_naam)&&(ae+=`<br/><span class="text-sm font-semibold text-amber-700">${U.naam||U.lin_naam}</span>`),U.lin_period&&(ae+=`<br/><span class="text-xs text-gray-500">${U.lin_period}</span>`),U.status&&(ae+=`<br/><span class="text-xs text-gray-400">${U.status}</span>`),Q.push(ae)}}catch(ie){console.warn("Verdedigingslinies WMS query failed:",ie)}continue}if(W==="Rijksmonumenten"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=50,Y=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-red-800">Rijksmonument</strong>';(U.cbsNaam||U.cbs_naam)&&(ae+=`<br/><span class="text-sm font-semibold">${U.cbsNaam||U.cbs_naam}</span>`),U.hoofdcategorie&&(ae+=`<br/><span class="text-sm text-red-700">${U.hoofdcategorie}</span>`),U.subcategorie&&(ae+=`<br/><span class="text-xs text-gray-600">${U.subcategorie}</span>`),U.rijksmonumentnummer&&(ae+=`<br/><span class="text-xs text-gray-500">Nr: ${U.rijksmonumentnummer}</span>`),(U.bouwjaar||U.oorspronkelijkebouwjaar)&&(ae+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${U.bouwjaar||U.oorspronkelijkebouwjaar}</span>`),Q.push(ae)}}catch(ie){console.warn("Rijksmonumenten WMS query failed:",ie)}continue}if(W==="Werelderfgoed"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=500,Y=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(U.siteName||U.naam)&&(ae+=`<br/><span class="text-sm font-semibold text-cyan-700">${U.siteName||U.naam}</span>`),U.siteDesignation&&(ae+=`<br/><span class="text-xs text-gray-600">${U.siteDesignation}</span>`),Q.push(ae)}}catch(ie){console.warn("Werelderfgoed WMS query failed:",ie)}continue}if(W==="Terpen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-orange-800">Terp</strong>';(U.naam||U.NAAM)&&(ae+=`<br/><span class="text-sm font-semibold text-orange-700">${U.naam||U.NAAM}</span>`),(U.plaats||U.PLAATS)&&(ae+=`<br/><span class="text-xs text-gray-600">${U.plaats||U.PLAATS}</span>`),Q.push(ae)}}catch(ie){console.warn("Terpen WMS query failed:",ie)}continue}if(W==="Religieus Erfgoed"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=50,Y=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-purple-800">Religieus Erfgoed</strong>';const Xe=U.naam||U.NAAM||U.name||U.NAME;Xe&&(ae+=`<br/><span class="text-sm font-semibold text-purple-700">${Xe}</span>`);const rt=U.denominatie||U.DENOMINATIE||U.religie;rt&&(ae+=`<br/><span class="text-sm text-gray-700">${rt}</span>`);const ht=U.type||U.TYPE||U.functie;ht&&(ae+=`<br/><span class="text-xs text-gray-600">${ht}</span>`);const Ft=U.bouwjaar||U.BOUWJAAR||U.jaar;Ft&&(ae+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Ft}</span>`);const an=U.gemeente||U.GEMEENTE||U.plaats;an&&(ae+=`<br/><span class="text-xs text-gray-400">${an}</span>`),Q.push(ae)}}catch(ie){console.warn("Religieus Erfgoed WMS query failed:",ie)}continue}if(W==="Gewaspercelen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=50,Y=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-green-800">Landbouwperceel</strong>';(U.gewas||U.gewasnaam)&&(ae+=`<br/><span class="text-sm font-semibold text-green-700">${U.gewas||U.gewasnaam}</span>`),(U.categorie||U.category)&&(ae+=`<br/><span class="text-xs text-gray-600">${U.categorie||U.category}</span>`),U.oppervlakte&&(ae+=`<br/><span class="text-xs text-gray-500">${U.oppervlakte} ha</span>`),Q.push(ae)}}catch(ie){console.warn("BRP Gewaspercelen WMS query failed:",ie)}continue}if(W==="Kadastrale Grenzen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=20,Y=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if((U.perceelNummer||U.perceelnummer)&&(ae+=`<br/><span class="text-sm font-semibold text-indigo-700">${U.perceelNummer||U.perceelnummer}</span>`),U.kadastraleGemeenteCode||U.gemeentecode){const Xe=String(U.kadastraleGemeenteCode||U.gemeentecode),rt=hre[Xe]||Xe;ae+=`<br/><span class="text-xs text-gray-600">Gemeente: ${rt}</span>`}U.sectie&&(ae+=`<br/><span class="text-xs text-gray-500">Sectie: ${U.sectie}</span>`),U.oppervlakte&&(ae+=`<br/><span class="text-xs text-gray-500">${U.oppervlakte} m</span>`),Q.push(ae)}}catch(ie){console.warn("Kadastrale Grenzen WMS query failed:",ie)}continue}if(W==="Scheepswrakken"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-cyan-800">Scheepswrak</strong>';(U.naam||U.NAAM)&&(ae+=`<br/><span class="text-sm font-semibold text-cyan-700">${U.naam||U.NAAM}</span>`),(U.type||U.TYPE)&&(ae+=`<br/><span class="text-sm text-gray-700">${U.type||U.TYPE}</span>`),(U.datering||U.DATERING)&&(ae+=`<br/><span class="text-xs text-gray-500">Datering: ${U.datering||U.DATERING}</span>`),(U.bron||U.BRON)&&(ae+=`<br/><span class="text-xs text-gray-400">${U.bron||U.BRON}</span>`),Q.push(ae)}}catch(ie){console.warn("Scheepswrakken WMS query failed:",ie)}continue}if(W==="Woonheuvels ZH"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-orange-800">Woonheuvel</strong>';(U.naam||U.NAAM)&&(ae+=`<br/><span class="text-sm font-semibold text-orange-700">${U.naam||U.NAAM}</span>`),(U.type||U.TYPE)&&(ae+=`<br/><span class="text-sm text-gray-700">${U.type||U.TYPE}</span>`),Q.push(ae)}}catch(ie){console.warn("Woonheuvels WMS query failed:",ie)}continue}if(W==="Romeinse Forten"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=200,Y=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-red-800">Romeins Fort</strong>';(U.naam||U.NAAM)&&(ae+=`<br/><span class="text-sm font-semibold text-red-700">${U.naam||U.NAAM}</span>`),(U.type||U.TYPE)&&(ae+=`<br/><span class="text-sm text-gray-700">${U.type||U.TYPE}</span>`),(U.periode||U.PERIODE)&&(ae+=`<br/><span class="text-xs text-gray-500">${U.periode||U.PERIODE}</span>`),Q.push(ae)}}catch(ie){console.warn("Romeinse Forten WMS query failed:",ie)}continue}if(W==="Windmolens"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=50,Y=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-amber-800">Windmolen</strong>';(U.naam||U.NAAM)&&(ae+=`<br/><span class="text-sm font-semibold text-amber-700">${U.naam||U.NAAM}</span>`),(U.type||U.TYPE||U.functie||U.FUNCTIE)&&(ae+=`<br/><span class="text-sm text-gray-700">${U.type||U.TYPE||U.functie||U.FUNCTIE}</span>`),(U.bouwjaar||U.BOUWJAAR)&&(ae+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${U.bouwjaar||U.BOUWJAAR}</span>`),Q.push(ae)}}catch(ie){console.warn("Windmolens WMS query failed:",ie)}continue}if(W==="Erfgoedlijnen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=200,Y=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-purple-800">Erfgoedlijn</strong>';(U.naam||U.NAAM||U.erfgoedlijn)&&(ae+=`<br/><span class="text-sm font-semibold text-purple-700">${U.naam||U.NAAM||U.erfgoedlijn}</span>`),(U.type||U.TYPE)&&(ae+=`<br/><span class="text-sm text-gray-700">${U.type||U.TYPE}</span>`),(U.omschrijving||U.OMSCHRIJVING)&&(ae+=`<br/><span class="text-xs text-gray-500">${U.omschrijving||U.OMSCHRIJVING}</span>`),Q.push(ae)}}catch(ie){console.warn("Erfgoedlijnen WMS query failed:",ie)}continue}if(W==="Oude Kernen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=200,Y=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-stone-800">Historische Kern</strong>';(U.naam||U.NAAM)&&(ae+=`<br/><span class="text-sm font-semibold text-stone-700">${U.naam||U.NAAM}</span>`),(U.type||U.TYPE)&&(ae+=`<br/><span class="text-sm text-gray-700">${U.type||U.TYPE}</span>`),(U.periode||U.PERIODE)&&(ae+=`<br/><span class="text-xs text-gray-500">${U.periode||U.PERIODE}</span>`),Q.push(ae)}}catch(ie){console.warn("Oude Kernen WMS query failed:",ie)}continue}if(W==="Relictenkaart Punten"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=50,Y=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties,ae={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},Xe=U.type?.replace(/[0-9]/g,"")||"",rt=ae[Xe]||U.type||"Cultuurhistorisch object";let ht='<strong class="text-emerald-800">Relict</strong>';ht+=`<br/><span class="text-sm font-semibold text-emerald-700">${rt}</span>`,U.type&&Xe!==U.type&&(ht+=`<br/><span class="text-xs text-gray-500">Code: ${U.type}</span>`),U.streek&&(ht+=`<br/><span class="text-xs text-gray-400">Streek: ${U.streek}</span>`),Q.push(ht)}}catch(ie){console.warn("Relictenkaart Punten WMS query failed:",ie)}continue}if(W==="Relictenkaart Lijnen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=50,Y=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties,Xe={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[U.klasse]||`Historisch lijnrelict (${U.klasse})`;let rt='<strong class="text-teal-800">Lijnrelict</strong>';rt+=`<br/><span class="text-sm font-semibold text-teal-700">${Xe}</span>`,Q.push(rt)}}catch(ie){console.warn("Relictenkaart Lijnen WMS query failed:",ie)}continue}if(W==="Relictenkaart Vlakken"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=100,Y=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties,Xe={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[U.klasse]||`Historisch landschap (${U.klasse})`;let rt='<strong class="text-lime-800">Landschapsrelict</strong>';if(rt+=`<br/><span class="text-sm font-semibold text-lime-700">${Xe}</span>`,U.st_area_shape_){const ht=(U.st_area_shape_/1e4).toFixed(1);rt+=`<br/><span class="text-xs text-gray-500">${ht} ha</span>`}Q.push(rt)}}catch(ie){console.warn("Relictenkaart Vlakken WMS query failed:",ie)}continue}if(W==="Verdronken Dorpen"){try{const ie=Lt(ue),X=At("EPSG:4326","EPSG:28992",ie),P=200,Y=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${X[0]-P},${X[1]-P},${X[0]+P},${X[1]+P}`}`,Z=await(await fetch(Y)).json();if(Z.features&&Z.features.length>0){const U=Z.features[0].properties;let ae='<strong class="text-blue-800">Verdronken Dorp</strong>';(U.naam||U.NAAM)&&(ae+=`<br/><span class="text-sm font-semibold text-blue-700">${U.naam||U.NAAM}</span>`),(U.verdronken||U.VERDRONKEN||U.jaar||U.JAAR)&&(ae+=`<br/><span class="text-xs text-gray-600">Verdronken: ${U.verdronken||U.VERDRONKEN||U.jaar||U.JAAR}</span>`),(U.gemeente||U.GEMEENTE)&&(ae+=`<br/><span class="text-xs text-gray-500">${U.gemeente||U.GEMEENTE}</span>`),(U.bron||U.BRON)&&(ae+=`<br/><span class="text-xs text-gray-400">${U.bron||U.BRON}</span>`),Q.push(ae)}}catch(ie){console.warn("Verdronken Dorpen WMS query failed:",ie)}continue}const be=K.getFeatureInfoUrl(ue,fe,"EPSG:3857",{INFO_FORMAT:"application/json"});if(be)try{const X=await(await fetch(be)).json();if(X.features&&X.features.length>0){const P=X.features[0].properties;if(W==="AHN 0.5m"){let Y='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const Ie=P.value_list??P.GRAY_INDEX??P.value??P.gray_index??P.dtm_05m??P.DTM_05M??P.hoogte??P.HOOGTE??P.elevation??P.ELEVATION;if(Ie!=null&&!isNaN(Number(Ie))){const Z=typeof Ie=="number"?Ie.toFixed(2):Number(Ie).toFixed(2);Y+=`<br/><span class="text-sm text-blue-700">Hoogte: ${Z} m NAP</span>`,Q.push(Y)}else{let Z=!1;const U=["geometry","id","fid","gml_id","bbox"];for(const[ae,Xe]of Object.entries(P))!U.includes(ae.toLowerCase())&&Xe!==null&&Xe!==""&&(Y+=`<br/><span class="text-xs text-gray-600">${ae}: ${Xe}</span>`,Z=!0);Z&&Q.push(Y)}continue}if(W==="Geomorfologie"){let Y='<strong class="text-green-800">Geomorfologie</strong>',Ie=!1;const Z=P.landform_subgroup_description,U=P.relief_klasse,ae=P.relief_subklasse,Xe=P.genese_description,rt=P.active_process;if(Z&&(Y+=`<br/><span class="text-sm text-green-700">${Z}</span>`,Ie=!0),U){const ht=ae&&ae!==U?`${U} (${ae})`:U;Y+=`<br/><span class="text-xs text-gray-600">Relief: ${ht}</span>`,Ie=!0}if(Xe&&(Y+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Xe}</span>`,Ie=!0),rt&&rt!=="onbekend"&&(Y+=`<br/><span class="text-xs text-gray-500">Actief proces: ${rt}</span>`,Ie=!0),!Ie){const ht=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[Ft,an]of Object.entries(P))!ht.includes(Ft.toLowerCase())&&an!==null&&an!==""&&!Ft.includes("validfrom")&&!Ft.includes("validto")&&(Y+=`<br/><span class="text-xs text-gray-600">${Ft}: ${an}</span>`)}Q.push(Y);continue}let Ee=`<strong>${W}</strong>`;if((P.first_soilname||P.soilname)&&(Ee+=`<br/><span class="text-sm text-amber-700">${P.first_soilname||P.soilname}</span>`),(P.soilcode||P.first_soilcode)&&(Ee+=`<br/><span class="text-xs text-gray-500">Code: ${P.soilcode||P.first_soilcode}</span>`),P.soilslope&&P.soilslope!=="Niet opgenomen"&&(Ee+=`<br/><span class="text-xs text-gray-500">Helling: ${P.soilslope}</span>`),!P.first_soilname&&!P.soilname){const Y=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[Ie,Z]of Object.entries(P))!Y.includes(Ie)&&Z&&Z!=="Niet opgenomen"&&(Ee+=`<br/><span class="text-xs text-gray-600">${Ie}: ${Z}</span>`)}Q.push(Ee)}}catch(ie){console.warn("WMS GetFeatureInfo failed:",ie)}}return Q},Pe=async ue=>{const fe=[],Q=ure(ue.coordinate),ge=[];n.forEachFeatureAtPixel(ue.pixel,be=>{ge.push(be)});for(const be of ge){const ie=be.getProperties(),{geometry:X,...P}=ie;if(P.vondst){const Z=P.vondst,U=`<strong>${Z.objectType}</strong>
            <div data-vondst-id="${Z.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${Z.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${Z.period}</span>
            ${Z.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${Z.depth} cm</span>`:""}
            ${Z.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${Z.notes}</span>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(Z.timestamp).toLocaleDateString("nl-NL")}</span>`;fe.push(U),I(Z.id);continue}if(P.kwaliteitswaarde&&P.kwaliteitswaarde.includes("archeologische waarde")){const Z=V(P);fe.push(Z);continue}let Ee=P.name||P.naam||P.title||P.NAAM||P.NAME||P.label||P.route_name||P.road_name;Ee||(P.leisure==="playground"?Ee="Speeltuin":P.leisure==="park"?Ee="Park":P.leisure==="swimming_area"||P.sport==="swimming"?Ee="Zwemplek":P.tourism==="museum"?Ee="Museum":P.amenity==="cafe"||P.amenity==="restaurant"?Ee=P.amenity==="cafe"?"Caf":"Restaurant":P.historic==="castle"?Ee="Kasteel":Ee="Info");let Y=`<strong>${Ee}</strong>`;if(P.category&&(Y+=`<br/><span class="text-sm text-gray-600">Categorie: ${P.category}</span>`),P.from_to&&P.from_to!==Ee&&(Y+=`<br/><span class="text-sm text-gray-600">${P.from_to}</span>`),P.route&&P.route!==Ee&&(Y+=`<br/><span class="text-sm text-gray-600">${P.route}</span>`),P.TOPONIEM&&(Y+=`<br/><span class="text-sm font-semibold text-gray-800">${P.TOPONIEM}</span>`,P.PLAATS&&(Y+=`<br/><span class="text-xs text-gray-500">${P.PLAATS}</span>`)),(P.AARD_VINDP||P.Aard_vindp)&&(Y+=`<br/><span class="text-sm text-gray-700">Aard: ${P.AARD_VINDP||P.Aard_vindp}</span>`),P.BEGIN_PER&&P.EIND_PER&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${P.BEGIN_PER} - ${P.EIND_PER}</span>`),(P.AARD_OPM||P.Aard_opmer)&&(Y+=`<br/><span class="text-xs text-gray-600 italic">${P.AARD_OPM||P.Aard_opmer}</span>`),P.Gemeente&&(Y+=`<br/><span class="text-sm text-gray-600">Gemeente: ${P.Gemeente}</span>`),P.Bron&&(Y+=`<br/><span class="text-xs text-gray-500">Bron: ${P.Bron}</span>`),P.Bron_besch&&(Y+=`<br/><span class="text-xs text-gray-500">${P.Bron_besch}</span>`),P.Dat_st_z&&P.Dat_ei_z&&(Y+=`<br/><span class="text-sm text-purple-700">Datering: ${P.Dat_st_z} - ${P.Dat_ei_z}</span>`),P.Begin&&P.Einde&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${P.Begin} - ${P.Einde}</span>`),P.Uiterwaard&&(Y+=`<br/><span class="text-sm font-semibold">${P.Uiterwaard}</span>`),P.rivier&&(Y+=`<br/><span class="text-sm text-blue-600">Rivier: ${P.rivier}</span>`),P.Beschrijvi&&(Y+=`<br/><span class="text-sm text-gray-700">${P.Beschrijvi}</span>`),P.leisure&&P.name){const Z=P.leisure==="playground"?"Speeltuin":P.leisure==="park"?"Park":P.leisure==="swimming_area"?"Zwemplek":null;Z&&(Y+=`<br/><span class="text-xs text-green-600">${Z}</span>`)}if((P.tourism==="museum"||P.museum)&&P.name&&(Y+='<br/><span class="text-xs text-purple-600">Museum</span>'),(P.leisure==="swimming_area"||P.sport==="swimming")&&P.name&&(Y+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),P.osm_id&&P.address!==void 0&&(Y+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',P.address&&(Y+=`<br/><span class="text-xs text-gray-500">${P.address}</span>`),P.phone&&(Y+=`<br/><span class="text-xs text-gray-600">${P.phone}</span>`)),(P.historic==="castle"||P.castle_type)&&(P.name&&(Y+='<br/><span class="text-xs text-purple-600">Kasteel</span>'),P.castle_type&&(Y+=`<br/><span class="text-xs text-gray-500">Type: ${P.castle_type}</span>`),P.start_date&&(Y+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${P.start_date}</span>`),P.heritage&&(Y+='<br/><span class="text-xs text-amber-600">Rijksmonument</span>')),P.bron==="Paleobiology Database"&&(P.taxonomie&&P.taxonomie!=="Onbekend"&&(Y+=`<br/><span class="text-xs text-amber-700">${P.taxonomie}</span>`),P.periode&&P.periode!=="Onbekend"&&(Y+=`<br/><span class="text-sm text-purple-700">${P.periode}</span>`),P.ouderdom&&P.ouderdom!=="Onbekend"&&(Y+=`<br/><span class="text-xs text-gray-600">Ouderdom: ${P.ouderdom}</span>`),P.aantal_fossielen&&(Y+=`<br/><span class="text-xs text-green-700">Aantal fossielen: ${P.aantal_fossielen}</span>`),P.formatie&&(Y+=`<br/><span class="text-xs text-gray-500">Formatie: ${P.formatie}</span>`),P.lid&&(Y+=`<br/><span class="text-xs text-gray-500">Lid: ${P.lid}</span>`),P.gesteente&&(Y+=`<br/><span class="text-xs text-gray-500">Gesteente: ${P.gesteente}</span>`),P.milieu&&(Y+=`<br/><span class="text-xs text-blue-600">Milieu: ${P.milieu}</span>`),P.vindplaats&&(Y+=`<br/><span class="text-xs text-gray-500 italic">${P.vindplaats}</span>`)),(P.inventarisnummer||P.locatie_naam)&&(P.locatie_naam&&(Y+=`<br/><span class="text-sm font-semibold">${P.locatie_naam}</span>`),P.inventarisnummer&&(Y+=`<br/><span class="text-xs text-gray-500">CAI: ${P.inventarisnummer}</span>`),P.datering_tekst&&(Y+=`<br/><span class="text-sm text-purple-700">${P.datering_tekst}</span>`)),(P.veensoort||P.dikte)&&(P.veensoort&&(Y+=`<br/><span class="text-sm text-amber-700">${P.veensoort}</span>`),P.dikte&&(Y+=`<br/><span class="text-xs text-gray-600">Dikte: ${P.dikte}</span>`)),P.nature&&P.debut){Y+=`<br/><span class="text-sm text-purple-700">${P.nature}</span>`;const Z=P.debut===P.fin?P.debut:`${P.debut} - ${P.fin}`;Z&&(Y+=`<br/><span class="text-sm text-gray-700">Periode: ${Z}</span>`),P.structure&&(Y+=`<br/><span class="text-xs text-gray-600">${P.structure}</span>`),P.commune&&(Y+=`<br/><span class="text-xs text-gray-500">${P.commune}</span>`),P.decouvert&&(Y+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${P.decouvert}</span>`),P.numero&&(Y+=`<br/><span class="text-xs text-gray-400">${P.numero}</span>`)}if((P.NATURE_OPE||P.CODE_OPERA)&&(P.TITRE&&(Y+=`<br/><span class="text-sm font-semibold">${P.TITRE}</span>`),P.NATURE_OPE&&(Y+=`<br/><span class="text-sm text-amber-700">${P.NATURE_OPE}</span>`),P.AUTEUR&&(Y+=`<br/><span class="text-xs text-gray-600">Auteur: ${P.AUTEUR}</span>`),P.DATE&&(Y+=`<br/><span class="text-xs text-gray-500">Datum: ${P.DATE}</span>`),P.COMMUNE&&(Y+=`<br/><span class="text-xs text-gray-500">${P.COMMUNE}</span>`)),P.type_protection&&(P.n_site||P.t_site)){const Z=P.type_protection==="Classe"?"text-red-700":"text-amber-700";Y+=`<br/><span class="text-sm ${Z}">${P.type_protection}</span>`,P.n_site&&(Y+=`<br/><span class="text-sm font-semibold">${P.n_site}</span>`),P.t_site&&(Y+=`<br/><span class="text-xs text-gray-600">${P.t_site}</span>`),P.c_site&&(Y+=`<br/><span class="text-xs text-gray-500">Code: ${P.c_site}</span>`),P.d_creation&&(Y+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${P.d_creation}</span>`)}if(P.type_protection&&P.cod_diren){const Z=P.type_protection==="Classe"?"text-red-700":"text-amber-700";if(Y+=`<br/><span class="text-sm ${Z}">${P.type_protection}</span>`,P.proced&&(Y+=`<br/><span class="text-xs text-gray-600">${P.proced}</span>`),P.d_proced&&(Y+=`<br/><span class="text-xs text-gray-500">Date: ${P.d_proced}</span>`),P.comment){const U=String(P.comment).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${U}${String(P.comment).length>150?"...":""}</span>`}}if(P.type_protection&&P.nomsite){const Z=P.type_protection==="Classe"?"text-red-700":"text-amber-700";if(Y+=`<br/><span class="text-sm ${Z}">${P.type_protection}</span>`,P.caractere&&(Y+=`<br/><span class="text-xs text-gray-600">${P.caractere}</span>`),P.datedecis&&(Y+=`<br/><span class="text-xs text-gray-500">Date: ${P.datedecis}</span>`),P.descriptio){const U=String(P.descriptio).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${U}${String(P.descriptio).length>150?"...":""}</span>`}}if(P.secteur&&P.style){if(Y+=`<br/><span class="text-sm text-gray-700">${P.secteur}</span>`,P["sous-secteur"]&&(Y+=`<br/><span class="text-xs text-gray-600">${P["sous-secteur"]}</span>`),P.description){const Z=String(P.description).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${Z}${String(P.description).length>150?"...":""}</span>`}P.url&&(Y+=`<br/><a href="${P.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(P.nature_operation||P.synthese){P.nature_operation&&(Y+=`<br/><span class="text-sm text-red-700">${P.nature_operation}</span>`),P.responsable_operation&&(Y+=`<br/><span class="text-xs text-gray-600">Responsable: ${P.responsable_operation}</span>`),P.date_operation&&(Y+=`<br/><span class="text-xs text-gray-500">Datum: ${P.date_operation}</span>`);const Z=[];if(P.prehistoire==="Oui"&&Z.push("Prehistorie"),P.protohistoire==="Oui"&&Z.push("Protohistorie"),P.antiquite==="Oui"&&Z.push("Romeins"),P.moyen_age==="Oui"&&Z.push("Middeleeuwen"),P.temps_modernes==="Oui"&&Z.push("Moderne tijd"),Z.length>0&&(Y+=`<br/><span class="text-sm text-purple-700">${Z.join(", ")}</span>`),P.adresse&&(Y+=`<br/><span class="text-xs text-gray-500">${P.adresse}</span>`),P.synthese){const U=String(P.synthese).slice(0,200);Y+=`<br/><span class="text-xs text-gray-600 italic">${U}${String(P.synthese).length>200?"...":""}</span>`}}if(P.operator&&(Y+=`<br/><span class="text-sm text-gray-600">${P.operator}</span>`),P.opening_hours&&(Y+=`<br/><span class="text-xs text-green-600">Open: ${P.opening_hours}</span>`),P.website&&(Y+=`<br/><a href="${P.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),P.addr_street){const Z=[P.addr_street,P.addr_housenumber,P.addr_postcode].filter(Boolean).join(" ");Y+=`<br/><span class="text-xs text-gray-500">${Z}</span>`}const Ie=P.description||P.omschrijving||P.descr||P.info;Ie&&Ie!==Ee&&(Y+=`<br/><span class="text-sm text-gray-600">${Ie}</span>`),fe.push(Y)}const he=n.getView().getResolution()||1,K=await de(ue.coordinate,he);fe.push(...K);const W=await Q;if(fe.length===0&&W!==null){const be=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${W.toFixed(2)} m NAP</span>
          </div>`;fe.push(be)}fe.length>0&&W!==null&&(fe[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${W.toFixed(2)} m NAP</span>
        </div>`),fe.length>0&&(i(fe),s(0),console.log(` KLIK OPGESLAGEN: [${ue.coordinate[0].toFixed(0)}, ${ue.coordinate[1].toFixed(0)}]`),h(ue.coordinate),g(!1),a(!0))};return n.on("click",Pe),()=>{n.un("click",Pe)}},[n]);const G=()=>{a(!1),n&&d&&(Sx(n),g(!1))},z=(V,de)=>{de.offset.y>100&&G()};return T.jsx(Xs,{children:o&&T.jsxs(T.Fragment,{children:[T.jsx(Yt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:G}),T.jsxs(Yt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:z,children:[T.jsx("div",{className:"flex justify-center pt-2 pb-1",children:T.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),T.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[A&&T.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[T.jsx("button",{onClick:k,className:"w-7 h-7 flex items-center justify-center text-blue-600 hover:bg-blue-50 rounded-full transition-colors border-0 outline-none","aria-label":"Vorige laag",children:T.jsx(MQ,{size:18})}),T.jsxs("span",{className:"text-xs text-gray-500 font-medium min-w-[32px] text-center",children:[r+1,"/",t.length]}),T.jsx("button",{onClick:C,className:"w-7 h-7 flex items-center justify-center text-blue-600 hover:bg-blue-50 rounded-full transition-colors border-0 outline-none","aria-label":"Volgende laag",children:T.jsx(c3,{size:18})})]}),T.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate text-sm",children:N||"Info"}),T.jsx("button",{onClick:G,className:"w-7 h-7 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors flex-shrink-0","aria-label":"Sluiten",children:T.jsx(qc,{size:18})})]}),T.jsx("div",{className:"px-4 py-3 max-h-[50vh] overflow-y-auto",dangerouslySetInnerHTML:{__html:D}}),$&&w&&T.jsx("div",{className:"px-4 pb-4",children:T.jsxs("button",{onClick:()=>{e(w),a(!1),I(null)},className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-sm text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[T.jsx(p3,{size:16}),T.jsx("span",{children:"Vondst verwijderen"})]})}),O&&c&&T.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:d?T.jsxs("button",{onClick:j,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[T.jsx(fx,{size:16}),T.jsx("span",{children:"Hoogtekaart verbergen"})]}):T.jsx("button",{onClick:L,disabled:m,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-sm text-white rounded-lg transition-colors border-0 outline-none ${m?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:m?T.jsxs(T.Fragment,{children:[T.jsx(h3,{size:16,className:"animate-spin"}),T.jsx("span",{children:"Laden..."})]}):T.jsxs(T.Fragment,{children:[T.jsx(fx,{size:16}),T.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const gre="https://router.project-osrm.org/route/v1/driving";function mre(n,e){const t={depart:"Start de route",arrive:"U bent aangekomen","turn-left":"Sla linksaf","turn-right":"Sla rechtsaf","turn-slight-left":"Houd links aan","turn-slight-right":"Houd rechts aan","turn-sharp-left":"Sla scherp linksaf","turn-sharp-right":"Sla scherp rechtsaf",uturn:"Keer om",straight:"Ga rechtdoor",merge:"Voeg in","on-ramp":"Neem de oprit","off-ramp":"Neem de afrit","fork-left":"Houd links aan bij de splitsing","fork-right":"Houd rechts aan bij de splitsing","end-of-road-left":"Sla linksaf aan het einde van de weg","end-of-road-right":"Sla rechtsaf aan het einde van de weg",roundabout:"Neem de rotonde",rotary:"Neem de rotonde",continue:"Blijf de weg volgen",notification:"Let op"},i=e?`${n}-${e}`:n;return t[i]||t[n]||"Volg de route"}function bM(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}const yn=Ks()(Bc((n,e)=>({isNavigating:!1,destination:null,destinationName:null,routeCoordinates:null,distance:null,duration:null,loading:!1,error:null,steps:[],currentStepIndex:0,voiceEnabled:!0,lastSpokenStep:-1,lastSpokenTime:0,lastSpokenDistance:-1,startNavigation:async(t,i,r)=>{n(s=>{s.loading=!0,s.error=null});try{const s=`${gre}/${r.lng},${r.lat};${t.lng},${t.lat}?overview=full&geometries=geojson&steps=true`,o=await fetch(s);if(!o.ok)throw new Error("Route berekening mislukt");const a=await o.json();if(a.code==="Ok"&&a.routes&&a.routes.length>0){const c=a.routes[0],h=c.geometry.coordinates.map(g=>({lng:g[0],lat:g[1]})),d=[];if(c.legs&&c.legs[0]&&c.legs[0].steps)for(const g of c.legs[0].steps){const m=g.maneuver?.type||"continue",y=g.maneuver?.modifier;d.push({instruction:mre(m,y),maneuver:y?`${m}-${y}`:m,distance:g.distance||0,duration:g.duration||0,location:{lng:g.maneuver?.location?.[0]||r.lng,lat:g.maneuver?.location?.[1]||r.lat}})}if(n(g=>{g.isNavigating=!0,g.destination=t,g.destinationName=i,g.routeCoordinates=h,g.distance=c.distance,g.duration=c.duration,g.steps=d,g.currentStepIndex=0,g.lastSpokenStep=-1,g.loading=!1}),d.length>0){const g=d[0],m=g.distance>1e3?`${(g.distance/1e3).toFixed(1)} kilometer`:`${Math.round(g.distance)} meter`;e().speakInstruction(`${g.instruction}. Over ${m}.`)}console.log(` Navigation started to ${i}`),console.log(` Distance: ${(c.distance/1e3).toFixed(1)} km`),console.log(` Duration: ${Math.round(c.duration/60)} min`),console.log(` Steps: ${d.length}`)}else throw new Error(a.message||"Geen route gevonden")}catch(s){console.error("Navigation error:",s),n(o=>{o.loading=!1,o.error=s.message||"Navigatie fout"})}},stopNavigation:()=>{"speechSynthesis"in window&&window.speechSynthesis.cancel(),n(t=>{t.isNavigating=!1,t.destination=null,t.destinationName=null,t.routeCoordinates=null,t.distance=null,t.duration=null,t.error=null,t.steps=[],t.currentStepIndex=0,t.lastSpokenStep=-1,t.lastSpokenTime=0,t.lastSpokenDistance=-1}),console.log(" Navigation stopped")},clearError:()=>{n(t=>{t.error=null})},updateCurrentStep:t=>{const{steps:i,currentStepIndex:r,lastSpokenStep:s,lastSpokenTime:o,lastSpokenDistance:a,voiceEnabled:c}=e();if(i.length===0)return;const h=Date.now(),d=5e3;let g=r;for(let m=r;m<i.length;m++){const y=i[m].location;bM(t,y)<30&&(g=Math.min(m+1,i.length-1))}if(g!==r&&(n(m=>{m.currentStepIndex=g}),c&&g!==s&&g<i.length&&h-o>d)){const m=i[g],y=m.distance>1e3?`${(m.distance/1e3).toFixed(1)} kilometer`:`${Math.round(m.distance)} meter`;e().speakInstruction(`${m.instruction}. Over ${y}.`),n(w=>{w.lastSpokenStep=g,w.lastSpokenTime=h,w.lastSpokenDistance=-1})}if(c&&r<i.length){const m=i[r],y=bM(t,m.location);if(h-o<d)return;const w=[200,100,50];for(const I of w)if(y<=I&&y>I-30&&(a===-1||Math.abs(a-I)>30)&&m.maneuver!=="depart"&&m.maneuver!=="arrive"){e().speakInstruction(`Over ${I} meter, ${m.instruction.toLowerCase()}.`),n(E=>{E.lastSpokenTime=h,E.lastSpokenDistance=I});break}}},setVoiceEnabled:t=>{n(i=>{i.voiceEnabled=t}),!t&&"speechSynthesis"in window&&window.speechSynthesis.cancel()},speakInstruction:t=>{if(e().voiceEnabled&&"speechSynthesis"in window){window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(t);i.lang="nl-NL",i.rate=1,i.pitch=1,i.volume=1;const s=window.speechSynthesis.getVoices().find(o=>o.lang.startsWith("nl"));s&&(i.voice=s),window.speechSynthesis.speak(i),console.log(` Speaking: ${t}`)}}})));function pre(){const n=di(E=>E.map),e=Ht(E=>E.position),t=yn(E=>E.startNavigation),i=yn(E=>E.isNavigating),[r,s]=oe.useState(null),[o,a]=oe.useState(!1),[c,h]=oe.useState(!1),d=oe.useRef(null),g=oe.useRef(null);oe.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const E=n.getViewport();if(!E){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",E);const A=600,b=15,N=j=>{if(console.log(" Touch start, touches:",j.touches.length),j.touches.length!==1)return;const G=j.touches[0];g.current={x:G.clientX,y:G.clientY},console.log(" Starting long press timer at:",g.current),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",g.current),!g.current)return;const z=window.__olMap;if(!z){console.log(" Map not available (global)");return}const V=E.getBoundingClientRect(),de=[g.current.x-V.left,g.current.y-V.top],Pe=z.getCoordinateFromPixel(de);if(Pe){const ue=Lt(Pe);j.preventDefault(),s({pixel:[g.current.x,g.current.y],coordinate:ue}),a(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ue)}},A)},D=j=>{if(!d.current||!g.current)return;const G=j.touches[0],z=G.clientX-g.current.x,V=G.clientY-g.current.y,de=Math.sqrt(z*z+V*V);de>b&&(console.log(" Touch moved too much, cancelling. Distance:",de),clearTimeout(d.current),d.current=null)},O=()=>{console.log(" Touch end, timer active:",!!d.current),d.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(d.current),d.current=null),g.current=null},$=j=>{o&&j.preventDefault()},k=j=>{j.button===0&&(console.log(" Mouse down"),g.current={x:j.clientX,y:j.clientY},d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!g.current)return;const G=window.__olMap;if(console.log(" __olMap:",G),console.log(" __olMap constructor:",G?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof G?.getCoordinateAtPixel),!G){console.log(" Map not available (global)");return}const z=E.getBoundingClientRect(),V=[g.current.x-z.left,g.current.y-z.top];console.log(" Pixel:",V);const de=G.getCoordinateFromPixel(V);if(console.log(" Coordinate:",de),de){const Pe=Lt(de);s({pixel:[g.current.x,g.current.y],coordinate:Pe}),a(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",Pe)}},A))},C=j=>{if(!d.current||!g.current)return;const G=j.clientX-g.current.x,z=j.clientY-g.current.y;Math.sqrt(G*G+z*z)>b&&(console.log(" Mouse moved, cancelling"),clearTimeout(d.current),d.current=null)},L=()=>{console.log(" Mouse up"),d.current&&(clearTimeout(d.current),d.current=null),g.current=null};return E.addEventListener("touchstart",N,{passive:!1}),E.addEventListener("touchmove",D,{passive:!0}),E.addEventListener("touchend",O),E.addEventListener("touchcancel",O),E.addEventListener("contextmenu",$),E.addEventListener("mousedown",k),E.addEventListener("mousemove",C),E.addEventListener("mouseup",L),E.addEventListener("mouseleave",L),()=>{E.removeEventListener("touchstart",N),E.removeEventListener("touchmove",D),E.removeEventListener("touchend",O),E.removeEventListener("touchcancel",O),E.removeEventListener("contextmenu",$),E.removeEventListener("mousedown",k),E.removeEventListener("mousemove",C),E.removeEventListener("mouseup",L),E.removeEventListener("mouseleave",L),d.current&&clearTimeout(d.current)}},[n,o]);const m=()=>{c&&(a(!1),s(null),h(!1))},y=async()=>{if(!r||!e)return;const[E,A]=r.coordinate,b=`${A.toFixed(4)}, ${E.toFixed(4)}`;await t({lng:E,lat:A},b,{lng:e.lng,lat:e.lat}),a(!1),s(null),h(!1)},w=()=>{a(!1),s(null),h(!1)},I=E=>{const[A,b]=E;return`${b.toFixed(5)}N, ${A.toFixed(5)}E`};return T.jsx(Xs,{children:o&&r&&T.jsxs(T.Fragment,{children:[T.jsx(Yt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),T.jsxs(Yt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden min-w-[200px]",style:{left:Math.min(r.pixel[0],window.innerWidth-220),top:Math.min(r.pixel[1],window.innerHeight-180)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[T.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100",children:T.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[T.jsx(Jy,{size:16}),T.jsx("span",{className:"text-xs font-mono",children:I(r.coordinate)})]})}),T.jsxs("div",{className:"py-1",children:[T.jsxs("button",{onClick:y,disabled:!e||i,className:`w-full px-4 py-3 flex items-center gap-3 transition-colors ${e&&!i?"hover:bg-blue-50 text-gray-700":"text-gray-400 cursor-not-allowed"}`,children:[T.jsx(ev,{size:20,className:e&&!i?"text-blue-500":"text-gray-300"}),T.jsx("span",{className:"font-medium",children:"Navigeer hierheen"})]}),!e&&T.jsx("div",{className:"px-4 py-2 text-xs text-amber-600 bg-amber-50",children:"GPS positie niet beschikbaar"}),i&&T.jsx("div",{className:"px-4 py-2 text-xs text-blue-600 bg-blue-50",children:"Navigatie al actief"})]}),T.jsx("div",{className:"border-t border-gray-100",children:T.jsxs("button",{onClick:w,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-gray-50 transition-colors",children:[T.jsx(qc,{size:18}),T.jsx("span",{children:"Annuleren"})]})})]})]})})}function _re(){return T.jsx("div",{className:"fixed bottom-2.5 left-2 z-[800] h-8 flex items-center px-2 bg-white/80 backdrop-blur-sm rounded-lg shadow-sm text-xs font-mono text-gray-600",children:"bvd v2.5.28"})}const yre={Compass:jQ,TreePalm:xZ,Mountain:fx,Waves:bZ,Search:g3,Target:vZ,Layers:kg,Grid:QQ},vre={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},Ere={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},wre=["Labels Overlay","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","Romeinse wegen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","Religieus Erfgoed","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Veengebieden","AHN 0.5m","Geomorfologie","Bodemkaart","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur","World Hillshade","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Gewaspercelen","Kadastrale Grenzen"],xre=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function Sre(){const n=Jn(d=>d.setLayerVisibility),e=Ht(d=>d.stopTracking),{presetsPanelOpen:t,togglePresetsPanel:i,toggleSettingsPanel:r,closeAllPanels:s}=Nh(),{presets:o,applyPreset:a}=kO(),c=()=>{s(),wre.forEach(d=>n(d,!1)),xre.forEach(d=>{n(d,d==="CartoDB (licht)")}),e(),console.log(" Reset: CartoDB (licht), alle lagen uit, GPS uit")},h=d=>{a(d),s()};return T.jsxs(T.Fragment,{children:[T.jsx("button",{onClick:r,className:"fixed bottom-[45px] md:bottom-[55px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Instellingen",children:T.jsx(m3,{size:22,className:"text-gray-600"})}),T.jsx("button",{onClick:c,className:"fixed bottom-[100px] md:bottom-[110px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Reset - CartoDB, alle lagen uit, GPS uit",children:T.jsx(gx,{size:22,className:"text-gray-600"})}),T.jsx("button",{onClick:i,className:"fixed bottom-[155px] md:bottom-[165px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Presets",children:t?T.jsx(u3,{size:22,className:"text-blue-600"}):T.jsx(kg,{size:22,className:"text-blue-600"})}),T.jsx(Xs,{children:t&&T.jsxs(T.Fragment,{children:[T.jsx(Yt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),T.jsxs(Yt.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"fixed bottom-[155px] md:bottom-[165px] left-14 bg-white/95 rounded-xl shadow-lg overflow-hidden min-w-[140px] backdrop-blur-sm z-[801]",children:[T.jsx("div",{className:"px-3 py-1.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs font-medium",children:"Presets"}),T.jsx("div",{className:"p-2",children:o.map(d=>{const g=yre[d.icon]||kg,m=vre[d.icon]||"text-blue-600",y=Ere[d.icon]||"hover:bg-blue-50";return T.jsxs("button",{onClick:()=>h(d.id),className:`w-full flex items-center gap-2 px-2 py-1.5 ${y} rounded text-left transition-colors border-0 outline-none bg-transparent`,children:[T.jsx(g,{size:14,className:m}),T.jsx("span",{className:"text-xs text-gray-700",children:d.name}),!d.isBuiltIn&&T.jsx("span",{className:"ml-auto text-[10px] text-gray-400",children:"custom"})]},d.id)})})]})]})})]})}function Ire(){const{infoPanelOpen:n,toggleInfoPanel:e}=Nh();return T.jsxs(T.Fragment,{children:[T.jsx("button",{onClick:e,className:"fixed top-3 right-2.5 z-[800] w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Info & Attributies",children:T.jsx(JQ,{size:16,className:"text-gray-600"})}),T.jsx(Xs,{children:n&&T.jsxs(T.Fragment,{children:[T.jsx(Yt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),T.jsxs(Yt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[T.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[T.jsx("span",{className:"font-medium",children:"Info & Attributies"}),T.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors",children:T.jsx(qc,{size:18})})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),T.jsx("p",{className:"text-gray-600",children:"Detectorapp NL is een kaartapplicatie voor metal detecting en archeologische verkenning in Nederland."})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),T.jsxs("ul",{className:"space-y-2 text-gray-600",children:[T.jsxs("li",{children:[T.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"AMK, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN, IKAW, Bodemkaart, Geomorfologie"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Parken, etc."})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Itiner-E"})," (CC BY 4.0)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"CARTO"})," (CC BY 3.0)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"CartoDB basiskaart"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Map5.nl / Kadaster"}),T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Friesland Geoportal"}),T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"FAMKE Steentijd, Terpen"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data"})]})]})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),T.jsxs("div",{className:"text-gray-600 space-y-2",children:[T.jsxs("p",{children:[T.jsx("strong",{children:"Locatiegegevens:"})," Deze app gebruikt uw GPS-locatie alleen voor navigatie op de kaart. Locatiegegevens worden niet opgeslagen of gedeeld met derden."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Geen tracking:"})," We verzamelen geen persoonlijke gegevens, analytics of gebruiksstatistieken."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Lokale opslag:"})," Alle kaartdata wordt lokaal in de app opgeslagen. Er worden geen gegevens naar externe servers gestuurd."]})]})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Contact"}),T.jsx("p",{className:"text-gray-600",children:"Vragen of feedback? Neem contact op via de ontwikkelaar."})]}),T.jsx("section",{className:"pt-2 border-t border-gray-200",children:T.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Detectorapp NL v2.5.28"})})]})]})]})})]})}const Tre=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN4 Helling NL",color:"blue",default:.6},{name:"AHN 0.5m",color:"blue",default:.7},{name:"World Hillshade",color:"blue",default:.7},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"AMK Monumenten",color:"purple",default:.8}],Rre={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function Are(){const[n,e]=oe.useState(!1),[t,i]=oe.useState(!1),r=Jn(d=>d.visible),s=Jn(d=>d.opacity),o=Jn(d=>d.setLayerOpacity),a=Tre.filter(d=>r[d.name]);if(a.length===0)return null;const c=t?a:a.slice(0,3),h=a.length>3;return T.jsxs("div",{className:"fixed bottom-[140px] md:bottom-[150px] right-2.5 z-[900]",children:[T.jsxs(Yt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[T.jsx(mZ,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&T.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),T.jsx(Xs,{children:n&&T.jsxs(Yt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[T.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),T.jsx("div",{className:"space-y-3",children:c.map(d=>{const g=s[d.name]??d.default;return T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:d.name,children:d.name}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>o(d.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${Rre[d.color]}`}),T.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(g*100),"%"]})]})]},d.name)})}),h&&T.jsx("button",{onClick:()=>i(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?T.jsxs(T.Fragment,{children:[T.jsx(u3,{size:14}),"Minder tonen"]}):T.jsxs(T.Fragment,{children:[T.jsx(CQ,{size:14}),a.length-3," meer..."]})})]})})]})}function Pre(){const n=di(N=>N.map),e=Ht(N=>N.position),t=yn(N=>N.startNavigation);yn(N=>N.isNavigating);const i=yn(N=>N.loading),[r,s]=oe.useState(""),[o,a]=oe.useState([]),[c,h]=oe.useState(!1),[d,g]=oe.useState(!1),m=oe.useRef(null),y=oe.useRef();oe.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{g(!0);try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();D.response?.docs&&a(D.response.docs)}catch(N){console.error("Search error:",N),a([])}finally{g(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const w=async N=>{try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(N)}`)).json();if(O.response?.docs?.[0]?.centroide_ll){const k=O.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(D){console.error("Lookup error:",D)}return null},I=async N=>{if(!n)return;const D=await w(N.id);D&&n.getView().animate({center:Ka([D.lng,D.lat]),zoom:16,duration:1e3}),s(""),a([]),h(!1)},E=async(N,D)=>{if(D.stopPropagation(),!e){alert("GPS positie niet beschikbaar. Zet GPS aan.");return}const O=await w(N.id);O&&await t(O,N.weergavenaam,{lng:e.lng,lat:e.lat}),s(""),a([]),h(!1)},A=()=>{s(""),a([]),m.current?.focus()},b=N=>{switch(N){case"adres":return"";case"weg":return"";case"woonplaats":return"";case"gemeente":return"";case"provincie":return"";case"postcode":return"";default:return""}};return T.jsxs("div",{className:"search-box",children:[T.jsxs("div",{className:"search-input-wrapper",children:[T.jsx(g3,{size:18,className:"search-icon"}),T.jsx("input",{ref:m,type:"text",value:r,onChange:N=>{s(N.target.value),h(!0)},onFocus:()=>h(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),r&&T.jsx("button",{onClick:A,className:"search-clear",children:T.jsx(qc,{size:16})})]}),c&&o.length>0&&T.jsx("ul",{className:"search-results",children:o.map(N=>T.jsxs("li",{className:"search-result-item",children:[T.jsxs("div",{className:"search-result-content",onClick:()=>I(N),children:[T.jsx("span",{className:"search-result-icon",children:b(N.type)}),T.jsx("span",{className:"search-result-text",children:N.weergavenaam})]}),T.jsx("button",{className:"search-navigate-btn",onClick:D=>E(N,D),disabled:i||!e,title:e?"Navigeer hierheen":"GPS niet actief",children:T.jsx(ev,{size:16})})]},N.id))}),c&&d&&T.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function Cre(){const n=di(i=>i.map),e=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r+1,duration:200})},t=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r-1,duration:200})};return T.jsxs("div",{className:"fixed top-2.5 left-2.5 z-[800] flex flex-col gap-1",children:[T.jsx(Yt.button,{className:"w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:T.jsx(f3,{size:16,className:"text-gray-600"})}),T.jsx(Yt.button,{className:"w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:T.jsx(aZ,{size:16,className:"text-gray-600"})})]})}function bre(){const{settingsPanelOpen:n,toggleSettingsPanel:e}=Nh(),t=zs(),{presets:i,createPreset:r,deletePreset:s}=kO(),[o,a]=oe.useState(""),[c,h]=oe.useState(!1),d=()=>{o.trim()&&(r(o.trim(),"Layers"),a(""),h(!1))};return T.jsx(Xs,{children:n&&T.jsxs(T.Fragment,{children:[T.jsx(Yt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),T.jsxs(Yt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[T.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(m3,{size:18}),T.jsx("span",{className:"font-medium",children:"Instellingen"})]}),T.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:T.jsx(qc,{size:18})})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[T.jsxs($u,{title:"Kaart",icon:T.jsx(d3,{size:16}),children:[T.jsx(MM,{label:"Standaard achtergrond",children:T.jsxs("select",{value:t.defaultBackground,onChange:g=>t.setDefaultBackground(g.target.value),className:"px-2 py-1 text-sm bg-gray-100 rounded border-0 outline-none",children:[T.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),T.jsx("option",{value:"OpenStreetMap",children:"OSM"}),T.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),T.jsx(Wu,{label:"Schaalbalk tonen",checked:t.showScaleBar,onChange:t.setShowScaleBar})]}),T.jsxs($u,{title:"GPS",icon:T.jsx(ev,{size:16}),children:[T.jsx(Wu,{label:"GPS aan bij start",checked:t.gpsAutoStart,onChange:t.setGpsAutoStart}),T.jsx(Wu,{label:"Kaart draait mee (heading up)",checked:t.headingUpMode,onChange:t.setHeadingUpMode}),T.jsx(Wu,{label:"Nauwkeurigheidscirkel",checked:t.showAccuracyCircle,onChange:t.setShowAccuracyCircle})]}),T.jsx($u,{title:"Feedback",icon:T.jsx(_Z,{size:16}),children:T.jsx(Wu,{label:"Trillen bij acties",checked:t.hapticFeedback,onChange:t.setHapticFeedback})}),T.jsx($u,{title:"Weergave",icon:T.jsx(IZ,{size:16}),children:T.jsx(MM,{label:"Tekstgrootte",children:T.jsxs("select",{value:t.fontSize,onChange:g=>t.setFontSize(g.target.value),className:"px-2 py-1 text-sm bg-gray-100 rounded border-0 outline-none",children:[T.jsx("option",{value:"small",children:"Klein"}),T.jsx("option",{value:"medium",children:"Normaal"}),T.jsx("option",{value:"large",children:"Groot"})]})})}),T.jsxs($u,{title:"Vondsten",icon:T.jsx(Jy,{size:16}),children:[T.jsx(Wu,{label:"Vondsten knop tonen",checked:t.showVondstButton,onChange:t.setShowVondstButton}),T.jsx("p",{className:"text-xs text-gray-500 mt-1 py-1",children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),T.jsx(Mre,{})]}),T.jsx($u,{title:"Presets",icon:T.jsx(kg,{size:16}),children:T.jsxs("div",{className:"space-y-2",children:[i.map(g=>T.jsxs("div",{className:"flex items-center justify-between py-1",children:[T.jsxs("span",{className:"text-sm text-gray-600",children:[g.name,g.isBuiltIn&&T.jsx("span",{className:"ml-1 text-[10px] text-gray-400",children:"(standaard)"})]}),!g.isBuiltIn&&T.jsx("button",{onClick:()=>s(g.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:T.jsx(p3,{size:14})})]},g.id)),c?T.jsxs("div",{className:"flex gap-2 mt-2",children:[T.jsx("input",{type:"text",value:o,onChange:g=>a(g.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 text-sm bg-gray-100 rounded border-0 outline-none",onKeyDown:g=>g.key==="Enter"&&d(),autoFocus:!0}),T.jsx("button",{onClick:d,className:"px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",children:"Opslaan"}),T.jsx("button",{onClick:()=>h(!1),className:"px-2 py-1 text-xs bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",children:"Annuleren"})]}):T.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",children:[T.jsx(f3,{size:14}),T.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),T.jsx("div",{className:"px-4 py-2 border-t border-gray-100 text-xs text-gray-400 text-center",children:"Instellingen worden lokaal opgeslagen"})]})]})})}function $u({title:n,icon:e,children:t}){return T.jsxs("section",{children:[T.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[T.jsx("span",{className:"text-blue-600",children:e}),T.jsx("span",{className:"font-medium text-gray-800 text-sm",children:n})]}),T.jsx("div",{className:"space-y-2",children:t})]})}function MM({label:n,children:e}){return T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("span",{className:"text-sm text-gray-600",children:n}),e]})}function Wu({label:n,checked:e,onChange:t}){return T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("span",{className:"text-sm text-gray-600",children:n}),T.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-colors border-0 outline-none relative ${e?"bg-blue-500":"bg-gray-300"}`,children:T.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow transition-transform ${e?"translate-x-5":"translate-x-0.5"}`})})]})}function Mre(){const{vondsten:n,exportAsGeoJSON:e}=nv();return T.jsxs("button",{onClick:e,disabled:n.length===0,className:`flex items-center gap-2 mt-2 px-2 py-1.5 text-sm rounded transition-colors border-0 outline-none w-full ${n.length===0?"text-gray-400 bg-gray-100 cursor-not-allowed":"text-blue-600 hover:bg-blue-50"}`,children:[T.jsx(WQ,{size:14}),T.jsxs("span",{children:["Exporteer vondsten (",n.length,")"]})]})}function kre(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function Lre(n,e){let t=1/0,i=0;for(let r=0;r<e.length;r++){const s=kre(n,e[r]);s<t&&(t=s,i=r)}return i}function Nre(){const n=di(a=>a.map),e=yn(a=>a.routeCoordinates),t=yn(a=>a.destination),i=yn(a=>a.isNavigating),r=Ht(a=>a.position),s=oe.useRef(null),o=oe.useRef(0);return oe.useEffect(()=>{if(!n)return;const a=new ay;return s.current=new fy({source:a,zIndex:500}),n.addLayer(s.current),()=>{s.current&&n&&n.removeLayer(s.current)}},[n]),oe.useEffect(()=>{i||(o.current=0)},[i]),oe.useEffect(()=>{if(!s.current)return;const a=s.current.getSource();if(!a||(a.clear(),!i||!e||e.length===0))return;let c=0;if(r&&e.length>2){const m={lng:r.lng,lat:r.lat},y=Lre(m,e);y>o.current&&(o.current=y),c=o.current,c>e.length-2&&(c=e.length-2)}const d=e.slice(c).map(m=>Ka([m.lng,m.lat])),g=new mc({geometry:new yc(d)});if(g.setStyle([new Ii({stroke:new Ro({color:"white",width:8,lineCap:"round",lineJoin:"round"})}),new Ii({stroke:new Ro({color:"#4285F4",width:5,lineCap:"round",lineJoin:"round"})})]),a.addFeature(g),t){const m=new mc({geometry:new qa(Ka([t.lng,t.lat]))});m.setStyle(new Ii({image:new Gc({radius:12,fill:new es({color:"#EA4335"}),stroke:new Ro({color:"white",width:3})})})),a.addFeature(m)}if(n&&c===0){const m=a.getExtent();n.getView().fit(m,{padding:[80,80,80,80],duration:500})}},[n,i,e,t,r]),null}function Ore(n){const e={size:24,className:"text-white"};return n.includes("left")?n.includes("sharp")?T.jsx(UQ,{...e}):n.includes("slight")?T.jsx(wQ,{...e}):T.jsx(_Q,{...e}):n.includes("right")?n.includes("sharp")?T.jsx(zQ,{...e}):n.includes("slight")?T.jsx(SQ,{...e}):T.jsx(vQ,{...e}):n.includes("uturn")?T.jsx(gx,{...e}):n.includes("arrive")?T.jsx(VQ,{...e}):n.includes("roundabout")||n.includes("rotary")?T.jsx(gx,{...e}):T.jsx(TQ,{...e})}function Dre(){const n=yn(m=>m.isNavigating),e=yn(m=>m.destinationName),t=yn(m=>m.distance),i=yn(m=>m.duration),r=yn(m=>m.steps),s=yn(m=>m.currentStepIndex),o=yn(m=>m.voiceEnabled),a=yn(m=>m.setVoiceEnabled),c=yn(m=>m.stopNavigation),h=r[s],d=m=>m?m<1e3?`${Math.round(m)} m`:`${(m/1e3).toFixed(1)} km`:"--",g=m=>{if(!m)return"--";if(m<60)return`${Math.round(m)} sec`;const y=Math.round(m/60);if(y<60)return`${y} min`;const w=Math.floor(y/60),I=y%60;return`${w}u ${I}m`};return T.jsx(Xs,{children:n&&T.jsxs(Yt.div,{className:"fixed top-16 left-2 right-2 z-[1100] bg-white rounded-xl shadow-md overflow-hidden",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:[h&&T.jsxs("div",{className:"bg-blue-600 px-4 py-3 flex items-center gap-3",children:[T.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-700 flex items-center justify-center flex-shrink-0",children:Ore(h.maneuver)}),T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsx("div",{className:"text-white font-bold text-lg truncate",children:h.instruction}),T.jsxs("div",{className:"text-blue-200 text-sm",children:["Over ",d(h.distance)]})]}),T.jsx("button",{onClick:()=>a(!o),className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-colors ${o?"bg-blue-700 text-white":"bg-blue-800 text-blue-400"}`,title:o?"Geluid uit":"Geluid aan",children:o?T.jsx(RZ,{size:20}):T.jsx(PZ,{size:20})})]}),T.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[T.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:T.jsx(ev,{size:20,className:"text-gray-600"})}),T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[T.jsx(Jy,{size:12}),T.jsx("span",{children:"Bestemming"})]}),T.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:e||"Bestemming"})]}),T.jsxs("div",{className:"text-right flex-shrink-0",children:[T.jsx("div",{className:"text-lg font-bold text-blue-600",children:d(t)}),T.jsx("div",{className:"text-xs text-gray-500",children:g(i)})]}),T.jsx("button",{onClick:c,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center flex-shrink-0 transition-colors",title:"Stop navigatie",children:T.jsx(qc,{size:20,className:"text-white"})})]}),r.length>1&&T.jsxs("div",{className:"px-4 pb-2",children:[T.jsx("div",{className:"flex gap-1",children:r.map((m,y)=>T.jsx("div",{className:`h-1 flex-1 rounded-full transition-colors ${y<s?"bg-green-500":y===s?"bg-blue-500":"bg-gray-200"}`},y))}),T.jsxs("div",{className:"text-xs text-gray-400 mt-1 text-center",children:["Stap ",s+1," van ",r.length]})]})]})})}function Vre({onClose:n}){const e=x4(O=>O.user),t=Ht(O=>O.position),i=MH(O=>O.addVondst),r=nv(O=>O.addVondst),s=zs(O=>O.vondstenLocalOnly),[o,a]=oe.useState(""),[c,h]=oe.useState("Munt"),[d,g]=oe.useState("Brons"),[m,y]=oe.useState("Romeins (12 v.Chr.-450 n.Chr.)"),[w,I]=oe.useState(20),[E,A]=oe.useState(!0),[b,N]=oe.useState(!1),D=async O=>{if(O.preventDefault(),!!t){if(!s&&!e){alert("Log in om vondsten in de cloud op te slaan");return}N(!0);try{s?(r({location:{lat:t.lat,lng:t.lng},notes:o,objectType:c,material:d,period:m,depth:w}),alert("Vondst lokaal opgeslagen! ")):(await i({userId:e.uid,location:{lat:t.lat,lng:t.lng,accuracy:5},timestamp:new Date().toISOString(),photos:[],notes:o,objectType:c,material:d,period:m,depth:w,tags:[m.toLowerCase(),c.toLowerCase()],private:E}),alert("Vondst opgeslagen in cloud! ")),n()}catch($){alert("Fout bij opslaan: "+$.message)}finally{N(!1)}}};return T.jsx(Yt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:T.jsxs(Yt.div,{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[T.jsxs("div",{className:"sticky top-0 bg-blue-600 text-white px-4 py-3 flex justify-between items-center",children:[T.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),T.jsx("button",{onClick:n,className:"text-2xl",children:""})]}),T.jsxs("form",{onSubmit:D,className:"p-4 space-y-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium mb-1",children:"Locatie (GPS)"}),T.jsx("div",{className:"text-sm text-gray-600",children:t?T.jsxs(T.Fragment,{children:["Lat: ",t.lat.toFixed(6),", Lng: ",t.lng.toFixed(6)]}):T.jsx("span",{className:"text-red-600",children:" GPS niet actief"})})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium mb-1",children:"Object type"}),T.jsxs("select",{value:c,onChange:O=>h(O.target.value),className:"w-full border rounded px-3 py-2",children:[T.jsx("option",{children:"Munt"}),T.jsx("option",{children:"Aardewerk"}),T.jsx("option",{children:"Gesp"}),T.jsx("option",{children:"Fibula"}),T.jsx("option",{children:"Ring"}),T.jsx("option",{children:"Speld"}),T.jsx("option",{children:"Sieraad"}),T.jsx("option",{children:"Gereedschap"}),T.jsx("option",{children:"Wapen"}),T.jsx("option",{children:"Anders"})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium mb-1",children:"Materiaal"}),T.jsxs("select",{value:d,onChange:O=>g(O.target.value),className:"w-full border rounded px-3 py-2",children:[T.jsx("option",{children:"Brons"}),T.jsx("option",{children:"IJzer"}),T.jsx("option",{children:"Zilver"}),T.jsx("option",{children:"Goud"}),T.jsx("option",{children:"Keramiek"}),T.jsx("option",{children:"Steen"}),T.jsx("option",{children:"Glas"}),T.jsx("option",{children:"Onbekend"})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium mb-1",children:"Periode"}),T.jsxs("select",{value:m,onChange:O=>y(O.target.value),className:"w-full border rounded px-3 py-2",children:[T.jsx("option",{children:"Romeins (12 v.Chr.-450 n.Chr.)"}),T.jsx("option",{children:"IJzertijd"}),T.jsx("option",{children:"Middeleeuws (450-1500)"}),T.jsx("option",{children:"Nieuwetijd (1500-1800)"}),T.jsx("option",{children:"Modern (1800+)"}),T.jsx("option",{children:"Onbekend"})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium mb-1",children:"Diepte (cm)"}),T.jsx("input",{type:"number",value:w,onChange:O=>I(parseInt(O.target.value)),className:"w-full border rounded px-3 py-2",min:"0",max:"200"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notities"}),T.jsx("textarea",{value:o,onChange:O=>a(O.target.value),className:"w-full border rounded px-3 py-2 h-24",placeholder:"Beschrijving, omstandigheden, etc..."})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{type:"checkbox",checked:E,onChange:O=>A(O.target.checked),id:"private"}),T.jsx("label",{htmlFor:"private",className:"text-sm",children:"Priv (alleen jij kunt deze vondst zien)"})]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 border rounded hover:bg-gray-50",children:"Annuleren"}),T.jsx("button",{type:"submit",disabled:b||!t,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:b?"Opslaan...":"Opslaan"})]})]})]})})}function Fre(){const{user:n,setUser:e,setLoading:t}=x4();return oe.useEffect(()=>{const s=U$(IE,o=>{e(o),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await O$(IE)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await B$(IE)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function jre(){const[n,e]=oe.useState(!1),{isAuthenticated:t,loginAnonymous:i}=Fre(),r=zs(a=>a.vondstenLocalOnly);if(!zs(a=>a.showVondstButton))return null;const o=()=>{if(r){e(!0);return}if(!t){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&i();return}e(!0)};return T.jsxs(T.Fragment,{children:[T.jsx(Yt.button,{className:"fixed bottom-[30px] md:bottom-10 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:o,title:"Vondst toevoegen",children:T.jsx(Jy,{size:22,strokeWidth:2})}),T.jsx(Xs,{children:n&&T.jsx(Vre,{onClose:()=>e(!1)})})]})}const kM={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},Gre={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function Ure(){const n=di(r=>r.map),e=nv(r=>r.vondsten),t=Jn(r=>r.visible["Mijn Vondsten"]),i=oe.useRef(null);return oe.useEffect(()=>{if(!n)return;const r=new ay;return e.forEach(s=>{const o=new mc({geometry:new qa(Ka([s.location.lng,s.location.lat])),vondst:s}),a=kM[s.objectType]||kM.Anders,c=Gre[s.objectType]||"?";o.setStyle(new Ii({image:new Gc({radius:12,fill:new es({color:a}),stroke:new Ro({color:"#ffffff",width:2})}),text:new uy({text:c,font:"bold 10px sans-serif",fill:new es({color:"#ffffff"}),offsetY:1})})),r.addFeature(o)}),i.current?i.current.setSource(r):(i.current=new fy({source:r,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),i.current.setVisible(t),n.addLayer(i.current)),()=>{i.current&&n&&(n.removeLayer(i.current),i.current=null)}},[n,e]),oe.useEffect(()=>{i.current&&i.current.setVisible(t)},[t]),null}function Bre(){const n=Ht(i=>i.tracking),e=Ht(i=>i.headingSource),t=Ht(i=>i.updateHeading);oe.useEffect(()=>{if(!n||e!=="compass")return;let i=0;const r=100,s=c=>{const h=Date.now();h-i<r||(i=h,c.alpha!==null&&t(360-c.alpha,"compass"))},o=c=>{const h=Date.now();h-i<r||(i=h,c.alpha!==null&&t(360-c.alpha,"compass"))},a=c=>{const h=Date.now();h-i<r||(i=h,c.webkitCompassHeading!==void 0&&t(c.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",o),window.addEventListener("deviceorientation",s),window.addEventListener("deviceorientation",a),()=>{window.removeEventListener("deviceorientationabsolute",o),window.removeEventListener("deviceorientation",s),window.removeEventListener("deviceorientation",a)}},[n,e,t])}const zre=n=>n<.5?2*n*n:-1+(4-2*n)*n;function $re(){const n=di(a=>a.map),e=di(a=>a.rotationEnabled),t=di(a=>a.setRotation),i=Ht(a=>a.smoothHeading),r=Ht(a=>a.tracking),s=zs(a=>a.headingUpMode),o=oe.useRef(null);oe.useEffect(()=>{if(!s){n&&n.getView().getRotation()!==0&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}if(!n||!r||!e||i===null){n&&!r&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}const a=-(i*Math.PI)/180,c=o.current??n.getView().getRotation();let h=a-c;for(;h>Math.PI;)h-=2*Math.PI;for(;h<-Math.PI;)h+=2*Math.PI;Math.abs(h)<.087||(n.getView().animate({rotation:a,duration:250,easing:zre}),o.current=a,t(i))},[n,r,e,i,t,s])}function Wre(){const n=di(d=>d.map),e=Ht(d=>d.position),t=Ht(d=>d.tracking),i=Ht(d=>d.navigationMode),r=Ht(d=>d.toggleMode),s=yn(d=>d.isNavigating),o=yn(d=>d.updateCurrentStep),a=yn(d=>d.destination),c=oe.useRef(!1),h=oe.useRef(0);return oe.useEffect(()=>{s&&!c.current?(console.log(" Navigation started - activating drive mode"),i==="free"&&r(),c.current=!0):!s&&c.current&&(console.log(" Navigation stopped - deactivating drive mode"),i==="drive"&&r(),c.current=!1)},[s,i,r]),oe.useEffect(()=>{!s||!e||o({lng:e.lng,lat:e.lat})},[s,e,o]),oe.useEffect(()=>{if(!n||!e||!s||!t)return;const d=Date.now();if(d-h.current<500)return;h.current=d;const g=Ka([e.lng,e.lat]);n.getView().animate({center:g,duration:300})},[n,e,s,t]),oe.useEffect(()=>{if(!n||!s)return;(n.getView().getZoom()||15)<14&&n.getView().animate({zoom:15,duration:500})},[n,s,e]),{isNavigating:s,destination:a}}function Hre(){const n=di(r=>r.map),e=Jn(r=>r.setLayerOpacity),t=Jn(r=>r.visible),i=oe.useRef(null);oe.useEffect(()=>{if(!n)return;const r=()=>{const s=n.getView().getZoom();if(!s||i.current!==null&&Math.abs(s-i.current)<.5)return;i.current=s;const o=t["AHN 0.5m"],a=t["AHN4 Multi-Hillshade NL"];!o&&!a||(o&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),a&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",r),r(),()=>{n.un("moveend",r)}},[n,t,e])}const LM={small:"text-sm",medium:"text-base",large:"text-lg"};function Kre(){Bre(),$re(),Wre(),Hre();const n=zs(t=>t.fontSize),e=LM[n]||LM.small;return T.jsxs("div",{className:e,children:[T.jsx(FH,{}),T.jsx(NZ,{}),T.jsx(Nre,{}),T.jsx(Ure,{}),T.jsx(fre,{}),T.jsx(pre,{}),T.jsx(Pre,{}),T.jsx(Dre,{}),T.jsx(LZ,{}),T.jsx(Cre,{}),T.jsx(DZ,{}),T.jsx(VZ,{}),T.jsx(Are,{}),T.jsx(_re,{}),T.jsx(Sre,{}),T.jsx(jre,{}),T.jsx(Ire,{}),T.jsx(bre,{})]})}const qre="2.5.28";console.log(`%c DetectorApp v${qre}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");r6.createRoot(document.getElementById("root")).render(T.jsx(Kre,{}));export{es as F,Hie as G,UF as I,qa as P,Ii as S,Bl as T,fy as V,Yu as X,x9 as a,g9 as b,Ro as c,ay as d,uy as e,mc as f,Ka as g,X0 as h,At as p,lre as r};
//# sourceMappingURL=index-BovP1BJX.js.map
