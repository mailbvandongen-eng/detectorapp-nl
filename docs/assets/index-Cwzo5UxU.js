const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-D61xe2dB.js","assets/iconStyles-Cbf67jVs.js","assets/amkOL-B-g6fQh9.js","assets/layerLoaderOL-C0S-6HGK.js","assets/romeinsOL-CBNlFf8u.js","assets/kastelenOL-C0h5Pn8o.js","assets/ruinesOL-DgKz60Le.js","assets/hunebeddenOL-CVXggxtl.js","assets/uikavArcheoPuntenOL-BvTudbYb.js","assets/uikavVlakkenOL-2jNxVUOF.js","assets/uikavBufferlaagOL-CAXHqLMG.js","assets/uikavExpertOL-CIme7nUs.js","assets/uikavUiterwaardenOL-D5ZfmCkJ.js","assets/speeltuinenOL-C265ItaB.js","assets/museaOL-6DERzGrH.js","assets/strandjesOL-tBUj3Sw3.js","assets/parkenOL-Dx8DOWkY.js","assets/kringloopwinkelsOL-CUQ3nnZu.js","assets/fossielenOL-Cwy79EOk.js","assets/fossielUtils-GJ2LGWOo.js","assets/fossielenBelgieOL-BhB4um7C.js","assets/fossielenDuitslandOL-lEw0NnQo.js","assets/fossielenFrankrijkOL-BCb8uYcX.js","assets/bunkersOL-C7erhsRr.js","assets/grafheuvelsOL-DRVSxQS_.js","assets/slagveldenOL-B0oXuPX5.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Jb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var b2={exports:{}},Dg={},I2={exports:{}},ln={};var kP;function OB(){if(kP)return ln;kP=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(se){return se===null||typeof se!="object"?null:(se=f&&se[f]||se["@@iterator"],typeof se=="function"?se:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function E(se,V,Q){this.props=se,this.context=V,this.refs=x,this.updater=Q||y}E.prototype.isReactComponent={},E.prototype.setState=function(se,V){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,V,"setState")},E.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function T(){}T.prototype=E.prototype;function b(se,V,Q){this.props=se,this.context=V,this.refs=x,this.updater=Q||y}var I=b.prototype=new T;I.constructor=b,v(I,E.prototype),I.isPureReactComponent=!0;var M=Array.isArray,F=Object.prototype.hasOwnProperty,G={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function C(se,V,Q){var ne,ie={},pe=null,De=null;if(V!=null)for(ne in V.ref!==void 0&&(De=V.ref),V.key!==void 0&&(pe=""+V.key),V)F.call(V,ne)&&!R.hasOwnProperty(ne)&&(ie[ne]=V[ne]);var Be=arguments.length-2;if(Be===1)ie.children=Q;else if(1<Be){for(var Ue=Array(Be),_e=0;_e<Be;_e++)Ue[_e]=arguments[_e+2];ie.children=Ue}if(se&&se.defaultProps)for(ne in Be=se.defaultProps,Be)ie[ne]===void 0&&(ie[ne]=Be[ne]);return{$$typeof:n,type:se,key:pe,ref:De,props:ie,_owner:G.current}}function P(se,V){return{$$typeof:n,type:se.type,key:V,ref:se.ref,props:se.props,_owner:se._owner}}function N(se){return typeof se=="object"&&se!==null&&se.$$typeof===n}function O(se){var V={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(Q){return V[Q]})}var z=/\/+/g;function j(se,V){return typeof se=="object"&&se!==null&&se.key!=null?O(""+se.key):V.toString(36)}function be(se,V,Q,ne,ie){var pe=typeof se;(pe==="undefined"||pe==="boolean")&&(se=null);var De=!1;if(se===null)De=!0;else switch(pe){case"string":case"number":De=!0;break;case"object":switch(se.$$typeof){case n:case e:De=!0}}if(De)return De=se,ie=ie(De),se=ne===""?"."+j(De,0):ne,M(ie)?(Q="",se!=null&&(Q=se.replace(z,"$&/")+"/"),be(ie,V,Q,"",function(_e){return _e})):ie!=null&&(N(ie)&&(ie=P(ie,Q+(!ie.key||De&&De.key===ie.key?"":(""+ie.key).replace(z,"$&/")+"/")+se)),V.push(ie)),1;if(De=0,ne=ne===""?".":ne+":",M(se))for(var Be=0;Be<se.length;Be++){pe=se[Be];var Ue=ne+j(pe,Be);De+=be(pe,V,Q,Ue,ie)}else if(Ue=g(se),typeof Ue=="function")for(se=Ue.call(se),Be=0;!(pe=se.next()).done;)pe=pe.value,Ue=ne+j(pe,Be++),De+=be(pe,V,Q,Ue,ie);else if(pe==="object")throw V=String(se),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return De}function Pe(se,V,Q){if(se==null)return se;var ne=[],ie=0;return be(se,ne,"","",function(pe){return V.call(Q,pe,ie++)}),ne}function je(se){if(se._status===-1){var V=se._result;V=V(),V.then(function(Q){(se._status===0||se._status===-1)&&(se._status=1,se._result=Q)},function(Q){(se._status===0||se._status===-1)&&(se._status=2,se._result=Q)}),se._status===-1&&(se._status=0,se._result=V)}if(se._status===1)return se._result.default;throw se._result}var Ne={current:null},ue={transition:null},Te={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:ue,ReactCurrentOwner:G};function le(){throw Error("act(...) is not supported in production builds of React.")}return ln.Children={map:Pe,forEach:function(se,V,Q){Pe(se,function(){V.apply(this,arguments)},Q)},count:function(se){var V=0;return Pe(se,function(){V++}),V},toArray:function(se){return Pe(se,function(V){return V})||[]},only:function(se){if(!N(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},ln.Component=E,ln.Fragment=t,ln.Profiler=i,ln.PureComponent=b,ln.StrictMode=r,ln.Suspense=l,ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Te,ln.act=le,ln.cloneElement=function(se,V,Q){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var ne=v({},se.props),ie=se.key,pe=se.ref,De=se._owner;if(V!=null){if(V.ref!==void 0&&(pe=V.ref,De=G.current),V.key!==void 0&&(ie=""+V.key),se.type&&se.type.defaultProps)var Be=se.type.defaultProps;for(Ue in V)F.call(V,Ue)&&!R.hasOwnProperty(Ue)&&(ne[Ue]=V[Ue]===void 0&&Be!==void 0?Be[Ue]:V[Ue])}var Ue=arguments.length-2;if(Ue===1)ne.children=Q;else if(1<Ue){Be=Array(Ue);for(var _e=0;_e<Ue;_e++)Be[_e]=arguments[_e+2];ne.children=Be}return{$$typeof:n,type:se.type,key:ie,ref:pe,props:ne,_owner:De}},ln.createContext=function(se){return se={$$typeof:a,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:s,_context:se},se.Consumer=se},ln.createElement=C,ln.createFactory=function(se){var V=C.bind(null,se);return V.type=se,V},ln.createRef=function(){return{current:null}},ln.forwardRef=function(se){return{$$typeof:o,render:se}},ln.isValidElement=N,ln.lazy=function(se){return{$$typeof:h,_payload:{_status:-1,_result:se},_init:je}},ln.memo=function(se,V){return{$$typeof:u,type:se,compare:V===void 0?null:V}},ln.startTransition=function(se){var V=ue.transition;ue.transition={};try{se()}finally{ue.transition=V}},ln.unstable_act=le,ln.useCallback=function(se,V){return Ne.current.useCallback(se,V)},ln.useContext=function(se){return Ne.current.useContext(se)},ln.useDebugValue=function(){},ln.useDeferredValue=function(se){return Ne.current.useDeferredValue(se)},ln.useEffect=function(se,V){return Ne.current.useEffect(se,V)},ln.useId=function(){return Ne.current.useId()},ln.useImperativeHandle=function(se,V,Q){return Ne.current.useImperativeHandle(se,V,Q)},ln.useInsertionEffect=function(se,V){return Ne.current.useInsertionEffect(se,V)},ln.useLayoutEffect=function(se,V){return Ne.current.useLayoutEffect(se,V)},ln.useMemo=function(se,V){return Ne.current.useMemo(se,V)},ln.useReducer=function(se,V,Q){return Ne.current.useReducer(se,V,Q)},ln.useRef=function(se){return Ne.current.useRef(se)},ln.useState=function(se){return Ne.current.useState(se)},ln.useSyncExternalStore=function(se,V,Q){return Ne.current.useSyncExternalStore(se,V,Q)},ln.useTransition=function(){return Ne.current.useTransition()},ln.version="18.3.1",ln}var PP;function Gp(){return PP||(PP=1,I2.exports=OB()),I2.exports}var MP;function DB(){if(MP)return Dg;MP=1;var n=Gp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,u){var h,f={},g=null,y=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(f[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:o,key:g,ref:y,props:f,_owner:i.current}}return Dg.Fragment=t,Dg.jsx=a,Dg.jsxs=a,Dg}var NP;function FB(){return NP||(NP=1,b2.exports=DB()),b2.exports}var m=FB(),jy={},A2={exports:{}},xs={},R2={exports:{}},C2={};var LP;function jB(){return LP||(LP=1,(function(n){function e(ue,Te){var le=ue.length;ue.push(Te);e:for(;0<le;){var se=le-1>>>1,V=ue[se];if(0<i(V,Te))ue[se]=Te,ue[le]=V,le=se;else break e}}function t(ue){return ue.length===0?null:ue[0]}function r(ue){if(ue.length===0)return null;var Te=ue[0],le=ue.pop();if(le!==Te){ue[0]=le;e:for(var se=0,V=ue.length,Q=V>>>1;se<Q;){var ne=2*(se+1)-1,ie=ue[ne],pe=ne+1,De=ue[pe];if(0>i(ie,le))pe<V&&0>i(De,ie)?(ue[se]=De,ue[pe]=le,se=pe):(ue[se]=ie,ue[ne]=le,se=ne);else if(pe<V&&0>i(De,le))ue[se]=De,ue[pe]=le,se=pe;else break e}}return Te}function i(ue,Te){var le=ue.sortIndex-Te.sortIndex;return le!==0?le:ue.id-Te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,f=null,g=3,y=!1,v=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(ue){for(var Te=t(u);Te!==null;){if(Te.callback===null)r(u);else if(Te.startTime<=ue)r(u),Te.sortIndex=Te.expirationTime,e(l,Te);else break;Te=t(u)}}function M(ue){if(x=!1,I(ue),!v)if(t(l)!==null)v=!0,je(F);else{var Te=t(u);Te!==null&&Ne(M,Te.startTime-ue)}}function F(ue,Te){v=!1,x&&(x=!1,T(C),C=-1),y=!0;var le=g;try{for(I(Te),f=t(l);f!==null&&(!(f.expirationTime>Te)||ue&&!O());){var se=f.callback;if(typeof se=="function"){f.callback=null,g=f.priorityLevel;var V=se(f.expirationTime<=Te);Te=n.unstable_now(),typeof V=="function"?f.callback=V:f===t(l)&&r(l),I(Te)}else r(l);f=t(l)}if(f!==null)var Q=!0;else{var ne=t(u);ne!==null&&Ne(M,ne.startTime-Te),Q=!1}return Q}finally{f=null,g=le,y=!1}}var G=!1,R=null,C=-1,P=5,N=-1;function O(){return!(n.unstable_now()-N<P)}function z(){if(R!==null){var ue=n.unstable_now();N=ue;var Te=!0;try{Te=R(!0,ue)}finally{Te?j():(G=!1,R=null)}}else G=!1}var j;if(typeof b=="function")j=function(){b(z)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,Pe=be.port2;be.port1.onmessage=z,j=function(){Pe.postMessage(null)}}else j=function(){E(z,0)};function je(ue){R=ue,G||(G=!0,j())}function Ne(ue,Te){C=E(function(){ue(n.unstable_now())},Te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){v||y||(v=!0,je(F))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ue){switch(g){case 1:case 2:case 3:var Te=3;break;default:Te=g}var le=g;g=Te;try{return ue()}finally{g=le}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,Te){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var le=g;g=ue;try{return Te()}finally{g=le}},n.unstable_scheduleCallback=function(ue,Te,le){var se=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?se+le:se):le=se,ue){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=le+V,ue={id:h++,callback:Te,priorityLevel:ue,startTime:le,expirationTime:V,sortIndex:-1},le>se?(ue.sortIndex=le,e(u,ue),t(l)===null&&ue===t(u)&&(x?(T(C),C=-1):x=!0,Ne(M,le-se))):(ue.sortIndex=V,e(l,ue),v||y||(v=!0,je(F))),ue},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(ue){var Te=g;return function(){var le=g;g=Te;try{return ue.apply(this,arguments)}finally{g=le}}}})(C2)),C2}var OP;function VB(){return OP||(OP=1,R2.exports=jB()),R2.exports}var DP;function GB(){if(DP)return xs;DP=1;var n=Gp(),e=VB();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(c,d){a(c,d),a(c+"Capture",d)}function a(c,d){for(i[c]=d,c=0;c<d.length;c++)r.add(d[c])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(c){return l.call(f,c)?!0:l.call(h,c)?!1:u.test(c)?f[c]=!0:(h[c]=!0,!1)}function y(c,d,p,w){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function v(c,d,p,w){if(d===null||typeof d>"u"||y(c,d,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(c,d,p,w,S,A,B){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=w,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=c,this.type=d,this.sanitizeURL=A,this.removeEmptyString=B}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){E[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];E[d]=new x(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){E[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){E[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){E[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){E[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){E[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){E[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){E[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function b(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),E.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function I(c,d,p,w){var S=E.hasOwnProperty(d)?E[d]:null;(S!==null?S.type!==0:w||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(v(d,p,S,w)&&(p=null),w||S===null?g(d)&&(p===null?c.removeAttribute(d):c.setAttribute(d,""+p)):S.mustUseProperty?c[S.propertyName]=p===null?S.type===3?!1:"":p:(d=S.attributeName,w=S.attributeNamespace,p===null?c.removeAttribute(d):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,w?c.setAttributeNS(w,d,p):c.setAttribute(d,p))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),G=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),O=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),be=Symbol.for("react.suspense_list"),Pe=Symbol.for("react.memo"),je=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),ue=Symbol.iterator;function Te(c){return c===null||typeof c!="object"?null:(c=ue&&c[ue]||c["@@iterator"],typeof c=="function"?c:null)}var le=Object.assign,se;function V(c){if(se===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);se=d&&d[1]||""}return`
`+se+c}var Q=!1;function ne(c,d){if(!c||Q)return"";Q=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Ae){var w=Ae}Reflect.construct(c,[],d)}else{try{d.call()}catch(Ae){w=Ae}c.call(d.prototype)}else{try{throw Error()}catch(Ae){w=Ae}c()}}catch(Ae){if(Ae&&w&&typeof Ae.stack=="string"){for(var S=Ae.stack.split(`
`),A=w.stack.split(`
`),B=S.length-1,re=A.length-1;1<=B&&0<=re&&S[B]!==A[re];)re--;for(;1<=B&&0<=re;B--,re--)if(S[B]!==A[re]){if(B!==1||re!==1)do if(B--,re--,0>re||S[B]!==A[re]){var ae=`
`+S[B].replace(" at new "," at ");return c.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",c.displayName)),ae}while(1<=B&&0<=re);break}}}finally{Q=!1,Error.prepareStackTrace=p}return(c=c?c.displayName||c.name:"")?V(c):""}function ie(c){switch(c.tag){case 5:return V(c.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return c=ne(c.type,!1),c;case 11:return c=ne(c.type.render,!1),c;case 1:return c=ne(c.type,!0),c;default:return""}}function pe(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case R:return"Fragment";case G:return"Portal";case P:return"Profiler";case C:return"StrictMode";case j:return"Suspense";case be:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case O:return(c.displayName||"Context")+".Consumer";case N:return(c._context.displayName||"Context")+".Provider";case z:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case Pe:return d=c.displayName||null,d!==null?d:pe(c.type)||"Memo";case je:d=c._payload,c=c._init;try{return pe(c(d))}catch{}}return null}function De(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(d);case 8:return d===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Be(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Ue(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function _e(c){var d=Ue(c)?"checked":"value",p=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),w=""+c[d];if(!c.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,A=p.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return S.call(this)},set:function(B){w=""+B,A.call(this,B)}}),Object.defineProperty(c,d,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(B){w=""+B},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function Ct(c){c._valueTracker||(c._valueTracker=_e(c))}function kt(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var p=d.getValue(),w="";return c&&(w=Ue(c)?c.checked?"true":"false":c.value),c=w,c!==p?(d.setValue(c),!0):!1}function hn(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Mt(c,d){var p=d.checked;return le({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??c._wrapperState.initialChecked})}function jn(c,d){var p=d.defaultValue==null?"":d.defaultValue,w=d.checked!=null?d.checked:d.defaultChecked;p=Be(d.value!=null?d.value:p),c._wrapperState={initialChecked:w,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Qt(c,d){d=d.checked,d!=null&&I(c,"checked",d,!1)}function ot(c,d){Qt(c,d);var p=Be(d.value),w=d.type;if(p!=null)w==="number"?(p===0&&c.value===""||c.value!=p)&&(c.value=""+p):c.value!==""+p&&(c.value=""+p);else if(w==="submit"||w==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?on(c,d.type,p):d.hasOwnProperty("defaultValue")&&on(c,d.type,Be(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function Zn(c,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var w=d.type;if(!(w!=="submit"&&w!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,p||d===c.value||(c.value=d),c.defaultValue=d}p=c.name,p!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,p!==""&&(c.name=p)}function on(c,d,p){(d!=="number"||hn(c.ownerDocument)!==c)&&(p==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+p&&(c.defaultValue=""+p))}var en=Array.isArray;function Qn(c,d,p,w){if(c=c.options,d){d={};for(var S=0;S<p.length;S++)d["$"+p[S]]=!0;for(p=0;p<c.length;p++)S=d.hasOwnProperty("$"+c[p].value),c[p].selected!==S&&(c[p].selected=S),S&&w&&(c[p].defaultSelected=!0)}else{for(p=""+Be(p),d=null,S=0;S<c.length;S++){if(c[S].value===p){c[S].selected=!0,w&&(c[S].defaultSelected=!0);return}d!==null||c[S].disabled||(d=c[S])}d!==null&&(d.selected=!0)}}function mt(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return le({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function Bt(c,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(en(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}c._wrapperState={initialValue:Be(p)}}function Mn(c,d){var p=Be(d.value),w=Be(d.defaultValue);p!=null&&(p=""+p,p!==c.value&&(c.value=p),d.defaultValue==null&&c.defaultValue!==p&&(c.defaultValue=p)),w!=null&&(c.defaultValue=""+w)}function _t(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function Jt(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pt(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?Jt(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var sr,ai=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,w,S){MSApp.execUnsafeLocalFunction(function(){return c(d,p,w,S)})}:c})(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for(sr=sr||document.createElement("div"),sr.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=sr.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function Br(c,d){if(d){var p=c.firstChild;if(p&&p===c.lastChild&&p.nodeType===3){p.nodeValue=d;return}}c.textContent=d}var zt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ns=["Webkit","ms","Moz","O"];Object.keys(zt).forEach(function(c){ns.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),zt[d]=zt[c]})});function Oe(c,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||zt.hasOwnProperty(c)&&zt[c]?(""+d).trim():d+"px"}function Ee(c,d){c=c.style;for(var p in d)if(d.hasOwnProperty(p)){var w=p.indexOf("--")===0,S=Oe(p,d[p],w);p==="float"&&(p="cssFloat"),w?c.setProperty(p,S):c[p]=S}}var me=le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nt(c,d){if(d){if(me[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function L(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lt=null;function W(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var q=null,X=null,ce=null;function he(c){if(c=wg(c)){if(typeof q!="function")throw Error(t(280));var d=c.stateNode;d&&(d=J1(d),q(c.stateNode,c.type,d))}}function Ve(c){X?ce?ce.push(c):ce=[c]:X=c}function Ie(){if(X){var c=X,d=ce;if(ce=X=null,he(c),d)for(c=0;c<d.length;c++)he(d[c])}}function $e(c,d){return c(d)}function et(){}var ft=!1;function St(c,d,p){if(ft)return c(d,p);ft=!0;try{return $e(c,d,p)}finally{ft=!1,(X!==null||ce!==null)&&(et(),Ie())}}function sn(c,d){var p=c.stateNode;if(p===null)return null;var w=J1(p);if(w===null)return null;p=w[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(c=c.type,w=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!w;break e;default:c=!1}if(c)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var dr=!1;if(o)try{var cn={};Object.defineProperty(cn,"passive",{get:function(){dr=!0}}),window.addEventListener("test",cn,cn),window.removeEventListener("test",cn,cn)}catch{dr=!1}function fr(c,d,p,w,S,A,B,re,ae){var Ae=Array.prototype.slice.call(arguments,3);try{d.apply(p,Ae)}catch(He){this.onError(He)}}var vr=!1,Fi=null,U=!1,Z=null,K={onError:function(c){vr=!0,Fi=c}};function Y(c,d,p,w,S,A,B,re,ae){vr=!1,Fi=null,fr.apply(K,arguments)}function J(c,d,p,w,S,A,B,re,ae){if(Y.apply(this,arguments),vr){if(vr){var Ae=Fi;vr=!1,Fi=null}else throw Error(t(198));U||(U=!0,Z=Ae)}}function te(c){var d=c,p=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(p=d.return),c=d.return;while(c)}return d.tag===3?p:null}function xe(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function ke(c){if(te(c)!==c)throw Error(t(188))}function ye(c){var d=c.alternate;if(!d){if(d=te(c),d===null)throw Error(t(188));return d!==c?null:c}for(var p=c,w=d;;){var S=p.return;if(S===null)break;var A=S.alternate;if(A===null){if(w=S.return,w!==null){p=w;continue}break}if(S.child===A.child){for(A=S.child;A;){if(A===p)return ke(S),c;if(A===w)return ke(S),d;A=A.sibling}throw Error(t(188))}if(p.return!==w.return)p=S,w=A;else{for(var B=!1,re=S.child;re;){if(re===p){B=!0,p=S,w=A;break}if(re===w){B=!0,w=S,p=A;break}re=re.sibling}if(!B){for(re=A.child;re;){if(re===p){B=!0,p=A,w=S;break}if(re===w){B=!0,w=A,p=S;break}re=re.sibling}if(!B)throw Error(t(189))}}if(p.alternate!==w)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?c:d}function we(c){return c=ye(c),c!==null?Se(c):null}function Se(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=Se(c);if(d!==null)return d;c=c.sibling}return null}var Ke=e.unstable_scheduleCallback,tt=e.unstable_cancelCallback,gt=e.unstable_shouldYield,Ye=e.unstable_requestPaint,Xe=e.unstable_now,$t=e.unstable_getCurrentPriorityLevel,Nn=e.unstable_ImmediatePriority,Vn=e.unstable_UserBlockingPriority,gr=e.unstable_NormalPriority,La=e.unstable_LowPriority,la=e.unstable_IdlePriority,Ds=null,Or=null;function nc(c){if(Or&&typeof Or.onCommitFiberRoot=="function")try{Or.onCommitFiberRoot(Ds,c,void 0,(c.current.flags&128)===128)}catch{}}var wr=Math.clz32?Math.clz32:Nu,go=Math.log,ca=Math.LN2;function Nu(c){return c>>>=0,c===0?32:31-(go(c)/ca|0)|0}var mo=64,rc=4194304;function An(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function ol(c,d){var p=c.pendingLanes;if(p===0)return 0;var w=0,S=c.suspendedLanes,A=c.pingedLanes,B=p&268435455;if(B!==0){var re=B&~S;re!==0?w=An(re):(A&=B,A!==0&&(w=An(A)))}else B=p&~S,B!==0?w=An(B):A!==0&&(w=An(A));if(w===0)return 0;if(d!==0&&d!==w&&(d&S)===0&&(S=w&-w,A=d&-d,S>=A||S===16&&(A&4194240)!==0))return d;if((w&4)!==0&&(w|=p&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=w;0<d;)p=31-wr(d),S=1<<p,w|=c[p],d&=~S;return w}function Lu(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ou(c,d){for(var p=c.suspendedLanes,w=c.pingedLanes,S=c.expirationTimes,A=c.pendingLanes;0<A;){var B=31-wr(A),re=1<<B,ae=S[B];ae===-1?((re&p)===0||(re&w)!==0)&&(S[B]=Lu(re,d)):ae<=d&&(c.expiredLanes|=re),A&=~re}}function eg(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function tg(){var c=mo;return mo<<=1,(mo&4194240)===0&&(mo=64),c}function ng(c){for(var d=[],p=0;31>p;p++)d.push(c);return d}function Du(c,d,p){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-wr(d),c[d]=p}function rE(c,d){var p=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var w=c.eventTimes;for(c=c.expirationTimes;0<p;){var S=31-wr(p),A=1<<S;d[S]=0,w[S]=-1,c[S]=-1,p&=~A}}function rg(c,d){var p=c.entangledLanes|=d;for(c=c.entanglements;p;){var w=31-wr(p),S=1<<w;S&d|c[w]&d&&(c[w]|=d),p&=~S}}var mn=0;function po(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var ig,Rd,sg,ag,og,yo=!1,Cd=[],_o=null,xo=null,wi=null,Fu=new Map,ll=new Map,Fs=[],F1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ic(c,d){switch(c){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":xo=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":Fu.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":ll.delete(d.pointerId)}}function Oa(c,d,p,w,S,A){return c===null||c.nativeEvent!==A?(c={blockedOn:d,domEventName:p,eventSystemFlags:w,nativeEvent:A,targetContainers:[S]},d!==null&&(d=wg(d),d!==null&&Rd(d)),c):(c.eventSystemFlags|=w,d=c.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),c)}function j1(c,d,p,w,S){switch(d){case"focusin":return _o=Oa(_o,c,d,p,w,S),!0;case"dragenter":return xo=Oa(xo,c,d,p,w,S),!0;case"mouseover":return wi=Oa(wi,c,d,p,w,S),!0;case"pointerover":var A=S.pointerId;return Fu.set(A,Oa(Fu.get(A)||null,c,d,p,w,S)),!0;case"gotpointercapture":return A=S.pointerId,ll.set(A,Oa(ll.get(A)||null,c,d,p,w,S)),!0}return!1}function kd(c){var d=Bu(c.target);if(d!==null){var p=te(d);if(p!==null){if(d=p.tag,d===13){if(d=xe(p),d!==null){c.blockedOn=d,og(c.priority,function(){sg(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){c.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Jn(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var p=Pd(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(p===null){p=c.nativeEvent;var w=new p.constructor(p.type,p);Lt=w,p.target.dispatchEvent(w),Lt=null}else return d=wg(p),d!==null&&Rd(d),c.blockedOn=p,!1;d.shift()}return!0}function V1(c,d,p){Jn(c)&&p.delete(d)}function iE(){yo=!1,_o!==null&&Jn(_o)&&(_o=null),xo!==null&&Jn(xo)&&(xo=null),wi!==null&&Jn(wi)&&(wi=null),Fu.forEach(V1),ll.forEach(V1)}function sc(c,d){c.blockedOn===d&&(c.blockedOn=null,yo||(yo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,iE)))}function ac(c){function d(S){return sc(S,c)}if(0<Cd.length){sc(Cd[0],c);for(var p=1;p<Cd.length;p++){var w=Cd[p];w.blockedOn===c&&(w.blockedOn=null)}}for(_o!==null&&sc(_o,c),xo!==null&&sc(xo,c),wi!==null&&sc(wi,c),Fu.forEach(d),ll.forEach(d),p=0;p<Fs.length;p++)w=Fs[p],w.blockedOn===c&&(w.blockedOn=null);for(;0<Fs.length&&(p=Fs[0],p.blockedOn===null);)kd(p),p.blockedOn===null&&Fs.shift()}var cl=M.ReactCurrentBatchConfig,ul=!0;function vo(c,d,p,w){var S=mn,A=cl.transition;cl.transition=null;try{mn=1,lg(c,d,p,w)}finally{mn=S,cl.transition=A}}function G1(c,d,p,w){var S=mn,A=cl.transition;cl.transition=null;try{mn=4,lg(c,d,p,w)}finally{mn=S,cl.transition=A}}function lg(c,d,p,w){if(ul){var S=Pd(c,d,p,w);if(S===null)mE(c,d,w,wo,p),ic(c,w);else if(j1(S,c,d,p,w))w.stopPropagation();else if(ic(c,w),d&4&&-1<F1.indexOf(c)){for(;S!==null;){var A=wg(S);if(A!==null&&ig(A),A=Pd(c,d,p,w),A===null&&mE(c,d,w,wo,p),A===S)break;S=A}S!==null&&w.stopPropagation()}else mE(c,d,w,null,p)}}var wo=null;function Pd(c,d,p,w){if(wo=null,c=W(w),c=Bu(c),c!==null)if(d=te(c),d===null)c=null;else if(p=d.tag,p===13){if(c=xe(d),c!==null)return c;c=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return wo=c,null}function Md(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($t()){case Nn:return 1;case Vn:return 4;case gr:case La:return 16;case la:return 536870912;default:return 16}default:return 16}}var js=null,Nd=null,hl=null;function B1(){if(hl)return hl;var c,d=Nd,p=d.length,w,S="value"in js?js.value:js.textContent,A=S.length;for(c=0;c<p&&d[c]===S[c];c++);var B=p-c;for(w=1;w<=B&&d[p-w]===S[A-w];w++);return hl=S.slice(c,1<w?1-w:void 0)}function ju(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function Eo(){return!0}function cg(){return!1}function ji(c){function d(p,w,S,A,B){this._reactName=p,this._targetInst=S,this.type=w,this.nativeEvent=A,this.target=B,this.currentTarget=null;for(var re in c)c.hasOwnProperty(re)&&(p=c[re],this[re]=p?p(A):A[re]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Eo:cg,this.isPropagationStopped=cg,this}return le(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Eo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Eo)},persist:function(){},isPersistent:Eo}),d}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vu=ji(So),oc=le({},So,{view:0,detail:0}),Ld=ji(oc),Od,Dd,Vs,Gu=le({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zt,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Vs&&(Vs&&c.type==="mousemove"?(Od=c.screenX-Vs.screenX,Dd=c.screenY-Vs.screenY):Dd=Od=0,Vs=c),Od)},movementY:function(c){return"movementY"in c?c.movementY:Dd}}),ug=ji(Gu),U1=le({},Gu,{dataTransfer:0}),z1=ji(U1),Fd=le({},oc,{relatedTarget:0}),Ei=ji(Fd),$1=le({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),W1=ji($1),lc=le({},So,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),_=ji(lc),k=le({},So,{data:0}),D=ji(k),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Re={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function it(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=Re[c])?!!d[c]:!1}function Zt(){return it}var Dr=le({},oc,{key:function(c){if(c.key){var d=H[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=ju(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?ge[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zt,charCode:function(c){return c.type==="keypress"?ju(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?ju(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Gn=ji(Dr),Ur=le({},Gu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gs=ji(Ur),dl=le({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zt}),To=ji(dl),bo=le({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),jd=ji(bo),hg=le({},Gu,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),CG=ji(hg),kG=[9,13,27,32],sE=o&&"CompositionEvent"in window,dg=null;o&&"documentMode"in document&&(dg=document.documentMode);var PG=o&&"TextEvent"in window&&!dg,EC=o&&(!sE||dg&&8<dg&&11>=dg),SC=" ",TC=!1;function bC(c,d){switch(c){case"keyup":return kG.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function IC(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Vd=!1;function MG(c,d){switch(c){case"compositionend":return IC(d);case"keypress":return d.which!==32?null:(TC=!0,SC);case"textInput":return c=d.data,c===SC&&TC?null:c;default:return null}}function NG(c,d){if(Vd)return c==="compositionend"||!sE&&bC(c,d)?(c=B1(),hl=Nd=js=null,Vd=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return EC&&d.locale!=="ko"?null:d.data;default:return null}}var LG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AC(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!LG[c.type]:d==="textarea"}function RC(c,d,p,w){Ve(w),d=q1(d,"onChange"),0<d.length&&(p=new Vu("onChange","change",null,p,w),c.push({event:p,listeners:d}))}var fg=null,gg=null;function OG(c){HC(c,0)}function H1(c){var d=$d(c);if(kt(d))return c}function DG(c,d){if(c==="change")return d}var CC=!1;if(o){var aE;if(o){var oE="oninput"in document;if(!oE){var kC=document.createElement("div");kC.setAttribute("oninput","return;"),oE=typeof kC.oninput=="function"}aE=oE}else aE=!1;CC=aE&&(!document.documentMode||9<document.documentMode)}function PC(){fg&&(fg.detachEvent("onpropertychange",MC),gg=fg=null)}function MC(c){if(c.propertyName==="value"&&H1(gg)){var d=[];RC(d,gg,c,W(c)),St(OG,d)}}function FG(c,d,p){c==="focusin"?(PC(),fg=d,gg=p,fg.attachEvent("onpropertychange",MC)):c==="focusout"&&PC()}function jG(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return H1(gg)}function VG(c,d){if(c==="click")return H1(d)}function GG(c,d){if(c==="input"||c==="change")return H1(d)}function BG(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Da=typeof Object.is=="function"?Object.is:BG;function mg(c,d){if(Da(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var p=Object.keys(c),w=Object.keys(d);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var S=p[w];if(!l.call(d,S)||!Da(c[S],d[S]))return!1}return!0}function NC(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function LC(c,d){var p=NC(c);c=0;for(var w;p;){if(p.nodeType===3){if(w=c+p.textContent.length,c<=d&&w>=d)return{node:p,offset:d-c};c=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=NC(p)}}function OC(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?OC(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function DC(){for(var c=window,d=hn();d instanceof c.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)c=d.contentWindow;else break;d=hn(c.document)}return d}function lE(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function UG(c){var d=DC(),p=c.focusedElem,w=c.selectionRange;if(d!==p&&p&&p.ownerDocument&&OC(p.ownerDocument.documentElement,p)){if(w!==null&&lE(p)){if(d=w.start,c=w.end,c===void 0&&(c=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(c,p.value.length);else if(c=(d=p.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var S=p.textContent.length,A=Math.min(w.start,S);w=w.end===void 0?A:Math.min(w.end,S),!c.extend&&A>w&&(S=w,w=A,A=S),S=LC(p,A);var B=LC(p,w);S&&B&&(c.rangeCount!==1||c.anchorNode!==S.node||c.anchorOffset!==S.offset||c.focusNode!==B.node||c.focusOffset!==B.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),c.removeAllRanges(),A>w?(c.addRange(d),c.extend(B.node,B.offset)):(d.setEnd(B.node,B.offset),c.addRange(d)))}}for(d=[],c=p;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)c=d[p],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var zG=o&&"documentMode"in document&&11>=document.documentMode,Gd=null,cE=null,pg=null,uE=!1;function FC(c,d,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;uE||Gd==null||Gd!==hn(w)||(w=Gd,"selectionStart"in w&&lE(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),pg&&mg(pg,w)||(pg=w,w=q1(cE,"onSelect"),0<w.length&&(d=new Vu("onSelect","select",null,d,p),c.push({event:d,listeners:w}),d.target=Gd)))}function K1(c,d){var p={};return p[c.toLowerCase()]=d.toLowerCase(),p["Webkit"+c]="webkit"+d,p["Moz"+c]="moz"+d,p}var Bd={animationend:K1("Animation","AnimationEnd"),animationiteration:K1("Animation","AnimationIteration"),animationstart:K1("Animation","AnimationStart"),transitionend:K1("Transition","TransitionEnd")},hE={},jC={};o&&(jC=document.createElement("div").style,"AnimationEvent"in window||(delete Bd.animationend.animation,delete Bd.animationiteration.animation,delete Bd.animationstart.animation),"TransitionEvent"in window||delete Bd.transitionend.transition);function Y1(c){if(hE[c])return hE[c];if(!Bd[c])return c;var d=Bd[c],p;for(p in d)if(d.hasOwnProperty(p)&&p in jC)return hE[c]=d[p];return c}var VC=Y1("animationend"),GC=Y1("animationiteration"),BC=Y1("animationstart"),UC=Y1("transitionend"),zC=new Map,$C="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cc(c,d){zC.set(c,d),s(d,[c])}for(var dE=0;dE<$C.length;dE++){var fE=$C[dE],$G=fE.toLowerCase(),WG=fE[0].toUpperCase()+fE.slice(1);cc($G,"on"+WG)}cc(VC,"onAnimationEnd"),cc(GC,"onAnimationIteration"),cc(BC,"onAnimationStart"),cc("dblclick","onDoubleClick"),cc("focusin","onFocus"),cc("focusout","onBlur"),cc(UC,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HG=new Set("cancel close invalid load scroll toggle".split(" ").concat(yg));function WC(c,d,p){var w=c.type||"unknown-event";c.currentTarget=p,J(w,d,void 0,c),c.currentTarget=null}function HC(c,d){d=(d&4)!==0;for(var p=0;p<c.length;p++){var w=c[p],S=w.event;w=w.listeners;e:{var A=void 0;if(d)for(var B=w.length-1;0<=B;B--){var re=w[B],ae=re.instance,Ae=re.currentTarget;if(re=re.listener,ae!==A&&S.isPropagationStopped())break e;WC(S,re,Ae),A=ae}else for(B=0;B<w.length;B++){if(re=w[B],ae=re.instance,Ae=re.currentTarget,re=re.listener,ae!==A&&S.isPropagationStopped())break e;WC(S,re,Ae),A=ae}}}if(U)throw c=Z,U=!1,Z=null,c}function ar(c,d){var p=d[wE];p===void 0&&(p=d[wE]=new Set);var w=c+"__bubble";p.has(w)||(KC(d,c,2,!1),p.add(w))}function gE(c,d,p){var w=0;d&&(w|=4),KC(p,c,w,d)}var X1="_reactListening"+Math.random().toString(36).slice(2);function _g(c){if(!c[X1]){c[X1]=!0,r.forEach(function(p){p!=="selectionchange"&&(HG.has(p)||gE(p,!1,c),gE(p,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[X1]||(d[X1]=!0,gE("selectionchange",!1,d))}}function KC(c,d,p,w){switch(Md(d)){case 1:var S=vo;break;case 4:S=G1;break;default:S=lg}p=S.bind(null,d,p,c),S=void 0,!dr||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),w?S!==void 0?c.addEventListener(d,p,{capture:!0,passive:S}):c.addEventListener(d,p,!0):S!==void 0?c.addEventListener(d,p,{passive:S}):c.addEventListener(d,p,!1)}function mE(c,d,p,w,S){var A=w;if((d&1)===0&&(d&2)===0&&w!==null)e:for(;;){if(w===null)return;var B=w.tag;if(B===3||B===4){var re=w.stateNode.containerInfo;if(re===S||re.nodeType===8&&re.parentNode===S)break;if(B===4)for(B=w.return;B!==null;){var ae=B.tag;if((ae===3||ae===4)&&(ae=B.stateNode.containerInfo,ae===S||ae.nodeType===8&&ae.parentNode===S))return;B=B.return}for(;re!==null;){if(B=Bu(re),B===null)return;if(ae=B.tag,ae===5||ae===6){w=A=B;continue e}re=re.parentNode}}w=w.return}St(function(){var Ae=A,He=W(p),qe=[];e:{var ze=zC.get(c);if(ze!==void 0){var yt=Vu,wt=c;switch(c){case"keypress":if(ju(p)===0)break e;case"keydown":case"keyup":yt=Gn;break;case"focusin":wt="focus",yt=Ei;break;case"focusout":wt="blur",yt=Ei;break;case"beforeblur":case"afterblur":yt=Ei;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=ug;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=z1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=To;break;case VC:case GC:case BC:yt=W1;break;case UC:yt=jd;break;case"scroll":yt=Ld;break;case"wheel":yt=CG;break;case"copy":case"cut":case"paste":yt=_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=Gs}var Tt=(d&4)!==0,Fr=!Tt&&c==="scroll",fe=Tt?ze!==null?ze+"Capture":null:ze;Tt=[];for(var oe=Ae,ve;oe!==null;){ve=oe;var Je=ve.stateNode;if(ve.tag===5&&Je!==null&&(ve=Je,fe!==null&&(Je=sn(oe,fe),Je!=null&&Tt.push(xg(oe,Je,ve)))),Fr)break;oe=oe.return}0<Tt.length&&(ze=new yt(ze,wt,null,p,He),qe.push({event:ze,listeners:Tt}))}}if((d&7)===0){e:{if(ze=c==="mouseover"||c==="pointerover",yt=c==="mouseout"||c==="pointerout",ze&&p!==Lt&&(wt=p.relatedTarget||p.fromElement)&&(Bu(wt)||wt[fl]))break e;if((yt||ze)&&(ze=He.window===He?He:(ze=He.ownerDocument)?ze.defaultView||ze.parentWindow:window,yt?(wt=p.relatedTarget||p.toElement,yt=Ae,wt=wt?Bu(wt):null,wt!==null&&(Fr=te(wt),wt!==Fr||wt.tag!==5&&wt.tag!==6)&&(wt=null)):(yt=null,wt=Ae),yt!==wt)){if(Tt=ug,Je="onMouseLeave",fe="onMouseEnter",oe="mouse",(c==="pointerout"||c==="pointerover")&&(Tt=Gs,Je="onPointerLeave",fe="onPointerEnter",oe="pointer"),Fr=yt==null?ze:$d(yt),ve=wt==null?ze:$d(wt),ze=new Tt(Je,oe+"leave",yt,p,He),ze.target=Fr,ze.relatedTarget=ve,Je=null,Bu(He)===Ae&&(Tt=new Tt(fe,oe+"enter",wt,p,He),Tt.target=ve,Tt.relatedTarget=Fr,Je=Tt),Fr=Je,yt&&wt)t:{for(Tt=yt,fe=wt,oe=0,ve=Tt;ve;ve=Ud(ve))oe++;for(ve=0,Je=fe;Je;Je=Ud(Je))ve++;for(;0<oe-ve;)Tt=Ud(Tt),oe--;for(;0<ve-oe;)fe=Ud(fe),ve--;for(;oe--;){if(Tt===fe||fe!==null&&Tt===fe.alternate)break t;Tt=Ud(Tt),fe=Ud(fe)}Tt=null}else Tt=null;yt!==null&&YC(qe,ze,yt,Tt,!1),wt!==null&&Fr!==null&&YC(qe,Fr,wt,Tt,!0)}}e:{if(ze=Ae?$d(Ae):window,yt=ze.nodeName&&ze.nodeName.toLowerCase(),yt==="select"||yt==="input"&&ze.type==="file")var It=DG;else if(AC(ze))if(CC)It=GG;else{It=jG;var jt=FG}else(yt=ze.nodeName)&&yt.toLowerCase()==="input"&&(ze.type==="checkbox"||ze.type==="radio")&&(It=VG);if(It&&(It=It(c,Ae))){RC(qe,It,p,He);break e}jt&&jt(c,ze,Ae),c==="focusout"&&(jt=ze._wrapperState)&&jt.controlled&&ze.type==="number"&&on(ze,"number",ze.value)}switch(jt=Ae?$d(Ae):window,c){case"focusin":(AC(jt)||jt.contentEditable==="true")&&(Gd=jt,cE=Ae,pg=null);break;case"focusout":pg=cE=Gd=null;break;case"mousedown":uE=!0;break;case"contextmenu":case"mouseup":case"dragend":uE=!1,FC(qe,p,He);break;case"selectionchange":if(zG)break;case"keydown":case"keyup":FC(qe,p,He)}var Vt;if(sE)e:{switch(c){case"compositionstart":var Wt="onCompositionStart";break e;case"compositionend":Wt="onCompositionEnd";break e;case"compositionupdate":Wt="onCompositionUpdate";break e}Wt=void 0}else Vd?bC(c,p)&&(Wt="onCompositionEnd"):c==="keydown"&&p.keyCode===229&&(Wt="onCompositionStart");Wt&&(EC&&p.locale!=="ko"&&(Vd||Wt!=="onCompositionStart"?Wt==="onCompositionEnd"&&Vd&&(Vt=B1()):(js=He,Nd="value"in js?js.value:js.textContent,Vd=!0)),jt=q1(Ae,Wt),0<jt.length&&(Wt=new D(Wt,c,null,p,He),qe.push({event:Wt,listeners:jt}),Vt?Wt.data=Vt:(Vt=IC(p),Vt!==null&&(Wt.data=Vt)))),(Vt=PG?MG(c,p):NG(c,p))&&(Ae=q1(Ae,"onBeforeInput"),0<Ae.length&&(He=new D("onBeforeInput","beforeinput",null,p,He),qe.push({event:He,listeners:Ae}),He.data=Vt))}HC(qe,d)})}function xg(c,d,p){return{instance:c,listener:d,currentTarget:p}}function q1(c,d){for(var p=d+"Capture",w=[];c!==null;){var S=c,A=S.stateNode;S.tag===5&&A!==null&&(S=A,A=sn(c,p),A!=null&&w.unshift(xg(c,A,S)),A=sn(c,d),A!=null&&w.push(xg(c,A,S))),c=c.return}return w}function Ud(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function YC(c,d,p,w,S){for(var A=d._reactName,B=[];p!==null&&p!==w;){var re=p,ae=re.alternate,Ae=re.stateNode;if(ae!==null&&ae===w)break;re.tag===5&&Ae!==null&&(re=Ae,S?(ae=sn(p,A),ae!=null&&B.unshift(xg(p,ae,re))):S||(ae=sn(p,A),ae!=null&&B.push(xg(p,ae,re)))),p=p.return}B.length!==0&&c.push({event:d,listeners:B})}var KG=/\r\n?/g,YG=/\u0000|\uFFFD/g;function XC(c){return(typeof c=="string"?c:""+c).replace(KG,`
`).replace(YG,"")}function Z1(c,d,p){if(d=XC(d),XC(c)!==d&&p)throw Error(t(425))}function Q1(){}var pE=null,yE=null;function _E(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var xE=typeof setTimeout=="function"?setTimeout:void 0,XG=typeof clearTimeout=="function"?clearTimeout:void 0,qC=typeof Promise=="function"?Promise:void 0,qG=typeof queueMicrotask=="function"?queueMicrotask:typeof qC<"u"?function(c){return qC.resolve(null).then(c).catch(ZG)}:xE;function ZG(c){setTimeout(function(){throw c})}function vE(c,d){var p=d,w=0;do{var S=p.nextSibling;if(c.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(w===0){c.removeChild(S),ac(d);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=S}while(p);ac(d)}function uc(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function ZC(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var p=c.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return c;d--}else p==="/$"&&d++}c=c.previousSibling}return null}var zd=Math.random().toString(36).slice(2),Io="__reactFiber$"+zd,vg="__reactProps$"+zd,fl="__reactContainer$"+zd,wE="__reactEvents$"+zd,QG="__reactListeners$"+zd,JG="__reactHandles$"+zd;function Bu(c){var d=c[Io];if(d)return d;for(var p=c.parentNode;p;){if(d=p[fl]||p[Io]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(c=ZC(c);c!==null;){if(p=c[Io])return p;c=ZC(c)}return d}c=p,p=c.parentNode}return null}function wg(c){return c=c[Io]||c[fl],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function $d(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function J1(c){return c[vg]||null}var EE=[],Wd=-1;function hc(c){return{current:c}}function or(c){0>Wd||(c.current=EE[Wd],EE[Wd]=null,Wd--)}function nr(c,d){Wd++,EE[Wd]=c.current,c.current=d}var dc={},Vi=hc(dc),gs=hc(!1),Uu=dc;function Hd(c,d){var p=c.type.contextTypes;if(!p)return dc;var w=c.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===d)return w.__reactInternalMemoizedMaskedChildContext;var S={},A;for(A in p)S[A]=d[A];return w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=S),S}function ms(c){return c=c.childContextTypes,c!=null}function ey(){or(gs),or(Vi)}function QC(c,d,p){if(Vi.current!==dc)throw Error(t(168));nr(Vi,d),nr(gs,p)}function JC(c,d,p){var w=c.stateNode;if(d=d.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var S in w)if(!(S in d))throw Error(t(108,De(c)||"Unknown",S));return le({},p,w)}function ty(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||dc,Uu=Vi.current,nr(Vi,c),nr(gs,gs.current),!0}function ek(c,d,p){var w=c.stateNode;if(!w)throw Error(t(169));p?(c=JC(c,d,Uu),w.__reactInternalMemoizedMergedChildContext=c,or(gs),or(Vi),nr(Vi,c)):or(gs),nr(gs,p)}var gl=null,ny=!1,SE=!1;function tk(c){gl===null?gl=[c]:gl.push(c)}function eB(c){ny=!0,tk(c)}function fc(){if(!SE&&gl!==null){SE=!0;var c=0,d=mn;try{var p=gl;for(mn=1;c<p.length;c++){var w=p[c];do w=w(!0);while(w!==null)}gl=null,ny=!1}catch(S){throw gl!==null&&(gl=gl.slice(c+1)),Ke(Nn,fc),S}finally{mn=d,SE=!1}}return null}var Kd=[],Yd=0,ry=null,iy=0,ua=[],ha=0,zu=null,ml=1,pl="";function $u(c,d){Kd[Yd++]=iy,Kd[Yd++]=ry,ry=c,iy=d}function nk(c,d,p){ua[ha++]=ml,ua[ha++]=pl,ua[ha++]=zu,zu=c;var w=ml;c=pl;var S=32-wr(w)-1;w&=~(1<<S),p+=1;var A=32-wr(d)+S;if(30<A){var B=S-S%5;A=(w&(1<<B)-1).toString(32),w>>=B,S-=B,ml=1<<32-wr(d)+S|p<<S|w,pl=A+c}else ml=1<<A|p<<S|w,pl=c}function TE(c){c.return!==null&&($u(c,1),nk(c,1,0))}function bE(c){for(;c===ry;)ry=Kd[--Yd],Kd[Yd]=null,iy=Kd[--Yd],Kd[Yd]=null;for(;c===zu;)zu=ua[--ha],ua[ha]=null,pl=ua[--ha],ua[ha]=null,ml=ua[--ha],ua[ha]=null}var Bs=null,Us=null,mr=!1,Fa=null;function rk(c,d){var p=ma(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=c,d=c.deletions,d===null?(c.deletions=[p],c.flags|=16):d.push(p)}function ik(c,d){switch(c.tag){case 5:var p=c.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,Bs=c,Us=uc(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,Bs=c,Us=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=zu!==null?{id:ml,overflow:pl}:null,c.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=ma(18,null,null,0),p.stateNode=d,p.return=c,c.child=p,Bs=c,Us=null,!0):!1;default:return!1}}function IE(c){return(c.mode&1)!==0&&(c.flags&128)===0}function AE(c){if(mr){var d=Us;if(d){var p=d;if(!ik(c,d)){if(IE(c))throw Error(t(418));d=uc(p.nextSibling);var w=Bs;d&&ik(c,d)?rk(w,p):(c.flags=c.flags&-4097|2,mr=!1,Bs=c)}}else{if(IE(c))throw Error(t(418));c.flags=c.flags&-4097|2,mr=!1,Bs=c}}}function sk(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Bs=c}function sy(c){if(c!==Bs)return!1;if(!mr)return sk(c),mr=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!_E(c.type,c.memoizedProps)),d&&(d=Us)){if(IE(c))throw ak(),Error(t(418));for(;d;)rk(c,d),d=uc(d.nextSibling)}if(sk(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var p=c.data;if(p==="/$"){if(d===0){Us=uc(c.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}c=c.nextSibling}Us=null}}else Us=Bs?uc(c.stateNode.nextSibling):null;return!0}function ak(){for(var c=Us;c;)c=uc(c.nextSibling)}function Xd(){Us=Bs=null,mr=!1}function RE(c){Fa===null?Fa=[c]:Fa.push(c)}var tB=M.ReactCurrentBatchConfig;function Eg(c,d,p){if(c=p.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var w=p.stateNode}if(!w)throw Error(t(147,c));var S=w,A=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===A?d.ref:(d=function(B){var re=S.refs;B===null?delete re[A]:re[A]=B},d._stringRef=A,d)}if(typeof c!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,c))}return c}function ay(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function ok(c){var d=c._init;return d(c._payload)}function lk(c){function d(fe,oe){if(c){var ve=fe.deletions;ve===null?(fe.deletions=[oe],fe.flags|=16):ve.push(oe)}}function p(fe,oe){if(!c)return null;for(;oe!==null;)d(fe,oe),oe=oe.sibling;return null}function w(fe,oe){for(fe=new Map;oe!==null;)oe.key!==null?fe.set(oe.key,oe):fe.set(oe.index,oe),oe=oe.sibling;return fe}function S(fe,oe){return fe=wc(fe,oe),fe.index=0,fe.sibling=null,fe}function A(fe,oe,ve){return fe.index=ve,c?(ve=fe.alternate,ve!==null?(ve=ve.index,ve<oe?(fe.flags|=2,oe):ve):(fe.flags|=2,oe)):(fe.flags|=1048576,oe)}function B(fe){return c&&fe.alternate===null&&(fe.flags|=2),fe}function re(fe,oe,ve,Je){return oe===null||oe.tag!==6?(oe=x2(ve,fe.mode,Je),oe.return=fe,oe):(oe=S(oe,ve),oe.return=fe,oe)}function ae(fe,oe,ve,Je){var It=ve.type;return It===R?He(fe,oe,ve.props.children,Je,ve.key):oe!==null&&(oe.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===je&&ok(It)===oe.type)?(Je=S(oe,ve.props),Je.ref=Eg(fe,oe,ve),Je.return=fe,Je):(Je=ky(ve.type,ve.key,ve.props,null,fe.mode,Je),Je.ref=Eg(fe,oe,ve),Je.return=fe,Je)}function Ae(fe,oe,ve,Je){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==ve.containerInfo||oe.stateNode.implementation!==ve.implementation?(oe=v2(ve,fe.mode,Je),oe.return=fe,oe):(oe=S(oe,ve.children||[]),oe.return=fe,oe)}function He(fe,oe,ve,Je,It){return oe===null||oe.tag!==7?(oe=Qu(ve,fe.mode,Je,It),oe.return=fe,oe):(oe=S(oe,ve),oe.return=fe,oe)}function qe(fe,oe,ve){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=x2(""+oe,fe.mode,ve),oe.return=fe,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case F:return ve=ky(oe.type,oe.key,oe.props,null,fe.mode,ve),ve.ref=Eg(fe,null,oe),ve.return=fe,ve;case G:return oe=v2(oe,fe.mode,ve),oe.return=fe,oe;case je:var Je=oe._init;return qe(fe,Je(oe._payload),ve)}if(en(oe)||Te(oe))return oe=Qu(oe,fe.mode,ve,null),oe.return=fe,oe;ay(fe,oe)}return null}function ze(fe,oe,ve,Je){var It=oe!==null?oe.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number")return It!==null?null:re(fe,oe,""+ve,Je);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case F:return ve.key===It?ae(fe,oe,ve,Je):null;case G:return ve.key===It?Ae(fe,oe,ve,Je):null;case je:return It=ve._init,ze(fe,oe,It(ve._payload),Je)}if(en(ve)||Te(ve))return It!==null?null:He(fe,oe,ve,Je,null);ay(fe,ve)}return null}function yt(fe,oe,ve,Je,It){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return fe=fe.get(ve)||null,re(oe,fe,""+Je,It);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case F:return fe=fe.get(Je.key===null?ve:Je.key)||null,ae(oe,fe,Je,It);case G:return fe=fe.get(Je.key===null?ve:Je.key)||null,Ae(oe,fe,Je,It);case je:var jt=Je._init;return yt(fe,oe,ve,jt(Je._payload),It)}if(en(Je)||Te(Je))return fe=fe.get(ve)||null,He(oe,fe,Je,It,null);ay(oe,Je)}return null}function wt(fe,oe,ve,Je){for(var It=null,jt=null,Vt=oe,Wt=oe=0,ci=null;Vt!==null&&Wt<ve.length;Wt++){Vt.index>Wt?(ci=Vt,Vt=null):ci=Vt.sibling;var Sn=ze(fe,Vt,ve[Wt],Je);if(Sn===null){Vt===null&&(Vt=ci);break}c&&Vt&&Sn.alternate===null&&d(fe,Vt),oe=A(Sn,oe,Wt),jt===null?It=Sn:jt.sibling=Sn,jt=Sn,Vt=ci}if(Wt===ve.length)return p(fe,Vt),mr&&$u(fe,Wt),It;if(Vt===null){for(;Wt<ve.length;Wt++)Vt=qe(fe,ve[Wt],Je),Vt!==null&&(oe=A(Vt,oe,Wt),jt===null?It=Vt:jt.sibling=Vt,jt=Vt);return mr&&$u(fe,Wt),It}for(Vt=w(fe,Vt);Wt<ve.length;Wt++)ci=yt(Vt,fe,Wt,ve[Wt],Je),ci!==null&&(c&&ci.alternate!==null&&Vt.delete(ci.key===null?Wt:ci.key),oe=A(ci,oe,Wt),jt===null?It=ci:jt.sibling=ci,jt=ci);return c&&Vt.forEach(function(Ec){return d(fe,Ec)}),mr&&$u(fe,Wt),It}function Tt(fe,oe,ve,Je){var It=Te(ve);if(typeof It!="function")throw Error(t(150));if(ve=It.call(ve),ve==null)throw Error(t(151));for(var jt=It=null,Vt=oe,Wt=oe=0,ci=null,Sn=ve.next();Vt!==null&&!Sn.done;Wt++,Sn=ve.next()){Vt.index>Wt?(ci=Vt,Vt=null):ci=Vt.sibling;var Ec=ze(fe,Vt,Sn.value,Je);if(Ec===null){Vt===null&&(Vt=ci);break}c&&Vt&&Ec.alternate===null&&d(fe,Vt),oe=A(Ec,oe,Wt),jt===null?It=Ec:jt.sibling=Ec,jt=Ec,Vt=ci}if(Sn.done)return p(fe,Vt),mr&&$u(fe,Wt),It;if(Vt===null){for(;!Sn.done;Wt++,Sn=ve.next())Sn=qe(fe,Sn.value,Je),Sn!==null&&(oe=A(Sn,oe,Wt),jt===null?It=Sn:jt.sibling=Sn,jt=Sn);return mr&&$u(fe,Wt),It}for(Vt=w(fe,Vt);!Sn.done;Wt++,Sn=ve.next())Sn=yt(Vt,fe,Wt,Sn.value,Je),Sn!==null&&(c&&Sn.alternate!==null&&Vt.delete(Sn.key===null?Wt:Sn.key),oe=A(Sn,oe,Wt),jt===null?It=Sn:jt.sibling=Sn,jt=Sn);return c&&Vt.forEach(function(LB){return d(fe,LB)}),mr&&$u(fe,Wt),It}function Fr(fe,oe,ve,Je){if(typeof ve=="object"&&ve!==null&&ve.type===R&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case F:e:{for(var It=ve.key,jt=oe;jt!==null;){if(jt.key===It){if(It=ve.type,It===R){if(jt.tag===7){p(fe,jt.sibling),oe=S(jt,ve.props.children),oe.return=fe,fe=oe;break e}}else if(jt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===je&&ok(It)===jt.type){p(fe,jt.sibling),oe=S(jt,ve.props),oe.ref=Eg(fe,jt,ve),oe.return=fe,fe=oe;break e}p(fe,jt);break}else d(fe,jt);jt=jt.sibling}ve.type===R?(oe=Qu(ve.props.children,fe.mode,Je,ve.key),oe.return=fe,fe=oe):(Je=ky(ve.type,ve.key,ve.props,null,fe.mode,Je),Je.ref=Eg(fe,oe,ve),Je.return=fe,fe=Je)}return B(fe);case G:e:{for(jt=ve.key;oe!==null;){if(oe.key===jt)if(oe.tag===4&&oe.stateNode.containerInfo===ve.containerInfo&&oe.stateNode.implementation===ve.implementation){p(fe,oe.sibling),oe=S(oe,ve.children||[]),oe.return=fe,fe=oe;break e}else{p(fe,oe);break}else d(fe,oe);oe=oe.sibling}oe=v2(ve,fe.mode,Je),oe.return=fe,fe=oe}return B(fe);case je:return jt=ve._init,Fr(fe,oe,jt(ve._payload),Je)}if(en(ve))return wt(fe,oe,ve,Je);if(Te(ve))return Tt(fe,oe,ve,Je);ay(fe,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"?(ve=""+ve,oe!==null&&oe.tag===6?(p(fe,oe.sibling),oe=S(oe,ve),oe.return=fe,fe=oe):(p(fe,oe),oe=x2(ve,fe.mode,Je),oe.return=fe,fe=oe),B(fe)):p(fe,oe)}return Fr}var qd=lk(!0),ck=lk(!1),oy=hc(null),ly=null,Zd=null,CE=null;function kE(){CE=Zd=ly=null}function PE(c){var d=oy.current;or(oy),c._currentValue=d}function ME(c,d,p){for(;c!==null;){var w=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,w!==null&&(w.childLanes|=d)):w!==null&&(w.childLanes&d)!==d&&(w.childLanes|=d),c===p)break;c=c.return}}function Qd(c,d){ly=c,CE=Zd=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(ps=!0),c.firstContext=null)}function da(c){var d=c._currentValue;if(CE!==c)if(c={context:c,memoizedValue:d,next:null},Zd===null){if(ly===null)throw Error(t(308));Zd=c,ly.dependencies={lanes:0,firstContext:c}}else Zd=Zd.next=c;return d}var Wu=null;function NE(c){Wu===null?Wu=[c]:Wu.push(c)}function uk(c,d,p,w){var S=d.interleaved;return S===null?(p.next=p,NE(d)):(p.next=S.next,S.next=p),d.interleaved=p,yl(c,w)}function yl(c,d){c.lanes|=d;var p=c.alternate;for(p!==null&&(p.lanes|=d),p=c,c=c.return;c!==null;)c.childLanes|=d,p=c.alternate,p!==null&&(p.childLanes|=d),p=c,c=c.return;return p.tag===3?p.stateNode:null}var gc=!1;function LE(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hk(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function _l(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function mc(c,d,p){var w=c.updateQueue;if(w===null)return null;if(w=w.shared,(xn&2)!==0){var S=w.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),w.pending=d,yl(c,p)}return S=w.interleaved,S===null?(d.next=d,NE(w)):(d.next=S.next,S.next=d),w.interleaved=d,yl(c,p)}function cy(c,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var w=d.lanes;w&=c.pendingLanes,p|=w,d.lanes=p,rg(c,p)}}function dk(c,d){var p=c.updateQueue,w=c.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var S=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var B={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};A===null?S=A=B:A=A.next=B,p=p.next}while(p!==null);A===null?S=A=d:A=A.next=d}else S=A=d;p={baseState:w.baseState,firstBaseUpdate:S,lastBaseUpdate:A,shared:w.shared,effects:w.effects},c.updateQueue=p;return}c=p.lastBaseUpdate,c===null?p.firstBaseUpdate=d:c.next=d,p.lastBaseUpdate=d}function uy(c,d,p,w){var S=c.updateQueue;gc=!1;var A=S.firstBaseUpdate,B=S.lastBaseUpdate,re=S.shared.pending;if(re!==null){S.shared.pending=null;var ae=re,Ae=ae.next;ae.next=null,B===null?A=Ae:B.next=Ae,B=ae;var He=c.alternate;He!==null&&(He=He.updateQueue,re=He.lastBaseUpdate,re!==B&&(re===null?He.firstBaseUpdate=Ae:re.next=Ae,He.lastBaseUpdate=ae))}if(A!==null){var qe=S.baseState;B=0,He=Ae=ae=null,re=A;do{var ze=re.lane,yt=re.eventTime;if((w&ze)===ze){He!==null&&(He=He.next={eventTime:yt,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var wt=c,Tt=re;switch(ze=d,yt=p,Tt.tag){case 1:if(wt=Tt.payload,typeof wt=="function"){qe=wt.call(yt,qe,ze);break e}qe=wt;break e;case 3:wt.flags=wt.flags&-65537|128;case 0:if(wt=Tt.payload,ze=typeof wt=="function"?wt.call(yt,qe,ze):wt,ze==null)break e;qe=le({},qe,ze);break e;case 2:gc=!0}}re.callback!==null&&re.lane!==0&&(c.flags|=64,ze=S.effects,ze===null?S.effects=[re]:ze.push(re))}else yt={eventTime:yt,lane:ze,tag:re.tag,payload:re.payload,callback:re.callback,next:null},He===null?(Ae=He=yt,ae=qe):He=He.next=yt,B|=ze;if(re=re.next,re===null){if(re=S.shared.pending,re===null)break;ze=re,re=ze.next,ze.next=null,S.lastBaseUpdate=ze,S.shared.pending=null}}while(!0);if(He===null&&(ae=qe),S.baseState=ae,S.firstBaseUpdate=Ae,S.lastBaseUpdate=He,d=S.shared.interleaved,d!==null){S=d;do B|=S.lane,S=S.next;while(S!==d)}else A===null&&(S.shared.lanes=0);Yu|=B,c.lanes=B,c.memoizedState=qe}}function fk(c,d,p){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var w=c[d],S=w.callback;if(S!==null){if(w.callback=null,w=p,typeof S!="function")throw Error(t(191,S));S.call(w)}}}var Sg={},Ao=hc(Sg),Tg=hc(Sg),bg=hc(Sg);function Hu(c){if(c===Sg)throw Error(t(174));return c}function OE(c,d){switch(nr(bg,d),nr(Tg,c),nr(Ao,Sg),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Pt(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=Pt(d,c)}or(Ao),nr(Ao,d)}function Jd(){or(Ao),or(Tg),or(bg)}function gk(c){Hu(bg.current);var d=Hu(Ao.current),p=Pt(d,c.type);d!==p&&(nr(Tg,c),nr(Ao,p))}function DE(c){Tg.current===c&&(or(Ao),or(Tg))}var Er=hc(0);function hy(c){for(var d=c;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var FE=[];function jE(){for(var c=0;c<FE.length;c++)FE[c]._workInProgressVersionPrimary=null;FE.length=0}var dy=M.ReactCurrentDispatcher,VE=M.ReactCurrentBatchConfig,Ku=0,Sr=null,Zr=null,oi=null,fy=!1,Ig=!1,Ag=0,nB=0;function Gi(){throw Error(t(321))}function GE(c,d){if(d===null)return!1;for(var p=0;p<d.length&&p<c.length;p++)if(!Da(c[p],d[p]))return!1;return!0}function BE(c,d,p,w,S,A){if(Ku=A,Sr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,dy.current=c===null||c.memoizedState===null?aB:oB,c=p(w,S),Ig){A=0;do{if(Ig=!1,Ag=0,25<=A)throw Error(t(301));A+=1,oi=Zr=null,d.updateQueue=null,dy.current=lB,c=p(w,S)}while(Ig)}if(dy.current=py,d=Zr!==null&&Zr.next!==null,Ku=0,oi=Zr=Sr=null,fy=!1,d)throw Error(t(300));return c}function UE(){var c=Ag!==0;return Ag=0,c}function Ro(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oi===null?Sr.memoizedState=oi=c:oi=oi.next=c,oi}function fa(){if(Zr===null){var c=Sr.alternate;c=c!==null?c.memoizedState:null}else c=Zr.next;var d=oi===null?Sr.memoizedState:oi.next;if(d!==null)oi=d,Zr=c;else{if(c===null)throw Error(t(310));Zr=c,c={memoizedState:Zr.memoizedState,baseState:Zr.baseState,baseQueue:Zr.baseQueue,queue:Zr.queue,next:null},oi===null?Sr.memoizedState=oi=c:oi=oi.next=c}return oi}function Rg(c,d){return typeof d=="function"?d(c):d}function zE(c){var d=fa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=c;var w=Zr,S=w.baseQueue,A=p.pending;if(A!==null){if(S!==null){var B=S.next;S.next=A.next,A.next=B}w.baseQueue=S=A,p.pending=null}if(S!==null){A=S.next,w=w.baseState;var re=B=null,ae=null,Ae=A;do{var He=Ae.lane;if((Ku&He)===He)ae!==null&&(ae=ae.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),w=Ae.hasEagerState?Ae.eagerState:c(w,Ae.action);else{var qe={lane:He,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};ae===null?(re=ae=qe,B=w):ae=ae.next=qe,Sr.lanes|=He,Yu|=He}Ae=Ae.next}while(Ae!==null&&Ae!==A);ae===null?B=w:ae.next=re,Da(w,d.memoizedState)||(ps=!0),d.memoizedState=w,d.baseState=B,d.baseQueue=ae,p.lastRenderedState=w}if(c=p.interleaved,c!==null){S=c;do A=S.lane,Sr.lanes|=A,Yu|=A,S=S.next;while(S!==c)}else S===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function $E(c){var d=fa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=c;var w=p.dispatch,S=p.pending,A=d.memoizedState;if(S!==null){p.pending=null;var B=S=S.next;do A=c(A,B.action),B=B.next;while(B!==S);Da(A,d.memoizedState)||(ps=!0),d.memoizedState=A,d.baseQueue===null&&(d.baseState=A),p.lastRenderedState=A}return[A,w]}function mk(){}function pk(c,d){var p=Sr,w=fa(),S=d(),A=!Da(w.memoizedState,S);if(A&&(w.memoizedState=S,ps=!0),w=w.queue,WE(xk.bind(null,p,w,c),[c]),w.getSnapshot!==d||A||oi!==null&&oi.memoizedState.tag&1){if(p.flags|=2048,Cg(9,_k.bind(null,p,w,S,d),void 0,null),li===null)throw Error(t(349));(Ku&30)!==0||yk(p,d,S)}return S}function yk(c,d,p){c.flags|=16384,c={getSnapshot:d,value:p},d=Sr.updateQueue,d===null?(d={lastEffect:null,stores:null},Sr.updateQueue=d,d.stores=[c]):(p=d.stores,p===null?d.stores=[c]:p.push(c))}function _k(c,d,p,w){d.value=p,d.getSnapshot=w,vk(d)&&wk(c)}function xk(c,d,p){return p(function(){vk(d)&&wk(c)})}function vk(c){var d=c.getSnapshot;c=c.value;try{var p=d();return!Da(c,p)}catch{return!0}}function wk(c){var d=yl(c,1);d!==null&&Ba(d,c,1,-1)}function Ek(c){var d=Ro();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rg,lastRenderedState:c},d.queue=c,c=c.dispatch=sB.bind(null,Sr,c),[d.memoizedState,c]}function Cg(c,d,p,w){return c={tag:c,create:d,destroy:p,deps:w,next:null},d=Sr.updateQueue,d===null?(d={lastEffect:null,stores:null},Sr.updateQueue=d,d.lastEffect=c.next=c):(p=d.lastEffect,p===null?d.lastEffect=c.next=c:(w=p.next,p.next=c,c.next=w,d.lastEffect=c)),c}function Sk(){return fa().memoizedState}function gy(c,d,p,w){var S=Ro();Sr.flags|=c,S.memoizedState=Cg(1|d,p,void 0,w===void 0?null:w)}function my(c,d,p,w){var S=fa();w=w===void 0?null:w;var A=void 0;if(Zr!==null){var B=Zr.memoizedState;if(A=B.destroy,w!==null&&GE(w,B.deps)){S.memoizedState=Cg(d,p,A,w);return}}Sr.flags|=c,S.memoizedState=Cg(1|d,p,A,w)}function Tk(c,d){return gy(8390656,8,c,d)}function WE(c,d){return my(2048,8,c,d)}function bk(c,d){return my(4,2,c,d)}function Ik(c,d){return my(4,4,c,d)}function Ak(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function Rk(c,d,p){return p=p!=null?p.concat([c]):null,my(4,4,Ak.bind(null,d,c),p)}function HE(){}function Ck(c,d){var p=fa();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&GE(d,w[1])?w[0]:(p.memoizedState=[c,d],c)}function kk(c,d){var p=fa();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&GE(d,w[1])?w[0]:(c=c(),p.memoizedState=[c,d],c)}function Pk(c,d,p){return(Ku&21)===0?(c.baseState&&(c.baseState=!1,ps=!0),c.memoizedState=p):(Da(p,d)||(p=tg(),Sr.lanes|=p,Yu|=p,c.baseState=!0),d)}function rB(c,d){var p=mn;mn=p!==0&&4>p?p:4,c(!0);var w=VE.transition;VE.transition={};try{c(!1),d()}finally{mn=p,VE.transition=w}}function Mk(){return fa().memoizedState}function iB(c,d,p){var w=xc(c);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},Nk(c))Lk(d,p);else if(p=uk(c,d,p,w),p!==null){var S=is();Ba(p,c,w,S),Ok(p,d,w)}}function sB(c,d,p){var w=xc(c),S={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(Nk(c))Lk(d,S);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=d.lastRenderedReducer,A!==null))try{var B=d.lastRenderedState,re=A(B,p);if(S.hasEagerState=!0,S.eagerState=re,Da(re,B)){var ae=d.interleaved;ae===null?(S.next=S,NE(d)):(S.next=ae.next,ae.next=S),d.interleaved=S;return}}catch{}p=uk(c,d,S,w),p!==null&&(S=is(),Ba(p,c,w,S),Ok(p,d,w))}}function Nk(c){var d=c.alternate;return c===Sr||d!==null&&d===Sr}function Lk(c,d){Ig=fy=!0;var p=c.pending;p===null?d.next=d:(d.next=p.next,p.next=d),c.pending=d}function Ok(c,d,p){if((p&4194240)!==0){var w=d.lanes;w&=c.pendingLanes,p|=w,d.lanes=p,rg(c,p)}}var py={readContext:da,useCallback:Gi,useContext:Gi,useEffect:Gi,useImperativeHandle:Gi,useInsertionEffect:Gi,useLayoutEffect:Gi,useMemo:Gi,useReducer:Gi,useRef:Gi,useState:Gi,useDebugValue:Gi,useDeferredValue:Gi,useTransition:Gi,useMutableSource:Gi,useSyncExternalStore:Gi,useId:Gi,unstable_isNewReconciler:!1},aB={readContext:da,useCallback:function(c,d){return Ro().memoizedState=[c,d===void 0?null:d],c},useContext:da,useEffect:Tk,useImperativeHandle:function(c,d,p){return p=p!=null?p.concat([c]):null,gy(4194308,4,Ak.bind(null,d,c),p)},useLayoutEffect:function(c,d){return gy(4194308,4,c,d)},useInsertionEffect:function(c,d){return gy(4,2,c,d)},useMemo:function(c,d){var p=Ro();return d=d===void 0?null:d,c=c(),p.memoizedState=[c,d],c},useReducer:function(c,d,p){var w=Ro();return d=p!==void 0?p(d):d,w.memoizedState=w.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},w.queue=c,c=c.dispatch=iB.bind(null,Sr,c),[w.memoizedState,c]},useRef:function(c){var d=Ro();return c={current:c},d.memoizedState=c},useState:Ek,useDebugValue:HE,useDeferredValue:function(c){return Ro().memoizedState=c},useTransition:function(){var c=Ek(!1),d=c[0];return c=rB.bind(null,c[1]),Ro().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,p){var w=Sr,S=Ro();if(mr){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),li===null)throw Error(t(349));(Ku&30)!==0||yk(w,d,p)}S.memoizedState=p;var A={value:p,getSnapshot:d};return S.queue=A,Tk(xk.bind(null,w,A,c),[c]),w.flags|=2048,Cg(9,_k.bind(null,w,A,p,d),void 0,null),p},useId:function(){var c=Ro(),d=li.identifierPrefix;if(mr){var p=pl,w=ml;p=(w&~(1<<32-wr(w)-1)).toString(32)+p,d=":"+d+"R"+p,p=Ag++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=nB++,d=":"+d+"r"+p.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},oB={readContext:da,useCallback:Ck,useContext:da,useEffect:WE,useImperativeHandle:Rk,useInsertionEffect:bk,useLayoutEffect:Ik,useMemo:kk,useReducer:zE,useRef:Sk,useState:function(){return zE(Rg)},useDebugValue:HE,useDeferredValue:function(c){var d=fa();return Pk(d,Zr.memoizedState,c)},useTransition:function(){var c=zE(Rg)[0],d=fa().memoizedState;return[c,d]},useMutableSource:mk,useSyncExternalStore:pk,useId:Mk,unstable_isNewReconciler:!1},lB={readContext:da,useCallback:Ck,useContext:da,useEffect:WE,useImperativeHandle:Rk,useInsertionEffect:bk,useLayoutEffect:Ik,useMemo:kk,useReducer:$E,useRef:Sk,useState:function(){return $E(Rg)},useDebugValue:HE,useDeferredValue:function(c){var d=fa();return Zr===null?d.memoizedState=c:Pk(d,Zr.memoizedState,c)},useTransition:function(){var c=$E(Rg)[0],d=fa().memoizedState;return[c,d]},useMutableSource:mk,useSyncExternalStore:pk,useId:Mk,unstable_isNewReconciler:!1};function ja(c,d){if(c&&c.defaultProps){d=le({},d),c=c.defaultProps;for(var p in c)d[p]===void 0&&(d[p]=c[p]);return d}return d}function KE(c,d,p,w){d=c.memoizedState,p=p(w,d),p=p==null?d:le({},d,p),c.memoizedState=p,c.lanes===0&&(c.updateQueue.baseState=p)}var yy={isMounted:function(c){return(c=c._reactInternals)?te(c)===c:!1},enqueueSetState:function(c,d,p){c=c._reactInternals;var w=is(),S=xc(c),A=_l(w,S);A.payload=d,p!=null&&(A.callback=p),d=mc(c,A,S),d!==null&&(Ba(d,c,S,w),cy(d,c,S))},enqueueReplaceState:function(c,d,p){c=c._reactInternals;var w=is(),S=xc(c),A=_l(w,S);A.tag=1,A.payload=d,p!=null&&(A.callback=p),d=mc(c,A,S),d!==null&&(Ba(d,c,S,w),cy(d,c,S))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var p=is(),w=xc(c),S=_l(p,w);S.tag=2,d!=null&&(S.callback=d),d=mc(c,S,w),d!==null&&(Ba(d,c,w,p),cy(d,c,w))}};function Dk(c,d,p,w,S,A,B){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(w,A,B):d.prototype&&d.prototype.isPureReactComponent?!mg(p,w)||!mg(S,A):!0}function Fk(c,d,p){var w=!1,S=dc,A=d.contextType;return typeof A=="object"&&A!==null?A=da(A):(S=ms(d)?Uu:Vi.current,w=d.contextTypes,A=(w=w!=null)?Hd(c,S):dc),d=new d(p,A),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=yy,c.stateNode=d,d._reactInternals=c,w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=S,c.__reactInternalMemoizedMaskedChildContext=A),d}function jk(c,d,p,w){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,w),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,w),d.state!==c&&yy.enqueueReplaceState(d,d.state,null)}function YE(c,d,p,w){var S=c.stateNode;S.props=p,S.state=c.memoizedState,S.refs={},LE(c);var A=d.contextType;typeof A=="object"&&A!==null?S.context=da(A):(A=ms(d)?Uu:Vi.current,S.context=Hd(c,A)),S.state=c.memoizedState,A=d.getDerivedStateFromProps,typeof A=="function"&&(KE(c,d,A,p),S.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&yy.enqueueReplaceState(S,S.state,null),uy(c,p,S,w),S.state=c.memoizedState),typeof S.componentDidMount=="function"&&(c.flags|=4194308)}function ef(c,d){try{var p="",w=d;do p+=ie(w),w=w.return;while(w);var S=p}catch(A){S=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:d,stack:S,digest:null}}function XE(c,d,p){return{value:c,source:null,stack:p??null,digest:d??null}}function qE(c,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var cB=typeof WeakMap=="function"?WeakMap:Map;function Vk(c,d,p){p=_l(-1,p),p.tag=3,p.payload={element:null};var w=d.value;return p.callback=function(){Ty||(Ty=!0,h2=w),qE(c,d)},p}function Gk(c,d,p){p=_l(-1,p),p.tag=3;var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var S=d.value;p.payload=function(){return w(S)},p.callback=function(){qE(c,d)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(p.callback=function(){qE(c,d),typeof w!="function"&&(yc===null?yc=new Set([this]):yc.add(this));var B=d.stack;this.componentDidCatch(d.value,{componentStack:B!==null?B:""})}),p}function Bk(c,d,p){var w=c.pingCache;if(w===null){w=c.pingCache=new cB;var S=new Set;w.set(d,S)}else S=w.get(d),S===void 0&&(S=new Set,w.set(d,S));S.has(p)||(S.add(p),c=SB.bind(null,c,d,p),d.then(c,c))}function Uk(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function zk(c,d,p,w,S){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=_l(-1,1),d.tag=2,mc(p,d,1))),p.lanes|=1),c):(c.flags|=65536,c.lanes=S,c)}var uB=M.ReactCurrentOwner,ps=!1;function rs(c,d,p,w){d.child=c===null?ck(d,null,p,w):qd(d,c.child,p,w)}function $k(c,d,p,w,S){p=p.render;var A=d.ref;return Qd(d,S),w=BE(c,d,p,w,A,S),p=UE(),c!==null&&!ps?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,xl(c,d,S)):(mr&&p&&TE(d),d.flags|=1,rs(c,d,w,S),d.child)}function Wk(c,d,p,w,S){if(c===null){var A=p.type;return typeof A=="function"&&!_2(A)&&A.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=A,Hk(c,d,A,w,S)):(c=ky(p.type,null,w,d,d.mode,S),c.ref=d.ref,c.return=d,d.child=c)}if(A=c.child,(c.lanes&S)===0){var B=A.memoizedProps;if(p=p.compare,p=p!==null?p:mg,p(B,w)&&c.ref===d.ref)return xl(c,d,S)}return d.flags|=1,c=wc(A,w),c.ref=d.ref,c.return=d,d.child=c}function Hk(c,d,p,w,S){if(c!==null){var A=c.memoizedProps;if(mg(A,w)&&c.ref===d.ref)if(ps=!1,d.pendingProps=w=A,(c.lanes&S)!==0)(c.flags&131072)!==0&&(ps=!0);else return d.lanes=c.lanes,xl(c,d,S)}return ZE(c,d,p,w,S)}function Kk(c,d,p){var w=d.pendingProps,S=w.children,A=c!==null?c.memoizedState:null;if(w.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},nr(nf,zs),zs|=p;else{if((p&1073741824)===0)return c=A!==null?A.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,nr(nf,zs),zs|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=A!==null?A.baseLanes:p,nr(nf,zs),zs|=w}else A!==null?(w=A.baseLanes|p,d.memoizedState=null):w=p,nr(nf,zs),zs|=w;return rs(c,d,S,p),d.child}function Yk(c,d){var p=d.ref;(c===null&&p!==null||c!==null&&c.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function ZE(c,d,p,w,S){var A=ms(p)?Uu:Vi.current;return A=Hd(d,A),Qd(d,S),p=BE(c,d,p,w,A,S),w=UE(),c!==null&&!ps?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,xl(c,d,S)):(mr&&w&&TE(d),d.flags|=1,rs(c,d,p,S),d.child)}function Xk(c,d,p,w,S){if(ms(p)){var A=!0;ty(d)}else A=!1;if(Qd(d,S),d.stateNode===null)xy(c,d),Fk(d,p,w),YE(d,p,w,S),w=!0;else if(c===null){var B=d.stateNode,re=d.memoizedProps;B.props=re;var ae=B.context,Ae=p.contextType;typeof Ae=="object"&&Ae!==null?Ae=da(Ae):(Ae=ms(p)?Uu:Vi.current,Ae=Hd(d,Ae));var He=p.getDerivedStateFromProps,qe=typeof He=="function"||typeof B.getSnapshotBeforeUpdate=="function";qe||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(re!==w||ae!==Ae)&&jk(d,B,w,Ae),gc=!1;var ze=d.memoizedState;B.state=ze,uy(d,w,B,S),ae=d.memoizedState,re!==w||ze!==ae||gs.current||gc?(typeof He=="function"&&(KE(d,p,He,w),ae=d.memoizedState),(re=gc||Dk(d,p,re,w,ze,ae,Ae))?(qe||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(d.flags|=4194308)):(typeof B.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=w,d.memoizedState=ae),B.props=w,B.state=ae,B.context=Ae,w=re):(typeof B.componentDidMount=="function"&&(d.flags|=4194308),w=!1)}else{B=d.stateNode,hk(c,d),re=d.memoizedProps,Ae=d.type===d.elementType?re:ja(d.type,re),B.props=Ae,qe=d.pendingProps,ze=B.context,ae=p.contextType,typeof ae=="object"&&ae!==null?ae=da(ae):(ae=ms(p)?Uu:Vi.current,ae=Hd(d,ae));var yt=p.getDerivedStateFromProps;(He=typeof yt=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(re!==qe||ze!==ae)&&jk(d,B,w,ae),gc=!1,ze=d.memoizedState,B.state=ze,uy(d,w,B,S);var wt=d.memoizedState;re!==qe||ze!==wt||gs.current||gc?(typeof yt=="function"&&(KE(d,p,yt,w),wt=d.memoizedState),(Ae=gc||Dk(d,p,Ae,w,ze,wt,ae)||!1)?(He||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(w,wt,ae),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(w,wt,ae)),typeof B.componentDidUpdate=="function"&&(d.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof B.componentDidUpdate!="function"||re===c.memoizedProps&&ze===c.memoizedState||(d.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||re===c.memoizedProps&&ze===c.memoizedState||(d.flags|=1024),d.memoizedProps=w,d.memoizedState=wt),B.props=w,B.state=wt,B.context=ae,w=Ae):(typeof B.componentDidUpdate!="function"||re===c.memoizedProps&&ze===c.memoizedState||(d.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||re===c.memoizedProps&&ze===c.memoizedState||(d.flags|=1024),w=!1)}return QE(c,d,p,w,A,S)}function QE(c,d,p,w,S,A){Yk(c,d);var B=(d.flags&128)!==0;if(!w&&!B)return S&&ek(d,p,!1),xl(c,d,A);w=d.stateNode,uB.current=d;var re=B&&typeof p.getDerivedStateFromError!="function"?null:w.render();return d.flags|=1,c!==null&&B?(d.child=qd(d,c.child,null,A),d.child=qd(d,null,re,A)):rs(c,d,re,A),d.memoizedState=w.state,S&&ek(d,p,!0),d.child}function qk(c){var d=c.stateNode;d.pendingContext?QC(c,d.pendingContext,d.pendingContext!==d.context):d.context&&QC(c,d.context,!1),OE(c,d.containerInfo)}function Zk(c,d,p,w,S){return Xd(),RE(S),d.flags|=256,rs(c,d,p,w),d.child}var JE={dehydrated:null,treeContext:null,retryLane:0};function e2(c){return{baseLanes:c,cachePool:null,transitions:null}}function Qk(c,d,p){var w=d.pendingProps,S=Er.current,A=!1,B=(d.flags&128)!==0,re;if((re=B)||(re=c!==null&&c.memoizedState===null?!1:(S&2)!==0),re?(A=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(S|=1),nr(Er,S&1),c===null)return AE(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(B=w.children,c=w.fallback,A?(w=d.mode,A=d.child,B={mode:"hidden",children:B},(w&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=B):A=Py(B,w,0,null),c=Qu(c,w,p,null),A.return=d,c.return=d,A.sibling=c,d.child=A,d.child.memoizedState=e2(p),d.memoizedState=JE,c):t2(d,B));if(S=c.memoizedState,S!==null&&(re=S.dehydrated,re!==null))return hB(c,d,B,w,re,S,p);if(A){A=w.fallback,B=d.mode,S=c.child,re=S.sibling;var ae={mode:"hidden",children:w.children};return(B&1)===0&&d.child!==S?(w=d.child,w.childLanes=0,w.pendingProps=ae,d.deletions=null):(w=wc(S,ae),w.subtreeFlags=S.subtreeFlags&14680064),re!==null?A=wc(re,A):(A=Qu(A,B,p,null),A.flags|=2),A.return=d,w.return=d,w.sibling=A,d.child=w,w=A,A=d.child,B=c.child.memoizedState,B=B===null?e2(p):{baseLanes:B.baseLanes|p,cachePool:null,transitions:B.transitions},A.memoizedState=B,A.childLanes=c.childLanes&~p,d.memoizedState=JE,w}return A=c.child,c=A.sibling,w=wc(A,{mode:"visible",children:w.children}),(d.mode&1)===0&&(w.lanes=p),w.return=d,w.sibling=null,c!==null&&(p=d.deletions,p===null?(d.deletions=[c],d.flags|=16):p.push(c)),d.child=w,d.memoizedState=null,w}function t2(c,d){return d=Py({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function _y(c,d,p,w){return w!==null&&RE(w),qd(d,c.child,null,p),c=t2(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function hB(c,d,p,w,S,A,B){if(p)return d.flags&256?(d.flags&=-257,w=XE(Error(t(422))),_y(c,d,B,w)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(A=w.fallback,S=d.mode,w=Py({mode:"visible",children:w.children},S,0,null),A=Qu(A,S,B,null),A.flags|=2,w.return=d,A.return=d,w.sibling=A,d.child=w,(d.mode&1)!==0&&qd(d,c.child,null,B),d.child.memoizedState=e2(B),d.memoizedState=JE,A);if((d.mode&1)===0)return _y(c,d,B,null);if(S.data==="$!"){if(w=S.nextSibling&&S.nextSibling.dataset,w)var re=w.dgst;return w=re,A=Error(t(419)),w=XE(A,w,void 0),_y(c,d,B,w)}if(re=(B&c.childLanes)!==0,ps||re){if(w=li,w!==null){switch(B&-B){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(w.suspendedLanes|B))!==0?0:S,S!==0&&S!==A.retryLane&&(A.retryLane=S,yl(c,S),Ba(w,c,S,-1))}return y2(),w=XE(Error(t(421))),_y(c,d,B,w)}return S.data==="$?"?(d.flags|=128,d.child=c.child,d=TB.bind(null,c),S._reactRetry=d,null):(c=A.treeContext,Us=uc(S.nextSibling),Bs=d,mr=!0,Fa=null,c!==null&&(ua[ha++]=ml,ua[ha++]=pl,ua[ha++]=zu,ml=c.id,pl=c.overflow,zu=d),d=t2(d,w.children),d.flags|=4096,d)}function Jk(c,d,p){c.lanes|=d;var w=c.alternate;w!==null&&(w.lanes|=d),ME(c.return,d,p)}function n2(c,d,p,w,S){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:S}:(A.isBackwards=d,A.rendering=null,A.renderingStartTime=0,A.last=w,A.tail=p,A.tailMode=S)}function eP(c,d,p){var w=d.pendingProps,S=w.revealOrder,A=w.tail;if(rs(c,d,w.children,p),w=Er.current,(w&2)!==0)w=w&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Jk(c,p,d);else if(c.tag===19)Jk(c,p,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}w&=1}if(nr(Er,w),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(p=d.child,S=null;p!==null;)c=p.alternate,c!==null&&hy(c)===null&&(S=p),p=p.sibling;p=S,p===null?(S=d.child,d.child=null):(S=p.sibling,p.sibling=null),n2(d,!1,S,p,A);break;case"backwards":for(p=null,S=d.child,d.child=null;S!==null;){if(c=S.alternate,c!==null&&hy(c)===null){d.child=S;break}c=S.sibling,S.sibling=p,p=S,S=c}n2(d,!0,p,null,A);break;case"together":n2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function xy(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function xl(c,d,p){if(c!==null&&(d.dependencies=c.dependencies),Yu|=d.lanes,(p&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,p=wc(c,c.pendingProps),d.child=p,p.return=d;c.sibling!==null;)c=c.sibling,p=p.sibling=wc(c,c.pendingProps),p.return=d;p.sibling=null}return d.child}function dB(c,d,p){switch(d.tag){case 3:qk(d),Xd();break;case 5:gk(d);break;case 1:ms(d.type)&&ty(d);break;case 4:OE(d,d.stateNode.containerInfo);break;case 10:var w=d.type._context,S=d.memoizedProps.value;nr(oy,w._currentValue),w._currentValue=S;break;case 13:if(w=d.memoizedState,w!==null)return w.dehydrated!==null?(nr(Er,Er.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?Qk(c,d,p):(nr(Er,Er.current&1),c=xl(c,d,p),c!==null?c.sibling:null);nr(Er,Er.current&1);break;case 19:if(w=(p&d.childLanes)!==0,(c.flags&128)!==0){if(w)return eP(c,d,p);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),nr(Er,Er.current),w)break;return null;case 22:case 23:return d.lanes=0,Kk(c,d,p)}return xl(c,d,p)}var tP,r2,nP,rP;tP=function(c,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)c.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},r2=function(){},nP=function(c,d,p,w){var S=c.memoizedProps;if(S!==w){c=d.stateNode,Hu(Ao.current);var A=null;switch(p){case"input":S=Mt(c,S),w=Mt(c,w),A=[];break;case"select":S=le({},S,{value:void 0}),w=le({},w,{value:void 0}),A=[];break;case"textarea":S=mt(c,S),w=mt(c,w),A=[];break;default:typeof S.onClick!="function"&&typeof w.onClick=="function"&&(c.onclick=Q1)}Nt(p,w);var B;p=null;for(Ae in S)if(!w.hasOwnProperty(Ae)&&S.hasOwnProperty(Ae)&&S[Ae]!=null)if(Ae==="style"){var re=S[Ae];for(B in re)re.hasOwnProperty(B)&&(p||(p={}),p[B]="")}else Ae!=="dangerouslySetInnerHTML"&&Ae!=="children"&&Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&Ae!=="autoFocus"&&(i.hasOwnProperty(Ae)?A||(A=[]):(A=A||[]).push(Ae,null));for(Ae in w){var ae=w[Ae];if(re=S?.[Ae],w.hasOwnProperty(Ae)&&ae!==re&&(ae!=null||re!=null))if(Ae==="style")if(re){for(B in re)!re.hasOwnProperty(B)||ae&&ae.hasOwnProperty(B)||(p||(p={}),p[B]="");for(B in ae)ae.hasOwnProperty(B)&&re[B]!==ae[B]&&(p||(p={}),p[B]=ae[B])}else p||(A||(A=[]),A.push(Ae,p)),p=ae;else Ae==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,re=re?re.__html:void 0,ae!=null&&re!==ae&&(A=A||[]).push(Ae,ae)):Ae==="children"?typeof ae!="string"&&typeof ae!="number"||(A=A||[]).push(Ae,""+ae):Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ae)?(ae!=null&&Ae==="onScroll"&&ar("scroll",c),A||re===ae||(A=[])):(A=A||[]).push(Ae,ae))}p&&(A=A||[]).push("style",p);var Ae=A;(d.updateQueue=Ae)&&(d.flags|=4)}},rP=function(c,d,p,w){p!==w&&(d.flags|=4)};function kg(c,d){if(!mr)switch(c.tailMode){case"hidden":d=c.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?c.tail=null:p.sibling=null;break;case"collapsed":p=c.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:w.sibling=null}}function Bi(c){var d=c.alternate!==null&&c.alternate.child===c.child,p=0,w=0;if(d)for(var S=c.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags&14680064,w|=S.flags&14680064,S.return=c,S=S.sibling;else for(S=c.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags,w|=S.flags,S.return=c,S=S.sibling;return c.subtreeFlags|=w,c.childLanes=p,d}function fB(c,d,p){var w=d.pendingProps;switch(bE(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bi(d),null;case 1:return ms(d.type)&&ey(),Bi(d),null;case 3:return w=d.stateNode,Jd(),or(gs),or(Vi),jE(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(c===null||c.child===null)&&(sy(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Fa!==null&&(g2(Fa),Fa=null))),r2(c,d),Bi(d),null;case 5:DE(d);var S=Hu(bg.current);if(p=d.type,c!==null&&d.stateNode!=null)nP(c,d,p,w,S),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!w){if(d.stateNode===null)throw Error(t(166));return Bi(d),null}if(c=Hu(Ao.current),sy(d)){w=d.stateNode,p=d.type;var A=d.memoizedProps;switch(w[Io]=d,w[vg]=A,c=(d.mode&1)!==0,p){case"dialog":ar("cancel",w),ar("close",w);break;case"iframe":case"object":case"embed":ar("load",w);break;case"video":case"audio":for(S=0;S<yg.length;S++)ar(yg[S],w);break;case"source":ar("error",w);break;case"img":case"image":case"link":ar("error",w),ar("load",w);break;case"details":ar("toggle",w);break;case"input":jn(w,A),ar("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!A.multiple},ar("invalid",w);break;case"textarea":Bt(w,A),ar("invalid",w)}Nt(p,A),S=null;for(var B in A)if(A.hasOwnProperty(B)){var re=A[B];B==="children"?typeof re=="string"?w.textContent!==re&&(A.suppressHydrationWarning!==!0&&Z1(w.textContent,re,c),S=["children",re]):typeof re=="number"&&w.textContent!==""+re&&(A.suppressHydrationWarning!==!0&&Z1(w.textContent,re,c),S=["children",""+re]):i.hasOwnProperty(B)&&re!=null&&B==="onScroll"&&ar("scroll",w)}switch(p){case"input":Ct(w),Zn(w,A,!0);break;case"textarea":Ct(w),_t(w);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(w.onclick=Q1)}w=S,d.updateQueue=w,w!==null&&(d.flags|=4)}else{B=S.nodeType===9?S:S.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Jt(p)),c==="http://www.w3.org/1999/xhtml"?p==="script"?(c=B.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof w.is=="string"?c=B.createElement(p,{is:w.is}):(c=B.createElement(p),p==="select"&&(B=c,w.multiple?B.multiple=!0:w.size&&(B.size=w.size))):c=B.createElementNS(c,p),c[Io]=d,c[vg]=w,tP(c,d,!1,!1),d.stateNode=c;e:{switch(B=L(p,w),p){case"dialog":ar("cancel",c),ar("close",c),S=w;break;case"iframe":case"object":case"embed":ar("load",c),S=w;break;case"video":case"audio":for(S=0;S<yg.length;S++)ar(yg[S],c);S=w;break;case"source":ar("error",c),S=w;break;case"img":case"image":case"link":ar("error",c),ar("load",c),S=w;break;case"details":ar("toggle",c),S=w;break;case"input":jn(c,w),S=Mt(c,w),ar("invalid",c);break;case"option":S=w;break;case"select":c._wrapperState={wasMultiple:!!w.multiple},S=le({},w,{value:void 0}),ar("invalid",c);break;case"textarea":Bt(c,w),S=mt(c,w),ar("invalid",c);break;default:S=w}Nt(p,S),re=S;for(A in re)if(re.hasOwnProperty(A)){var ae=re[A];A==="style"?Ee(c,ae):A==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&ai(c,ae)):A==="children"?typeof ae=="string"?(p!=="textarea"||ae!=="")&&Br(c,ae):typeof ae=="number"&&Br(c,""+ae):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(i.hasOwnProperty(A)?ae!=null&&A==="onScroll"&&ar("scroll",c):ae!=null&&I(c,A,ae,B))}switch(p){case"input":Ct(c),Zn(c,w,!1);break;case"textarea":Ct(c),_t(c);break;case"option":w.value!=null&&c.setAttribute("value",""+Be(w.value));break;case"select":c.multiple=!!w.multiple,A=w.value,A!=null?Qn(c,!!w.multiple,A,!1):w.defaultValue!=null&&Qn(c,!!w.multiple,w.defaultValue,!0);break;default:typeof S.onClick=="function"&&(c.onclick=Q1)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Bi(d),null;case 6:if(c&&d.stateNode!=null)rP(c,d,c.memoizedProps,w);else{if(typeof w!="string"&&d.stateNode===null)throw Error(t(166));if(p=Hu(bg.current),Hu(Ao.current),sy(d)){if(w=d.stateNode,p=d.memoizedProps,w[Io]=d,(A=w.nodeValue!==p)&&(c=Bs,c!==null))switch(c.tag){case 3:Z1(w.nodeValue,p,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Z1(w.nodeValue,p,(c.mode&1)!==0)}A&&(d.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[Io]=d,d.stateNode=w}return Bi(d),null;case 13:if(or(Er),w=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(mr&&Us!==null&&(d.mode&1)!==0&&(d.flags&128)===0)ak(),Xd(),d.flags|=98560,A=!1;else if(A=sy(d),w!==null&&w.dehydrated!==null){if(c===null){if(!A)throw Error(t(318));if(A=d.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(t(317));A[Io]=d}else Xd(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Bi(d),A=!1}else Fa!==null&&(g2(Fa),Fa=null),A=!0;if(!A)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(w=w!==null,w!==(c!==null&&c.memoizedState!==null)&&w&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(Er.current&1)!==0?Qr===0&&(Qr=3):y2())),d.updateQueue!==null&&(d.flags|=4),Bi(d),null);case 4:return Jd(),r2(c,d),c===null&&_g(d.stateNode.containerInfo),Bi(d),null;case 10:return PE(d.type._context),Bi(d),null;case 17:return ms(d.type)&&ey(),Bi(d),null;case 19:if(or(Er),A=d.memoizedState,A===null)return Bi(d),null;if(w=(d.flags&128)!==0,B=A.rendering,B===null)if(w)kg(A,!1);else{if(Qr!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(B=hy(c),B!==null){for(d.flags|=128,kg(A,!1),w=B.updateQueue,w!==null&&(d.updateQueue=w,d.flags|=4),d.subtreeFlags=0,w=p,p=d.child;p!==null;)A=p,c=w,A.flags&=14680066,B=A.alternate,B===null?(A.childLanes=0,A.lanes=c,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=B.childLanes,A.lanes=B.lanes,A.child=B.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=B.memoizedProps,A.memoizedState=B.memoizedState,A.updateQueue=B.updateQueue,A.type=B.type,c=B.dependencies,A.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),p=p.sibling;return nr(Er,Er.current&1|2),d.child}c=c.sibling}A.tail!==null&&Xe()>rf&&(d.flags|=128,w=!0,kg(A,!1),d.lanes=4194304)}else{if(!w)if(c=hy(B),c!==null){if(d.flags|=128,w=!0,p=c.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),kg(A,!0),A.tail===null&&A.tailMode==="hidden"&&!B.alternate&&!mr)return Bi(d),null}else 2*Xe()-A.renderingStartTime>rf&&p!==1073741824&&(d.flags|=128,w=!0,kg(A,!1),d.lanes=4194304);A.isBackwards?(B.sibling=d.child,d.child=B):(p=A.last,p!==null?p.sibling=B:d.child=B,A.last=B)}return A.tail!==null?(d=A.tail,A.rendering=d,A.tail=d.sibling,A.renderingStartTime=Xe(),d.sibling=null,p=Er.current,nr(Er,w?p&1|2:p&1),d):(Bi(d),null);case 22:case 23:return p2(),w=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==w&&(d.flags|=8192),w&&(d.mode&1)!==0?(zs&1073741824)!==0&&(Bi(d),d.subtreeFlags&6&&(d.flags|=8192)):Bi(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function gB(c,d){switch(bE(d),d.tag){case 1:return ms(d.type)&&ey(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return Jd(),or(gs),or(Vi),jE(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return DE(d),null;case 13:if(or(Er),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));Xd()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return or(Er),null;case 4:return Jd(),null;case 10:return PE(d.type._context),null;case 22:case 23:return p2(),null;case 24:return null;default:return null}}var vy=!1,Ui=!1,mB=typeof WeakSet=="function"?WeakSet:Set,xt=null;function tf(c,d){var p=c.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){Ar(c,d,w)}else p.current=null}function i2(c,d,p){try{p()}catch(w){Ar(c,d,w)}}var iP=!1;function pB(c,d){if(pE=ul,c=DC(),lE(c)){if("selectionStart"in c)var p={start:c.selectionStart,end:c.selectionEnd};else e:{p=(p=c.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var S=w.anchorOffset,A=w.focusNode;w=w.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var B=0,re=-1,ae=-1,Ae=0,He=0,qe=c,ze=null;t:for(;;){for(var yt;qe!==p||S!==0&&qe.nodeType!==3||(re=B+S),qe!==A||w!==0&&qe.nodeType!==3||(ae=B+w),qe.nodeType===3&&(B+=qe.nodeValue.length),(yt=qe.firstChild)!==null;)ze=qe,qe=yt;for(;;){if(qe===c)break t;if(ze===p&&++Ae===S&&(re=B),ze===A&&++He===w&&(ae=B),(yt=qe.nextSibling)!==null)break;qe=ze,ze=qe.parentNode}qe=yt}p=re===-1||ae===-1?null:{start:re,end:ae}}else p=null}p=p||{start:0,end:0}}else p=null;for(yE={focusedElem:c,selectionRange:p},ul=!1,xt=d;xt!==null;)if(d=xt,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,xt=c;else for(;xt!==null;){d=xt;try{var wt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(wt!==null){var Tt=wt.memoizedProps,Fr=wt.memoizedState,fe=d.stateNode,oe=fe.getSnapshotBeforeUpdate(d.elementType===d.type?Tt:ja(d.type,Tt),Fr);fe.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var ve=d.stateNode.containerInfo;ve.nodeType===1?ve.textContent="":ve.nodeType===9&&ve.documentElement&&ve.removeChild(ve.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){Ar(d,d.return,Je)}if(c=d.sibling,c!==null){c.return=d.return,xt=c;break}xt=d.return}return wt=iP,iP=!1,wt}function Pg(c,d,p){var w=d.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var S=w=w.next;do{if((S.tag&c)===c){var A=S.destroy;S.destroy=void 0,A!==void 0&&i2(d,p,A)}S=S.next}while(S!==w)}}function wy(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&c)===c){var w=p.create;p.destroy=w()}p=p.next}while(p!==d)}}function s2(c){var d=c.ref;if(d!==null){var p=c.stateNode;switch(c.tag){case 5:c=p;break;default:c=p}typeof d=="function"?d(c):d.current=c}}function sP(c){var d=c.alternate;d!==null&&(c.alternate=null,sP(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[Io],delete d[vg],delete d[wE],delete d[QG],delete d[JG])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function aP(c){return c.tag===5||c.tag===3||c.tag===4}function oP(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||aP(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function a2(c,d,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(c,d):p.insertBefore(c,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(c,p)):(d=p,d.appendChild(c)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=Q1));else if(w!==4&&(c=c.child,c!==null))for(a2(c,d,p),c=c.sibling;c!==null;)a2(c,d,p),c=c.sibling}function o2(c,d,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,d?p.insertBefore(c,d):p.appendChild(c);else if(w!==4&&(c=c.child,c!==null))for(o2(c,d,p),c=c.sibling;c!==null;)o2(c,d,p),c=c.sibling}var Si=null,Va=!1;function pc(c,d,p){for(p=p.child;p!==null;)lP(c,d,p),p=p.sibling}function lP(c,d,p){if(Or&&typeof Or.onCommitFiberUnmount=="function")try{Or.onCommitFiberUnmount(Ds,p)}catch{}switch(p.tag){case 5:Ui||tf(p,d);case 6:var w=Si,S=Va;Si=null,pc(c,d,p),Si=w,Va=S,Si!==null&&(Va?(c=Si,p=p.stateNode,c.nodeType===8?c.parentNode.removeChild(p):c.removeChild(p)):Si.removeChild(p.stateNode));break;case 18:Si!==null&&(Va?(c=Si,p=p.stateNode,c.nodeType===8?vE(c.parentNode,p):c.nodeType===1&&vE(c,p),ac(c)):vE(Si,p.stateNode));break;case 4:w=Si,S=Va,Si=p.stateNode.containerInfo,Va=!0,pc(c,d,p),Si=w,Va=S;break;case 0:case 11:case 14:case 15:if(!Ui&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){S=w=w.next;do{var A=S,B=A.destroy;A=A.tag,B!==void 0&&((A&2)!==0||(A&4)!==0)&&i2(p,d,B),S=S.next}while(S!==w)}pc(c,d,p);break;case 1:if(!Ui&&(tf(p,d),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(re){Ar(p,d,re)}pc(c,d,p);break;case 21:pc(c,d,p);break;case 22:p.mode&1?(Ui=(w=Ui)||p.memoizedState!==null,pc(c,d,p),Ui=w):pc(c,d,p);break;default:pc(c,d,p)}}function cP(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var p=c.stateNode;p===null&&(p=c.stateNode=new mB),d.forEach(function(w){var S=bB.bind(null,c,w);p.has(w)||(p.add(w),w.then(S,S))})}}function Ga(c,d){var p=d.deletions;if(p!==null)for(var w=0;w<p.length;w++){var S=p[w];try{var A=c,B=d,re=B;e:for(;re!==null;){switch(re.tag){case 5:Si=re.stateNode,Va=!1;break e;case 3:Si=re.stateNode.containerInfo,Va=!0;break e;case 4:Si=re.stateNode.containerInfo,Va=!0;break e}re=re.return}if(Si===null)throw Error(t(160));lP(A,B,S),Si=null,Va=!1;var ae=S.alternate;ae!==null&&(ae.return=null),S.return=null}catch(Ae){Ar(S,d,Ae)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)uP(d,c),d=d.sibling}function uP(c,d){var p=c.alternate,w=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Ga(d,c),Co(c),w&4){try{Pg(3,c,c.return),wy(3,c)}catch(Tt){Ar(c,c.return,Tt)}try{Pg(5,c,c.return)}catch(Tt){Ar(c,c.return,Tt)}}break;case 1:Ga(d,c),Co(c),w&512&&p!==null&&tf(p,p.return);break;case 5:if(Ga(d,c),Co(c),w&512&&p!==null&&tf(p,p.return),c.flags&32){var S=c.stateNode;try{Br(S,"")}catch(Tt){Ar(c,c.return,Tt)}}if(w&4&&(S=c.stateNode,S!=null)){var A=c.memoizedProps,B=p!==null?p.memoizedProps:A,re=c.type,ae=c.updateQueue;if(c.updateQueue=null,ae!==null)try{re==="input"&&A.type==="radio"&&A.name!=null&&Qt(S,A),L(re,B);var Ae=L(re,A);for(B=0;B<ae.length;B+=2){var He=ae[B],qe=ae[B+1];He==="style"?Ee(S,qe):He==="dangerouslySetInnerHTML"?ai(S,qe):He==="children"?Br(S,qe):I(S,He,qe,Ae)}switch(re){case"input":ot(S,A);break;case"textarea":Mn(S,A);break;case"select":var ze=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!A.multiple;var yt=A.value;yt!=null?Qn(S,!!A.multiple,yt,!1):ze!==!!A.multiple&&(A.defaultValue!=null?Qn(S,!!A.multiple,A.defaultValue,!0):Qn(S,!!A.multiple,A.multiple?[]:"",!1))}S[vg]=A}catch(Tt){Ar(c,c.return,Tt)}}break;case 6:if(Ga(d,c),Co(c),w&4){if(c.stateNode===null)throw Error(t(162));S=c.stateNode,A=c.memoizedProps;try{S.nodeValue=A}catch(Tt){Ar(c,c.return,Tt)}}break;case 3:if(Ga(d,c),Co(c),w&4&&p!==null&&p.memoizedState.isDehydrated)try{ac(d.containerInfo)}catch(Tt){Ar(c,c.return,Tt)}break;case 4:Ga(d,c),Co(c);break;case 13:Ga(d,c),Co(c),S=c.child,S.flags&8192&&(A=S.memoizedState!==null,S.stateNode.isHidden=A,!A||S.alternate!==null&&S.alternate.memoizedState!==null||(u2=Xe())),w&4&&cP(c);break;case 22:if(He=p!==null&&p.memoizedState!==null,c.mode&1?(Ui=(Ae=Ui)||He,Ga(d,c),Ui=Ae):Ga(d,c),Co(c),w&8192){if(Ae=c.memoizedState!==null,(c.stateNode.isHidden=Ae)&&!He&&(c.mode&1)!==0)for(xt=c,He=c.child;He!==null;){for(qe=xt=He;xt!==null;){switch(ze=xt,yt=ze.child,ze.tag){case 0:case 11:case 14:case 15:Pg(4,ze,ze.return);break;case 1:tf(ze,ze.return);var wt=ze.stateNode;if(typeof wt.componentWillUnmount=="function"){w=ze,p=ze.return;try{d=w,wt.props=d.memoizedProps,wt.state=d.memoizedState,wt.componentWillUnmount()}catch(Tt){Ar(w,p,Tt)}}break;case 5:tf(ze,ze.return);break;case 22:if(ze.memoizedState!==null){fP(qe);continue}}yt!==null?(yt.return=ze,xt=yt):fP(qe)}He=He.sibling}e:for(He=null,qe=c;;){if(qe.tag===5){if(He===null){He=qe;try{S=qe.stateNode,Ae?(A=S.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(re=qe.stateNode,ae=qe.memoizedProps.style,B=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,re.style.display=Oe("display",B))}catch(Tt){Ar(c,c.return,Tt)}}}else if(qe.tag===6){if(He===null)try{qe.stateNode.nodeValue=Ae?"":qe.memoizedProps}catch(Tt){Ar(c,c.return,Tt)}}else if((qe.tag!==22&&qe.tag!==23||qe.memoizedState===null||qe===c)&&qe.child!==null){qe.child.return=qe,qe=qe.child;continue}if(qe===c)break e;for(;qe.sibling===null;){if(qe.return===null||qe.return===c)break e;He===qe&&(He=null),qe=qe.return}He===qe&&(He=null),qe.sibling.return=qe.return,qe=qe.sibling}}break;case 19:Ga(d,c),Co(c),w&4&&cP(c);break;case 21:break;default:Ga(d,c),Co(c)}}function Co(c){var d=c.flags;if(d&2){try{e:{for(var p=c.return;p!==null;){if(aP(p)){var w=p;break e}p=p.return}throw Error(t(160))}switch(w.tag){case 5:var S=w.stateNode;w.flags&32&&(Br(S,""),w.flags&=-33);var A=oP(c);o2(c,A,S);break;case 3:case 4:var B=w.stateNode.containerInfo,re=oP(c);a2(c,re,B);break;default:throw Error(t(161))}}catch(ae){Ar(c,c.return,ae)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function yB(c,d,p){xt=c,hP(c)}function hP(c,d,p){for(var w=(c.mode&1)!==0;xt!==null;){var S=xt,A=S.child;if(S.tag===22&&w){var B=S.memoizedState!==null||vy;if(!B){var re=S.alternate,ae=re!==null&&re.memoizedState!==null||Ui;re=vy;var Ae=Ui;if(vy=B,(Ui=ae)&&!Ae)for(xt=S;xt!==null;)B=xt,ae=B.child,B.tag===22&&B.memoizedState!==null?gP(S):ae!==null?(ae.return=B,xt=ae):gP(S);for(;A!==null;)xt=A,hP(A),A=A.sibling;xt=S,vy=re,Ui=Ae}dP(c)}else(S.subtreeFlags&8772)!==0&&A!==null?(A.return=S,xt=A):dP(c)}}function dP(c){for(;xt!==null;){var d=xt;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Ui||wy(5,d);break;case 1:var w=d.stateNode;if(d.flags&4&&!Ui)if(p===null)w.componentDidMount();else{var S=d.elementType===d.type?p.memoizedProps:ja(d.type,p.memoizedProps);w.componentDidUpdate(S,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var A=d.updateQueue;A!==null&&fk(d,A,w);break;case 3:var B=d.updateQueue;if(B!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}fk(d,B,p)}break;case 5:var re=d.stateNode;if(p===null&&d.flags&4){p=re;var ae=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&p.focus();break;case"img":ae.src&&(p.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Ae=d.alternate;if(Ae!==null){var He=Ae.memoizedState;if(He!==null){var qe=He.dehydrated;qe!==null&&ac(qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ui||d.flags&512&&s2(d)}catch(ze){Ar(d,d.return,ze)}}if(d===c){xt=null;break}if(p=d.sibling,p!==null){p.return=d.return,xt=p;break}xt=d.return}}function fP(c){for(;xt!==null;){var d=xt;if(d===c){xt=null;break}var p=d.sibling;if(p!==null){p.return=d.return,xt=p;break}xt=d.return}}function gP(c){for(;xt!==null;){var d=xt;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{wy(4,d)}catch(ae){Ar(d,p,ae)}break;case 1:var w=d.stateNode;if(typeof w.componentDidMount=="function"){var S=d.return;try{w.componentDidMount()}catch(ae){Ar(d,S,ae)}}var A=d.return;try{s2(d)}catch(ae){Ar(d,A,ae)}break;case 5:var B=d.return;try{s2(d)}catch(ae){Ar(d,B,ae)}}}catch(ae){Ar(d,d.return,ae)}if(d===c){xt=null;break}var re=d.sibling;if(re!==null){re.return=d.return,xt=re;break}xt=d.return}}var _B=Math.ceil,Ey=M.ReactCurrentDispatcher,l2=M.ReactCurrentOwner,ga=M.ReactCurrentBatchConfig,xn=0,li=null,zr=null,Ti=0,zs=0,nf=hc(0),Qr=0,Mg=null,Yu=0,Sy=0,c2=0,Ng=null,ys=null,u2=0,rf=1/0,vl=null,Ty=!1,h2=null,yc=null,by=!1,_c=null,Iy=0,Lg=0,d2=null,Ay=-1,Ry=0;function is(){return(xn&6)!==0?Xe():Ay!==-1?Ay:Ay=Xe()}function xc(c){return(c.mode&1)===0?1:(xn&2)!==0&&Ti!==0?Ti&-Ti:tB.transition!==null?(Ry===0&&(Ry=tg()),Ry):(c=mn,c!==0||(c=window.event,c=c===void 0?16:Md(c.type)),c)}function Ba(c,d,p,w){if(50<Lg)throw Lg=0,d2=null,Error(t(185));Du(c,p,w),((xn&2)===0||c!==li)&&(c===li&&((xn&2)===0&&(Sy|=p),Qr===4&&vc(c,Ti)),_s(c,w),p===1&&xn===0&&(d.mode&1)===0&&(rf=Xe()+500,ny&&fc()))}function _s(c,d){var p=c.callbackNode;Ou(c,d);var w=ol(c,c===li?Ti:0);if(w===0)p!==null&&tt(p),c.callbackNode=null,c.callbackPriority=0;else if(d=w&-w,c.callbackPriority!==d){if(p!=null&&tt(p),d===1)c.tag===0?eB(pP.bind(null,c)):tk(pP.bind(null,c)),qG(function(){(xn&6)===0&&fc()}),p=null;else{switch(po(w)){case 1:p=Nn;break;case 4:p=Vn;break;case 16:p=gr;break;case 536870912:p=la;break;default:p=gr}p=TP(p,mP.bind(null,c))}c.callbackPriority=d,c.callbackNode=p}}function mP(c,d){if(Ay=-1,Ry=0,(xn&6)!==0)throw Error(t(327));var p=c.callbackNode;if(sf()&&c.callbackNode!==p)return null;var w=ol(c,c===li?Ti:0);if(w===0)return null;if((w&30)!==0||(w&c.expiredLanes)!==0||d)d=Cy(c,w);else{d=w;var S=xn;xn|=2;var A=_P();(li!==c||Ti!==d)&&(vl=null,rf=Xe()+500,qu(c,d));do try{wB();break}catch(re){yP(c,re)}while(!0);kE(),Ey.current=A,xn=S,zr!==null?d=0:(li=null,Ti=0,d=Qr)}if(d!==0){if(d===2&&(S=eg(c),S!==0&&(w=S,d=f2(c,S))),d===1)throw p=Mg,qu(c,0),vc(c,w),_s(c,Xe()),p;if(d===6)vc(c,w);else{if(S=c.current.alternate,(w&30)===0&&!xB(S)&&(d=Cy(c,w),d===2&&(A=eg(c),A!==0&&(w=A,d=f2(c,A))),d===1))throw p=Mg,qu(c,0),vc(c,w),_s(c,Xe()),p;switch(c.finishedWork=S,c.finishedLanes=w,d){case 0:case 1:throw Error(t(345));case 2:Zu(c,ys,vl);break;case 3:if(vc(c,w),(w&130023424)===w&&(d=u2+500-Xe(),10<d)){if(ol(c,0)!==0)break;if(S=c.suspendedLanes,(S&w)!==w){is(),c.pingedLanes|=c.suspendedLanes&S;break}c.timeoutHandle=xE(Zu.bind(null,c,ys,vl),d);break}Zu(c,ys,vl);break;case 4:if(vc(c,w),(w&4194240)===w)break;for(d=c.eventTimes,S=-1;0<w;){var B=31-wr(w);A=1<<B,B=d[B],B>S&&(S=B),w&=~A}if(w=S,w=Xe()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*_B(w/1960))-w,10<w){c.timeoutHandle=xE(Zu.bind(null,c,ys,vl),w);break}Zu(c,ys,vl);break;case 5:Zu(c,ys,vl);break;default:throw Error(t(329))}}}return _s(c,Xe()),c.callbackNode===p?mP.bind(null,c):null}function f2(c,d){var p=Ng;return c.current.memoizedState.isDehydrated&&(qu(c,d).flags|=256),c=Cy(c,d),c!==2&&(d=ys,ys=p,d!==null&&g2(d)),c}function g2(c){ys===null?ys=c:ys.push.apply(ys,c)}function xB(c){for(var d=c;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var S=p[w],A=S.getSnapshot;S=S.value;try{if(!Da(A(),S))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function vc(c,d){for(d&=~c2,d&=~Sy,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var p=31-wr(d),w=1<<p;c[p]=-1,d&=~w}}function pP(c){if((xn&6)!==0)throw Error(t(327));sf();var d=ol(c,0);if((d&1)===0)return _s(c,Xe()),null;var p=Cy(c,d);if(c.tag!==0&&p===2){var w=eg(c);w!==0&&(d=w,p=f2(c,w))}if(p===1)throw p=Mg,qu(c,0),vc(c,d),_s(c,Xe()),p;if(p===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,Zu(c,ys,vl),_s(c,Xe()),null}function m2(c,d){var p=xn;xn|=1;try{return c(d)}finally{xn=p,xn===0&&(rf=Xe()+500,ny&&fc())}}function Xu(c){_c!==null&&_c.tag===0&&(xn&6)===0&&sf();var d=xn;xn|=1;var p=ga.transition,w=mn;try{if(ga.transition=null,mn=1,c)return c()}finally{mn=w,ga.transition=p,xn=d,(xn&6)===0&&fc()}}function p2(){zs=nf.current,or(nf)}function qu(c,d){c.finishedWork=null,c.finishedLanes=0;var p=c.timeoutHandle;if(p!==-1&&(c.timeoutHandle=-1,XG(p)),zr!==null)for(p=zr.return;p!==null;){var w=p;switch(bE(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&ey();break;case 3:Jd(),or(gs),or(Vi),jE();break;case 5:DE(w);break;case 4:Jd();break;case 13:or(Er);break;case 19:or(Er);break;case 10:PE(w.type._context);break;case 22:case 23:p2()}p=p.return}if(li=c,zr=c=wc(c.current,null),Ti=zs=d,Qr=0,Mg=null,c2=Sy=Yu=0,ys=Ng=null,Wu!==null){for(d=0;d<Wu.length;d++)if(p=Wu[d],w=p.interleaved,w!==null){p.interleaved=null;var S=w.next,A=p.pending;if(A!==null){var B=A.next;A.next=S,w.next=B}p.pending=w}Wu=null}return c}function yP(c,d){do{var p=zr;try{if(kE(),dy.current=py,fy){for(var w=Sr.memoizedState;w!==null;){var S=w.queue;S!==null&&(S.pending=null),w=w.next}fy=!1}if(Ku=0,oi=Zr=Sr=null,Ig=!1,Ag=0,l2.current=null,p===null||p.return===null){Qr=1,Mg=d,zr=null;break}e:{var A=c,B=p.return,re=p,ae=d;if(d=Ti,re.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Ae=ae,He=re,qe=He.tag;if((He.mode&1)===0&&(qe===0||qe===11||qe===15)){var ze=He.alternate;ze?(He.updateQueue=ze.updateQueue,He.memoizedState=ze.memoizedState,He.lanes=ze.lanes):(He.updateQueue=null,He.memoizedState=null)}var yt=Uk(B);if(yt!==null){yt.flags&=-257,zk(yt,B,re,A,d),yt.mode&1&&Bk(A,Ae,d),d=yt,ae=Ae;var wt=d.updateQueue;if(wt===null){var Tt=new Set;Tt.add(ae),d.updateQueue=Tt}else wt.add(ae);break e}else{if((d&1)===0){Bk(A,Ae,d),y2();break e}ae=Error(t(426))}}else if(mr&&re.mode&1){var Fr=Uk(B);if(Fr!==null){(Fr.flags&65536)===0&&(Fr.flags|=256),zk(Fr,B,re,A,d),RE(ef(ae,re));break e}}A=ae=ef(ae,re),Qr!==4&&(Qr=2),Ng===null?Ng=[A]:Ng.push(A),A=B;do{switch(A.tag){case 3:A.flags|=65536,d&=-d,A.lanes|=d;var fe=Vk(A,ae,d);dk(A,fe);break e;case 1:re=ae;var oe=A.type,ve=A.stateNode;if((A.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||ve!==null&&typeof ve.componentDidCatch=="function"&&(yc===null||!yc.has(ve)))){A.flags|=65536,d&=-d,A.lanes|=d;var Je=Gk(A,re,d);dk(A,Je);break e}}A=A.return}while(A!==null)}vP(p)}catch(It){d=It,zr===p&&p!==null&&(zr=p=p.return);continue}break}while(!0)}function _P(){var c=Ey.current;return Ey.current=py,c===null?py:c}function y2(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),li===null||(Yu&268435455)===0&&(Sy&268435455)===0||vc(li,Ti)}function Cy(c,d){var p=xn;xn|=2;var w=_P();(li!==c||Ti!==d)&&(vl=null,qu(c,d));do try{vB();break}catch(S){yP(c,S)}while(!0);if(kE(),xn=p,Ey.current=w,zr!==null)throw Error(t(261));return li=null,Ti=0,Qr}function vB(){for(;zr!==null;)xP(zr)}function wB(){for(;zr!==null&&!gt();)xP(zr)}function xP(c){var d=SP(c.alternate,c,zs);c.memoizedProps=c.pendingProps,d===null?vP(c):zr=d,l2.current=null}function vP(c){var d=c;do{var p=d.alternate;if(c=d.return,(d.flags&32768)===0){if(p=fB(p,d,zs),p!==null){zr=p;return}}else{if(p=gB(p,d),p!==null){p.flags&=32767,zr=p;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Qr=6,zr=null;return}}if(d=d.sibling,d!==null){zr=d;return}zr=d=c}while(d!==null);Qr===0&&(Qr=5)}function Zu(c,d,p){var w=mn,S=ga.transition;try{ga.transition=null,mn=1,EB(c,d,p,w)}finally{ga.transition=S,mn=w}return null}function EB(c,d,p,w){do sf();while(_c!==null);if((xn&6)!==0)throw Error(t(327));p=c.finishedWork;var S=c.finishedLanes;if(p===null)return null;if(c.finishedWork=null,c.finishedLanes=0,p===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var A=p.lanes|p.childLanes;if(rE(c,A),c===li&&(zr=li=null,Ti=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||by||(by=!0,TP(gr,function(){return sf(),null})),A=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||A){A=ga.transition,ga.transition=null;var B=mn;mn=1;var re=xn;xn|=4,l2.current=null,pB(c,p),uP(p,c),UG(yE),ul=!!pE,yE=pE=null,c.current=p,yB(p),Ye(),xn=re,mn=B,ga.transition=A}else c.current=p;if(by&&(by=!1,_c=c,Iy=S),A=c.pendingLanes,A===0&&(yc=null),nc(p.stateNode),_s(c,Xe()),d!==null)for(w=c.onRecoverableError,p=0;p<d.length;p++)S=d[p],w(S.value,{componentStack:S.stack,digest:S.digest});if(Ty)throw Ty=!1,c=h2,h2=null,c;return(Iy&1)!==0&&c.tag!==0&&sf(),A=c.pendingLanes,(A&1)!==0?c===d2?Lg++:(Lg=0,d2=c):Lg=0,fc(),null}function sf(){if(_c!==null){var c=po(Iy),d=ga.transition,p=mn;try{if(ga.transition=null,mn=16>c?16:c,_c===null)var w=!1;else{if(c=_c,_c=null,Iy=0,(xn&6)!==0)throw Error(t(331));var S=xn;for(xn|=4,xt=c.current;xt!==null;){var A=xt,B=A.child;if((xt.flags&16)!==0){var re=A.deletions;if(re!==null){for(var ae=0;ae<re.length;ae++){var Ae=re[ae];for(xt=Ae;xt!==null;){var He=xt;switch(He.tag){case 0:case 11:case 15:Pg(8,He,A)}var qe=He.child;if(qe!==null)qe.return=He,xt=qe;else for(;xt!==null;){He=xt;var ze=He.sibling,yt=He.return;if(sP(He),He===Ae){xt=null;break}if(ze!==null){ze.return=yt,xt=ze;break}xt=yt}}}var wt=A.alternate;if(wt!==null){var Tt=wt.child;if(Tt!==null){wt.child=null;do{var Fr=Tt.sibling;Tt.sibling=null,Tt=Fr}while(Tt!==null)}}xt=A}}if((A.subtreeFlags&2064)!==0&&B!==null)B.return=A,xt=B;else e:for(;xt!==null;){if(A=xt,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:Pg(9,A,A.return)}var fe=A.sibling;if(fe!==null){fe.return=A.return,xt=fe;break e}xt=A.return}}var oe=c.current;for(xt=oe;xt!==null;){B=xt;var ve=B.child;if((B.subtreeFlags&2064)!==0&&ve!==null)ve.return=B,xt=ve;else e:for(B=oe;xt!==null;){if(re=xt,(re.flags&2048)!==0)try{switch(re.tag){case 0:case 11:case 15:wy(9,re)}}catch(It){Ar(re,re.return,It)}if(re===B){xt=null;break e}var Je=re.sibling;if(Je!==null){Je.return=re.return,xt=Je;break e}xt=re.return}}if(xn=S,fc(),Or&&typeof Or.onPostCommitFiberRoot=="function")try{Or.onPostCommitFiberRoot(Ds,c)}catch{}w=!0}return w}finally{mn=p,ga.transition=d}}return!1}function wP(c,d,p){d=ef(p,d),d=Vk(c,d,1),c=mc(c,d,1),d=is(),c!==null&&(Du(c,1,d),_s(c,d))}function Ar(c,d,p){if(c.tag===3)wP(c,c,p);else for(;d!==null;){if(d.tag===3){wP(d,c,p);break}else if(d.tag===1){var w=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(yc===null||!yc.has(w))){c=ef(p,c),c=Gk(d,c,1),d=mc(d,c,1),c=is(),d!==null&&(Du(d,1,c),_s(d,c));break}}d=d.return}}function SB(c,d,p){var w=c.pingCache;w!==null&&w.delete(d),d=is(),c.pingedLanes|=c.suspendedLanes&p,li===c&&(Ti&p)===p&&(Qr===4||Qr===3&&(Ti&130023424)===Ti&&500>Xe()-u2?qu(c,0):c2|=p),_s(c,d)}function EP(c,d){d===0&&((c.mode&1)===0?d=1:(d=rc,rc<<=1,(rc&130023424)===0&&(rc=4194304)));var p=is();c=yl(c,d),c!==null&&(Du(c,d,p),_s(c,p))}function TB(c){var d=c.memoizedState,p=0;d!==null&&(p=d.retryLane),EP(c,p)}function bB(c,d){var p=0;switch(c.tag){case 13:var w=c.stateNode,S=c.memoizedState;S!==null&&(p=S.retryLane);break;case 19:w=c.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(d),EP(c,p)}var SP;SP=function(c,d,p){if(c!==null)if(c.memoizedProps!==d.pendingProps||gs.current)ps=!0;else{if((c.lanes&p)===0&&(d.flags&128)===0)return ps=!1,dB(c,d,p);ps=(c.flags&131072)!==0}else ps=!1,mr&&(d.flags&1048576)!==0&&nk(d,iy,d.index);switch(d.lanes=0,d.tag){case 2:var w=d.type;xy(c,d),c=d.pendingProps;var S=Hd(d,Vi.current);Qd(d,p),S=BE(null,d,w,c,S,p);var A=UE();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,ms(w)?(A=!0,ty(d)):A=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,LE(d),S.updater=yy,d.stateNode=S,S._reactInternals=d,YE(d,w,c,p),d=QE(null,d,w,!0,A,p)):(d.tag=0,mr&&A&&TE(d),rs(null,d,S,p),d=d.child),d;case 16:w=d.elementType;e:{switch(xy(c,d),c=d.pendingProps,S=w._init,w=S(w._payload),d.type=w,S=d.tag=AB(w),c=ja(w,c),S){case 0:d=ZE(null,d,w,c,p);break e;case 1:d=Xk(null,d,w,c,p);break e;case 11:d=$k(null,d,w,c,p);break e;case 14:d=Wk(null,d,w,ja(w.type,c),p);break e}throw Error(t(306,w,""))}return d;case 0:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:ja(w,S),ZE(c,d,w,S,p);case 1:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:ja(w,S),Xk(c,d,w,S,p);case 3:e:{if(qk(d),c===null)throw Error(t(387));w=d.pendingProps,A=d.memoizedState,S=A.element,hk(c,d),uy(d,w,null,p);var B=d.memoizedState;if(w=B.element,A.isDehydrated)if(A={element:w,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},d.updateQueue.baseState=A,d.memoizedState=A,d.flags&256){S=ef(Error(t(423)),d),d=Zk(c,d,w,p,S);break e}else if(w!==S){S=ef(Error(t(424)),d),d=Zk(c,d,w,p,S);break e}else for(Us=uc(d.stateNode.containerInfo.firstChild),Bs=d,mr=!0,Fa=null,p=ck(d,null,w,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Xd(),w===S){d=xl(c,d,p);break e}rs(c,d,w,p)}d=d.child}return d;case 5:return gk(d),c===null&&AE(d),w=d.type,S=d.pendingProps,A=c!==null?c.memoizedProps:null,B=S.children,_E(w,S)?B=null:A!==null&&_E(w,A)&&(d.flags|=32),Yk(c,d),rs(c,d,B,p),d.child;case 6:return c===null&&AE(d),null;case 13:return Qk(c,d,p);case 4:return OE(d,d.stateNode.containerInfo),w=d.pendingProps,c===null?d.child=qd(d,null,w,p):rs(c,d,w,p),d.child;case 11:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:ja(w,S),$k(c,d,w,S,p);case 7:return rs(c,d,d.pendingProps,p),d.child;case 8:return rs(c,d,d.pendingProps.children,p),d.child;case 12:return rs(c,d,d.pendingProps.children,p),d.child;case 10:e:{if(w=d.type._context,S=d.pendingProps,A=d.memoizedProps,B=S.value,nr(oy,w._currentValue),w._currentValue=B,A!==null)if(Da(A.value,B)){if(A.children===S.children&&!gs.current){d=xl(c,d,p);break e}}else for(A=d.child,A!==null&&(A.return=d);A!==null;){var re=A.dependencies;if(re!==null){B=A.child;for(var ae=re.firstContext;ae!==null;){if(ae.context===w){if(A.tag===1){ae=_l(-1,p&-p),ae.tag=2;var Ae=A.updateQueue;if(Ae!==null){Ae=Ae.shared;var He=Ae.pending;He===null?ae.next=ae:(ae.next=He.next,He.next=ae),Ae.pending=ae}}A.lanes|=p,ae=A.alternate,ae!==null&&(ae.lanes|=p),ME(A.return,p,d),re.lanes|=p;break}ae=ae.next}}else if(A.tag===10)B=A.type===d.type?null:A.child;else if(A.tag===18){if(B=A.return,B===null)throw Error(t(341));B.lanes|=p,re=B.alternate,re!==null&&(re.lanes|=p),ME(B,p,d),B=A.sibling}else B=A.child;if(B!==null)B.return=A;else for(B=A;B!==null;){if(B===d){B=null;break}if(A=B.sibling,A!==null){A.return=B.return,B=A;break}B=B.return}A=B}rs(c,d,S.children,p),d=d.child}return d;case 9:return S=d.type,w=d.pendingProps.children,Qd(d,p),S=da(S),w=w(S),d.flags|=1,rs(c,d,w,p),d.child;case 14:return w=d.type,S=ja(w,d.pendingProps),S=ja(w.type,S),Wk(c,d,w,S,p);case 15:return Hk(c,d,d.type,d.pendingProps,p);case 17:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:ja(w,S),xy(c,d),d.tag=1,ms(w)?(c=!0,ty(d)):c=!1,Qd(d,p),Fk(d,w,S),YE(d,w,S,p),QE(null,d,w,!0,c,p);case 19:return eP(c,d,p);case 22:return Kk(c,d,p)}throw Error(t(156,d.tag))};function TP(c,d){return Ke(c,d)}function IB(c,d,p,w){this.tag=c,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ma(c,d,p,w){return new IB(c,d,p,w)}function _2(c){return c=c.prototype,!(!c||!c.isReactComponent)}function AB(c){if(typeof c=="function")return _2(c)?1:0;if(c!=null){if(c=c.$$typeof,c===z)return 11;if(c===Pe)return 14}return 2}function wc(c,d){var p=c.alternate;return p===null?(p=ma(c.tag,d,c.key,c.mode),p.elementType=c.elementType,p.type=c.type,p.stateNode=c.stateNode,p.alternate=c,c.alternate=p):(p.pendingProps=d,p.type=c.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=c.flags&14680064,p.childLanes=c.childLanes,p.lanes=c.lanes,p.child=c.child,p.memoizedProps=c.memoizedProps,p.memoizedState=c.memoizedState,p.updateQueue=c.updateQueue,d=c.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=c.sibling,p.index=c.index,p.ref=c.ref,p}function ky(c,d,p,w,S,A){var B=2;if(w=c,typeof c=="function")_2(c)&&(B=1);else if(typeof c=="string")B=5;else e:switch(c){case R:return Qu(p.children,S,A,d);case C:B=8,S|=8;break;case P:return c=ma(12,p,d,S|2),c.elementType=P,c.lanes=A,c;case j:return c=ma(13,p,d,S),c.elementType=j,c.lanes=A,c;case be:return c=ma(19,p,d,S),c.elementType=be,c.lanes=A,c;case Ne:return Py(p,S,A,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case N:B=10;break e;case O:B=9;break e;case z:B=11;break e;case Pe:B=14;break e;case je:B=16,w=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=ma(B,p,d,S),d.elementType=c,d.type=w,d.lanes=A,d}function Qu(c,d,p,w){return c=ma(7,c,w,d),c.lanes=p,c}function Py(c,d,p,w){return c=ma(22,c,w,d),c.elementType=Ne,c.lanes=p,c.stateNode={isHidden:!1},c}function x2(c,d,p){return c=ma(6,c,null,d),c.lanes=p,c}function v2(c,d,p){return d=ma(4,c.children!==null?c.children:[],c.key,d),d.lanes=p,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function RB(c,d,p,w,S){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ng(0),this.expirationTimes=ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ng(0),this.identifierPrefix=w,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function w2(c,d,p,w,S,A,B,re,ae){return c=new RB(c,d,p,re,ae),d===1?(d=1,A===!0&&(d|=8)):d=0,A=ma(3,null,null,d),c.current=A,A.stateNode=c,A.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},LE(A),c}function CB(c,d,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:w==null?null:""+w,children:c,containerInfo:d,implementation:p}}function bP(c){if(!c)return dc;c=c._reactInternals;e:{if(te(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(ms(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var p=c.type;if(ms(p))return JC(c,p,d)}return d}function IP(c,d,p,w,S,A,B,re,ae){return c=w2(p,w,!0,c,S,A,B,re,ae),c.context=bP(null),p=c.current,w=is(),S=xc(p),A=_l(w,S),A.callback=d??null,mc(p,A,S),c.current.lanes=S,Du(c,S,w),_s(c,w),c}function My(c,d,p,w){var S=d.current,A=is(),B=xc(S);return p=bP(p),d.context===null?d.context=p:d.pendingContext=p,d=_l(A,B),d.payload={element:c},w=w===void 0?null:w,w!==null&&(d.callback=w),c=mc(S,d,B),c!==null&&(Ba(c,S,B,A),cy(c,S,B)),B}function Ny(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function AP(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var p=c.retryLane;c.retryLane=p!==0&&p<d?p:d}}function E2(c,d){AP(c,d),(c=c.alternate)&&AP(c,d)}function kB(){return null}var RP=typeof reportError=="function"?reportError:function(c){console.error(c)};function S2(c){this._internalRoot=c}Ly.prototype.render=S2.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));My(c,d,null,null)},Ly.prototype.unmount=S2.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;Xu(function(){My(null,c,null,null)}),d[fl]=null}};function Ly(c){this._internalRoot=c}Ly.prototype.unstable_scheduleHydration=function(c){if(c){var d=ag();c={blockedOn:null,target:c,priority:d};for(var p=0;p<Fs.length&&d!==0&&d<Fs[p].priority;p++);Fs.splice(p,0,c),p===0&&kd(c)}};function T2(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Oy(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function CP(){}function PB(c,d,p,w,S){if(S){if(typeof w=="function"){var A=w;w=function(){var Ae=Ny(B);A.call(Ae)}}var B=IP(d,w,c,0,null,!1,!1,"",CP);return c._reactRootContainer=B,c[fl]=B.current,_g(c.nodeType===8?c.parentNode:c),Xu(),B}for(;S=c.lastChild;)c.removeChild(S);if(typeof w=="function"){var re=w;w=function(){var Ae=Ny(ae);re.call(Ae)}}var ae=w2(c,0,!1,null,null,!1,!1,"",CP);return c._reactRootContainer=ae,c[fl]=ae.current,_g(c.nodeType===8?c.parentNode:c),Xu(function(){My(d,ae,p,w)}),ae}function Dy(c,d,p,w,S){var A=p._reactRootContainer;if(A){var B=A;if(typeof S=="function"){var re=S;S=function(){var ae=Ny(B);re.call(ae)}}My(d,B,c,S)}else B=PB(p,d,c,S,w);return Ny(B)}ig=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var p=An(d.pendingLanes);p!==0&&(rg(d,p|1),_s(d,Xe()),(xn&6)===0&&(rf=Xe()+500,fc()))}break;case 13:Xu(function(){var w=yl(c,1);if(w!==null){var S=is();Ba(w,c,1,S)}}),E2(c,1)}},Rd=function(c){if(c.tag===13){var d=yl(c,134217728);if(d!==null){var p=is();Ba(d,c,134217728,p)}E2(c,134217728)}},sg=function(c){if(c.tag===13){var d=xc(c),p=yl(c,d);if(p!==null){var w=is();Ba(p,c,d,w)}E2(c,d)}},ag=function(){return mn},og=function(c,d){var p=mn;try{return mn=c,d()}finally{mn=p}},q=function(c,d,p){switch(d){case"input":if(ot(c,p),d=p.name,p.type==="radio"&&d!=null){for(p=c;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var w=p[d];if(w!==c&&w.form===c.form){var S=J1(w);if(!S)throw Error(t(90));kt(w),ot(w,S)}}}break;case"textarea":Mn(c,p);break;case"select":d=p.value,d!=null&&Qn(c,!!p.multiple,d,!1)}},$e=m2,et=Xu;var MB={usingClientEntryPoint:!1,Events:[wg,$d,J1,Ve,Ie,m2]},Og={findFiberByHostInstance:Bu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NB={bundleType:Og.bundleType,version:Og.version,rendererPackageName:Og.rendererPackageName,rendererConfig:Og.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=we(c),c===null?null:c.stateNode},findFiberByHostInstance:Og.findFiberByHostInstance||kB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fy.isDisabled&&Fy.supportsFiber)try{Ds=Fy.inject(NB),Or=Fy}catch{}}return xs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MB,xs.createPortal=function(c,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T2(d))throw Error(t(200));return CB(c,d,null,p)},xs.createRoot=function(c,d){if(!T2(c))throw Error(t(299));var p=!1,w="",S=RP;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=w2(c,1,!1,null,null,p,!1,w,S),c[fl]=d.current,_g(c.nodeType===8?c.parentNode:c),new S2(d)},xs.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=we(d),c=c===null?null:c.stateNode,c},xs.flushSync=function(c){return Xu(c)},xs.hydrate=function(c,d,p){if(!Oy(d))throw Error(t(200));return Dy(null,c,d,!0,p)},xs.hydrateRoot=function(c,d,p){if(!T2(c))throw Error(t(405));var w=p!=null&&p.hydratedSources||null,S=!1,A="",B=RP;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(A=p.identifierPrefix),p.onRecoverableError!==void 0&&(B=p.onRecoverableError)),d=IP(d,null,c,1,p??null,S,!1,A,B),c[fl]=d.current,_g(c),w)for(c=0;c<w.length;c++)p=w[c],S=p._getVersion,S=S(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,S]:d.mutableSourceEagerHydrationData.push(p,S);return new Ly(d)},xs.render=function(c,d,p){if(!Oy(d))throw Error(t(200));return Dy(null,c,d,!1,p)},xs.unmountComponentAtNode=function(c){if(!Oy(c))throw Error(t(40));return c._reactRootContainer?(Xu(function(){Dy(null,null,c,!1,function(){c._reactRootContainer=null,c[fl]=null})}),!0):!1},xs.unstable_batchedUpdates=m2,xs.unstable_renderSubtreeIntoContainer=function(c,d,p,w){if(!Oy(p))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Dy(c,d,p,!1,w)},xs.version="18.3.1-next-f1338f8080-20240426",xs}var FP;function BB(){if(FP)return A2.exports;FP=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),A2.exports=GB(),A2.exports}var jP;function UB(){if(jP)return jy;jP=1;var n=BB();return jy.createRoot=n.createRoot,jy.hydrateRoot=n.hydrateRoot,jy}var zB=UB();const $B=Jb(zB);var ee=Gp();const WB=Jb(ee),Es={ADD:"add",REMOVE:"remove"},u0={PROPERTYCHANGE:"propertychange"},Yt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Lv{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function HB(n,e,t){let r,i;t=t||Pl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Pl(n,e){return n>e?1:n<e?-1:0}function KB(n,e){return n<e?1:n>e?-1:0}function Ov(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function YB(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Ln(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function Tu(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function XB(n,e,t){const r=e||Pl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function Km(){return!0}function Dv(){return!1}function Ym(){}function YO(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!Tu(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function XO(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Bp(n){for(const e in n)delete n[e]}function Fh(n){let e;for(e in n)return!1;return!e}class rl{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let Up=class extends Lv{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new rl(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let u=0,h=i.length;u<h;++u)if("handleEvent"in i[u]?l=i[u].handleEvent(s):l=i[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let u=o[r];for(delete o[r];u--;)this.removeEventListener(r,Ym);delete a[r]}return l}disposeInternal(){this.listeners_&&Bp(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=Ym,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function _n(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function J_(n,e,t,r){return _n(n,e,t,r,!0)}function rr(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Bp(n))}class zp extends Up{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Yt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=_n(this,e[s],t);return i}return _n(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=J_(this,e[s],t)}else r=J_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)qB(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}zp.prototype.on;zp.prototype.once;zp.prototype.un;function qB(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)rr(n[e]);else rr(n)}function Ut(){throw new Error("Unimplemented abstract method.")}let ZB=0;function In(n){return n.ol_uid||(n.ol_uid=String(++ZB))}class VP extends rl{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class il extends zp{constructor(e){super(),this.on,this.once,this.un,In(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new VP(r,e,t)),r=u0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new VP(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],Fh(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const GP={LENGTH:"length"};class Vy extends rl{constructor(e,t,r){super(e),this.element=t,this.index=r}}class Sa extends il{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(GP.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Vy(Es.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Vy(Es.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Vy(Es.REMOVE,i,e)),this.dispatchEvent(new Vy(Es.ADD,t,e))}updateLength_(){this.set(GP.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function Fn(n,e){if(!n)throw new Error(e)}let mi=class qO extends il{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new qO(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(rr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=_n(e,Yt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?QB(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function QB(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Fn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ui={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function BP(n){const e=ta();for(let t=0,r=n.length;t<r;++t)pm(e,n[t]);return e}function Xm(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function ZO(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function ld(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function jh(n,e){return eI(n,e[0],e[1])}function zc(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function eI(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function rT(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=ui.UNKNOWN;return a<t?l=l|ui.LEFT:a>i&&(l=l|ui.RIGHT),o<r?l=l|ui.BELOW:o>s&&(l=l|ui.ABOVE),l===ui.UNKNOWN&&(l=ui.INTERSECTING),l}function ta(){return[1/0,1/0,-1/0,-1/0]}function cu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function $p(n){return cu(1/0,1/0,-1/0,-1/0,n)}function QO(n,e){const t=n[0],r=n[1];return cu(t,r,t,r,e)}function tI(n,e,t,r,i){const s=$p(i);return e5(s,n,e,t,r)}function h0(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function JO(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function pm(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function e5(n,e,t,r,i){for(;t<r;t+=i)JB(n,e[t],e[t+1]);return n}function JB(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function t5(n,e){let t;return t=e(Fv(n)),t||(t=e(jv(n)),t)||(t=e(Vv(n)),t)||(t=e(cd(n)),t)?t:!1}function iT(n){let e=0;return j0(n)||(e=un(n)*Hr(n)),e}function Fv(n){return[n[0],n[1]]}function jv(n){return[n[2],n[1]]}function Xo(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function eU(n,e){let t;if(e==="bottom-left")t=Fv(n);else if(e==="bottom-right")t=jv(n);else if(e==="top-left")t=cd(n);else if(e==="top-right")t=Vv(n);else throw new Error("Invalid corner");return t}function ex(n,e,t,r,i){const[s,a,o,l,u,h,f,g]=n5(n,e,t,r);return cu(Math.min(s,o,u,f),Math.min(a,l,h,g),Math.max(s,o,u,f),Math.max(a,l,h,g),i)}function n5(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,u=i*o,h=s*a,f=s*o,g=n[0],y=n[1];return[g-l+f,y-u-h,g-l-f,y-u+h,g+l-f,y+u+h,g+l+f,y+u-h,g-l+f,y-u-h]}function Hr(n){return n[3]-n[1]}function Ml(n,e,t){const r=t||ta();return cs(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):$p(r),r}function cd(n){return[n[0],n[3]]}function Vv(n){return[n[2],n[3]]}function un(n){return n[2]-n[0]}function cs(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function j0(n){return n[2]<n[0]||n[3]<n[1]}function tU(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function nU(n,e,t){let r=!1;const i=rT(n,e),s=rT(n,t);if(i===ui.INTERSECTING||s===ui.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],u=n[3],h=e[0],f=e[1],g=t[0],y=t[1],v=(y-f)/(g-h);let x,E;s&ui.ABOVE&&!(i&ui.ABOVE)&&(x=g-(y-u)/v,r=x>=a&&x<=l),!r&&s&ui.RIGHT&&!(i&ui.RIGHT)&&(E=y-(g-l)*v,r=E>=o&&E<=u),!r&&s&ui.BELOW&&!(i&ui.BELOW)&&(x=g-(y-o)/v,r=x>=a&&x<=l),!r&&s&ui.LEFT&&!(i&ui.LEFT)&&(E=y-(g-a)*v,r=E>=o&&E<=u)}return r}function r5(n,e){const t=e.getExtent(),r=Xo(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=un(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function i5(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];r5(n,e);const i=un(r);if(un(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function lr(n,e,t){return Math.min(Math.max(n,e),t)}function rU(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return Rh(n,e,t,r)}function Rh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function iU(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let u=r;u<e+1;u++)r==u?n[o][u]=0:n[o][u]+=l*n[r][u]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function UP(n){return n*180/Math.PI}function Nl(n){return n*Math.PI/180}function eu(n,e){const t=n%e;return t*e<0?t+e:t}function Ks(n,e,t){return n+t*(e-n)}function Wp(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function tx(n,e){return Math.round(Wp(n,e))}function Gy(n,e){return Math.floor(Wp(n,e))}function $c(n,e){return Math.ceil(Wp(n,e))}function sT(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function Fg(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function s5(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function sU(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function nx(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function nI(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function aU(n,e){return n[0]*=e,n[1]*=e,n}function a5(n,e){if(e.canWrapX()){const t=un(e.getExtent()),r=o5(n,e,t);r&&(n[0]-=r*t)}return n}function o5(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||un(r),i=Math.floor((n[0]-r[0])/t)),i}function l5(...n){console.warn(...n)}const d0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Gv=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||d0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const Hp=6378137,Of=Math.PI*Hp,oU=[-Of,-Of,Of,Of],lU=[-180,-85,180,85],By=Hp*Math.log(Math.tan(Math.PI/2));class af extends Gv{constructor(e){super({code:e,units:"m",extent:oU,global:!0,worldExtent:lU,getPointResolution:function(t,r){return t/Math.cosh(r[1]/Hp)}})}}const zP=[new af("EPSG:3857"),new af("EPSG:102100"),new af("EPSG:102113"),new af("EPSG:900913"),new af("http://www.opengis.net/def/crs/EPSG/0/3857"),new af("http://www.opengis.net/gml/srs/epsg.xml#3857")];function cU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=Of*n[s]/180;let a=Hp*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>By?a=By:a<-By&&(a=-By),e[s+1]=a}return e}function uU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/Of,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Hp))/Math.PI-90;return e}const hU=6378137,$P=[-180,-90,180,90],dU=Math.PI*hU/180;class Ju extends Gv{constructor(e,t){super({code:e,units:"degrees",extent:$P,axisOrientation:t,global:!0,metersPerUnit:dU,worldExtent:$P})}}const WP=[new Ju("CRS:84"),new Ju("EPSG:4326","neu"),new Ju("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ju("urn:ogc:def:crs:OGC:2:84"),new Ju("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ju("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ju("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let aT={};function b_(n){return aT[n]||aT[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function fU(n,e){aT[n]=e}let Hf={};function Vh(n,e,t){const r=n.getCode(),i=e.getCode();r in Hf||(Hf[r]={}),Hf[r][i]=t}function I_(n,e){return n in Hf&&e in Hf[n]?Hf[n][e]:null}const rx=.9996,Aa=.00669438,Bv=Aa*Aa,Uv=Bv*Aa,xh=Aa/(1-Aa),HP=Math.sqrt(1-Aa),f0=(1-HP)/(1+HP),c5=f0*f0,rI=c5*f0,iI=rI*f0,u5=iI*f0,h5=1-Aa/4-3*Bv/64-5*Uv/256,gU=3*Aa/8+3*Bv/32+45*Uv/1024,mU=15*Bv/256+45*Uv/1024,pU=35*Uv/3072,yU=3/2*f0-27/32*rI+269/512*u5,_U=21/16*c5-55/32*iI,xU=151/96*rI-417/128*u5,vU=1097/512*iI,ix=6378137;function wU(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/rx/(ix*h5),o=a+yU*Math.sin(2*a)+_U*Math.sin(4*a)+xU*Math.sin(6*a)+vU*Math.sin(8*a),l=Math.sin(o),u=l*l,h=Math.cos(o),f=l/h,g=f*f,y=g*g,v=1-Aa*u,x=Math.sqrt(1-Aa*u),E=ix/x,T=(1-Aa)/v,b=xh*h**2,I=b*b,M=r/(E*rx),F=M*M,G=F*M,R=G*M,C=R*M,P=C*M,N=o-f/T*(F/2-R/24*(5+3*g+10*b-4*I-9*xh))+P/720*(61+90*g+298*b+45*y-252*xh-3*I);let O=(M-G/6*(1+2*g+b)+C/120*(5-2*b+28*g-3*I+8*xh+24*y))/h;return O=sT(O+Nl(d5(t.number)),-Math.PI,Math.PI),[UP(O),UP(N)]}const KP=-80,YP=84,EU=-180,SU=180;function TU(n,e,t){n=sT(n,EU,SU),e<KP?e=KP:e>YP&&(e=YP);const r=Nl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,u=Nl(n),h=d5(t.number),f=Nl(h),g=ix/Math.sqrt(1-Aa*i**2),y=xh*s**2,v=s*sT(u-f,-Math.PI,Math.PI),x=v*v,E=x*v,T=E*v,b=T*v,I=b*v,M=ix*(h5*r-gU*Math.sin(2*r)+mU*Math.sin(4*r)-pU*Math.sin(6*r)),F=rx*g*(v+E/6*(1-o+y)+b/120*(5-18*o+l+72*y-58*xh))+5e5;let G=rx*(M+g*a*(x/2+T/24*(5-o+9*y+4*y**2)+I/720*(61-58*o+l+600*y-330*xh)));return t.north||(G+=1e7),[F,G]}function d5(n){return(n-1)*6-180+3}const bU=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function f5(n){let e=0;for(const i of bU){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function XP(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],u=t[o+1],h=n(l,u,e);r[o]=h[0],r[o+1]=h[1]}return r}}function IU(n){return f5(n)?new Gv({code:n,units:"m"}):null}function AU(n){const e=f5(n.getCode());return e?{forward:XP(TU,e),inverse:XP(wU,e)}:null}const RU=63710088e-1;function qP(n,e,t){t=t||RU;const r=Nl(n[1]),i=Nl(e[1]),s=(i-r)/2,a=Nl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const CU=[AU],kU=[IU];let oT=!0;function g5(n){oT=!1}function sI(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function sx(n){fU(n.getCode(),n),Vh(n,n,sI)}function PU(n){n.forEach(sx)}function qn(n){if(typeof n!="string")return n;const e=b_(n);if(e)return e;for(const t of kU){const r=t(n);if(r)return r}return null}function ax(n,e,t,r){n=qn(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/d0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=oI(n,qn("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=o(u,u,2);const h=qP(u.slice(0,2),u.slice(2,4)),f=qP(u.slice(4,6),u.slice(6,8));i=(h+f)/2}const l=r?d0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function lT(n){PU(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Vh(e,t,sI)})})}function MU(n,e,t,r){n.forEach(function(i){e.forEach(function(s){Vh(i,s,t),Vh(s,i,r)})})}function aI(n,e){return n?typeof n=="string"?qn(n):n:qn(e)}function cT(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let u=0,h=i;u<h;++u)t[a+u]=u>=l?e[a+u]:o[u]}return t})}function NU(n,e,t,r){const i=qn(n),s=qn(e);Vh(i,s,cT(t)),Vh(s,i,cT(r))}function ka(n,e){return g5(),Kp(n,"EPSG:4326","EPSG:3857")}function vn(n,e){const t=Kp(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=eu(r+180,360)-180),t}function Ch(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||oI(n,e)===sI)&&t}function oI(n,e){const t=n.getCode(),r=e.getCode();let i=I_(t,r);if(i)return i;let s=null,a=null;for(const l of CU)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=k2(s.inverse,a.forward);else{const l=I_(t,o);l&&(i=k2(l,a.forward))}else{const l=I_(o,r);l&&(i=k2(s.inverse,l))}return i&&(sx(n),sx(e),Vh(n,e,i)),i}function k2(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function qm(n,e){const t=qn(n),r=qn(e);return oI(t,r)}function Kp(n,e,t){const r=qm(e,t);if(!r){const i=qn(e).getCode(),s=qn(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function uT(n,e){return n}function Sl(n,e){return oT&&!nx(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(oT=!1,l5("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function m5(n,e){return n}function Do(n,e){return n}function ZP(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=un(a);r=r.slice(0),s=o5(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=lr(r[0],a[0],a[2]),r[1]=lr(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*un(e.getExtent())),i}}function LU(){lT(zP),lT(WP),MU(WP,zP,cU,uU)}LU();new Array(6);function no(){return[1,0,0,1,0,0]}function OU(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function ni(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function qo(n,e,t,r,i,s,a,o){const l=Math.sin(s),u=Math.cos(s);return n[0]=r*u,n[1]=i*l,n[2]=-r*l,n[3]=i*u,n[4]=a*r*u-o*r*l+e,n[5]=a*i*l+o*i*u+t,n}function p5(n,e){const t=DU(e);Fn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function DU(n){return n[0]*n[3]-n[1]*n[2]}const FU=[1e5,1e5,1e5,1e5,2,2];function jU(n){return"matrix("+n.join(", ")+")"}function hT(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function VU(n,e){const t=hT(n),r=hT(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*FU[i])!==0)return!1;return!0}function tu(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const u=n[l],h=n[l+1];s[o++]=i[0]*u+i[2]*h+i[4],s[o++]=i[1]*u+i[3]*h+i[5];for(let f=2;f<a;f++)s[o++]=n[l+f]}return s&&s.length!=o&&(s.length=o),s}function y5(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),u=s[0],h=s[1];let f=0;for(let g=e;g<t;g+=r){const y=n[g]-u,v=n[g+1]-h;a[f++]=u+y*o-v*l,a[f++]=h+y*l+v*o;for(let x=g+2;x<g+r;++x)a[f++]=n[x]}return a&&a.length!=f&&(a.length=f),a}function GU(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],u=a[1];let h=0;for(let f=e;f<t;f+=r){const g=n[f]-l,y=n[f+1]-u;o[h++]=l+i*g,o[h++]=u+s*y;for(let v=f+2;v<f+r;++v)o[h++]=n[v]}return o&&o.length!=h&&(o.length=h),o}function BU(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let u=l+2;u<l+r;++u)a[o++]=n[u]}return a&&a.length!=o&&(a.length=o),a}const QP=no(),UU=[NaN,NaN];class _5 extends il{constructor(){super(),this.extent_=ta(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=YO((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Ut()}closestPointXY(e,t,r,i){return Ut()}containsXY(e,t){return this.closestPointXY(e,t,UU,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Ut()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&$p(t),this.extentRevision_=this.getRevision()}return tU(this.extent_,e)}rotate(e,t){Ut()}scale(e,t,r){Ut()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Ut()}getType(){return Ut()}applyTransform(e){Ut()}intersectsExtent(e){return Ut()}translate(e,t){Ut()}transform(e,t){const r=qn(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),u=r.getWorldExtent(),h=Hr(u)/Hr(l);qo(QP,u[0],u[3],h,-h,0,0,0);const f=tu(s,0,s.length,o,QP,a),g=qm(r,t);return g?g(f,f,o):f}:qm(r,t);return this.applyTransform(i),this}}class ud extends _5{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return tI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Ut()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=JP(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Ut()}setLayout(e,t,r){let i;if(e)i=JP(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=hd(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();y5(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=Xo(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();GU(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();BU(r,0,r.length,i,e,t,r),this.changed()}}}function hd(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function JP(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function zU(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return tu(r,0,r.length,i,e,t)}function e4(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],u=n[t]-o,h=n[t+1]-l;let f;if(u===0&&h===0)f=e;else{const g=((i-o)*u+(s-l)*h)/(u*u+h*h);if(g>1)f=t;else if(g>0){for(let y=0;y<r;++y)a[y]=Ks(n[e+y],n[t+y],g);a.length=r;return}else f=e}for(let g=0;g<r;++g)a[g]=n[f+g];a.length=r}function lI(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],u=Rh(s,a,o,l);u>i&&(i=u),s=o,a=l}return i}function cI(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=lI(n,e,o,r,i),e=o}return i}function $U(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=cI(n,e,o,r,i),e=o[o.length-1]}return i}function uI(n,e,t,r,i,s,a,o,l,u,h){if(e==t)return u;let f,g;if(i===0){if(g=Rh(a,o,n[e],n[e+1]),g<u){for(f=0;f<r;++f)l[f]=n[e+f];return l.length=r,g}return u}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(e4(n,y-r,y,r,a,o,h),g=Rh(a,o,h[0],h[1]),g<u){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(g)-Math.sqrt(u))/i|0,1);if(s&&(e4(n,t-r,e,r,a,o,h),g=Rh(a,o,h[0],h[1]),g<u)){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r}return u}function hI(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const y=t[f];u=uI(n,e,y,r,i,s,a,o,l,u,h),e=y}return u}function WU(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const y=t[f];u=hI(n,e,y,r,i,s,a,o,l,u,h),e=y[y.length-1]}return u}function HU(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function zv(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function Yp(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=zv(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function x5(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Yp(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function Wc(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function Zm(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=Wc(n,e,l,r,i[s]),e=l}return i.length=s,i}function dT(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:Zm(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function ox(n,e,t,r,i,s,a){let o,l;const u=(t-e)/r;if(u===1)o=e;else if(u===2)o=e,l=i;else if(u!==0){let h=n[e],f=n[e+1],g=0;const y=[0];for(let E=e+r;E<t;E+=r){const T=n[E],b=n[E+1];g+=Math.sqrt((T-h)*(T-h)+(b-f)*(b-f)),y.push(g),h=T,f=b}const v=i*g,x=HB(y,v);x<0?(l=(v-y[-x-2])/(y[-x-1]-y[-x-2]),o=e+(-x-2)*r):o=e+x*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:Ks(n[o+h],n[o+r+h],l);return s}function fT(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const g=o+l>>1;i<n[(g+1)*r-1]?l=g:o=g+1}const u=n[o*r-1];if(i==u)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],f=(i-u)/(h-u);a=[];for(let g=0;g<r-1;++g)a.push(Ks(n[(o-1)*r+g],n[o*r+g],f));return a.push(i),a}function KU(n,e,t,r,i,s,a){if(a)return fT(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,u=t.length;l<u;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return fT(n,e,h,r,i,!1);e=h}}return null}function YU(n,e,t,r,i){return!t5(i,function(a){return!vh(n,e,t,r,a[0],a[1])})}function vh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const u=n[e],h=n[e+1];l<=s?h>s&&(u-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(u-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=u,l=h}return a!==0}function dI(n,e,t,r,i,s){if(t.length===0||!vh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(vh(n,t[a-1],t[a],r,i,s))return!1;return!0}function XU(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(dI(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function v5(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function $v(n,e,t,r,i,s){return s=s??e5(ta(),n,e,t,r),cs(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:v5(n,e,t,r,function(a,o){return nU(i,a,o)}):!1}function qU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if($v(n,e,t[s],r,i))return!0;e=t[s]}return!1}function w5(n,e,t,r,i){return!!($v(n,e,t,r,i)||vh(n,e,t,r,i[0],i[1])||vh(n,e,t,r,i[0],i[3])||vh(n,e,t,r,i[2],i[1])||vh(n,e,t,r,i[2],i[3]))}function E5(n,e,t,r,i){if(!w5(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(YU(n,t[s-1],t[s],r,i)&&!$v(n,t[s-1],t[s],r,i))return!1;return!0}function ZU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(E5(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function fI(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],u=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(u-s)*(u-s)),i=l,s=u}return a}function Wv(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const u=[e,t-r];let h=0;for(;u.length>0;){const f=u.pop(),g=u.pop();let y=0;const v=n[g],x=n[g+1],E=n[f],T=n[f+1];for(let b=g+r;b<f;b+=r){const I=n[b],M=n[b+1],F=rU(I,M,v,x,E,T);F>y&&(h=b,y=F)}y>i&&(l[(h-e)/r]=1,g+r<h&&u.push(g,h),h+r<f&&u.push(h,f))}for(let f=0;f<o;++f)l[f]&&(s[a++]=n[e+f*r],s[a++]=n[e+f*r+1]);return a}function S5(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=Wv(n,e,h,r,i,s,a),o.push(a),e=h}return a}function ih(n,e){return e*Math.round(n/e)}function QU(n,e,t,r,i,s,a){if(e==t)return a;let o=ih(n[e],i),l=ih(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let u,h;do if(u=ih(n[e],i),h=ih(n[e+1],i),e+=r,e==t)return s[a++]=u,s[a++]=h,a;while(u==o&&h==l);for(;e<t;){const f=ih(n[e],i),g=ih(n[e+1],i);if(e+=r,f==u&&g==h)continue;const y=u-o,v=h-l,x=f-o,E=g-l;if(y*E==v*x&&(y<0&&x<y||y==x||y>0&&x>y)&&(v<0&&E<v||v==E||v>0&&E>v)){u=f,h=g;continue}s[a++]=u,s[a++]=h,o=u,l=h,u=f,h=g}return s[a++]=u,s[a++]=h,a}function gI(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=QU(n,e,h,r,i,s,a),o.push(a),e=h}return a}function JU(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l],f=[];a=gI(n,e,h,r,i,s,a,f),o.push(f),e=h[h.length-1]}return a}class na extends ud{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Ln(this.flatCoordinates,e),this.changed()}clone(){const e=new na(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<ld(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(lI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),uI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return v5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,fT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return Wc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return ox(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return fI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Wv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new na(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return $v(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zv(this.flatCoordinates,0,e,this.stride),this.changed()}}let _i=class T5 extends ud{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new T5(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=Rh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return QO(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return eI(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=HU(this.flatCoordinates,0,e,this.stride),this.changed()}};const Ta={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Gh=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",ez=Gh.includes("safari")&&!Gh.includes("chrom");ez&&(Gh.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Gh));const tz=Gh.includes("webkit")&&!Gh.includes("edge"),b5=Gh.includes("macintosh"),nz=typeof devicePixelRatio<"u"?devicePixelRatio:1,Qs=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,mI=typeof Image<"u"&&Image.prototype.decode,I5=typeof createImageBitmap=="function",A5=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ri(n,e,t,r){let i;return t&&t.length?i=t.shift():Qs?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let P2;function lx(){return P2||(P2=ri(1,1)),P2}function Hv(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function t4(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function rz(n){for(;n.lastChild;)n.lastChild.remove()}function iz(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function R5(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function Hc(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const pI=[NaN,NaN,NaN,0];let M2;function sz(){return M2||(M2=ri(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),M2}const az=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,oz=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,lz=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,cz=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Uy(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ym(n){throw new Error('failed to parse "'+n+'" as color')}function C5(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(oz)||n.match(az)||n.match(lz);if(s){const a=s[4],o=100/255;return[lr(Uy(s[1],o)+.5|0,0,255),lr(Uy(s[2],o)+.5|0,0,255),lr(Uy(s[3],o)+.5|0,0,255),a!==void 0?lr(Uy(a,100),0,1):1]}ym(n)}if(n.startsWith("#")){if(cz.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,u=s.length;l<u;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}ym(n)}const e=sz();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ym(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return C5(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=Wp(i[3]/255,3),i}function uz(n){return typeof n=="string"?n:_I(n)}const hz=1024,jg={};let N2=0;function dz(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function L2(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function O2(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function D2(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function F2(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function n4(n){const e=D2(n[0]),t=D2(n[1]),r=D2(n[2]),i=F2(e*.222488403+t*.716873169+r*.06060791),s=500*(F2(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-F2(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function fz(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=O2(e),s=O2(e+t/500*Math.cos(r)),a=O2(e-t/200*Math.sin(r)),o=L2(s*3.021973625-i*1.617392459-a*.404875592),l=L2(s*-.943766287+i*1.916279586+a*.027607165),u=L2(s*.069407491-i*.22898585+a*1.159737864);return[lr(o+.5|0,0,255),lr(l+.5|0,0,255),lr(u+.5|0,0,255),n[3]]}function yI(n){if(n==="none")return pI;if(jg.hasOwnProperty(n))return jg[n];if(N2>=hz){let t=0;for(const r in jg)(t++&3)===0&&(delete jg[r],--N2)}const e=C5(n);e.length!==4&&ym(n);for(const t of e)isNaN(t)&&ym(n);return jg[n]=e,++N2,e}function Bh(n){return Array.isArray(n)?n:yI(n)}function _I(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class k5 extends Up{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?vt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Yt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==vt.IDLE&&this.loader){this.state=vt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;XO(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||I5&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=vt.LOADED}).catch(r=>{this.state=vt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function gz(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[J_(r,Yt.LOAD,function(){a=!0,s||e()})];return r.src&&mI?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(J_(r,Yt.ERROR,t)),function(){i=!1,o.forEach(rr)}}function mz(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function P5(n,e){return e&&(n.src=e),n.src&&mI?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):mz(n)}function M5(n,e){return e&&(n.src=e),n.src&&mI&&I5?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):P5(n)}class pz{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=j2(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=j2(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=j2(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===vt.IDLE&&i.load(),i.getImageState()===vt.LOADING?i.ready().then(()=>{this.patternCache_[a]=lx().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=lx().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function j2(n,e,t){const r=t?Bh(t):"null";return e+":"+n+":"+r}const ba=new pz;let Vg=null;class N5 extends Up{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?vt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===vt.LOADED){Vg||(Vg=ri(1,1,void 0,{willReadFrequently:!0})),Vg.drawImage(this.image_,0,0);try{Vg.getImageData(0,0,1,1),this.tainted_=!1}catch{Vg=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Yt.CHANGE)}handleImageError_(){this.imageState_=vt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=vt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=ri(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===vt.IDLE){this.image_||this.initializeImage_(),this.imageState_=vt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&P5(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==vt.LOADED)return;const t=this.image_,r=ri(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=uz(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===vt.LOADED||this.imageState_===vt.ERROR)e();else{const t=()=>{(this.imageState_===vt.LOADED||this.imageState_===vt.ERROR)&&(this.removeEventListener(Yt.CHANGE,t),e())};this.addEventListener(Yt.CHANGE,t)}})),this.ready_}}function cx(n,e,t,r,i,s){let a=e===void 0?void 0:ba.get(e,t,i);return a||(a=new N5(n,n&&"src"in n?n.src||void 0:e,t,r,i),ba.set(e,t,i,a,s)),s&&a&&!ba.getPattern(e,t,i)&&ba.set(e,t,i,a,s),a}function Fo(n){return n?Array.isArray(n)?_I(n):typeof n=="object"&&"src"in n?yz(n):n:null}function yz(n){if(!n.offset||!n.size)return ba.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=ba.getPattern(e,void 0,n.color);if(t)return t;const r=ba.get(n.src,"anonymous",null);if(r.getImageState()!==vt.LOADED)return null;const i=ri(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),cx(i.canvas,e,void 0,vt.LOADED,n.color,!0),ba.getPattern(e,void 0,n.color)}class L5{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const zy="ol-hidden",Xp="ol-unselectable",xI="ol-control",r4="ol-collapsed",_z=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),i4=["style","variant","weight","size","lineHeight","family"],gT={normal:400,bold:700},mT=function(n){const e=n.match(_z);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=i4.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[i4[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in gT&&(t.weight=gT[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},O5="10px sans-serif",Ss="#000",g0="round",Ll=[],Ol=0,m0="round",Qm=10,Jm="#000",ep="center",ux="middle",wh=[0,0,0,0],tp=1,Ef=new il;let Gg=null,s4;const pT={},xz=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function vz(n,e,t){return`${n} ${e} 16px "${t}"`}const wz=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=mT(s),l=o.families[0].toLowerCase(),u=o.weight;return a.some(h=>{const f=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),g=gT[h.weight]||h.weight;return f===l&&h.style===o.style&&g==u})}async function i(){await t.ready;let s=!0;const a=Ef.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const u=o[l];let h=a[u];h<100&&(await r(u)?(Bp(pT),Ef.set(u,100)):(h+=10,Ef.set(u,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=Qs?self.fonts:document.fonts);const a=mT(s);if(!a)return;const o=a.families;let l=!1;for(const u of o){if(xz.has(u))continue;const h=vz(a.style,a.weight,u);Ef.get(h)===void 0&&(Ef.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),Ez=(function(){let n;return function(e){let t=pT[e];if(t==null){if(Qs){const r=mT(e),i=D5(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);pT[e]=t}return t}})();function D5(n,e){return Gg||(Gg=ri(1,1)),n!=s4&&(Gg.font=n,s4=Gg.font),Gg.measureText(e)}function F5(n,e){return D5(n,e).width}function a4(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,F5(n,s)),0);return t[e]=r,r}function Sz(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const f=e[u];if(f===`
`||u===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const g=e[u+1]||n.font,y=F5(g,f);t.push(y),a+=y;const v=Ez(g);r.push(v),l=Math.max(l,v)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function Tz(n,e,t,r,i,s,a,o,l,u,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=f=>f.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,u),n.scale(h[0],h[1]),bz(r,n)):h[0]<0||h[1]<0?(n.translate(l,u),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,u,a*h[0],o*h[1]),n.restore()}function bz(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class Iz extends L5{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?Wp(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=no()}drawImages_(e,t,r,i){if(!this.image_)return;const s=tu(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let h=0,f=s.length;h<f;h+=2){const g=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=g+this.imageAnchorX_,x=y+this.imageAnchorY_;qo(o,v,x,1,1,u,-v,-x),a.save(),a.transform.apply(a,o),a.translate(v,x),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,g,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=tu(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,u=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,u-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,u),this.textFillState_&&a.fillText(this.text_,l,u))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=tu(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let u=2;u<l;u+=2)a.lineTo(o[u],o[u+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!cs(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=zU(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!cs(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(cs(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,u=a.length;l<u;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!cs(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!cs(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const u=s[o];i=this.drawRings_(r,i,u,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),Tu(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:ep;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Fo(r||Ss)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),u=t.getMiterLimit(),h=s||Ll;this.strokeState_={lineCap:i!==void 0?i:g0,lineDash:this.pixelRatio_===1?h:h.map(f=>f*this.pixelRatio_),lineDashOffset:(a||Ol)*this.pixelRatio_,lineJoin:o!==void 0?o:m0,lineWidth:(l!==void 0?l:tp)*this.pixelRatio_,miterLimit:u!==void 0?u:Qm,strokeStyle:Fo(r||Jm)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Fo(y||Ss)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),v=r.getLineCap(),x=r.getLineDash(),E=r.getLineDashOffset(),T=r.getLineJoin(),b=r.getWidth(),I=r.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:g0,lineDash:x||Ll,lineDashOffset:E||Ol,lineJoin:T!==void 0?T:m0,lineWidth:b!==void 0?b:tp,miterLimit:I!==void 0?I:Qm,strokeStyle:Fo(y||Jm)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),h=e.getText(),f=e.getTextAlign(),g=e.getTextBaseline();this.textState_={font:i!==void 0?i:O5,textAlign:f!==void 0?f:ep,textBaseline:g!==void 0?g:ux},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,v,x)=>y+=x%2?" ":v,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const Az=.5,j5={Point:Oz,LineString:Mz,Polygon:Fz,MultiPoint:Dz,MultiLineString:Nz,MultiPolygon:Lz,GeometryCollection:Pz,Circle:Cz};function Rz(n,e){return parseInt(In(n),10)-parseInt(In(e),10)}function o4(n,e){const t=V5(n,e);return t*t}function V5(n,e){return Az*n/e}function Cz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function l4(n,e,t,r,i,s,a,o){const l=[],u=t.getImage();if(u){let g=!0;const y=u.getImageState();y==vt.LOADED||y==vt.ERROR?g=!1:y==vt.IDLE&&u.load(),g&&l.push(u.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const f=l.length>0;return f&&Promise.all(l).then(()=>i(null)),kz(n,e,t,r,s,a,o),f}function kz(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())G5(n,l,t,e,a);else{const h=j5[l.getType()];h(n,l,t,e,a,s)}}function G5(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)G5(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function Pz(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const u=j5[a[o].getType()];u(n,a[o],t,r,i,s)}}function Mz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function Nz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function Lz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function Oz(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),u=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=vt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,u),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,u),h.drawText(e,r,i)}}function Dz(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(a.getImageState()!=vt.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(a,h),f.drawMultiPoint(e,r,i)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,r,i)}}function Fz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let jz=!1;function Vz(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=jz,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const u=e.getType();try{let h;u=="text"||u=="json"?h=o.responseText:u=="xml"?h=o.responseXML||o.responseText:u=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function c4(n,e){return function(t,r,i,s,a){Vz(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function Gz(n,e){return[[-1/0,-1/0,1/0,1/0]]}function B5(n,e,t,r){const i=[];let s=ta();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=tI(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function vI(n,e,t,r,i,s,a){let o,l,u,h,f,g,y;const v=i[s+1],x=[];for(let b=0,I=t.length;b<I;++b){const M=t[b];for(h=n[M-r],g=n[M-r+1],o=e;o<M;o+=r)f=n[o],y=n[o+1],(v<=g&&y<=v||g<=v&&v<=y)&&(u=(v-g)/(y-g)*(f-h)+h,x.push(u)),h=f,g=y}let E=NaN,T=-1/0;for(x.sort(Pl),h=x[0],o=1,l=x.length;o<l;++o){f=x[o];const b=Math.abs(f-h);b>T&&(u=(h+f)/2,dI(n,e,t,r,u,v)&&(E=u,T=b)),h=f}return isNaN(E)&&(E=i[s]),a?(a.push(E,v,T),a):[E,v,T]}function U5(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=vI(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function Bz(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function wI(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function EI(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=wI(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function z5(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!EI(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function hx(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=wI(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&Bz(n,e,o,r),e=o}return e}function yT(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=hx(n,e,t[s],r,i);return e}function Uz(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],u=wI(n,r,l,2);if(s===void 0&&(s=u),u===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class ro extends _5{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(rr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(_n(e[t],Yt.CHANGE,this.changed,this))}clone(){const e=new ro(V2(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<ld(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){$p(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)JO(e,t[r].getExtent());return e}getGeometries(){return V2(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new ro(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=Xo(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(V2(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function V2(n){return n.map(e=>e.clone())}function $5(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const u=n[e]-s,h=n[e+1]-a;i+=l*u-o*h,o=u,l=h}return i/2}function W5(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=$5(n,e,o,r),e=o}return i}function zz(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=W5(n,e,o,r),e=o[o.length-1]}return i}class np extends ud{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new np(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<ld(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(lI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),uI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return $5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Wc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Wv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new np(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zv(this.flatCoordinates,0,e,this.stride),this.changed()}}class Bl extends ud{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,u=i.length;l<u;++l){const h=i[l];Ln(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Ln(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Bl(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<ld(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(cI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,KU(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Zm(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new na(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],u=new na(e.slice(s,l),r);i.push(u),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=fI(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],u=ox(t,r,l,s,.5);Ln(e,u),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=S5(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new Bl(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return qU(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Yp(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class dd extends ud{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Ln(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new dd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<ld(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const u=Rh(e,t,s[o],s[o+1]);if(u<i){i=u;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return Wc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new _i(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new _i(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(eI(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zv(this.flatCoordinates,0,e,this.stride),this.changed()}}class Pa extends ud{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Ln(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Pa(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<ld(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(cI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return dI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return W5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),hx(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Zm(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Xo(this.getExtent());this.flatInteriorPoint_=vI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new _i(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new np(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],u=new np(t.slice(s,l),e);i.push(u),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;EI(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=hx(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=gI(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Pa(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return E5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Yp(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function u4(n){if(j0(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Pa(s,"XY",[s.length])}class Uh extends ud{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const u=i[o],h=s.length,f=u.getEnds();for(let g=0,y=f.length;g<y;++g)f[g]+=h;Ln(s,u.getFlatCoordinates()),a.push(f)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Ln(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new Uh(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<ld(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($U(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),WU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return XU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return zz(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),yT(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,dT(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=B5(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=U5(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new dd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;z5(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=yT(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=JU(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new Uh(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Pa(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),u=l[l.length-1];if(s!==0)for(let f=0,g=l.length;f<g;++f)l[f]-=s;const h=new Pa(t.slice(s,u),e,l);i.push(h),s=u}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return ZU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=x5(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const h4=no();class Ys{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?QO(this.flatCoordinates_):tI(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Xo(this.getExtent());this.flatInteriorPoints_=vI(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Uz(this.flatCoordinates_,this.ends_),t=B5(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=U5(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ox(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=ox(e,t,a,2,.5);Ln(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=qn(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=Hr(r)/Hr(t);qo(h4,r[0],r[3],i,-i,0,0,0),tu(this.flatCoordinates_,0,this.flatCoordinates_.length,2,h4,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ys(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=YO((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=Wv(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=S5(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=gI(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Ys(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ys.prototype.getFlatCoordinates=Ys.prototype.getOrientedFlatCoordinates;function H5(n,e,t=0,r=n.length-1,i=$z){for(;r>t;){if(r-t>600){const l=r-t+1,u=e-t+1,h=Math.log(l),f=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*f*(l-f)/l)*(u-l/2<0?-1:1),y=Math.max(t,Math.floor(e-u*f/l+g)),v=Math.min(r,Math.floor(e+(l-u)*f/l+g));H5(n,e,y,v,i)}const s=n[e];let a=t,o=r;for(Bg(n,t,e),i(n[r],s)>0&&Bg(n,t,r);a<o;){for(Bg(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?Bg(n,t,o):(o++,Bg(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function Bg(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function $z(n,e){return n<e?-1:n>e?1:0}let K5=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!Wy(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;Wy(e,l)&&(t.leaf?r.push(o):B2(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!Wy(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(Wy(e,a)){if(t.leaf||B2(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Sf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,u;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),u=!0),r.leaf){const h=Wz(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!u&&!r.leaf&&B2(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],u=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=Sf(e.slice(t,r+1)),of(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=Sf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));d4(e,t,r,u,this.compareMinX);for(let h=t;h<=r;h+=u){const f=Math.min(h+u-1,r);d4(e,h,f,l,this.compareMinY);for(let g=h;g<=f;g+=l){const y=Math.min(g+l-1,f);o.children.push(this._build(e,g,y,i-1))}}return of(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const u=t.children[l],h=G2(u),f=Yz(e,u)-h;f<a?(a=f,s=h<s?h:s,o=u):f===a&&h<s&&(s=h,o=u)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),Jg(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=Sf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,of(r,this.toBBox),of(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=Sf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,of(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=Qg(e,0,o,this.toBBox),u=Qg(e,o,r,this.toBBox),h=Xz(l,u),f=G2(l)+G2(u);h<s?(s=h,i=o,a=f<a?f:a):h===s&&f<a&&(a=f,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:Hz,s=e.leaf?this.compareMinY:Kz,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=Qg(e,0,t,s),o=Qg(e,r-t,r,s);let l=$y(a)+$y(o);for(let u=t;u<r-t;u++){const h=e.children[u];Jg(a,e.leaf?s(h):h),l+=$y(a)}for(let u=r-t-1;u>=t;u--){const h=e.children[u];Jg(o,e.leaf?s(h):h),l+=$y(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)Jg(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():of(e[t],this.toBBox)}};function Wz(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function of(n,e){Qg(n,0,n.children.length,e,n)}function Qg(n,e,t,r,i){i||(i=Sf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];Jg(i,n.leaf?r(a):a)}return i}function Jg(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function Hz(n,e){return n.minX-e.minX}function Kz(n,e){return n.minY-e.minY}function G2(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function $y(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Yz(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function Xz(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function B2(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Wy(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Sf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d4(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;H5(n,a,e,t,i),s.push(e,a,a,t)}}class f4{constructor(e){this.rbush_=new K5(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[In(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[In(o)]=l}this.rbush_.load(r)}remove(e){const t=In(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[In(t)],i=[r.minX,r.minY,r.maxX,r.maxY];h0(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return Fh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return cu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class SI extends il{constructor(e){super(),this.projection=qn(e.projection),this.attributions_=g4(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=g4(e),this.changed()}setState(e){this.state_=e,this.changed()}}function g4(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const pa={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Sc extends rl{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class fd extends SI{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ym,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Fn(this.format_,"`format` must be set when `url` is set"),this.loader_=c4(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:Gz;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new f4:null,this.loadedExtentsRtree_=new f4,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new Sa(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=In(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Sc(pa.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ys||(this.featureChangeKeys_[e]=[_n(t,Yt.CHANGE,this.handleFeatureChange_,this),_n(t,u0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Ys){const s=this.idIndex_[i];s instanceof Ys?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(Fn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=In(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=In(o);this.setupChangeEvents_(l,o);const u=o.getGeometry();if(u){const h=u.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(pa.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new Sc(pa.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(pa.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(pa.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Es.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(Es.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(rr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Sc(pa.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Ys||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Ys||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Fh(this.nullGeometryFeatures_)||Ln(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=i5(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||Km,this.featuresRtree_.forEachInExtent(l,function(u){if(t(u)){const h=u.getGeometry(),f=o;if(o=h instanceof Ys?0:h.closestPointXY(r,i,a,o),o<f){s=u;const g=Math.sqrt(o);l[0]=r-g,l[1]=i-g,l[2]=r+g,l[3]=i+g}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=In(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new Sc(pa.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:In(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Fh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return zc(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Sc(pa.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Sc(pa.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Sc(pa.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(h0(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=In(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(rr),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(pa.REMOVEFEATURE)&&this.dispatchEvent(new Sc(pa.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Fn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(c4(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class er{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new er({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=cx(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===vt.IDLE&&t.load(),t.getImageState()===vt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?In(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Bh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class _r{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new _r({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function m4(n){return n[0]>0&&n[1]>0}function qz(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function As(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Kv{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=As(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Kv({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Ut()}getImage(e){return Ut()}getHitDetectionImage(){return Ut()}getPixelRatio(e){return 1}getImageState(){return Ut()}getImageSize(){return Ut()}getOrigin(){return Ut()}getSize(){return Ut()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=As(e)}listenImageChange(e){Ut()}load(){Ut()}unlistenImageChange(e){Ut()}ready(){return Promise.resolve()}}class Yv extends Kv{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?vt.LOADING:vt.LOADED,this.imageState_===vt.LOADING&&this.ready().then(()=>this.imageState_=vt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Yv({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=ba.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=ri(a,a);this.draw_(s,o,e),i=o.canvas,ba.set(r,null,null,new N5(i,void 0,null,vt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const G=i;i=s,s=G}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),u=Math.sqrt(s*s-l*l),h=i-u,f=Math.sqrt(l*l+h*h),g=f/l;if(e==="miter"&&g<=r)return g*t;const y=t/2/g,v=t/2*(h/f),E=Math.sqrt((i+y)*(i+y)+v*v)-i;if(this.radius2_===void 0||e==="bevel")return E*2;const T=i*Math.sin(o),b=Math.sqrt(i*i-T*T),I=s-b,F=Math.sqrt(T*T+I*I)/T;if(F<=r){const G=F*t/2-s-i;return 2*Math.max(E,G)}return E*2}createRenderOptions(){let e=g0,t=m0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Fo(this.stroke_.getColor()??Jm),o=this.stroke_.getWidth()??tp,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??m0,e=this.stroke_.getLineCap()??g0,r=this.stroke_.getMiterLimit()??Qm);const l=this.calculateLineJoinSize_(t,o,r),u=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*u+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=Ss),t.fillStyle=Fo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Bh(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=ri(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,u=o%2===0?r:i;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Ss,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Ps extends Yv{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Ps({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class En{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=p4,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new En({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=p4,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function Zz(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Fn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let U2=null;function Y5(n,e){if(!U2){const t=new er({color:"rgba(255,255,255,0.4)"}),r=new _r({color:"#3399CC",width:1.25});U2=[new En({image:new Ps({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return U2}function p4(n){return n.getGeometry()}const Qz="#333";class Go{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=As(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new er({color:Qz}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Go({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof er?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=As(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const di={ANIMATING:0,INTERACTING:1},Dt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Hy=[Dt.FILL],Kc=[Dt.STROKE],Eh=[Dt.BEGIN_PATH],y4=[Dt.CLOSE_PATH];class qp extends L5{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],jh(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const u=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],f=e[t+1];const g=this.tmpCoordinate_;let y=!0,v,x,E;for(v=t+i;v<r;v+=i)g[0]=e[v],g[1]=e[v+1],E=rT(u,g),E!==x?(y&&(o[l++]=h,o[l++]=f,y=!1),o[l++]=g[0],o[l++]=g[1]):E===ui.INTERSECTING?(o[l++]=g[0],o[l++]=g[1],y=!1):y=!0,h=g[0],f=g[1],x=E;return(s&&y||v===t+i)&&(o[l++]=h,o[l++]=f),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],u=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(u),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let u,h,f,g,y;switch(a){case"MultiPolygon":u=e.getOrientedFlatCoordinates(),g=[];const v=e.getEndss();y=0;for(let x=0,E=v.length;x<E;++x){const T=[];y=this.drawCustomCoordinates_(u,y,v[x],o,T),g.push(T)}this.instructions.push([Dt.CUSTOM,l,g,e,r,dT,s]),this.hitDetectionInstructions.push([Dt.CUSTOM,l,g,e,i||r,dT,s]);break;case"Polygon":case"MultiLineString":f=[],u=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(u,0,e.getEnds(),o,f),this.instructions.push([Dt.CUSTOM,l,f,e,r,Zm,s]),this.hitDetectionInstructions.push([Dt.CUSTOM,l,f,e,i||r,Zm,s]);break;case"LineString":case"Circle":u=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(u,0,u.length,o,!1,!1),this.instructions.push([Dt.CUSTOM,l,h,e,r,Wc,s]),this.hitDetectionInstructions.push([Dt.CUSTOM,l,h,e,i||r,Wc,s]);break;case"MultiPoint":u=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(u,o),h>l&&(this.instructions.push([Dt.CUSTOM,l,h,e,r,Wc,s]),this.hitDetectionInstructions.push([Dt.CUSTOM,l,h,e,i||r,Wc,s]));break;case"Point":u=e.getFlatCoordinates(),this.coordinates.push(u[0],u[1]),h=this.coordinates.length,this.instructions.push([Dt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Dt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Dt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Dt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Dt.END_GEOMETRY?a=t:s==Dt.BEGIN_GEOMETRY&&(i[2]=t,YB(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Fo(r||Ss)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Fo(r||Jm);const i=e.getLineCap();t.lineCap=i!==void 0?i:g0;const s=e.getLineDash();t.lineDash=s?s.slice():Ll;const a=e.getLineDashOffset();t.lineDashOffset=a||Ol;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:m0;const l=e.getWidth();t.lineWidth=l!==void 0?l:tp;const u=e.getMiterLimit();t.miterLimit=u!==void 0?u:Qm,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Dt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Dt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!Tu(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Dt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=ZO(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Xm(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Jz extends qp{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!jh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Dt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Dt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,u=i.length;l<u;l+=e.getStride())(!this.maxExtent||jh(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Dt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Dt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class e$ extends qp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Dt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Dt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ll,Ol],Eh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(Kc),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Dt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ll,Ol],Eh);const o=e.getEnds(),l=e.getFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinates_(l,h,o[f],u);this.hitDetectionInstructions.push(Kc),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Kc),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Kc),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Eh)}}class _4 extends qp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Eh),this.hitDetectionInstructions.push(Eh);for(let u=0;u<l;++u){const h=r[u],f=this.coordinates.length,g=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[Dt.MOVE_TO_LINE_TO,f,g];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(y4),this.hitDetectionInstructions.push(y4)),t=h}return a&&(this.instructions.push(Hy),this.hitDetectionInstructions.push(Hy)),o&&(this.instructions.push(Kc),this.hitDetectionInstructions.push(Kc)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Dt.SET_FILL_STYLE,Ss]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Dt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ll,Ol]);const o=e.getFlatCoordinates(),l=e.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Dt.CIRCLE,u];this.instructions.push(Eh,h),this.hitDetectionInstructions.push(Eh,h),i.fillStyle!==void 0&&(this.instructions.push(Hy),this.hitDetectionInstructions.push(Hy)),i.strokeStyle!==void 0&&(this.instructions.push(Kc),this.hitDetectionInstructions.push(Kc)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Dt.SET_FILL_STYLE,Ss]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Dt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ll,Ol]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),u=e.getStride();this.drawFlatCoordinatess_(l,0,o,u),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Dt.SET_FILL_STYLE,Ss]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Dt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ll,Ol]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinatess_(l,h,o[f],u);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=ih(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function t$(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[u,h]=l.slice(-2),f=e[a+i],g=e[a+i+1],y=Math.sqrt((f-u)*(f-u)+(g-h)*(g-h));if(o+=y,o>=n){const v=(n-o+y)/y,x=Ks(u,f,v),E=Ks(h,g,v);l.push(x,E),s.push(l),l=[x,E],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const v=y-o,x=Ks(u,f,v/y),E=Ks(h,g,v/y);l.push(x,E),s.push(l),l=[x,E],o=0,a+=i}}return o>0&&s.push(l),s}function n$(n,e,t,r,i){let s=t,a=t,o=0,l=0,u=t,h,f,g,y,v,x,E,T,b,I;for(f=t;f<r;f+=i){const M=e[f],F=e[f+1];v!==void 0&&(b=M-v,I=F-x,y=Math.sqrt(b*b+I*I),E!==void 0&&(l+=g,h=Math.acos((E*b+T*I)/(g*y)),h>n&&(l>o&&(o=l,s=u,a=f),l=0,u=f-i)),g=y,E=b,T=I),v=M,x=F}return l+=y,l>o?[u,f]:[s,a]}const dx={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class r$ extends qp{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Ss]={fillStyle:Ss},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const u=e.getType();let h=null,f=e.getStride();if(a.placement==="line"&&(u=="LineString"||u=="MultiLineString"||u=="Polygon"||u=="MultiPolygon")){if(!cs(this.maxExtent,e.getExtent()))return;let g;if(h=e.getFlatCoordinates(),u=="LineString")g=[h.length];else if(u=="MultiLineString")g=e.getEnds();else if(u=="Polygon")g=e.getEnds().slice(0,1);else if(u=="MultiPolygon"){const E=e.getEndss();g=[];for(let T=0,b=E.length;T<b;++T)g.push(E[T][0])}this.beginGeometry(e,t,r);const y=a.repeat,v=y?void 0:a.textAlign;let x=0;for(let E=0,T=g.length;E<T;++E){let b;y?b=t$(y*this.resolution,h,x,g[E],f):b=[h.slice(x,g[E])];for(let I=0,M=b.length;I<M;++I){const F=b[I];let G=0,R=F.length;if(v==null){const P=n$(a.maxAngle,F,0,F.length,2);G=P[0],R=P[1]}for(let P=G;P<R;P+=f)o.push(F[P],F[P+1]);const C=o.length;x=g[E],this.drawChars_(l,C),l=C}}this.endGeometry(t)}else{let g=a.overflow?null:[];switch(u){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),f=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||g.push(h[2]/this.resolution),f=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();h=[];for(let F=0,G=M.length;F<G;F+=3)a.overflow||g.push(M[F+2]/this.resolution),h.push(M[F],M[F+1]);if(h.length===0)return;f=2;break}const y=this.appendFlatPointCoordinates(h,f);if(y===l)return;if(g&&(y-l)/2!==h.length/f){let M=l/2;g=g.filter((F,G)=>{const R=o[(M+G)*2]===h[G*f]&&o[(M+G)*2+1]===h[G*f+1];return R||--M,R})}this.saveTextStates_();const v=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,x=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let E=a.padding;if(E!=wh&&(a.scale[0]<0||a.scale[1]<0)){let M=a.padding[0],F=a.padding[1],G=a.padding[2],R=a.padding[3];a.scale[0]<0&&(F=-F,R=-R),a.scale[1]<0&&(M=-M,G=-G),E=[M,F,G,R]}const T=this.pixelRatio;this.instructions.push([Dt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==wh?wh:E.map(function(M){return M*T}),v,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]);const b=1/T,I=v?v.slice(0):null;I&&(I[1]=Ss),this.hitDetectionInstructions.push([Dt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,E,I,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Ss:this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||ep,justify:t.justify,textBaseline:t.textBaseline||ux,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=dx[i.textBaseline],h=this.textOffsetY_*l,f=this.text_,g=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Dt.DRAW_CHARS,e,t,u,i.overflow,o,i.maxAngle,l,h,s,g*l,f,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Dt.DRAW_CHARS,e,t,u,i.overflow,o&&Ss,i.maxAngle,l,h,s,g*l,f,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Fo(a.getColor()||Ss)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=o.getLineDash(),E=o.getLineDashOffset(),T=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||g0,s.lineDash=x?x.slice():Ll,s.lineDashOffset=E===void 0?Ol:E,s.lineJoin=o.getLineJoin()||m0,s.lineWidth=T===void 0?tp:T,s.miterLimit=b===void 0?Qm:b,s.strokeStyle=Fo(o.getColor()||Jm)}r=this.textState_;const l=e.getFont()||O5;wz(l);const u=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||ux,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||wh,r.scale=u===void 0?[1,1]:u;const h=e.getOffsetX(),f=e.getOffsetY(),g=e.getRotateWithView(),y=e.getKeepUpright(),v=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=g===void 0?!1:g,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=v===void 0?0:v,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:In(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+In(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const i$={Circle:_4,Default:qp,Image:Jz,LineString:e$,Polygon:_4,Text:r$};class s${constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=i$[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function a$(n,e,t,r,i,s,a,o,l,u,h,f,g=!0){let y=n[e],v=n[e+1],x=0,E=0,T=0,b=0;function I(){x=y,E=v,e+=r,y=n[e],v=n[e+1],b+=T,T=Math.sqrt((y-x)*(y-x)+(v-E)*(v-E))}do I();while(e<t-r&&b+T<s);let M=T===0?0:(s-b)/T;const F=Ks(x,y,M),G=Ks(E,v,M),R=e-r,C=b,P=s+o*l(u,i,h);for(;e<t-r&&b+T<P;)I();M=T===0?0:(P-b)/T;const N=Ks(x,y,M),O=Ks(E,v,M);let z=!1;if(g)if(f){const Ne=[F,G,N,O];y5(Ne,0,4,2,f,Ne,Ne),z=Ne[0]>Ne[2]}else z=F>N;const j=Math.PI,be=[],Pe=R+r===e;e=R,T=0,b=C,y=n[e],v=n[e+1];let je;if(Pe){I(),je=Math.atan2(v-E,y-x),z&&(je+=je>0?-j:j);const Ne=(N+F)/2,ue=(O+G)/2;return be[0]=[Ne,ue,(P-s)/2,je,i],be}i=i.replace(/\n/g," ");for(let Ne=0,ue=i.length;Ne<ue;){I();let Te=Math.atan2(v-E,y-x);if(z&&(Te+=Te>0?-j:j),je!==void 0){let ie=Te-je;if(ie+=ie>j?-2*j:ie<-j?2*j:0,Math.abs(ie)>a)return null}je=Te;const le=Ne;let se=0;for(;Ne<ue;++Ne){const ie=z?ue-Ne-1:Ne,pe=o*l(u,i[ie],h);if(e+r<t&&b+T<s+se+pe/2)break;se+=pe}if(Ne===le)continue;const V=z?i.substring(ue-le,ue-Ne):i.substring(le,Ne);M=T===0?0:(s+se/2-b)/T;const Q=Ks(x,y,M),ne=Ks(E,v,M);be.push([Q,ne,se/2,Te,V]),s+=se}return be}class X5{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(lx(),{get:(e,t)=>{if(typeof lx()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const lf=ta(),Tc=[],wl=[],El=[],bc=[];function x4(n){return n[3].declutterBox}const v4=new RegExp("[-----]");function z2(n,e){return e==="start"?e=v4.test(n)?"right":"left":e==="end"&&(e=v4.test(n)?"left":"right"),dx[e]}function o$(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function l$(n,e,t){return t%2===0&&(n+=e),n}class c${constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=no(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new X5:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],u=this.pixelRatio,h=[l.scale[0]*u,l.scale[1]*u],f=l.justify?dx[l.justify]:z2(Array.isArray(e)?e[0]:e,l.textAlign||ep),g=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(o$,[]),{width:v,height:x,widths:E,heights:T,lineWidths:b}=Sz(l,y),I=v+g,M=[],F=(I+2)*h[0],G=(x+g)*h[1],R={width:F<0?Math.floor(F):Math.ceil(F),height:G<0?Math.floor(G):Math.ceil(G),contextInstructions:M};(h[0]!=1||h[1]!=1)&&M.push("scale",h),i&&(M.push("strokeStyle",a.strokeStyle),M.push("lineWidth",g),M.push("lineCap",a.lineCap),M.push("lineJoin",a.lineJoin),M.push("miterLimit",a.miterLimit),M.push("setLineDash",[a.lineDash]),M.push("lineDashOffset",a.lineDashOffset)),r&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const C=.5-f;let P=f*I+C*g;const N=[],O=[];let z=0,j=0,be=0,Pe=0,je;for(let Ne=0,ue=y.length;Ne<ue;Ne+=2){const Te=y[Ne];if(Te===`
`){j+=z,z=0,P=f*I+C*g,++Pe;continue}const le=y[Ne+1]||l.font;le!==je&&(i&&N.push("font",le),r&&O.push("font",le),je=le),z=Math.max(z,T[be]);const se=[Te,P+C*E[be]+f*(E[be]-b[Pe]),.5*(g+z)+j];P+=E[be],i&&N.push("strokeText",se),r&&O.push("fillText",se),++be}return Array.prototype.push.apply(M,N),Array.prototype.push.apply(M,O),this.labels_[s]=R,R}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,u,h,f,g,y,v,x,E){o*=g[0],l*=g[1];let T=r-o,b=i-l;const I=s+u>e?e-u:s,M=a+h>t?t-h:a,F=v[3]+I*g[0]+v[1],G=v[0]+M*g[1]+v[2],R=T-v[3],C=b-v[0];(x||f!==0)&&(Tc[0]=R,bc[0]=R,Tc[1]=C,wl[1]=C,wl[0]=R+F,El[0]=wl[0],El[1]=C+G,bc[1]=El[1]);let P;return f!==0?(P=qo(no(),r,i,1,1,f,-r,-i),ni(P,Tc),ni(P,wl),ni(P,El),ni(P,bc),cu(Math.min(Tc[0],wl[0],El[0],bc[0]),Math.min(Tc[1],wl[1],El[1],bc[1]),Math.max(Tc[0],wl[0],El[0],bc[0]),Math.max(Tc[1],wl[1],El[1],bc[1]),lf)):cu(Math.min(R,R+F),Math.min(C,C+G),Math.max(R,R+F),Math.max(C,C+G),lf),y&&(T=Math.round(T),b=Math.round(b)),{drawImageX:T,drawImageY:b,drawImageW:I,drawImageH:M,originX:u,originY:h,declutterBox:{minX:lf[0],minY:lf[1],maxX:lf[2],maxY:lf[3],value:E},canvasTransform:P,scale:g}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),u=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return u.minX-h<=t[0]&&u.maxX+h>=0&&u.minY-h<=t[1]&&u.maxY+h>=0&&(l&&this.replayTextBackground_(e,Tc,wl,El,bc,a,o),Tz(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=ni(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,u=z2(Array.isArray(e)?e[0]:e,s.textAlign||ep),h=dx[s.textBaseline||ux],f=o&&o.lineWidth?o.lineWidth:0,g=a.width/l-2*s.scale[0],y=u*g+2*(.5-u)*f,v=h*a.height/l+2*(.5-h)*f;return{label:a,anchorX:y,anchorY:v}}execute_(e,t,r,i,s,a,o,l){const u=this.zIndexContext_;let h;this.pixelCoordinates_&&Tu(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=tu(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),OU(this.renderedTransform_,r));let f=0;const g=i.length;let y=0,v,x,E,T,b,I,M,F,G,R,C,P,N,O=0,z=0;const j=this.coordinateCache_,be=this.viewRotation_,Pe=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,je={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:be},Ne=this.instructions!=i||this.overlaps?0:200;let ue,Te,le,se;for(;f<g;){const V=i[f];switch(V[0]){case Dt.BEGIN_GEOMETRY:ue=V[1],se=V[3],ue.getGeometry()?o!==void 0&&!cs(o,se.getExtent())?f=V[2]+1:++f:f=V[2],u&&(u.zIndex=V[4]);break;case Dt.BEGIN_PATH:O>Ne&&(this.fill_(e),O=0),z>Ne&&(e.stroke(),z=0),!O&&!z&&(e.beginPath(),b=NaN,I=NaN),++f;break;case Dt.CIRCLE:y=V[1];const ne=h[y],ie=h[y+1],pe=h[y+2],De=h[y+3],Be=pe-ne,Ue=De-ie,_e=Math.sqrt(Be*Be+Ue*Ue);e.moveTo(ne+_e,ie),e.arc(ne,ie,_e,0,2*Math.PI,!0),++f;break;case Dt.CLOSE_PATH:e.closePath(),++f;break;case Dt.CUSTOM:y=V[1],v=V[2];const Ct=V[3],kt=V[4],hn=V[5];je.geometry=Ct,je.feature=ue,f in j||(j[f]=[]);const Mt=j[f];hn?hn(h,y,v,2,Mt):(Mt[0]=h[y],Mt[1]=h[y+1],Mt.length=2),u&&(u.zIndex=V[6]),kt(Mt,je),++f;break;case Dt.DRAW_IMAGE:y=V[1],v=V[2],G=V[3],x=V[4],E=V[5];let jn=V[6];const Qt=V[7],ot=V[8],Zn=V[9],on=V[10];let en=V[11];const Qn=V[12];let mt=V[13];T=V[14]||"declutter";const Bt=V[15];if(!G&&V.length>=20){R=V[19],C=V[20],P=V[21],N=V[22];const Ie=this.drawLabelWithPointPlacement_(R,C,P,N);G=Ie.label,V[3]=G;const $e=V[23];x=(Ie.anchorX-$e)*this.pixelRatio,V[4]=x;const et=V[24];E=(Ie.anchorY-et)*this.pixelRatio,V[5]=E,jn=G.height,V[6]=jn,mt=G.width,V[13]=mt}let Mn;V.length>25&&(Mn=V[25]);let _t,Jt,Pt;V.length>17?(_t=V[16],Jt=V[17],Pt=V[18]):(_t=wh,Jt=null,Pt=null),on&&Pe?en+=be:!on&&!Pe&&(en-=be);let sr=0;for(;y<v;y+=2){if(Mn&&Mn[sr++]<mt/this.pixelRatio)continue;const Ie=this.calculateImageOrLabelDimensions_(G.width,G.height,h[y],h[y+1],mt,jn,x,E,ot,Zn,en,Qn,s,_t,!!Jt||!!Pt,ue),$e=[e,t,G,Ie,Qt,Jt,Pt];if(l){let et,ft,St;if(Bt){const cn=v-y;if(!Bt[cn]){Bt[cn]={args:$e,declutterMode:T};continue}const fr=Bt[cn];et=fr.args,ft=fr.declutterMode,delete Bt[cn],St=x4(et)}let sn,dr;if(et&&(ft!=="declutter"||!l.collides(St))&&(sn=!0),(T!=="declutter"||!l.collides(Ie.declutterBox))&&(dr=!0),ft==="declutter"&&T==="declutter"){const cn=sn&&dr;sn=cn,dr=cn}sn&&(ft!=="none"&&l.insert(St),this.replayImageOrLabel_.apply(this,et)),dr&&(T!=="none"&&l.insert(Ie.declutterBox),this.replayImageOrLabel_.apply(this,$e))}else this.replayImageOrLabel_.apply(this,$e)}++f;break;case Dt.DRAW_CHARS:const ai=V[1],Br=V[2],zt=V[3],ns=V[4];N=V[5];const Oe=V[6],Ee=V[7],me=V[8];P=V[9];const Nt=V[10];R=V[11],Array.isArray(R)&&(R=R.reduce(l$,"")),C=V[12];const L=[V[13],V[13]];T=V[14]||"declutter";const Lt=V[15],W=this.textStates[C],q=W.font,X=[W.scale[0]*Ee,W.scale[1]*Ee];let ce;q in this.widths_?ce=this.widths_[q]:(ce={},this.widths_[q]=ce);const he=fI(h,ai,Br,2),Ve=Math.abs(X[0])*a4(q,R,ce);if(ns||Ve<=he){const Ie=this.textStates[C].textAlign,$e=(he-Ve)*z2(R,Ie),et=a$(h,ai,Br,2,R,$e,Oe,Math.abs(X[0]),a4,q,ce,Pe?0:this.viewRotation_,Lt);e:if(et){const ft=[];let St,sn,dr,cn,fr;if(P)for(St=0,sn=et.length;St<sn;++St){fr=et[St],dr=fr[4],cn=this.createLabel(dr,C,"",P),x=fr[2]+(X[0]<0?-Nt:Nt),E=zt*cn.height+(.5-zt)*2*Nt*X[1]/X[0]-me;const vr=this.calculateImageOrLabelDimensions_(cn.width,cn.height,fr[0],fr[1],cn.width,cn.height,x,E,0,0,fr[3],L,!1,wh,!1,ue);if(l&&T==="declutter"&&l.collides(vr.declutterBox))break e;ft.push([e,t,cn,vr,1,null,null])}if(N)for(St=0,sn=et.length;St<sn;++St){fr=et[St],dr=fr[4],cn=this.createLabel(dr,C,N,""),x=fr[2],E=zt*cn.height-me;const vr=this.calculateImageOrLabelDimensions_(cn.width,cn.height,fr[0],fr[1],cn.width,cn.height,x,E,0,0,fr[3],L,!1,wh,!1,ue);if(l&&T==="declutter"&&l.collides(vr.declutterBox))break e;ft.push([e,t,cn,vr,1,null,null])}l&&T!=="none"&&l.load(ft.map(x4));for(let vr=0,Fi=ft.length;vr<Fi;++vr)this.replayImageOrLabel_.apply(this,ft[vr])}}++f;break;case Dt.END_GEOMETRY:if(a!==void 0){ue=V[1];const Ie=a(ue,se,T);if(Ie)return Ie}++f;break;case Dt.FILL:Ne?O++:this.fill_(e),++f;break;case Dt.MOVE_TO_LINE_TO:for(y=V[1],v=V[2],Te=h[y],le=h[y+1],e.moveTo(Te,le),b=Te+.5|0,I=le+.5|0,y+=2;y<v;y+=2)Te=h[y],le=h[y+1],M=Te+.5|0,F=le+.5|0,(y==v-2||M!==b||F!==I)&&(e.lineTo(Te,le),b=M,I=F);++f;break;case Dt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],O&&(this.fill_(e),O=0,z&&(e.stroke(),z=0)),e.fillStyle=V[1],++f;break;case Dt.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,V),++f;break;case Dt.STROKE:Ne?z++:e.stroke(),++f;break;default:++f;break}}O&&this.fill_(e),z&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const fh=["Polygon","Circle","LineString","Image","Text","Default"],q5=["Image","Text"],u$=fh.filter(n=>!q5.includes(n));class h${constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=no(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new c$(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=qo(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=ri(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):u||h.clearRect(0,0,o,o);let f;this.renderBuffer_!==void 0&&(f=ta(),pm(f,e),Xm(f,t*(this.renderBuffer_+i),f));const g=d$(i);let y;function v(F,G,R){const C=h.getImageData(0,0,o,o).data;for(let P=0,N=g.length;P<N;P++)if(C[g[P]]>0){if(!a||R==="none"||y!=="Image"&&y!=="Text"||a.includes(F)){const O=(g[P]-3)/4,z=i-O%o,j=i-(O/o|0),be=s(F,G,z*z+j*j);if(be)return be}h.clearRect(0,0,o,o);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Pl);let E,T,b,I,M;for(E=x.length-1;E>=0;--E){const F=x[E].toString();for(b=this.executorsByZIndex_[F],T=fh.length-1;T>=0;--T)if(y=fh[T],I=b[y],I!==void 0&&(M=I.executeHitDetection(h,l,r,v,f),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return tu(o,0,8,2,e,o),o}isEmpty(){return Fh(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?KB:Pl),a=a||fh;const u=fh.length;for(let h=0,f=l.length;h<f;++h){const g=l[h].toString(),y=this.executorsByZIndex_[g];for(let v=0,x=a.length;v<x;++v){const E=a[v],T=y[E];if(T!==void 0){const b=o===null?void 0:T.getZIndexContext(),I=b?b.getContext():e,M=this.maxExtent_&&E!=="Image"&&E!=="Text";if(M&&(I.save(),this.clip(I,r)),!b||E==="Text"||E==="Image"?T.execute(I,t,r,i,s,o):b.pushFunction(F=>T.execute(F,t,r,i,s,o)),M&&I.restore(),b){b.offset();const F=l[h]*u+fh.indexOf(E);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Pl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const $2={};function d$(n){if($2[n]!==void 0)return $2[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return $2[n]=i,i}function w4(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let Zp=class Z5 extends Kv{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;Fn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||In(a)),Fn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Fn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=vt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?vt.LOADED:vt.IDLE:l=vt.LOADING:l=vt.LOADED),this.color_=e.color!==void 0?Bh(e.color):null,this.iconImage_=cx(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let u,h;if(e.size)[u,h]=e.size;else{const f=this.getImage(1);if(f.width&&f.height)u=f.width,h=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=e;const g=()=>{if(this.unlistenImageChange(g),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(w4(y[0],y[1],e.width,e.height))};this.listenImageChange(g);return}}u!==void 0&&this.setScale(w4(u,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Z5({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=cx(null,e,this.crossOrigin_,vt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==vt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==vt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Yt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Yt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Lo=.5;function f$(n,e,t,r,i,s,a,o,l){const u=i,h=n[0]*Lo,f=n[1]*Lo,g=ri(h,f);g.imageSmoothingEnabled=!1;const y=g.canvas,v=new Iz(g,Lo,i,null,a,o,null),x=t.length,E=Math.floor((256*256*256-1)/x),T={};for(let I=1;I<=x;++I){const M=t[I-1],F=M.getStyleFunction()||r;if(!F)continue;let G=F(M,s);if(!G)continue;Array.isArray(G)||(G=[G]);const C=(I*E).toString(16).padStart(7,"#00000");for(let P=0,N=G.length;P<N;++P){const O=G[P],z=O.getGeometryFunction()(M);if(!z||!cs(u,z.getExtent()))continue;const j=O.clone(),be=j.getFill();be&&be.setColor(C);const Pe=j.getStroke();Pe&&(Pe.setColor(C),Pe.setLineDash(null)),j.setText(void 0);const je=O.getImage();if(je){const le=je.getImageSize();if(!le)continue;const se=ri(le[0],le[1],void 0,{alpha:!1}),V=se.canvas;se.fillStyle=C,se.fillRect(0,0,V.width,V.height),j.setImage(new Zp({img:V,anchor:je.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:je.getOrigin(),opacity:1,size:je.getSize(),scale:je.getScale(),rotation:je.getRotation(),rotateWithView:je.getRotateWithView()}))}const Ne=j.getZIndex()||0;let ue=T[Ne];ue||(ue={},T[Ne]=ue,ue.Polygon=[],ue.Circle=[],ue.LineString=[],ue.Point=[]);const Te=z.getType();if(Te==="GeometryCollection"){const le=z.getGeometriesArrayRecursive();for(let se=0,V=le.length;se<V;++se){const Q=le[se];ue[Q.getType().replace("Multi","")].push(Q,j)}}else ue[Te.replace("Multi","")].push(z,j)}}const b=Object.keys(T).map(Number).sort(Pl);for(let I=0,M=b.length;I<M;++I){const F=T[b[I]];for(const G in F){const R=F[G];for(let C=0,P=R.length;C<P;C+=2){v.setStyle(R[C+1]);for(let N=0,O=e.length;N<O;++N)v.setTransform(e[N]),v.drawGeometry(R[C])}}}return g.getImageData(0,0,y.width,y.height)}function g$(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*Lo),s=Math.floor(Math.round(n[1])*Lo),a=(lr(i,0,t.width-1)+lr(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),f=Math.floor((256*256*256-1)/e.length);h&&h%f===0&&r.push(e[h/f-1])}return r}class Q5 extends rl{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const m$=5;class p$ extends zp{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=m$}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Ut()}getData(e){return null}prepareFrame(e){return Ut()}renderFrame(e,t){return Ut()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===vt.LOADED||t.getState()===vt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=vt.LOADED&&t!=vt.ERROR&&e.addEventListener(Yt.CHANGE,this.boundHandleImageChange_),t==vt.IDLE&&(e.load(),t=e.getState()),t==vt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const E4=[];let Tf=null;function y$(){Tf=ri(1,1,void 0,{willReadFrequently:!0})}class TI extends p${constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=no(),this.pixelTransform=no(),this.inversePixelTransform=no(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){Tf||y$(),Tf.clearRect(0,0,1,1);let i;try{Tf.drawImage(e,t,r,1,1,0,0,1,1),i=Tf.getImageData(0,0,1,1).data}catch{return Tf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&Tu(Bh(e.style.backgroundColor),Bh(r)))){const o=e.firstElementChild;Hc(o)&&(a=o.getContext("2d"))}if(a&&VU(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Qs?R5():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=ri();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=cd(r),s=Vv(r),a=jv(r),o=Fv(r);ni(t.coordinateToPixelTransform,i),ni(t.coordinateToPixelTransform,s),ni(t.coordinateToPixelTransform,a),ni(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;ni(l,i),ni(l,s),ni(l,a),ni(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(un(r)/i*a),l=Math.round(Hr(r)/i*a);qo(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),p5(this.inversePixelTransform,this.pixelTransform);const u=jU(this.pixelTransform);if(this.useContainer(t,u,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),u!==h.style.transform&&(h.style.transform=u)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new Q5(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Ta.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Ta.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new X5),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ta.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ta.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,u=a/2,h=i/t,f=-h,g=-e[0]+o,y=-e[1];return qo(this.tempTransform,l,u,h,f,-r,g,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class _$ extends TI{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=ta(),this.wrappedRenderedExtent_=ta(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,u=s.rotation,h=l.getExtent(),f=this.getLayer().getSource(),g=this.getLayer().getDeclutter(),y=t.pixelRatio,v=t.viewHints,x=!(v[di.ANIMATING]||v[di.INTERACTING]),E=this.context,T=Math.round(un(i)/o*y),b=Math.round(Hr(i)/o*y),I=f.getWrapX()&&l.canWrapX(),M=I?un(h):null,F=I?Math.ceil((i[2]-h[2])/M)+1:1;let G=I?Math.floor((i[0]-h[0])/M):0;do{let R=this.getRenderTransform(a,o,0,y,T,b,G*M);t.declutter&&(R=R.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],R,u,x,r===void 0?fh:r?q5:u$,r?g&&t.declutter[g]:void 0)}while(++G<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ri(this.context.canvas.width,this.context.canvas.height,E4))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Hv(this.context),E4.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Ta.PRERENDER)||this.getLayer().hasListener(Ta.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Do(r.extent);o=cs(l,e.extent),this.clipped_=o&&!zc(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),h=[],f=r[0]*Lo,g=r[1]*Lo;h.push(this.getRenderTransform(i,s,a,Lo,f,g,0).slice());const y=u.getSource(),v=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!zc(v,l)){let x=l[0];const E=un(v);let T=0,b;for(;x<v[0];)--T,b=E*T,h.push(this.getRenderTransform(i,s,a,Lo,f,g,b).slice()),x+=E;for(T=0,x=l[2];x>v[2];)++T,b=E*T,h.push(this.getRenderTransform(i,s,a,Lo,f,g,b).slice()),x-=E}this.hitDetectionImageData_=f$(r,h,this.renderedFeatures_,u.getStyleFunction(),l,s,a,o4(s,this.renderedPixelRatio_))}t(g$(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),u={},h=function(g,y,v){const x=In(g),E=u[x];if(E){if(E!==!0&&v<E.distanceSq){if(v===0)return u[x]=!0,s.splice(s.lastIndexOf(E),1),i(g,l,y);E.geometry=y,E.distanceSq=v}}else{if(v===0)return u[x]=!0,i(g,l,y);s.push(u[x]={feature:g,layer:l,geometry:y,distanceSq:v,callback:i})}},f=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,f?t.declutter?.[f]?.all().map(g=>g.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[di.ANIMATING],s=e.viewHints[di.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,u=e.viewState,h=u.projection,f=u.resolution,g=e.pixelRatio,y=t.getRevision(),v=t.getRenderBuffer();let x=t.getRenderOrder();x===void 0&&(x=Rz);const E=u.center.slice(),T=Xm(l,v*f),b=T.slice(),I=[T.slice()],M=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!zc(M,e.extent)){const be=un(M),Pe=Math.max(un(T)/2,be);T[0]=M[0]-Pe,T[2]=M[2]+Pe,a5(E,h);const je=r5(I[0],h);je[0]<M[0]&&je[2]<M[2]?I.push([je[0]+be,je[1],je[2]+be,je[3]]):je[0]>M[0]&&je[2]>M[2]&&I.push([je[0]-be,je[1],je[2]-be,je[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==y&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&zc(this.wrappedRenderedExtent_,T))return Tu(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new s$(V5(f,g),T,f,g);let G;for(let be=0,Pe=I.length;be<Pe;++be)r.loadFeatures(I[be],f,h);const R=o4(f,g);let C=!0;const P=(be,Pe)=>{let je;const Ne=be.getStyleFunction()||t.getStyleFunction();if(Ne&&(je=Ne(be,f)),je){const ue=this.renderFeature(be,R,je,F,G,this.getLayer().getDeclutter(),Pe);C=C&&!ue}},N=m5(T),O=r.getFeaturesInExtent(N);x&&O.sort(x);for(let be=0,Pe=O.length;be<Pe;++be)P(O[be],be);this.renderedFeatures_=O,this.ready=C;const z=F.finish(),j=new h$(T,f,g,r.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=f,this.renderedRevision_=y,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=T,this.renderedCenter_=E,this.renderedProjection_=h,this.renderedPixelRatio_=g,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let u=0,h=r.length;u<h;++u)l=l4(i,e,r[u],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=l4(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let gd=0;const ls=1<<gd++,pn=1<<gd++,Ts=1<<gd++,Xa=1<<gd++,zh=1<<gd++,em=1<<gd++,Ky=Math.pow(2,gd)-1,bI={[ls]:"boolean",[pn]:"number",[Ts]:"string",[Xa]:"color",[zh]:"number[]",[em]:"size"},x$=Object.keys(bI).map(Number).sort(Pl);function v$(n){return n in bI}function tm(n){const e=[];for(const t of x$)nm(n,t)&&e.push(bI[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function nm(n,e){return(n&e)===e}function Ic(n,e){return n===e}class ti{constructor(e,t){if(!v$(e))throw new Error(`literal expressions must have a specific type, got ${tm(e)}`);this.type=e,this.value=t}}class w${constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function J5(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ni(n,e,t){switch(typeof n){case"boolean":{if(Ic(e,Ts))return new ti(Ts,n?"true":"false");if(!nm(e,ls))throw new Error(`got a boolean, but expected ${tm(e)}`);return new ti(ls,n)}case"number":{if(Ic(e,em))return new ti(em,As(n));if(Ic(e,ls))return new ti(ls,!!n);if(Ic(e,Ts))return new ti(Ts,n.toString());if(!nm(e,pn))throw new Error(`got a number, but expected ${tm(e)}`);return new ti(pn,n)}case"string":{if(Ic(e,Xa))return new ti(Xa,yI(n));if(Ic(e,ls))return new ti(ls,!!n);if(!nm(e,Ts))throw new Error(`got a string, but expected ${tm(e)}`);return new ti(Ts,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return M$(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(Ic(e,em)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new ti(em,n)}if(Ic(e,Xa)){if(n.length===3)return new ti(Xa,[...n,1]);if(n.length===4)return new ti(Xa,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!nm(e,zh))throw new Error(`got an array of numbers, but expected ${tm(e)}`);return new ti(zh,n)}const Le={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},E$={[Le.Get]:Ht(tn(1,1/0),S4),[Le.Var]:Ht(tn(1,1),S$),[Le.Has]:Ht(tn(1,1/0),S4),[Le.Id]:Ht(T$,cf),[Le.Concat]:Ht(tn(2,1/0),Rn(Ts)),[Le.GeometryType]:Ht(b$,cf),[Le.LineMetric]:Ht(cf),[Le.Resolution]:Ht(W2,cf),[Le.Zoom]:Ht(W2,cf),[Le.Time]:Ht(W2,cf),[Le.Any]:Ht(tn(2,1/0),Rn(ls)),[Le.All]:Ht(tn(2,1/0),Rn(ls)),[Le.Not]:Ht(tn(1,1),Rn(ls)),[Le.Equal]:Ht(tn(2,2),Rn(Ky)),[Le.NotEqual]:Ht(tn(2,2),Rn(Ky)),[Le.GreaterThan]:Ht(tn(2,2),Rn(pn)),[Le.GreaterThanOrEqualTo]:Ht(tn(2,2),Rn(pn)),[Le.LessThan]:Ht(tn(2,2),Rn(pn)),[Le.LessThanOrEqualTo]:Ht(tn(2,2),Rn(pn)),[Le.Multiply]:Ht(tn(2,1/0),T4),[Le.Coalesce]:Ht(tn(2,1/0),T4),[Le.Divide]:Ht(tn(2,2),Rn(pn)),[Le.Add]:Ht(tn(2,1/0),Rn(pn)),[Le.Subtract]:Ht(tn(2,2),Rn(pn)),[Le.Clamp]:Ht(tn(3,3),Rn(pn)),[Le.Mod]:Ht(tn(2,2),Rn(pn)),[Le.Pow]:Ht(tn(2,2),Rn(pn)),[Le.Abs]:Ht(tn(1,1),Rn(pn)),[Le.Floor]:Ht(tn(1,1),Rn(pn)),[Le.Ceil]:Ht(tn(1,1),Rn(pn)),[Le.Round]:Ht(tn(1,1),Rn(pn)),[Le.Sin]:Ht(tn(1,1),Rn(pn)),[Le.Cos]:Ht(tn(1,1),Rn(pn)),[Le.Atan]:Ht(tn(1,2),Rn(pn)),[Le.Sqrt]:Ht(tn(1,1),Rn(pn)),[Le.Match]:Ht(tn(4,1/0),b4,A$),[Le.Between]:Ht(tn(3,3),Rn(pn)),[Le.Interpolate]:Ht(tn(6,1/0),b4,R$),[Le.Case]:Ht(tn(3,1/0),I$,C$),[Le.In]:Ht(tn(2,2),k$),[Le.Number]:Ht(tn(1,1/0),Rn(Ky)),[Le.String]:Ht(tn(1,1/0),Rn(Ky)),[Le.Array]:Ht(tn(1,1/0),Rn(pn)),[Le.Color]:Ht(tn(1,4),Rn(pn)),[Le.Band]:Ht(tn(1,3),Rn(pn)),[Le.Palette]:Ht(tn(2,2),P$),[Le.ToString]:Ht(tn(1,1),Rn(ls|pn|Ts|Xa))};function S4(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new ti(pn,a);break}case"string":{i[s]=new ti(Ts,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function S$(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new ti(Ts,r)]}function T$(n,e,t){t.featureId=!0}function b$(n,e,t){t.geometryType=!0}function W2(n,e,t){t.mapState=!0}function cf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function tn(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function T4(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Ni(n[s+1],e,t);i[s]=a}return i}function Rn(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Ni(e[a+1],n,r);s[a]=o}return s}}function I$(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function b4(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function A$(n,e,t){const r=n.length-1,i=Ts|pn|ls,s=Ni(n[1],i,t),a=Ni(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const u=Ni(n[l+2],s.type,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+1} of match expression: ${u.message}`)}try{const u=Ni(n[l+3],a.type,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+2} of match expression: ${u.message}`)}}return[s,...o,a]}function R$(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new ti(pn,i);let a;try{a=Ni(n[2],pn,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const u=Ni(n[l+3],pn,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${u.message}`)}try{const u=Ni(n[l+4],e,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${u.message}`)}}return[s,a,...o]}function C$(n,e,t){const r=Ni(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Ni(n[s+1],ls,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Ni(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function k$(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=Ts}else i=pn;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Ni(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Ni(n[1],i,t),...s]}function P$(n,e,t){let r;try{r=Ni(n[1],pn,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Ni(i[a],Xa,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof ti))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Ht(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new w$(t,i,...s)}}function M$(n,e,t){const r=n[0],i=E$[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function eD(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return eD(n.getGeometries()[0]);default:return""}}function tD(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function ql(n,e,t){const r=Ni(n,e,t);return lo(r)}function lo(n,e){if(n instanceof ti){if(n.type===Xa&&typeof n.value=="string"){const r=yI(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case Le.Number:case Le.String:case Le.Coalesce:return N$(n);case Le.Get:case Le.Var:case Le.Has:return L$(n);case Le.Id:return r=>r.featureId;case Le.GeometryType:return r=>r.geometryType;case Le.Concat:{const r=n.args.map(i=>lo(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case Le.Resolution:return r=>r.resolution;case Le.Any:case Le.All:case Le.Between:case Le.In:case Le.Not:return D$(n);case Le.Equal:case Le.NotEqual:case Le.LessThan:case Le.LessThanOrEqualTo:case Le.GreaterThan:case Le.GreaterThanOrEqualTo:return O$(n);case Le.Multiply:case Le.Divide:case Le.Add:case Le.Subtract:case Le.Clamp:case Le.Mod:case Le.Pow:case Le.Abs:case Le.Floor:case Le.Ceil:case Le.Round:case Le.Sin:case Le.Cos:case Le.Atan:case Le.Sqrt:return F$(n);case Le.Case:return j$(n);case Le.Match:return V$(n);case Le.Interpolate:return G$(n);case Le.ToString:return B$(n);default:throw new Error(`Unsupported operator ${t}`)}}function N$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case Le.Number:case Le.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function L$(n,e){const r=n.args[0].value;switch(n.operator){case Le.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case Le.Var:return i=>i.variables[r];case Le.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function O$(n,e){const t=n.operator,r=lo(n.args[0]),i=lo(n.args[1]);switch(t){case Le.Equal:return s=>r(s)===i(s);case Le.NotEqual:return s=>r(s)!==i(s);case Le.LessThan:return s=>r(s)<i(s);case Le.LessThanOrEqualTo:return s=>r(s)<=i(s);case Le.GreaterThan:return s=>r(s)>i(s);case Le.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function D$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case Le.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case Le.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case Le.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case Le.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function F$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case Le.Divide:return s=>i[0](s)/i[1](s);case Le.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case Le.Subtract:return s=>i[0](s)-i[1](s);case Le.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case Le.Mod:return s=>i[0](s)%i[1](s);case Le.Pow:return s=>Math.pow(i[0](s),i[1](s));case Le.Abs:return s=>Math.abs(i[0](s));case Le.Floor:return s=>Math.floor(i[0](s));case Le.Ceil:return s=>Math.ceil(i[0](s));case Le.Round:return s=>Math.round(i[0](s));case Le.Sin:return s=>Math.sin(i[0](s));case Le.Cos:return s=>Math.cos(i[0](s));case Le.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case Le.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function j$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=lo(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function V$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=lo(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function G$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=lo(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let u=2;u<t;u+=2){const h=r[u](i);let f=r[u+1](i);const g=Array.isArray(f);if(g&&(f=dz(f)),h>=a)return u===2?f:g?U$(s,a,o,l,h,f):rm(s,a,o,l,h,f);o=h,l=f}return l}}function B$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.ToString:return s=>{const a=i[0](s);return n.args[0].type===Xa?_I(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function rm(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function U$(n,e,t,r,i,s){if(i-t===0)return r;const o=n4(r),l=n4(s);let u=l[2]-o[2];u>180?u-=360:u<-180&&(u+=360);const h=[rm(n,e,t,o[0],i,l[0]),rm(n,e,t,o[1],i,l[1]),o[2]+rm(n,e,t,0,i,u),rm(n,e,t,r[3],i,s[3])];return fz(h)}function z$(n){return!0}function $$(n){const e=J5(),t=W$(n,e),r=tD();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=eD(i.getGeometry())),t(r)}}function I4(n){const e=J5(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=_T(n[a],e);const i=tD(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const u=a.getId();u!==void 0?i.featureId=u:i.featureId=null}let l=0;for(let u=0;u<t;++u){const h=r[u](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function W$(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?ql(s.filter,ls,e):z$;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let u=0;u<l;++u)o[u]=_T(s.style[u],e)}else o=[_T(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const u of r[o].styles){const h=u(i);h&&s.push(h)}}}return s}}function _T(n,e){const t=rp(n,"",e),r=ip(n,"",e),i=H$(n,e),s=K$(n,e),a=bs(n,"z-index",e);if(!t&&!r&&!i&&!s&&!Fh(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new En;return function(l){let u=!0;if(t){const h=t(l);h&&(u=!1),o.setFill(h)}if(r){const h=r(l);h&&(u=!1),o.setStroke(h)}if(i){const h=i(l);h&&(u=!1),o.setText(h)}if(s){const h=s(l);h&&(u=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),u?null:o}}function rp(n,e,t){let r;if(e+"fill-pattern-src"in n)r=Z$(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=II(n,e+"fill-color",t)}if(!r)return null;const i=new er;return function(s){const a=r(s);return a===pI?null:(i.setColor(a),i)}}function ip(n,e,t){const r=bs(n,e+"stroke-width",t),i=II(n,e+"stroke-color",t);if(!r&&!i)return null;const s=Tl(n,e+"stroke-line-cap",t),a=Tl(n,e+"stroke-line-join",t),o=nD(n,e+"stroke-line-dash",t),l=bs(n,e+"stroke-line-dash-offset",t),u=bs(n,e+"stroke-miter-limit",t),h=new _r;return function(f){if(i){const g=i(f);if(g===pI)return null;h.setColor(g)}if(r&&h.setWidth(r(f)),s){const g=s(f);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(g)}if(a){const g=a(f);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(g)}return o&&h.setLineDash(o(f)),l&&h.setLineDashOffset(l(f)),u&&h.setMiterLimit(u(f)),h}}function H$(n,e){const t="text-",r=Tl(n,t+"value",e);if(!r)return null;const i=rp(n,t,e),s=rp(n,t+"background-",e),a=ip(n,t,e),o=ip(n,t+"background-",e),l=Tl(n,t+"font",e),u=bs(n,t+"max-angle",e),h=bs(n,t+"offset-x",e),f=bs(n,t+"offset-y",e),g=Kf(n,t+"overflow",e),y=Tl(n,t+"placement",e),v=bs(n,t+"repeat",e),x=Xv(n,t+"scale",e),E=Kf(n,t+"rotate-with-view",e),T=bs(n,t+"rotation",e),b=Tl(n,t+"align",e),I=Tl(n,t+"justify",e),M=Tl(n,t+"baseline",e),F=Kf(n,t+"keep-upright",e),G=nD(n,t+"padding",e),R=qv(n,t+"declutter-mode"),C=new Go({declutterMode:R});return function(P){if(C.setText(r(P)),i&&C.setFill(i(P)),s&&C.setBackgroundFill(s(P)),a&&C.setStroke(a(P)),o&&C.setBackgroundStroke(o(P)),l&&C.setFont(l(P)),u&&C.setMaxAngle(u(P)),h&&C.setOffsetX(h(P)),f&&C.setOffsetY(f(P)),g&&C.setOverflow(g(P)),y){const N=y(P);if(N!=="point"&&N!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(N)}if(v&&C.setRepeat(v(P)),x&&C.setScale(x(P)),E&&C.setRotateWithView(E(P)),T&&C.setRotation(T(P)),b){const N=b(P);if(N!=="left"&&N!=="center"&&N!=="right"&&N!=="end"&&N!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(N)}if(I){const N=I(P);if(N!=="left"&&N!=="right"&&N!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(N)}if(M){const N=M(P);if(N!=="bottom"&&N!=="top"&&N!=="middle"&&N!=="alphabetic"&&N!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(N)}return G&&C.setPadding(G(P)),F&&C.setKeepUpright(F(P)),C}}function K$(n,e){return"icon-src"in n?Y$(n,e):"shape-points"in n?X$(n,e):"circle-radius"in n?q$(n,e):null}function Y$(n,e){const t="icon-",r=t+"src",i=rD(n[r],r),s=fx(n,t+"anchor",e),a=Xv(n,t+"scale",e),o=bs(n,t+"opacity",e),l=fx(n,t+"displacement",e),u=bs(n,t+"rotation",e),h=Kf(n,t+"rotate-with-view",e),f=R4(n,t+"anchor-origin"),g=C4(n,t+"anchor-x-units"),y=C4(n,t+"anchor-y-units"),v=tW(n,t+"color"),x=J$(n,t+"cross-origin"),E=eW(n,t+"offset"),T=R4(n,t+"offset-origin"),b=gx(n,t+"width"),I=gx(n,t+"height"),M=Q$(n,t+"size"),F=qv(n,t+"declutter-mode"),G=new Zp({src:i,anchorOrigin:f,anchorXUnits:g,anchorYUnits:y,color:v,crossOrigin:x,offset:E,offsetOrigin:T,height:I,width:b,size:M,declutterMode:F});return function(R){return o&&G.setOpacity(o(R)),l&&G.setDisplacement(l(R)),u&&G.setRotation(u(R)),h&&G.setRotateWithView(h(R)),a&&G.setScale(a(R)),s&&G.setAnchor(s(R)),G}}function X$(n,e){const t="shape-",r=t+"points",i=t+"radius",s=xT(n[r],r),a=xT(n[i],i),o=rp(n,t,e),l=ip(n,t,e),u=Xv(n,t+"scale",e),h=fx(n,t+"displacement",e),f=bs(n,t+"rotation",e),g=Kf(n,t+"rotate-with-view",e),y=gx(n,t+"radius2"),v=gx(n,t+"angle"),x=qv(n,t+"declutter-mode"),E=new Yv({points:s,radius:a,radius2:y,angle:v,declutterMode:x});return function(T){return o&&E.setFill(o(T)),l&&E.setStroke(l(T)),h&&E.setDisplacement(h(T)),f&&E.setRotation(f(T)),g&&E.setRotateWithView(g(T)),u&&E.setScale(u(T)),E}}function q$(n,e){const t="circle-",r=rp(n,t,e),i=ip(n,t,e),s=bs(n,t+"radius",e),a=Xv(n,t+"scale",e),o=fx(n,t+"displacement",e),l=bs(n,t+"rotation",e),u=Kf(n,t+"rotate-with-view",e),h=qv(n,t+"declutter-mode"),f=new Ps({radius:5,declutterMode:h});return function(g){return s&&f.setRadius(s(g)),r&&f.setFill(r(g)),i&&f.setStroke(i(g)),o&&f.setDisplacement(o(g)),l&&f.setRotation(l(g)),u&&f.setRotateWithView(u(g)),a&&f.setScale(a(g)),f}}function bs(n,e,t){if(!(e in n))return;const r=ql(n[e],pn,t);return function(i){return xT(r(i),e)}}function Tl(n,e,t){if(!(e in n))return null;const r=ql(n[e],Ts,t);return function(i){return rD(r(i),e)}}function Z$(n,e,t){const r=Tl(n,e+"pattern-src",t),i=A4(n,e+"pattern-offset",t),s=A4(n,e+"pattern-size",t),a=II(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function Kf(n,e,t){if(!(e in n))return null;const r=ql(n[e],ls,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function II(n,e,t){if(!(e in n))return null;const r=ql(n[e],Xa,t);return function(i){return iD(r(i),e)}}function nD(n,e,t){if(!(e in n))return null;const r=ql(n[e],zh,t);return function(i){return Qp(r(i),e)}}function fx(n,e,t){if(!(e in n))return null;const r=ql(n[e],zh,t);return function(i){const s=Qp(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function A4(n,e,t){if(!(e in n))return null;const r=ql(n[e],zh,t);return function(i){return sD(r(i),e)}}function Xv(n,e,t){if(!(e in n))return null;const r=ql(n[e],zh|pn,t);return function(i){return nW(r(i),e)}}function gx(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function Q$(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return As(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function J$(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function R4(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function C4(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function eW(n,e){const t=n[e];if(t!==void 0)return Qp(t,e)}function qv(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function tW(n,e){const t=n[e];if(t!==void 0)return iD(t,e)}function Qp(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function rD(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function xT(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function iD(n,e){if(typeof n=="string")return n;const t=Qp(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function sD(n,e){const t=Qp(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function nW(n,e){return typeof n=="number"?n:sD(n,e)}const Ua={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function k4(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,u=e?0:s[1]*i,h=o?o[0]:0,f=o?o[1]:0;let g=n[0]+l/2+h,y=n[2]-l/2+h,v=n[1]+u/2+f,x=n[3]-u/2+f;g>y&&(g=(y+g)/2,y=g),v>x&&(v=(x+v)/2,x=v);let E=lr(r[0],g,y),T=lr(r[1],v,x);if(a&&t&&i){const b=30*i;E+=-b*Math.log(1+Math.max(0,g-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-y)/b),T+=-b*Math.log(1+Math.max(0,v-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-x)/b)}return[E,T]})}function rW(n){return n}function aD(n){return Math.pow(n,3)}function V0(n){return 1-aD(1-n)}function iW(n){return 3*n*n-2*n*n*n}function sW(n){return n}function AI(n,e,t,r){const i=un(e)/t[0],s=Hr(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function RI(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),lr(r,t/2,e*2)}function aW(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],u=n[n.length-1],h=t?AI(l,t,a,r):l;if(o)return e?RI(i,h,u):lr(i,u,h);const f=Math.min(h,i),g=Math.floor(Ov(n,f,s));return n[g]>h&&g<n.length-1?n[g+1]:n[g]}})}function oW(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,u){if(a!==void 0){const h=i?AI(e,i,l,s):e;if(u)return r?RI(a,h,t):lr(a,t,h);const f=1e-9,g=Math.ceil(Math.log(e/h)/Math.log(n)-f),y=-o*(.5-f)+.5,v=Math.min(h,a),x=Math.floor(Math.log(e/v)/Math.log(n)+y),E=Math.max(g,x),T=e/Math.pow(n,E);return lr(T,t,h)}})}function P4(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const u=r?AI(n,r,o,i):n;return!t||!l?lr(s,e,u):RI(s,u,e)}})}function CI(n){if(n!==void 0)return 0}function M4(n){if(n!==void 0)return n}function lW(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function cW(n){const e=Nl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const uW=42,kI=256,H2=0;class Oo extends il{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=aI(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&g5(),e.center&&(e.center=Sl(e.center,this.projection_)),e.extent&&(e.extent=Do(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in Ua)delete t[o];this.setProperties(t,!0);const r=dW(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=hW(e),s=r.constraint,a=fW(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Sl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Sl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&Yy(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const u=[];for(;i<t;++i){const h=arguments[i],f={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||iW,callback:r};if(h.center&&(f.sourceCenter=a,f.targetCenter=h.center.slice(),a=f.targetCenter),h.zoom!==void 0?(f.sourceResolution=o,f.targetResolution=this.getResolutionForZoom(h.zoom),o=f.targetResolution):h.resolution&&(f.sourceResolution=o,f.targetResolution=h.resolution,o=f.targetResolution),h.rotation!==void 0){f.sourceRotation=l;const g=eu(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=l+g,l=f.targetRotation}gW(f)?f.complete=!0:s+=f.duration,u.push(f)}this.animations_.push(u),this.setHint(di.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[di.ANIMATING]>0}getInteracting(){return this.hints_[di.INTERACTING]>0}cancelAnimations(){this.setHint(di.ANIMATING,-this.hints_[di.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&Yy(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const u=e-l.start;let h=l.duration>0?u/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const f=l.easing(h);if(l.sourceCenter){const g=l.sourceCenter[0],y=l.sourceCenter[1],v=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const E=g+f*(v-g),T=y+f*(x-y);this.targetCenter_=[E,T]}if(l.sourceResolution&&l.targetResolution){const g=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(g,0,y,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const g=f===1?eu(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(g,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=g}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(di.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&Yy(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],nI(r,e-this.getRotation()),sU(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&uT(e,this.getProjection())}getCenterInternal(){return this.get(Ua.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return m5(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Fn(t,"The view center is not defined");const r=this.getResolution();Fn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return Fn(i!==void 0,"The view rotation is not defined"),ex(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Ua.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Do(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=un(e)/t[0],i=Hr(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(Ua.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=K2(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=Ov(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=lr(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,lr(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(Fn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Fn(!j0(e),"Cannot fit empty extent provided as `geometry`");const i=Do(e,this.getProjection());r=u4(i)}else if(e.getType()==="Circle"){const i=Do(e.getExtent(),this.getProjection());r=u4(i),r.rotate(this.getRotation(),Xo(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,u=-1/0,h=-1/0;for(let f=0,g=s.length;f<g;f+=a){const y=s[f]*r-s[f+1]*i,v=s[f]*i+s[f+1]*r;o=Math.min(o,y),l=Math.min(l,v),u=Math.max(u,y),h=Math.max(h,v)}return[o,l,u,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),h=Math.sin(u),f=Math.cos(u),g=Xo(o);g[0]+=(i[1]-i[3])/2*l,g[1]+=(i[0]-i[2])/2*l;const y=g[0]*f-g[1]*h,v=g[1]*f+g[0]*h,x=this.getConstrainedCenter([y,v],l),E=t.callback?t.callback:Ym;t.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:t.duration,easing:t.easing},E):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),Yy(E,!0))}centerOn(e,t,r){this.centerOnInternal(Sl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(K2(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=K2(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=uT(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Sl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Sl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Sl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(Ua.ROTATION)!==i&&this.set(Ua.ROTATION,i),this.get(Ua.RESOLUTION)!==a&&(this.set(Ua.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(Ua.CENTER)||!nx(this.get(Ua.CENTER),o))&&this.set(Ua.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!nx(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:V0,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(di.INTERACTING,1)}endInteraction(e,t,r){r=r&&Sl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(di.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function Yy(n,e){setTimeout(function(){n(e)},0)}function hW(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return k4(n.extent,n.constrainOnlyCenter,t)}const e=aI(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,k4(t,!1,!1)}return rW}function dW(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:H2,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,u=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,f=n.showFullExtent!==void 0?n.showFullExtent:!1,g=aI(n.projection,"EPSG:3857"),y=g.getExtent();let v=n.constrainOnlyCenter,x=n.extent;if(!u&&!x&&g.isGlobal()&&(v=!1,x=y),n.resolutions!==void 0){const E=n.resolutions;t=E[a],r=E[o]!==void 0?E[o]:E[E.length-1],n.constrainResolution?e=aW(E,h,!v&&x,f):e=P4(t,r,h,!v&&x,f)}else{const T=(y?Math.max(un(y),Hr(y)):360*d0.degrees/g.getMetersPerUnit())/kI/Math.pow(2,H2),b=T/Math.pow(2,28-H2);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=oW(l,t,r,h,!v&&x,f):e=P4(t,r,h,!v&&x,f)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function fW(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?cW():t===!1?M4:typeof t=="number"?lW(t):M4}return CI}function gW(n){return!(n.sourceCenter&&n.targetCenter&&!nx(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function K2(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const u=o*s-l*a,h=l*s+o*a;return[u,h]}const Bn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class oD extends il{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Bn.OPACITY]=e.opacity!==void 0?e.opacity:1,Fn(typeof t[Bn.OPACITY]=="number","Layer opacity must be a number"),t[Bn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Bn.Z_INDEX]=e.zIndex,t[Bn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Bn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Bn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Bn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=lr(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Ut()}getLayerStatesArray(e){return Ut()}getExtent(){return this.get(Bn.EXTENT)}getMaxResolution(){return this.get(Bn.MAX_RESOLUTION)}getMinResolution(){return this.get(Bn.MIN_RESOLUTION)}getMinZoom(){return this.get(Bn.MIN_ZOOM)}getMaxZoom(){return this.get(Bn.MAX_ZOOM)}getOpacity(){return this.get(Bn.OPACITY)}getSourceState(){return Ut()}getVisible(){return this.get(Bn.VISIBLE)}getZIndex(){return this.get(Bn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Bn.EXTENT,e)}setMaxResolution(e){this.set(Bn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Bn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Bn.MAX_ZOOM,e)}setMinZoom(e){this.set(Bn.MIN_ZOOM,e)}setOpacity(e){Fn(typeof e=="number","Layer opacity must be a number"),this.set(Bn.OPACITY,e)}setVisible(e){this.set(Bn.VISIBLE,e)}setZIndex(e){this.set(Bn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Jp extends oD{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Bn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Bn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(rr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=_n(e,Yt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Oo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return PI(i,t.viewState)&&(!s||cs(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Oo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Bn.MAP,e)}getMapInternal(){return this.get(Bn.MAP)}setMap(e){this.mapPrecomposeKey_&&(rr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(rr(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=_n(e,Ta.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=_n(this,Yt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);Fn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Bn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function PI(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const N4={RENDER_ORDER:"renderOrder"};class lD extends Jp{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(N4.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new K5(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(N4.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Y5:e;const t=mW(e);this.styleFunction_=e===null?void 0:Zz(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function mW(n){if(n===void 0)return Y5;if(!n)return null;if(typeof n=="function"||n instanceof En)return n;if(!Array.isArray(n))return I4([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof En){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof En))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return $$(i)}return I4(n)}class md extends lD{constructor(e){super(e)}createRenderer(){return new _$(this)}}const Ac={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Fc extends rl{constructor(e,t){super(e),this.layer=t}}const Y2={LAYERS:"layers"};let Zv=class cD extends oD{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Y2.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Sa(r.slice(),{unique:!0}):Fn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Sa(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(rr),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(_n(e,Es.ADD,this.handleLayersAdd_,this),_n(e,Es.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(rr);Bp(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new Fc(Ac.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[_n(e,u0.PROPERTYCHANGE,this.handleLayerChange_,this),_n(e,Yt.CHANGE,this.handleLayerChange_,this)];e instanceof cD&&t.push(_n(e,Ac.ADDLAYER,this.handleLayerGroupAdd_,this),_n(e,Ac.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[In(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Fc(Ac.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Fc(Ac.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Fc(Ac.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=In(t);this.listenerKeys_[r].forEach(rr),delete this.listenerKeys_[r],this.dispatchEvent(new Fc(Ac.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(Y2.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new Fc(Ac.REMOVELAYER,r[i]))}this.set(Y2.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Ml(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const Ft={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class MI extends Up{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Yt.CHANGE)}release(){this.setState(Ft.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ft.EMPTY){if(this.state!==Ft.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Ut()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:aD(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function vT(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const pW=new Error("disposed"),yW=[256,256];class L4 extends MI{constructor(e){const t=Ft.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=vT(this.data_);return e?[e.width,e.height]:yW}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ft.IDLE&&this.state!==Ft.ERROR)return;this.state=Ft.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ft.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ft.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(pW),this.controller_=null),super.disposeInternal()}}class uD extends MI{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,Qs?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ft.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ft.ERROR,this.unlistenImage_(),this.image_=_W(),this.changed()}handleImageLoad_(){if(Qs)this.state=Ft.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ft.LOADED:this.state=Ft.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ft.ERROR&&(this.state=Ft.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ft.IDLE&&(this.state=Ft.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=gz(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function _W(){const n=ri(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let X2;const Yf=[];function O4(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function q2(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function xW(){if(X2===void 0){const n=ri(6,6,Yf);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",O4(n,4,5,4,0),O4(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;X2=q2(e,0)||q2(e,4)||q2(e,8),Hv(n),Yf.push(n.canvas)}return X2}function mx(n,e,t,r){const i=Kp(t,e,n);let s=ax(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||jh(l,i)){const u=ax(n,s,i)/s;isFinite(u)&&u>0&&(s/=u)}return s}function vW(n,e,t,r){const i=Xo(t);let s=mx(n,e,i,r);return(!isFinite(s)||s<=0)&&t5(t,function(a){return s=mx(n,e,a,r),isFinite(s)&&s>0}),s}function hD(n,e,t,r,i,s,a,o,l,u,h,f,g,y){const v=ri(Math.round(t*n),Math.round(t*e),Yf);if(f||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(t,t);function x(F){return Math.round(F*t)/t}v.globalCompositeOperation="lighter";const E=ta();l.forEach(function(F,G,R){JO(E,F.extent)});let T;const b=t/r,I=(f?1:1+Math.pow(2,-24))/b;(!g||l.length!==1||u!==0)&&(T=ri(Math.round(un(E)*b),Math.round(Hr(E)*b),Yf),f||(T.imageSmoothingEnabled=!1),l.forEach(function(F,G,R){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){T.save();const z=(F.clipExtent[0]-E[0])*b,j=-(F.clipExtent[3]-E[3])*b,be=un(F.clipExtent)*b,Pe=Hr(F.clipExtent)*b;T.rect(f?z:Math.round(z),f?j:Math.round(j),f?be:Math.round(z+be)-Math.round(z),f?Pe:Math.round(j+Pe)-Math.round(j)),T.clip()}const C=(F.extent[0]-E[0])*b,P=-(F.extent[3]-E[3])*b,N=un(F.extent)*b,O=Hr(F.extent)*b;T.drawImage(F.image,u,u,F.image.width-2*u,F.image.height-2*u,f?C:Math.round(C),f?P:Math.round(P),f?N:Math.round(C+N)-Math.round(C),f?O:Math.round(P+O)-Math.round(P)),F.clipExtent&&T.restore()}}));const M=cd(a);return o.getTriangles().forEach(function(F,G,R){const C=F.source,P=F.target;let N=C[0][0],O=C[0][1],z=C[1][0],j=C[1][1],be=C[2][0],Pe=C[2][1];const je=x((P[0][0]-M[0])/s),Ne=x(-(P[0][1]-M[1])/s),ue=x((P[1][0]-M[0])/s),Te=x(-(P[1][1]-M[1])/s),le=x((P[2][0]-M[0])/s),se=x(-(P[2][1]-M[1])/s),V=N,Q=O;N=0,O=0,z-=V,j-=Q,be-=V,Pe-=Q;const ne=[[z,j,0,0,ue-je],[be,Pe,0,0,le-je],[0,0,z,j,Te-Ne],[0,0,be,Pe,se-Ne]],ie=iU(ne);if(!ie)return;if(v.save(),v.beginPath(),xW()||!f){v.moveTo(ue,Te);const De=4,Be=je-ue,Ue=Ne-Te;for(let _e=0;_e<De;_e++)v.lineTo(ue+x((_e+1)*Be/De),Te+x(_e*Ue/(De-1))),_e!=De-1&&v.lineTo(ue+x((_e+1)*Be/De),Te+x((_e+1)*Ue/(De-1)));v.lineTo(le,se)}else v.moveTo(ue,Te),v.lineTo(je,Ne),v.lineTo(le,se);v.clip(),v.transform(ie[0],ie[2],ie[1],ie[3],je,Ne),v.translate(E[0]-V,E[3]-Q);let pe;if(T)pe=T.canvas,v.scale(I,-I);else{const De=l[0],Be=De.extent;pe=De.image,v.scale(un(Be)/pe.width,-Hr(Be)/pe.height)}v.drawImage(pe,0,0),v.restore()}),T&&(Hv(T),Yf.push(T.canvas)),h&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,o.getTriangles().forEach(function(F,G,R){const C=F.target,P=(C[0][0]-M[0])/s,N=-(C[0][1]-M[1])/s,O=(C[1][0]-M[0])/s,z=-(C[1][1]-M[1])/s,j=(C[2][0]-M[0])/s,be=-(C[2][1]-M[1])/s;v.beginPath(),v.moveTo(O,z),v.lineTo(P,N),v.lineTo(j,be),v.closePath(),v.stroke()}),v.restore()),v.canvas}const wW=10,D4=.25;class dD{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const u=o?cT(I=>ni(o,Kp(I,this.targetProj_,this.sourceProj_))):qm(this.targetProj_,this.sourceProj_);this.transformInv_=function(I){const M=I[0]+"/"+I[1];return l[M]||(l[M]=u(I)),l[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&un(i)>=un(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?un(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?un(this.targetProj_.getExtent()):null;const h=cd(r),f=Vv(r),g=jv(r),y=Fv(r),v=this.transformInv_(h),x=this.transformInv_(f),E=this.transformInv_(g),T=this.transformInv_(y),b=wW+(a?Math.max(0,Math.ceil(Math.log2(iT(r)/(a*a*256*256)))):0);if(this.addQuad_(h,f,g,y,v,x,E,T,b),this.wrapsXInSource_){let I=1/0;this.triangles_.forEach(function(M,F,G){I=Math.min(I,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-I>this.sourceWorldWidth_/2){const F=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];F[0][0]-I>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-I>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-I>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const G=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-G<this.sourceWorldWidth_/2&&(M.source=F)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,u){const h=BP([s,a,o,l]),f=this.sourceWorldWidth_?un(h)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&f>.5&&f<1;let v=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=BP([e,t,r,i]);v=un(E)/this.targetWorldWidth_>D4||v}!y&&this.sourceProj_.isGlobal()&&f&&(v=f>D4||v)}if(!v&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!cs(h,this.maxSourceExtent_))return;let x=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)v=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(u>0){if(!v){const E=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(E);let b;y?b=(eu(s[0],g)+eu(o[0],g))/2-eu(T[0],g):b=(s[0]+o[0])/2-T[0];const I=(s[1]+o[1])/2-T[1];v=b*b+I*I>this.errorThresholdSquared_}if(v){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const E=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(E),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],I=this.transformInv_(b);this.addQuad_(e,t,E,b,s,a,T,I,u-1),this.addQuad_(b,E,r,i,I,T,o,l,u-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(E),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],I=this.transformInv_(b);this.addQuad_(e,E,b,i,s,T,I,l,u-1),this.addQuad_(E,t,r,b,T,a,o,I,u-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,o,l),(x&14)==0&&this.addTriangle_(e,r,t,s,o,a),x&&((x&13)==0&&this.addTriangle_(t,i,e,a,l,s),(x&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=ta();return this.triangles_.forEach(function(t,r,i){const s=t.source;pm(e,s[0]),pm(e,s[1]),pm(e,s[2])}),e}getTriangles(){return this.triangles_}}const fD=.5;class gD extends MI{constructor(e,t,r,i,s,a,o,l,u,h,f,g){super(s,Ft.IDLE,g),this.renderEdges_=f!==void 0?f:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const E=v?Ml(y,v):y;if(iT(E)===0){this.state=Ft.EMPTY;return}const T=e.getExtent();T&&(x?x=Ml(x,T):x=T);const b=i.getResolution(this.wrappedTileCoord_[0]),I=vW(e,r,E,b);if(!isFinite(I)||I<=0){this.state=Ft.EMPTY;return}const M=h!==void 0?h:fD;if(this.triangulation_=new dD(e,r,E,x,I*M,b),this.triangulation_.getTriangles().length===0){this.state=Ft.EMPTY;return}this.sourceZ_=t.getZForResolution(I);let F=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(F[1]=lr(F[1],x[1],x[3]),F[3]=lr(F[3],x[1],x[3])):F=Ml(F,x)),!iT(F))this.state=Ft.EMPTY;else{let G=0,R=0;e.canWrapX()&&(G=un(T),R=Math.floor((F[0]-T[0])/G)),i5(F.slice(),e,!0).forEach(P=>{const N=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let O=N.minX;O<=N.maxX;O++)for(let z=N.minY;z<=N.maxY;z++){const j=u(this.sourceZ_,O,z,o);if(j){const be=R*G;this.sourceTiles_.push({tile:j,offset:be})}}++R}),this.sourceTiles_.length===0&&(this.state=Ft.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==Ft.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ft.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=hD(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ft.LOADED}this.changed()}load(){if(this.state==Ft.IDLE){this.state=Ft.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==Ft.IDLE||r==Ft.LOADING){e++;const i=_n(t,Yt.CHANGE,s=>{const a=t.getState();(a==Ft.LOADED||a==Ft.ERROR||a==Ft.EMPTY)&&(rr(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==Ft.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(rr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Hv(this.canvas_.getContext("2d")),Yf.push(this.canvas_),this.canvas_=null),super.release()}}class NI{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function uf(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new NI(n,e,t,r)}class F4{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Lv&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return Fn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return Fn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Fn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function px(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function EW(n,e,t){return n+"/"+e+"/"+t}function A_(n,e,t,r,i){return`${In(n)},${e},${EW(t,r,i)}`}function mD(n){return SW(n[0],n[1],n[2])}function SW(n,e,t){return(e<<n)+t}function TW(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class bW extends TI{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Ml(l,Do(t.extent,i.projection))),!o[di.ANIMATING]&&!o[di.INTERACTING]&&!j0(l))if(a){const u=i.projection,h=a.getImage(l,s,r,u);h&&(this.loadImage(h)?this.image=h:h.getState()===vt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=ni(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!jh(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=un(a),u=Math.floor(o.width*((i[0]-a[0])/l));if(u<0||u>=o.width)return null;const h=Hr(a),f=Math.floor(o.height*((a[3]-i[1])/h));return f<0||f>=o.height?null:this.getImageData(o,u,f)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),u=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,f=e.viewState,g=f.center,y=f.resolution,v=h*a/(y*l),x=h*o/(y*l);this.prepareContainer(e,t);const E=this.context.canvas.width,T=this.context.canvas.height,b=this.getRenderContext(e);let I=!1,M=!0;if(u.extent){const P=Do(u.extent,f.projection);M=cs(P,e.extent),I=M&&!zc(P,e.extent),I&&this.clipUnrotated(b,e,P)}const F=r.getImage(),G=qo(this.tempTransform,E/2,T/2,v,x,0,l*(i[0]-g[0])/a,l*(g[1]-i[3])/o);this.renderedResolution=o*h/l;const R=F.width*G[0],C=F.height*G[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),M&&R>=.5&&C>=.5){const P=G[4],N=G[5],O=u.opacity;O!==1&&(b.save(),b.globalAlpha=O),b.drawImage(F,0,0,+F.width,+F.height,P,N,R,C),O!==1&&b.restore()}return this.postRender(this.context,e),I&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class IW extends Jp{constructor(e){e=e||{},super(e)}}class AW extends IW{constructor(e){super(e)}createRenderer(){return new bW(this)}getData(e){return super.getData(e)}}function Z2(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function RW(n,e,t){const r=n[t];return r?r.delete(e):!1}function j4(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Ml(e,Do(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Ml(e,i))}return e}class CW extends TI{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=ta(),this.tempTileRange_=new NI(0,0,0,0),this.tempTileCoord_=px(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new F4(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new F4(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=A_(o,o.getKey(),e,t,r);let u;if(s.containsKey(l))u=s.get(l);else{const h=i.viewState.projection,f=o.getProjection();if(u=o.getTile(e,t,r,i.pixelRatio,h,!f||Ch(f,h)?void 0:this.getSourceTileCache()),!u)return null;s.set(l,u)}return u}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=ni(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!jh(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),u=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const f=l.getTileCoordForCoordAndZ(i,h),g=this.getTile(h,f[1],f[2],t);if(!g||g.getState()!==Ft.LOADED)continue;const y=l.getOrigin(h),v=As(l.getTileSize(h)),x=l.getResolution(h);let E;if(g instanceof uD||g instanceof gD)E=g.getImage();else if(g instanceof L4){if(E=vT(g.getData()),!E)continue}else continue;const T=Math.floor(u*((i[0]-y[0])/x-f[1]*v[0])),b=Math.floor(u*((y[1]-i[1])/x-f[2]*v[1])),I=Math.round(u*o.getGutterForProjection(a.projection));return this.getImageData(E,T+I,b+I)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),u=l.getTileGridForProjection(a.projection),h=In(l);h in e.wantedTiles||(e.wantedTiles[h]={});const f=e.wantedTiles[h],g=o.getMapInternal(),y=Math.max(r-s,u.getMinZoom(),u.getZForResolution(Math.min(o.getMaxResolution(),g?g.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):u.getResolution(0)),l.zDirection)),v=a.rotation,x=v?n5(a.center,a.resolution,v,e.size):void 0;for(let E=r;E>=y;--E){const T=u.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),b=u.getResolution(E);for(let I=T.minX;I<=T.maxX;++I)for(let M=T.minY;M<=T.maxY;++M){if(v&&!u.tileCoordIntersectsViewport([E,I,M],x))continue;const F=this.getTile(E,I,M,e);if(!F||!Z2(i,F,E))continue;const R=F.getKey();if(f[R]=!0,F.getState()===Ft.IDLE&&!e.tileQueue.isKeyQueued(R)){const C=px(E,I,M,this.tempTileCoord_);e.tileQueue.enqueue([F,h,u.getTileCoordCenter(C),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const u=A_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(u)){const h=r.peek(u);if(h.getState()===Ft.LOADED)return h.endTransition(In(this)),Z2(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),u=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let f=s.minY;f<=s.maxY;++f){const g=A_(l,u,r,h,f);let y=!1;if(o.containsKey(g)){const v=o.peek(g);v.getState()===Ft.LOADED&&(Z2(i,v,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,u=this.getLayer(),h=u.getSource(),f=h.getTileGridForProjection(s),g=f.getZForResolution(a,h.zDirection),y=f.getResolution(g),v=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let x=e.extent;const E=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,b=this.context.canvas.height,I=r.extent&&Do(r.extent);I&&(x=Ml(x,Do(r.extent)));const M=y*T/2/E,F=y*b/2/E,G=[o[0]-M,o[1]-F,o[0]+M,o[1]+F],R={};this.renderedTiles.length=0;const C=u.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ue=f.getZForResolution(i.nextResolution,h.zDirection),Te=j4(e,e.nextExtent);this.enqueueTiles(e,Te,ue,R,C)}const P=j4(e,x);if(this.enqueueTiles(e,P,g,R,0),C>0&&setTimeout(()=>{this.enqueueTiles(e,P,g-1,R,C-1)},0),!(g in R))return this.container;const N=In(this),O=e.time;for(const ue of R[g]){const Te=ue.getState();if(Te===Ft.EMPTY)continue;const le=ue.tileCoord;if(Te===Ft.LOADED&&ue.getAlpha(N,O)===1){ue.endTransition(N);continue}if(Te!==Ft.ERROR&&(this.renderComplete=!1),this.findStaleTile_(le,R)){RW(R,ue,g),e.animate=!0;continue}if(this.findAltTiles_(f,le,g+1,R))continue;const Q=f.getMinZoom();for(let ne=g-1;ne>=Q&&!this.findAltTiles_(f,le,ne,R);--ne);}const z=y/a*l/E,j=this.getRenderContext(e);qo(this.tempTransform,T/2,b/2,z,z,0,-T/2,-b/2),r.extent&&this.clipUnrotated(j,e,I),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const be=Object.keys(R).map(Number);be.sort(Pl);let Pe;const je=[],Ne=[];for(let ue=be.length-1;ue>=0;--ue){const Te=be[ue],le=h.getTilePixelSize(Te,l,s),V=f.getResolution(Te)/y,Q=le[0]*V*z,ne=le[1]*V*z,ie=f.getTileCoordForCoordAndZ(cd(G),Te),pe=f.getTileCoordExtent(ie),De=ni(this.tempTransform,[E*(pe[0]-G[0])/y,E*(G[3]-pe[3])/y]),Be=E*h.getGutterForProjection(s);for(const Ue of R[Te]){if(Ue.getState()!==Ft.LOADED)continue;const _e=Ue.tileCoord,Ct=ie[1]-_e[1],kt=Math.round(De[0]-(Ct-1)*Q),hn=ie[2]-_e[2],Mt=Math.round(De[1]-(hn-1)*ne),jn=Math.round(De[0]-Ct*Q),Qt=Math.round(De[1]-hn*ne),ot=kt-jn,Zn=Mt-Qt,on=be.length===1;let en=!1;Pe=[jn,Qt,jn+ot,Qt,jn+ot,Qt+Zn,jn,Qt+Zn];for(let Qn=0,mt=je.length;Qn<mt;++Qn)if(!on&&Te<Ne[Qn]){const Bt=je[Qn];cs([jn,Qt,jn+ot,Qt+Zn],[Bt[0],Bt[3],Bt[4],Bt[7]])&&(en||(j.save(),en=!0),j.beginPath(),j.moveTo(Pe[0],Pe[1]),j.lineTo(Pe[2],Pe[3]),j.lineTo(Pe[4],Pe[5]),j.lineTo(Pe[6],Pe[7]),j.moveTo(Bt[6],Bt[7]),j.lineTo(Bt[4],Bt[5]),j.lineTo(Bt[2],Bt[3]),j.lineTo(Bt[0],Bt[1]),j.clip())}je.push(Pe),Ne.push(Te),this.drawTile(Ue,e,jn,Qt,ot,Zn,Be,on),en&&j.restore(),this.renderedTiles.unshift(Ue),this.updateUsedTiles(e.usedTiles,h,Ue)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!h0(this.renderedExtent_,G),this.renderedExtent_=G,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const ue=(Te,le)=>{const se=In(h),V=le.wantedTiles[se],Q=V?Object.keys(V).length:0;this.updateCacheSize(Q),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ue)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let u;if(e instanceof L4){if(u=vT(e.getData()),!u)throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(!u)return;const h=this.getRenderContext(t),f=In(this),g=t.layerStatesArray[t.layerIndex],y=g.opacity*(l?e.getAlpha(f,t.time):1),v=y!==h.globalAlpha;v&&(h.save(),h.globalAlpha=y),h.drawImage(u,o,o,u.width-2*o,u.height-2*o,r,i,s,a),v&&h.restore(),y!==g.opacity?t.animate=!0:l&&e.endTransition(f)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=In(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Xy={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class kW extends Jp{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Xy.PRELOAD)}setPreload(e){this.set(Xy.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Xy.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Xy.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class sh extends kW{constructor(e){super(e)}createRenderer(){return new CW(this,{cacheSize:this.getCacheSize()})}}function wT(n){return Array.isArray(n)?Math.min(...n):n}const hf=[0,0,0],Rc=5;class pD{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Fn(XB(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Fn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=cd(r)),Fn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Fn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:kI,Fn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new NI(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,u=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);u>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=uf(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,u,r),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return uf(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return uf(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),u=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return uf(u,u,h,h,r);const f=Math.floor(l*(s+1))-1,g=Math.floor(l*(a+1))-1;return uf(u,f,h,g,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,hf);const i=hf[1],s=hf[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,hf);const a=hf[1],o=hf[2];return uf(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=As(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=As(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,u=o+s[1]*i;return cu(a,o,l,u,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),u=As(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/u[0],f=o*(l[1]-t)/r/u[1];return i?(h=$c(h,Rc)-1,f=$c(f,Rc)-1):(h=Gy(h,Rc),f=Gy(f,Rc)),px(a,h,f,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=As(this.getTileSize(r),this.tmpSize_);let u=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(u=$c(u,Rc)-1,h=$c(h,Rc)-1):(u=Gy(u,Rc),h=Gy(h,Rc)),px(r,u,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=Ov(this.resolutions_,e,t||0);return lr(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return w5(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function yD(n){let e=n.getDefaultTileGrid();return e||(e=LW(n),n.setDefaultTileGrid(e)),e}function PW(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=LI(t);if(!jh(s,i)){const a=un(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function MW(n,e,t,r){r=r!==void 0?r:"top-left";const i=_D(n,e,t);return new pD({extent:n,origin:eU(n,r),resolutions:i,tileSize:t})}function NW(n){const e=n||{},t=e.extent||qn("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:_D(t,e.maxZoom,e.tileSize,e.maxResolution)};return new pD(r)}function _D(n,e,t,r){e=e!==void 0?e:uW,t=As(t!==void 0?t:kI);const i=Hr(n),s=un(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function LW(n,e,t,r){const i=LI(n);return MW(i,e,t,r)}function LI(n){n=qn(n);let e=n.getExtent();if(!e){const t=180*d0.degrees/n.getMetersPerUnit();e=cu(-t,-t,t,t)}return e}function OI(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const OW=/\{z\}/g,DW=/\{x\}/g,FW=/\{y\}/g,jW=/\{-y\}/g;function VW(n,e,t,r,i){return n.replace(OW,e.toString()).replace(DW,t.toString()).replace(FW,r.toString()).replace(jW,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function GW(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function BW(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return VW(n,a,t[1],t[2],s)})}function UW(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=BW(n[i],e);return zW(r)}function zW(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=mD(e),s=eu(i,n.length);return n[s](e,t,r)})}class $W extends SI{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&As(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||In(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Ut()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:yD(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=As(i.getTileSize(e),this.tmpSize);return s==1?a:qz(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=PW(i,e,r)),TW(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class WW extends rl{constructor(e,t){super(e),this.tile=t}}const Q2={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class DI extends $W{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===DI.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=In(t),i=t.getState();let s;i==Ft.LOADING?(this.tileLoadingKeys_[r]=!0,s=Q2.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==Ft.ERROR?Q2.TILELOADERROR:i==Ft.LOADED?Q2.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new WW(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=GW(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(UW(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class xD extends DI{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:vD,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:uD,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Ch(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Ch(t,e)))return this.tileGrid;const r=In(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=yD(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),u=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,u!==void 0?Ft.IDLE:Ft.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Yt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Ch(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],u=this.getKey(),h=this.getTileGridForProjection(o),f=this.getTileGridForProjection(s),g=this.getTileCoordForTileUrlFunction(l,s),y=new gD(o,h,s,f,l,g,this.getTilePixelRatio(i),this.getGutter(),(v,x,E,T)=>this.getTileInternal(v,x,E,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=u,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=A_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const u=this.createTile_(e,t,r,i,s,o);return a?.set(l,u),u}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=qn(e);if(r){const i=In(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function vD(n,e){if(Qs){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class bf extends xD{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:NW({extent:LI(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const HW="modulepreload",KW=function(n){return"/detectorapp-nl/"+n},V4={},pt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(u=>{if(u=KW(u),u in V4)return;V4[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":HW,h||(g.as="script"),g.crossOrigin="",g.href=u,o&&g.setAttribute("nonce",o),document.head.appendChild(g),h)return new Promise((y,v)=>{g.addEventListener("load",y),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class YW extends k5{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let u=t.getExtent();u&&t.canWrapX()&&(u=u.slice(),u[0]=-1/0,u[2]=1/0);const h=u?Ml(r,u):r,f=Xo(h),g=mx(e,t,f,i),y=fD,v=new dD(e,t,h,l,g*y,i),x=v.calculateSourceExtent(),E=j0(x)?null:a(x,g,s),T=E?vt.IDLE:vt.EMPTY,b=E?E.getPixelRatio():1;super(r,i,b,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=E,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==vt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==vt.LOADED){const t=un(this.targetExtent_)/this.targetResolution_,r=Hr(this.targetExtent_)/this.targetResolution_;this.canvas_=hD(t,r,this.sourcePixelRatio_,wT(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==vt.IDLE){this.state=vt.LOADING,this.changed();const e=this.sourceImage_.getState();e==vt.LOADED||e==vt.ERROR?this.reproject_():(this.sourceListenerKey_=_n(this.sourceImage_,Yt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==vt.LOADED||r==vt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){rr(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Yc=4,J2={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class XW extends rl{constructor(e,t){super(e),this.image=t}}class qW extends SI{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=Ov(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Ch(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ch(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&h0(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new YW(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=wD(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&zc(this.wantedExtent_,s)||zc(this.image.getExtent(),s))&&(this.wantedResolution_&&wT(this.wantedResolution_)===a||wT(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new k5(s,a,r,this.loader),this.image.addEventListener(Yt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case vt.LOADING:this.loading=!0,r=J2.IMAGELOADSTART;break;case vt.LOADED:this.loading=!1,r=J2.IMAGELOADEND;break;case vt.ERROR:this.loading=!1,r=J2.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new XW(r,t))}}function ZW(n,e){n.getImage().src=e}function wD(n,e,t,r){const i=e/t,s=Xo(n),a=$c(un(n)/i,Yc),o=$c(Hr(n)/i,Yc),l=$c((r-1)*a/2,Yc),u=a+2*l,h=$c((r-1)*o/2,Yc),f=o+2*h;return ex(s,i,0,[u,f])}function QW(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[tx(un(e)/o,Yc),tx(Hr(e)/o,Yc)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const u=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return OI(u,s)}function JW(n){const e=n.load?n.load:M5,t=qn(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=wD(s,a,o,r);const u=QW(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,u).then(f=>{const g=un(s)/f.width*o;return{image:f,extent:s,resolution:g,pixelRatio:o}})}}class eH extends qW{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:ZW,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=JW({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),M5(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const ET="1.3.0";function tH(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=s5(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),OI(n,i)}function nH(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[tx(un(n)/o,Yc),tx(Hr(n)/o,Yc)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return tH(i,n,l,r,s)}function G4(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:ET,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const rH='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class iH extends bf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[rH];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!Qs&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||vD)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const yx=1/0;class sH{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Bp(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){Fn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=yx?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),h=u<i&&r[u]<r[l]?u:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==yx?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class aH extends sH{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Yt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===Ft.LOADED||r===Ft.ERROR||r===Ft.EMPTY){r!==Ft.ERROR&&t.removeEventListener(Yt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===Ft.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function oH(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return yx;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class lH extends xD{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=ta(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=qn(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=Kp(e,s,a),u=mx(a,s,e,t),h=o.getZForResolution(u,this.zDirection),f=o.getResolution(h),g=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=g[0])return;let y=o.getTileCoordExtent(g,this.tmpExtent_);const v=this.gutter_;v!==0&&(y=Xm(y,f*v,y));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,G4(this.params_,"GetFeatureInfo"),i);const E=Math.floor((l[0]-y[0])/f),T=Math.floor((y[3]-l[1])/f);return x[this.v13_?"I":"X"]=E,x[this.v13_?"J":"Y"]=T,this.getRequestUrl_(g,y,1,a||s,x)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:ET,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),OI(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=eu(mD(e),a.length);o=a[l]}return nH(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||ET;this.v13_=s5(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=Xm(a,s*o,a));const l=Object.assign({},G4(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class If extends rl{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Lc extends If{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Rr={SINGLECLICK:"singleclick",CLICK:Yt.CLICK,DBLCLICK:Yt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ST={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class cH extends Up{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=_n(r,ST.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=_n(r,ST.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Yt.TOUCHMOVE,this.boundHandleTouchMove_,A5?{passive:!1}:!1)}emulateClick_(e){let t=new Lc(Rr.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Lc(Rr.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Lc(Rr.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Rr.POINTERUP||t.type==Rr.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Rr.POINTERDOWN||t.type==Rr.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Lc(Rr.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(rr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Lc(Rr.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(_n(r,Rr.POINTERMOVE,this.handlePointerMove_,this),_n(r,Rr.POINTERUP,this.handlePointerUp_,this),_n(this.element_,Rr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(_n(this.element_.getRootNode(),Rr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Lc(Rr.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Lc(Rr.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(rr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Yt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(rr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(rr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Oc={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},$i={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Qv extends il{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)rr(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Ym&&this.listenerKeys.push(_n(e,Oc.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class uH extends Qv{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Yt.CLICK,this.handleClick_.bind(this),!1);const u=t+" "+Xp+" "+xI+(this.collapsed_&&this.collapsible_?" "+r4:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>XO(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!Tu(t,this.renderedAttributions_)){rz(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(r4),this.collapsed_?t4(this.collapseLabel_,this.label_):t4(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class hH extends Qv{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Yt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+Xp+" "+xI,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(zy)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:V0}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(zy);!s&&r===0?this.element.classList.add(zy):s&&r!==0&&this.element.classList.remove(zy)}this.label_.style.transform=i}this.rotation_=r}}class dH extends Qv{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Yt.CLICK,this.handleClick_.bind(this,r),!1);const f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Yt.CLICK,this.handleClick_.bind(this,-r),!1);const g=t+" "+Xp+" "+xI,y=this.element;y.className=g,y.appendChild(h),y.appendChild(f),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:V0})):r.setZoom(s)}}}function fH(n){n=n||{};const e=new Sa;return(n.zoom===void 0||n.zoom)&&e.push(new dH(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new hH(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new uH(n.attributionOptions)),e}class gH{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const B4={ACTIVE:"active"};class e1 extends il{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(B4.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(B4.ACTIVE,e)}setMap(e){this.map_=e}}function mH(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:sW,center:n.getConstrainedCenter(i)})}}function FI(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:V0})}class pH extends e1{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Rr.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();FI(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function TT(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const yH=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},_H=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},ED=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?_H(n):!0},xH=Km,SD=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(tz&&b5&&e.ctrlKey)},TD=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},vH=function(n){const e=n.originalEvent;return b5?e.metaKey:e.ctrlKey},wH=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},bD=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},eS=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},EH=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class t1 extends e1{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Rr.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Rr.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Rr.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Rr.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function jI(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class SH extends t1{constructor(e){super({stopDown:Dv}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:TT(TD,EH);this.condition_=e.onFocusOnly?TT(ED,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(jI(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();aU(s,o.getResolution()),nI(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:V0})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class TH extends t1{constructor(e){e=e||{},super({stopDown:Dv}),this.condition_=e.condition?e.condition:yH,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!eS(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===CI)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return eS(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return eS(e)&&SD(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class bH extends Lv{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Pa([i])}getGeometry(){return this.geometry_}}const df={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ug extends rl{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class IH extends t1{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new bH(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??SD,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ug(df.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ug(t?df.BOXEND:df.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ug(df.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ug(df.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ug(df.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class AH extends IH{constructor(e){e=e||{};const t=e.condition?e.condition:wH;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:V0})}}const eh={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class RH extends e1{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return TD(t)&&bD(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Yt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==eh.DOWN||i==eh.LEFT||i==eh.RIGHT||i==eh.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,u=0;i==eh.DOWN?u=-o:i==eh.LEFT?l=-o:i==eh.RIGHT?l=o:u=o;const h=[l,u];nI(h,a.getRotation()),mH(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class CH extends e1{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!vH(t)&&bD(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Yt.KEYDOWN||e.type==Yt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();FI(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const kH=40,PH=300;class MH extends e1{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:xH;this.condition_=e.onFocusOnly?TT(ED,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Yt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=kH;break;case WheelEvent.DOM_DELTA_PAGE:s*=PH;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-lr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),FI(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class NH extends t1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Dv),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==CI&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(jI(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class LH extends t1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Dv),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,u=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(jI(this.targetPointers))),l.render(),u.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function OH(n){n=n||{};const e=new Sa,t=new gH(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new TH),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new pH({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new SH({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new NH),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new LH({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new RH),e.push(new CH({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new MH({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new AH({duration:n.zoomDuration})),e}class DH extends Lv{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Ut()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;qo(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),p5(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let u;const h=t.viewState;function f(M,F,G,R){return s.call(a,F,M?G:null,R)}const g=h.projection,y=a5(e.slice(),g),v=[[0,0]];if(g.canWrapX()&&i){const M=g.getExtent(),F=un(M);v.push([-F,0],[F,0])}const x=t.layerStatesArray,E=x.length,T=[],b=[];for(let M=0;M<v.length;M++)for(let F=E-1;F>=0;--F){const G=x[F],R=G.layer;if(R.hasRenderer()&&PI(G,h)&&o.call(l,R)){const C=R.getRenderer(),P=R.getSource();if(C&&P){const N=P.getWrapX()?y:e,O=f.bind(null,G.managed);b[0]=N[0]+v[M][0],b[1]=N[1]+v[M][1],u=C.forEachFeatureAtCoordinate(b,t,r,O,T)}if(u)return u}}if(T.length===0)return;const I=1/T.length;return T.forEach((M,F)=>M.distanceSq+=F*I),T.sort((M,F)=>M.distanceSq-F.distanceSq),T.some(M=>u=M.callback(M.feature,M.layer,M.geometry)),u}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,Km,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Ut()}scheduleExpireIconCache(e){ba.canExpireCache()&&e.postRenderFunctions.push(FH)}}function FH(n,e){ba.expire()}class jH extends DH{constructor(e){super(e),this.fontChangeListenerKey_=_n(Ef,u0.PROPERTYCHANGE,e.redrawText,e),this.element_=Qs?R5():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Xp+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new Q5(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){rr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ta.PRECOMPOSE,e);const t=e.layerStatesArray.sort((u,h)=>u.zIndex-h.zIndex);t.some(u=>u.layer instanceof lD&&u.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let u=0,h=t.length;u<h;++u){const f=t[u];e.layerIndex=u;const g=f.layer,y=g.getSourceState();if(!PI(f,i)||y!="ready"&&y!="undefined"){g.unrender();continue}const v=g.render(e,a);v&&(v!==a&&(this.children_.push(v),a=v),s.push(f))}this.declutter(e,s),iz(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Hc(l)){const u=l.getContext("2d");for(const h of this.children_){const f=h.firstElementChild||h,g=h.style.backgroundColor;if(g&&(!Hc(f)||f.width>0)&&(u.fillStyle=g,u.fillRect(0,0,l.width,l.height)),Hc(f)&&f.width>0){const y=h.style.opacity||f.style.opacity;u.globalAlpha=y===""?1:Number(y);const v=f.style.transform;if(v)u.setTransform(...hT(v));else{const x=parseFloat(f.style.width)/f.width,E=parseFloat(f.style.height)/f.height;u.setTransform(x,0,0,E,0,0)}u.drawImage(f,0,0)}}u.globalAlpha=1,u.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Ta.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function ID(n){if(n instanceof Jp){n.setMapInternal(null);return}n instanceof Zv&&n.getLayers().forEach(ID)}function AD(n,e){if(n instanceof Jp){n.setMapInternal(e);return}if(n instanceof Zv){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)AD(t[r],e)}}let VH=class extends il{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=GH(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:nz,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=no(),this.pixelToCoordinateTransform_=no(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Qs||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Qs||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Qs?new Sa:fH()),this.interactions=t.interactions||(Qs?new Sa:OH({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new aH(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener($i.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener($i.VIEW,this.handleViewChanged_),this.addChangeListener($i.SIZE,this.handleSizeChanged_),this.addChangeListener($i.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Oo)&&e.view.then(function(i){r.setView(new Oo(i))}),this.controls.addEventListener(Es.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Es.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Es.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Es.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Es.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Es.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){AD(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:Km,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof Zv?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:Km,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get($i.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return uT(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?ni(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get($i.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Sa){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Sl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?ni(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get($i.SIZE)}getView(){return this.get($i.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return oH(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Lc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===ST.POINTERDOWN||r===Yt.WHEEL||r===Yt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[di.ANIMATING]||a[di.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ta.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ta.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new If(Oc.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new If(Oc.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)rr(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Yt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Yt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Hc(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Hc(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new jH(this)),!Hc(t)){this.mapBrowserEventHandler_=new cH(this,this.moveTolerance_);for(const i in Rr)this.mapBrowserEventHandler_.addEventListener(Rr[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Yt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Yt.WHEEL,this.boundHandleBrowserEvent_,A5?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[_n(r,Yt.KEYDOWN,this.handleBrowserEvent,this),_n(r,Yt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(rr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(rr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=_n(e,u0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=_n(e,Yt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(rr),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Fc("addlayer",e)),this.layerGroupPropertyListenerKeys_=[_n(e,u0.PROPERTYCHANGE,this.render,this),_n(e,Yt.CHANGE,this.render,this),_n(e,"addlayer",this.handleLayerAdd_,this),_n(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){ID(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&m4(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:ex(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:In(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=ex(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!j0(this.previousExtent_)&&!h0(s.extent,this.previousExtent_))&&(this.dispatchEvent(new If(Oc.MOVESTART,this,i)),this.previousExtent_=$p(this.previousExtent_)),this.previousExtent_&&!s.viewHints[di.ANIMATING]&&!s.viewHints[di.INTERACTING]&&!h0(s.extent,this.previousExtent_)&&(this.dispatchEvent(new If(Oc.MOVEEND,this,s)),ZO(s.extent,this.previousExtent_))),this.dispatchEvent(new If(Oc.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Oc.LOADSTART)||this.hasListener(Oc.LOADEND)||this.hasListener(Ta.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Fc("removelayer",t)),this.set($i.LAYERGROUP,e)}setSize(e){this.set($i.SIZE,e)}setTarget(e){this.set($i.TARGET,e)}setView(e){if(!e||e instanceof Oo){this.set($i.VIEW,e);return}this.set($i.VIEW,new Oo);const t=this;e.then(function(r){t.setView(new Oo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(Hc(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!m4(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&l5("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!Tu(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function GH(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Zv({layers:n.layers});t[$i.LAYERGROUP]=r,t[$i.TARGET]=n.target,t[$i.VIEW]=n.view instanceof Oo?n.view:new Oo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new Sa(n.controls.slice()):(Fn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Sa(n.interactions.slice()):(Fn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new Sa(n.overlays.slice()):(Fn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new Sa,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const tS="units",BH=[1,2,5],zg=25.4/.28;class UH extends Qv{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+Xp,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(tS,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(tS)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(tS,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=ax(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||zg)/zg,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||zg)/zg:void 0;let u=o*a,h="";if(i=="degrees"){const I=d0.degrees;u*=I,u<I/60?(h="",a*=3600):u<I?(h="",a*=60):h=""}else if(i=="imperial")u<.9144?(h="in",a/=.0254):u<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")u<1e-6?(h="nm",a*=1e9):u<.001?(h="m",a*=1e6):u<1?(h="mm",a*=1e3):u<1e3?h="m":(h="km",a/=1e3);else if(i=="us")u<.9144?(h="in",a*=39.37):u<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let f=3*Math.floor(Math.log(o*a)/Math.log(10)),g,y,v,x=0,E,T;for(;;){v=Math.floor(f/3);const I=Math.pow(10,v);if(g=BH[(f%3+3)%3]*I,y=Math.round(g/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){g=x,y=E,v=T;break}else if(y>=o)break;x=g,E=y,T=v,++f}const b=this.scaleBar_?this.createScaleBar(y,g,h):g.toFixed(v<0?-v:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const f=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${f}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,u=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${u}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=ax(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||zg,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const zH={},U4=n=>{let e;const t=new Set,r=(h,f)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const y=e;e=f??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(v=>v(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(zH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(r,i,l);return l},$H=n=>n?U4(n):U4;var nS={exports:{}},rS={},iS={exports:{}},sS={};var z4;function WH(){if(z4)return sS;z4=1;var n=Gp();function e(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,g){var y=g(),v=r({inst:{value:y,getSnapshot:g}}),x=v[0].inst,E=v[1];return s(function(){x.value=y,x.getSnapshot=g,l(x)&&E({inst:x})},[f,y,g]),i(function(){return l(x)&&E({inst:x}),f(function(){l(x)&&E({inst:x})})},[f]),a(y),y}function l(f){var g=f.getSnapshot;f=f.value;try{var y=g();return!t(f,y)}catch{return!0}}function u(f,g){return g()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return sS.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,sS}var $4;function HH(){return $4||($4=1,iS.exports=WH()),iS.exports}var W4;function KH(){if(W4)return rS;W4=1;var n=Gp(),e=HH();function t(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return rS.useSyncExternalStoreWithSelector=function(u,h,f,g,y){var v=s(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=o(function(){function T(G){if(!b){if(b=!0,I=G,G=g(G),y!==void 0&&x.hasValue){var R=x.value;if(y(R,G))return M=R}return M=G}if(R=M,r(I,G))return R;var C=g(G);return y!==void 0&&y(R,C)?(I=G,R):(I=G,M=C)}var b=!1,I,M,F=f===void 0?null:f;return[function(){return T(h())},F===null?void 0:function(){return T(F())}]},[h,f,g,y]);var E=i(u,v[0],v[1]);return a(function(){x.hasValue=!0,x.value=E},[E]),l(E),E},rS}var H4;function YH(){return H4||(H4=1,nS.exports=KH()),nS.exports}var XH=YH();const qH=Jb(XH),RD={},{useDebugValue:ZH}=WB,{useSyncExternalStoreWithSelector:QH}=qH;let K4=!1;const JH=n=>n;function eK(n,e=JH,t){(RD?"production":void 0)!=="production"&&t&&!K4&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),K4=!0);const r=QH(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return ZH(r),r}const tK=n=>{(RD?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?$H(n):n,t=(r,i)=>eK(e,r,i);return Object.assign(t,e),t},oa=n=>tK;var CD=Symbol.for("immer-nothing"),Y4=Symbol.for("immer-draftable"),ra=Symbol.for("immer-state");function qa(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var sp=Object.getPrototypeOf;function p0(n){return!!n&&!!n[ra]}function $h(n){return n?kD(n)||Array.isArray(n)||!!n[Y4]||!!n.constructor?.[Y4]||n1(n)||ew(n):!1}var nK=Object.prototype.constructor.toString(),X4=new WeakMap;function kD(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=X4.get(t);return r===void 0&&(r=Function.toString.call(t),X4.set(t,r)),r===nK}function _x(n,e,t=!0){Jv(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Jv(n){const e=n[ra];return e?e.type_:Array.isArray(n)?1:n1(n)?2:ew(n)?3:0}function bT(n,e){return Jv(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function PD(n,e,t){const r=Jv(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function rK(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function n1(n){return n instanceof Map}function ew(n){return n instanceof Set}function ah(n){return n.copy_||n.base_}function IT(n,e){if(n1(n))return new Map(n);if(ew(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=kD(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[ra];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(sp(n),r)}else{const r=sp(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function VI(n,e=!1){return tw(n)||p0(n)||!$h(n)||(Jv(n)>1&&Object.defineProperties(n,{set:qy,add:qy,clear:qy,delete:qy}),Object.freeze(n),e&&Object.values(n).forEach(t=>VI(t,!0))),n}function iK(){qa(2)}var qy={value:iK};function tw(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var sK={};function Wh(n){const e=sK[n];return e||qa(0,n),e}var ap;function MD(){return ap}function aK(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function q4(n,e){e&&(Wh("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function AT(n){RT(n),n.drafts_.forEach(oK),n.drafts_=null}function RT(n){n===ap&&(ap=n.parent_)}function Z4(n){return ap=aK(ap,n)}function oK(n){const e=n[ra];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Q4(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[ra].modified_&&(AT(e),qa(4)),$h(n)&&(n=xx(e,n),e.parent_||vx(e,n)),e.patches_&&Wh("Patches").generateReplacementPatches_(t[ra].base_,n,e.patches_,e.inversePatches_)):n=xx(e,t,[]),AT(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==CD?n:void 0}function xx(n,e,t){if(tw(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[ra];if(!i)return _x(e,(s,a)=>J4(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return vx(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),_x(a,(l,u)=>J4(n,i,s,l,u,t,o),r),vx(n,s,!1),t&&n.patches_&&Wh("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function J4(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=tw(i);if(!(o&&!a)){if(p0(i)){const l=s&&e&&e.type_!==3&&!bT(e.assigned_,r)?s.concat(r):void 0,u=xx(n,i,l);if(PD(t,r,u),p0(u))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if($h(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;xx(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(n1(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&vx(n,i)}}}function vx(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&VI(e,t)}function lK(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:MD(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=GI;t&&(i=[r],s=op);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var GI={get(n,e){if(e===ra)return n;const t=ah(n);if(!bT(t,e))return cK(n,t,e);const r=t[e];return n.finalized_||!$h(r)?r:r===aS(n.base_,e)?(oS(n),n.copy_[e]=kT(r,n)):r},has(n,e){return e in ah(n)},ownKeys(n){return Reflect.ownKeys(ah(n))},set(n,e,t){const r=ND(ah(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=aS(ah(n),e),s=i?.[ra];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(rK(t,i)&&(t!==void 0||bT(n.base_,e)))return!0;oS(n),CT(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return aS(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,oS(n),CT(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=ah(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){qa(11)},getPrototypeOf(n){return sp(n.base_)},setPrototypeOf(){qa(12)}},op={};_x(GI,(n,e)=>{op[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});op.deleteProperty=function(n,e){return op.set.call(this,n,e,void 0)};op.set=function(n,e,t){return GI.set.call(this,n[0],e,t,n[0])};function aS(n,e){const t=n[ra];return(t?ah(t):n)[e]}function cK(n,e,t){const r=ND(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function ND(n,e){if(!(e in n))return;let t=sp(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=sp(t)}}function CT(n){n.modified_||(n.modified_=!0,n.parent_&&CT(n.parent_))}function oS(n){n.copy_||(n.copy_=IT(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var uK=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...u){return a.produce(l,h=>t.call(this,h,...u))}}typeof t!="function"&&qa(6),r!==void 0&&typeof r!="function"&&qa(7);let i;if($h(e)){const s=Z4(this),a=kT(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?AT(s):RT(s)}return q4(s,r),Q4(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===CD&&(i=void 0),this.autoFreeze_&&VI(i,!0),r){const s=[],a=[];Wh("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else qa(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){$h(n)||qa(8),p0(n)&&(n=hK(n));const e=Z4(this),t=kT(n,void 0);return t[ra].isManual_=!0,RT(e),t}finishDraft(n,e){const t=n&&n[ra];(!t||!t.isManual_)&&qa(9);const{scope_:r}=t;return q4(r,e),Q4(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=Wh("Patches").applyPatches_;return p0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function kT(n,e){const t=n1(n)?Wh("MapSet").proxyMap_(n,e):ew(n)?Wh("MapSet").proxySet_(n,e):lK(n,e);return(e?e.scope_:MD()).drafts_.push(t),t}function hK(n){return p0(n)||qa(10,n),LD(n)}function LD(n){if(!$h(n)||tw(n))return n;const e=n[ra];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=IT(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=IT(n,!0);return _x(t,(i,s)=>{PD(t,i,LD(s))},r),e&&(e.finalized_=!1),t}var dK=new uK,fK=dK.produce;const gK=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?fK(i):i;return e(o,s,...a)},n(r.setState,t,r)),G0=gK,os=oa()(G0((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),nw={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await pt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await pt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await pt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await pt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await pt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await pt(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await pt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await pt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await pt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await pt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await pt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-DaEURZd5.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await pt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-CdG1DKEH.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await pt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-CdG1DKEH.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await pt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-CdG1DKEH.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await pt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-CLbRuBeX.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await pt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-CLbRuBeX.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await pt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-CLbRuBeX.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await pt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-CLbRuBeX.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await pt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-CLbRuBeX.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await pt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-CLbRuBeX.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await pt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-CLbRuBeX.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await pt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-Cy9tLolX.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await pt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-sF5nsII1.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await pt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-sF5nsII1.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await pt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-sF5nsII1.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await pt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await pt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await pt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await pt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await pt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-D61xe2dB.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await pt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-D61xe2dB.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await pt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await pt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await pt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await pt(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await pt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await pt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await pt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-DZgtrlyU.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await pt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-B-g6fQh9.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await pt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-B-g6fQh9.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await pt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-B-g6fQh9.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await pt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-B-g6fQh9.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await pt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-B-g6fQh9.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await pt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-B-g6fQh9.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await pt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-CBNlFf8u.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await pt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-CBNlFf8u.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await pt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-C0h5Pn8o.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await pt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-DgKz60Le.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await pt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-6XXt65mX.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await pt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-CVXggxtl.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await pt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-BvTudbYb.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await pt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-2jNxVUOF.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await pt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-CAXHqLMG.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await pt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-CIme7nUs.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await pt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-D5ZfmCkJ.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await pt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-C265ItaB.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await pt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-6DERzGrH.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await pt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-tBUj3Sw3.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await pt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-Dx8DOWkY.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await pt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-CUQ3nnZu.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await pt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-Cwy79EOk.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await pt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-BhB4um7C.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await pt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-lEw0NnQo.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await pt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-BCb8uYcX.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await pt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-C8Lg_8ZZ.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await pt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-zL682kLM.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await pt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-CxoeERDo.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await pt(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-DGG7rM_v.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await pt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-C7erhsRr.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await pt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-DRVSxQS_.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await pt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-B0oXuPX5.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await pt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-BgBF5muO.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function mK(){return Object.values(nw).filter(n=>n.immediateLoad)}const Di=oa()(G0((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),fi=oa()(G0((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"Archeo Landschappen":.5,Essen:.6,Terpen:.7,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=nw[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=Di.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),yr=oa()(G0((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{n(t=>{t.routeDashboardOpen=!t.routeDashboardOpen})}}))),pK=()=>{};var eM={};const OD=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yK=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},DD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,y=u&63;l||(y=64,a||(g=64)),r.push(t[h],t[f],t[g],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(OD(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yK(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||u==null||f==null)throw new _K;const g=s<<2|o>>4;if(r.push(g),u!==64){const y=o<<4&240|u>>2;if(r.push(y),f!==64){const v=u<<6&192|f;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class _K extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xK=function(n){const e=OD(n);return DD.encodeByteArray(e,!0)},wx=function(n){return xK(n).replace(/\./g,"")},FD=function(n){try{return DD.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function jD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const vK=()=>jD().__FIREBASE_DEFAULTS__,wK=()=>{if(typeof process>"u"||typeof eM>"u")return;const n=eM.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},EK=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&FD(n[1]);return e&&JSON.parse(e)},rw=()=>{try{return pK()||vK()||wK()||EK()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},VD=n=>rw()?.emulatorHosts?.[n],GD=n=>{const e=VD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},BD=()=>rw()?.config,UD=n=>rw()?.[`_${n}`];class SK{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function pd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function BI(n){return(await fetch(n,{credentials:"include"})).ok}function zD(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[wx(JSON.stringify(t)),wx(JSON.stringify(a)),""].join(".")}const _m={};function TK(){const n={prod:[],emulator:[]};for(const e of Object.keys(_m))_m[e]?n.emulator.push(e):n.prod.push(e);return n}function bK(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let tM=!1;function UI(n,e){if(typeof window>"u"||typeof document>"u"||!pd(window.location.host)||_m[n]===e||_m[n]||tM)return;_m[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=TK().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function o(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,y){g.setAttribute("width","24"),g.setAttribute("id",y),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{tM=!0,a()},g}function h(g,y){g.setAttribute("id",y),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){const g=bK(r),y=t("text"),v=document.getElementById(y)||document.createElement("span"),x=t("learnmore"),E=document.getElementById(x)||document.createElement("a"),T=t("preprendIcon"),b=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const I=g.element;o(I),h(E,x);const M=u();l(b,T),I.append(b,v,E,M),document.body.appendChild(I)}s?(v.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function ii(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function IK(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ii())}function $D(){const n=rw()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AK(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function RK(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function CK(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kK(){const n=ii();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function WD(){return!$D()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function HD(){return!$D()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function KD(){try{return typeof indexedDB=="object"}catch{return!1}}function PK(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const MK="FirebaseError";class sl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=MK,Object.setPrototypeOf(this,sl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,r1.prototype.create)}}class r1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?NK(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new sl(i,o,r)}}function NK(n,e){return n.replace(LK,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const LK=/\{\$([^}]+)}/g;function OK(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Hh(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(nM(s)&&nM(a)){if(!Hh(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function nM(n){return n!==null&&typeof n=="object"}function i1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function DK(n,e){const t=new FK(n,e);return t.subscribe.bind(t)}class FK{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");jK(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=lS),i.error===void 0&&(i.error=lS),i.complete===void 0&&(i.complete=lS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jK(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lS(){}function xi(n){return n&&n._delegate?n._delegate:n}class uu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const oh="[DEFAULT]";class VK{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new SK;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(BK(e))try{this.getOrInitializeService({instanceIdentifier:oh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=oh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=oh){return this.instances.has(e)}getOptions(e=oh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:GK(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=oh){return this.component?this.component.multipleInstances?e:oh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GK(n){return n===oh?void 0:n}function BK(n){return n.instantiationMode==="EAGER"}class UK{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VK(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var dn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(dn||(dn={}));const zK={debug:dn.DEBUG,verbose:dn.VERBOSE,info:dn.INFO,warn:dn.WARN,error:dn.ERROR,silent:dn.SILENT},$K=dn.INFO,WK={[dn.DEBUG]:"log",[dn.VERBOSE]:"log",[dn.INFO]:"info",[dn.WARN]:"warn",[dn.ERROR]:"error"},HK=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=WK[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zI{constructor(e){this.name=e,this._logLevel=$K,this._logHandler=HK,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zK[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dn.DEBUG,...e),this._logHandler(this,dn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dn.VERBOSE,...e),this._logHandler(this,dn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dn.INFO,...e),this._logHandler(this,dn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dn.WARN,...e),this._logHandler(this,dn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dn.ERROR,...e),this._logHandler(this,dn.ERROR,...e)}}const KK=(n,e)=>e.some(t=>n instanceof t);let rM,iM;function YK(){return rM||(rM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function XK(){return iM||(iM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YD=new WeakMap,PT=new WeakMap,XD=new WeakMap,cS=new WeakMap,$I=new WeakMap;function qK(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(nu(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&YD.set(t,n)}).catch(()=>{}),$I.set(e,n),e}function ZK(n){if(PT.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});PT.set(n,e)}let MT={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return PT.get(n);if(e==="objectStoreNames")return n.objectStoreNames||XD.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return nu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function QK(n){MT=n(MT)}function JK(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(uS(this),e,...t);return XD.set(r,e.sort?e.sort():[e]),nu(r)}:XK().includes(n)?function(...e){return n.apply(uS(this),e),nu(YD.get(this))}:function(...e){return nu(n.apply(uS(this),e))}}function eY(n){return typeof n=="function"?JK(n):(n instanceof IDBTransaction&&ZK(n),KK(n,YK())?new Proxy(n,MT):n)}function nu(n){if(n instanceof IDBRequest)return qK(n);if(cS.has(n))return cS.get(n);const e=eY(n);return e!==n&&(cS.set(n,e),$I.set(e,n)),e}const uS=n=>$I.get(n);function tY(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=nu(a);return r&&a.addEventListener("upgradeneeded",l=>{r(nu(a.result),l.oldVersion,l.newVersion,nu(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const nY=["get","getKey","getAll","getAllKeys","count"],rY=["put","add","delete","clear"],hS=new Map;function sM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hS.get(e))return hS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=rY.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||nY.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&l.done]))[0]};return hS.set(e,s),s}QK(n=>({...n,get:(e,t,r)=>sM(e,t)||n.get(e,t,r),has:(e,t)=>!!sM(e,t)||n.has(e,t)}));class iY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(sY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function sY(n){return n.getComponent()?.type==="VERSION"}const NT="@firebase/app",aM="0.14.6";const Ul=new zI("@firebase/app"),aY="@firebase/app-compat",oY="@firebase/analytics-compat",lY="@firebase/analytics",cY="@firebase/app-check-compat",uY="@firebase/app-check",hY="@firebase/auth",dY="@firebase/auth-compat",fY="@firebase/database",gY="@firebase/data-connect",mY="@firebase/database-compat",pY="@firebase/functions",yY="@firebase/functions-compat",_Y="@firebase/installations",xY="@firebase/installations-compat",vY="@firebase/messaging",wY="@firebase/messaging-compat",EY="@firebase/performance",SY="@firebase/performance-compat",TY="@firebase/remote-config",bY="@firebase/remote-config-compat",IY="@firebase/storage",AY="@firebase/storage-compat",RY="@firebase/firestore",CY="@firebase/ai",kY="@firebase/firestore-compat",PY="firebase",MY="12.6.0";const LT="[DEFAULT]",NY={[NT]:"fire-core",[aY]:"fire-core-compat",[lY]:"fire-analytics",[oY]:"fire-analytics-compat",[uY]:"fire-app-check",[cY]:"fire-app-check-compat",[hY]:"fire-auth",[dY]:"fire-auth-compat",[fY]:"fire-rtdb",[gY]:"fire-data-connect",[mY]:"fire-rtdb-compat",[pY]:"fire-fn",[yY]:"fire-fn-compat",[_Y]:"fire-iid",[xY]:"fire-iid-compat",[vY]:"fire-fcm",[wY]:"fire-fcm-compat",[EY]:"fire-perf",[SY]:"fire-perf-compat",[TY]:"fire-rc",[bY]:"fire-rc-compat",[IY]:"fire-gcs",[AY]:"fire-gcs-compat",[RY]:"fire-fst",[kY]:"fire-fst-compat",[CY]:"fire-vertex","fire-js":"fire-js",[PY]:"fire-js-all"};const Ex=new Map,LY=new Map,OT=new Map;function oM(n,e){try{n.container.addComponent(e)}catch(t){Ul.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Kh(n){const e=n.name;if(OT.has(e))return Ul.debug(`There were multiple attempts to register component ${e}.`),!1;OT.set(e,n);for(const t of Ex.values())oM(t,n);for(const t of LY.values())oM(t,n);return!0}function iw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Zs(n){return n==null?!1:n.settings!==void 0}const OY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ru=new r1("app","Firebase",OY);class DY{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new uu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ru.create("app-deleted",{appName:this._name})}}const yd=MY;function qD(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:LT,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ru.create("bad-app-name",{appName:String(i)});if(t||(t=BD()),!t)throw ru.create("no-options");const s=Ex.get(i);if(s){if(Hh(t,s.options)&&Hh(r,s.config))return s;throw ru.create("duplicate-app",{appName:i})}const a=new UK(i);for(const l of OT.values())a.addComponent(l);const o=new DY(t,r,a);return Ex.set(i,o),o}function WI(n=LT){const e=Ex.get(n);if(!e&&n===LT&&BD())return qD();if(!e)throw ru.create("no-app",{appName:n});return e}function Bo(n,e,t){let r=NY[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ul.warn(a.join(" "));return}Kh(new uu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const FY="firebase-heartbeat-database",jY=1,lp="firebase-heartbeat-store";let dS=null;function ZD(){return dS||(dS=tY(FY,jY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(lp)}catch(t){console.warn(t)}}}}).catch(n=>{throw ru.create("idb-open",{originalErrorMessage:n.message})})),dS}async function VY(n){try{const t=(await ZD()).transaction(lp),r=await t.objectStore(lp).get(QD(n));return await t.done,r}catch(e){if(e instanceof sl)Ul.warn(e.message);else{const t=ru.create("idb-get",{originalErrorMessage:e?.message});Ul.warn(t.message)}}}async function lM(n,e){try{const r=(await ZD()).transaction(lp,"readwrite");await r.objectStore(lp).put(e,QD(n)),await r.done}catch(t){if(t instanceof sl)Ul.warn(t.message);else{const r=ru.create("idb-set",{originalErrorMessage:t?.message});Ul.warn(r.message)}}}function QD(n){return`${n.name}!${n.options.appId}`}const GY=1024,BY=30;class UY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new $Y(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=cM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>BY){const i=WY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ul.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=cM(),{heartbeatsToSend:t,unsentEntries:r}=zY(this._heartbeatsCache.heartbeats),i=wx(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ul.warn(e),""}}}function cM(){return new Date().toISOString().substring(0,10)}function zY(n,e=GY){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),uM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),uM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class $Y{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KD()?PK().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await VY(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return lM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return lM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function uM(n){return wx(JSON.stringify({version:2,heartbeats:n})).length}function WY(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function HY(n){Kh(new uu("platform-logger",e=>new iY(e),"PRIVATE")),Kh(new uu("heartbeat",e=>new UY(e),"PRIVATE")),Bo(NT,aM,n),Bo(NT,aM,"esm2020"),Bo("fire-js","")}HY("");function JD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const KY=JD,e6=new r1("auth","Firebase",JD());const Sx=new zI("@firebase/auth");function YY(n,...e){Sx.logLevel<=dn.WARN&&Sx.warn(`Auth (${yd}): ${n}`,...e)}function R_(n,...e){Sx.logLevel<=dn.ERROR&&Sx.error(`Auth (${yd}): ${n}`,...e)}function Zo(n,...e){throw KI(n,...e)}function io(n,...e){return KI(n,...e)}function HI(n,e,t){const r={...KY(),[e]:t};return new r1("auth","Firebase",r).create(e,{appName:n.name})}function iu(n){return HI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function XY(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Zo(n,"argument-error"),HI(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function KI(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return e6.create(n,...e)}function Kt(n,e,...t){if(!n)throw KI(e,...t)}function Il(n){const e="INTERNAL ASSERTION FAILED: "+n;throw R_(e),new Error(e)}function zl(n,e){n||Il(e)}function DT(){return typeof self<"u"&&self.location?.href||""}function qY(){return hM()==="http:"||hM()==="https:"}function hM(){return typeof self<"u"&&self.location?.protocol||null}function ZY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qY()||RK()||"connection"in navigator)?navigator.onLine:!0}function QY(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class s1{constructor(e,t){this.shortDelay=e,this.longDelay=t,zl(t>e,"Short delay should be less than long delay!"),this.isMobile=IK()||CK()}get(){return ZY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function YI(n,e){zl(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class t6{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Il("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Il("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Il("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const JY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const eX=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],tX=new s1(3e4,6e4);function sw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function B0(n,e,t,r,i={}){return n6(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=i1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:l,...s};return AK()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&pd(n.emulatorConfig.host)&&(u.credentials="include"),t6.fetch()(await i6(n,n.config.apiHost,t,o),u)})}async function n6(n,e,t){n._canInitEmulator=!1;const r={...JY,...e};try{const i=new nX(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Zy(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zy(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Zy(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Zy(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw HI(n,h,u);Zo(n,h)}}catch(i){if(i instanceof sl)throw i;Zo(n,"network-request-failed",{message:String(i)})}}async function r6(n,e,t,r,i={}){const s=await B0(n,e,t,r,i);return"mfaPendingCredential"in s&&Zo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function i6(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?YI(n.config,i):`${n.config.apiScheme}://${i}`;return eX.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class nX{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(io(this.auth,"network-request-failed")),tX.get())})}}function Zy(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=io(n,e,r);return i.customData._tokenResponse=t,i}async function rX(n,e){return B0(n,"POST","/v1/accounts:delete",e)}async function Tx(n,e){return B0(n,"POST","/v1/accounts:lookup",e)}function xm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function iX(n,e=!1){const t=xi(n),r=await t.getIdToken(e),i=XI(r);Kt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:xm(fS(i.auth_time)),issuedAtTime:xm(fS(i.iat)),expirationTime:xm(fS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function fS(n){return Number(n)*1e3}function XI(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return R_("JWT malformed, contained fewer than 3 sections"),null;try{const i=FD(t);return i?JSON.parse(i):(R_("Failed to decode base64 JWT payload"),null)}catch(i){return R_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function dM(n){const e=XI(n);return Kt(e,"internal-error"),Kt(typeof e.exp<"u","internal-error"),Kt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function cp(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof sl&&sX(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function sX({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class aX{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class FT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=xm(this.lastLoginAt),this.creationTime=xm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bx(n){const e=n.auth,t=await n.getIdToken(),r=await cp(n,Tx(e,{idToken:t}));Kt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?s6(i.providerUserInfo):[],a=lX(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,u=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new FT(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function oX(n){const e=xi(n);await bx(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lX(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function s6(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function cX(n,e){const t=await n6(n,{},async()=>{const r=i1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await i6(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&pd(n.emulatorConfig.host)&&(l.credentials="include"),t6.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function uX(n,e){return B0(n,"POST","/v2/accounts:revokeToken",sw(n,e))}class Xf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Kt(e.idToken,"internal-error"),Kt(typeof e.idToken<"u","internal-error"),Kt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):dM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Kt(e.length!==0,"internal-error");const t=dM(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Kt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await cX(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Xf;return r&&(Kt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Kt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Kt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xf,this.toJSON())}_performRefresh(){return Il("not implemented")}}function Cc(n,e){Kt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ja{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new aX(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new FT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await cp(this,this.stsTokenManager.getToken(this.auth,e));return Kt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return iX(this,e)}reload(){return oX(this)}_assign(e){this!==e&&(Kt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ja({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Kt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await bx(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zs(this.auth.app))return Promise.reject(iu(this.auth));const e=await this.getIdToken();return await cp(this,rX(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:f,emailVerified:g,isAnonymous:y,providerData:v,stsTokenManager:x}=t;Kt(f&&x,e,"internal-error");const E=Xf.fromJSON(this.name,x);Kt(typeof f=="string",e,"internal-error"),Cc(r,e.name),Cc(i,e.name),Kt(typeof g=="boolean",e,"internal-error"),Kt(typeof y=="boolean",e,"internal-error"),Cc(s,e.name),Cc(a,e.name),Cc(o,e.name),Cc(l,e.name),Cc(u,e.name),Cc(h,e.name);const T=new Ja({uid:f,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:E,createdAt:u,lastLoginAt:h});return v&&Array.isArray(v)&&(T.providerData=v.map(b=>({...b}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Xf;i.updateFromServerResponse(t);const s=new Ja({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await bx(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Kt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?s6(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new Xf;o.updateFromIdToken(r);const l=new Ja({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new FT(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,u),l}}const fM=new Map;function Al(n){zl(n instanceof Function,"Expected a class definition");let e=fM.get(n);return e?(zl(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,fM.set(n,e),e)}class a6{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}a6.type="NONE";const gM=a6;function C_(n,e,t){return`firebase:${n}:${e}:${t}`}class qf{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=C_(this.userKey,i.apiKey,s),this.fullPersistenceKey=C_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Tx(this.auth,{idToken:e}).catch(()=>{});return t?Ja._fromGetAccountInfoResponse(this.auth,t,e):null}return Ja._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new qf(Al(gM),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Al(gM);const a=C_(r,e.config.apiKey,e.name);let o=null;for(const u of t)try{const h=await u._get(a);if(h){let f;if(typeof h=="string"){const g=await Tx(e,{idToken:h}).catch(()=>{});if(!g)break;f=await Ja._fromGetAccountInfoResponse(e,g,h)}else f=Ja._fromJSON(e,h);u!==s&&(o=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new qf(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new qf(s,e,r))}}function mM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(u6(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(o6(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(d6(e))return"Blackberry";if(f6(e))return"Webos";if(l6(e))return"Safari";if((e.includes("chrome/")||c6(e))&&!e.includes("edge/"))return"Chrome";if(h6(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function o6(n=ii()){return/firefox\//i.test(n)}function l6(n=ii()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function c6(n=ii()){return/crios\//i.test(n)}function u6(n=ii()){return/iemobile/i.test(n)}function h6(n=ii()){return/android/i.test(n)}function d6(n=ii()){return/blackberry/i.test(n)}function f6(n=ii()){return/webos/i.test(n)}function qI(n=ii()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function hX(n=ii()){return qI(n)&&!!window.navigator?.standalone}function dX(){return kK()&&document.documentMode===10}function g6(n=ii()){return qI(n)||h6(n)||f6(n)||d6(n)||/windows phone/i.test(n)||u6(n)}function m6(n,e=[]){let t;switch(n){case"Browser":t=mM(ii());break;case"Worker":t=`${mM(ii())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${yd}/${r}`}class fX{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function gX(n,e={}){return B0(n,"GET","/v2/passwordPolicy",sw(n,e))}const mX=6;class pX{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??mX,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class yX{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pM(this),this.idTokenSubscription=new pM(this),this.beforeStateQueue=new fX(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=e6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Al(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await qf.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Tx(this,{idToken:e}),r=await Ja._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Zs(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Kt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bx(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zs(this.app))return Promise.reject(iu(this));const t=e?xi(e):null;return t&&Kt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Kt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zs(this.app)?Promise.reject(iu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zs(this.app)?Promise.reject(iu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Al(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gX(this),t=new pX(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new r1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await uX(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Al(e)||this._popupRedirectResolver;Kt(t,this,"argument-error"),this.redirectPersistenceManager=await qf.create(this,[Al(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Kt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Kt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=m6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Zs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&YY(`Error while retrieving App Check token: ${e.error}`),e?.token}}function a1(n){return xi(n)}class pM{constructor(e){this.auth=e,this.observer=null,this.addObserver=DK(t=>this.observer=t)}get next(){return Kt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ZI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _X(n){ZI=n}function xX(n){return ZI.loadJS(n)}function vX(){return ZI.gapiScript}function wX(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function EX(n,e){const t=iw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Hh(s,e??{}))return i;Zo(i,"already-initialized")}return t.initialize({options:e})}function SX(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Al);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function TX(n,e,t){const r=a1(n);Kt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=p6(e),{host:a,port:o}=bX(e),l=o===null?"":`:${o}`,u={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Kt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Kt(Hh(u,r.config.emulator)&&Hh(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,pd(a)?(BI(`${s}//${a}${l}`),UI("Auth",!0)):IX()}function p6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function bX(n){const e=p6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:yM(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:yM(a)}}}function yM(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function IX(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class y6{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Il("not implemented")}_getIdTokenResponse(e){return Il("not implemented")}_linkToIdToken(e,t){return Il("not implemented")}_getReauthenticationResolver(e){return Il("not implemented")}}async function Zf(n,e){return r6(n,"POST","/v1/accounts:signInWithIdp",sw(n,e))}const AX="http://localhost";class Yh extends y6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Yh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Zo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new Yh(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Zf(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Zf(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Zf(e,t)}buildRequest(){const e={requestUri:AX,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=i1(t)}return e}}class QI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class o1 extends QI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Vc extends o1{constructor(){super("facebook.com")}static credential(e){return Yh._fromParams({providerId:Vc.PROVIDER_ID,signInMethod:Vc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vc.credentialFromTaggedObject(e)}static credentialFromError(e){return Vc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vc.credential(e.oauthAccessToken)}catch{return null}}}Vc.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vc.PROVIDER_ID="facebook.com";class bl extends o1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Yh._fromParams({providerId:bl.PROVIDER_ID,signInMethod:bl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return bl.credentialFromTaggedObject(e)}static credentialFromError(e){return bl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return bl.credential(t,r)}catch{return null}}}bl.GOOGLE_SIGN_IN_METHOD="google.com";bl.PROVIDER_ID="google.com";class Gc extends o1{constructor(){super("github.com")}static credential(e){return Yh._fromParams({providerId:Gc.PROVIDER_ID,signInMethod:Gc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gc.credentialFromTaggedObject(e)}static credentialFromError(e){return Gc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gc.credential(e.oauthAccessToken)}catch{return null}}}Gc.GITHUB_SIGN_IN_METHOD="github.com";Gc.PROVIDER_ID="github.com";class Bc extends o1{constructor(){super("twitter.com")}static credential(e,t){return Yh._fromParams({providerId:Bc.PROVIDER_ID,signInMethod:Bc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Bc.credentialFromTaggedObject(e)}static credentialFromError(e){return Bc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Bc.credential(t,r)}catch{return null}}}Bc.TWITTER_SIGN_IN_METHOD="twitter.com";Bc.PROVIDER_ID="twitter.com";async function RX(n,e){return r6(n,"POST","/v1/accounts:signUp",sw(n,e))}class hu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Ja._fromIdTokenResponse(e,r,i),a=_M(r);return new hu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=_M(r);return new hu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function _M(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function CX(n){if(Zs(n.app))return Promise.reject(iu(n));const e=a1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new hu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await RX(e,{returnSecureToken:!0}),r=await hu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class Ix extends sl{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Ix.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Ix(e,t,r,i)}}function _6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ix._fromErrorAndOperation(n,s,e,r):s})}async function kX(n,e,t=!1){const r=await cp(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return hu._forOperation(n,"link",r)}async function PX(n,e,t=!1){const{auth:r}=n;if(Zs(r.app))return Promise.reject(iu(r));const i="reauthenticate";try{const s=await cp(n,_6(r,i,e,n),t);Kt(s.idToken,r,"internal-error");const a=XI(s.idToken);Kt(a,r,"internal-error");const{sub:o}=a;return Kt(n.uid===o,r,"user-mismatch"),hu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Zo(r,"user-mismatch"),s}}async function MX(n,e,t=!1){if(Zs(n.app))return Promise.reject(iu(n));const r="signIn",i=await _6(n,r,e),s=await hu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function NX(n,e,t,r){return xi(n).onIdTokenChanged(e,t,r)}function LX(n,e,t){return xi(n).beforeAuthStateChanged(e,t)}function x6(n,e,t,r){return xi(n).onAuthStateChanged(e,t,r)}function v6(n){return xi(n).signOut()}const Ax="__sak";class w6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ax,"1"),this.storage.removeItem(Ax),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const OX=1e3,DX=10;class E6 extends w6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=g6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);dX()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,DX):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},OX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}E6.type="LOCAL";const FX=E6;class S6 extends w6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}S6.type="SESSION";const T6=S6;function jX(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class aw{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new aw(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async u=>u(t.origin,s)),l=await jX(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}aw.receivers=[];function JI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class VX{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=JI("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Uo(){return window}function GX(n){Uo().location.href=n}function b6(){return typeof Uo().WorkerGlobalScope<"u"&&typeof Uo().importScripts=="function"}async function BX(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function UX(){return navigator?.serviceWorker?.controller||null}function zX(){return b6()?self:null}const I6="firebaseLocalStorageDb",$X=1,Rx="firebaseLocalStorage",A6="fbase_key";class l1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ow(n,e){return n.transaction([Rx],e?"readwrite":"readonly").objectStore(Rx)}function WX(){const n=indexedDB.deleteDatabase(I6);return new l1(n).toPromise()}function jT(){const n=indexedDB.open(I6,$X);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Rx,{keyPath:A6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Rx)?e(r):(r.close(),await WX(),e(await jT()))})})}async function xM(n,e,t){const r=ow(n,!0).put({[A6]:e,value:t});return new l1(r).toPromise()}async function HX(n,e){const t=ow(n,!1).get(e),r=await new l1(t).toPromise();return r===void 0?null:r.value}function vM(n,e){const t=ow(n,!0).delete(e);return new l1(t).toPromise()}const KX=800,YX=3;class R6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>YX)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return b6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=aw._getInstance(zX()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await BX(),!this.activeServiceWorker)return;this.sender=new VX(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||UX()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jT();return await xM(e,Ax,"1"),await vM(e,Ax),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>xM(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>HX(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vM(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ow(i,!1).getAll();return new l1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),KX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}R6.type="LOCAL";const XX=R6;new s1(3e4,6e4);function C6(n,e){return e?Al(e):(Kt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class eA extends y6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Zf(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Zf(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Zf(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function qX(n){return MX(n.auth,new eA(n),n.bypassAuthState)}function ZX(n){const{auth:e,user:t}=n;return Kt(t,e,"internal-error"),PX(t,new eA(n),n.bypassAuthState)}async function QX(n){const{auth:e,user:t}=n;return Kt(t,e,"internal-error"),kX(t,new eA(n),n.bypassAuthState)}class k6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qX;case"linkViaPopup":case"linkViaRedirect":return QX;case"reauthViaPopup":case"reauthViaRedirect":return ZX;default:Zo(this.auth,"internal-error")}}resolve(e){zl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const JX=new s1(2e3,1e4);async function eq(n,e,t){if(Zs(n.app))return Promise.reject(io(n,"operation-not-supported-in-this-environment"));const r=a1(n);XY(n,e,QI);const i=C6(r,t);return new Sh(r,"signInViaPopup",e,i).executeNotNull()}class Sh extends k6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Sh.currentPopupAction&&Sh.currentPopupAction.cancel(),Sh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Kt(e,this.auth,"internal-error"),e}async onExecution(){zl(this.filter.length===1,"Popup operations only handle one event");const e=JI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(io(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(io(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Sh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(io(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,JX.get())};e()}}Sh.currentPopupAction=null;const tq="pendingRedirect",k_=new Map;class nq extends k6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=k_.get(this.auth._key());if(!e){try{const r=await rq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}k_.set(this.auth._key(),e)}return this.bypassAuthState||k_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function rq(n,e){const t=aq(e),r=sq(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function iq(n,e){k_.set(n._key(),e)}function sq(n){return Al(n._redirectPersistence)}function aq(n){return C_(tq,n.config.apiKey,n.name)}async function oq(n,e,t=!1){if(Zs(n.app))return Promise.reject(iu(n));const r=a1(n),i=C6(r,e),a=await new nq(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const lq=600*1e3;class cq{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uq(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!P6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(io(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lq&&this.cachedEventUids.clear(),this.cachedEventUids.has(wM(e))}saveEventToCache(e){this.cachedEventUids.add(wM(e)),this.lastProcessedEventTime=Date.now()}}function wM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function P6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function uq(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return P6(n);default:return!1}}async function hq(n,e={}){return B0(n,"GET","/v1/projects",e)}const dq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fq=/^https?/;async function gq(n){if(n.config.emulator)return;const{authorizedDomains:e}=await hq(n);for(const t of e)try{if(mq(t))return}catch{}Zo(n,"unauthorized-domain")}function mq(n){const e=DT(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!fq.test(t))return!1;if(dq.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const pq=new s1(3e4,6e4);function EM(){const n=Uo().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function yq(n){return new Promise((e,t)=>{function r(){EM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{EM(),t(io(n,"network-request-failed"))},timeout:pq.get()})}if(Uo().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Uo().gapi?.load)r();else{const i=wX("iframefcb");return Uo()[i]=()=>{gapi.load?r():t(io(n,"network-request-failed"))},xX(`${vX()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw P_=null,e})}let P_=null;function _q(n){return P_=P_||yq(n),P_}const xq=new s1(5e3,15e3),vq="__/auth/iframe",wq="emulator/auth/iframe",Eq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Sq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Tq(n){const e=n.config;Kt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?YI(e,wq):`https://${n.config.authDomain}/${vq}`,r={apiKey:e.apiKey,appName:n.name,v:yd},i=Sq.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${i1(r).slice(1)}`}async function bq(n){const e=await _q(n),t=Uo().gapi;return Kt(t,n,"internal-error"),e.open({where:document.body,url:Tq(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Eq,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=io(n,"network-request-failed"),o=Uo().setTimeout(()=>{s(a)},xq.get());function l(){Uo().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const Iq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Aq=500,Rq=600,Cq="_blank",kq="http://localhost";class SM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Pq(n,e,t,r=Aq,i=Rq){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...Iq,width:r.toString(),height:i.toString(),top:s,left:a},u=ii().toLowerCase();t&&(o=c6(u)?Cq:t),o6(u)&&(e=e||kq,l.scrollbars="yes");const h=Object.entries(l).reduce((g,[y,v])=>`${g}${y}=${v},`,"");if(hX(u)&&o!=="_self")return Mq(e||"",o),new SM(null);const f=window.open(e||"",o,h);Kt(f,n,"popup-blocked");try{f.focus()}catch{}return new SM(f)}function Mq(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Nq="__/auth/handler",Lq="emulator/auth/handler",Oq=encodeURIComponent("fac");async function TM(n,e,t,r,i,s){Kt(n.config.authDomain,n,"auth-domain-config-required"),Kt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:yd,eventId:i};if(e instanceof QI){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",OK(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(e instanceof o1){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),u=l?`#${Oq}=${encodeURIComponent(l)}`:"";return`${Dq(n)}?${i1(o).slice(1)}${u}`}function Dq({config:n}){return n.emulator?YI(n,Lq):`https://${n.authDomain}/${Nq}`}const gS="webStorageSupport";class Fq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=T6,this._completeRedirectFn=oq,this._overrideRedirectResult=iq}async _openPopup(e,t,r,i){zl(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await TM(e,t,r,DT(),i);return Pq(e,s,JI())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await TM(e,t,r,DT(),i);return GX(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(zl(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await bq(e),r=new cq(e);return t.register("authEvent",i=>(Kt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gS,{type:gS},i=>{const s=i?.[0]?.[gS];s!==void 0&&t(!!s),Zo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=gq(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return g6()||l6()||qI()}}const jq=Fq;var bM="@firebase/auth",IM="1.12.0";class Vq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Kt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Gq(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Bq(n){Kh(new uu("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Kt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:m6(n)},u=new yX(r,i,s,l);return SX(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Kh(new uu("auth-internal",e=>{const t=a1(e.getProvider("auth").getImmediate());return(r=>new Vq(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bo(bM,IM,Gq(n)),Bo(bM,IM,"esm2020")}const Uq=300,zq=UD("authIdTokenMaxAge")||Uq;let AM=null;const $q=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>zq)return;const i=t?.token;AM!==i&&(AM=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Wq(n=WI()){const e=iw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=EX(n,{popupRedirectResolver:jq,persistence:[XX,FX,T6]}),r=UD("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=$q(s.toString());LX(t,a,()=>a(t.currentUser)),NX(t,o=>a(o))}}const i=VD("auth");return i&&TX(t,`http://${i}`),t}function Hq(){return document.getElementsByTagName("head")?.[0]??document}_X({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=io("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Hq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Bq("Browser");var Kq="firebase",Yq="12.7.0";Bo(Kq,Yq,"app");var RM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var su,M6;(function(){var n;function e(R,C){function P(){}P.prototype=C.prototype,R.F=C.prototype,R.prototype=new P,R.prototype.constructor=R,R.D=function(N,O,z){for(var j=Array(arguments.length-2),be=2;be<arguments.length;be++)j[be-2]=arguments[be];return C.prototype[O].apply(N,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(R,C,P){P||(P=0);const N=Array(16);if(typeof C=="string")for(var O=0;O<16;++O)N[O]=C.charCodeAt(P++)|C.charCodeAt(P++)<<8|C.charCodeAt(P++)<<16|C.charCodeAt(P++)<<24;else for(O=0;O<16;++O)N[O]=C[P++]|C[P++]<<8|C[P++]<<16|C[P++]<<24;C=R.g[0],P=R.g[1],O=R.g[2];let z=R.g[3],j;j=C+(z^P&(O^z))+N[0]+3614090360&4294967295,C=P+(j<<7&4294967295|j>>>25),j=z+(O^C&(P^O))+N[1]+3905402710&4294967295,z=C+(j<<12&4294967295|j>>>20),j=O+(P^z&(C^P))+N[2]+606105819&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(C^O&(z^C))+N[3]+3250441966&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(z^P&(O^z))+N[4]+4118548399&4294967295,C=P+(j<<7&4294967295|j>>>25),j=z+(O^C&(P^O))+N[5]+1200080426&4294967295,z=C+(j<<12&4294967295|j>>>20),j=O+(P^z&(C^P))+N[6]+2821735955&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(C^O&(z^C))+N[7]+4249261313&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(z^P&(O^z))+N[8]+1770035416&4294967295,C=P+(j<<7&4294967295|j>>>25),j=z+(O^C&(P^O))+N[9]+2336552879&4294967295,z=C+(j<<12&4294967295|j>>>20),j=O+(P^z&(C^P))+N[10]+4294925233&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(C^O&(z^C))+N[11]+2304563134&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(z^P&(O^z))+N[12]+1804603682&4294967295,C=P+(j<<7&4294967295|j>>>25),j=z+(O^C&(P^O))+N[13]+4254626195&4294967295,z=C+(j<<12&4294967295|j>>>20),j=O+(P^z&(C^P))+N[14]+2792965006&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(C^O&(z^C))+N[15]+1236535329&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(O^z&(P^O))+N[1]+4129170786&4294967295,C=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(C^P))+N[6]+3225465664&4294967295,z=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(z^C))+N[11]+643717713&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^C&(O^z))+N[0]+3921069994&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(O^z&(P^O))+N[5]+3593408605&4294967295,C=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(C^P))+N[10]+38016083&4294967295,z=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(z^C))+N[15]+3634488961&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^C&(O^z))+N[4]+3889429448&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(O^z&(P^O))+N[9]+568446438&4294967295,C=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(C^P))+N[14]+3275163606&4294967295,z=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(z^C))+N[3]+4107603335&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^C&(O^z))+N[8]+1163531501&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(O^z&(P^O))+N[13]+2850285829&4294967295,C=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(C^P))+N[2]+4243563512&4294967295,z=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(z^C))+N[7]+1735328473&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^C&(O^z))+N[12]+2368359562&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(P^O^z)+N[5]+4294588738&4294967295,C=P+(j<<4&4294967295|j>>>28),j=z+(C^P^O)+N[8]+2272392833&4294967295,z=C+(j<<11&4294967295|j>>>21),j=O+(z^C^P)+N[11]+1839030562&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^C)+N[14]+4259657740&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(P^O^z)+N[1]+2763975236&4294967295,C=P+(j<<4&4294967295|j>>>28),j=z+(C^P^O)+N[4]+1272893353&4294967295,z=C+(j<<11&4294967295|j>>>21),j=O+(z^C^P)+N[7]+4139469664&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^C)+N[10]+3200236656&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(P^O^z)+N[13]+681279174&4294967295,C=P+(j<<4&4294967295|j>>>28),j=z+(C^P^O)+N[0]+3936430074&4294967295,z=C+(j<<11&4294967295|j>>>21),j=O+(z^C^P)+N[3]+3572445317&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^C)+N[6]+76029189&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(P^O^z)+N[9]+3654602809&4294967295,C=P+(j<<4&4294967295|j>>>28),j=z+(C^P^O)+N[12]+3873151461&4294967295,z=C+(j<<11&4294967295|j>>>21),j=O+(z^C^P)+N[15]+530742520&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^C)+N[2]+3299628645&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(O^(P|~z))+N[0]+4096336452&4294967295,C=P+(j<<6&4294967295|j>>>26),j=z+(P^(C|~O))+N[7]+1126891415&4294967295,z=C+(j<<10&4294967295|j>>>22),j=O+(C^(z|~P))+N[14]+2878612391&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~C))+N[5]+4237533241&4294967295,P=O+(j<<21&4294967295|j>>>11),j=C+(O^(P|~z))+N[12]+1700485571&4294967295,C=P+(j<<6&4294967295|j>>>26),j=z+(P^(C|~O))+N[3]+2399980690&4294967295,z=C+(j<<10&4294967295|j>>>22),j=O+(C^(z|~P))+N[10]+4293915773&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~C))+N[1]+2240044497&4294967295,P=O+(j<<21&4294967295|j>>>11),j=C+(O^(P|~z))+N[8]+1873313359&4294967295,C=P+(j<<6&4294967295|j>>>26),j=z+(P^(C|~O))+N[15]+4264355552&4294967295,z=C+(j<<10&4294967295|j>>>22),j=O+(C^(z|~P))+N[6]+2734768916&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~C))+N[13]+1309151649&4294967295,P=O+(j<<21&4294967295|j>>>11),j=C+(O^(P|~z))+N[4]+4149444226&4294967295,C=P+(j<<6&4294967295|j>>>26),j=z+(P^(C|~O))+N[11]+3174756917&4294967295,z=C+(j<<10&4294967295|j>>>22),j=O+(C^(z|~P))+N[2]+718787259&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~C))+N[9]+3951481745&4294967295,R.g[0]=R.g[0]+C&4294967295,R.g[1]=R.g[1]+(O+(j<<21&4294967295|j>>>11))&4294967295,R.g[2]=R.g[2]+O&4294967295,R.g[3]=R.g[3]+z&4294967295}r.prototype.v=function(R,C){C===void 0&&(C=R.length);const P=C-this.blockSize,N=this.C;let O=this.h,z=0;for(;z<C;){if(O==0)for(;z<=P;)i(this,R,z),z+=this.blockSize;if(typeof R=="string"){for(;z<C;)if(N[O++]=R.charCodeAt(z++),O==this.blockSize){i(this,N),O=0;break}}else for(;z<C;)if(N[O++]=R[z++],O==this.blockSize){i(this,N),O=0;break}}this.h=O,this.o+=C},r.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var C=1;C<R.length-8;++C)R[C]=0;C=this.o*8;for(var P=R.length-8;P<R.length;++P)R[P]=C&255,C/=256;for(this.v(R),R=Array(16),C=0,P=0;P<4;++P)for(let N=0;N<32;N+=8)R[C++]=this.g[P]>>>N&255;return R};function s(R,C){var P=o;return Object.prototype.hasOwnProperty.call(P,R)?P[R]:P[R]=C(R)}function a(R,C){this.h=C;const P=[];let N=!0;for(let O=R.length-1;O>=0;O--){const z=R[O]|0;N&&z==C||(P[O]=z,N=!1)}this.g=P}var o={};function l(R){return-128<=R&&R<128?s(R,function(C){return new a([C|0],C<0?-1:0)}):new a([R|0],R<0?-1:0)}function u(R){if(isNaN(R)||!isFinite(R))return f;if(R<0)return E(u(-R));const C=[];let P=1;for(let N=0;R>=P;N++)C[N]=R/P|0,P*=4294967296;return new a(C,0)}function h(R,C){if(R.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(R.charAt(0)=="-")return E(h(R.substring(1),C));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=u(Math.pow(C,8));let N=f;for(let z=0;z<R.length;z+=8){var O=Math.min(8,R.length-z);const j=parseInt(R.substring(z,z+O),C);O<8?(O=u(Math.pow(C,O)),N=N.j(O).add(u(j))):(N=N.j(P),N=N.add(u(j)))}return N}var f=l(0),g=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-E(this).m();let R=0,C=1;for(let P=0;P<this.g.length;P++){const N=this.i(P);R+=(N>=0?N:4294967296+N)*C,C*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(v(this))return"0";if(x(this))return"-"+E(this).toString(R);const C=u(Math.pow(R,6));var P=this;let N="";for(;;){const O=M(P,C).g;P=T(P,O.j(C));let z=((P.g.length>0?P.g[0]:P.h)>>>0).toString(R);if(P=O,v(P))return z+N;for(;z.length<6;)z="0"+z;N=z+N}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function v(R){if(R.h!=0)return!1;for(let C=0;C<R.g.length;C++)if(R.g[C]!=0)return!1;return!0}function x(R){return R.h==-1}n.l=function(R){return R=T(this,R),x(R)?-1:v(R)?0:1};function E(R){const C=R.g.length,P=[];for(let N=0;N<C;N++)P[N]=~R.g[N];return new a(P,~R.h).add(g)}n.abs=function(){return x(this)?E(this):this},n.add=function(R){const C=Math.max(this.g.length,R.g.length),P=[];let N=0;for(let O=0;O<=C;O++){let z=N+(this.i(O)&65535)+(R.i(O)&65535),j=(z>>>16)+(this.i(O)>>>16)+(R.i(O)>>>16);N=j>>>16,z&=65535,j&=65535,P[O]=j<<16|z}return new a(P,P[P.length-1]&-2147483648?-1:0)};function T(R,C){return R.add(E(C))}n.j=function(R){if(v(this)||v(R))return f;if(x(this))return x(R)?E(this).j(E(R)):E(E(this).j(R));if(x(R))return E(this.j(E(R)));if(this.l(y)<0&&R.l(y)<0)return u(this.m()*R.m());const C=this.g.length+R.g.length,P=[];for(var N=0;N<2*C;N++)P[N]=0;for(N=0;N<this.g.length;N++)for(let O=0;O<R.g.length;O++){const z=this.i(N)>>>16,j=this.i(N)&65535,be=R.i(O)>>>16,Pe=R.i(O)&65535;P[2*N+2*O]+=j*Pe,b(P,2*N+2*O),P[2*N+2*O+1]+=z*Pe,b(P,2*N+2*O+1),P[2*N+2*O+1]+=j*be,b(P,2*N+2*O+1),P[2*N+2*O+2]+=z*be,b(P,2*N+2*O+2)}for(R=0;R<C;R++)P[R]=P[2*R+1]<<16|P[2*R];for(R=C;R<2*C;R++)P[R]=0;return new a(P,0)};function b(R,C){for(;(R[C]&65535)!=R[C];)R[C+1]+=R[C]>>>16,R[C]&=65535,C++}function I(R,C){this.g=R,this.h=C}function M(R,C){if(v(C))throw Error("division by zero");if(v(R))return new I(f,f);if(x(R))return C=M(E(R),C),new I(E(C.g),E(C.h));if(x(C))return C=M(R,E(C)),new I(E(C.g),C.h);if(R.g.length>30){if(x(R)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var P=g,N=C;N.l(R)<=0;)P=F(P),N=F(N);var O=G(P,1),z=G(N,1);for(N=G(N,2),P=G(P,2);!v(N);){var j=z.add(N);j.l(R)<=0&&(O=O.add(P),z=j),N=G(N,1),P=G(P,1)}return C=T(R,O.j(C)),new I(O,C)}for(O=f;R.l(C)>=0;){for(P=Math.max(1,Math.floor(R.m()/C.m())),N=Math.ceil(Math.log(P)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),z=u(P),j=z.j(C);x(j)||j.l(R)>0;)P-=N,z=u(P),j=z.j(C);v(z)&&(z=g),O=O.add(z),R=T(R,j)}return new I(O,R)}n.B=function(R){return M(this,R).h},n.and=function(R){const C=Math.max(this.g.length,R.g.length),P=[];for(let N=0;N<C;N++)P[N]=this.i(N)&R.i(N);return new a(P,this.h&R.h)},n.or=function(R){const C=Math.max(this.g.length,R.g.length),P=[];for(let N=0;N<C;N++)P[N]=this.i(N)|R.i(N);return new a(P,this.h|R.h)},n.xor=function(R){const C=Math.max(this.g.length,R.g.length),P=[];for(let N=0;N<C;N++)P[N]=this.i(N)^R.i(N);return new a(P,this.h^R.h)};function F(R){const C=R.g.length+1,P=[];for(let N=0;N<C;N++)P[N]=R.i(N)<<1|R.i(N-1)>>>31;return new a(P,R.h)}function G(R,C){const P=C>>5;C%=32;const N=R.g.length-P,O=[];for(let z=0;z<N;z++)O[z]=C>0?R.i(z+P)>>>C|R.i(z+P+1)<<32-C:R.i(z+P);return new a(O,R.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,M6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,su=a}).apply(typeof RM<"u"?RM:typeof self<"u"?self:typeof window<"u"?window:{});var Qy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var N6,im,L6,M_,VT,O6,D6,F6;(function(){var n,e=Object.defineProperty;function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qy=="object"&&Qy];for(var k=0;k<_.length;++k){var D=_[k];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var r=t(this);function i(_,k){if(k)e:{var D=r;_=_.split(".");for(var H=0;H<_.length-1;H++){var ge=_[H];if(!(ge in D))break e;D=D[ge]}_=_[_.length-1],H=D[_],k=k(H),k!=H&&k!=null&&e(D,_,{configurable:!0,writable:!0,value:k})}}i("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(_){return _||function(k){var D=[],H;for(H in k)Object.prototype.hasOwnProperty.call(k,H)&&D.push([H,k[H]]);return D}});var s=s||{},a=this||self;function o(_){var k=typeof _;return k=="object"&&_!=null||k=="function"}function l(_,k,D){return _.call.apply(_.bind,arguments)}function u(_,k,D){return u=l,u.apply(null,arguments)}function h(_,k){var D=Array.prototype.slice.call(arguments,1);return function(){var H=D.slice();return H.push.apply(H,arguments),_.apply(this,H)}}function f(_,k){function D(){}D.prototype=k.prototype,_.Z=k.prototype,_.prototype=new D,_.prototype.constructor=_,_.Ob=function(H,ge,Re){for(var it=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)it[Zt-2]=arguments[Zt];return k.prototype[ge].apply(H,it)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function y(_){const k=_.length;if(k>0){const D=Array(k);for(let H=0;H<k;H++)D[H]=_[H];return D}return[]}function v(_,k){for(let H=1;H<arguments.length;H++){const ge=arguments[H];var D=typeof ge;if(D=D!="object"?D:ge?Array.isArray(ge)?"array":D:"null",D=="array"||D=="object"&&typeof ge.length=="number"){D=_.length||0;const Re=ge.length||0;_.length=D+Re;for(let it=0;it<Re;it++)_[D+it]=ge[it]}else _.push(ge)}}class x{constructor(k,D){this.i=k,this.j=D,this.h=0,this.g=null}get(){let k;return this.h>0?(this.h--,k=this.g,this.g=k.next,k.next=null):k=this.i(),k}}function E(_){a.setTimeout(()=>{throw _},0)}function T(){var _=R;let k=null;return _.g&&(k=_.g,_.g=_.g.next,_.g||(_.h=null),k.next=null),k}class b{constructor(){this.h=this.g=null}add(k,D){const H=I.get();H.set(k,D),this.h?this.h.next=H:this.g=H,this.h=H}}var I=new x(()=>new M,_=>_.reset());class M{constructor(){this.next=this.g=this.h=null}set(k,D){this.h=k,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let F,G=!1,R=new b,C=()=>{const _=Promise.resolve(void 0);F=()=>{_.then(P)}};function P(){for(var _;_=T();){try{_.h.call(_.g)}catch(D){E(D)}var k=I;k.j(_),k.h<100&&(k.h++,_.next=k.g,k.g=_)}G=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(_,k){this.type=_,this.g=this.target=k,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,k=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const D=()=>{};a.addEventListener("test",D,k),a.removeEventListener("test",D,k)}catch{}return _})();function j(_){return/^[\s\xa0]*$/.test(_)}function be(_,k){O.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,k)}f(be,O),be.prototype.init=function(_,k){const D=this.type=_.type,H=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=k,k=_.relatedTarget,k||(D=="mouseover"?k=_.fromElement:D=="mouseout"&&(k=_.toElement)),this.relatedTarget=k,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&be.Z.h.call(this)},be.prototype.h=function(){be.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Pe="closure_listenable_"+(Math.random()*1e6|0),je=0;function Ne(_,k,D,H,ge){this.listener=_,this.proxy=null,this.src=k,this.type=D,this.capture=!!H,this.ha=ge,this.key=++je,this.da=this.fa=!1}function ue(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function Te(_,k,D){for(const H in _)k.call(D,_[H],H,_)}function le(_,k){for(const D in _)k.call(void 0,_[D],D,_)}function se(_){const k={};for(const D in _)k[D]=_[D];return k}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(_,k){let D,H;for(let ge=1;ge<arguments.length;ge++){H=arguments[ge];for(D in H)_[D]=H[D];for(let Re=0;Re<V.length;Re++)D=V[Re],Object.prototype.hasOwnProperty.call(H,D)&&(_[D]=H[D])}}function ne(_){this.src=_,this.g={},this.h=0}ne.prototype.add=function(_,k,D,H,ge){const Re=_.toString();_=this.g[Re],_||(_=this.g[Re]=[],this.h++);const it=pe(_,k,H,ge);return it>-1?(k=_[it],D||(k.fa=!1)):(k=new Ne(k,this.src,Re,!!H,ge),k.fa=D,_.push(k)),k};function ie(_,k){const D=k.type;if(D in _.g){var H=_.g[D],ge=Array.prototype.indexOf.call(H,k,void 0),Re;(Re=ge>=0)&&Array.prototype.splice.call(H,ge,1),Re&&(ue(k),_.g[D].length==0&&(delete _.g[D],_.h--))}}function pe(_,k,D,H){for(let ge=0;ge<_.length;++ge){const Re=_[ge];if(!Re.da&&Re.listener==k&&Re.capture==!!D&&Re.ha==H)return ge}return-1}var De="closure_lm_"+(Math.random()*1e6|0),Be={};function Ue(_,k,D,H,ge){if(Array.isArray(k)){for(let Re=0;Re<k.length;Re++)Ue(_,k[Re],D,H,ge);return null}return D=Zn(D),_&&_[Pe]?_.J(k,D,o(H)?!!H.capture:!1,ge):_e(_,k,D,!1,H,ge)}function _e(_,k,D,H,ge,Re){if(!k)throw Error("Invalid event type");const it=o(ge)?!!ge.capture:!!ge;let Zt=Qt(_);if(Zt||(_[De]=Zt=new ne(_)),D=Zt.add(k,D,H,it,Re),D.proxy)return D;if(H=Ct(),D.proxy=H,H.src=_,H.listener=D,_.addEventListener)z||(ge=it),ge===void 0&&(ge=!1),_.addEventListener(k.toString(),H,ge);else if(_.attachEvent)_.attachEvent(Mt(k.toString()),H);else if(_.addListener&&_.removeListener)_.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return D}function Ct(){function _(D){return k.call(_.src,_.listener,D)}const k=jn;return _}function kt(_,k,D,H,ge){if(Array.isArray(k))for(var Re=0;Re<k.length;Re++)kt(_,k[Re],D,H,ge);else H=o(H)?!!H.capture:!!H,D=Zn(D),_&&_[Pe]?(_=_.i,Re=String(k).toString(),Re in _.g&&(k=_.g[Re],D=pe(k,D,H,ge),D>-1&&(ue(k[D]),Array.prototype.splice.call(k,D,1),k.length==0&&(delete _.g[Re],_.h--)))):_&&(_=Qt(_))&&(k=_.g[k.toString()],_=-1,k&&(_=pe(k,D,H,ge)),(D=_>-1?k[_]:null)&&hn(D))}function hn(_){if(typeof _!="number"&&_&&!_.da){var k=_.src;if(k&&k[Pe])ie(k.i,_);else{var D=_.type,H=_.proxy;k.removeEventListener?k.removeEventListener(D,H,_.capture):k.detachEvent?k.detachEvent(Mt(D),H):k.addListener&&k.removeListener&&k.removeListener(H),(D=Qt(k))?(ie(D,_),D.h==0&&(D.src=null,k[De]=null)):ue(_)}}}function Mt(_){return _ in Be?Be[_]:Be[_]="on"+_}function jn(_,k){if(_.da)_=!0;else{k=new be(k,this);const D=_.listener,H=_.ha||_.src;_.fa&&hn(_),_=D.call(H,k)}return _}function Qt(_){return _=_[De],_ instanceof ne?_:null}var ot="__closure_events_fn_"+(Math.random()*1e9>>>0);function Zn(_){return typeof _=="function"?_:(_[ot]||(_[ot]=function(k){return _.handleEvent(k)}),_[ot])}function on(){N.call(this),this.i=new ne(this),this.M=this,this.G=null}f(on,N),on.prototype[Pe]=!0,on.prototype.removeEventListener=function(_,k,D,H){kt(this,_,k,D,H)};function en(_,k){var D,H=_.G;if(H)for(D=[];H;H=H.G)D.push(H);if(_=_.M,H=k.type||k,typeof k=="string")k=new O(k,_);else if(k instanceof O)k.target=k.target||_;else{var ge=k;k=new O(H,_),Q(k,ge)}ge=!0;let Re,it;if(D)for(it=D.length-1;it>=0;it--)Re=k.g=D[it],ge=Qn(Re,H,!0,k)&&ge;if(Re=k.g=_,ge=Qn(Re,H,!0,k)&&ge,ge=Qn(Re,H,!1,k)&&ge,D)for(it=0;it<D.length;it++)Re=k.g=D[it],ge=Qn(Re,H,!1,k)&&ge}on.prototype.N=function(){if(on.Z.N.call(this),this.i){var _=this.i;for(const k in _.g){const D=_.g[k];for(let H=0;H<D.length;H++)ue(D[H]);delete _.g[k],_.h--}}this.G=null},on.prototype.J=function(_,k,D,H){return this.i.add(String(_),k,!1,D,H)},on.prototype.K=function(_,k,D,H){return this.i.add(String(_),k,!0,D,H)};function Qn(_,k,D,H){if(k=_.i.g[String(k)],!k)return!0;k=k.concat();let ge=!0;for(let Re=0;Re<k.length;++Re){const it=k[Re];if(it&&!it.da&&it.capture==D){const Zt=it.listener,Dr=it.ha||it.src;it.fa&&ie(_.i,it),ge=Zt.call(Dr,H)!==!1&&ge}}return ge&&!H.defaultPrevented}function mt(_,k){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=u(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(k)>2147483647?-1:a.setTimeout(_,k||0)}function Bt(_){_.g=mt(()=>{_.g=null,_.i&&(_.i=!1,Bt(_))},_.l);const k=_.h;_.h=null,_.m.apply(null,k)}class Mn extends N{constructor(k,D){super(),this.m=k,this.l=D,this.h=null,this.i=!1,this.g=null}j(k){this.h=arguments,this.g?this.i=!0:Bt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _t(_){N.call(this),this.h=_,this.g={}}f(_t,N);var Jt=[];function Pt(_){Te(_.g,function(k,D){this.g.hasOwnProperty(D)&&hn(k)},_),_.g={}}_t.prototype.N=function(){_t.Z.N.call(this),Pt(this)},_t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sr=a.JSON.stringify,ai=a.JSON.parse,Br=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function zt(){}function ns(){}var Oe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ee(){O.call(this,"d")}f(Ee,O);function me(){O.call(this,"c")}f(me,O);var Nt={},L=null;function Lt(){return L=L||new on}Nt.Ia="serverreachability";function W(_){O.call(this,Nt.Ia,_)}f(W,O);function q(_){const k=Lt();en(k,new W(k))}Nt.STAT_EVENT="statevent";function X(_,k){O.call(this,Nt.STAT_EVENT,_),this.stat=k}f(X,O);function ce(_){const k=Lt();en(k,new X(k,_))}Nt.Ja="timingevent";function he(_,k){O.call(this,Nt.Ja,_),this.size=k}f(he,O);function Ve(_,k){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},k)}function Ie(){this.g=!0}Ie.prototype.ua=function(){this.g=!1};function $e(_,k,D,H,ge,Re){_.info(function(){if(_.g)if(Re){var it="",Zt=Re.split("&");for(let Gn=0;Gn<Zt.length;Gn++){var Dr=Zt[Gn].split("=");if(Dr.length>1){const Ur=Dr[0];Dr=Dr[1];const Gs=Ur.split("_");it=Gs.length>=2&&Gs[1]=="type"?it+(Ur+"="+Dr+"&"):it+(Ur+"=redacted&")}}}else it=null;else it=Re;return"XMLHTTP REQ ("+H+") [attempt "+ge+"]: "+k+`
`+D+`
`+it})}function et(_,k,D,H,ge,Re,it){_.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ge+"]: "+k+`
`+D+`
`+Re+" "+it})}function ft(_,k,D,H){_.info(function(){return"XMLHTTP TEXT ("+k+"): "+sn(_,D)+(H?" "+H:"")})}function St(_,k){_.info(function(){return"TIMEOUT: "+k})}Ie.prototype.info=function(){};function sn(_,k){if(!_.g)return k;if(!k)return null;try{const Re=JSON.parse(k);if(Re){for(_=0;_<Re.length;_++)if(Array.isArray(Re[_])){var D=Re[_];if(!(D.length<2)){var H=D[1];if(Array.isArray(H)&&!(H.length<1)){var ge=H[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(let it=1;it<H.length;it++)H[it]=""}}}}return sr(Re)}catch{return k}}var dr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},cn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},fr;function vr(){}f(vr,zt),vr.prototype.g=function(){return new XMLHttpRequest},fr=new vr;function Fi(_){return encodeURIComponent(String(_))}function U(_){var k=1;_=_.split(":");const D=[];for(;k>0&&_.length;)D.push(_.shift()),k--;return _.length&&D.push(_.join(":")),D}function Z(_,k,D,H){this.j=_,this.i=k,this.l=D,this.S=H||1,this.V=new _t(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var Y={},J={};function te(_,k,D){_.M=1,_.A=ol(ca(k)),_.u=D,_.R=!0,xe(_,null)}function xe(_,k){_.F=Date.now(),Se(_),_.B=ca(_.A);var D=_.B,H=_.S;Array.isArray(H)||(H=[String(H)]),ag(D.i,"t",H),_.C=0,D=_.j.L,_.h=new K,_.g=U1(_.j,D?k:null,!_.u),_.P>0&&(_.O=new Mn(u(_.Y,_,_.g),_.P)),k=_.V,D=_.g,H=_.ba;var ge="readystatechange";Array.isArray(ge)||(ge&&(Jt[0]=ge.toString()),ge=Jt);for(let Re=0;Re<ge.length;Re++){const it=Ue(D,ge[Re],H||k.handleEvent,!1,k.h||k);if(!it)break;k.g[it.key]=it}k=_.J?se(_.J):{},_.u?(_.v||(_.v="POST"),k["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,k)):(_.v="GET",_.g.ea(_.B,_.v,null,k)),q(),$e(_.i,_.v,_.B,_.l,_.S,_.u)}Z.prototype.ba=function(_){_=_.target;const k=this.O;k&&vo(_)==3?k.j():this.Y(_)},Z.prototype.Y=function(_){try{if(_==this.g)e:{const Zt=vo(this.g),Dr=this.g.ya(),Gn=this.g.ca();if(!(Zt<3)&&(Zt!=3||this.g&&(this.h.h||this.g.la()||G1(this.g)))){this.K||Zt!=4||Dr==7||(Dr==8||Gn<=0?q(3):q(2)),tt(this);var k=this.g.ca();this.X=k;var D=ke(this);if(this.o=k==200,et(this.i,this.v,this.B,this.l,this.S,Zt,k),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ge=this.g;if((H=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var Re=H;break t}}Re=null}if(_=Re)ft(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Xe(this,_);else{this.o=!1,this.m=3,ce(12),Ye(this),gt(this);break e}}if(this.R){_=!0;let Ur;for(;!this.K&&this.C<D.length;)if(Ur=we(this,D),Ur==J){Zt==4&&(this.m=4,ce(14),_=!1),ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Ur==Y){this.m=4,ce(15),ft(this.i,this.l,D,"[Invalid Chunk]"),_=!1;break}else ft(this.i,this.l,Ur,null),Xe(this,Ur);if(ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||D.length!=0||this.h.h||(this.m=1,ce(16),_=!1),this.o=this.o&&_,!_)ft(this.i,this.l,D,"[Invalid Chunked Response]"),Ye(this),gt(this);else if(D.length>0&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.aa&&!it.P&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),Vu(it),it.P=!0,ce(11))}}else ft(this.i,this.l,D,null),Xe(this,D);Zt==4&&Ye(this),this.o&&!this.K&&(Zt==4?Od(this.j,this):(this.o=!1,Se(this)))}else lg(this.g),k==400&&D.indexOf("Unknown SID")>0?(this.m=3,ce(12)):(this.m=0,ce(13)),Ye(this),gt(this)}}}catch{}};function ke(_){if(!ye(_))return _.g.la();const k=G1(_.g);if(k==="")return"";let D="";const H=k.length,ge=vo(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return Ye(_),gt(_),"";_.h.i=new a.TextDecoder}for(let Re=0;Re<H;Re++)_.h.h=!0,D+=_.h.i.decode(k[Re],{stream:!(ge&&Re==H-1)});return k.length=0,_.h.g+=D,_.C=0,_.h.g}function ye(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function we(_,k){var D=_.C,H=k.indexOf(`
`,D);return H==-1?J:(D=Number(k.substring(D,H)),isNaN(D)?Y:(H+=1,H+D>k.length?J:(k=k.slice(H,H+D),_.C=H+D,k)))}Z.prototype.cancel=function(){this.K=!0,Ye(this)};function Se(_){_.T=Date.now()+_.H,Ke(_,_.H)}function Ke(_,k){if(_.D!=null)throw Error("WatchDog timer not null");_.D=Ve(u(_.aa,_),k)}function tt(_){_.D&&(a.clearTimeout(_.D),_.D=null)}Z.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(St(this.i,this.B),this.M!=2&&(q(),ce(17)),Ye(this),this.m=2,gt(this)):Ke(this,this.T-_)};function gt(_){_.j.I==0||_.K||Od(_.j,_)}function Ye(_){tt(_);var k=_.O;k&&typeof k.dispose=="function"&&k.dispose(),_.O=null,Pt(_.V),_.g&&(k=_.g,_.g=null,k.abort(),k.dispose())}function Xe(_,k){try{var D=_.j;if(D.I!=0&&(D.g==_||La(D.h,_))){if(!_.L&&La(D.h,_)&&D.I==3){try{var H=D.Ba.g.parse(k)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ge=H;if(ge[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<_.F)Ld(D),js(D);else break e;So(D),ce(18)}}else D.xa=ge[1],0<D.xa-D.K&&ge[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Ve(u(D.Va,D),6e3));gr(D.h)<=1&&D.ta&&(D.ta=void 0)}else Vs(D,11)}else if((_.L||D.g==_)&&Ld(D),!j(k))for(ge=D.Ba.g.parse(k),k=0;k<ge.length;k++){let Gn=ge[k];const Ur=Gn[0];if(!(Ur<=D.K))if(D.K=Ur,Gn=Gn[1],D.I==2)if(Gn[0]=="c"){D.M=Gn[1],D.ba=Gn[2];const Gs=Gn[3];Gs!=null&&(D.ka=Gs,D.j.info("VER="+D.ka));const dl=Gn[4];dl!=null&&(D.za=dl,D.j.info("SVER="+D.za));const To=Gn[5];To!=null&&typeof To=="number"&&To>0&&(H=1.5*To,D.O=H,D.j.info("backChannelRequestTimeoutMs_="+H)),H=D;const bo=_.g;if(bo){const jd=bo.g?bo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jd){var Re=H.h;Re.g||jd.indexOf("spdy")==-1&&jd.indexOf("quic")==-1&&jd.indexOf("h2")==-1||(Re.j=Re.l,Re.g=new Set,Re.h&&(la(Re,Re.h),Re.h=null))}if(H.G){const hg=bo.g?bo.g.getResponseHeader("X-HTTP-Session-Id"):null;hg&&(H.wa=hg,An(H.J,H.G,hg))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-_.F,D.j.info("Handshake RTT: "+D.T+"ms")),H=D;var it=_;if(H.na=ug(H,H.L?H.ba:null,H.W),it.L){Ds(H.h,it);var Zt=it,Dr=H.O;Dr&&(Zt.H=Dr),Zt.D&&(tt(Zt),Se(Zt)),H.g=it}else ji(H);D.i.length>0&&hl(D)}else Gn[0]!="stop"&&Gn[0]!="close"||Vs(D,7);else D.I==3&&(Gn[0]=="stop"||Gn[0]=="close"?Gn[0]=="stop"?Vs(D,7):Md(D):Gn[0]!="noop"&&D.l&&D.l.qa(Gn),D.A=0)}}q(4)}catch{}}var $t=class{constructor(_,k){this.g=_,this.map=k}};function Nn(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Vn(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function gr(_){return _.h?1:_.g?_.g.size:0}function La(_,k){return _.h?_.h==k:_.g?_.g.has(k):!1}function la(_,k){_.g?_.g.add(k):_.h=k}function Ds(_,k){_.h&&_.h==k?_.h=null:_.g&&_.g.has(k)&&_.g.delete(k)}Nn.prototype.cancel=function(){if(this.i=Or(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Or(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let k=_.i;for(const D of _.g.values())k=k.concat(D.G);return k}return y(_.i)}var nc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wr(_,k){if(_){_=_.split("&");for(let D=0;D<_.length;D++){const H=_[D].indexOf("=");let ge,Re=null;H>=0?(ge=_[D].substring(0,H),Re=_[D].substring(H+1)):ge=_[D],k(ge,Re?decodeURIComponent(Re.replace(/\+/g," ")):"")}}}function go(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let k;_ instanceof go?(this.l=_.l,Nu(this,_.j),this.o=_.o,this.g=_.g,mo(this,_.u),this.h=_.h,rc(this,og(_.i)),this.m=_.m):_&&(k=String(_).match(nc))?(this.l=!1,Nu(this,k[1]||"",!0),this.o=Lu(k[2]||""),this.g=Lu(k[3]||"",!0),mo(this,k[4]),this.h=Lu(k[5]||"",!0),rc(this,k[6]||"",!0),this.m=Lu(k[7]||"")):(this.l=!1,this.i=new mn(null,this.l))}go.prototype.toString=function(){const _=[];var k=this.j;k&&_.push(Ou(k,tg,!0),":");var D=this.g;return(D||k=="file")&&(_.push("//"),(k=this.o)&&_.push(Ou(k,tg,!0),"@"),_.push(Fi(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&_.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&_.push("/"),_.push(Ou(D,D.charAt(0)=="/"?Du:ng,!0))),(D=this.i.toString())&&_.push("?",D),(D=this.m)&&_.push("#",Ou(D,rg)),_.join("")},go.prototype.resolve=function(_){const k=ca(this);let D=!!_.j;D?Nu(k,_.j):D=!!_.o,D?k.o=_.o:D=!!_.g,D?k.g=_.g:D=_.u!=null;var H=_.h;if(D)mo(k,_.u);else if(D=!!_.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ge=k.h.lastIndexOf("/");ge!=-1&&(H=k.h.slice(0,ge+1)+H)}if(ge=H,ge==".."||ge==".")H="";else if(ge.indexOf("./")!=-1||ge.indexOf("/.")!=-1){H=ge.lastIndexOf("/",0)==0,ge=ge.split("/");const Re=[];for(let it=0;it<ge.length;){const Zt=ge[it++];Zt=="."?H&&it==ge.length&&Re.push(""):Zt==".."?((Re.length>1||Re.length==1&&Re[0]!="")&&Re.pop(),H&&it==ge.length&&Re.push("")):(Re.push(Zt),H=!0)}H=Re.join("/")}else H=ge}return D?k.h=H:D=_.i.toString()!=="",D?rc(k,og(_.i)):D=!!_.m,D&&(k.m=_.m),k};function ca(_){return new go(_)}function Nu(_,k,D){_.j=D?Lu(k,!0):k,_.j&&(_.j=_.j.replace(/:$/,""))}function mo(_,k){if(k){if(k=Number(k),isNaN(k)||k<0)throw Error("Bad port number "+k);_.u=k}else _.u=null}function rc(_,k,D){k instanceof mn?(_.i=k,Cd(_.i,_.l)):(D||(k=Ou(k,rE)),_.i=new mn(k,_.l))}function An(_,k,D){_.i.set(k,D)}function ol(_){return An(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function Lu(_,k){return _?k?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Ou(_,k,D){return typeof _=="string"?(_=encodeURI(_).replace(k,eg),D&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function eg(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var tg=/[#\/\?@]/g,ng=/[#\?:]/g,Du=/[#\?]/g,rE=/[#\?@]/g,rg=/#/g;function mn(_,k){this.h=this.g=null,this.i=_||null,this.j=!!k}function po(_){_.g||(_.g=new Map,_.h=0,_.i&&wr(_.i,function(k,D){_.add(decodeURIComponent(k.replace(/\+/g," ")),D)}))}n=mn.prototype,n.add=function(_,k){po(this),this.i=null,_=yo(this,_);let D=this.g.get(_);return D||this.g.set(_,D=[]),D.push(k),this.h+=1,this};function ig(_,k){po(_),k=yo(_,k),_.g.has(k)&&(_.i=null,_.h-=_.g.get(k).length,_.g.delete(k))}function Rd(_,k){return po(_),k=yo(_,k),_.g.has(k)}n.forEach=function(_,k){po(this),this.g.forEach(function(D,H){D.forEach(function(ge){_.call(k,ge,H,this)},this)},this)};function sg(_,k){po(_);let D=[];if(typeof k=="string")Rd(_,k)&&(D=D.concat(_.g.get(yo(_,k))));else for(_=Array.from(_.g.values()),k=0;k<_.length;k++)D=D.concat(_[k]);return D}n.set=function(_,k){return po(this),this.i=null,_=yo(this,_),Rd(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[k]),this.h+=1,this},n.get=function(_,k){return _?(_=sg(this,_),_.length>0?String(_[0]):k):k};function ag(_,k,D){ig(_,k),D.length>0&&(_.i=null,_.g.set(yo(_,k),y(D)),_.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],k=Array.from(this.g.keys());for(let H=0;H<k.length;H++){var D=k[H];const ge=Fi(D);D=sg(this,D);for(let Re=0;Re<D.length;Re++){let it=ge;D[Re]!==""&&(it+="="+Fi(D[Re])),_.push(it)}}return this.i=_.join("&")};function og(_){const k=new mn;return k.i=_.i,_.g&&(k.g=new Map(_.g),k.h=_.h),k}function yo(_,k){return k=String(k),_.j&&(k=k.toLowerCase()),k}function Cd(_,k){k&&!_.j&&(po(_),_.i=null,_.g.forEach(function(D,H){const ge=H.toLowerCase();H!=ge&&(ig(this,H),ag(this,ge,D))},_)),_.j=k}function _o(_,k){const D=new Ie;if(a.Image){const H=new Image;H.onload=h(wi,D,"TestLoadImage: loaded",!0,k,H),H.onerror=h(wi,D,"TestLoadImage: error",!1,k,H),H.onabort=h(wi,D,"TestLoadImage: abort",!1,k,H),H.ontimeout=h(wi,D,"TestLoadImage: timeout",!1,k,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=_}else k(!1)}function xo(_,k){const D=new Ie,H=new AbortController,ge=setTimeout(()=>{H.abort(),wi(D,"TestPingServer: timeout",!1,k)},1e4);fetch(_,{signal:H.signal}).then(Re=>{clearTimeout(ge),Re.ok?wi(D,"TestPingServer: ok",!0,k):wi(D,"TestPingServer: server error",!1,k)}).catch(()=>{clearTimeout(ge),wi(D,"TestPingServer: error",!1,k)})}function wi(_,k,D,H,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),H(D)}catch{}}function Fu(){this.g=new Br}function ll(_){this.i=_.Sb||null,this.h=_.ab||!1}f(ll,zt),ll.prototype.g=function(){return new Fs(this.i,this.h)};function Fs(_,k){on.call(this),this.H=_,this.o=k,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Fs,on),n=Fs.prototype,n.open=function(_,k){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=k,this.readyState=1,Oa(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const k={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(k.body=_),(this.H||a).fetch(new Request(this.D,k)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ic(this)),this.readyState=0},n.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,Oa(this)),this.g&&(this.readyState=3,Oa(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;F1(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function F1(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}n.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var k=_.value?_.value:new Uint8Array(0);(k=this.B.decode(k,{stream:!_.done}))&&(this.response=this.responseText+=k)}_.done?ic(this):Oa(this),this.readyState==3&&F1(this)}},n.Oa=function(_){this.g&&(this.response=this.responseText=_,ic(this))},n.Na=function(_){this.g&&(this.response=_,ic(this))},n.ga=function(){this.g&&ic(this)};function ic(_){_.readyState=4,_.l=null,_.j=null,_.B=null,Oa(_)}n.setRequestHeader=function(_,k){this.A.append(_,k)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],k=this.h.entries();for(var D=k.next();!D.done;)D=D.value,_.push(D[0]+": "+D[1]),D=k.next();return _.join(`\r
`)};function Oa(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(Fs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function j1(_){let k="";return Te(_,function(D,H){k+=H,k+=":",k+=D,k+=`\r
`}),k}function kd(_,k,D){e:{for(H in D){var H=!1;break e}H=!0}H||(D=j1(D),typeof _=="string"?D!=null&&Fi(D):An(_,k,D))}function Jn(_){on.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Jn,on);var V1=/^https?$/i,iE=["POST","PUT"];n=Jn.prototype,n.Fa=function(_){this.H=_},n.ea=function(_,k,D,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);k=k?k.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():fr.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(k,String(_),!0),this.B=!1}catch(Re){sc(this,Re);return}if(_=D||"",D=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ge in H)D.set(ge,H[ge]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Re of H.keys())D.set(Re,H.get(Re));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(D.keys()).find(Re=>Re.toLowerCase()=="content-type"),ge=a.FormData&&_ instanceof a.FormData,!(Array.prototype.indexOf.call(iE,k,void 0)>=0)||H||ge||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Re,it]of D)this.g.setRequestHeader(Re,it);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(Re){sc(this,Re)}};function sc(_,k){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=k,_.o=5,ac(_),ul(_)}function ac(_){_.A||(_.A=!0,en(_,"complete"),en(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,en(this,"complete"),en(this,"abort"),ul(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ul(this,!0)),Jn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?cl(this):this.Xa())},n.Xa=function(){cl(this)};function cl(_){if(_.h&&typeof s<"u"){if(_.v&&vo(_)==4)setTimeout(_.Ca.bind(_),0);else if(en(_,"readystatechange"),vo(_)==4){_.h=!1;try{const Re=_.ca();e:switch(Re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var k=!0;break e;default:k=!1}var D;if(!(D=k)){var H;if(H=Re===0){let it=String(_.D).match(nc)[1]||null;!it&&a.self&&a.self.location&&(it=a.self.location.protocol.slice(0,-1)),H=!V1.test(it?it.toLowerCase():"")}D=H}if(D)en(_,"complete"),en(_,"success");else{_.o=6;try{var ge=vo(_)>2?_.g.statusText:""}catch{ge=""}_.l=ge+" ["+_.ca()+"]",ac(_)}}finally{ul(_)}}}}function ul(_,k){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const D=_.g;_.g=null,k||en(_,"ready");try{D.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function vo(_){return _.g?_.g.readyState:0}n.ca=function(){try{return vo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(_){if(this.g){var k=this.g.responseText;return _&&k.indexOf(_)==0&&(k=k.substring(_.length)),ai(k)}};function G1(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function lg(_){const k={};_=(_.g&&vo(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<_.length;H++){if(j(_[H]))continue;var D=U(_[H]);const ge=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Re=k[ge]||[];k[ge]=Re,Re.push(D)}le(k,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wo(_,k,D){return D&&D.internalChannelParams&&D.internalChannelParams[_]||k}function Pd(_){this.za=0,this.i=[],this.j=new Ie,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wo("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wo("baseRetryDelayMs",5e3,_),this.Za=wo("retryDelaySeedMs",1e4,_),this.Ta=wo("forwardChannelMaxRetries",2,_),this.va=wo("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new Nn(_&&_.concurrentRequestLimit),this.Ba=new Fu,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Pd.prototype,n.ka=8,n.I=1,n.connect=function(_,k,D,H){ce(0),this.W=_,this.H=k||{},D&&H!==void 0&&(this.H.OSID=D,this.H.OAID=H),this.F=this.X,this.J=ug(this,null,this.W),hl(this)};function Md(_){if(Nd(_),_.I==3){var k=_.V++,D=ca(_.J);if(An(D,"SID",_.M),An(D,"RID",k),An(D,"TYPE","terminate"),Eo(_,D),k=new Z(_,_.j,k),k.M=2,k.A=ol(ca(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(k.A.toString(),"")}catch{}!D&&a.Image&&(new Image().src=k.A,D=!0),D||(k.g=U1(k.j,null),k.g.ea(k.A)),k.F=Date.now(),Se(k)}Gu(_)}function js(_){_.g&&(Vu(_),_.g.cancel(),_.g=null)}function Nd(_){js(_),_.v&&(a.clearTimeout(_.v),_.v=null),Ld(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&a.clearTimeout(_.m),_.m=null)}function hl(_){if(!Vn(_.h)&&!_.m){_.m=!0;var k=_.Ea;F||C(),G||(F(),G=!0),R.add(k,_),_.D=0}}function B1(_,k){return gr(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=k.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=Ve(u(_.Ea,_,k),Dd(_,_.D)),_.D++,!0)}n.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const ge=new Z(this,this.j,_);let Re=this.o;if(this.U&&(Re?(Re=se(Re),Q(Re,this.U)):Re=this.U),this.u!==null||this.R||(ge.J=Re,Re=null),this.S)e:{for(var k=0,D=0;D<this.i.length;D++){t:{var H=this.i[D];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(k+=H,k>4096){k=D;break e}if(k===4096||D===this.i.length-1){k=D+1;break e}}k=1e3}else k=1e3;k=cg(this,ge,k),D=ca(this.J),An(D,"RID",_),An(D,"CVER",22),this.G&&An(D,"X-HTTP-Session-Id",this.G),Eo(this,D),Re&&(this.R?k="headers="+Fi(j1(Re))+"&"+k:this.u&&kd(D,this.u,Re)),la(this.h,ge),this.Ra&&An(D,"TYPE","init"),this.S?(An(D,"$req",k),An(D,"SID","null"),ge.U=!0,te(ge,D,null)):te(ge,D,k),this.I=2}}else this.I==3&&(_?ju(this,_):this.i.length==0||Vn(this.h)||ju(this))};function ju(_,k){var D;k?D=k.l:D=_.V++;const H=ca(_.J);An(H,"SID",_.M),An(H,"RID",D),An(H,"AID",_.K),Eo(_,H),_.u&&_.o&&kd(H,_.u,_.o),D=new Z(_,_.j,D,_.D+1),_.u===null&&(D.J=_.o),k&&(_.i=k.G.concat(_.i)),k=cg(_,D,1e3),D.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),la(_.h,D),te(D,H,k)}function Eo(_,k){_.H&&Te(_.H,function(D,H){An(k,H,D)}),_.l&&Te({},function(D,H){An(k,H,D)})}function cg(_,k,D){D=Math.min(_.i.length,D);const H=_.l?u(_.l.Ka,_.l,_):null;e:{var ge=_.i;let Zt=-1;for(;;){const Dr=["count="+D];Zt==-1?D>0?(Zt=ge[0].g,Dr.push("ofs="+Zt)):Zt=0:Dr.push("ofs="+Zt);let Gn=!0;for(let Ur=0;Ur<D;Ur++){var Re=ge[Ur].g;const Gs=ge[Ur].map;if(Re-=Zt,Re<0)Zt=Math.max(0,ge[Ur].g-100),Gn=!1;else try{Re="req"+Re+"_"||"";try{var it=Gs instanceof Map?Gs:Object.entries(Gs);for(const[dl,To]of it){let bo=To;o(To)&&(bo=sr(To)),Dr.push(Re+dl+"="+encodeURIComponent(bo))}}catch(dl){throw Dr.push(Re+"type="+encodeURIComponent("_badmap")),dl}}catch{H&&H(Gs)}}if(Gn){it=Dr.join("&");break e}}it=void 0}return _=_.i.splice(0,D),k.G=_,it}function ji(_){if(!_.g&&!_.v){_.Y=1;var k=_.Da;F||C(),G||(F(),G=!0),R.add(k,_),_.A=0}}function So(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=Ve(u(_.Da,_),Dd(_,_.A)),_.A++,!0)}n.Da=function(){if(this.v=null,oc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=Ve(u(this.Wa,this),_)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ce(10),js(this),oc(this))};function Vu(_){_.B!=null&&(a.clearTimeout(_.B),_.B=null)}function oc(_){_.g=new Z(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var k=ca(_.na);An(k,"RID","rpc"),An(k,"SID",_.M),An(k,"AID",_.K),An(k,"CI",_.F?"0":"1"),!_.F&&_.ia&&An(k,"TO",_.ia),An(k,"TYPE","xmlhttp"),Eo(_,k),_.u&&_.o&&kd(k,_.u,_.o),_.O&&(_.g.H=_.O);var D=_.g;_=_.ba,D.M=1,D.A=ol(ca(k)),D.u=null,D.R=!0,xe(D,_)}n.Va=function(){this.C!=null&&(this.C=null,js(this),So(this),ce(19))};function Ld(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function Od(_,k){var D=null;if(_.g==k){Ld(_),Vu(_),_.g=null;var H=2}else if(La(_.h,k))D=k.G,Ds(_.h,k),H=1;else return;if(_.I!=0){if(k.o)if(H==1){D=k.u?k.u.length:0,k=Date.now()-k.F;var ge=_.D;H=Lt(),en(H,new he(H,D)),hl(_)}else ji(_);else if(ge=k.m,ge==3||ge==0&&k.X>0||!(H==1&&B1(_,k)||H==2&&So(_)))switch(D&&D.length>0&&(k=_.h,k.i=k.i.concat(D)),ge){case 1:Vs(_,5);break;case 4:Vs(_,10);break;case 3:Vs(_,6);break;default:Vs(_,2)}}}function Dd(_,k){let D=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(D*=2),D*k}function Vs(_,k){if(_.j.info("Error code "+k),k==2){var D=u(_.bb,_),H=_.Ua;const ge=!H;H=new go(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Nu(H,"https"),ol(H),ge?_o(H.toString(),D):xo(H.toString(),D)}else ce(2);_.I=0,_.l&&_.l.pa(k),Gu(_),Nd(_)}n.bb=function(_){_?(this.j.info("Successfully pinged google.com"),ce(2)):(this.j.info("Failed to ping google.com"),ce(1))};function Gu(_){if(_.I=0,_.ja=[],_.l){const k=Or(_.h);(k.length!=0||_.i.length!=0)&&(v(_.ja,k),v(_.ja,_.i),_.h.i.length=0,y(_.i),_.i.length=0),_.l.oa()}}function ug(_,k,D){var H=D instanceof go?ca(D):new go(D);if(H.g!="")k&&(H.g=k+"."+H.g),mo(H,H.u);else{var ge=a.location;H=ge.protocol,k=k?k+"."+ge.hostname:ge.hostname,ge=+ge.port;const Re=new go(null);H&&Nu(Re,H),k&&(Re.g=k),ge&&mo(Re,ge),D&&(Re.h=D),H=Re}return D=_.G,k=_.wa,D&&k&&An(H,D,k),An(H,"VER",_.ka),Eo(_,H),H}function U1(_,k,D){if(k&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return k=_.Aa&&!_.ma?new Jn(new ll({ab:D})):new Jn(_.ma),k.Fa(_.L),k}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function z1(){}n=z1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Fd(){}Fd.prototype.g=function(_,k){return new Ei(_,k)};function Ei(_,k){on.call(this),this.g=new Pd(k),this.l=_,this.h=k&&k.messageUrlParams||null,_=k&&k.messageHeaders||null,k&&k.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=k&&k.initMessageHeaders||null,k&&k.messageContentType&&(_?_["X-WebChannel-Content-Type"]=k.messageContentType:_={"X-WebChannel-Content-Type":k.messageContentType}),k&&k.sa&&(_?_["X-WebChannel-Client-Profile"]=k.sa:_={"X-WebChannel-Client-Profile":k.sa}),this.g.U=_,(_=k&&k.Qb)&&!j(_)&&(this.g.u=_),this.A=k&&k.supportsCrossDomainXhr||!1,this.v=k&&k.sendRawJson||!1,(k=k&&k.httpSessionIdParam)&&!j(k)&&(this.g.G=k,_=this.h,_!==null&&k in _&&(_=this.h,k in _&&delete _[k])),this.j=new lc(this)}f(Ei,on),Ei.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ei.prototype.close=function(){Md(this.g)},Ei.prototype.o=function(_){var k=this.g;if(typeof _=="string"){var D={};D.__data__=_,_=D}else this.v&&(D={},D.__data__=sr(_),_=D);k.i.push(new $t(k.Ya++,_)),k.I==3&&hl(k)},Ei.prototype.N=function(){this.g.l=null,delete this.j,Md(this.g),delete this.g,Ei.Z.N.call(this)};function $1(_){Ee.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var k=_.__sm__;if(k){e:{for(const D in k){_=D;break e}_=void 0}(this.i=_)&&(_=this.i,k=k!==null&&_ in k?k[_]:void 0),this.data=k}else this.data=_}f($1,Ee);function W1(){me.call(this),this.status=1}f(W1,me);function lc(_){this.g=_}f(lc,z1),lc.prototype.ra=function(){en(this.g,"a")},lc.prototype.qa=function(_){en(this.g,new $1(_))},lc.prototype.pa=function(_){en(this.g,new W1)},lc.prototype.oa=function(){en(this.g,"b")},Fd.prototype.createWebChannel=Fd.prototype.g,Ei.prototype.send=Ei.prototype.o,Ei.prototype.open=Ei.prototype.m,Ei.prototype.close=Ei.prototype.close,F6=function(){return new Fd},D6=function(){return Lt()},O6=Nt,VT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},dr.NO_ERROR=0,dr.TIMEOUT=8,dr.HTTP_ERROR=6,M_=dr,cn.COMPLETE="complete",L6=cn,ns.EventType=Oe,Oe.OPEN="a",Oe.CLOSE="b",Oe.ERROR="c",Oe.MESSAGE="d",on.prototype.listen=on.prototype.J,im=ns,Jn.prototype.listenOnce=Jn.prototype.K,Jn.prototype.getLastError=Jn.prototype.Ha,Jn.prototype.getLastErrorCode=Jn.prototype.ya,Jn.prototype.getStatus=Jn.prototype.ca,Jn.prototype.getResponseJson=Jn.prototype.La,Jn.prototype.getResponseText=Jn.prototype.la,Jn.prototype.send=Jn.prototype.ea,Jn.prototype.setWithCredentials=Jn.prototype.Fa,N6=Jn}).apply(typeof Qy<"u"?Qy:typeof self<"u"?self:typeof window<"u"?window:{});const CM="@firebase/firestore",kM="4.9.3";let Ci=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ci.UNAUTHENTICATED=new Ci(null),Ci.GOOGLE_CREDENTIALS=new Ci("google-credentials-uid"),Ci.FIRST_PARTY=new Ci("first-party-uid"),Ci.MOCK_USER=new Ci("mock-user");let U0="12.7.0";const Xh=new zI("@firebase/firestore");function Af(){return Xh.logLevel}function Ze(n,...e){if(Xh.logLevel<=dn.DEBUG){const t=e.map(tA);Xh.debug(`Firestore (${U0}): ${n}`,...t)}}function us(n,...e){if(Xh.logLevel<=dn.ERROR){const t=e.map(tA);Xh.error(`Firestore (${U0}): ${n}`,...t)}}function qh(n,...e){if(Xh.logLevel<=dn.WARN){const t=e.map(tA);Xh.warn(`Firestore (${U0}): ${n}`,...t)}}function tA(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Et(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,j6(n,r,t)}function j6(n,e,t){let r=`FIRESTORE (${U0}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw us(r),new Error(r)}function Rt(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||j6(e,i,r)}function qt(n,e){return n}const Me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends sl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class zo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class V6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Xq{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ci.UNAUTHENTICATED)))}shutdown(){}}class qq{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Zq{constructor(e){this.t=e,this.currentUser=Ci.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Rt(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new zo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new zo,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new zo)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Rt(typeof r.accessToken=="string",31837,{l:r}),new V6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Rt(e===null||typeof e=="string",2055,{h:e}),new Ci(e)}}class Qq{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ci.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Jq{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Qq(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ci.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class PM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eZ{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Zs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Rt(this.o===void 0,3512);const r=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new PM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Rt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new PM(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function tZ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class nA{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=tZ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function Xt(n,e){return n<e?-1:n>e?1:0}function GT(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return mS(i)===mS(s)?Xt(i,s):mS(i)?1:-1}return Xt(n.length,e.length)}const nZ=55296,rZ=57343;function mS(n){const e=n.charCodeAt(0);return e>=nZ&&e<=rZ}function y0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function G6(n){return n+"\0"}const MM="__name__";class No{constructor(e,t,r){t===void 0?t=0:t>e.length&&Et(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Et(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return No.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof No?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=No.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Xt(e.length,t.length)}static compareSegments(e,t){const r=No.isNumericId(e),i=No.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?No.extractNumericId(e).compare(No.extractNumericId(t)):GT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return su.fromString(e.substring(4,e.length-2))}}class Pn extends No{construct(e,t,r){return new Pn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new at(Me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Pn(t)}static emptyPath(){return new Pn([])}}const iZ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class br extends No{construct(e,t,r){return new br(e,t,r)}static isValidIdentifier(e){return iZ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),br.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===MM}static keyField(){return new br([MM])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new at(Me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new at(Me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new at(Me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new at(Me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new br(t)}static emptyPath(){return new br([])}}class ct{constructor(e){this.path=e}static fromPath(e){return new ct(Pn.fromString(e))}static fromName(e){return new ct(Pn.fromString(e).popFirst(5))}static empty(){return new ct(Pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new Pn(e.slice()))}}function B6(n,e,t){if(!t)throw new at(Me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function sZ(n,e,t,r){if(e===!0&&r===!0)throw new at(Me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NM(n){if(!ct.isDocumentKey(n))throw new at(Me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function LM(n){if(ct.isDocumentKey(n))throw new at(Me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function U6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function lw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Et(12329,{type:typeof n})}function Ma(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new at(Me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lw(n);throw new at(Me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Kr(n,e){const t={typeString:n};return e&&(t.value=e),t}function c1(n,e){if(!U6(n))throw new at(Me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new at(Me.INVALID_ARGUMENT,t);return!0}const OM=-62135596800,DM=1e6;class $n{static now(){return $n.fromMillis(Date.now())}static fromDate(e){return $n.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*DM);return new $n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new at(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new at(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OM)throw new at(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/DM}_compareTo(e){return this.seconds===e.seconds?Xt(this.nanoseconds,e.nanoseconds):Xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(c1(e,$n._jsonSchema))return new $n(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-OM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$n._jsonSchemaVersion="firestore/timestamp/1.0",$n._jsonSchema={type:Kr("string",$n._jsonSchemaVersion),seconds:Kr("number"),nanoseconds:Kr("number")};class Ot{static fromTimestamp(e){return new Ot(e)}static min(){return new Ot(new $n(0,0))}static max(){return new Ot(new $n(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const up=-1;class Cx{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function BT(n){return n.fields.find((e=>e.kind===2))}function lh(n){return n.fields.filter((e=>e.kind!==2))}Cx.UNKNOWN_ID=-1;class N_{constructor(e,t){this.fieldPath=e,this.kind=t}}class hp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new hp(0,ia.min())}}function aZ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ot.fromTimestamp(r===1e9?new $n(t+1,0):new $n(t,r));return new ia(i,ct.empty(),e)}function z6(n){return new ia(n.readTime,n.key,up)}class ia{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ia(Ot.min(),ct.empty(),up)}static max(){return new ia(Ot.max(),ct.empty(),up)}}function rA(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ct.comparator(n.documentKey,e.documentKey),t!==0?t:Xt(n.largestBatchId,e.largestBatchId))}const $6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class W6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function _d(n){if(n.code!==Me.FAILED_PRECONDITION||n.message!==$6)throw n;Ze("LocalStore","Unexpectedly lost primary lease")}class de{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new de(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof de?t:de.resolve(t)}catch(t){return de.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):de.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):de.reject(t)}static resolve(e){return new de(((t,r)=>{t(e)}))}static reject(e){return new de(((t,r)=>{r(e)}))}static waitFor(e){return new de(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=de.resolve(!1);for(const r of e)t=t.next((i=>i?de.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new de(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next((h=>{a[u]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new de(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const Ws="SimpleDb";class cw{static open(e,t,r,i){try{return new cw(t,e.transaction(i,r))}catch(s){throw new vm(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new zo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new vm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=iA(r.target.error);this.S.reject(new vm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ze(Ws,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new lZ(t)}}class au{static delete(e){return Ze(Ws,"Removing database:",e),gh(jD().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!KD())return!1;if(au.F())return!0;const e=ii(),t=au.M(e),r=0<t&&t<10,i=H6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,au.M(ii())===12.2&&us("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ze(Ws,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new vm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new at(Me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new at(Me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new vm(e,a))},i.onupgradeneeded=s=>{Ze(Ws,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{Ze(Ws,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=cw.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((u=>(o.C(),u))).catch((u=>(o.abort(u),de.reject(u)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,u=l.name!=="FirebaseError"&&a<3;if(Ze(Ws,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function H6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class oZ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return gh(this.U.delete())}}class vm extends at{constructor(e,t){super(Me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function bu(n){return n.name==="IndexedDbTransactionError"}class lZ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ze(Ws,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ze(Ws,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),gh(r)}add(e){return Ze(Ws,"ADD",this.store.name,e,e),gh(this.store.add(e))}get(e){return gh(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ze(Ws,"GET",this.store.name,e,t),t)))}delete(e){return Ze(Ws,"DELETE",this.store.name,e),gh(this.store.delete(e))}count(){return Ze(Ws,"COUNT",this.store.name),gh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new de(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new de(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){Ze(Ws,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new de(((r,i)=>{t.onerror=s=>{const a=iA(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new de(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new oZ(o),u=t(o.primaryKey,o.value,l);if(u instanceof de){const h=u.catch((f=>(l.done(),de.reject(f))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>de.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function gh(n){return new de(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=iA(r.target.error);t(i)}}))}let FM=!1;function iA(n){const e=au.M(ii());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new at("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return FM||(FM=!0,setTimeout((()=>{throw r}),0)),r}}return n}const wm="IndexBackfiller";class cZ{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ze(wm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ze(wm,`Documents written: ${t}`)}catch(t){bu(t)?Ze(wm,"Ignoring IndexedDB error during index backfill: ",t):await _d(t)}await this.re(6e4)}))}}class uZ{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return de.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return Ze(wm,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(Ze(wm,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=z6(s);rA(a,r)>0&&(r=a)})),new ia(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ia{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ia.ce=-1;const kh=-1;function uw(n){return n==null}function dp(n){return n===0&&1/n==-1/0}function hZ(n){return typeof n=="number"&&Number.isInteger(n)&&!dp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const kx="";function Zi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=jM(e)),e=dZ(n.get(t),e);return jM(e)}function dZ(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case kx:t+="";break;default:t+=s}}return t}function jM(n){return n+kx+""}function jo(n){const e=n.length;if(Rt(e>=2,64408,{path:n}),e===2)return Rt(n.charAt(0)===kx&&n.charAt(1)==="",56145,{path:n}),Pn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(kx,s);switch((a<0||a>t)&&Et(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:Et(61167,{path:n})}s=a+2}return new Pn(r)}const ch="remoteDocuments",u1="owner",ff="owner",fp="mutationQueues",fZ="userId",Ka="mutations",VM="batchId",Th="userMutationsIndex",GM=["userId","batchId"];function L_(n,e){return[n,Zi(e)]}function K6(n,e,t){return[n,Zi(e),t]}const gZ={},_0="documentMutations",Px="remoteDocumentsV14",mZ=["prefixPath","collectionGroup","readTime","documentId"],O_="documentKeyIndex",pZ=["prefixPath","collectionGroup","documentId"],Y6="collectionGroupIndex",yZ=["collectionGroup","readTime","prefixPath","documentId"],gp="remoteDocumentGlobal",UT="remoteDocumentGlobalKey",x0="targets",X6="queryTargetsIndex",_Z=["canonicalId","targetId"],v0="targetDocuments",xZ=["targetId","path"],sA="documentTargetsIndex",vZ=["path","targetId"],Mx="targetGlobalKey",Ph="targetGlobal",mp="collectionParents",wZ=["collectionId","parent"],w0="clientMetadata",EZ="clientId",hw="bundles",SZ="bundleId",dw="namedQueries",TZ="name",aA="indexConfiguration",bZ="indexId",zT="collectionGroupIndex",IZ="collectionGroup",Em="indexState",AZ=["indexId","uid"],q6="sequenceNumberIndex",RZ=["uid","sequenceNumber"],Sm="indexEntries",CZ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Z6="documentKeyIndex",kZ=["indexId","uid","orderedDocumentKey"],fw="documentOverlays",PZ=["userId","collectionPath","documentId"],$T="collectionPathOverlayIndex",MZ=["userId","collectionPath","largestBatchId"],Q6="collectionGroupOverlayIndex",NZ=["userId","collectionGroup","largestBatchId"],oA="globals",LZ="name",J6=[fp,Ka,_0,ch,x0,u1,Ph,v0,w0,gp,mp,hw,dw],OZ=[...J6,fw],e8=[fp,Ka,_0,Px,x0,u1,Ph,v0,w0,gp,mp,hw,dw,fw],t8=e8,lA=[...t8,aA,Em,Sm],DZ=lA,n8=[...lA,oA],FZ=n8;class WT extends W6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function si(n,e){const t=qt(n);return au.O(t.le,e)}function BM(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Iu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function r8(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class xr{constructor(e,t){this.comparator=e,this.root=t||ki.EMPTY}insert(e,t){return new xr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ki.BLACK,null,null))}remove(e){return new xr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ki.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jy(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jy(this.root,e,this.comparator,!0)}}class Jy{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ki{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??ki.RED,this.left=i??ki.EMPTY,this.right=s??ki.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ki(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ki.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ki.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ki.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ki.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Et(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Et(27949);return e+(this.isRed()?0:1)}}ki.EMPTY=null,ki.RED=!0,ki.BLACK=!1;ki.EMPTY=new class{constructor(){this.size=0}get key(){throw Et(57766)}get value(){throw Et(16141)}get color(){throw Et(16727)}get left(){throw Et(29726)}get right(){throw Et(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new ki(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Kn{constructor(e){this.comparator=e,this.data=new xr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new UM(this.data.getIterator())}getIteratorFrom(e){return new UM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Kn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Kn(this.comparator);return t.data=e,t}}class UM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function gf(n){return n.hasNext()?n.getNext():void 0}class Rs{constructor(e){this.fields=e,e.sort(br.comparator)}static empty(){return new Rs([])}unionWith(e){let t=new Kn(br.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Rs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return y0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class i8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new i8("Invalid base64 string: "+s):s}})(e);return new Xr(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new Xr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xr.EMPTY_BYTE_STRING=new Xr("");const jZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $l(n){if(Rt(!!n,39018),typeof n=="string"){let e=0;const t=jZ.exec(n);if(Rt(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pr(n.seconds),nanos:pr(n.nanos)}}function pr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Wl(n){return typeof n=="string"?Xr.fromBase64String(n):Xr.fromUint8Array(n)}const s8="server_timestamp",a8="__type__",o8="__previous_value__",l8="__local_write_time__";function cA(n){return(n?.mapValue?.fields||{})[a8]?.stringValue===s8}function gw(n){const e=n.mapValue.fields[o8];return cA(e)?gw(e):e}function pp(n){const e=$l(n.mapValue.fields[l8].timestampValue);return new $n(e.seconds,e.nanos)}class VZ{constructor(e,t,r,i,s,a,o,l,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=h}}const Nx="(default)";class Zh{constructor(e,t){this.projectId=e,this.database=t||Nx}static empty(){return new Zh("","")}get isDefaultDatabase(){return this.database===Nx}isEqual(e){return e instanceof Zh&&e.projectId===this.projectId&&e.database===this.database}}const uA="__type__",c8="__max__",Xc={mapValue:{fields:{__type__:{stringValue:c8}}}},hA="__vector__",E0="value",D_={nullValue:"NULL_VALUE"};function du(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?cA(n)?4:u8(n)?9007199254740991:mw(n)?10:11:Et(28295,{value:n})}function Qo(n,e){if(n===e)return!0;const t=du(n);if(t!==du(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return pp(n).isEqual(pp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=$l(i.timestampValue),o=$l(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return Wl(i.bytesValue).isEqual(Wl(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return pr(i.geoPointValue.latitude)===pr(s.geoPointValue.latitude)&&pr(i.geoPointValue.longitude)===pr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return pr(i.integerValue)===pr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=pr(i.doubleValue),o=pr(s.doubleValue);return a===o?dp(a)===dp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return y0(n.arrayValue.values||[],e.arrayValue.values||[],Qo);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(BM(a)!==BM(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Qo(a[l],o[l])))return!1;return!0})(n,e);default:return Et(52216,{left:n})}}function yp(n,e){return(n.values||[]).find((t=>Qo(t,e)))!==void 0}function fu(n,e){if(n===e)return 0;const t=du(n),r=du(e);if(t!==r)return Xt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xt(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=pr(s.integerValue||s.doubleValue),l=pr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return zM(n.timestampValue,e.timestampValue);case 4:return zM(pp(n),pp(e));case 5:return GT(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=Wl(s),l=Wl(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const h=Xt(o[u],l[u]);if(h!==0)return h}return Xt(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=Xt(pr(s.latitude),pr(a.latitude));return o!==0?o:Xt(pr(s.longitude),pr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return $M(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},u=o[E0]?.arrayValue,h=l[E0]?.arrayValue,f=Xt(u?.values?.length||0,h?.values?.length||0);return f!==0?f:$M(u,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===Xc.mapValue&&a===Xc.mapValue)return 0;if(s===Xc.mapValue)return 1;if(a===Xc.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const g=GT(l[f],h[f]);if(g!==0)return g;const y=fu(o[l[f]],u[h[f]]);if(y!==0)return y}return Xt(l.length,h.length)})(n.mapValue,e.mapValue);default:throw Et(23264,{he:t})}}function zM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Xt(n,e);const t=$l(n),r=$l(e),i=Xt(t.seconds,r.seconds);return i!==0?i:Xt(t.nanos,r.nanos)}function $M(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=fu(t[i],r[i]);if(s)return s}return Xt(t.length,r.length)}function S0(n){return HT(n)}function HT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=$l(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Wl(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ct.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=HT(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${HT(t.fields[a])}`;return i+"}"})(n.mapValue):Et(61005,{value:n})}function F_(n){switch(du(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gw(n);return e?16+F_(e):16;case 5:return 2*n.stringValue.length;case 6:return Wl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+F_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Iu(r.fields,((s,a)=>{i+=s.length+F_(a)})),i})(n.mapValue);default:throw Et(13486,{value:n})}}function _p(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function KT(n){return!!n&&"integerValue"in n}function xp(n){return!!n&&"arrayValue"in n}function WM(n){return!!n&&"nullValue"in n}function HM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function j_(n){return!!n&&"mapValue"in n}function mw(n){return(n?.mapValue?.fields||{})[uA]?.stringValue===hA}function Tm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Iu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Tm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Tm(n.arrayValue.values[t]);return e}return{...n}}function u8(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===c8}const h8={mapValue:{fields:{[uA]:{stringValue:hA},[E0]:{arrayValue:{}}}}};function GZ(n){return"nullValue"in n?D_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?_p(Zh.empty(),ct.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?mw(n)?h8:{mapValue:{}}:Et(35942,{value:n})}function BZ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?_p(Zh.empty(),ct.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?h8:"mapValue"in n?mw(n)?{mapValue:{}}:Xc:Et(61959,{value:n})}function KM(n,e){const t=fu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function YM(n,e){const t=fu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Yi{constructor(e){this.value=e}static empty(){return new Yi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!j_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Tm(t)}setAll(e){let t=br.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=Tm(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());j_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Qo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];j_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Iu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new Yi(Tm(this.value))}}function d8(n){const e=[];return Iu(n.fields,((t,r)=>{const i=new br([t]);if(j_(r)){const s=d8(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Rs(e)}class Mr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Mr(e,0,Ot.min(),Ot.min(),Ot.min(),Yi.empty(),0)}static newFoundDocument(e,t,r,i){return new Mr(e,1,t,Ot.min(),r,i,0)}static newNoDocument(e,t){return new Mr(e,2,t,Ot.min(),Ot.min(),Yi.empty(),0)}static newUnknownDocument(e,t){return new Mr(e,3,t,Ot.min(),Ot.min(),Yi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ot.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class T0{constructor(e,t){this.position=e,this.inclusive=t}}function XM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ct.comparator(ct.fromName(a.referenceValue),t.key):r=fu(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function qM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Qo(n.position[t],e.position[t]))return!1;return!0}class Lx{constructor(e,t="asc"){this.field=e,this.dir=t}}function UZ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class f8{}class fn extends f8{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new zZ(e,t,r):t==="array-contains"?new HZ(e,r):t==="in"?new x8(e,r):t==="not-in"?new KZ(e,r):t==="array-contains-any"?new YZ(e,r):new fn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new $Z(e,r):new WZ(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(fu(t,this.value)):t!==null&&du(this.value)===du(t)&&this.matchesComparison(fu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wn extends f8{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Wn(e,t)}matches(e){return b0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function b0(n){return n.op==="and"}function YT(n){return n.op==="or"}function dA(n){return g8(n)&&b0(n)}function g8(n){for(const e of n.filters)if(e instanceof Wn)return!1;return!0}function XT(n){if(n instanceof fn)return n.field.canonicalString()+n.op.toString()+S0(n.value);if(dA(n))return n.filters.map((e=>XT(e))).join(",");{const e=n.filters.map((t=>XT(t))).join(",");return`${n.op}(${e})`}}function m8(n,e){return n instanceof fn?(function(r,i){return i instanceof fn&&r.op===i.op&&r.field.isEqual(i.field)&&Qo(r.value,i.value)})(n,e):n instanceof Wn?(function(r,i){return i instanceof Wn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&m8(a,i.filters[o])),!0):!1})(n,e):void Et(19439)}function p8(n,e){const t=n.filters.concat(e);return Wn.create(t,n.op)}function y8(n){return n instanceof fn?(function(t){return`${t.field.canonicalString()} ${t.op} ${S0(t.value)}`})(n):n instanceof Wn?(function(t){return t.op.toString()+" {"+t.getFilters().map(y8).join(" ,")+"}"})(n):"Filter"}class zZ extends fn{constructor(e,t,r){super(e,t,r),this.key=ct.fromName(r.referenceValue)}matches(e){const t=ct.comparator(e.key,this.key);return this.matchesComparison(t)}}class $Z extends fn{constructor(e,t){super(e,"in",t),this.keys=_8("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class WZ extends fn{constructor(e,t){super(e,"not-in",t),this.keys=_8("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function _8(n,e){return(e.arrayValue?.values||[]).map((t=>ct.fromName(t.referenceValue)))}class HZ extends fn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return xp(t)&&yp(t.arrayValue,this.value)}}class x8 extends fn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&yp(this.value.arrayValue,t)}}class KZ extends fn{constructor(e,t){super(e,"not-in",t)}matches(e){if(yp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!yp(this.value.arrayValue,t)}}class YZ extends fn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!xp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>yp(this.value.arrayValue,r)))}}class XZ{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function qT(n,e=null,t=[],r=[],i=null,s=null,a=null){return new XZ(n,e,t,r,i,s,a)}function Qh(n){const e=qt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>XT(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),uw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>S0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>S0(r))).join(",")),e.Te=t}return e.Te}function h1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!UZ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!m8(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!qM(n.startAt,e.startAt)&&qM(n.endAt,e.endAt)}function Ox(n){return ct.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Dx(n,e){return n.filters.filter((t=>t instanceof fn&&t.field.isEqual(e)))}function ZM(n,e,t){let r=D_,i=!0;for(const s of Dx(n,e)){let a=D_,o=!0;switch(s.op){case"<":case"<=":a=GZ(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=D_}KM({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];KM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function QM(n,e,t){let r=Xc,i=!0;for(const s of Dx(n,e)){let a=Xc,o=!0;switch(s.op){case">=":case">":a=BZ(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=Xc}YM({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];YM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class d1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function qZ(n,e,t,r,i,s,a,o){return new d1(n,e,t,r,i,s,a,o)}function pw(n){return new d1(n)}function JM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function v8(n){return n.collectionGroup!==null}function bm(n){const e=qt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Kn(br.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((u=>{u.isInequality()&&(o=o.add(u.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Lx(s,r))})),t.has(br.keyField().canonicalString())||e.Ie.push(new Lx(br.keyField(),r))}return e.Ie}function Ra(n){const e=qt(n);return e.Ee||(e.Ee=ZZ(e,bm(n))),e.Ee}function ZZ(n,e){if(n.limitType==="F")return qT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Lx(i.field,s)}));const t=n.endAt?new T0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new T0(n.startAt.position,n.startAt.inclusive):null;return qT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ZT(n,e){const t=n.filters.concat([e]);return new d1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function QT(n,e,t){return new d1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yw(n,e){return h1(Ra(n),Ra(e))&&n.limitType===e.limitType}function w8(n){return`${Qh(Ra(n))}|lt:${n.limitType}`}function Rf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>y8(i))).join(", ")}]`),uw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>S0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>S0(i))).join(",")),`Target(${r})`})(Ra(n))}; limitType=${n.limitType})`}function f1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ct.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of bm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const u=XM(a,o,l);return a.inclusive?u<=0:u<0})(r.startAt,bm(r),i)||r.endAt&&!(function(a,o,l){const u=XM(a,o,l);return a.inclusive?u>=0:u>0})(r.endAt,bm(r),i))})(n,e)}function QZ(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function E8(n){return(e,t)=>{let r=!1;for(const i of bm(n)){const s=JZ(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function JZ(n,e,t){const r=n.field.isKeyField()?ct.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?fu(l,u):Et(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Et(19790,{direction:n.dir})}}class Zl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Iu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return r8(this.inner)}size(){return this.innerSize}}const eQ=new xr(ct.comparator);function Js(){return eQ}const S8=new xr(ct.comparator);function sm(...n){let e=S8;for(const t of n)e=e.insert(t.key,t);return e}function T8(n){let e=S8;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Vo(){return Im()}function b8(){return Im()}function Im(){return new Zl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const tQ=new xr(ct.comparator),nQ=new Kn(ct.comparator);function an(...n){let e=nQ;for(const t of n)e=e.add(t);return e}const rQ=new Kn(Xt);function iQ(){return rQ}function fA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dp(e)?"-0":e}}function I8(n){return{integerValue:""+n}}function sQ(n,e){return hZ(e)?I8(e):fA(n,e)}class _w{constructor(){this._=void 0}}function aQ(n,e,t){return n instanceof I0?(function(i,s){const a={fields:{[a8]:{stringValue:s8},[l8]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&cA(s)&&(s=gw(s)),s&&(a.fields[o8]=s),{mapValue:a}})(t,e):n instanceof A0?R8(n,e):n instanceof R0?C8(n,e):(function(i,s){const a=A8(i,s),o=eN(a)+eN(i.Ae);return KT(a)&&KT(i.Ae)?I8(o):fA(i.serializer,o)})(n,e)}function oQ(n,e,t){return n instanceof A0?R8(n,e):n instanceof R0?C8(n,e):t}function A8(n,e){return n instanceof vp?(function(r){return KT(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class I0 extends _w{}class A0 extends _w{constructor(e){super(),this.elements=e}}function R8(n,e){const t=k8(e);for(const r of n.elements)t.some((i=>Qo(i,r)))||t.push(r);return{arrayValue:{values:t}}}class R0 extends _w{constructor(e){super(),this.elements=e}}function C8(n,e){let t=k8(e);for(const r of n.elements)t=t.filter((i=>!Qo(i,r)));return{arrayValue:{values:t}}}class vp extends _w{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function eN(n){return pr(n.integerValue||n.doubleValue)}function k8(n){return xp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class P8{constructor(e,t){this.field=e,this.transform=t}}function lQ(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof A0&&i instanceof A0||r instanceof R0&&i instanceof R0?y0(r.elements,i.elements,Qo):r instanceof vp&&i instanceof vp?Qo(r.Ae,i.Ae):r instanceof I0&&i instanceof I0})(n.transform,e.transform)}class cQ{constructor(e,t){this.version=e,this.transformResults=t}}class Xi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xi}static exists(e){return new Xi(void 0,e)}static updateTime(e){return new Xi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function V_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class xw{}function M8(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new vw(n.key,Xi.none()):new z0(n.key,n.data,Xi.none());{const t=n.data,r=Yi.empty();let i=new Kn(br.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Ql(n.key,r,new Rs(i.toArray()),Xi.none())}}function uQ(n,e,t){n instanceof z0?(function(i,s,a){const o=i.value.clone(),l=nN(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof Ql?(function(i,s,a){if(!V_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=nN(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(N8(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Am(n,e,t,r){return n instanceof z0?(function(s,a,o,l){if(!V_(s.precondition,a))return o;const u=s.value.clone(),h=rN(s.fieldTransforms,l,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ql?(function(s,a,o,l){if(!V_(s.precondition,a))return o;const u=rN(s.fieldTransforms,l,a),h=a.data;return h.setAll(N8(s)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((f=>f.field)))})(n,e,t,r):(function(s,a,o){return V_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function hQ(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=A8(r.transform,i||null);s!=null&&(t===null&&(t=Yi.empty()),t.set(r.field,s))}return t||null}function tN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&y0(r,i,((s,a)=>lQ(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class z0 extends xw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ql extends xw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function N8(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function nN(n,e,t){const r=new Map;Rt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,oQ(a,o,t[i]))}return r}function rN(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,aQ(s,a,e))}return r}class vw extends xw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class L8 extends xw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gA{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&uQ(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Am(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Am(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=b8();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=M8(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ot.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),an())}isEqual(e){return this.batchId===e.batchId&&y0(this.mutations,e.mutations,((t,r)=>tN(t,r)))&&y0(this.baseMutations,e.baseMutations,((t,r)=>tN(t,r)))}}class mA{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Rt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return tQ})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new mA(e,t,r,i)}}class pA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class dQ{constructor(e,t){this.count=e,this.unchangedNames=t}}var Wr,yn;function fQ(n){switch(n){case Me.OK:return Et(64938);case Me.CANCELLED:case Me.UNKNOWN:case Me.DEADLINE_EXCEEDED:case Me.RESOURCE_EXHAUSTED:case Me.INTERNAL:case Me.UNAVAILABLE:case Me.UNAUTHENTICATED:return!1;case Me.INVALID_ARGUMENT:case Me.NOT_FOUND:case Me.ALREADY_EXISTS:case Me.PERMISSION_DENIED:case Me.FAILED_PRECONDITION:case Me.ABORTED:case Me.OUT_OF_RANGE:case Me.UNIMPLEMENTED:case Me.DATA_LOSS:return!0;default:return Et(15467,{code:n})}}function O8(n){if(n===void 0)return us("GRPC error has no .code"),Me.UNKNOWN;switch(n){case Wr.OK:return Me.OK;case Wr.CANCELLED:return Me.CANCELLED;case Wr.UNKNOWN:return Me.UNKNOWN;case Wr.DEADLINE_EXCEEDED:return Me.DEADLINE_EXCEEDED;case Wr.RESOURCE_EXHAUSTED:return Me.RESOURCE_EXHAUSTED;case Wr.INTERNAL:return Me.INTERNAL;case Wr.UNAVAILABLE:return Me.UNAVAILABLE;case Wr.UNAUTHENTICATED:return Me.UNAUTHENTICATED;case Wr.INVALID_ARGUMENT:return Me.INVALID_ARGUMENT;case Wr.NOT_FOUND:return Me.NOT_FOUND;case Wr.ALREADY_EXISTS:return Me.ALREADY_EXISTS;case Wr.PERMISSION_DENIED:return Me.PERMISSION_DENIED;case Wr.FAILED_PRECONDITION:return Me.FAILED_PRECONDITION;case Wr.ABORTED:return Me.ABORTED;case Wr.OUT_OF_RANGE:return Me.OUT_OF_RANGE;case Wr.UNIMPLEMENTED:return Me.UNIMPLEMENTED;case Wr.DATA_LOSS:return Me.DATA_LOSS;default:return Et(39323,{code:n})}}(yn=Wr||(Wr={}))[yn.OK=0]="OK",yn[yn.CANCELLED=1]="CANCELLED",yn[yn.UNKNOWN=2]="UNKNOWN",yn[yn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yn[yn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yn[yn.NOT_FOUND=5]="NOT_FOUND",yn[yn.ALREADY_EXISTS=6]="ALREADY_EXISTS",yn[yn.PERMISSION_DENIED=7]="PERMISSION_DENIED",yn[yn.UNAUTHENTICATED=16]="UNAUTHENTICATED",yn[yn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yn[yn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yn[yn.ABORTED=10]="ABORTED",yn[yn.OUT_OF_RANGE=11]="OUT_OF_RANGE",yn[yn.UNIMPLEMENTED=12]="UNIMPLEMENTED",yn[yn.INTERNAL=13]="INTERNAL",yn[yn.UNAVAILABLE=14]="UNAVAILABLE",yn[yn.DATA_LOSS=15]="DATA_LOSS";function gQ(){return new TextEncoder}const mQ=new su([4294967295,4294967295],0);function iN(n){const e=gQ().encode(n),t=new M6;return t.update(e),new Uint8Array(t.digest())}function sN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new su([t,r],0),new su([i,s],0)]}class yA{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new am(`Invalid padding: ${t}`);if(r<0)throw new am(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new am(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new am(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=su.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(su.fromNumber(r)));return i.compare(mQ)===1&&(i=new su([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=iN(e),[r,i]=sN(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new yA(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=iN(e),[r,i]=sN(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class am extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ww{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,g1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ww(Ot.min(),i,new xr(Xt),Js(),an())}}class g1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new g1(r,t,an(),an(),an())}}class G_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class D8{constructor(e,t){this.targetId=e,this.Ce=t}}class F8{constructor(e,t,r=Xr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class aN{constructor(){this.ve=0,this.Fe=oN(),this.Me=Xr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=an(),t=an(),r=an();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Et(38017,{changeType:s})}})),new g1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=oN()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Rt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class pQ{constructor(e){this.Ge=e,this.ze=new Map,this.je=Js(),this.Je=e_(),this.He=e_(),this.Ye=new xr(Xt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Et(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(Ox(s))if(r===0){const a=new ct(s.path);this.et(t,a,Mr.newNoDocument(a,Ot.min()))}else Rt(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=Wl(r).toUint8Array()}catch(l){if(l instanceof i8)return qh("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new yA(a,i,s)}catch(l){return qh(l instanceof am?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&Ox(o.target)){const l=new ct(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Mr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=an();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new ww(e,t,this.Ye,this.je,r);return this.je=Js(),this.Je=e_(),this.He=e_(),this.Ye=new xr(Xt),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new aN,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Kn(Xt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Kn(Xt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ze("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new aN),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function e_(){return new xr(ct.comparator)}function oN(){return new xr(ct.comparator)}const yQ={asc:"ASCENDING",desc:"DESCENDING"},_Q={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xQ={and:"AND",or:"OR"};class vQ{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function JT(n,e){return n.useProto3Json||uw(e)?e:{value:e}}function C0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function j8(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function wQ(n,e){return C0(n,e.toTimestamp())}function ds(n){return Rt(!!n,49232),Ot.fromTimestamp((function(t){const r=$l(t);return new $n(r.seconds,r.nanos)})(n))}function _A(n,e){return eb(n,e).canonicalString()}function eb(n,e){const t=(function(i){return new Pn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function V8(n){const e=Pn.fromString(n);return Rt(Y8(e),10190,{key:e.toString()}),e}function Fx(n,e){return _A(n.databaseId,e.path)}function Mh(n,e){const t=V8(e);if(t.get(1)!==n.databaseId.projectId)throw new at(Me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new at(Me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ct(U8(t))}function G8(n,e){return _A(n.databaseId,e)}function B8(n){const e=V8(n);return e.length===4?Pn.emptyPath():U8(e)}function tb(n){return new Pn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function U8(n){return Rt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function lN(n,e,t){return{name:Fx(n,e),fields:t.value.mapValue.fields}}function EQ(n,e,t){const r=Mh(n,e.name),i=ds(e.updateTime),s=e.createTime?ds(e.createTime):Ot.min(),a=new Yi({mapValue:{fields:e.fields}}),o=Mr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function SQ(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Et(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(u,h){return u.useProto3Json?(Rt(h===void 0||typeof h=="string",58123),Xr.fromBase64String(h||"")):(Rt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xr.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(u){const h=u.code===void 0?Me.UNKNOWN:O8(u.code);return new at(h,u.message||"")})(a);t=new F8(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Mh(n,r.document.name),s=ds(r.document.updateTime),a=r.document.createTime?ds(r.document.createTime):Ot.min(),o=new Yi({mapValue:{fields:r.document.fields}}),l=Mr.newFoundDocument(i,s,a,o),u=r.targetIds||[],h=r.removedTargetIds||[];t=new G_(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Mh(n,r.document),s=r.readTime?ds(r.readTime):Ot.min(),a=Mr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new G_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Mh(n,r.document),s=r.removedTargetIds||[];t=new G_([],s,i,null)}else{if(!("filter"in e))return Et(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new dQ(i,s),o=r.targetId;t=new D8(o,a)}}return t}function jx(n,e){let t;if(e instanceof z0)t={update:lN(n,e.key,e.value)};else if(e instanceof vw)t={delete:Fx(n,e.key)};else if(e instanceof Ql)t={update:lN(n,e.key,e.data),updateMask:CQ(e.fieldMask)};else{if(!(e instanceof L8))return Et(16599,{Vt:e.type});t={verify:Fx(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof I0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof A0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof R0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof vp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Et(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:wQ(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Et(27497)})(n,e.precondition)),t}function nb(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Xi.updateTime(ds(s.updateTime)):s.exists!==void 0?Xi.exists(s.exists):Xi.none()})(e.currentDocument):Xi.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)Rt(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new I0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new A0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new R0(h)}else"increment"in o?l=new vp(a,o.increment):Et(16584,{proto:o});const u=br.fromServerFormat(o.fieldPath);return new P8(u,l)})(n,i))):[];if(e.update){e.update.name;const i=Mh(n,e.update.name),s=new Yi({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const u=l.fieldPaths||[];return new Rs(u.map((h=>br.fromServerFormat(h))))})(e.updateMask);return new Ql(i,s,a,t,r)}return new z0(i,s,t,r)}if(e.delete){const i=Mh(n,e.delete);return new vw(i,t)}if(e.verify){const i=Mh(n,e.verify);return new L8(i,t)}return Et(1463,{proto:e})}function TQ(n,e){return n&&n.length>0?(Rt(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?ds(i.updateTime):ds(s);return a.isEqual(Ot.min())&&(a=ds(s)),new cQ(a,i.transformResults||[])})(t,e)))):[]}function z8(n,e){return{documents:[G8(n,e.path)]}}function $8(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=G8(n,i);const s=(function(u){if(u.length!==0)return K8(Wn.create(u,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(u){if(u.length!==0)return u.map((h=>(function(g){return{field:Cf(g.field),direction:IQ(g.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=JT(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:i}}function W8(n){let e=B8(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Rt(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){const g=H8(f);return g instanceof Wn&&dA(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(f){return f.map((g=>(function(v){return new Lx(kf(v.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(g)))})(t.orderBy));let o=null;t.limit&&(o=(function(f){let g;return g=typeof f=="object"?f.value:f,uw(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(f){const g=!!f.before,y=f.values||[];return new T0(y,g)})(t.startAt));let u=null;return t.endAt&&(u=(function(f){const g=!f.before,y=f.values||[];return new T0(y,g)})(t.endAt)),qZ(e,i,a,s,o,"F",l,u)}function bQ(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Et(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function H8(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=kf(t.unaryFilter.field);return fn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=kf(t.unaryFilter.field);return fn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=kf(t.unaryFilter.field);return fn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=kf(t.unaryFilter.field);return fn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Et(61313);default:return Et(60726)}})(n):n.fieldFilter!==void 0?(function(t){return fn.create(kf(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Et(58110);default:return Et(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Wn.create(t.compositeFilter.filters.map((r=>H8(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Et(1026)}})(t.compositeFilter.op))})(n):Et(30097,{filter:n})}function IQ(n){return yQ[n]}function AQ(n){return _Q[n]}function RQ(n){return xQ[n]}function Cf(n){return{fieldPath:n.canonicalString()}}function kf(n){return br.fromServerFormat(n.fieldPath)}function K8(n){return n instanceof fn?(function(t){if(t.op==="=="){if(HM(t.value))return{unaryFilter:{field:Cf(t.field),op:"IS_NAN"}};if(WM(t.value))return{unaryFilter:{field:Cf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(HM(t.value))return{unaryFilter:{field:Cf(t.field),op:"IS_NOT_NAN"}};if(WM(t.value))return{unaryFilter:{field:Cf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cf(t.field),op:AQ(t.op),value:t.value}}})(n):n instanceof Wn?(function(t){const r=t.getFilters().map((i=>K8(i)));return r.length===1?r[0]:{compositeFilter:{op:RQ(t.op),filters:r}}})(n):Et(54877,{filter:n})}function CQ(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Y8(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Rl{constructor(e,t,r,i,s=Ot.min(),a=Ot.min(),o=Xr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Rl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Rl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class X8{constructor(e){this.yt=e}}function kQ(n,e){let t;if(e.document)t=EQ(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ct.fromSegments(e.noDocument.path),i=ed(e.noDocument.readTime);t=Mr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Et(56709);{const r=ct.fromSegments(e.unknownDocument.path),i=ed(e.unknownDocument.version);t=Mr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new $n(i[0],i[1]);return Ot.fromTimestamp(s)})(e.readTime)),t}function cN(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Vx(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:Fx(s,a.key),fields:a.data.value.mapValue.fields,updateTime:C0(s,a.version.toTimestamp()),createTime:C0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Jh(e.version)};else{if(!e.isUnknownDocument())return Et(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Jh(e.version)}}return r}function Vx(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Jh(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ed(n){const e=new $n(n.seconds,n.nanoseconds);return Ot.fromTimestamp(e)}function mh(n,e){const t=(e.baseMutations||[]).map((s=>nb(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>nb(n.yt,s))),i=$n.fromMillis(e.localWriteTimeMs);return new gA(e.batchId,i,t,r)}function om(n){const e=ed(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ed(n.lastLimboFreeSnapshotVersion):Ot.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return Rt(a===1,1966,{count:a}),Ra(pw(B8(s.documents[0])))})(n.query):(function(s){return Ra(W8(s))})(n.query),new Rl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Xr.fromBase64String(n.resumeToken))}function q8(n,e){const t=Jh(e.snapshotVersion),r=Jh(e.lastLimboFreeSnapshotVersion);let i;i=Ox(e.target)?z8(n.yt,e.target):$8(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Qh(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Z8(n){const e=W8({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?QT(e,e.limit,"L"):e}function pS(n,e){return new pA(e.largestBatchId,nb(n.yt,e.overlayMutation))}function uN(n,e){const t=e.path.lastSegment();return[n,Zi(e.path.popLast()),t]}function hN(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Jh(r.readTime),documentKey:Zi(r.documentKey.path),largestBatchId:r.largestBatchId}}class PQ{getBundleMetadata(e,t){return dN(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:ed(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return dN(e).put((function(i){return{bundleId:i.id,createTime:Jh(ds(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return fN(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:Z8(s.bundledQuery),readTime:ed(s.readTime)}})(r)}))}saveNamedQuery(e,t){return fN(e).put((function(i){return{name:i.name,readTime:Jh(ds(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function dN(n){return si(n,hw)}function fN(n){return si(n,dw)}class Ew{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Ew(e,r)}getOverlay(e,t){return $g(e).get(uN(this.userId,t)).next((r=>r?pS(this.serializer,r):null))}getOverlays(e,t){const r=Vo();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new pA(t,a);i.push(this.St(e,o))})),de.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(Zi(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push($g(e).Z($T,o))})),de.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Vo(),s=Zi(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return $g(e).J($T,a).next((o=>{for(const l of o){const u=pS(this.serializer,l);i.set(u.getKey(),u)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=Vo();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return $g(e).ee({index:Q6,range:o},((l,u,h)=>{const f=pS(this.serializer,u);s.size()<i||f.largestBatchId===a?(s.set(f.getKey(),f),a=f.largestBatchId):h.done()})).next((()=>s))}St(e,t){return $g(e).put((function(i,s,a){const[o,l,u]=uN(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:jx(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function $g(n){return si(n,fw)}class MQ{bt(e){return si(e,oA)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Xr.fromUint8Array(r):Xr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class ph{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(pr(e.integerValue));else if("doubleValue"in e){const r=pr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),dp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=$l(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Wl(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?u8(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):mw(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Et(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=E0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(pr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ct.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}ph.Kt=new ph;const mf=255;function NQ(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function gN(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=NQ(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class LQ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=gN(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=gN(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(mf),this.sn(255)}_n(){this.an(mf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===mf?(this.sn(mf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===mf?(this.an(mf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class OQ{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class DQ{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Wg{constructor(){this.cn=new LQ,this.ln=new OQ(this.cn),this.hn=new DQ(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class yh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new yh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:B_(this.En),directionalValue:B_(this.dn),orderedDocumentKey:B_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function kc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=mN(n.En,e.En),t!==0?t:(t=mN(n.dn,e.dn),t!==0?t:ct.comparator(n.In,e.In)))}function mN(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function B_(n){return HD()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function pN(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class yN{constructor(e){this.mn=new Kn(((t,r)=>br.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Rt(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=BT(e);if(t!==void 0&&!this.wn(t))return!1;const r=lh(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Kn(br.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new N_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new N_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new N_(r.field,r.dir==="asc"?0:1)));return new Cx(Cx.UNKNOWN_ID,this.collectionId,t,hp.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function Q8(n){if(Rt(n instanceof fn||n instanceof Wn,20012),n instanceof fn){if(n instanceof x8){const t=n.value.arrayValue?.values?.map((r=>fn.create(n.field,"==",r)))||[];return Wn.create(t,"or")}return n}const e=n.filters.map((t=>Q8(t)));return Wn.create(e,n.op)}function FQ(n){if(n.getFilters().length===0)return[];const e=sb(Q8(n));return Rt(J8(e),7391),rb(e)||ib(e)?[e]:e.getFilters()}function rb(n){return n instanceof fn}function ib(n){return n instanceof Wn&&dA(n)}function J8(n){return rb(n)||ib(n)||(function(t){if(t instanceof Wn&&YT(t)){for(const r of t.getFilters())if(!rb(r)&&!ib(r))return!1;return!0}return!1})(n)}function sb(n){if(Rt(n instanceof fn||n instanceof Wn,34018),n instanceof fn)return n;if(n.filters.length===1)return sb(n.filters[0]);const e=n.filters.map((r=>sb(r)));let t=Wn.create(e,n.op);return t=Gx(t),J8(t)?t:(Rt(t instanceof Wn,64498),Rt(b0(t),40251),Rt(t.filters.length>1,57927),t.filters.reduce(((r,i)=>xA(r,i))))}function xA(n,e){let t;return Rt(n instanceof fn||n instanceof Wn,38388),Rt(e instanceof fn||e instanceof Wn,25473),t=n instanceof fn?e instanceof fn?(function(i,s){return Wn.create([i,s],"and")})(n,e):_N(n,e):e instanceof fn?_N(e,n):(function(i,s){if(Rt(i.filters.length>0&&s.filters.length>0,48005),b0(i)&&b0(s))return p8(i,s.getFilters());const a=YT(i)?i:s,o=YT(i)?s:i,l=a.filters.map((u=>xA(u,o)));return Wn.create(l,"or")})(n,e),Gx(t)}function _N(n,e){if(b0(e))return p8(e,n.getFilters());{const t=e.filters.map((r=>xA(n,r)));return Wn.create(t,"or")}}function Gx(n){if(Rt(n instanceof fn||n instanceof Wn,11850),n instanceof fn)return n;const e=n.getFilters();if(e.length===1)return Gx(e[0]);if(g8(n))return n;const t=e.map((i=>Gx(i))),r=[];return t.forEach((i=>{i instanceof fn?r.push(i):i instanceof Wn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Wn.create(r,n.op)}class jQ{constructor(){this.Cn=new vA}addToCollectionParentIndex(e,t){return this.Cn.add(t),de.resolve()}getCollectionParents(e,t){return de.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return de.resolve()}deleteFieldIndex(e,t){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,t){return de.resolve()}getDocumentsMatchingTarget(e,t){return de.resolve(null)}getIndexType(e,t){return de.resolve(0)}getFieldIndexes(e,t){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,t){return de.resolve(ia.min())}getMinOffsetFromCollectionGroup(e,t){return de.resolve(ia.min())}updateCollectionGroup(e,t,r){return de.resolve()}updateIndexEntries(e,t){return de.resolve()}}class vA{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Kn(Pn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Kn(Pn.comparator)).toArray()}}const xN="IndexedDbIndexManager",t_=new Uint8Array(0);class VQ{constructor(e,t){this.databaseId=t,this.vn=new vA,this.Fn=new Zl((r=>Qh(r)),((r,i)=>h1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:Zi(i)};return vN(e).put(s)}return de.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[G6(t),""],!1,!0);return vN(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(jo(a.parent))}return r}))}addFieldIndex(e,t){const r=Hg(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=yf(e);return s.next((o=>{a.put(hN(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=Hg(e),i=yf(e),s=pf(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Hg(e),r=pf(e),i=yf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return de.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new yN(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=pf(e);let i=!0;const s=new Map;return de.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=an();const o=[];return de.forEach(s,((l,u)=>{Ze(xN,`Using index ${(function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(l)} to execute ${Qh(t)}`);const h=(function(I,M){const F=BT(M);if(F===void 0)return null;for(const G of Dx(I,F.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null})(u,l),f=(function(I,M){const F=new Map;for(const G of lh(M))for(const R of Dx(I,G.fieldPath))switch(R.op){case"==":case"in":F.set(G.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return F.set(G.fieldPath.canonicalString(),R.value),Array.from(F.values())}return null})(u,l),g=(function(I,M){const F=[];let G=!0;for(const R of lh(M)){const C=R.kind===0?ZM(I,R.fieldPath,I.startAt):QM(I,R.fieldPath,I.startAt);F.push(C.value),G&&(G=C.inclusive)}return new T0(F,G)})(u,l),y=(function(I,M){const F=[];let G=!0;for(const R of lh(M)){const C=R.kind===0?QM(I,R.fieldPath,I.endAt):ZM(I,R.fieldPath,I.endAt);F.push(C.value),G&&(G=C.inclusive)}return new T0(F,G)})(u,l),v=this.On(l,u,g),x=this.On(l,u,y),E=this.Nn(l,u,f),T=this.Bn(l.indexId,h,v,g.inclusive,x,y.inclusive,E);return de.forEach(T,(b=>r.Y(b,t.limit).next((I=>{I.forEach((M=>{const F=ct.fromSegments(M.documentKey);a.has(F)||(a=a.add(F),o.push(F))}))}))))})).next((()=>o))}return de.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=FQ(Wn.create(e.filters,"and")).map((r=>qT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),u=l/(t!=null?t.length:1),h=[];for(let f=0;f<l;++f){const g=t?this.Ln(t[f/u]):t_,y=this.kn(e,g,r[f%u],i),v=this.qn(e,g,s[f%u],a),x=o.map((E=>this.kn(e,g,E,!0)));h.push(...this.createRange(y,v,x))}return h}kn(e,t,r,i){const s=new yh(e,ct.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new yh(e,ct.empty(),t,r);return i?s.An():s}xn(e,t){const r=new yN(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return de.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let u=new Kn(br.comparator),h=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:u=u.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Wg;for(const i of lh(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);ph.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new Wg;return ph.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Wg;return ph.Kt.Dt(_p(this.databaseId,t),r.Pn((function(s){const a=lh(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Wg);let s=0;for(const a of lh(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&xp(o))i=this.Kn(i,a,o);else{const u=l.Pn(a.kind);ph.Kt.Dt(o,u)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new Wg;l.seed(o.un()),ph.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof fn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Hg(e),i=yf(e);return(t?r.J(zT,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return de.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,f){const g=f?new hp(f.sequenceNumber,new ia(ed(f.readTime),new ct(jo(f.documentKey)),f.largestBatchId)):hp.empty(),y=h.fields.map((([v,x])=>new N_(br.fromServerFormat(v),x)));return new Cx(h.indexId,h.collectionGroup,y,g)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Xt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Hg(e),s=yf(e);return this.Gn(e).next((a=>i.J(zT,IDBKeyRange.bound(t,t)).next((o=>de.forEach(o,(l=>s.put(hN(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return de.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?de.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),de.forEach(o,(l=>this.zn(e,i,l).next((u=>{const h=this.jn(s,l);return u.isEqual(h)?de.resolve():this.Jn(e,s,l,u,h)})))))))}))}Hn(e,t,r,i){return pf(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return pf(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=pf(e);let s=new Kn(kc);return i.ee({index:Z6,range:IDBKeyRange.only([r.indexId,this.uid,B_(this.$n(r,t))])},((a,o)=>{s=s.add(new yh(r.indexId,t,pN(o.arrayValue),pN(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Kn(kc);const i=this.Qn(t,e);if(i==null)return r;const s=BT(t);if(s!=null){const a=e.data.field(s.fieldPath);if(xp(a))for(const o of a.arrayValue.values||[])r=r.add(new yh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new yh(t.indexId,e.key,t_,i));return r}Jn(e,t,r,i,s){Ze(xN,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,u,h,f,g){const y=l.getIterator(),v=u.getIterator();let x=gf(y),E=gf(v);for(;x||E;){let T=!1,b=!1;if(x&&E){const I=h(x,E);I<0?b=!0:I>0&&(T=!0)}else x!=null?b=!0:T=!0;T?(f(E),E=gf(v)):b?(g(x),x=gf(y)):(x=gf(y),E=gf(v))}})(i,s,kc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),de.waitFor(a)}Gn(e){let t=1;return yf(e).ee({index:q6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>kc(a,o))).filter(((a,o,l)=>!o||kc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=kc(a,e),l=kc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,t_,ct.empty()),l=i[a+1].Vn(this.uid,t_,ct.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return kc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(wN)}getMinOffset(e,t){return de.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Et(44426))))).next(wN)}}function vN(n){return si(n,mp)}function pf(n){return si(n,Sm)}function Hg(n){return si(n,aA)}function yf(n){return si(n,Em)}function wN(n){Rt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;rA(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ia(e.readTime,e.documentKey,t)}const EN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eF=41943040;class Hi{static withCacheSize(e){return new Hi(e,Hi.DEFAULT_COLLECTION_PERCENTILE,Hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function tF(n,e,t){const r=n.store(Ka),i=n.store(_0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,f,g)=>(o++,g.delete())));s.push(l.next((()=>{Rt(o===1,47070,{batchId:t.batchId})})));const u=[];for(const h of t.mutations){const f=K6(e,h.key.path,t.batchId);s.push(i.delete(f)),u.push(h.key)}return de.waitFor(s).next((()=>u))}function Bx(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Et(14731);e=n.noDocument}return JSON.stringify(e).length}Hi.DEFAULT_COLLECTION_PERCENTILE=10,Hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Hi.DEFAULT=new Hi(eF,Hi.DEFAULT_COLLECTION_PERCENTILE,Hi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Hi.DISABLED=new Hi(-1,0,0);class Sw{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Rt(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Sw(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pc(e).ee({index:Th,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Pf(e),a=Pc(e);return a.add({}).next((o=>{Rt(typeof o=="number",49019);const l=new gA(o,t,r,i),u=(function(y,v,x){const E=x.baseMutations.map((b=>jx(y.yt,b))),T=x.mutations.map((b=>jx(y.yt,b)));return{userId:v,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:E,mutations:T}})(this.serializer,this.userId,l),h=[];let f=new Kn(((g,y)=>Xt(g.canonicalString(),y.canonicalString())));for(const g of i){const y=K6(this.userId,g.key.path,o);f=f.add(g.key.path.popLast()),h.push(a.put(u)),h.push(s.put(y,gZ))}return f.forEach((g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),de.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Pc(e).get(t).next((r=>r?(Rt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),mh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?de.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Pc(e).ee({index:Th,range:i},((a,o,l)=>{o.userId===this.userId&&(Rt(o.batchId>=r,47524,{tr:r}),s=mh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=kh;return Pc(e).ee({index:Th,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,kh],[this.userId,Number.POSITIVE_INFINITY]);return Pc(e).J(Th,t).next((r=>r.map((i=>mh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=L_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Pf(e).ee({range:i},((a,o,l)=>{const[u,h,f]=a,g=jo(h);if(u===this.userId&&t.path.isEqual(g))return Pc(e).get(f).next((y=>{if(!y)throw Et(61480,{nr:a,batchId:f});Rt(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),s.push(mh(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Kn(Xt);const i=[];return t.forEach((s=>{const a=L_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Pf(e).ee({range:o},((u,h,f)=>{const[g,y,v]=u,x=jo(y);g===this.userId&&s.path.isEqual(x)?r=r.add(v):f.done()}));i.push(l)})),de.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=L_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Kn(Xt);return Pf(e).ee({range:a},((l,u,h)=>{const[f,g,y]=l,v=jo(g);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Pc(e).get(s).next((a=>{if(a===null)throw Et(35274,{batchId:s});Rt(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(mh(this.serializer,a))})))})),de.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return tF(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),de.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return de.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Pf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=jo(s[1]);i.push(l)}else o.done()})).next((()=>{Rt(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return nF(e,this.userId,t)}_r(e){return rF(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:kh,lastStreamToken:""}))}}function nF(n,e,t){const r=L_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Pf(n).ee({range:s,X:!0},((o,l,u)=>{const[h,f,g]=o;h===e&&f===i&&(a=!0),u.done()})).next((()=>a))}function Pc(n){return si(n,Ka)}function Pf(n){return si(n,_0)}function rF(n){return si(n,fp)}class td{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new td(0)}static cr(){return new td(-1)}}class GQ{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new td(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ot.fromTimestamp(new $n(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>_f(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Rt(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return _f(e).ee(((a,o)=>{const l=om(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>de.waitFor(s))).next((()=>i))}forEachTarget(e,t){return _f(e).ee(((r,i)=>{const s=om(i);t(s)}))}lr(e){return SN(e).get(Mx).next((t=>(Rt(t!==null,2888),t)))}hr(e,t){return SN(e).put(Mx,t)}Pr(e,t){return _f(e).put(q8(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Qh(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return _f(e).ee({range:i,index:X6},((a,o,l)=>{const u=om(o);h1(t,u.target)&&(s=u,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=Uc(e);return t.forEach((a=>{const o=Zi(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),de.waitFor(i)}removeMatchingKeys(e,t,r){const i=Uc(e);return de.forEach(t,(s=>{const a=Zi(s.path);return de.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=Uc(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Uc(e);let s=an();return i.ee({range:r,X:!0},((a,o,l)=>{const u=jo(a[1]),h=new ct(u);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=Zi(t.path),i=IDBKeyRange.bound([r],[G6(r)],!1,!0);let s=0;return Uc(e).ee({index:sA,X:!0,range:i},(([a,o],l,u)=>{a!==0&&(s++,u.done())})).next((()=>s>0))}At(e,t){return _f(e).get(t).next((r=>r?om(r):null))}}function _f(n){return si(n,x0)}function SN(n){return si(n,Ph)}function Uc(n){return si(n,v0)}const TN="LruGarbageCollector",BQ=1048576;function bN([n,e],[t,r]){const i=Xt(n,t);return i===0?Xt(e,r):i}class UQ{constructor(e){this.Ir=e,this.buffer=new Kn(bN),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();bN(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class iF{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ze(TN,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){bu(t)?Ze(TN,"Ignoring IndexedDB error during garbage collection: ",t):await _d(t)}await this.Vr(3e5)}))}}class zQ{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return de.resolve(Ia.ce);const r=new UQ(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ze("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(EN)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),EN):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(Ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i)))).next((f=>(r=f,o=Date.now(),this.removeTargets(e,r,t)))).next((f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((f=>(u=Date.now(),Af()<=dn.DEBUG&&Ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f}))))}}function sF(n,e){return new zQ(n,e)}class $Q{constructor(e,t){this.db=e,this.garbageCollector=sF(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return n_(e,r)}removeReference(e,t,r){return n_(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return n_(e,t)}br(e,t){return(function(i,s){let a=!1;return rF(i).te((o=>nF(i,o,s).next((l=>(l&&(a=!0),de.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((u=>{if(!u)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Ot.min()),Uc(e).delete((function(f){return[0,Zi(f.path)]})(a)))))}));i.push(l)}})).next((()=>de.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return n_(e,t)}Sr(e,t){const r=Uc(e);let i,s=Ia.ce;return r.ee({index:sA},(([a,o],{path:l,sequenceNumber:u})=>{a===0?(s!==Ia.ce&&t(new ct(jo(i)),s),s=u,i=l):s=Ia.ce})).next((()=>{s!==Ia.ce&&t(new ct(jo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function n_(n,e){return Uc(n).put((function(r,i){return{targetId:0,path:Zi(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class aF{constructor(){this.changes=new Zl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?de.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class WQ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return th(e).put(r)}removeEntry(e,t,r){return th(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Vx(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Mr.newInvalidDocument(t);return th(e).ee({index:O_,range:IDBKeyRange.only(Kg(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Mr.newInvalidDocument(t)};return th(e).ee({index:O_,range:IDBKeyRange.only(Kg(t))},((i,s)=>{r={document:this.Cr(t,s),size:Bx(s)}})).next((()=>r))}getEntries(e,t){let r=Js();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=Js(),i=new xr(ct.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,Bx(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return de.resolve();let i=new Kn(RN);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(Kg(i.first()),Kg(i.last())),a=i.getIterator();let o=a.getNext();return th(e).ee({index:O_,range:s},((l,u,h)=>{const f=ct.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;o&&RN(o,f)<0;)r(o,null),o=a.getNext();o&&o.isEqual(f)&&(r(o,u),o=a.hasNext()?a.getNext():null),o?h.j(Kg(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),Vx(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return th(e).J(IDBKeyRange.bound(o,l,!0)).next((u=>{s?.incrementDocumentReadCount(u.length);let h=Js();for(const f of u){const g=this.Cr(ct.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(f1(t,g)||i.has(g.key))&&(h=h.insert(g.key,g))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=Js();const a=AN(t,r),o=AN(t,ia.max());return th(e).ee({index:Y6,range:IDBKeyRange.bound(a,o,!0)},((l,u,h)=>{const f=this.Cr(ct.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new HQ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return IN(e).get(UT).next((t=>(Rt(!!t,20021),t)))}Dr(e,t){return IN(e).put(UT,t)}Cr(e,t){if(t){const r=kQ(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ot.min())))return r}return Mr.newInvalidDocument(e)}}function oF(n){return new WQ(n)}class HQ extends aF{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Zl((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Kn(((s,a)=>Xt(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=cN(this.Nr.serializer,a);i=i.add(s.path.popLast());const u=Bx(l);r+=u-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=cN(this.Nr.serializer,a.convertToNoDocument(Ot.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),de.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function IN(n){return si(n,gp)}function th(n){return si(n,Px)}function Kg(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function AN(n,e){const t=e.documentKey.path.toArray();return[n,Vx(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function RN(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Xt(t[s],r[s]),i)return i;return i=Xt(t.length,r.length),i||(i=Xt(t[t.length-2],r[r.length-2]),i||Xt(t[t.length-1],r[r.length-1]))}class KQ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class lF{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Am(r.mutation,i,Rs.empty(),$n.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,an()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=an()){const i=Vo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=sm();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Vo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,an())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=Js();const a=Im(),o=(function(){return Im()})();return t.forEach(((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Ql)?s=s.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),Am(h.mutation,u,h.mutation.getFieldMask(),$n.now())):a.set(u.key,Rs.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((u,h)=>a.set(u,h))),t.forEach(((u,h)=>o.set(u,new KQ(h,a.get(u)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=Im();let i=new xr(((a,o)=>a-o)),s=an();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const u=t.get(l);if(u===null)return;let h=r.get(l)||Rs.empty();h=o.applyToLocalView(u,h),r.set(l,h);const f=(i.get(o.batchId)||an()).add(l);i=i.insert(o.batchId,f)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,h=l.value,f=b8();h.forEach((g=>{if(!s.has(g)){const y=M8(t.get(g),r.get(g));y!==null&&f.set(g,y),s=s.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return de.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):v8(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):de.resolve(Vo());let o=up,l=s;return a.next((u=>de.forEach(u,((h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?de.resolve():this.remoteDocumentCache.getEntry(e,h).next((g=>{l=l.insert(h,g)}))))).next((()=>this.populateOverlays(e,u,s))).next((()=>this.computeViews(e,l,u,an()))).next((h=>({batchId:o,changes:T8(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ct(t)).next((r=>{let i=sm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=sm();return this.indexManager.getCollectionParents(e,s).next((o=>de.forEach(o,(l=>{const u=(function(f,g){return new d1(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next((h=>{h.forEach(((f,g)=>{a=a.insert(f,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,Mr.newInvalidDocument(h)))}));let o=sm();return a.forEach(((l,u)=>{const h=s.get(l);h!==void 0&&Am(h.mutation,u,Rs.empty(),$n.now()),f1(t,u)&&(o=o.insert(l,u))})),o}))}}class YQ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return de.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:ds(i.createTime)}})(t)),de.resolve()}getNamedQuery(e,t){return de.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:Z8(i.bundledQuery),readTime:ds(i.readTime)}})(t)),de.resolve()}}class XQ{constructor(){this.overlays=new xr(ct.comparator),this.qr=new Map}getOverlay(e,t){return de.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vo();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),de.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),de.resolve()}getOverlaysForCollection(e,t,r){const i=Vo(),s=t.length+1,a=new ct(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return de.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new xr(((u,h)=>u-h));const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=Vo(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const o=Vo(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((u,h)=>o.set(u,h))),!(o.size()>=i)););return de.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new pA(t,r));let s=this.qr.get(t);s===void 0&&(s=an(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class qQ{constructor(){this.sessionToken=Xr.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,de.resolve()}}class wA{constructor(){this.Qr=new Kn(hi.$r),this.Ur=new Kn(hi.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new hi(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new hi(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ct(new Pn([])),r=new hi(t,e),i=new hi(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ct(new Pn([])),r=new hi(t,e),i=new hi(t,e+1);let s=an();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new hi(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class hi{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ct.comparator(e.key,t.key)||Xt(e.Yr,t.Yr)}static Kr(e,t){return Xt(e.Yr,t.Yr)||ct.comparator(e.key,t.key)}}class ZQ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Kn(hi.$r)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new gA(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new hi(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return de.resolve(a)}lookupMutationBatch(e,t){return de.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?kh:this.tr-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new hi(t,0),i=new hi(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Kn(Xt);return t.forEach((i=>{const s=new hi(i,0),a=new hi(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),de.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ct.isDocumentKey(s)||(s=s.child(""));const a=new hi(new ct(s),0);let o=new Kn(Xt);return this.Zr.forEachWhile((l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)}),a),de.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Rt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return de.forEach(t.mutations,(i=>{const s=new hi(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new hi(t,0),i=this.Zr.firstAfterOrEqual(r);return de.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class QQ{constructor(e){this.ri=e,this.docs=(function(){return new xr(ct.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return de.resolve(r?r.document.mutableCopy():Mr.newInvalidDocument(t))}getEntries(e,t){let r=Js();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Mr.newInvalidDocument(i))})),de.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Js();const a=t.path,o=new ct(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||rA(z6(h),r)<=0||(i.has(h.key)||f1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Et(9500)}ii(e,t){return de.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new JQ(this)}getSize(e){return de.resolve(this.size)}}class JQ extends aF{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),de.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class eJ{constructor(e){this.persistence=e,this.si=new Zl((t=>Qh(t)),h1),this.lastRemoteSnapshotVersion=Ot.min(),this.highestTargetId=0,this.oi=0,this._i=new wA,this.targetCount=0,this.ai=td.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),de.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new td(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,de.resolve()}updateTargetData(e,t){return this.Pr(t),de.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),de.waitFor(s).next((()=>i))}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return de.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),de.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),de.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),de.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return de.resolve(r)}containsKey(e,t){return de.resolve(this._i.containsKey(t))}}class EA{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ia(0),this.li=!1,this.li=!0,this.hi=new qQ,this.referenceDelegate=e(this),this.Pi=new eJ(this),this.indexManager=new jQ,this.remoteDocumentCache=(function(i){return new QQ(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new X8(t),this.Ii=new YQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new XQ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new ZQ(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze("MemoryPersistence","Starting transaction:",e);const i=new tJ(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return de.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class tJ extends W6{constructor(e){super(),this.currentSequenceNumber=e}}class Tw{constructor(e){this.persistence=e,this.Ri=new wA,this.Vi=null}static mi(e){return new Tw(e)}get fi(){if(this.Vi)return this.Vi;throw Et(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),de.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),de.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.fi,(r=>{const i=ct.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Ot.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return de.or([()=>de.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ux{constructor(e,t){this.persistence=e,this.pi=new Zl((r=>Zi(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=sF(this,t)}static mi(e,t){return new Ux(e,t)}Ei(){}di(e){return de.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return de.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?de.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Ot.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=F_(e.data.value)),t}br(e,t,r){return de.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class nJ{constructor(e){this.serializer=e}k(e,t,r,i){const s=new cw("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(u1)})(e),(function(l){l.createObjectStore(fp,{keyPath:fZ}),l.createObjectStore(Ka,{keyPath:VM,autoIncrement:!0}).createIndex(Th,GM,{unique:!0}),l.createObjectStore(_0)})(e),CN(e),(function(l){l.createObjectStore(ch)})(e));let a=de.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(v0),l.deleteObjectStore(x0),l.deleteObjectStore(Ph)})(e),CN(e)),a=a.next((()=>(function(l){const u=l.store(Ph),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ot.min().toTimestamp(),targetCount:0};return u.put(Mx,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,u){return u.store(Ka).J().next((f=>{l.deleteObjectStore(Ka),l.createObjectStore(Ka,{keyPath:VM,autoIncrement:!0}).createIndex(Th,GM,{unique:!0});const g=u.store(Ka),y=f.map((v=>g.put(v)));return de.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(w0,{keyPath:EZ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(gp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(hw,{keyPath:SZ})})(e),(function(l){l.createObjectStore(dw,{keyPath:TZ})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const u=l.createObjectStore(fw,{keyPath:PZ});u.createIndex($T,MZ,{unique:!1}),u.createIndex(Q6,NZ,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const u=l.createObjectStore(Px,{keyPath:mZ});u.createIndex(O_,pZ),u.createIndex(Y6,yZ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(ch)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(aA,{keyPath:bZ,autoIncrement:!0}).createIndex(zT,IZ,{unique:!1}),l.createObjectStore(Em,{keyPath:AZ}).createIndex(q6,RZ,{unique:!1}),l.createObjectStore(Sm,{keyPath:CZ}).createIndex(Z6,kZ,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(Em).clear()})).next((()=>{t.objectStore(Sm).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(oA,{keyPath:LZ})})(e)}))),r<18&&i>=18&&HD()&&(a=a.next((()=>{t.objectStore(Em).clear()})).next((()=>{t.objectStore(Sm).clear()}))),a}wi(e){let t=0;return e.store(ch).ee(((r,i)=>{t+=Bx(i)})).next((()=>{const r={byteSize:t};return e.store(gp).put(UT,r)}))}yi(e){const t=e.store(fp),r=e.store(Ka);return t.J().next((i=>de.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,kh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Th,a).next((o=>de.forEach(o,(l=>{Rt(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=mh(this.serializer,l);return tF(e,s.userId,u).next((()=>{}))}))))}))))}Si(e){const t=e.store(v0),r=e.store(ch);return e.store(Ph).get(Mx).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new Pn(a),u=(function(f){return[0,Zi(f)]})(l);s.push(t.get(u).next((h=>h?de.resolve():(f=>t.put({targetId:0,path:Zi(f),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>de.waitFor(s)))}))}bi(e,t){e.createObjectStore(mp,{keyPath:wZ});const r=t.store(mp),i=new vA,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:Zi(l)})}};return t.store(ch).ee({X:!0},((a,o)=>{const l=new Pn(a);return s(l.popLast())})).next((()=>t.store(_0).ee({X:!0},(([a,o,l],u)=>{const h=jo(o);return s(h.popLast())}))))}Di(e){const t=e.store(x0);return t.ee(((r,i)=>{const s=om(i),a=q8(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(ch),i=[];return r.ee(((s,a)=>{const o=t.store(Px),l=(function(f){return f.document?new ct(Pn.fromString(f.document.name).popFirst(5)):f.noDocument?ct.fromSegments(f.noDocument.path):f.unknownDocument?ct.fromSegments(f.unknownDocument.path):Et(36783)})(a).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(u))})).next((()=>de.waitFor(i)))}Fi(e,t){const r=t.store(Ka),i=oF(this.serializer),s=new EA(Tw.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let u=o.get(l.userId)??an();mh(this.serializer,l).keys().forEach((h=>u=u.add(h))),o.set(l.userId,u)})),de.forEach(o,((l,u)=>{const h=new Ci(u),f=Ew.wt(this.serializer,h),g=s.getIndexManager(h),y=Sw.wt(h,this.serializer,g,s.referenceDelegate);return new lF(i,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new WT(t,Ia.ce),l).next()}))}))}}function CN(n){n.createObjectStore(v0,{keyPath:xZ}).createIndex(sA,vZ,{unique:!0}),n.createObjectStore(x0,{keyPath:"targetId"}).createIndex(X6,_Z,{unique:!0}),n.createObjectStore(Ph)}const Mc="IndexedDbPersistence",yS=18e5,_S=5e3,xS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rJ="main";class SA{constructor(e,t,r,i,s,a,o,l,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=u,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!SA.v())throw new at(Me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $Q(this,i),this.$i=t+rJ,this.serializer=new X8(l),this.Ui=new au(this.$i,this.Ni,new nJ(this.serializer)),this.hi=new MQ,this.Pi=new GQ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=oF(this.serializer),this.Ii=new PQ,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&us(Mc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new at(Me.FAILED_PRECONDITION,xS);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ia(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>r_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(bu(e))return Ze(Mc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ze(Mc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Yg(e).get(ff).next((t=>de.resolve(this.es(t))))}ts(e){return r_(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,yS)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=si(t,w0);return r.J().next((i=>{const s=this.ss(i,yS),a=i.filter((o=>s.indexOf(o)===-1));return de.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?de.resolve(!0):Yg(e).get(ff).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,_S)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new at(Me.FAILED_PRECONDITION,xS);return!1}}return!(!this.networkEnabled||!this.inForeground)||r_(e).J().next((r=>this.ss(r,_S).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ze(Mc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[u1,w0],(e=>{const t=new WT(e,Ia.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>r_(e).J().next((t=>this.ss(t,yS).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Sw.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new VQ(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Ew.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze(Mc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?FZ:l===17?n8:l===16?DZ:l===15?lA:l===14?t8:l===13?e8:l===12?OZ:l===11?J6:void Et(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new WT(o,this.ci?this.ci.next():Ia.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw us(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new at(Me.FAILED_PRECONDITION,$6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return Yg(e).get(ff).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,_S)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new at(Me.FAILED_PRECONDITION,xS)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Yg(e).put(ff,t)}static v(){return au.v()}Zi(e){const t=Yg(e);return t.get(ff).next((r=>this.es(r)?(Ze(Mc,"Releasing primary lease."),t.delete(ff)):de.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(us(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;WD()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ze(Mc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return us(Mc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){us("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Yg(n){return si(n,u1)}function r_(n){return si(n,w0)}function iJ(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class TA{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=an(),i=an();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new TA(e,t.fromCache,r,i)}}class sJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class cF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return WD()?8:H6(ii())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new sJ;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Af()<=dn.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Rf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),de.resolve()):(Af()<=dn.DEBUG&&Ze("QueryEngine","Query:",Rf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Af()<=dn.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Rf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ra(t))):de.resolve())}ys(e,t){if(JM(t))return de.resolve(null);let r=Ra(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=QT(t,null,"F"),r=Ra(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=an(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const u=this.Ds(t,o);return this.Cs(t,u,a,l.readTime)?this.ys(e,QT(t,null,"F")):this.vs(e,u,t,l)}))))})))))}ws(e,t,r,i){return JM(t)||i.isEqual(Ot.min())?de.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?de.resolve(null):(Af()<=dn.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Rf(t)),this.vs(e,a,t,aZ(i,up)).next((o=>o)))}))}Ds(e,t){let r=new Kn(E8(e));return t.forEach(((i,s)=>{f1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Af()<=dn.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Rf(t)),this.ps.getDocumentsMatchingQuery(e,t,ia.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const bA="LocalStore",aJ=3e8;class oJ{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new xr(Xt),this.xs=new Zl((s=>Qh(s)),h1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function uF(n,e,t,r){return new oJ(n,e,t,r)}async function hF(n,e){const t=qt(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=an();for(const u of i){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((u=>({Ls:u,removedBatchIds:a,addedBatchIds:o})))}))}))}function lJ(n,e){const t=qt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,u,h){const f=u.batch,g=f.keys();let y=de.resolve();return g.forEach((v=>{y=y.next((()=>h.getEntry(l,v))).next((x=>{const E=u.docVersions.get(v);Rt(E!==null,48541),x.version.compareTo(E)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),h.addEntry(x)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,f)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=an();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function dF(n){const e=qt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function cJ(n,e){const t=qt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,f)=>{const g=i.get(f);if(!g)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,f))));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Xr.EMPTY_BYTE_STRING,Ot.min()).withLastLimboFreeSnapshotVersion(Ot.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(f,y),(function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=aJ?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(g,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=Js(),u=an();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(uJ(s,a,e.documentUpdates).next((h=>{l=h.ks,u=h.qs}))),!r.isEqual(Ot.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((f=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return de.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,u))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function uJ(n,e,t){let r=an(),i=an();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=Js();return t.forEach(((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ot.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze(bA,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function hJ(n,e){const t=qt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=kh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function dJ(n,e){const t=qt(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,de.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Rl(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function ab(n,e,t){const r=qt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!bu(a))throw a;Ze(bA,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function kN(n,e,t){const r=qt(n);let i=Ot.min(),s=an();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,u,h){const f=qt(l),g=f.xs.get(h);return g!==void 0?de.resolve(f.Ms.get(g)):f.Pi.getTargetData(u,h)})(r,a,Ra(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Ot.min(),t?s:an()))).next((o=>(fJ(r,QZ(e),o),{documents:o,Qs:s})))))}function fJ(n,e,t){let r=n.Os.get(e)||Ot.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class PN{constructor(){this.activeTargetIds=iQ()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fF{constructor(){this.Mo=new PN,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new PN,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gJ{Oo(e){}shutdown(){}}const MN="ConnectivityMonitor";class NN{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ze(MN,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ze(MN,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let i_=null;function ob(){return i_===null?i_=(function(){return 268435456+Math.round(2147483648*Math.random())})():i_++,"0x"+i_.toString(16)}const vS="RestConnection",mJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pJ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Nx?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=ob(),o=this.zo(e,t.toUriEncodedString());Ze(vS,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),h=pd(u);return this.Jo(e,o,l,r,h).then((f=>(Ze(vS,`Received RPC '${e}' ${a}: `,f),f)),(f=>{throw qh(vS,`RPC '${e}' ${a} failed with error: `,f,"url: ",o,"request:",r),f}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+U0})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=mJ[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class yJ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const zi="WebChannelConnection";class _J extends pJ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=ob();return new Promise(((o,l)=>{const u=new N6;u.setWithCredentials(!0),u.listenOnce(L6.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case M_.NO_ERROR:const f=u.getResponseJson();Ze(zi,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case M_.TIMEOUT:Ze(zi,`RPC '${e}' ${a} timed out`),l(new at(Me.DEADLINE_EXCEEDED,"Request time out"));break;case M_.HTTP_ERROR:const g=u.getStatus();if(Ze(zi,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const v=y?.error;if(v&&v.status&&v.message){const x=(function(T){const b=T.toLowerCase().replace(/_/g,"-");return Object.values(Me).indexOf(b)>=0?b:Me.UNKNOWN})(v.status);l(new at(x,v.message))}else l(new at(Me.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new at(Me.UNAVAILABLE,"Connection failed."));break;default:Et(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ze(zi,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);Ze(zi,`RPC '${e}' ${a} sending request:`,i),u.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=ob(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=F6(),o=D6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");Ze(zi,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=a.createWebChannel(h,l);this.I_(f);let g=!1,y=!1;const v=new yJ({Yo:E=>{y?Ze(zi,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(g||(Ze(zi,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),Ze(zi,`RPC '${e}' stream ${i} sending:`,E),f.send(E))},Zo:()=>f.close()}),x=(E,T,b)=>{E.listen(T,(I=>{try{b(I)}catch(M){setTimeout((()=>{throw M}),0)}}))};return x(f,im.EventType.OPEN,(()=>{y||(Ze(zi,`RPC '${e}' stream ${i} transport opened.`),v.o_())})),x(f,im.EventType.CLOSE,(()=>{y||(y=!0,Ze(zi,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(f))})),x(f,im.EventType.ERROR,(E=>{y||(y=!0,qh(zi,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),v.a_(new at(Me.UNAVAILABLE,"The operation could not be completed")))})),x(f,im.EventType.MESSAGE,(E=>{if(!y){const T=E.data[0];Rt(!!T,16349);const b=T,I=b?.error||b[0]?.error;if(I){Ze(zi,`RPC '${e}' stream ${i} received error:`,I);const M=I.status;let F=(function(C){const P=Wr[C];if(P!==void 0)return O8(P)})(M),G=I.message;F===void 0&&(F=Me.INTERNAL,G="Unknown error status: "+M+" with message "+I.message),y=!0,v.a_(new at(F,G)),f.close()}else Ze(zi,`RPC '${e}' stream ${i} received:`,T),v.u_(T)}})),x(o,O6.STAT_EVENT,(E=>{E.stat===VT.PROXY?Ze(zi,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===VT.NOPROXY&&Ze(zi,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function xJ(){return typeof window<"u"?window:null}function U_(){return typeof document<"u"?document:null}function bw(n){return new vQ(n,!0)}class gF{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const LN="PersistentStream";class mF{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new gF(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Me.RESOURCE_EXHAUSTED?(us(t.toString()),us("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new at(Me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ze(LN,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ze(LN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class vJ extends mF{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=SQ(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Ot.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ot.min():a.readTime?ds(a.readTime):Ot.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=tb(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=Ox(l)?{documents:z8(s,l)}:{query:$8(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=j8(s,a.resumeToken);const u=JT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Ot.min())>0){o.readTime=C0(s,a.snapshotVersion.toTimestamp());const u=JT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o})(this.serializer,e);const r=bQ(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=tb(this.serializer),t.removeTarget=e,this.q_(t)}}class wJ extends mF{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TQ(e.writeResults,e.commitTime),r=ds(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=tb(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>jx(this.serializer,r)))};this.q_(t)}}class EJ{}class SJ extends EJ{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new at(Me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,eb(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new at(Me.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,eb(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new at(Me.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class TJ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(us(t),this.aa=!1):Ze("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const nd="RemoteStore";class bJ{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{xd(this)&&(Ze(nd,"Restarting streams for network reachability change."),await(async function(l){const u=qt(l);u.Ea.add(4),await m1(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Iw(u)})(this))}))})),this.Ra=new TJ(r,i)}}async function Iw(n){if(xd(n))for(const e of n.da)await e(!0)}async function m1(n){for(const e of n.da)await e(!1)}function pF(n,e){const t=qt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),CA(t)?RA(t):$0(t).O_()&&AA(t,e))}function IA(n,e){const t=qt(n),r=$0(t);t.Ia.delete(e),r.O_()&&yF(t,e),t.Ia.size===0&&(r.O_()?r.L_():xd(t)&&t.Ra.set("Unknown"))}function AA(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ot.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$0(n).Y_(e)}function yF(n,e){n.Va.Ue(e),$0(n).Z_(e)}function RA(n){n.Va=new pQ({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),$0(n).start(),n.Ra.ua()}function CA(n){return xd(n)&&!$0(n).x_()&&n.Ia.size>0}function xd(n){return qt(n).Ea.size===0}function _F(n){n.Va=void 0}async function IJ(n){n.Ra.set("Online")}async function AJ(n){n.Ia.forEach(((e,t)=>{AA(n,e)}))}async function RJ(n,e){_F(n),CA(n)?(n.Ra.ha(e),RA(n)):n.Ra.set("Unknown")}async function CJ(n,e,t){if(n.Ra.set("Online"),e instanceof F8&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){Ze(nd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zx(n,r)}else if(e instanceof G_?n.Va.Ze(e):e instanceof D8?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ot.min()))try{const r=await dF(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(u);h&&s.Ia.set(u,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,u)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(Xr.EMPTY_BYTE_STRING,h.snapshotVersion)),yF(s,l);const f=new Rl(h.target,l,u,h.sequenceNumber);AA(s,f)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){Ze(nd,"Failed to raise snapshot:",r),await zx(n,r)}}async function zx(n,e,t){if(!bu(e))throw e;n.Ea.add(1),await m1(n),n.Ra.set("Offline"),t||(t=()=>dF(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ze(nd,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Iw(n)}))}function xF(n,e){return e().catch((t=>zx(n,t,e)))}async function p1(n){const e=qt(n),t=gu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:kh;for(;kJ(e);)try{const i=await hJ(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,PJ(e,i)}catch(i){await zx(e,i)}vF(e)&&wF(e)}function kJ(n){return xd(n)&&n.Ta.length<10}function PJ(n,e){n.Ta.push(e);const t=gu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function vF(n){return xd(n)&&!gu(n).x_()&&n.Ta.length>0}function wF(n){gu(n).start()}async function MJ(n){gu(n).ra()}async function NJ(n){const e=gu(n);for(const t of n.Ta)e.ea(t.mutations)}async function LJ(n,e,t){const r=n.Ta.shift(),i=mA.from(r,e,t);await xF(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await p1(n)}async function OJ(n,e){e&&gu(n).X_&&await(async function(r,i){if((function(a){return fQ(a)&&a!==Me.ABORTED})(i.code)){const s=r.Ta.shift();gu(r).B_(),await xF(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await p1(r)}})(n,e),vF(n)&&wF(n)}async function ON(n,e){const t=qt(n);t.asyncQueue.verifyOperationInProgress(),Ze(nd,"RemoteStore received new credentials");const r=xd(t);t.Ea.add(3),await m1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Iw(t)}async function DJ(n,e){const t=qt(n);e?(t.Ea.delete(2),await Iw(t)):e||(t.Ea.add(2),await m1(t),t.Ra.set("Unknown"))}function $0(n){return n.ma||(n.ma=(function(t,r,i){const s=qt(t);return s.sa(),new vJ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:IJ.bind(null,n),t_:AJ.bind(null,n),r_:RJ.bind(null,n),H_:CJ.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),CA(n)?RA(n):n.Ra.set("Unknown")):(await n.ma.stop(),_F(n))}))),n.ma}function gu(n){return n.fa||(n.fa=(function(t,r,i){const s=qt(t);return s.sa(),new wJ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:MJ.bind(null,n),r_:OJ.bind(null,n),ta:NJ.bind(null,n),na:LJ.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await p1(n)):(await n.fa.stop(),n.Ta.length>0&&(Ze(nd,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class kA{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new zo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new kA(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function PA(n,e){if(us("AsyncQueue",`${e}: ${n}`),bu(n))return new at(Me.UNAVAILABLE,`${e}: ${n}`);throw n}class Qf{static emptySet(e){return new Qf(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ct.comparator(t.key,r.key):(t,r)=>ct.comparator(t.key,r.key),this.keyedMap=sm(),this.sortedSet=new xr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Qf)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Qf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class DN{constructor(){this.ga=new xr(ct.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Et(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class k0{constructor(e,t,r,i,s,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new k0(e,t,Qf.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class FJ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class jJ{constructor(){this.queries=FN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=qt(t),s=i.queries;i.queries=FN(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new at(Me.ABORTED,"Firestore shutting down"))}}function FN(){return new Zl((n=>w8(n)),yw)}async function EF(n,e){const t=qt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new FJ,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=PA(a,`Initialization of query '${Rf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&MA(t)}async function SF(n,e){const t=qt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function VJ(n,e){const t=qt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&MA(t)}function GJ(n,e,t){const r=qt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function MA(n){n.Ca.forEach((e=>{e.next()}))}var lb,jN;(jN=lb||(lb={})).Ma="default",jN.Cache="cache";class TF{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new k0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=k0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==lb.Cache}}class bF{constructor(e){this.key=e}}class IF{constructor(e){this.key=e}}class BJ{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=an(),this.mutatedKeys=an(),this.eu=E8(e),this.tu=new Qf(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new DN,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,f)=>{const g=i.get(h),y=f1(this.query,f)?f:null,v=!!g&&this.mutatedKeys.has(g.key),x=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;g&&y?g.data.isEqual(y.data)?v!==x&&(r.track({type:3,doc:y}),E=!0):this.su(g,y)||(r.track({type:2,doc:y}),E=!0,(l&&this.eu(y,l)>0||u&&this.eu(y,u)<0)&&(o=!0)):!g&&y?(r.track({type:0,doc:y}),E=!0):g&&!y&&(r.track({type:1,doc:g}),E=!0,(l||u)&&(o=!0)),E&&(y?(a=a.add(y),s=x?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,f)=>(function(y,v){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Et(20277,{Rt:E})}};return x(y)-x(v)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new k0(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new DN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=an(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new IF(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new bF(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=an();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return k0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const NA="SyncEngine";class UJ{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class zJ{constructor(e){this.key=e,this.hu=!1}}class $J{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Zl((o=>w8(o)),yw),this.Iu=new Map,this.Eu=new Set,this.du=new xr(ct.comparator),this.Au=new Map,this.Ru=new wA,this.Vu={},this.mu=new Map,this.fu=td.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function WJ(n,e,t=!0){const r=MF(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await AF(r,e,t,!0),i}async function HJ(n,e){const t=MF(n);await AF(t,e,!0,!1)}async function AF(n,e,t,r){const i=await dJ(n.localStore,Ra(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await KJ(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&pF(n.remoteStore,i),o}async function KJ(n,e,t,r,i){n.pu=(f,g,y)=>(async function(x,E,T,b){let I=E.view.ru(T);I.Cs&&(I=await kN(x.localStore,E.query,!1).then((({documents:R})=>E.view.ru(R,I))));const M=b&&b.targetChanges.get(E.targetId),F=b&&b.targetMismatches.get(E.targetId)!=null,G=E.view.applyChanges(I,x.isPrimaryClient,M,F);return GN(x,E.targetId,G.au),G.snapshot})(n,f,g,y);const s=await kN(n.localStore,e,!0),a=new BJ(e,s.Qs),o=a.ru(s.documents),l=g1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=a.applyChanges(o,n.isPrimaryClient,l);GN(n,t,u.au);const h=new UJ(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function YJ(n,e,t){const r=qt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!yw(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ab(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&IA(r.remoteStore,i.targetId),cb(r,i.targetId)})).catch(_d)):(cb(r,i.targetId),await ab(r.localStore,i.targetId,!0))}async function XJ(n,e){const t=qt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),IA(t.remoteStore,r.targetId))}async function qJ(n,e,t){const r=NF(n);try{const i=await(function(a,o){const l=qt(a),u=$n.now(),h=o.reduce(((y,v)=>y.add(v.key)),an());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let v=Js(),x=an();return l.Ns.getEntries(y,h).next((E=>{v=E,v.forEach(((T,b)=>{b.isValidDocument()||(x=x.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,v))).next((E=>{f=E;const T=[];for(const b of o){const I=hQ(b,f.get(b.key).overlayedDocument);I!=null&&T.push(new Ql(b.key,I,d8(I.value.mapValue),Xi.exists(!0)))}return l.mutationQueue.addMutationBatch(y,u,T,o)})).next((E=>{g=E;const T=E.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(y,E.batchId,T)}))})).then((()=>({batchId:g.batchId,changes:T8(f)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new xr(Xt)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u})(r,i.batchId,t),await y1(r,i.changes),await p1(r.remoteStore)}catch(i){const s=PA(i,"Failed to persist write");t.reject(s)}}async function RF(n,e){const t=qt(n);try{const r=await cJ(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Rt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Rt(a.hu,14607):i.removedDocuments.size>0&&(Rt(a.hu,42227),a.hu=!1))})),await y1(t,r,e)}catch(r){await _d(r)}}function VN(n,e,t){const r=qt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=qt(a);l.onlineState=o;let u=!1;l.queries.forEach(((h,f)=>{for(const g of f.Sa)g.va(o)&&(u=!0)})),u&&MA(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZJ(n,e,t){const r=qt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new xr(ct.comparator);a=a.insert(s,Mr.newNoDocument(s,Ot.min()));const o=an().add(s),l=new ww(Ot.min(),new Map,new xr(Xt),a,o);await RF(r,l),r.du=r.du.remove(s),r.Au.delete(e),LA(r)}else await ab(r.localStore,e,!1).then((()=>cb(r,e,t))).catch(_d)}async function QJ(n,e){const t=qt(n),r=e.batch.batchId;try{const i=await lJ(t.localStore,e);kF(t,r,null),CF(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await y1(t,i)}catch(i){await _d(i)}}async function JJ(n,e,t){const r=qt(n);try{const i=await(function(a,o){const l=qt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return l.mutationQueue.lookupMutationBatch(u,o).next((f=>(Rt(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f)))).next((()=>l.mutationQueue.performConsistencyCheck(u))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>l.localDocuments.getDocuments(u,h)))}))})(r.localStore,e);kF(r,e,t),CF(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await y1(r,i)}catch(i){await _d(i)}}function CF(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function kF(n,e,t){const r=qt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function cb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||PF(n,r)}))}function PF(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(IA(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),LA(n))}function GN(n,e,t){for(const r of t)r instanceof bF?(n.Ru.addReference(r.key,e),eee(n,r)):r instanceof IF?(Ze(NA,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||PF(n,r.key)):Et(19791,{wu:r})}function eee(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ze(NA,"New document in limbo: "+t),n.Eu.add(r),LA(n))}function LA(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ct(Pn.fromString(e)),r=n.fu.next();n.Au.set(r,new zJ(t)),n.du=n.du.insert(t,r),pF(n.remoteStore,new Rl(Ra(pw(t.path)),r,"TargetPurposeLimboResolution",Ia.ce))}}async function y1(n,e,t){const r=qt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((u=>{if((u||t)&&r.isPrimaryClient){const h=u?!u.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=TA.As(l.targetId,u);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,u){const h=qt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>de.forEach(u,(g=>de.forEach(g.Es,(y=>h.persistence.referenceDelegate.addReference(f,g.targetId,y))).next((()=>de.forEach(g.ds,(y=>h.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))))))}catch(f){if(!bu(f))throw f;Ze(bA,"Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const y=h.Ms.get(g),v=y.snapshotVersion,x=y.withLastLimboFreeSnapshotVersion(v);h.Ms=h.Ms.insert(g,x)}}})(r.localStore,s))}async function tee(n,e){const t=qt(n);if(!t.currentUser.isEqual(e)){Ze(NA,"User change. New user:",e.toKey());const r=await hF(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new at(Me.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await y1(t,r.Ls)}}function nee(n,e){const t=qt(n),r=t.Au.get(e);if(r&&r.hu)return an().add(r.key);{let i=an();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function MF(n){const e=qt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=RF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nee.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZJ.bind(null,e),e.Pu.H_=VJ.bind(null,e.eventManager),e.Pu.yu=GJ.bind(null,e.eventManager),e}function NF(n){const e=qt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=QJ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JJ.bind(null,e),e}class wp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bw(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return uF(this.persistence,new cF,e.initialUser,this.serializer)}Cu(e){return new EA(Tw.mi,this.serializer)}Du(e){return new fF}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wp.provider={build:()=>new wp};class ree extends wp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Rt(this.persistence.referenceDelegate instanceof Ux,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new iF(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Hi.withCacheSize(this.cacheSizeBytes):Hi.DEFAULT;return new EA((r=>Ux.mi(r,t)),this.serializer)}}class iee extends wp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await NF(this.xu.syncEngine),await p1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return uF(this.persistence,new cF,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new iF(r,e.asyncQueue,t)}Mu(e,t){const r=new uZ(t,this.persistence);return new cZ(e.asyncQueue,r)}Cu(e){const t=iJ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Hi.withCacheSize(this.cacheSizeBytes):Hi.DEFAULT;return new SA(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,xJ(),U_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new fF}}class $x{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>VN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tee.bind(null,this.syncEngine),await DJ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new jJ})()}createDatastore(e){const t=bw(e.databaseInfo.databaseId),r=(function(s){return new _J(s)})(e.databaseInfo);return(function(s,a,o,l){return new SJ(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new bJ(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>VN(this.syncEngine,t,0)),(function(){return NN.v()?new NN:new gJ})())}createSyncEngine(e,t){return(function(i,s,a,o,l,u,h){const f=new $J(i,s,a,o,l,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=qt(t);Ze(nd,"RemoteStore shutting down."),r.Ea.add(5),await m1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}$x.provider={build:()=>new $x};class LF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):us("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const mu="FirestoreClient";class see{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ci.UNAUTHENTICATED,this.clientId=nA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{Ze(mu,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(Ze(mu,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=PA(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function wS(n,e){n.asyncQueue.verifyOperationInProgress(),Ze(mu,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await hF(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function BN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await aee(n);Ze(mu,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>ON(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>ON(e.remoteStore,i))),n._onlineComponents=e}async function aee(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ze(mu,"Using user provided OfflineComponentProvider");try{await wS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Me.FAILED_PRECONDITION||i.code===Me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;qh("Error using user provided cache. Falling back to memory cache: "+t),await wS(n,new wp)}}else Ze(mu,"Using default OfflineComponentProvider"),await wS(n,new ree(void 0));return n._offlineComponents}async function OF(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ze(mu,"Using user provided OnlineComponentProvider"),await BN(n,n._uninitializedComponentsProvider._online)):(Ze(mu,"Using default OnlineComponentProvider"),await BN(n,new $x))),n._onlineComponents}function oee(n){return OF(n).then((e=>e.syncEngine))}async function DF(n){const e=await OF(n),t=e.eventManager;return t.onListen=WJ.bind(null,e.syncEngine),t.onUnlisten=YJ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=HJ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XJ.bind(null,e.syncEngine),t}function lee(n,e,t={}){const r=new zo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new LF({next:g=>{h.Nu(),a.enqueueAndForget((()=>SF(s,f)));const y=g.docs.has(o);!y&&g.fromCache?u.reject(new at(Me.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&l&&l.source==="server"?u.reject(new at(Me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new TF(pw(o.path),h,{includeMetadataChanges:!0,qa:!0});return EF(s,f)})(await DF(n),n.asyncQueue,e,t,r))),r.promise}function cee(n,e,t={}){const r=new zo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new LF({next:g=>{h.Nu(),a.enqueueAndForget((()=>SF(s,f))),g.fromCache&&l.source==="server"?u.reject(new at(Me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new TF(o,h,{includeMetadataChanges:!0,qa:!0});return EF(s,f)})(await DF(n),n.asyncQueue,e,t,r))),r.promise}function FF(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const UN=new Map;const jF="firestore.googleapis.com",zN=!0;class $N{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new at(Me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jF,this.ssl=zN}else this.host=e.host,this.ssl=e.ssl??zN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eF;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BQ)throw new at(Me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sZ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FF(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new at(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new at(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new at(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Aw{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $N({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $N(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Xq;switch(r.type){case"firstParty":return new Jq(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new at(Me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=UN.get(t);r&&(Ze("ComponentProvider","Removing Datastore"),UN.delete(t),r.terminate())})(this),Promise.resolve()}}function uee(n,e,t,r={}){n=Ma(n,Aw);const i=pd(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(BI(`https://${o}`),UI("Firestore",!0)),s.host!==jF&&s.host!==o&&qh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!Hh(l,a)&&(n._setSettings(l),r.mockUserToken)){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=Ci.MOCK_USER;else{u=zD(r.mockUserToken,n._app?.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new at(Me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ci(f)}n._authCredentials=new qq(new V6(u,h))}}class W0{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new W0(this.firestore,e,this._query)}}class Gr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ou(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Gr(this.firestore,e,this._key)}toJSON(){return{type:Gr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(c1(t,Gr._jsonSchema))return new Gr(e,r||null,new ct(Pn.fromString(t.referencePath)))}}Gr._jsonSchemaVersion="firestore/documentReference/1.0",Gr._jsonSchema={type:Kr("string",Gr._jsonSchemaVersion),referencePath:Kr("string")};class ou extends W0{constructor(e,t,r){super(e,t,pw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Gr(this.firestore,null,new ct(e))}withConverter(e){return new ou(this.firestore,e,this._path)}}function WN(n,e,...t){if(n=xi(n),B6("collection","path",e),n instanceof Aw){const r=Pn.fromString(e,...t);return LM(r),new ou(n,null,r)}{if(!(n instanceof Gr||n instanceof ou))throw new at(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pn.fromString(e,...t));return LM(r),new ou(n.firestore,null,r)}}function Jf(n,e,...t){if(n=xi(n),arguments.length===1&&(e=nA.newId()),B6("doc","path",e),n instanceof Aw){const r=Pn.fromString(e,...t);return NM(r),new Gr(n,null,new ct(r))}{if(!(n instanceof Gr||n instanceof ou))throw new at(Me.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pn.fromString(e,...t));return NM(r),new Gr(n.firestore,n instanceof ou?n.converter:null,new ct(r))}}const HN="AsyncQueue";class KN{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new gF(this,"async_queue_retry"),this._c=()=>{const r=U_();r&&Ze(HN,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=U_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=U_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new zo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!bu(e))throw e;Ze(HN,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,us("INTERNAL UNHANDLED ERROR: ",YN(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=kA.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Et(47125,{Pc:YN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function YN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Au extends Aw{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new KN,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new KN(e),this._firestoreClient=void 0,await e}}}function hee(n,e){const t=typeof n=="object"?n:WI(),r=typeof n=="string"?n:Nx,i=iw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=GD("firestore");s&&uee(i,...s)}return i}function OA(n){if(n._terminated)throw new at(Me.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||VF(n),n._firestoreClient}function VF(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new VZ(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,FF(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new see(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function dee(n,e){qh("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return fee(n,$x.provider,{build:r=>new iee(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function fee(n,e,t){if((n=Ma(n,Au))._firestoreClient||n._terminated)throw new at(Me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new at(Me.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},VF(n)}class Ea{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ea(Xr.fromBase64String(e))}catch(t){throw new at(Me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ea(Xr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ea._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(c1(e,Ea._jsonSchema))return Ea.fromBase64String(e.bytes)}}Ea._jsonSchemaVersion="firestore/bytes/1.0",Ea._jsonSchema={type:Kr("string",Ea._jsonSchemaVersion),bytes:Kr("string")};class Rw{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new at(Me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new br(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Cw{constructor(e){this._methodName=e}}class $o{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new at(Me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new at(Me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xt(this._lat,e._lat)||Xt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$o._jsonSchemaVersion}}static fromJSON(e){if(c1(e,$o._jsonSchema))return new $o(e.latitude,e.longitude)}}$o._jsonSchemaVersion="firestore/geoPoint/1.0",$o._jsonSchema={type:Kr("string",$o._jsonSchemaVersion),latitude:Kr("number"),longitude:Kr("number")};class Wo{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Wo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(c1(e,Wo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Wo(e.vectorValues);throw new at(Me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Wo._jsonSchemaVersion="firestore/vectorValue/1.0",Wo._jsonSchema={type:Kr("string",Wo._jsonSchemaVersion),vectorValues:Kr("object")};const gee=/^__.*__$/;class mee{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ql(e,this.data,this.fieldMask,t,this.fieldTransforms):new z0(e,this.data,t,this.fieldTransforms)}}class GF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ql(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function BF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Et(40011,{Ac:n})}}class DA{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new DA({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wx(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(BF(this.Ac)&&gee.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class pee{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||bw(e)}Cc(e,t,r,i=!1){return new DA({Ac:e,methodName:t,Dc:r,path:br.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kw(n){const e=n._freezeSettings(),t=bw(n._databaseId);return new pee(n._databaseId,!!e.ignoreUndefinedProperties,t)}function UF(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);jA("Data must be an object, but it was:",a,r);const o=zF(r,a);let l,u;if(s.merge)l=new Rs(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const g=ub(e,f,t);if(!a.contains(g))throw new at(Me.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);WF(h,g)||h.push(g)}l=new Rs(h),u=a.fieldTransforms.filter((f=>l.covers(f.field)))}else l=null,u=a.fieldTransforms;return new mee(new Yi(o),l,u)}class Pw extends Cw{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pw}}class FA extends Cw{_toFieldTransform(e){return new P8(e.path,new I0)}isEqual(e){return e instanceof FA}}function yee(n,e,t,r){const i=n.Cc(1,e,t);jA("Data must be an object, but it was:",i,r);const s=[],a=Yi.empty();Iu(r,((l,u)=>{const h=VA(e,l,t);u=xi(u);const f=i.yc(h);if(u instanceof Pw)s.push(h);else{const g=_1(u,f);g!=null&&(s.push(h),a.set(h,g))}}));const o=new Rs(s);return new GF(a,o,i.fieldTransforms)}function _ee(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[ub(e,r,t)],l=[i];if(s.length%2!=0)throw new at(Me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)o.push(ub(e,s[g])),l.push(s[g+1]);const u=[],h=Yi.empty();for(let g=o.length-1;g>=0;--g)if(!WF(u,o[g])){const y=o[g];let v=l[g];v=xi(v);const x=a.yc(y);if(v instanceof Pw)u.push(y);else{const E=_1(v,x);E!=null&&(u.push(y),h.set(y,E))}}const f=new Rs(u);return new GF(h,f,a.fieldTransforms)}function xee(n,e,t,r=!1){return _1(t,n.Cc(r?4:3,e))}function _1(n,e){if($F(n=xi(n)))return jA("Unsupported field value:",e,n),zF(n,e);if(n instanceof Cw)return(function(r,i){if(!BF(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=_1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=xi(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return sQ(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=$n.fromDate(r);return{timestampValue:C0(i.serializer,s)}}if(r instanceof $n){const s=new $n(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:C0(i.serializer,s)}}if(r instanceof $o)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ea)return{bytesValue:j8(i.serializer,r._byteString)};if(r instanceof Gr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:_A(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Wo)return(function(a,o){return{mapValue:{fields:{[uA]:{stringValue:hA},[E0]:{arrayValue:{values:a.toArray().map((u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return fA(o.serializer,u)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${lw(r)}`)})(n,e)}function zF(n,e){const t={};return r8(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Iu(n,((r,i)=>{const s=_1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function $F(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof $n||n instanceof $o||n instanceof Ea||n instanceof Gr||n instanceof Cw||n instanceof Wo)}function jA(n,e,t){if(!$F(t)||!U6(t)){const r=lw(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function ub(n,e,t){if((e=xi(e))instanceof Rw)return e._internalPath;if(typeof e=="string")return VA(n,e);throw Wx("Field path arguments must be of type string or ",n,!1,void 0,t)}const vee=new RegExp("[~\\*/\\[\\]]");function VA(n,e,t){if(e.search(vee)>=0)throw Wx(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Rw(...e.split("."))._internalPath}catch{throw Wx(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wx(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new at(Me.INVALID_ARGUMENT,o+n+l)}function WF(n,e){return n.some((t=>t.isEqual(e)))}class HF{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Gr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wee(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(GA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class wee extends HF{data(){return super.data()}}function GA(n,e){return typeof e=="string"?VA(n,e):e instanceof Rw?e._internalPath:e._delegate._internalPath}function Eee(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new at(Me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class BA{}class See extends BA{}function Tee(n,e,...t){let r=[];e instanceof BA&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof UA)).length,o=s.filter((l=>l instanceof Mw)).length;if(a>1||a>0&&o>0)throw new at(Me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Mw extends See{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Mw(e,t,r)}_apply(e){const t=this._parse(e);return KF(e._query,t),new W0(e.firestore,e.converter,ZT(e._query,t))}_parse(e){const t=kw(e.firestore);return(function(s,a,o,l,u,h,f){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new at(Me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){qN(f,h);const v=[];for(const x of f)v.push(XN(l,s,x));g={arrayValue:{values:v}}}else g=XN(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||qN(f,h),g=xee(o,a,f,h==="in"||h==="not-in");return fn.create(u,h,g)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bee(n,e,t){const r=e,i=GA("where",n);return Mw._create(i,r,t)}class UA extends BA{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new UA(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Wn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)KF(a,l),a=ZT(a,l)})(e._query,t),new W0(e.firestore,e.converter,ZT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function XN(n,e,t){if(typeof(t=xi(t))=="string"){if(t==="")throw new at(Me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v8(e)&&t.indexOf("/")!==-1)throw new at(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Pn.fromString(t));if(!ct.isDocumentKey(r))throw new at(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _p(n,new ct(r))}if(t instanceof Gr)return _p(n,t._key);throw new at(Me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lw(t)}.`)}function qN(n,e){if(!Array.isArray(n)||n.length===0)throw new at(Me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function KF(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new at(Me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(Me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Iee{convertValue(e,t="none"){switch(du(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Et(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Iu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[E0].arrayValue?.values?.map((r=>pr(r.doubleValue)));return new Wo(t)}convertGeoPoint(e){return new $o(pr(e.latitude),pr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=gw(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(pp(e));default:return null}}convertTimestamp(e){const t=$l(e);return new $n(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Pn.fromString(e);Rt(Y8(r),9688,{name:e});const i=new Zh(r.get(1),r.get(3)),s=new ct(r.popFirst(5));return i.isEqual(t)||us(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function YF(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class lm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nh extends HF{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new z_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(GA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Nh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Nh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Nh._jsonSchema={type:Kr("string",Nh._jsonSchemaVersion),bundleSource:Kr("string","DocumentSnapshot"),bundleName:Kr("string"),bundle:Kr("string")};class z_ extends Nh{data(e={}){return super.data(e)}}class e0{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new lm(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new z_(this._firestore,this._userDataWriter,r.key,r,new lm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new at(Me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new z_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new lm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new z_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new lm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:Aee(o.type),doc:l,oldIndex:u,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=e0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=nA.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Aee(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Et(61501,{type:n})}}function Ree(n){n=Ma(n,Gr);const e=Ma(n.firestore,Au);return lee(OA(e),n._key).then((t=>Nee(e,n,t)))}e0._jsonSchemaVersion="firestore/querySnapshot/1.0",e0._jsonSchema={type:Kr("string",e0._jsonSchemaVersion),bundleSource:Kr("string","QuerySnapshot"),bundleName:Kr("string"),bundle:Kr("string")};class XF extends Iee{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ea(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gr(this.firestore,null,t)}}function Cee(n){n=Ma(n,W0);const e=Ma(n.firestore,Au),t=OA(e),r=new XF(e);return Eee(n._query),cee(t,n._query).then((i=>new e0(e,r,n,i)))}function ZN(n,e,t){n=Ma(n,Gr);const r=Ma(n.firestore,Au),i=YF(n.converter,e,t);return Nw(r,[UF(kw(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Xi.none())])}function kee(n,e,t,...r){n=Ma(n,Gr);const i=Ma(n.firestore,Au),s=kw(i);let a;return a=typeof(e=xi(e))=="string"||e instanceof Rw?_ee(s,"updateDoc",n._key,e,t,r):yee(s,"updateDoc",n._key,e),Nw(i,[a.toMutation(n._key,Xi.exists(!0))])}function Pee(n){return Nw(Ma(n.firestore,Au),[new vw(n._key,Xi.none())])}function Mee(n,e){const t=Ma(n.firestore,Au),r=Jf(n),i=YF(n.converter,e);return Nw(t,[UF(kw(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Xi.exists(!1))]).then((()=>r))}function Nw(n,e){return(function(r,i){const s=new zo;return r.asyncQueue.enqueueAndForget((async()=>qJ(await oee(r),i,s))),s.promise})(OA(n),e)}function Nee(n,e,t){const r=t.docs.get(e._key),i=new XF(n);return new Nh(n,i,e._key,r,new lm(t.hasPendingWrites,t.fromCache),e.converter)}function QN(){return new FA("serverTimestamp")}(function(e,t=!0){(function(i){U0=i})(yd),Kh(new uu("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Au(new Zq(r.getProvider("auth-internal")),new eZ(a,r.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new at(Me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zh(u.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),Bo(CM,kM,e),Bo(CM,kM,"esm2020")})();const qF="firebasestorage.googleapis.com",Lee="storageBucket",Oee=120*1e3,Dee=600*1e3;class al extends sl{constructor(e,t,r=0){super(ES(e),`Firebase Storage: ${t} (${ES(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,al.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ES(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Jo;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Jo||(Jo={}));function ES(n){return"storage/"+n}function Fee(){const n="An unknown error occurred, please check the error payload for server response.";return new al(Jo.UNKNOWN,n)}function jee(){return new al(Jo.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Vee(){return new al(Jo.CANCELED,"User canceled the upload/download.")}function Gee(n){return new al(Jo.INVALID_URL,"Invalid URL '"+n+"'.")}function Bee(n){return new al(Jo.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function JN(n){return new al(Jo.INVALID_ARGUMENT,n)}function ZF(){return new al(Jo.APP_DELETED,"The Firebase app was deleted.")}function Uee(n){return new al(Jo.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class eo{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=eo.makeFromUrl(e,t)}catch{return new eo(e,"")}if(r.path==="")return r;throw Bee(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${h}/b/${i}/o${g}`,"i"),v={bucket:1,path:3},x=t===qF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",T=new RegExp(`^https?://${x}/${i}/${E}`,"i"),I=[{regex:o,indices:l,postModify:s},{regex:y,indices:v,postModify:u},{regex:T,indices:{bucket:1,path:2},postModify:u}];for(let M=0;M<I.length;M++){const F=I[M],G=F.regex.exec(e);if(G){const R=G[F.indices.bucket];let C=G[F.indices.path];C||(C=""),r=new eo(R,C),F.postModify(r);break}}if(r==null)throw Gee(e);return r}}class zee{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function $ee(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function h(...E){u||(u=!0,e.apply(null,E))}function f(E){i=setTimeout(()=>{i=null,n(y,l())},E)}function g(){s&&clearTimeout(s)}function y(E,...T){if(u){g();return}if(E){g(),h.call(null,E,...T);return}if(l()||a){g(),h.call(null,E,...T);return}r<64&&(r*=2);let I;o===1?(o=2,I=0):I=(r+Math.random())*1e3,f(I)}let v=!1;function x(E){v||(v=!0,g(),!u&&(i!==null?(E||(o=2),clearTimeout(i),f(0)):E||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,x(!0)},t),x}function Wee(n){n(!1)}function Hee(n){return n!==void 0}function e3(n,e,t,r){if(r<e)throw JN(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw JN(`Invalid value for '${n}'. Expected ${t} or less.`)}function Kee(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Hx;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Hx||(Hx={}));function Yee(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class Xee{constructor(e,t,r,i,s,a,o,l,u,h,f,g=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=g,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new s_(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Hx.NO_ERROR,l=s.getStatus();if(!o||Yee(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Hx.ABORT;r(!1,new s_(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new s_(u,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Hee(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=Fee();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?ZF():Vee();a(l)}else{const l=jee();a(l)}};this.canceled_?t(!1,new s_(!1,null,!0)):this.backoffId_=$ee(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Wee(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class s_{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function qee(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Zee(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Qee(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Jee(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function ete(n,e,t,r,i,s,a=!0,o=!1){const l=Kee(n.urlParams),u=n.url+l,h=Object.assign({},n.headers);return Qee(h,e),qee(h,t),Zee(h,s),Jee(h,r),new Xee(u,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function tte(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function nte(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Kx{constructor(e,t){this._service=e,t instanceof eo?this._location=t:this._location=eo.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Kx(e,t)}get root(){const e=new eo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return nte(this._location.path)}get storage(){return this._service}get parent(){const e=tte(this._location.path);if(e===null)return null;const t=new eo(this._location.bucket,e);return new Kx(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Uee(e)}}function t3(n,e){const t=e?.[Lee];return t==null?null:eo.makeFromBucketSpec(t,n)}function rte(n,e,t,r={}){n.host=`${e}:${t}`;const i=pd(e);i&&(BI(`https://${n.host}/b`),UI("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:zD(s,n.app.options.projectId))}class ite{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=qF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Oee,this._maxUploadRetryTime=Dee,this._requests=new Set,i!=null?this._bucket=eo.makeFromBucketSpec(i,this._host):this._bucket=t3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=eo.makeFromBucketSpec(this._url,e):this._bucket=t3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){e3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){e3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Zs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Kx(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new zee(ZF());{const a=ete(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const n3="@firebase/storage",r3="0.14.0";const QF="storage";function ste(n=WI(),e){n=xi(n);const r=iw(n,QF).getImmediate({identifier:e}),i=GD("storage");return i&&ate(r,...i),r}function ate(n,e,t,r={}){rte(n,e,t,r)}function ote(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new ite(t,r,i,e,yd)}function lte(){Kh(new uu(QF,ote,"PUBLIC").setMultipleInstances(!0)),Bo(n3,r3,""),Bo(n3,r3,"esm2020")}lte();const cte={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},zA=qD(cte),t0=Wq(zA),qc=hee(zA);ste(zA);dee(qc).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const ute={};function hte(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const Ep=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Ep(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Ep(r)(t)}}}},dte=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,T)=>({...T,...E}),...e},a=!1;const o=new Set,l=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...E)},r,i);const h=Ep(s.serialize),f=()=>{const E=s.partialize({...r()});let T;const b=h({state:E,version:s.version}).then(I=>u.setItem(s.name,I)).catch(I=>{T=I});if(T)throw T;return b},g=i.setState;i.setState=(E,T)=>{g(E,T),f()};const y=n((...E)=>{t(...E),f()},r,i);let v;const x=()=>{var E;if(!u)return;a=!1,o.forEach(b=>b(r()));const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,r()))||void 0;return Ep(u.getItem.bind(u))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var I;return v=s.merge(b,(I=r())!=null?I:y),t(v,!0),f()}).then(()=>{T?.(v,void 0),a=!0,l.forEach(b=>b(v))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:E=>{s={...s,...E},E.getStorage&&(u=E.getStorage())},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:E=>(o.add(E),()=>{o.delete(E)}),onFinishHydration:E=>(l.add(E),()=>{l.delete(E)})},x(),v||y},fte=(n,e)=>(t,r,i)=>{let s={storage:hte(()=>localStorage),partialize:x=>x,version:0,merge:(x,E)=>({...E,...x}),...e},a=!1;const o=new Set,l=new Set;let u=s.storage;if(!u)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},r,i);const h=()=>{const x=s.partialize({...r()});return u.setItem(s.name,{state:x,version:s.version})},f=i.setState;i.setState=(x,E)=>{f(x,E),h()};const g=n((...x)=>{t(...x),h()},r,i);i.getInitialState=()=>g;let y;const v=()=>{var x,E;if(!u)return;a=!1,o.forEach(b=>{var I;return b((I=r())!=null?I:g)});const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,(x=r())!=null?x:g))||void 0;return Ep(u.getItem.bind(u))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var I;const[M,F]=b;if(y=s.merge(F,(I=r())!=null?I:g),t(y,!0),M)return h()}).then(()=>{T?.(y,void 0),y=r(),a=!0,l.forEach(b=>b(y))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(u=x.storage)},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||v(),y||g},gte=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((ute?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),dte(n,e)):fte(n,e),vd=gte,Lr=oa()(vd(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),Lw=oa()(G0((n,e)=>({user:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new bl;await eq(t0,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},logout:async()=>{n(t=>{t.loading=!0});try{await v6(t0)}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),x6(t0,t=>{n(r=>{r.user=t,r.loading=!1}),t&&Lr.getState().setVondstenLocalOnly(!1)}))}})));oa()(G0((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=Tee(WN(qc,"vondsten"),bee("userId","==",t)),s=(await Cee(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await Mee(WN(qc,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=Jf(qc,"vondsten",t);await kee(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await Pee(Jf(qc,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const SS=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],i3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],JF=oa()(vd((n,e)=>({presets:[...SS],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=fi.getState();i3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=fi.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&i3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...SS]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...SS]}:n})),s3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],x1=oa()(vd((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=s3[i%s3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),mte=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],$A=oa()(vd((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||mte.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));function pte({target:n,viewOptions:e}){const t=ee.useRef(null),r=ee.useRef(null),i=Di(a=>a.setMap),s=Lr(a=>a.showScaleBar);return ee.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new VH({target:n,controls:[],view:new Oo({center:ka(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),ee.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new UH({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const a3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function yte(){const n=ee.useRef(null),e=ee.useRef(!1);pte({target:"map"});const t=Di(f=>f.map),r=fi(f=>f.registerLayer),i=fi(f=>f.setLayerVisibility),s=Lr(f=>f.defaultBackground);ee.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const f=new sh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new iH}),g=new sh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new bf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new sh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new bf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),v=new sh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new bf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),x=new sh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new bf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),E=new sh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new bf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(f),t.addLayer(g),t.addLayer(y),t.addLayer(v),t.addLayer(x),t.addLayer(E),console.log(" Base layers added:",{osm:f.getVisible(),cartodb:g.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",f),r("CartoDB (licht)",g),r("Luchtfoto",y),r("Labels Overlay",v),r("TMK 1850",x),r("Bonnebladen 1900",E),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const f=mK();console.log(` Loading ${f.length} immediate-load layers (WMS/Tile)...`);const g=await Promise.allSettled(f.map(async v=>{try{const x=await v.factory();return x?{name:v.name,layer:x}:null}catch(x){return console.warn(` Failed to create ${v.name}:`,x),null}}));let y=0;g.forEach(v=>{if(v.status==="fulfilled"&&v.value){const{name:x,layer:E}=v.value;t.addLayer(E),r(x,E),y++,console.log(`   ${x}`)}}),console.log(` Immediate layers loaded: ${y}/${f.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}ee.useEffect(()=>{if(!t||e.current)return;const f=setTimeout(()=>{const g=s||"CartoDB (licht)";a3.forEach(y=>{i(y,!1)}),a3.includes(g)?i(g,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${g}`)},100);return()=>clearTimeout(f)},[t,s,i]);const o=Lr(f=>f.gpsAutoStart),l=os(f=>f.startTracking),u=ee.useRef(!1);ee.useEffect(()=>{if(!(!t||u.current)&&o){const f=setTimeout(()=>{l(),u.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(f)}},[t,o,l]);const h={width:"100%",height:"100vh"};return m.jsx("div",{id:"map",ref:n,style:h})}const WA=ee.createContext({});function HA(n){const e=ee.useRef(null);return e.current===null&&(e.current=n()),e.current}const Ow=ee.createContext(null),KA=ee.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class _te extends ee.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function xte({children:n,isPresent:e}){const t=ee.useId(),r=ee.useRef(null),i=ee.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=ee.useContext(KA);return ee.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:u}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),m.jsx(_te,{isPresent:e,childRef:r,sizeRef:i,children:ee.cloneElement(n,{ref:r})})}const vte=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=HA(wte),l=ee.useId(),u=ee.useCallback(f=>{o.set(f,!0);for(const g of o.values())if(!g)return;r&&r()},[o,r]),h=ee.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:u,register:f=>(o.set(f,!1),()=>o.delete(f))}),s?[Math.random(),u]:[t,u]);return ee.useMemo(()=>{o.forEach((f,g)=>o.set(g,!1))},[t]),ee.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=m.jsx(xte,{isPresent:t,children:n})),m.jsx(Ow.Provider,{value:h,children:n})};function wte(){return new Map}function ej(n=!0){const e=ee.useContext(Ow);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=ee.useId();ee.useEffect(()=>{n&&i(s)},[n]);const a=ee.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const a_=n=>n.key||"";function o3(n){const e=[];return ee.Children.forEach(n,t=>{ee.isValidElement(t)&&e.push(t)}),e}const YA=typeof window<"u",tj=YA?ee.useLayoutEffect:ee.useEffect,ir=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=ej(a),u=ee.useMemo(()=>o3(n),[n]),h=a&&!o?[]:u.map(a_),f=ee.useRef(!0),g=ee.useRef(u),y=HA(()=>new Map),[v,x]=ee.useState(u),[E,T]=ee.useState(u);tj(()=>{f.current=!1,g.current=u;for(let M=0;M<E.length;M++){const F=a_(E[M]);h.includes(F)?y.delete(F):y.get(F)!==!0&&y.set(F,!1)}},[E,h.length,h.join("-")]);const b=[];if(u!==v){let M=[...u];for(let F=0;F<E.length;F++){const G=E[F],R=a_(G);h.includes(R)||(M.splice(F,0,G),b.push(G))}s==="wait"&&b.length&&(M=b),T(o3(M)),x(u);return}const{forceRender:I}=ee.useContext(WA);return m.jsx(m.Fragment,{children:E.map(M=>{const F=a_(M),G=a&&!o?!1:u===E||h.includes(F),R=()=>{if(y.has(F))y.set(F,!0);else return;let C=!0;y.forEach(P=>{P||(C=!1)}),C&&(I?.(),T(g.current),a&&l?.(),r&&r())};return m.jsx(vte,{isPresent:G,initial:!f.current||t?void 0:!1,custom:G?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:G?void 0:R,children:M},F)})})},ea=n=>n;let nj=ea;function XA(n){let e;return()=>(e===void 0&&(e=n()),e)}const P0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Dl=n=>n*1e3,Fl=n=>n/1e3,Ete={useManualTiming:!1};function Ste(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(u){s.has(u)&&(l.schedule(u),n()),u(a)}const l={schedule:(u,h=!1,f=!1)=>{const y=f&&r?e:t;return h&&s.add(u),y.has(u)||y.add(u),u},cancel:u=>{t.delete(u),s.delete(u)},process:u=>{if(a=u,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(u))}};return l}const o_=["read","resolveKeyframes","update","preRender","render","postRender"],Tte=40;function rj(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=o_.reduce((T,b)=>(T[b]=Ste(s),T),{}),{read:o,resolveKeyframes:l,update:u,preRender:h,render:f,postRender:g}=a,y=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,Tte),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),h.process(i),f.process(i),g.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},v=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:o_.reduce((T,b)=>{const I=a[b];return T[b]=(M,F=!1,G=!1)=>(t||v(),I.schedule(M,F,G)),T},{}),cancel:T=>{for(let b=0;b<o_.length;b++)a[o_[b]].cancel(T)},state:i,steps:a}}const{schedule:ur,cancel:pu,state:Ai,steps:TS}=rj(typeof requestAnimationFrame<"u"?requestAnimationFrame:ea,!0),ij=ee.createContext({strict:!1}),l3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},M0={};for(const n in l3)M0[n]={isEnabled:e=>l3[n].some(t=>!!e[t])};function bte(n){for(const e in n)M0[e]={...M0[e],...n[e]}}const Ite=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Yx(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Ite.has(n)}let sj=n=>!Yx(n);function Ate(n){n&&(sj=e=>e.startsWith("on")?!Yx(e):n(e))}try{Ate(require("@emotion/is-prop-valid").default)}catch{}function Rte(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(sj(i)||t===!0&&Yx(i)||!e&&!Yx(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function Cte(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const Dw=ee.createContext({});function Sp(n){return typeof n=="string"||Array.isArray(n)}function Fw(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const qA=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ZA=["initial",...qA];function jw(n){return Fw(n.animate)||ZA.some(e=>Sp(n[e]))}function aj(n){return!!(jw(n)||n.variants)}function kte(n,e){if(jw(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Sp(t)?t:void 0,animate:Sp(r)?r:void 0}}return n.inherit!==!1?e:{}}function Pte(n){const{initial:e,animate:t}=kte(n,ee.useContext(Dw));return ee.useMemo(()=>({initial:e,animate:t}),[c3(e),c3(t)])}function c3(n){return Array.isArray(n)?n.join(" "):n}const Mte=Symbol.for("motionComponentSymbol");function Df(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Nte(n,e,t){return ee.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Df(t)&&(t.current=r))},[e])}const QA=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Lte="framerAppearId",oj="data-"+QA(Lte),{schedule:JA}=rj(queueMicrotask,!1),lj=ee.createContext({});function Ote(n,e,t,r,i){var s,a;const{visualElement:o}=ee.useContext(Dw),l=ee.useContext(ij),u=ee.useContext(Ow),h=ee.useContext(KA).reducedMotion,f=ee.useRef(null);r=r||l.renderer,!f.current&&r&&(f.current=r(n,{visualState:e,parent:o,props:t,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const g=f.current,y=ee.useContext(lj);g&&!g.projection&&i&&(g.type==="html"||g.type==="svg")&&Dte(f.current,t,i,y);const v=ee.useRef(!1);ee.useInsertionEffect(()=>{g&&v.current&&g.update(t,u)});const x=t[oj],E=ee.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,x)));return tj(()=>{g&&(v.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),JA.render(g.render),E.current&&g.animationState&&g.animationState.animateChanges())}),ee.useEffect(()=>{g&&(!E.current&&g.animationState&&g.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,x)}),E.current=!1))}),g}function Dte(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:cj(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&Df(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function cj(n){if(n)return n.options.allowProjection!==!1?n.projection:cj(n.parent)}function Fte({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&bte(n);function o(u,h){let f;const g={...ee.useContext(KA),...u,layoutId:jte(u)},{isStatic:y}=g,v=Pte(u),x=r(u,y);if(!y&&YA){Vte();const E=Gte(g);f=E.MeasureLayout,v.visualElement=Ote(i,x,g,e,E.ProjectionNode)}return m.jsxs(Dw.Provider,{value:v,children:[f&&v.visualElement?m.jsx(f,{visualElement:v.visualElement,...g}):null,t(i,u,Nte(x,v.visualElement,h),x,y,v.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=ee.forwardRef(o);return l[Mte]=i,l}function jte({layoutId:n}){const e=ee.useContext(WA).id;return e&&n!==void 0?e+"-"+n:n}function Vte(n,e){ee.useContext(ij).strict}function Gte(n){const{drag:e,layout:t}=M0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Bte=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function eR(n){return typeof n!="string"||n.includes("-")?!1:!!(Bte.indexOf(n)>-1||/[A-Z]/u.test(n))}function u3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function tR(n,e,t,r){if(typeof e=="function"){const[i,s]=u3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=u3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const hb=n=>Array.isArray(n),Ute=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),zte=n=>hb(n)?n[n.length-1]||0:n,qi=n=>!!(n&&n.getVelocity);function $_(n){const e=qi(n)?n.get():n;return Ute(e)?e.toValue():e}function $te({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:Wte(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const uj=n=>(e,t)=>{const r=ee.useContext(Dw),i=ee.useContext(Ow),s=()=>$te(n,e,r,i);return t?s():HA(s)};function Wte(n,e,t,r){const i={},s=r(n,{});for(const g in s)i[g]=$_(s[g]);let{initial:a,animate:o}=n;const l=jw(n),u=aj(n);e&&u&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const f=h?o:a;if(f&&typeof f!="boolean"&&!Fw(f)){const g=Array.isArray(f)?f:[f];for(let y=0;y<g.length;y++){const v=tR(n,g[y]);if(v){const{transitionEnd:x,transition:E,...T}=v;for(const b in T){let I=T[b];if(Array.isArray(I)){const M=h?I.length-1:0;I=I[M]}I!==null&&(i[b]=I)}for(const b in x)i[b]=x[b]}}}return i}const H0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],wd=new Set(H0),hj=n=>e=>typeof e=="string"&&e.startsWith(n),dj=hj("--"),Hte=hj("var(--"),nR=n=>Hte(n)?Kte.test(n.split("/*")[0].trim()):!1,Kte=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,fj=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Hl=(n,e,t)=>t>e?e:t<n?n:t,K0={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Tp={...K0,transform:n=>Hl(0,1,n)},l_={...K0,default:1},v1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Dc=v1("deg"),Ho=v1("%"),Gt=v1("px"),Yte=v1("vh"),Xte=v1("vw"),h3={...Ho,parse:n=>Ho.parse(n)/100,transform:n=>Ho.transform(n*100)},qte={borderWidth:Gt,borderTopWidth:Gt,borderRightWidth:Gt,borderBottomWidth:Gt,borderLeftWidth:Gt,borderRadius:Gt,radius:Gt,borderTopLeftRadius:Gt,borderTopRightRadius:Gt,borderBottomRightRadius:Gt,borderBottomLeftRadius:Gt,width:Gt,maxWidth:Gt,height:Gt,maxHeight:Gt,top:Gt,right:Gt,bottom:Gt,left:Gt,padding:Gt,paddingTop:Gt,paddingRight:Gt,paddingBottom:Gt,paddingLeft:Gt,margin:Gt,marginTop:Gt,marginRight:Gt,marginBottom:Gt,marginLeft:Gt,backgroundPositionX:Gt,backgroundPositionY:Gt},Zte={rotate:Dc,rotateX:Dc,rotateY:Dc,rotateZ:Dc,scale:l_,scaleX:l_,scaleY:l_,scaleZ:l_,skew:Dc,skewX:Dc,skewY:Dc,distance:Gt,translateX:Gt,translateY:Gt,translateZ:Gt,x:Gt,y:Gt,z:Gt,perspective:Gt,transformPerspective:Gt,opacity:Tp,originX:h3,originY:h3,originZ:Gt},d3={...K0,transform:Math.round},rR={...qte,...Zte,zIndex:d3,size:Gt,fillOpacity:Tp,strokeOpacity:Tp,numOctaves:d3},Qte={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Jte=H0.length;function ene(n,e,t){let r="",i=!0;for(let s=0;s<Jte;s++){const a=H0[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const u=fj(o,rR[a]);if(!l){i=!1;const h=Qte[a]||a;r+=`${h}(${u}) `}t&&(e[a]=u)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function iR(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const u=e[l];if(wd.has(l)){a=!0;continue}else if(dj(l)){i[l]=u;continue}else{const h=fj(u,rR[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=ene(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${u} ${h}`}}const tne={offset:"stroke-dashoffset",array:"stroke-dasharray"},nne={offset:"strokeDashoffset",array:"strokeDasharray"};function rne(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?tne:nne;n[s.offset]=Gt.transform(-r);const a=Gt.transform(e),o=Gt.transform(t);n[s.array]=`${a} ${o}`}function f3(n,e,t){return typeof n=="string"?n:Gt.transform(e+t*n)}function ine(n,e,t){const r=f3(e,n.x,n.width),i=f3(t,n.y,n.height);return`${r} ${i}`}function sR(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...u},h,f){if(iR(n,u,f),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:g,style:y,dimensions:v}=n;g.transform&&(v&&(y.transform=g.transform),delete g.transform),v&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=ine(v,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(g.x=e),t!==void 0&&(g.y=t),r!==void 0&&(g.scale=r),a!==void 0&&rne(g,a,o,l,!1)}const aR=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),gj=()=>({...aR(),attrs:{}}),oR=n=>typeof n=="string"&&n.toLowerCase()==="svg";function mj(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const pj=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function yj(n,e,t,r){mj(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(pj.has(i)?i:QA(i),e.attrs[i])}const Xx={};function sne(n){Object.assign(Xx,n)}function _j(n,{layout:e,layoutId:t}){return wd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Xx[n]||n==="opacity")}function lR(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(qi(i[a])||e.style&&qi(e.style[a])||_j(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function xj(n,e,t){const r=lR(n,e,t);for(const i in n)if(qi(n[i])||qi(e[i])){const s=H0.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function ane(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const g3=["x","y","width","height","cx","cy","r"],one={useVisualState:uj({scrapeMotionValuesFromProps:xj,createRenderState:gj,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(wd.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<g3.length;o++){const l=g3[o];n[l]!==e[l]&&(a=!0)}a&&ur.read(()=>{ane(t,r),ur.render(()=>{sR(r,i,oR(t.tagName),n.transformTemplate),yj(t,r)})})}})},lne={useVisualState:uj({scrapeMotionValuesFromProps:lR,createRenderState:aR})};function vj(n,e,t){for(const r in e)!qi(e[r])&&!_j(r,t)&&(n[r]=e[r])}function cne({transformTemplate:n},e){return ee.useMemo(()=>{const t=aR();return iR(t,e,n),Object.assign({},t.vars,t.style)},[e])}function une(n,e){const t=n.style||{},r={};return vj(r,t,n),Object.assign(r,cne(n,e)),r}function hne(n,e){const t={},r=une(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function dne(n,e,t,r){const i=ee.useMemo(()=>{const s=gj();return sR(s,e,oR(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};vj(s,n.style,n),i.style={...s,...i.style}}return i}function fne(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(eR(t)?dne:hne)(r,s,a,t),u=Rte(r,typeof t=="string",n),h=t!==ee.Fragment?{...u,...l,ref:i}:{},{children:f}=r,g=ee.useMemo(()=>qi(f)?f.get():f,[f]);return ee.createElement(t,{...h,children:g})}}function gne(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...eR(r)?one:lne,preloadedFeatures:n,useRender:fne(i),createVisualElement:e,Component:r};return Fte(a)}}function wj(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function Vw(n,e,t){const r=n.getProps();return tR(r,e,t!==void 0?t:r.custom,n)}const mne=XA(()=>window.ScrollTimeline!==void 0);class pne{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(mne()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class yne extends pne{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function cR(n,e){return n?n[e]||n.default||n:void 0}const db=2e4;function Ej(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<db;)e+=t,r=n.next(e);return e>=db?1/0:e}function uR(n){return typeof n=="function"}function m3(n,e){n.timeline=e,n.onfinish=null}const hR=n=>Array.isArray(n)&&typeof n[0]=="number",_ne={linearEasing:void 0};function xne(n,e){const t=XA(n);return()=>{var r;return(r=_ne[e])!==null&&r!==void 0?r:t()}}const qx=xne(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Sj=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(P0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function Tj(n){return!!(typeof n=="function"&&qx()||!n||typeof n=="string"&&(n in fb||qx())||hR(n)||Array.isArray(n)&&n.every(Tj))}const cm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,fb={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cm([0,.65,.55,1]),circOut:cm([.55,0,1,.45]),backIn:cm([.31,.01,.66,-.59]),backOut:cm([.33,1.53,.69,.99])};function bj(n,e){if(n)return typeof n=="function"&&qx()?Sj(n,e):hR(n)?cm(n):Array.isArray(n)?n.map(t=>bj(t,e)||fb.easeOut):fb[n]}const Wa={x:!1,y:!1};function Ij(){return Wa.x||Wa.y}function vne(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function Aj(n,e){const t=vne(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function p3(n){return e=>{e.pointerType==="touch"||Ij()||n(e)}}function wne(n,e,t={}){const[r,i,s]=Aj(n,t),a=p3(o=>{const{target:l}=o,u=e(o);if(typeof u!="function"||!l)return;const h=p3(f=>{u(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const Rj=(n,e)=>e?n===e?!0:Rj(n,e.parentElement):!1,dR=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Ene=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Sne(n){return Ene.has(n.tagName)||n.tabIndex!==-1}const um=new WeakSet;function y3(n){return e=>{e.key==="Enter"&&n(e)}}function bS(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Tne=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=y3(()=>{if(um.has(t))return;bS(t,"down");const i=y3(()=>{bS(t,"up")}),s=()=>bS(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function _3(n){return dR(n)&&!Ij()}function bne(n,e,t={}){const[r,i,s]=Aj(n,t),a=o=>{const l=o.currentTarget;if(!_3(o)||um.has(l))return;um.add(l);const u=e(o),h=(y,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",g),!(!_3(y)||!um.has(l))&&(um.delete(l),typeof u=="function"&&u(y,{success:v}))},f=y=>{h(y,t.useGlobalTarget||Rj(l,y.target))},g=y=>{h(y,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",g,i)};return r.forEach(o=>{!Sne(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",u=>Tne(u,i),i)}),s}function Ine(n){return n==="x"||n==="y"?Wa[n]?null:(Wa[n]=!0,()=>{Wa[n]=!1}):Wa.x||Wa.y?null:(Wa.x=Wa.y=!0,()=>{Wa.x=Wa.y=!1})}const Cj=new Set(["width","height","top","left","right","bottom",...H0]);let W_;function Ane(){W_=void 0}const Ko={now:()=>(W_===void 0&&Ko.set(Ai.isProcessing||Ete.useManualTiming?Ai.timestamp:performance.now()),W_),set:n=>{W_=n,queueMicrotask(Ane)}};function fR(n,e){n.indexOf(e)===-1&&n.push(e)}function gR(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class mR{constructor(){this.subscriptions=[]}add(e){return fR(this.subscriptions,e),()=>gR(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function kj(n,e){return e?n*(1e3/e):0}const x3=30,Rne=n=>!isNaN(parseFloat(n));class Cne{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=Ko.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ko.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Rne(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new mR);const r=this.events[e].add(t);return e==="change"?()=>{r(),ur.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ko.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>x3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,x3);return kj(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function bp(n,e){return new Cne(n,e)}function kne(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,bp(t))}function Pne(n,e){const t=Vw(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=zte(s[a]);kne(n,a,o)}}function Mne(n){return!!(qi(n)&&n.add)}function gb(n,e){const t=n.getValue("willChange");if(Mne(t))return t.add(e)}function Pj(n){return n.props[oj]}const Mj=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,Nne=1e-7,Lne=12;function One(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=Mj(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>Nne&&++o<Lne);return a}function w1(n,e,t,r){if(n===e&&t===r)return ea;const i=s=>One(s,0,1,n,t);return s=>s===0||s===1?s:Mj(i(s),e,r)}const Nj=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,Lj=n=>e=>1-n(1-e),Oj=w1(.33,1.53,.69,.99),pR=Lj(Oj),Dj=Nj(pR),Fj=n=>(n*=2)<1?.5*pR(n):.5*(2-Math.pow(2,-10*(n-1))),yR=n=>1-Math.sin(Math.acos(n)),jj=Lj(yR),Vj=Nj(yR),Gj=n=>/^0[^.\s]+$/u.test(n);function Dne(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||Gj(n):!0}const Rm=n=>Math.round(n*1e5)/1e5,_R=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Fne(n){return n==null}const jne=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,xR=(n,e)=>t=>!!(typeof t=="string"&&jne.test(t)&&t.startsWith(n)||e&&!Fne(t)&&Object.prototype.hasOwnProperty.call(t,e)),Bj=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(_R);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Vne=n=>Hl(0,255,n),IS={...K0,transform:n=>Math.round(Vne(n))},bh={test:xR("rgb","red"),parse:Bj("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+IS.transform(n)+", "+IS.transform(e)+", "+IS.transform(t)+", "+Rm(Tp.transform(r))+")"};function Gne(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const mb={test:xR("#"),parse:Gne,transform:bh.transform},Ff={test:xR("hsl","hue"),parse:Bj("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Ho.transform(Rm(e))+", "+Ho.transform(Rm(t))+", "+Rm(Tp.transform(r))+")"},Wi={test:n=>bh.test(n)||mb.test(n)||Ff.test(n),parse:n=>bh.test(n)?bh.parse(n):Ff.test(n)?Ff.parse(n):mb.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?bh.transform(n):Ff.transform(n)},Bne=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Une(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(_R))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Bne))===null||t===void 0?void 0:t.length)||0)>0}const Uj="number",zj="color",zne="var",$ne="var(",v3="${}",Wne=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ip(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Wne,l=>(Wi.test(l)?(r.color.push(s),i.push(zj),t.push(Wi.parse(l))):l.startsWith($ne)?(r.var.push(s),i.push(zne),t.push(l)):(r.number.push(s),i.push(Uj),t.push(parseFloat(l))),++s,v3)).split(v3);return{values:t,split:o,indexes:r,types:i}}function $j(n){return Ip(n).values}function Wj(n){const{split:e,types:t}=Ip(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===Uj?s+=Rm(i[a]):o===zj?s+=Wi.transform(i[a]):s+=i[a]}return s}}const Hne=n=>typeof n=="number"?0:n;function Kne(n){const e=$j(n);return Wj(n)(e.map(Hne))}const yu={test:Une,parse:$j,createTransformer:Wj,getAnimatableNone:Kne},Yne=new Set(["brightness","contrast","saturate","opacity"]);function Xne(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(_R)||[];if(!r)return n;const i=t.replace(r,"");let s=Yne.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const qne=/\b([a-z-]*)\(.*?\)/gu,pb={...yu,getAnimatableNone:n=>{const e=n.match(qne);return e?e.map(Xne).join(" "):n}},Zne={...rR,color:Wi,backgroundColor:Wi,outlineColor:Wi,fill:Wi,stroke:Wi,borderColor:Wi,borderTopColor:Wi,borderRightColor:Wi,borderBottomColor:Wi,borderLeftColor:Wi,filter:pb,WebkitFilter:pb},vR=n=>Zne[n];function Hj(n,e){let t=vR(n);return t!==pb&&(t=yu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Qne=new Set(["auto","none","0"]);function Jne(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Qne.has(s)&&Ip(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=Hj(t,i)}const w3=n=>n===K0||n===Gt,E3=(n,e)=>parseFloat(n.split(", ")[e]),S3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return E3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?E3(s[1],n):0}},ere=new Set(["x","y","z"]),tre=H0.filter(n=>!ere.has(n));function nre(n){const e=[];return tre.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const N0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:S3(4,13),y:S3(5,14)};N0.translateX=N0.x;N0.translateY=N0.y;const Lh=new Set;let yb=!1,_b=!1;function Kj(){if(_b){const n=Array.from(Lh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=nre(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}_b=!1,yb=!1,Lh.forEach(n=>n.complete()),Lh.clear()}function Yj(){Lh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(_b=!0)})}function rre(){Yj(),Kj()}class wR{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Lh.add(this),yb||(yb=!0,ur.read(Yj),ur.resolveKeyframes(Kj))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Lh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Lh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Xj=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),ire=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function sre(n){const e=ire.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function qj(n,e,t=1){const[r,i]=sre(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return Xj(a)?parseFloat(a):a}return nR(i)?qj(i,e,t+1):i}const Zj=n=>e=>e.test(n),are={test:n=>n==="auto",parse:n=>n},Qj=[K0,Gt,Ho,Dc,Xte,Yte,are],T3=n=>Qj.find(Zj(n));class Jj extends wR{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),nR(u))){const h=qj(u,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!Cj.has(r)||e.length!==2)return;const[i,s]=e,a=T3(i),o=T3(s);if(a!==o)if(w3(a)&&w3(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)Dne(e[i])&&r.push(i);r.length&&Jne(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=N0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=N0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const b3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(yu.test(n)||n==="0")&&!n.startsWith("url("));function ore(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function lre(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=b3(i,e),o=b3(s,e);return!a||!o?!1:ore(n)||(t==="spring"||uR(t))&&r}const cre=n=>n!==null;function Gw(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(cre),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const ure=40;class e9{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ko.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>ure?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&rre(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Ko.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:u}=this.options;if(!u&&!lre(e,r,i,s))if(a)this.options.duration=0;else{l&&l(Gw(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Ir=(n,e,t)=>n+(e-n)*t;function AS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function hre({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=AS(l,o,n+1/3),s=AS(l,o,n),a=AS(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Zx(n,e){return t=>t>0?e:n}const RS=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},dre=[mb,bh,Ff],fre=n=>dre.find(e=>e.test(n));function I3(n){const e=fre(n);if(!e)return!1;let t=e.parse(n);return e===Ff&&(t=hre(t)),t}const A3=(n,e)=>{const t=I3(n),r=I3(e);if(!t||!r)return Zx(n,e);const i={...t};return s=>(i.red=RS(t.red,r.red,s),i.green=RS(t.green,r.green,s),i.blue=RS(t.blue,r.blue,s),i.alpha=Ir(t.alpha,r.alpha,s),bh.transform(i))},gre=(n,e)=>t=>e(n(t)),E1=(...n)=>n.reduce(gre),xb=new Set(["none","hidden"]);function mre(n,e){return xb.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function pre(n,e){return t=>Ir(n,e,t)}function ER(n){return typeof n=="number"?pre:typeof n=="string"?nR(n)?Zx:Wi.test(n)?A3:xre:Array.isArray(n)?t9:typeof n=="object"?Wi.test(n)?A3:yre:Zx}function t9(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>ER(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function yre(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=ER(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function _re(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const xre=(n,e)=>{const t=yu.createTransformer(e),r=Ip(n),i=Ip(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?xb.has(n)&&!i.values.length||xb.has(e)&&!r.values.length?mre(n,e):E1(t9(_re(r,i),i.values),t):Zx(n,e)};function n9(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Ir(n,e,t):ER(n)(n,e)}const vre=5;function r9(n,e,t){const r=Math.max(e-vre,0);return kj(t-n(r),e-r)}const kr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},CS=.001;function wre({duration:n=kr.duration,bounce:e=kr.bounce,velocity:t=kr.velocity,mass:r=kr.mass}){let i,s,a=1-e;a=Hl(kr.minDamping,kr.maxDamping,a),n=Hl(kr.minDuration,kr.maxDuration,Fl(n)),a<1?(i=u=>{const h=u*a,f=h*n,g=h-t,y=vb(u,a),v=Math.exp(-f);return CS-g/y*v},s=u=>{const f=u*a*n,g=f*t+t,y=Math.pow(a,2)*Math.pow(u,2)*n,v=Math.exp(-f),x=vb(Math.pow(u,2),a);return(-i(u)+CS>0?-1:1)*((g-y)*v)/x}):(i=u=>{const h=Math.exp(-u*n),f=(u-t)*n+1;return-CS+h*f},s=u=>{const h=Math.exp(-u*n),f=(t-u)*(n*n);return h*f});const o=5/n,l=Sre(i,s,o);if(n=Dl(n),isNaN(l))return{stiffness:kr.stiffness,damping:kr.damping,duration:n};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:n}}}const Ere=12;function Sre(n,e,t){let r=t;for(let i=1;i<Ere;i++)r=r-n(r)/e(r);return r}function vb(n,e){return n*Math.sqrt(1-e*e)}const Tre=["duration","bounce"],bre=["stiffness","damping","mass"];function R3(n,e){return e.some(t=>n[t]!==void 0)}function Ire(n){let e={velocity:kr.velocity,stiffness:kr.stiffness,damping:kr.damping,mass:kr.mass,isResolvedFromDuration:!1,...n};if(!R3(n,bre)&&R3(n,Tre))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*Hl(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:kr.mass,stiffness:i,damping:s}}else{const t=wre(n);e={...e,...t,mass:kr.mass},e.isResolvedFromDuration=!0}return e}function i9(n=kr.visualDuration,e=kr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:h,duration:f,velocity:g,isResolvedFromDuration:y}=Ire({...t,velocity:-Fl(t.velocity||0)}),v=g||0,x=u/(2*Math.sqrt(l*h)),E=a-s,T=Fl(Math.sqrt(l/h)),b=Math.abs(E)<5;r||(r=b?kr.restSpeed.granular:kr.restSpeed.default),i||(i=b?kr.restDelta.granular:kr.restDelta.default);let I;if(x<1){const F=vb(T,x);I=G=>{const R=Math.exp(-x*T*G);return a-R*((v+x*T*E)/F*Math.sin(F*G)+E*Math.cos(F*G))}}else if(x===1)I=F=>a-Math.exp(-T*F)*(E+(v+T*E)*F);else{const F=T*Math.sqrt(x*x-1);I=G=>{const R=Math.exp(-x*T*G),C=Math.min(F*G,300);return a-R*((v+x*T*E)*Math.sinh(C)+F*E*Math.cosh(C))/F}}const M={calculatedDuration:y&&f||null,next:F=>{const G=I(F);if(y)o.done=F>=f;else{let R=0;x<1&&(R=F===0?Dl(v):r9(I,F,G));const C=Math.abs(R)<=r,P=Math.abs(a-G)<=i;o.done=C&&P}return o.value=o.done?a:G,o},toString:()=>{const F=Math.min(Ej(M),db),G=Sj(R=>M.next(F*R).value,F,30);return F+"ms "+G}};return M}function C3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:h}){const f=n[0],g={done:!1,value:f},y=C=>o!==void 0&&C<o||l!==void 0&&C>l,v=C=>o===void 0?l:l===void 0||Math.abs(o-C)<Math.abs(l-C)?o:l;let x=t*e;const E=f+x,T=a===void 0?E:a(E);T!==E&&(x=T-f);const b=C=>-x*Math.exp(-C/r),I=C=>T+b(C),M=C=>{const P=b(C),N=I(C);g.done=Math.abs(P)<=u,g.value=g.done?T:N};let F,G;const R=C=>{y(g.value)&&(F=C,G=i9({keyframes:[g.value,v(g.value)],velocity:r9(I,C,g.value),damping:i,stiffness:s,restDelta:u,restSpeed:h}))};return R(0),{calculatedDuration:null,next:C=>{let P=!1;return!G&&F===void 0&&(P=!0,M(C),R(C)),F!==void 0&&C>=F?G.next(C-F):(!P&&M(C),g)}}}const Are=w1(.42,0,1,1),Rre=w1(0,0,.58,1),s9=w1(.42,0,.58,1),Cre=n=>Array.isArray(n)&&typeof n[0]!="number",kre={linear:ea,easeIn:Are,easeInOut:s9,easeOut:Rre,circIn:yR,circInOut:Vj,circOut:jj,backIn:pR,backInOut:Dj,backOut:Oj,anticipate:Fj},k3=n=>{if(hR(n)){nj(n.length===4);const[e,t,r,i]=n;return w1(e,t,r,i)}else if(typeof n=="string")return kre[n];return n};function Pre(n,e,t){const r=[],i=t||n9,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||ea:e;o=E1(l,o)}r.push(o)}return r}function Mre(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(nj(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Pre(e,r,i),l=o.length,u=h=>{if(a&&h<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const g=P0(n[f],n[f+1],h);return o[f](g)};return t?h=>u(Hl(n[0],n[s-1],h)):u}function Nre(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=P0(0,e,r);n.push(Ir(t,1,i))}}function Lre(n){const e=[0];return Nre(e,n.length-1),e}function Ore(n,e){return n.map(t=>t*e)}function Dre(n,e){return n.map(()=>e||s9).splice(0,n.length-1)}function Qx({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=Cre(r)?r.map(k3):k3(r),s={done:!1,value:e[0]},a=Ore(t&&t.length===e.length?t:Lre(e),n),o=Mre(a,e,{ease:Array.isArray(i)?i:Dre(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const Fre=n=>{const e=({timestamp:t})=>n(t);return{start:()=>ur.update(e,!0),stop:()=>pu(e),now:()=>Ai.isProcessing?Ai.timestamp:Ko.now()}},jre={decay:C3,inertia:C3,tween:Qx,keyframes:Qx,spring:i9},Vre=n=>n/100;class SR extends e9{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||wR,o=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=uR(t)?t:jre[t]||Qx;let l,u;o!==Qx&&typeof e[0]!="number"&&(l=E1(Vre,n9(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(u=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=Ej(h));const{calculatedDuration:f}=h,g=f+i,y=g*(r+1)-i;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:g,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:u,totalDuration:h,resolvedDuration:f}=r;if(this.startTime===null)return s.next(0);const{delay:g,repeat:y,repeatType:v,repeatDelay:x,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-g*(this.speed>=0?1:-1),b=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let I=this.currentTime,M=s;if(y){const C=Math.min(this.currentTime,h)/f;let P=Math.floor(C),N=C%1;!N&&C>=1&&(N=1),N===1&&P--,P=Math.min(P,y+1),P%2&&(v==="reverse"?(N=1-N,x&&(N-=x/f)):v==="mirror"&&(M=a)),I=Hl(0,1,N)*f}const F=b?{done:!1,value:l[0]}:M.next(I);o&&(F.value=o(F.value));let{done:G}=F;!b&&u!==null&&(G=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&G);return R&&i!==void 0&&(F.value=Gw(l,this.options,i)),E&&E(F.value),R&&this.finish(),F}get duration(){const{resolved:e}=this;return e?Fl(e.calculatedDuration):0}get time(){return Fl(this.currentTime)}set time(e){e=Dl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Fl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Fre,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Gre=new Set(["opacity","clipPath","filter","transform"]);function Bre(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const u={[e]:t};l&&(u.offset=l);const h=bj(o,i);return Array.isArray(h)&&(u.easing=h),n.animate(u,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Ure=XA(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Jx=10,zre=2e4;function $re(n){return uR(n.type)||n.type==="spring"||!Tj(n.ease)}function Wre(n,e){const t=new SR({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<zre;)r=t.sample(s),i.push(r.value),s+=Jx;return{times:void 0,keyframes:i,duration:s-Jx,ease:"linear"}}const a9={anticipate:Fj,backInOut:Dj,circInOut:Vj};function Hre(n){return n in a9}class P3 extends e9{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new Jj(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&qx()&&Hre(s)&&(s=a9[s]),$re(this.options)){const{onComplete:f,onUpdate:g,motionValue:y,element:v,...x}=this.options,E=Wre(e,x);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,i=E.times,s=E.ease,a="keyframes"}const h=Bre(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(m3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;o.set(Gw(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Fl(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Fl(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Dl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return ea;const{animation:r}=t;m3(r,e)}return ea}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:f,element:g,...y}=this.options,v=new SR({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),x=Dl(this.time);u.setWithVelocity(v.sample(x-Jx).value,v.sample(x).value,Jx)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return Ure()&&r&&Gre.has(r)&&!l&&!u&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Kre={type:"spring",stiffness:500,damping:25,restSpeed:10},Yre=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Xre={type:"keyframes",duration:.8},qre={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Zre=(n,{keyframes:e})=>e.length>2?Xre:wd.has(n)?n.startsWith("scale")?Yre(e[1]):Kre:qre;function Qre({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const TR=(n,e,t,r={},i,s)=>a=>{const o=cR(r,n)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Dl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:g=>{e.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Qre(o)||(h={...h,...Zre(n,h)}),h.duration&&(h.duration=Dl(h.duration)),h.repeatDelay&&(h.repeatDelay=Dl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!s&&e.get()!==void 0){const g=Gw(h.keyframes,o);if(g!==void 0)return ur.update(()=>{h.onUpdate(g),h.onComplete()}),new yne([])}return!s&&P3.supports(h)?new P3(h):new SR(h)};function Jre({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function o9(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const u=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const f in l){const g=n.getValue(f,(s=n.latestValues[f])!==null&&s!==void 0?s:null),y=l[f];if(y===void 0||h&&Jre(h,f))continue;const v={delay:t,...cR(a||{},f)};let x=!1;if(window.MotionHandoffAnimation){const T=Pj(n);if(T){const b=window.MotionHandoffAnimation(T,f,ur);b!==null&&(v.startTime=b,x=!0)}}gb(n,f),g.start(TR(f,g,y,n.shouldReduceMotion&&Cj.has(f)?{type:!1}:v,n,x));const E=g.animation;E&&u.push(E)}return o&&Promise.all(u).then(()=>{ur.update(()=>{o&&Pne(n,o)})}),u}function wb(n,e,t={}){var r;const i=Vw(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(o9(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:g}=s;return eie(n,e,h+u,f,g,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,h]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function eie(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(u=0)=>u*r:(u=0)=>o-u*r;return Array.from(n.variantChildren).sort(tie).forEach((u,h)=>{u.notify("AnimationStart",e),a.push(wb(u,e,{...s,delay:t+l(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function tie(n,e){return n.sortNodePosition(e)}function nie(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>wb(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=wb(n,e,t);else{const i=typeof e=="function"?Vw(n,e,t.custom):e;r=Promise.all(o9(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const rie=ZA.length;function l9(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?l9(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<rie;t++){const r=ZA[t],i=n.props[r];(Sp(i)||i===!1)&&(e[r]=i)}return e}const iie=[...qA].reverse(),sie=qA.length;function aie(n){return e=>Promise.all(e.map(({animation:t,options:r})=>nie(n,t,r)))}function oie(n){let e=aie(n),t=M3(),r=!0;const i=l=>(u,h)=>{var f;const g=Vw(n,h,l==="exit"?(f=n.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(g){const{transition:y,transitionEnd:v,...x}=g;u={...u,...x,...v}}return u};function s(l){e=l(n)}function a(l){const{props:u}=n,h=l9(n.parent)||{},f=[],g=new Set;let y={},v=1/0;for(let E=0;E<sie;E++){const T=iie[E],b=t[T],I=u[T]!==void 0?u[T]:h[T],M=Sp(I),F=T===l?b.isActive:null;F===!1&&(v=E);let G=I===h[T]&&I!==u[T]&&M;if(G&&r&&n.manuallyAnimateOnMount&&(G=!1),b.protectedKeys={...y},!b.isActive&&F===null||!I&&!b.prevProp||Fw(I)||typeof I=="boolean")continue;const R=lie(b.prevProp,I);let C=R||T===l&&b.isActive&&!G&&M||E>v&&M,P=!1;const N=Array.isArray(I)?I:[I];let O=N.reduce(i(T),{});F===!1&&(O={});const{prevResolvedValues:z={}}=b,j={...z,...O},be=Ne=>{C=!0,g.has(Ne)&&(P=!0,g.delete(Ne)),b.needsAnimating[Ne]=!0;const ue=n.getValue(Ne);ue&&(ue.liveStyle=!1)};for(const Ne in j){const ue=O[Ne],Te=z[Ne];if(y.hasOwnProperty(Ne))continue;let le=!1;hb(ue)&&hb(Te)?le=!wj(ue,Te):le=ue!==Te,le?ue!=null?be(Ne):g.add(Ne):ue!==void 0&&g.has(Ne)?be(Ne):b.protectedKeys[Ne]=!0}b.prevProp=I,b.prevResolvedValues=O,b.isActive&&(y={...y,...O}),r&&n.blockInitialAnimation&&(C=!1),C&&(!(G&&R)||P)&&f.push(...N.map(Ne=>({animation:Ne,options:{type:T}})))}if(g.size){const E={};g.forEach(T=>{const b=n.getBaseTarget(T),I=n.getValue(T);I&&(I.liveStyle=!0),E[T]=b??null}),f.push({animation:E})}let x=!!f.length;return r&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(f):Promise.resolve()}function o(l,u){var h;if(t[l].isActive===u)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(g=>{var y;return(y=g.animationState)===null||y===void 0?void 0:y.setActive(l,u)}),t[l].isActive=u;const f=a(l);for(const g in t)t[g].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=M3(),r=!0}}}function lie(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!wj(e,n):!1}function nh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function M3(){return{animate:nh(!0),whileInView:nh(),whileHover:nh(),whileTap:nh(),whileDrag:nh(),whileFocus:nh(),exit:nh()}}class Ru{constructor(e){this.isMounted=!1,this.node=e}update(){}}class cie extends Ru{constructor(e){super(e),e.animationState||(e.animationState=oie(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Fw(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let uie=0;class hie extends Ru{constructor(){super(...arguments),this.id=uie++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const die={animation:{Feature:cie},exit:{Feature:hie}};function Ap(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function S1(n){return{point:{x:n.pageX,y:n.pageY}}}const fie=n=>e=>dR(e)&&n(e,S1(e));function Cm(n,e,t,r){return Ap(n,e,fie(t),r)}const N3=(n,e)=>Math.abs(n-e);function gie(n,e){const t=N3(n.x,e.x),r=N3(n.y,e.y);return Math.sqrt(t**2+r**2)}class c9{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=PS(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,y=gie(f.offset,{x:0,y:0})>=3;if(!g&&!y)return;const{point:v}=f,{timestamp:x}=Ai;this.history.push({...v,timestamp:x});const{onStart:E,onMove:T}=this.handlers;g||(E&&E(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,f)},this.handlePointerMove=(f,g)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=kS(g,this.transformPagePoint),ur.update(this.updatePoint,!0)},this.handlePointerUp=(f,g)=>{this.end();const{onEnd:y,onSessionEnd:v,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=PS(f.type==="pointercancel"?this.lastMoveEventInfo:kS(g,this.transformPagePoint),this.history);this.startEvent&&y&&y(f,E),v&&v(f,E)},!dR(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=S1(e),o=kS(a,this.transformPagePoint),{point:l}=o,{timestamp:u}=Ai;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=t;h&&h(e,PS(o,this.history)),this.removeListeners=E1(Cm(this.contextWindow,"pointermove",this.handlePointerMove),Cm(this.contextWindow,"pointerup",this.handlePointerUp),Cm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),pu(this.updatePoint)}}function kS(n,e){return e?{point:e(n.point)}:n}function L3(n,e){return{x:n.x-e.x,y:n.y-e.y}}function PS({point:n},e){return{point:n,delta:L3(n,u9(e)),offset:L3(n,mie(e)),velocity:pie(e,.1)}}function mie(n){return n[0]}function u9(n){return n[n.length-1]}function pie(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=u9(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Dl(e)));)t--;if(!r)return{x:0,y:0};const s=Fl(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const h9=1e-4,yie=1-h9,_ie=1+h9,d9=.01,xie=0-d9,vie=0+d9;function sa(n){return n.max-n.min}function wie(n,e,t){return Math.abs(n-e)<=t}function O3(n,e,t,r=.5){n.origin=r,n.originPoint=Ir(e.min,e.max,n.origin),n.scale=sa(t)/sa(e),n.translate=Ir(t.min,t.max,n.origin)-n.originPoint,(n.scale>=yie&&n.scale<=_ie||isNaN(n.scale))&&(n.scale=1),(n.translate>=xie&&n.translate<=vie||isNaN(n.translate))&&(n.translate=0)}function km(n,e,t,r){O3(n.x,e.x,t.x,r?r.originX:void 0),O3(n.y,e.y,t.y,r?r.originY:void 0)}function D3(n,e,t){n.min=t.min+e.min,n.max=n.min+sa(e)}function Eie(n,e,t){D3(n.x,e.x,t.x),D3(n.y,e.y,t.y)}function F3(n,e,t){n.min=e.min-t.min,n.max=n.min+sa(e)}function Pm(n,e,t){F3(n.x,e.x,t.x),F3(n.y,e.y,t.y)}function Sie(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Ir(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Ir(t,n,r.max):Math.min(n,t)),n}function j3(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Tie(n,{top:e,left:t,bottom:r,right:i}){return{x:j3(n.x,t,i),y:j3(n.y,e,r)}}function V3(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function bie(n,e){return{x:V3(n.x,e.x),y:V3(n.y,e.y)}}function Iie(n,e){let t=.5;const r=sa(n),i=sa(e);return i>r?t=P0(e.min,e.max-r,n.min):r>i&&(t=P0(n.min,n.max-i,e.min)),Hl(0,1,t)}function Aie(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const Eb=.35;function Rie(n=Eb){return n===!1?n=0:n===!0&&(n=Eb),{x:G3(n,"left","right"),y:G3(n,"top","bottom")}}function G3(n,e,t){return{min:B3(n,e),max:B3(n,t)}}function B3(n,e){return typeof n=="number"?n:n[e]||0}const U3=()=>({translate:0,scale:1,origin:0,originPoint:0}),jf=()=>({x:U3(),y:U3()}),z3=()=>({min:0,max:0}),jr=()=>({x:z3(),y:z3()});function xa(n){return[n("x"),n("y")]}function f9({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function Cie({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function kie(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function MS(n){return n===void 0||n===1}function Sb({scale:n,scaleX:e,scaleY:t}){return!MS(n)||!MS(e)||!MS(t)}function uh(n){return Sb(n)||g9(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function g9(n){return $3(n.x)||$3(n.y)}function $3(n){return n&&n!=="0%"}function ev(n,e,t){const r=n-t,i=e*r;return t+i}function W3(n,e,t,r,i){return i!==void 0&&(n=ev(n,i,r)),ev(n,t,r)+e}function Tb(n,e=0,t=1,r,i){n.min=W3(n.min,e,t,r,i),n.max=W3(n.max,e,t,r,i)}function m9(n,{x:e,y:t}){Tb(n.x,e.translate,e.scale,e.originPoint),Tb(n.y,t.translate,t.scale,t.originPoint)}const H3=.999999999999,K3=1.0000000000001;function Pie(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gf(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,m9(n,a)),r&&uh(s.latestValues)&&Gf(n,s.latestValues))}e.x<K3&&e.x>H3&&(e.x=1),e.y<K3&&e.y>H3&&(e.y=1)}function Vf(n,e){n.min=n.min+e,n.max=n.max+e}function Y3(n,e,t,r,i=.5){const s=Ir(n.min,n.max,i);Tb(n,e,t,s,r)}function Gf(n,e){Y3(n.x,e.x,e.scaleX,e.scale,e.originX),Y3(n.y,e.y,e.scaleY,e.scale,e.originY)}function p9(n,e){return f9(kie(n.getBoundingClientRect(),e))}function Mie(n,e,t){const r=p9(n,t),{scroll:i}=e;return i&&(Vf(r.x,i.offset.x),Vf(r.y,i.offset.y)),r}const y9=({current:n})=>n?n.ownerDocument.defaultView:null,Nie=new WeakMap;class Lie{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=jr(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(S1(h).point)},s=(h,f)=>{const{drag:g,dragPropagation:y,onDragStart:v}=this.getProps();if(g&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Ine(g),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xa(E=>{let T=this.getAxisMotionValue(E).get()||0;if(Ho.test(T)){const{projection:b}=this.visualElement;if(b&&b.layout){const I=b.layout.layoutBox[E];I&&(T=sa(I)*(parseFloat(T)/100))}}this.originPoint[E]=T}),v&&ur.postRender(()=>v(h,f)),gb(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:g,dragDirectionLock:y,onDirectionLock:v,onDrag:x}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:E}=f;if(y&&this.currentDirection===null){this.currentDirection=Oie(E),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,E),this.updateAxis("y",f.point,E),this.visualElement.render(),x&&x(h,f)},o=(h,f)=>this.stop(h,f),l=()=>xa(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new c9(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:y9(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&ur.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!c_(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=Sie(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Df(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Tie(i.layoutBox,t):this.constraints=!1,this.elastic=Rie(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&xa(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Aie(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Df(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=Mie(r,i.root,this.visualElement.getTransformPagePoint());let a=bie(i.layout.layoutBox,s);if(t){const o=t(Cie(a));this.hasMutatedConstraints=!!o,o&&(a=f9(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=xa(h=>{if(!c_(h,t,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const g=i?200:1e6,y=i?40:1e7,v={type:"inertia",velocity:r?e[h]:0,bounceStiffness:g,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,v)});return Promise.all(u).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return gb(this.visualElement,e),r.start(TR(e,r,0,t,this.visualElement,!1))}stopAnimation(){xa(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){xa(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){xa(t=>{const{drag:r}=this.getProps();if(!c_(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Ir(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Df(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};xa(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=Iie({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),xa(a=>{if(!c_(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(Ir(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;Nie.set(this.visualElement,this);const e=this.visualElement.current,t=Cm(e,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Df(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),ur.read(r);const a=Ap(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(xa(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=Eb,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function c_(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Oie(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Die extends Ru{constructor(e){super(e),this.removeGroupControls=ea,this.removeListeners=ea,this.controls=new Lie(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ea}unmount(){this.removeGroupControls(),this.removeListeners()}}const X3=n=>(e,t)=>{n&&ur.postRender(()=>n(e,t))};class Fie extends Ru{constructor(){super(...arguments),this.removePointerDownListener=ea}onPointerDown(e){this.session=new c9(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:y9(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:X3(e),onStart:X3(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&ur.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Cm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const H_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function q3(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Xg={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Gt.test(n))n=parseFloat(n);else return n;const t=q3(n,e.target.x),r=q3(n,e.target.y);return`${t}% ${r}%`}},jie={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=yu.parse(n);if(i.length>5)return r;const s=yu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const u=Ir(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),s(i)}};class Vie extends ee.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;sne(Gie),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),H_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||ur.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),JA.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function _9(n){const[e,t]=ej(),r=ee.useContext(WA);return m.jsx(Vie,{...n,layoutGroup:r,switchLayoutGroup:ee.useContext(lj),isPresent:e,safeToRemove:t})}const Gie={borderRadius:{...Xg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Xg,borderTopRightRadius:Xg,borderBottomLeftRadius:Xg,borderBottomRightRadius:Xg,boxShadow:jie};function Bie(n,e,t){const r=qi(n)?n:bp(n);return r.start(TR("",r,e,t)),r.animation}function Uie(n){return n instanceof SVGElement&&n.tagName!=="svg"}const zie=(n,e)=>n.depth-e.depth;class $ie{constructor(){this.children=[],this.isDirty=!1}add(e){fR(this.children,e),this.isDirty=!0}remove(e){gR(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(zie),this.isDirty=!1,this.children.forEach(e)}}function Wie(n,e){const t=Ko.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(pu(r),n(s-e))};return ur.read(r,!0),()=>pu(r)}const x9=["TopLeft","TopRight","BottomLeft","BottomRight"],Hie=x9.length,Z3=n=>typeof n=="string"?parseFloat(n):n,Q3=n=>typeof n=="number"||Gt.test(n);function Kie(n,e,t,r,i,s){i?(n.opacity=Ir(0,t.opacity!==void 0?t.opacity:1,Yie(r)),n.opacityExit=Ir(e.opacity!==void 0?e.opacity:1,0,Xie(r))):s&&(n.opacity=Ir(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Hie;a++){const o=`border${x9[a]}Radius`;let l=J3(e,o),u=J3(t,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||Q3(l)===Q3(u)?(n[o]=Math.max(Ir(Z3(l),Z3(u),r),0),(Ho.test(u)||Ho.test(l))&&(n[o]+="%")):n[o]=u}(e.rotate||t.rotate)&&(n.rotate=Ir(e.rotate||0,t.rotate||0,r))}function J3(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Yie=v9(0,.5,jj),Xie=v9(.5,.95,ea);function v9(n,e,t){return r=>r<n?0:r>e?1:t(P0(n,e,r))}function eL(n,e){n.min=e.min,n.max=e.max}function ya(n,e){eL(n.x,e.x),eL(n.y,e.y)}function tL(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function nL(n,e,t,r,i){return n-=e,n=ev(n,1/t,r),i!==void 0&&(n=ev(n,1/i,r)),n}function qie(n,e=0,t=1,r=.5,i,s=n,a=n){if(Ho.test(e)&&(e=parseFloat(e),e=Ir(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Ir(s.min,s.max,r);n===s&&(o-=e),n.min=nL(n.min,e,t,o,i),n.max=nL(n.max,e,t,o,i)}function rL(n,e,[t,r,i],s,a){qie(n,e[t],e[r],e[i],e.scale,s,a)}const Zie=["x","scaleX","originX"],Qie=["y","scaleY","originY"];function iL(n,e,t,r){rL(n.x,e,Zie,t?t.x:void 0,r?r.x:void 0),rL(n.y,e,Qie,t?t.y:void 0,r?r.y:void 0)}function sL(n){return n.translate===0&&n.scale===1}function w9(n){return sL(n.x)&&sL(n.y)}function aL(n,e){return n.min===e.min&&n.max===e.max}function Jie(n,e){return aL(n.x,e.x)&&aL(n.y,e.y)}function oL(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function E9(n,e){return oL(n.x,e.x)&&oL(n.y,e.y)}function lL(n){return sa(n.x)/sa(n.y)}function cL(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class ese{constructor(){this.members=[]}add(e){fR(this.members,e),e.scheduleRender()}remove(e){if(gR(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function tse(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:g,skewX:y,skewY:v}=t;u&&(r=`perspective(${u}px) ${r}`),h&&(r+=`rotate(${h}deg) `),f&&(r+=`rotateX(${f}deg) `),g&&(r+=`rotateY(${g}deg) `),y&&(r+=`skewX(${y}deg) `),v&&(r+=`skewY(${v}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const hh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},hm=typeof window<"u"&&window.MotionDebug!==void 0,NS=["","X","Y","Z"],nse={visibility:"hidden"},uL=1e3;let rse=0;function LS(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function S9(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=Pj(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",ur,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&S9(r)}function T9({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=rse++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,hm&&(hh.totalNodes=hh.resolvedTargetDeltas=hh.recalculatedProjection=0),this.nodes.forEach(ase),this.nodes.forEach(hse),this.nodes.forEach(dse),this.nodes.forEach(ose),hm&&window.MotionDebug.record(hh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new $ie)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new mR),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Uie(a),this.instance=a;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||l)&&(this.isLayoutDirty=!0),n){let f;const g=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Wie(g,250),H_.hasAnimatedSinceResize&&(H_.hasAnimatedSinceResize=!1,this.nodes.forEach(dL))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:g,hasRelativeTargetChanged:y,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||yse,{onLayoutAnimationStart:E,onLayoutAnimationComplete:T}=h.getProps(),b=!this.targetLayout||!E9(this.targetLayout,v)||y,I=!g&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||I||g&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,I);const M={...cR(x,"layout"),onPlay:E,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else g||dL(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,pu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(fse),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&S9(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hL);return}this.isUpdating||this.nodes.forEach(cse),this.isUpdating=!1,this.nodes.forEach(use),this.nodes.forEach(ise),this.nodes.forEach(sse),this.clearAllSnapshots();const o=Ko.now();Ai.delta=Hl(0,1e3/60,o-Ai.timestamp),Ai.timestamp=o,Ai.isProcessing=!0,TS.update.process(Ai),TS.preRender.process(Ai),TS.render.process(Ai),Ai.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,JA.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(lse),this.sharedNodes.forEach(gse)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ur.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ur.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=jr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!w9(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;a&&(o||uh(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),_se(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return jr();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(xse))){const{scroll:h}=this.root;h&&(Vf(l.x,h.offset.x),Vf(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=jr();if(ya(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:g}=h;h!==this.root&&f&&g.layoutScroll&&(f.wasRoot&&ya(l,a),Vf(l.x,f.offset.x),Vf(l.y,f.offset.y))}return l}applyTransform(a,o=!1){const l=jr();ya(l,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Gf(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),uh(h.latestValues)&&Gf(l,h.latestValues)}return uh(this.latestValues)&&Gf(l,this.latestValues),l}removeTransform(a){const o=jr();ya(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!uh(u.latestValues))continue;Sb(u.latestValues)&&u.updateSnapshot();const h=jr(),f=u.measurePageBox();ya(h,f),iL(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return uh(this.latestValues)&&iL(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ai.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:g}=this.options;if(!(!this.layout||!(f||g))){if(this.resolvedRelativeTargetAt=Ai.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=jr(),this.relativeTargetOrigin=jr(),Pm(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),ya(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=jr(),this.targetWithTransforms=jr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Eie(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ya(this.target,this.layout.layoutBox),m9(this.target,this.targetDelta)):ya(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=jr(),this.relativeTargetOrigin=jr(),Pm(this.relativeTargetOrigin,this.target,y.target),ya(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}hm&&hh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Sb(this.parent.latestValues)||g9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ai.timestamp&&(u=!1),u)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;ya(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,y=this.treeScale.y;Pie(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=jr());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(tL(this.prevProjectionDelta.x,this.projectionDelta.x),tL(this.prevProjectionDelta.y,this.projectionDelta.y)),km(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==y||!cL(this.projectionDelta.x,this.prevProjectionDelta.x)||!cL(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),hm&&hh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=jf(),this.projectionDelta=jf(),this.projectionDeltaWithTransform=jf()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},f=jf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=jr(),y=l?l.source:void 0,v=this.layout?this.layout.source:void 0,x=y!==v,E=this.getStack(),T=!E||E.members.length<=1,b=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(pse));this.animationProgress=0;let I;this.mixTargetDelta=M=>{const F=M/1e3;fL(f.x,a.x,F),fL(f.y,a.y,F),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Pm(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mse(this.relativeTarget,this.relativeTargetOrigin,g,F),I&&Jie(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=jr()),ya(I,this.relativeTarget)),x&&(this.animationValues=h,Kie(h,u,this.latestValues,F,b,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(pu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ur.update(()=>{H_.hasAnimatedSinceResize=!0,this.currentAnimation=Bie(0,uL,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(uL),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:h}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&b9(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||jr();const f=sa(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const g=sa(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+g}ya(o,l),Gf(o,h),km(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new ese),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&LS("z",a,u,this.animationValues);for(let h=0;h<NS.length;h++)LS(`rotate${NS[h]}`,a,u,this.animationValues),LS(`skew${NS[h]}`,a,u,this.animationValues);a.render();for(const h in u)a.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return nse;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=$_(a?.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=$_(a?.pointerEvents)||""),this.hasProjected&&!uh(this.latestValues)&&(x.transform=h?h({},""):"none",this.hasProjected=!1),x}const g=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=tse(this.projectionDeltaWithTransform,this.treeScale,g),h&&(u.transform=h(g,u.transform));const{x:y,y:v}=this.projectionDelta;u.transformOrigin=`${y.origin*100}% ${v.origin*100}% 0`,f.animationValues?u.opacity=f===this?(l=(o=g.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:u.opacity=f===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const x in Xx){if(g[x]===void 0)continue;const{correct:E,applyTo:T}=Xx[x],b=u.transform==="none"?g[x]:E(g[x],f);if(T){const I=T.length;for(let M=0;M<I;M++)u[T[M]]=b}else u[x]=b}return this.options.layoutId&&(u.pointerEvents=f===this?$_(a?.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(hL),this.root.sharedNodes.clear()}}}function ise(n){n.updateLayout()}function sse(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?xa(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],y=sa(g);g.min=r[f].min,g.max=g.min+y}):b9(s,t.layoutBox,r)&&xa(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],y=sa(r[f]);g.max=g.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+y)});const o=jf();km(o,r,t.layoutBox);const l=jf();a?km(l,n.applyTransform(i,!0),t.measuredBox):km(l,r,t.layoutBox);const u=!w9(o);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:g,layout:y}=f;if(g&&y){const v=jr();Pm(v,t.layoutBox,g.layoutBox);const x=jr();Pm(x,r,y.layoutBox),E9(v,x)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=v,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function ase(n){hm&&hh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function ose(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function lse(n){n.clearSnapshot()}function hL(n){n.clearMeasurements()}function cse(n){n.isLayoutDirty=!1}function use(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function dL(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function hse(n){n.resolveTargetDelta()}function dse(n){n.calcProjection()}function fse(n){n.resetSkewAndRotation()}function gse(n){n.removeLeadSnapshot()}function fL(n,e,t){n.translate=Ir(e.translate,0,t),n.scale=Ir(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function gL(n,e,t,r){n.min=Ir(e.min,t.min,r),n.max=Ir(e.max,t.max,r)}function mse(n,e,t,r){gL(n.x,e.x,t.x,r),gL(n.y,e.y,t.y,r)}function pse(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const yse={duration:.45,ease:[.4,0,.1,1]},mL=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),pL=mL("applewebkit/")&&!mL("chrome/")?Math.round:ea;function yL(n){n.min=pL(n.min),n.max=pL(n.max)}function _se(n){yL(n.x),yL(n.y)}function b9(n,e,t){return n==="position"||n==="preserve-aspect"&&!wie(lL(e),lL(t),.2)}function xse(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const vse=T9({attachResizeListener:(n,e)=>Ap(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),OS={current:void 0},I9=T9({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!OS.current){const n=new vse({});n.mount(window),n.setOptions({layoutScroll:!0}),OS.current=n}return OS.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),wse={pan:{Feature:Fie},drag:{Feature:Die,ProjectionNode:I9,MeasureLayout:_9}};function _L(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&ur.postRender(()=>s(e,S1(e)))}class Ese extends Ru{mount(){const{current:e}=this.node;e&&(this.unmount=wne(e,t=>(_L(this.node,t,"Start"),r=>_L(this.node,r,"End"))))}unmount(){}}class Sse extends Ru{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=E1(Ap(this.node.current,"focus",()=>this.onFocus()),Ap(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function xL(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&ur.postRender(()=>s(e,S1(e)))}class Tse extends Ru{mount(){const{current:e}=this.node;e&&(this.unmount=bne(e,t=>(xL(this.node,t,"Start"),(r,{success:i})=>xL(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const bb=new WeakMap,DS=new WeakMap,bse=n=>{const e=bb.get(n.target);e&&e(n)},Ise=n=>{n.forEach(bse)};function Ase({root:n,...e}){const t=n||document;DS.has(t)||DS.set(t,{});const r=DS.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Ise,{root:n,...e})),r[i]}function Rse(n,e,t){const r=Ase(e);return bb.set(n,t),r.observe(n),()=>{bb.delete(n),r.unobserve(n)}}const Cse={some:0,all:1};class kse extends Ru{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Cse[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),g=u?h:f;g&&g(l)};return Rse(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Pse(e,t))&&this.startObserver()}unmount(){}}function Pse({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const Mse={inView:{Feature:kse},tap:{Feature:Tse},focus:{Feature:Sse},hover:{Feature:Ese}},Nse={layout:{ProjectionNode:I9,MeasureLayout:_9}},Ib={current:null},A9={current:!1};function Lse(){if(A9.current=!0,!!YA)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ib.current=n.matches;n.addListener(e),e()}else Ib.current=!1}const Ose=[...Qj,Wi,yu],Dse=n=>Ose.find(Zj(n)),vL=new WeakMap;function Fse(n,e,t){for(const r in e){const i=e[r],s=t[r];if(qi(i))n.addValue(r,i);else if(qi(s))n.addValue(r,bp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,bp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const wL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class jse{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=wR,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=Ko.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,ur.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=jw(t),this.isVariantNode=aj(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...g}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in g){const v=g[y];l[y]!==void 0&&qi(v)&&v.set(l[y],!1)}}mount(e){this.current=e,vL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),A9.current||Lse(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ib.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){vL.delete(this.current),this.projection&&this.projection.unmount(),pu(this.notifyUpdate),pu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=wd.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&ur.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in M0){const t=M0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):jr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<wL.length;r++){const i=wL[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=Fse(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=bp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(Xj(i)||Gj(i))?i=parseFloat(i):!Dse(i)&&yu.test(t)&&(i=Hj(e,t)),this.setBaseTarget(e,qi(i)?i.get():i)),qi(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=tR(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!qi(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new mR),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class R9 extends jse{constructor(){super(...arguments),this.KeyframeResolver=Jj}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;qi(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Vse(n){return window.getComputedStyle(n)}class Gse extends R9{constructor(){super(...arguments),this.type="html",this.renderInstance=mj}readValueFromInstance(e,t){if(wd.has(t)){const r=vR(t);return r&&r.default||0}else{const r=Vse(e),i=(dj(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return p9(e,t)}build(e,t,r){iR(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return lR(e,t,r)}}class Bse extends R9{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=jr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(wd.has(t)){const r=vR(t);return r&&r.default||0}return t=pj.has(t)?t:QA(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return xj(e,t,r)}build(e,t,r){sR(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){yj(e,t,r,i)}mount(e){this.isSVGTag=oR(e.tagName),super.mount(e)}}const Use=(n,e)=>eR(n)?new Bse(e):new Gse(e,{allowProjection:n!==ee.Fragment}),zse=gne({...die,...Mse,...wse,...Nse},Use),At=Cte(zse);const $se=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Wse=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),EL=n=>{const e=Wse(n);return e.charAt(0).toUpperCase()+e.slice(1)},C9=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Hse=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Kse={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Yse=ee.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>ee.createElement("svg",{ref:l,...Kse,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:C9("lucide",i),...!s&&!Hse(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,h])=>ee.createElement(u,h)),...Array.isArray(s)?s:[s]]));const dt=(n,e)=>{const t=ee.forwardRef(({className:r,...i},s)=>ee.createElement(Yse,{ref:s,iconNode:e,className:C9(`lucide-${$se(EL(n))}`,`lucide-${n}`,r),...i}));return t.displayName=EL(n),t};const Xse=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],qse=dt("archive-restore",Xse);const Zse=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],k9=dt("archive",Zse);const Qse=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Jse=dt("ban",Qse);const eae=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],tae=dt("book-open",eae);const nae=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],P9=dt("bug",nae);const rae=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],M9=dt("calendar",rae);const iae=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],bR=dt("camera",iae);const sae=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],N9=dt("chart-column",sae);const aae=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Kl=dt("check",aae);const oae=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],IR=dt("chevron-down",oae);const lae=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],cae=dt("chevron-left",lae);const uae=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Bw=dt("chevron-right",uae);const hae=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],L9=dt("chevron-up",hae);const dae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],O9=dt("circle-alert",dae);const fae=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gae=dt("circle-check-big",fae);const mae=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ab=dt("clock",mae);const pae=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],yae=dt("cloud-off",pae);const _ae=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],Rb=dt("cloud",_ae);const xae=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],vae=dt("code",xae);const wae=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Eae=dt("compass",wae);const Sae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],Cb=dt("crosshair",Sae);const Tae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],tv=dt("download",Tae);const bae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],T1=dt("external-link",bae);const Iae=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],nv=dt("eye-off",Iae);const Aae=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],rv=dt("eye",Aae);const Rae=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],D9=dt("file-text",Rae);const Cae=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],kae=dt("folder-open",Cae);const Pae=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Mae=dt("folder-plus",Pae);const Nae=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Lae=dt("folder",Nae);const Oae=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Dae=dt("gauge",Oae);const Fae=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],jae=dt("gem",Fae);const Vae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Gae=dt("grid-3x3",Vae);const Bae=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Uae=dt("image-plus",Bae);const zae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],F9=dt("info",zae);const $ae=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],so=dt("layers",$ae);const Wae=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],j9=dt("list",Wae);const Hae=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],AR=dt("loader-circle",Hae);const Kae=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Yae=dt("locate-fixed",Kae);const Xae=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],kb=dt("lock",Xae);const qae=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],RR=dt("log-out",qae);const Zae=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],el=dt("map-pin",Zae);const Qae=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],CR=dt("map",Qae);const Jae=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],eoe=dt("menu",Jae);const toe=[["path",{d:"M5 12h14",key:"1ays0h"}]],noe=dt("minus",toe);const roe=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],Pb=dt("mountain",roe);const ioe=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],soe=dt("mouse-pointer",ioe);const aoe=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],kR=dt("navigation",aoe);const ooe=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],loe=dt("pause",ooe);const coe=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],SL=dt("pen-line",coe);const uoe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],hoe=dt("pen",uoe);const doe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],L0=dt("pencil",doe);const foe=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],goe=dt("play",foe);const moe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],co=dt("plus",moe);const poe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yoe=dt("rotate-ccw",poe);const _oe=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],xoe=dt("rotate-cw",_oe);const voe=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],iv=dt("route",voe);const woe=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],sv=dt("ruler",woe);const Eoe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],V9=dt("save",Eoe);const Soe=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Toe=dt("scale",Soe);const boe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Mb=dt("search",boe);const Ioe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Nb=dt("settings",Ioe);const Aoe=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Roe=dt("settings-2",Aoe);const Coe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],koe=dt("shield",Coe);const Poe=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Moe=dt("sliders-horizontal",Poe);const Noe=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],Loe=dt("sliders-vertical",Noe);const Ooe=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Doe=dt("smartphone",Ooe);const Foe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],joe=dt("square",Foe);const Voe=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Goe=dt("tag",Voe);const Boe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Uoe=dt("target",Boe);const zoe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Cu=dt("trash-2",zoe);const $oe=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],Woe=dt("tree-palm",$oe);const Hoe=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Koe=dt("type",Hoe);const Yoe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Uw=dt("upload",Yoe);const Xoe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],PR=dt("user",Xoe);const qoe=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Zoe=dt("waves",qoe);const Qoe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],vi=dt("x",Qoe);function Joe(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=os(),a=ee.useCallback(l=>{r(l)},[r]),o=ee.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return ee.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function ele(){const{tracking:n,toggle:e}=Joe();return m.jsx(At.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:m.jsx(Yae,{size:22,strokeWidth:2})})}const tle="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function nle(){const n=Di(y=>y.map),e=os(y=>y.position),t=os(y=>y.accuracy),r=os(y=>y.tracking),i=os(y=>y.smoothHeading),s=Lr(y=>y.showAccuracyCircle),a=os(y=>y.firstFix),o=os(y=>y.resetFirstFix),l=os(y=>y.config.centerOnUser),u=ee.useRef(null),h=ee.useRef(null),f=ee.useRef(null),g=ee.useMemo(()=>y=>new En({image:new Zp({src:tle,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return ee.useEffect(()=>{if(!n||!r&&!e)return;const y=ka([5.1214,52.0907]);return u.current=new mi({geometry:new _i(y)}),u.current.setStyle(g(0)),h.current=new mi({geometry:new _i(y)}),f.current=new md({source:new fd({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,r,e,g]),ee.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=ka([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const v=n.getView().getResolution()||1,x=Math.min(t/v,80);h.current.setStyle(new En({image:new Ps({radius:x,fill:new er({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new En({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),ee.useEffect(()=>{if(!u.current)return;const y=i!==null?i*Math.PI/180:0;u.current.setStyle(g(y))},[i,g]),null}function rle(){const n=yr(t=>t.themesPanelOpen),e=yr(t=>t.toggleThemesPanel);return m.jsx(At.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:m.jsx(CR,{size:22,strokeWidth:2})})}function ile(){return m.jsx(rle,{})}const u_=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],jc=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],Ya="default-vondsten",G9={id:Ya,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},sle=n=>n.some(t=>t.id===Ya)?n:[{...G9,createdAt:new Date().toISOString()},...n],Qi=oa()(vd((n,e)=>({layers:[{...G9}],colorIndex:0,addLayer:(t,r=jc)=>{const i=crypto.randomUUID(),s=u_[e().colorIndex%u_.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(u=>u.id===i?{...u,...s}:u)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||jc,o=i.color||u_[e().colorIndex%u_.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),u=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:u,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:u}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===Ya?{...r,points:[]}:r).filter(r=>r.id===Ya),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:sle(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===Ya?{...r,name:"Mijn vondsten"}:r)}:t}}));function Jr({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=ee.useState(t),a=fi(E=>E.visible),o=fi(E=>E.setLayerVisibility),l=$A(E=>E.isLayerUnlocked),u=E=>{const T=nw[E],b=T?.tier??"free",I=T?.regions??["nl"];return l(E,b,I)},h=r?.filter(E=>u(E))||[],f=h.filter(E=>a[E]).length,g=h.length,y=g>0&&f===g,v=f>0&&f<g,x=E=>{if(E.stopPropagation(),!r||h.length===0)return;const T=!y;h.forEach(b=>{o(b,T)})};return m.jsxs("div",{className:"mb-0.5",children:[m.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[m.jsxs("button",{onClick:E=>{E.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[m.jsx(At.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:m.jsx(Bw,{size:14})}),i?m.jsx(kae,{size:16,className:"text-blue-500"}):m.jsx(Lae,{size:16,className:"text-blue-500"}),m.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),f>0&&m.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:f})]}),r&&r.length>0&&m.jsx("button",{onClick:x,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":v?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||v)&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),m.jsx(ir,{initial:!1,children:i&&m.jsx(At.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function lt({name:n,type:e,hasOverlay:t}){const r=fi(I=>I.visible[n]),i=fi(I=>I.visible["Labels Overlay"]),s=fi(I=>I.loadingState[n]),a=fi(I=>I.toggleLayer),o=fi(I=>I.setLayerVisibility),l=$A(I=>I.isLayerUnlocked),u=s==="loading",h=s==="error",f=nw[n],g=f?.tier??"free",y=f?.regions??["nl"],x=!l(n,g,y),E=I=>{I.stopPropagation(),!(u||x)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(F=>{o(F,F===n)}))},T=I=>{I.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsxs("button",{onClick:E,disabled:u||x,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${x?"opacity-50 cursor-not-allowed bg-gray-50":u?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:x?"Premium laag - upgrade om te ontgrendelen":void 0,children:[m.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":x?"text-gray-400":"text-gray-600"}`,children:[n,h&&m.jsx(O9,{size:12,className:"text-red-500"}),x&&m.jsx(kb,{size:12,className:"text-amber-500"})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:x?"#e5e7eb":u?"#93c5fd":b?"#3b82f6":"white",border:x?"2px solid #d1d5db":u?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:x?m.jsx(kb,{size:10,strokeWidth:3,className:"text-gray-400"}):u?m.jsx(AR,{size:10,strokeWidth:3,className:"animate-spin"}):b?m.jsx(Kl,{size:12,strokeWidth:3}):null})]}),t&&b&&m.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:m.jsx(Goe,{size:12})})]})}const ale=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function B9({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=x1(),[a,o]=ee.useState(!1),[l,u]=ee.useState(!1),[h,f]=ee.useState(n.name),[g,y]=ee.useState(!1),v=ee.useRef(null),x=ee.useRef(null),E=n.features.features.length,T=[...new Set(n.features.features.map(R=>R.geometry?.type).filter(Boolean))];ee.useEffect(()=>{l&&v.current&&(v.current.focus(),v.current.select())},[l]),ee.useEffect(()=>{const R=C=>{x.current&&!x.current.contains(C.target)&&y(!1)};if(g)return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[g]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},I=()=>{const R=h.trim();R&&R!==n.name&&i(n.id,{name:R}),u(!1)},M=()=>{f(n.name),u(!1)},F=R=>{R.key==="Enter"?I():R.key==="Escape"&&M()},G=R=>{s(n.id,R),y(!1)};return e?m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[m.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),m.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:E})]}):m.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[m.jsxs("div",{className:"relative",ref:x,children:[m.jsx("button",{onClick:()=>y(!g),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),g&&m.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:ale.map(R=>m.jsx("button",{onClick:()=>G(R),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${R===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:R},title:R},R))})]}),m.jsx("div",{className:"flex-1 min-w-0",children:l?m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("input",{ref:v,type:"text",value:h,onChange:R=>f(R.target.value),onKeyDown:F,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),m.jsx("button",{onClick:I,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:m.jsx(Kl,{size:14})}),m.jsx("button",{onClick:M,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:m.jsx(vi,{size:14})})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),m.jsx("button",{onClick:()=>u(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:m.jsx(L0,{size:12})})]}),m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[m.jsxs("span",{children:[E," ",E===1?"feature":"features"]}),T.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"mx-0.5",children:""}),m.jsx("span",{children:T.join(", ")})]})]})]})})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(Cu,{size:14})})]})]})}function ole(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=yr(),{layers:r,toggleVisibility:i}=Qi(),s=x1(h=>h.layers),a=ee.useRef(null),o=Lr(h=>h.layerPanelFontScale),l=Lr(h=>h.setLayerPanelFontScale),u=13*o/100;return ee.useEffect(()=>{if(!n)return;const h=g=>{a.current&&!a.current.contains(g.target)&&e()},f=setTimeout(()=>{document.addEventListener("click",h)},100);return()=>{clearTimeout(f),document.removeEventListener("click",h)}},[n,e]),m.jsx(ir,{children:n&&m.jsxs(At.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${u}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(so,{size:14,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:h=>{l(parseInt(h.target.value))},onChange:h=>l(parseInt(h.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"}),m.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:m.jsx(vi,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),m.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${u}px`},children:[r.filter(h=>!h.archived).length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:m.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(h=>!h.archived).map(h=>m.jsxs("button",{onClick:f=>{f.stopPropagation(),i(h.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${h.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[m.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[h.name,m.jsxs("span",{className:"text-xs text-gray-400",children:["(",h.points.length,")"]})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:h.visible?"#f97316":"white",border:h.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:h.visible&&m.jsx(Kl,{size:12,strokeWidth:3})})]},h.id))]}),s.length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[m.jsx(Uw,{size:12,className:"text-cyan-600"}),m.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(h=>m.jsx(B9,{layer:h,compact:!0},h.id)),m.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),m.jsxs("div",{className:"space-y-0",children:[m.jsx(lt,{name:"CartoDB (licht)",type:"base"}),m.jsx(lt,{name:"OpenStreetMap",type:"base"}),m.jsx(lt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),m.jsx(lt,{name:"TMK 1850",type:"base",hasOverlay:!0}),m.jsx(lt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),m.jsxs(Jr,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[m.jsx(lt,{name:"Hunebedden",type:"overlay"}),m.jsx(lt,{name:"FAMKE Steentijd",type:"overlay"}),m.jsx(lt,{name:"Grafheuvels",type:"overlay"}),m.jsx(lt,{name:"Terpen",type:"overlay"}),m.jsxs(Jr,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[m.jsx(lt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]})]}),m.jsxs(Jr,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","IKAW","Archeo Landschappen","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[m.jsx(lt,{name:"AMK Monumenten",type:"overlay"}),m.jsxs(Jr,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[m.jsx(lt,{name:"AMK Romeins",type:"overlay"}),m.jsx(lt,{name:"AMK Steentijd",type:"overlay"}),m.jsx(lt,{name:"AMK Vroege ME",type:"overlay"}),m.jsx(lt,{name:"AMK Late ME",type:"overlay"}),m.jsx(lt,{name:"AMK Overig",type:"overlay"})]}),m.jsx(lt,{name:"Archeo Onderzoeken",type:"overlay"}),m.jsxs(Jr,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsxs(Jr,{title:"Romeinse wegen",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)"],children:[m.jsx(lt,{name:"Romeinse wegen (regio)",type:"overlay"}),m.jsx(lt,{name:"Romeinse wegen (Wereld)",type:"overlay"})]}),m.jsxs(Jr,{title:"Romeinse forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(lt,{name:"Romeinse Forten",type:"overlay"}),m.jsx(lt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),m.jsx(lt,{name:"IKAW",type:"overlay"}),m.jsx(lt,{name:"Archeo Landschappen",type:"overlay"}),m.jsxs(Jr,{title:"Verwachtingen uiterwaarden",defaultExpanded:!1,layerNames:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[m.jsx(lt,{name:"UIKAV Punten",type:"overlay"}),m.jsx(lt,{name:"UIKAV Vlakken",type:"overlay"}),m.jsx(lt,{name:"UIKAV Expert",type:"overlay"}),m.jsx(lt,{name:"UIKAV Buffer",type:"overlay"}),m.jsx(lt,{name:"UIKAV Indeling",type:"overlay"})]})]}),m.jsxs(Jr,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[m.jsx(lt,{name:"Rijksmonumenten",type:"overlay"}),m.jsx(lt,{name:"Werelderfgoed",type:"overlay"}),m.jsx(lt,{name:"Religieus Erfgoed",type:"overlay"}),m.jsx(lt,{name:"Kastelen",type:"overlay"}),m.jsx(lt,{name:"Runes",type:"overlay"})]}),m.jsxs(Jr,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[m.jsx(lt,{name:"WWII Bunkers",type:"overlay"}),m.jsx(lt,{name:"Slagvelden",type:"overlay"}),m.jsx(lt,{name:"Militaire Vliegvelden",type:"overlay"}),m.jsx(lt,{name:"Verdedigingslinies",type:"overlay"}),m.jsx(lt,{name:"Militaire Objecten",type:"overlay"}),m.jsx(lt,{name:"Inundatiegebieden",type:"overlay"})]}),m.jsxs(Jr,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[m.jsx(lt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),m.jsx(lt,{name:"AHN4 Hillshade NL",type:"overlay"}),m.jsx(lt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),m.jsx(lt,{name:"AHN 0.5m",type:"overlay"})]}),m.jsxs(Jr,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[m.jsx(lt,{name:"Veengebieden",type:"overlay"}),m.jsx(lt,{name:"Geomorfologie",type:"overlay"}),m.jsx(lt,{name:"Bodemkaart",type:"overlay"}),m.jsx(lt,{name:"Essen",type:"overlay"})]}),m.jsxs(Jr,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[m.jsx(lt,{name:"Gewaspercelen",type:"overlay"}),m.jsx(lt,{name:"Kadastrale Grenzen",type:"overlay"})]}),m.jsxs(Jr,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[m.jsxs(Jr,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[m.jsx(lt,{name:"Scheepswrakken",type:"overlay"}),m.jsx(lt,{name:"Woonheuvels ZH",type:"overlay"}),m.jsx(lt,{name:"Windmolens",type:"overlay"}),m.jsx(lt,{name:"Erfgoedlijnen",type:"overlay"}),m.jsx(lt,{name:"Oude Kernen",type:"overlay"})]}),m.jsxs(Jr,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[m.jsx(lt,{name:"Relictenkaart Punten",type:"overlay"}),m.jsx(lt,{name:"Relictenkaart Lijnen",type:"overlay"}),m.jsx(lt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),m.jsx(Jr,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:m.jsx(lt,{name:"Verdronken Dorpen",type:"overlay"})})]}),m.jsxs(Jr,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[m.jsx(lt,{name:"Fossiel Hotspots",type:"overlay"}),m.jsx(lt,{name:"Mineralen Hotspots",type:"overlay"}),m.jsx(lt,{name:"Goudrivieren",type:"overlay"}),m.jsx(lt,{name:"Fossielen Nederland",type:"overlay"}),m.jsx(lt,{name:"Fossielen Belgi",type:"overlay"}),m.jsx(lt,{name:"Fossielen Duitsland",type:"overlay"}),m.jsx(lt,{name:"Fossielen Frankrijk",type:"overlay"})]}),m.jsxs(Jr,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[m.jsx(lt,{name:"Wandelroutes",type:"overlay"}),m.jsx(lt,{name:"Parken",type:"overlay"}),m.jsx(lt,{name:"Speeltuinen",type:"overlay"}),m.jsx(lt,{name:"Musea",type:"overlay"}),m.jsx(lt,{name:"Strandjes",type:"overlay"}),m.jsx(lt,{name:"Kringloopwinkels",type:"overlay"})]})]})]})]})})}function lle(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var rd=1,id=2,n0=3,cle=4,Lb=5,TL=6378137,ule=6356752314e-3,bL=.0066943799901413165,Mm=484813681109536e-20,We=Math.PI/2,hle=.16666666666666666,dle=.04722222222222222,fle=.022156084656084655,st=1e-10,Cr=.017453292519943295,Cs=57.29577951308232,On=Math.PI/4,Rp=Math.PI*2,Vr=3.14159265359,Os={};Os.greenwich=0;Os.lisbon=-9.131906111111;Os.paris=2.337229166667;Os.bogota=-74.080916666667;Os.madrid=-3.687938888889;Os.rome=12.452333333333;Os.bern=7.439583333333;Os.jakarta=106.807719444444;Os.ferro=-17.666666666667;Os.brussels=4.367975;Os.stockholm=18.058277777778;Os.athens=23.7163375;Os.oslo=10.722916666667;const gle={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var IL=/[\s_\-\/\(\)]/g;function _u(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(IL,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(IL,""),a===r)return n[s]}function Ob(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var u=l.split("=");return u.push(!0),o[u[0].toLowerCase()]=u[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Cr},lat_1:function(o){e.lat1=o*Cr},lat_2:function(o){e.lat2=o*Cr},lat_ts:function(o){e.lat_ts=o*Cr},lon_0:function(o){e.long0=o*Cr},lon_1:function(o){e.long1=o*Cr},lon_2:function(o){e.long2=o*Cr},alpha:function(o){e.alpha=parseFloat(o)*Cr},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Cr},lonc:function(o){e.longc=o*Cr},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=_u(gle,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Cr},pm:function(o){var l=_u(Os,o);e.from_greenwich=(l||parseFloat(o))*Cr},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class U9{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const u=i[1].toUpperCase();if(u==="E")r="east";else if(u==="N")r="north";else if(u==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${u}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(u=>Array.isArray(u)&&u[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(u=>Array.isArray(u)&&(u[0]==="LENGTHUNIT"||u[0]==="ANGLEUNIT"||u[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")):null,t.conversion=e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")):null;const r=e.find(g=>Array.isArray(g)&&g[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT");if(i){const g=this.convertUnit(i);t.coordinate_system.unit=g}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(g=>Array.isArray(g)&&(g[0]==="DATUM"||g[0]==="ENSEMBLE"));if(s){const g=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=g:t.datum=g;const y=e.find(v=>Array.isArray(v)&&v[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(g.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(g=>Array.isArray(g)&&g[0]==="MEMBER").map(g=>({type:"DatumEnsembleMember",name:g[1],id:this.getId(g)}));const a=e.find(g=>Array.isArray(g)&&g[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT")&&this.convert(e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&g[0]==="PARAMETER").map(g=>this.convert(g));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(g=>Array.isArray(g)&&(g[0]==="LENGTHUNIT"||g[0]==="ANGLEUNIT"||g[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(g=>Array.isArray(g)&&g[0]==="SOURCECRS");if(l){const g=l.find(y=>Array.isArray(y));t.source_crs=g?this.convert(g):null}const u=e.find(g=>Array.isArray(g)&&g[0]==="TARGETCRS");if(u){const g=u.find(y=>Array.isArray(y));t.target_crs=g?this.convert(g):null}const h=e.find(g=>Array.isArray(g)&&g[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&(g[0]==="PARAMETER"||g[0]==="PARAMETERFILE")).map(g=>{if(g[0]==="PARAMETER")return this.convert(g);if(g[0]==="PARAMETERFILE")return{name:g[1],value:g[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const g=t.parameters[6];g.name==="Scale difference"&&(g.value=Math.round((g.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const f=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(g=>{g.unit||(g.unit=f)}),f.conversion_factor&&f.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:f});break;default:t.keyword=e[0];break}return t}}class mle extends U9{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class ple extends U9{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function yle(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function _le(n){return(yle(n)==="2019"?ple:mle).convert(n)}function xle(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Cp=1,z9=2,$9=3,av=4,W9=5,MR=-1,vle=/\s/,wle=/[A-Za-z]/,Ele=/[A-Za-z84_]/,zw=/[,\]]/,H9=/[\d\.E\-\+]/;function Jl(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Cp}Jl.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==av)for(;vle.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Cp:return this.neutral(n);case z9:return this.keyword(n);case av:return this.quoted(n);case W9:return this.afterquote(n);case $9:return this.number(n);case MR:return}};Jl.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=av;return}if(zw.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Jl.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Cp;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Cp,this.currentObject=this.stack.pop(),this.currentObject||(this.state=MR);return}};Jl.prototype.number=function(n){if(H9.test(n)){this.word+=n;return}if(zw.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Jl.prototype.quoted=function(n){if(n==='"'){this.state=W9;return}this.word+=n};Jl.prototype.keyword=function(n){if(Ele.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Cp;return}if(zw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Jl.prototype.neutral=function(n){if(wle.test(n)){this.word=n,this.state=z9;return}if(n==='"'){this.word="",this.state=av;return}if(H9.test(n)){this.word=n,this.state=$9;return}if(zw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Jl.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===MR)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Sle(n){var e=new Jl(n);return e.output()}function FS(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return Bf(a,s),s},r);e&&(n[e]=i)}function Bf(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Bf(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Bf(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Bf(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],FS(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],FS(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return Bf(n,e[t]);return FS(e,t,n)}}var Tle=.017453292519943295;function Ha(n){return n*Tle}function K9(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Ha(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Ha(n.lat0>0?90:-90),delete n.lat1)}function AL(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function RL(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function CL(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=RL(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-RL(n.ellipsoid.semi_minor_axis))))}function ov(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(ov(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,CL(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,CL(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=AL(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=AL(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":ov(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),K9(e),e)}var ble=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Ile(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function Y9(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];ble.indexOf(i)!==-1&&Ale(n[i]),typeof n[i]=="object"&&Y9(n[i])}}function Ale(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Ha(n.rectified_grid_angle));function o(h){var f=n.to_meter||1;return h*f}var l=function(h){return Ile(n,h)},u=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ha],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ha],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Ha],["lat0","latitude_of_origin",Ha],["lat0","standard_parallel_1",Ha],["lat1","standard_parallel_1",Ha],["lat2","standard_parallel_2",Ha],["azimuth","Azimuth"],["alpha","azimuth",Ha],["srsCode","name"]];u.forEach(l),K9(n)}function lv(n){if(typeof n=="object")return ov(n);const e=xle(n);var t=Sle(n);if(e==="WKT2"){const s=_le(t);return ov(s)}var r=t[0],i={};return Bf(t,i),Y9(i),i[r]}function Ii(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Ii[n]=Ob(arguments[1]):Ii[n]=lv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Ii[n]=lv(arguments[1]):(Ii[n]=t,t||delete Ii[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?Ii.apply(e,r):Ii(r)});if(typeof n=="string"){if(n in Ii)return Ii[n]}else"EPSG"in n?Ii["EPSG:"+n.EPSG]=n:"ESRI"in n?Ii["ESRI:"+n.ESRI]=n:"IAU2000"in n?Ii["IAU2000:"+n.IAU2000]=n:console.log(n);return}}lle(Ii);function Rle(n){return typeof n=="string"}function Cle(n){return n in Ii}function kle(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var Ple=["3857","900913","3785","102113"];function Mle(n){var e=_u(n,"authority");if(e){var t=_u(e,"epsg");return t&&Ple.indexOf(t)>-1}}function Nle(n){var e=_u(n,"extension");if(e)return _u(e,"proj4")}function Lle(n){return n[0]==="+"}function Ole(n){if(Rle(n)){if(Cle(n))return Ii[n];if(kle(n)){var e=lv(n);if(Mle(e))return Ii["EPSG:3857"];var t=Nle(e);return t?Ob(t):e}if(Lle(n))return Ob(n)}else return"projName"in n?n:lv(n)}function kL(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function tl(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function b1(n){return n<0?-1:1}function ht(n,e){return e||Math.abs(n)<=Vr?n:n-b1(n)*Rp}function ao(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(We-e))/r}function kp(n,e){for(var t=.5*n,r,i,s=We-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=We-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function Dle(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=tl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Fle(n){var e=n.x,t=n.y;if(t*Cs>90&&t*Cs<-90&&e*Cs>180&&e*Cs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-We)<=st)return null;if(this.sphere)r=this.x0+this.a*this.k0*ht(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(On+.5*t));else{var s=Math.sin(t),a=ao(this.e,t,s);r=this.x0+this.a*this.k0*ht(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function jle(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=We-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=kp(this.e,s),i===-9999)return null}return r=ht(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var Vle=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Gle={init:Dle,forward:Fle,inverse:jle,names:Vle};function Ble(){}function PL(n){return n}var X9=["longlat","identity"];const Ule={init:Ble,forward:PL,inverse:PL,names:X9};var zle=[Gle,Ule],dh={},Uf=[];function q9(n,e){var t=Uf.length;return n.names?(Uf[t]=n,n.names.forEach(function(r){dh[r.toLowerCase()]=t}),this):(console.log(e),!0)}function Z9(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function $le(n){if(!n)return!1;var e=n.toLowerCase();if(typeof dh[e]<"u"&&Uf[dh[e]]||(e=Z9(e),e in dh&&Uf[dh[e]]))return Uf[dh[e]]}function Wle(){zle.forEach(q9)}const Hle={start:Wle,add:q9,get:$le};var Q9={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const Kle=Q9.WGS84;function Yle(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(hle+a*(dle+a*fle)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function Xle(n,e,t,r,i){if(!n){var s=_u(Q9,r);s||(s=Kle),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<st)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var K_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var qle in K_){var jS=K_[qle];jS.datumName&&(K_[jS.datumName]=jS)}function Zle(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=Lb:o.datum_type=cle,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=rd),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=id,o.datum_params[3]*=Mm,o.datum_params[4]*=Mm,o.datum_params[5]*=Mm,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=n0,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var NR={};function Qle(n,e,t){return e instanceof ArrayBuffer?Jle(n,e,t):{ready:ece(n,e)}}function Jle(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=rce(i),a=ice(i,s),o=sce(i,a,s,r),l={header:a,subgrids:o};return NR[n]=l,l}async function ece(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],u=s.getBoundingBox().map(ML),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(ML),f=u[0]+(l[0]-1)*h[0],g=u[3]-(l[1]-1)*h[1],y=o[0],v=o[1],x=[];for(let b=l[1]-1;b>=0;b--)for(let I=l[0]-1;I>=0;I--){var E=b*l[0]+I;x.push([-Zc(v[E]),Zc(y[E])])}t.push({del:h,lim:l,ll:[-f,g],cvs:x})}var T={header:{nSubgrids:r},subgrids:t};return NR[n]=T,T}function tce(n){if(n===void 0)return null;var e=n.split(",");return e.map(nce)}function nce(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:NR[n]||null,isNull:!1}}function ML(n){return n*Math.PI/180}function Zc(n){return n/3600*Math.PI/180}function rce(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function ice(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:Db(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function Db(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function sce(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=oce(n,i,t),l=lce(n,i,o,t,r),u=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[Zc(o.lowerLongitude),Zc(o.lowerLatitude)],del:[Zc(o.longitudeInterval),Zc(o.latitudeInterval)],lim:[u,h],count:o.gridNodeCount,cvs:ace(l)});var f=16;r===!1&&(f=8),i+=176+o.gridNodeCount*f}return s}function ace(n){return n.map(function(e){return[Zc(e.longitudeShift),Zc(e.latitudeShift)]})}function oce(n,e,t){return{name:Db(n,e+8,e+16).trim(),parent:Db(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function lce(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var u={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(u.latitudeAccuracy=n.getFloat32(s+l*a+8,r),u.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(u)}return o}function Ca(n,e){if(!(this instanceof Ca))return new Ca(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(u){if(u)throw u};var t=Ole(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=Ca.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=_u(K_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=Xle(t.a,t.b,t.rf,t.ellps,t.sphere),a=Yle(s.a,s.b,s.rf,t.R_A),o=tce(t.nadgrids),l=t.datum||Zle(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);kL(this,t),kL(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ca.projections=Hle;Ca.projections.start();function cce(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===rd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===id?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function J9(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,u;if(i<-We&&i>-1.001*We)i=-We;else if(i>We&&i<1.001*We)i=We;else{if(i<-We)return{x:-1/0,y:-1/0,z:n.z};if(i>We)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),u=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*u*Math.cos(r),y:(a+s)*u*Math.sin(r),z:(a*(1-e)+s)*o}}function e7(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,u,h,f,g,y,v,x,E,T,b,I,M=n.x,F=n.y,G=n.z?n.z:0,R,C,P;if(o=Math.sqrt(M*M+F*F),l=Math.sqrt(M*M+F*F+G*G),o/t<i){if(R=0,l/t<i)return C=We,P=-r,{x:n.x,y:n.y,z:n.z}}else R=Math.atan2(F,M);u=G/l,h=o/l,f=1/Math.sqrt(1-e*(2-e)*h*h),v=h*(1-e)*f,x=u*f,I=0;do I++,y=t/Math.sqrt(1-e*x*x),P=o*v+G*x-y*(1-e*x*x),g=e*y/(y+P),f=1/Math.sqrt(1-g*(2-g)*h*h),E=h*(1-g)*f,T=u*f,b=T*v-E*x,v=E,x=T;while(b*b>s&&I<a);return C=Math.atan(T/Math.abs(E)),{x:R,y:C,z:P}}function uce(n,e,t){if(e===rd)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===id){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6];return{x:u*(n.x-l*n.y+o*n.z)+r,y:u*(l*n.x+n.y-a*n.z)+i,z:u*(-o*n.x+a*n.y+n.z)+s}}}function hce(n,e,t){if(e===rd)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===id){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6],h=(n.x-r)/u,f=(n.y-i)/u,g=(n.z-s)/u;return{x:h+l*f-o*g,y:-l*h+f+a*g,z:o*h-a*f+g}}}function h_(n){return n===rd||n===id}function dce(n,e,t){if(cce(n,e)||n.datum_type===Lb||e.datum_type===Lb)return t;var r=n.a,i=n.es;if(n.datum_type===n0){var s=NL(n,!1,t);if(s!==0)return;r=TL,i=bL}var a=e.a,o=e.b,l=e.es;if(e.datum_type===n0&&(a=TL,o=ule,l=bL),i===l&&r===a&&!h_(n.datum_type)&&!h_(e.datum_type))return t;if(t=J9(t,i,r),h_(n.datum_type)&&(t=uce(t,n.datum_type,n.datum_params)),h_(e.datum_type)&&(t=hce(t,e.datum_type,e.datum_params)),t=e7(t,l,a,o),e.datum_type===n0){var u=NL(e,!0,t);if(u!==0)return}return t}function NL(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,u=0,h=l.length;u<h;u++){var f=l[u],g=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,y=f.ll[0]-g,v=f.ll[1]-g,x=f.ll[0]+(f.lim[0]-1)*f.del[0]+g,E=f.ll[1]+(f.lim[1]-1)*f.del[1]+g;if(!(v>r.y||y>r.x||E<r.y||x<r.x)&&(i=fce(r,e,f),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Cs+" "+r.y*Cs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function fce(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=ht(i.x-Math.PI)+Math.PI;var s=LL(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,u;do{if(u=LL(s,t),isNaN(u.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(u.x+s.x),y:i.y-(u.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=ht(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function LL(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var u={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},f=i.x*i.y,g=i.x*(1-i.y),y=(1-i.x)*(1-i.y),v=(1-i.x)*i.y;return s.x=y*o.x+g*l.x+v*h.x+f*u.x,s.y=y*o.y+g*l.y+v*h.y+f*u.y,s}function OL(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,u={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":u[o]=a;break;case"w":u[o]=-a;break;case"n":u[o]=a;break;case"s":u[o]=-a;break;case"u":t[o]!==void 0&&(u.z=a);break;case"d":t[o]!==void 0&&(u.z=-a);break;default:return null}return u}function t7(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function gce(n){DL(n.x),DL(n.y)}function DL(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function mce(n,e){return(n.datum.datum_type===rd||n.datum.datum_type===id||n.datum.datum_type===n0)&&e.datumCode!=="WGS84"||(e.datum.datum_type===rd||e.datum.datum_type===id||e.datum.datum_type===n0)&&n.datumCode!=="WGS84"}function cv(n,e,t,r){var i;Array.isArray(t)?t=t7(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(gce(t),n.datum&&e.datum&&mce(n,e)&&(i=new Ca("WGS84"),t=cv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=OL(n,!1,t)),n.projName==="longlat")t={x:t.x*Cr,y:t.y*Cr,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=dce(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Cs,y:t.y*Cs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?OL(e,!0,t):(t&&!s&&delete t.z,t)}var FL=Ca("WGS84");function VS(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=cv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=cv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function d_(n){return n instanceof Ca?n:typeof n=="object"&&"oProj"in n?n.oProj:Ca(n)}function pce(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=d_(n),r=FL,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=d_(n),r=FL,s=!0),r||(r=d_(n)),i||(i=d_(e)),t?VS(r,i,t):(a={forward:function(o,l){return VS(r,i,o,l)},inverse:function(o,l){return VS(i,r,o,l)}},s&&(a.oProj=i),a)}var jL=6,n7="AJSAJS",r7="AFAFAF",zf=65,vs=73,va=79,dm=86,fm=90;const yce={forward:i7,inverse:_ce,toPoint:s7};function i7(n,e){return e=e||5,wce(xce({lat:n[1],lon:n[0]}),e)}function _ce(n){var e=LR(o7(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function s7(n){var e=LR(o7(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function GS(n){return n*(Math.PI/180)}function VL(n){return 180*(n/Math.PI)}function xce(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,u,h,f,g,y=GS(e),v=GS(t),x,E;E=Math.floor((t+180)/6)+1,t===180&&(E=60),e>=56&&e<64&&t>=3&&t<12&&(E=32),e>=72&&e<84&&(t>=0&&t<9?E=31:t>=9&&t<21?E=33:t>=21&&t<33?E=35:t>=33&&t<42&&(E=37)),a=(E-1)*6-180+3,x=GS(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),u=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),f=Math.cos(y)*(v-x),g=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var T=s*l*(f+(1-u+h)*f*f*f/6+(5-18*u+u*u+72*h-58*o)*f*f*f*f*f/120)+5e5,b=s*(g+l*Math.tan(y)*(f*f/2+(5-u+9*h+4*h*h)*f*f*f*f/24+(61-58*u+u*u+600*h-330*o)*f*f*f*f*f*f/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(T),zoneNumber:E,zoneLetter:vce(e)}}function LR(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,u=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,f,g,y,v,x,E,T,b,I=t-5e5,M=e;r<"N"&&(M-=1e7),E=(i-1)*6-180+3,l=o/(1-o),x=M/s,T=x/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=T+(3*u/2-27*u*u*u/32)*Math.sin(2*T)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*T)+151*u*u*u/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),f=Math.tan(b)*Math.tan(b),g=l*Math.cos(b)*Math.cos(b),y=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),v=I/(h*s);var F=b-h*Math.tan(b)/y*(v*v/2-(5+3*f+10*g-4*g*g-9*l)*v*v*v*v/24+(61+90*f+298*g+45*f*f-252*l-3*g*g)*v*v*v*v*v*v/720);F=VL(F);var G=(v-(1+2*f+g)*v*v*v/6+(5-2*g+28*f-3*g*g+8*l+24*f*f)*v*v*v*v*v/120)/Math.cos(b);G=E+VL(G);var R;if(n.accuracy){var C=LR({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});R={top:C.lat,right:C.lon,bottom:F,left:G}}else R={lat:F,lon:G};return R}function vce(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function wce(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+Ece(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function Ece(n,e,t){var r=a7(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return Sce(i,s,r)}function a7(n){var e=n%jL;return e===0&&(e=jL),e}function Sce(n,e,t){var r=t-1,i=n7.charCodeAt(r),s=r7.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>fm&&(a=a-fm+zf-1,l=!0),(a===vs||i<vs&&a>vs||(a>vs||i<vs)&&l)&&a++,(a===va||i<va&&a>va||(a>va||i<va)&&l)&&(a++,a===vs&&a++),a>fm&&(a=a-fm+zf-1),o>dm?(o=o-dm+zf-1,l=!0):l=!1,(o===vs||s<vs&&o>vs||(o>vs||s<vs)&&l)&&o++,(o===va||s<va&&o>va||(o>va||s<va)&&l)&&(o++,o===vs&&o++),o>dm&&(o=o-dm+zf-1);var u=String.fromCharCode(a)+String.fromCharCode(o);return u}function o7(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=a7(a),u=Tce(t.charAt(0),l),h=bce(t.charAt(1),l);h<Ice(o);)h+=2e6;var f=e-s;if(f%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var g=f/2,y=0,v=0,x,E,T,b,I;return g>0&&(x=1e5/Math.pow(10,g),E=n.substring(s,s+g),y=parseFloat(E)*x,T=n.substring(s+g),v=parseFloat(T)*x),b=y+u,I=v+h,{easting:b,northing:I,zoneLetter:o,zoneNumber:a,accuracy:x}}function Tce(n,e){for(var t=n7.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===vs&&t++,t===va&&t++,t>fm){if(i)throw"Bad character: "+n;t=zf,i=!0}r+=1e5}return r}function bce(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=r7.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===vs&&t++,t===va&&t++,t>dm){if(i)throw"Bad character: "+n;t=zf,i=!0}r+=1e5}return r}function Ice(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function O0(n,e,t){if(!(this instanceof O0))return new O0(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}O0.fromMGRS=function(n){return new O0(s7(n))};O0.prototype.toMGRS=function(n){return i7([this.x,this.y],n)};var Ace=1,Rce=.25,GL=.046875,BL=.01953125,UL=.01068115234375,Cce=.75,kce=.46875,Pce=.013020833333333334,Mce=.007120768229166667,Nce=.3645833333333333,Lce=.005696614583333333,Oce=.3076171875;function OR(n){var e=[];e[0]=Ace-n*(Rce+n*(GL+n*(BL+n*UL))),e[1]=n*(Cce-n*(GL+n*(BL+n*UL)));var t=n*n;return e[2]=t*(kce-n*(Pce+n*Mce)),t*=n,e[3]=t*(Nce-n*Lce),e[4]=t*n*Oce,e}function Y0(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var Dce=20;function DR(n,e,t){for(var r=1/(1-e),i=n,s=Dce;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(Y0(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<st)return i}return i}function Fce(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=OR(this.es),this.ml0=Y0(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function jce(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,f=Math.pow(h,2),g=this.ep2*Math.pow(l,2),y=Math.pow(g,2),v=Math.abs(l)>st?Math.tan(t):0,x=Math.pow(v,2),E=Math.pow(x,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=Y0(t,o,l,this.en);s=this.a*(this.k0*h*(1+f/6*(1-x+g+f/20*(5-18*x+E+14*g-58*x*g+f/42*(61+179*E-E*x-479*x)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+f/12*(5-x+9*g+4*y+f/30*(61+E-58*x+270*g-330*x*g+f/56*(1385+543*E-E*x-3111*x))))))+this.y0}else{var u=l*Math.sin(r);if(Math.abs(Math.abs(u)-1)<st)return 93;if(s=.5*this.a*this.k0*Math.log((1+u)/(1-u))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(u,2)),u=Math.abs(a),u>=1){if(u-1>st)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function Vce(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=DR(e,this.es,this.en),Math.abs(t)<We){var f=Math.sin(t),g=Math.cos(t),y=Math.abs(g)>st?Math.tan(t):0,v=this.ep2*Math.pow(g,2),x=Math.pow(v,2),E=Math.pow(y,2),T=Math.pow(E,2);e=1-this.es*Math.pow(f,2);var b=s*Math.sqrt(e)/this.k0,I=Math.pow(b,2);e=e*y,r=t-e*I/(1-this.es)*.5*(1-I/12*(5+3*E-9*v*E+v-4*x-I/30*(61+90*E-252*v*E+45*T+46*v-I/56*(1385+3633*E+4095*T+1574*T*E)))),i=ht(this.long0+b*(1-I/6*(1+2*E+v-I/20*(5+28*E+24*T+8*v*E+6*v-I/42*(61+662*E+1320*T+720*T*E))))/g,this.over)}else r=We*b1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),u=this.lat0+a/this.k0,h=Math.cos(u);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=ht(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var Gce=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const Y_={init:Fce,forward:jce,inverse:Vce,names:Gce};function l7(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Is(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function Bce(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function Uce(n){var e=Math.abs(n);return e=Bce(e*(1+e/(Is(1,e)+1))),n<0?-e:e}function FR(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function zce(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function $ce(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function c7(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=l7(t),a=$ce(t),o=2*i*a,l=-2*r*s,u=n.length-1,h=n[u],f=0,g=0,y=0,v,x;--u>=0;)v=g,x=f,g=h,f=y,h=-v+o*g-l*f+n[u],y=-x+l*g+o*f;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function Wce(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Y_.init.apply(this),this.forward=Y_.forward,this.inverse=Y_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=FR(this.cbg,this.lat0);this.Zb=-this.Qn*(r+zce(this.gtu,2*r))}function Hce(n){var e=ht(n.x-this.long0,this.over),t=n.y;t=FR(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,Is(r,i*a)),e=Uce(Math.tan(e));var o=c7(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,u;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,u=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,u=1/0),n.x=l,n.y=u,n}function Kce(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=c7(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(l7(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),u=Math.cos(e);t=Math.atan2(a*u,Is(l,u*o)),e=Math.atan2(l,u*o),r=ht(e+this.long0,this.over),i=FR(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var Yce=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const X_={init:Wce,forward:Hce,inverse:Kce,names:Yce};function Xce(n,e){if(n===void 0){if(n=Math.floor((ht(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var qce="etmerc";function Zce(){var n=Xce(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Cr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,X_.init.apply(this),this.forward=X_.forward,this.inverse=X_.inverse}var Qce=["Universal Transverse Mercator System","utm"];const Jce={init:Zce,names:Qce,dependsOn:qce};function jR(n,e){return Math.pow((1-n)/(1+n),e)}var eue=20;function tue(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+On)/(Math.pow(Math.tan(.5*this.lat0+On),this.C)*jR(this.e*n,this.ratexp))}function nue(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+On),this.C)*jR(this.e*Math.sin(t),this.ratexp))-We,n.x=this.C*e,n}function rue(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+On)/this.K,1/this.C),s=eue;s>0&&(r=2*Math.atan(i*jR(this.e*Math.sin(n.y),-.5*this.e))-We,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const VR={init:tue,forward:nue,inverse:rue};function iue(){VR.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function sue(n){var e,t,r,i;return n.x=ht(n.x-this.long0,this.over),VR.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function aue(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Is(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,VR.inverse.apply(this,[n]),n.x=ht(n.x+this.long0,this.over),n}var oue=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const lue={init:iue,forward:sue,inverse:aue,names:oue};function GR(n,e,t){return e*=t,Math.tan(.5*(We+n))*Math.pow((1-e)/(1+e),.5*t)}function cue(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*(1+b1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=st&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&Math.abs(Math.cos(this.lat_ts))>st&&(this.k0=.5*this.cons*tl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ao(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=tl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(GR(this.lat0,this.sinlat0,this.e))-We,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function uue(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,u,h,f=ht(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=st&&Math.abs(t+this.lat0)<=st?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(f)),n.x=this.a*s*i*Math.sin(f)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(f))+this.y0,n):(a=2*Math.atan(GR(t,r,this.e))-We,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=st?(u=ao(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*u/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<st?(s=2*this.a*this.k0/(1+l*Math.cos(f)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(f))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(f))+this.y0),n.x=s*l*Math.sin(f)+this.x0,n))}function hue(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=st?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<st?this.lat0>0?e=ht(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=ht(this.long0+Math.atan2(n.x,n.y),this.over):e=ht(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=st){if(a<=st)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*kp(this.e,r),e=this.con*ht(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=st?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=ht(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*kp(this.e,Math.tan(.5*(We+s)));return n.x=e,n.y=t,n}var due=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const fue={init:cue,forward:uue,inverse:hue,names:due,ssfn_:GR};function gue(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),u=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*u}function mue(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function pue(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,u=s,h=-1e3,f=0;Math.abs(u-h)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),h=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=u,n}var yue=["somerc"];const _ue={init:gue,forward:mue,inverse:pue,names:yue};var Mf=1e-7;function xue(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(Z9(t))!==-1}function vue(){var n,e,t,r,i,s,a,o,l,u,h=0,f,g=0,y=0,v=0,x=0,E=0,T=0;this.no_off=xue(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var I=!1;if("rectified_grid_angle"in this&&(I=!0),b&&(T=this.alpha),I&&(h=this.rectified_grid_angle),b||I)g=this.longc;else if(y=this.long1,x=this.lat1,v=this.long2,E=this.lat2,Math.abs(x-E)<=Mf||(n=Math.abs(x))<=Mf||Math.abs(n-We)<=Mf||Math.abs(Math.abs(this.lat0)-We)<=Mf||Math.abs(Math.abs(E)-We)<=Mf)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>st?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(ao(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||I?(b?(f=Math.asin(Math.sin(T)/r),I||(h=T)):(f=h,T=Math.asin(r*Math.sin(f))),this.lam0=g-Math.asin(.5*(i-1/i)*Math.tan(f))/this.B):(s=Math.pow(ao(this.e,x,Math.sin(x)),this.B),a=Math.pow(ao(this.e,E,Math.sin(E)),this.B),i=this.E/s,l=(a-s)/(a+s),u=this.E*this.E,u=(u-a*s)/(u+a*s),n=y-v,n<-Math.PI?v-=Rp:n>Math.PI&&(v+=Rp),this.lam0=ht(.5*(y+v)-Math.atan(u*Math.tan(.5*this.B*(y-v))/l)/this.B,this.over),f=Math.atan(2*Math.sin(this.B*ht(y-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(On-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(On+i))}function wue(n){var e={},t,r,i,s,a,o,l,u;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-We)>st){if(a=this.E/Math.pow(ao(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<st)throw new Error;u=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Mf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else u=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=u):(l-=this.u_0,e.x=u*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-u*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Eue(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<st)l.x=0,l.y=o<0?-We:We;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=kp(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Sue=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Tue={init:vue,forward:wue,inverse:Eue,names:Sue};function bue(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<st)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=tl(this.e,e,t),i=ao(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=tl(this.e,s,a),l=ao(this.e,this.lat2,s),u=Math.abs(Math.abs(this.lat0)-We)<st?0:ao(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>st?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Iue(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=st&&(t=b1(t)*(We-2*st));var r=Math.abs(Math.abs(t)-We),i,s;if(r>st)i=ao(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*ht(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Aue(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=kp(this.e,r),i===-9999)return null}else i=-We;return s=ht(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var Rue=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Cue={init:bue,forward:Iue,inverse:Aue,names:Rue};function kue(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Pue(n){var e,t,r,i,s,a,o,l=n.x,u=n.y,h=ht(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function Mue(n){var e,t,r,i,s,a,o,l,u=n.x;n.x=n.y,n.y=u,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var Nue=["Krovak","krovak"];const Lue={init:kue,forward:Pue,inverse:Mue,names:Nue};function hs(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function I1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function A1(n){return .375*n*(1+.25*n*(1+.46875*n))}function R1(n){return .05859375*n*n*(1+.75*n)}function C1(n){return n*n*n*(35/3072)}function BR(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function ku(n){return Math.abs(n)<We?n:n-b1(n)*Math.PI}function uv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function Oue(){this.sphere||(this.e0=I1(this.es),this.e1=A1(this.es),this.e2=R1(this.es),this.e3=C1(this.es),this.ml0=this.a*hs(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Due(n){var e,t,r=n.x,i=n.y;if(r=ht(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=BR(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),u=r*Math.cos(i),h=u*u,f=this.es*a*a/(1-this.es),g=this.a*hs(this.e0,this.e1,this.e2,this.e3,i);e=o*u*(1-h*l*(1/6-(8-l+8*f)*h/120)),t=g-this.ml0+o*s/a*h*(.5+(5-l+6*f)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function Fue(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=uv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-We)<=st)return n.x=this.long0,n.y=We,t<0&&(n.y*=-1),n;var l=BR(this.a,this.e,Math.sin(o)),u=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),f=e*this.a/l,g=f*f;r=o-l*Math.tan(o)/u*f*f*(.5-(1+3*h)*f*f/24),i=f*(1-g*(h/3+(1+3*h)*h*g/15))/Math.cos(o)}return n.x=ht(i+this.long0,this.over),n.y=ku(r),n}var jue=["Cassini","Cassini_Soldner","cass"];const Vue={init:Oue,forward:Due,inverse:Fue,names:jue};function lu(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var Fb=1,jb=2,Vb=3,q_=4;function Gue(){var n=Math.abs(this.lat0);if(Math.abs(n-We)<st?this.mode=this.lat0<0?Fb:jb:Math.abs(n)<st?this.mode=Vb:this.mode=q_,this.es>0){var e;switch(this.qp=lu(this.e,1),this.mmf=.5/(1-this.es),this.apa=Xue(this.es),this.mode){case jb:this.dd=1;break;case Fb:this.dd=1;break;case Vb:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case q_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=lu(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===q_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Bue(n){var e,t,r,i,s,a,o,l,u,h,f=n.x,g=n.y;if(f=ht(f-this.long0,this.over),this.sphere){if(s=Math.sin(g),h=Math.cos(g),r=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=st)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(f),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(g+this.lat0)<st)return null;t=On-g*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=r}}else{switch(o=0,l=0,u=0,r=Math.cos(f),i=Math.sin(f),s=Math.sin(g),a=lu(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:u=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:u=1+l*r;break;case this.N_POLE:u=We+g,a=this.qp-a;break;case this.S_POLE:u=g-We,a=this.qp+a;break}if(Math.abs(u)<st)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),this.mode===this.OBLIQ?t=this.ymf*u*(this.cosb1*o-this.sinb1*l*r):t=(u=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*u*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?u:-u)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function Uue(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,u;if(this.sphere){var h=0,f,g=0;if(f=Math.sqrt(e*e+t*t),i=f*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=st?0:Math.asin(t*g/f),e*=g,t=h*f;break;case this.OBLIQ:i=Math.abs(f)<=st?this.lat0:Math.asin(h*this.sinph0+t*g*this.cosph0/f),e*=g*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:t=-t,i=We-i;break;case this.S_POLE:i-=We;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(u=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<st)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(u=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*u,t=l*this.cosb1*s-t*this.sinb1*a):(u=t*a/l,o=this.qp*u,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;u=1-o/this.qp,this.mode===this.S_POLE&&(u=-u)}r=Math.atan2(e,t),i=que(Math.asin(u),this.apa)}return n.x=ht(this.long0+r,this.over),n.y=i,n}var zue=.3333333333333333,$ue=.17222222222222222,Wue=.10257936507936508,Hue=.06388888888888888,Kue=.0664021164021164,Yue=.016415012942191543;function Xue(n){var e,t=[];return t[0]=n*zue,e=n*n,t[0]+=e*$ue,t[1]=e*Hue,e*=n,t[0]+=e*Wue,t[1]+=e*Kue,t[2]=e*Yue,t}function que(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Zue=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Que={init:Gue,forward:Bue,inverse:Uue,names:Zue,S_POLE:Fb,N_POLE:jb,EQUIT:Vb,OBLIQ:q_};function xu(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Jue(){Math.abs(this.lat1+this.lat2)<st||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=tl(this.e3,this.sin_po,this.cos_po),this.qs1=lu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=tl(this.e3,this.sin_po,this.cos_po),this.qs2=lu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=lu(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>st?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function ehe(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=lu(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*ht(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function the(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=ht(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function nhe(n,e){var t,r,i,s,a,o=xu(.5*e);if(n<st)return o;for(var l=n*n,u=1;u<=25;u++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var rhe=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const ihe={init:Jue,forward:ehe,inverse:the,names:rhe,phi1z:nhe};function she(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function ahe(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ht(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=st?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function ohe(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=xu(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=ht(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var lhe=["gnom"];const che={init:she,forward:ahe,inverse:ohe,names:lhe};function uhe(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*We:We;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function hhe(){this.sphere||(this.k0=tl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function dhe(n){var e=n.x,t=n.y,r,i,s=ht(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=lu(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function fhe(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=ht(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=uhe(this.e,2*n.y*this.k0/this.a),e=ht(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var ghe=["cea"];const mhe={init:hhe,forward:dhe,inverse:fhe,names:ghe};function phe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function yhe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=ku(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function _he(n){var e=n.x,t=n.y;return n.x=ht(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=ku(this.lat0+(t-this.y0)/this.a),n}var xhe=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const vhe={init:phe,forward:yhe,inverse:_he,names:xhe};var zL=20;function whe(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=I1(this.es),this.e1=A1(this.es),this.e2=R1(this.es),this.e3=C1(this.es),this.ml0=this.a*hs(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Ehe(n){var e=n.x,t=n.y,r,i,s,a=ht(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=st?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(ku(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=st)r=this.a*a,i=-1*this.ml0;else{var o=BR(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*hs(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function She(n){var e,t,r,i,s,a,o,l,u;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=st)e=ht(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=zL;s;--s)if(h=Math.tan(l),u=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=u,Math.abs(u)<=st){t=l;break}e=ht(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=st)t=0,e=ht(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var f,g,y,v,x;for(s=zL;s;--s)if(x=this.e*Math.sin(l),f=Math.sqrt(1-x*x)*Math.tan(l),g=this.a*hs(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),v=g/this.a,u=(a*(f*v+1)-v-.5*f*(v*v+o))/(this.es*Math.sin(2*l)*(v*v+o-2*a*v)/(4*f)+(a-v)*(f*y-2/Math.sin(2*l))-y),l-=u,Math.abs(u)<=st){t=l;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=ht(this.long0+Math.asin(r*f/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var The=["Polyconic","American_Polyconic","poly"];const bhe={init:whe,forward:Ehe,inverse:She,names:The};function Ihe(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Ahe(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/Mm*1e-5,o=s,l=1,u=0;for(e=1;e<=10;e++)l=l*a,u=u+this.A[e]*l;var h=u,f=o,g=1,y=0,v,x,E=0,T=0;for(e=1;e<=6;e++)v=g*h-y*f,x=y*h+g*f,g=v,y=x,E=E+this.B_re[e]*g-this.B_im[e]*y,T=T+this.B_im[e]*g+this.B_re[e]*y;return n.x=T*this.a+this.x0,n.y=E*this.a+this.y0,n}function Rhe(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,u=0,h,f,g=0,y=0;for(e=1;e<=6;e++)h=l*a-u*o,f=u*a+l*o,l=h,u=f,g=g+this.C_re[e]*l-this.C_im[e]*u,y=y+this.C_im[e]*l+this.C_re[e]*u;for(var v=0;v<this.iterations;v++){var x=g,E=y,T,b,I=a,M=o;for(e=2;e<=6;e++)T=x*g-E*y,b=E*g+x*y,x=T,E=b,I=I+(e-1)*(this.B_re[e]*x-this.B_im[e]*E),M=M+(e-1)*(this.B_im[e]*x+this.B_re[e]*E);x=1,E=0;var F=this.B_re[1],G=this.B_im[1];for(e=2;e<=6;e++)T=x*g-E*y,b=E*g+x*y,x=T,E=b,F=F+e*(this.B_re[e]*x-this.B_im[e]*E),G=G+e*(this.B_im[e]*x+this.B_re[e]*E);var R=F*F+G*G;g=(I*F+M*G)/R,y=(M*F-I*G)/R}var C=g,P=y,N=1,O=0;for(e=1;e<=9;e++)N=N*C,O=O+this.D[e]*N;var z=this.lat0+O*Mm*1e5,j=this.long0+P;return n.x=j,n.y=z,n}var Che=["New_Zealand_Map_Grid","nzmg"];const khe={init:Ihe,forward:Ahe,inverse:Rhe,names:Che};function Phe(){}function Mhe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function Nhe(n){n.x-=this.x0,n.y-=this.y0;var e=ht(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var Lhe=["Miller_Cylindrical","mill"];const Ohe={init:Phe,forward:Mhe,inverse:Nhe,names:Lhe};var Dhe=20;function Fhe(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=OR(this.es)}function jhe(n){var e,t,r=n.x,i=n.y;if(r=ht(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=Dhe;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<st)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),u=Math.cos(i);t=this.a*Y0(i,l,u,this.en),e=this.a*r*u/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function Vhe(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=xu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=xu(Math.sin(e)/this.n)),r=ht(r+this.long0,this.over),e=ku(e)):(e=DR(n.y/this.a,this.es,this.en),i=Math.abs(e),i<We?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=ht(t,this.over)):i-st<We&&(r=this.long0)),n.x=r,n.y=e,n}var Ghe=["Sinusoidal","sinu"];const Bhe={init:Fhe,forward:jhe,inverse:Vhe,names:Ghe};function Uhe(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function zhe(n){for(var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<st)break}i/=2,Math.PI/2-Math.abs(t)<st&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function $he(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=ht(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var Whe=["Mollweide","moll"];const Hhe={init:Uhe,forward:zhe,inverse:$he,names:Whe};function Khe(){Math.abs(this.lat1+this.lat2)<st||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=I1(this.es),this.e1=A1(this.es),this.e2=R1(this.es),this.e3=C1(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=tl(this.e,this.sin_phi,this.cos_phi),this.ml1=hs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<st?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=tl(this.e,this.sin_phi,this.cos_phi),this.ml2=hs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=hs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Yhe(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=hs(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*ht(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function Xhe(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=ht(this.long0+s/this.ns,this.over),r=ku(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=uv(a,this.e0,this.e1,this.e2,this.e3),i=ht(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var qhe=["Equidistant_Conic","eqdc"];const Zhe={init:Khe,forward:Yhe,inverse:Xhe,names:qhe};function Qhe(){this.R=this.a}function Jhe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i,s;Math.abs(t)<=st&&(i=this.x0+this.R*r,s=this.y0);var a=xu(2*Math.abs(t/Math.PI));(Math.abs(r)<=st||Math.abs(Math.abs(t)-We)<=st)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,u=Math.sin(a),h=Math.cos(a),f=h/(u+h-1),g=f*f,y=f*(2/u-1),v=y*y,x=Math.PI*this.R*(o*(f-v)+Math.sqrt(l*(f-v)*(f-v)-(v+l)*(g-v)))/(v+l);r<0&&(x=-x),i=this.x0+x;var E=l+f;return x=Math.PI*this.R*(y*E-o*Math.sqrt((v+l)*(l+1)-E*E))/(v+l),t>=0?s=this.y0+x:s=this.y0-x,n.x=i,n.y=s,n}function ede(n){var e,t,r,i,s,a,o,l,u,h,f,g,y;return n.x-=this.x0,n.y-=this.y0,f=Math.PI*this.R,r=n.x/f,i=n.y/f,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,u=(a-o*o/3/l)/l,h=2*Math.sqrt(-u/3),f=3*y/u/h,Math.abs(f)>1&&(f>=0?f=1:f=-1),g=Math.acos(f)/3,n.y>=0?t=(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<st?e=this.long0:e=ht(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var tde=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const nde={init:Qhe,forward:Jhe,inverse:ede,names:tde};function rde(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),u=Math.sin(o),h=Math.cos(o),f=Math.sin(l),g=Math.cos(l);let y=a,v,x=100,E,T,b,I,M,F,G,R,C,P,N,O,z,j;do{if(E=Math.sin(y),T=Math.cos(y),b=Math.sqrt(g*E*(g*E)+(h*f-u*g*T)*(h*f-u*g*T)),b===0)return{azi1:0,s12:0};I=u*f+h*g*T,M=Math.atan2(b,I),F=h*g*E/b,G=1-F*F,R=G!==0?I-2*u*f/G:0,C=s/16*G*(4+s*(4-3*G)),v=y,y=a+(1-C)*s*F*(M+C*b*(R+C*I*(-1+2*R*R)))}while(Math.abs(y-v)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(P=G*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),N=1+P/16384*(4096+P*(-768+P*(320-175*P))),O=P/1024*(256+P*(-128+P*(74-47*P))),z=O*b*(R+O/4*(I*(-1+2*R*R)-O/6*R*(-3+4*b*b)*(-3+4*R*R))),j=i*(1-s)*N*(M-z),{azi1:Math.atan2(g*E,h*f-u*g*T),s12:j})}function ide(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),u=Math.sin(t),h=Math.cos(t),f=Math.atan2(o,l*h),g=l*u,y=1-g*g,v=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+v/16384*(4096+v*(-768+v*(320-175*v))),E=v/1024*(256+v*(-128+v*(74-47*v)));let T=r/(i*(1-s)*x),b,I=100,M,F,G,R;do M=Math.cos(2*f+T),F=Math.sin(T),G=Math.cos(T),R=E*F*(M+E/4*(G*(-1+2*M*M)-E/6*M*(-3+4*F*F)*(-3+4*M*M))),b=T,T=r/(i*(1-s)*x)+R;while(Math.abs(T-b)>1e-12&&--I>0);if(I===0)return{lat2:NaN,lon2:NaN};const C=o*F-l*G*h,P=Math.atan2(o*G+l*F*h,(1-s)*Math.sqrt(g*g+C*C)),N=Math.atan2(F*u,l*G-o*F*h),O=s/16*y*(4+s*(4-3*y)),z=N-(1-O)*s*g*(T+O*F*(M+O*G*(-1+2*M*M))),j=e+z;return{lat2:P,lon2:j}}function sde(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function ade(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=ht(e-this.long0,this.over),a,o,l,u,h,f,g,y,v,x,E;return this.sphere?Math.abs(this.sin_p12-1)<=st?(n.x=this.x0+this.a*(We-t)*Math.sin(s),n.y=this.y0-this.a*(We-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(n.x=this.x0+this.a*(We+t)*Math.sin(s),n.y=this.y0+this.a*(We+t)*Math.cos(s),n):(v=this.sin_p12*r+this.cos_p12*i*Math.cos(s),g=Math.acos(v),y=g?g/Math.sin(g):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=I1(this.es),o=A1(this.es),l=R1(this.es),u=C1(this.es),Math.abs(this.sin_p12-1)<=st?(h=this.a*hs(a,o,l,u,We),f=this.a*hs(a,o,l,u,t),n.x=this.x0+(h-f)*Math.sin(s),n.y=this.y0-(h-f)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(h=this.a*hs(a,o,l,u,We),f=this.a*hs(a,o,l,u,t),n.x=this.x0+(h+f)*Math.sin(s),n.y=this.y0+(h+f)*Math.cos(s),n):Math.abs(e)<st&&Math.abs(t-this.lat0)<st?(n.x=n.y=0,n):(x=rde(this.lat0,this.long0,t,e,this.a,this.f),E=x.azi1,n.x=x.s12*Math.sin(E),n.y=x.s12*Math.cos(E),n))}function ode(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,u,h,f,g,y,v,x,E;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*We*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=st?a=this.lat0:(a=xu(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-We,Math.abs(o)<=st?this.lat0>=0?s=ht(this.long0+Math.atan2(n.x,-n.y),this.over):s=ht(this.long0-Math.atan2(-n.x,n.y),this.over):s=ht(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=I1(this.es),u=A1(this.es),h=R1(this.es),f=C1(this.es),Math.abs(this.sin_p12-1)<=st?(g=this.a*hs(l,u,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=g-e,a=uv(y/this.a,l,u,h,f),s=ht(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=st?(g=this.a*hs(l,u,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-g,a=uv(y/this.a,l,u,h,f),s=ht(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(v=Math.atan2(n.x,n.y),x=Math.sqrt(n.x*n.x+n.y*n.y),E=ide(this.lat0,this.long0,v,x,this.a,this.f),n.x=E.lon2,n.y=E.lat2,n))}var lde=["Azimuthal_Equidistant","aeqd"];const cde={init:sde,forward:ade,inverse:ode,names:lde};function ude(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function hde(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ht(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=st)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function dde(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=xu(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=st?(o=this.lat0,n.x=a,n.y=o,n):(o=xu(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-We,Math.abs(s)<=st?(this.lat0>=0?a=ht(this.long0+Math.atan2(n.x,-n.y),this.over):a=ht(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=ht(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var fde=["ortho"];const gde={init:ude,forward:hde,inverse:dde,names:fde};var Tr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Dn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function mde(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=We-On/2?this.face=Tr.TOP:this.lat0<=-(We-On/2)?this.face=Tr.BOTTOM:Math.abs(this.long0)<=On?this.face=Tr.FRONT:Math.abs(this.long0)<=We+On?this.face=this.long0>0?Tr.RIGHT:Tr.LEFT:this.face=Tr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function pde(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Tr.TOP)s=We-t,r>=On&&r<=We+On?(l.value=Dn.AREA_0,i=r-We):r>We+On||r<=-(We+On)?(l.value=Dn.AREA_1,i=r>0?r-Vr:r+Vr):r>-(We+On)&&r<=-On?(l.value=Dn.AREA_2,i=r+We):(l.value=Dn.AREA_3,i=r);else if(this.face===Tr.BOTTOM)s=We+t,r>=On&&r<=We+On?(l.value=Dn.AREA_0,i=-r+We):r<On&&r>=-On?(l.value=Dn.AREA_1,i=-r):r<-On&&r>=-(We+On)?(l.value=Dn.AREA_2,i=-r-We):(l.value=Dn.AREA_3,i=r>0?-r+Vr:-r-Vr);else{var u,h,f,g,y,v,x;this.face===Tr.RIGHT?r=r0(r,+We):this.face===Tr.BACK?r=r0(r,+Vr):this.face===Tr.LEFT&&(r=r0(r,-We)),g=Math.sin(t),y=Math.cos(t),v=Math.sin(r),x=Math.cos(r),u=y*x,h=y*v,f=g,this.face===Tr.FRONT?(s=Math.acos(u),i=f_(s,f,h,l)):this.face===Tr.RIGHT?(s=Math.acos(h),i=f_(s,f,-u,l)):this.face===Tr.BACK?(s=Math.acos(-u),i=f_(s,f,-h,l)):this.face===Tr.LEFT?(s=Math.acos(-h),i=f_(s,f,u,l)):(s=i=0,l.value=Dn.AREA_0)}return o=Math.atan(12/Vr*(i+Math.acos(Math.sin(i)*Math.cos(On))-We)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Dn.AREA_1?o+=We:l.value===Dn.AREA_2?o+=Vr:l.value===Dn.AREA_3&&(o+=1.5*Vr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function yde(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,u,h,f={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?f.value=Dn.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(f.value=Dn.AREA_1,t-=We):n.x<0&&-n.x>=Math.abs(n.y)?(f.value=Dn.AREA_2,t=t<0?t+Vr:t-Vr):(f.value=Dn.AREA_3,t+=We),h=Vr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===Tr.TOP)u=Math.acos(l),e.phi=We-u,f.value===Dn.AREA_0?e.lam=o+We:f.value===Dn.AREA_1?e.lam=o<0?o+Vr:o-Vr:f.value===Dn.AREA_2?e.lam=o-We:e.lam=o;else if(this.face===Tr.BOTTOM)u=Math.acos(l),e.phi=u-We,f.value===Dn.AREA_0?e.lam=-o+We:f.value===Dn.AREA_1?e.lam=-o:f.value===Dn.AREA_2?e.lam=-o-We:e.lam=o<0?-o-Vr:-o+Vr;else{var g,y,v;g=l,h=g*g,h>=1?v=0:v=Math.sqrt(1-h)*Math.sin(o),h+=v*v,h>=1?y=0:y=Math.sqrt(1-h),f.value===Dn.AREA_1?(h=y,y=-v,v=h):f.value===Dn.AREA_2?(y=-y,v=-v):f.value===Dn.AREA_3&&(h=y,y=v,v=-h),this.face===Tr.RIGHT?(h=g,g=-y,y=h):this.face===Tr.BACK?(g=-g,y=-y):this.face===Tr.LEFT&&(h=g,g=y,y=-h),e.phi=Math.acos(-v)-We,e.lam=Math.atan2(y,g),this.face===Tr.RIGHT?e.lam=r0(e.lam,-We):this.face===Tr.BACK?e.lam=r0(e.lam,-Vr):this.face===Tr.LEFT&&(e.lam=r0(e.lam,+We))}if(this.es!==0){var x,E,T;x=e.phi<0?1:0,E=Math.tan(e.phi),T=this.b/Math.sqrt(E*E+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function f_(n,e,t,r){var i;return n<st?(r.value=Dn.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=On?r.value=Dn.AREA_0:i>On&&i<=We+On?(r.value=Dn.AREA_1,i-=We):i>We+On||i<=-(We+On)?(r.value=Dn.AREA_2,i=i>=0?i-Vr:i+Vr):(r.value=Dn.AREA_3,i+=We)),i}function r0(n,e){var t=n+e;return t<-Vr?t+=Rp:t>+Vr&&(t-=Rp),t}var _de=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const xde={init:mde,forward:pde,inverse:yde,names:_de};var Gb=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],gm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],u7=.8487,h7=1.3523,d7=Cs/5,vde=1/d7,$f=18,hv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},wde=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function Ede(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function Sde(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Tde(n){var e=ht(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*d7);r<0?r=0:r>=$f&&(r=$f-1),t=Cs*(t-vde*r);var i={x:hv(Gb[r],t)*e,y:hv(gm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*u7+this.x0,i.y=i.y*this.a*h7+this.y0,i}function bde(n){var e={x:(n.x-this.x0)/(this.a*u7),y:Math.abs(n.y-this.y0)/(this.a*h7)};if(e.y>=1)e.x/=Gb[$f][0],e.y=n.y<0?-We:We;else{var t=Math.floor(e.y*$f);for(t<0?t=0:t>=$f&&(t=$f-1);;)if(gm[t][0]>e.y)--t;else if(gm[t+1][0]<=e.y)++t;else break;var r=gm[t],i=5*(e.y-r[0])/(gm[t+1][0]-r[0]);i=Ede(function(s){return(hv(r,s)-e.y)/wde(r,s)},i,st,100),e.x/=hv(Gb[t],i),e.y=(5*t+i)*Cr,n.y<0&&(e.y=-e.y)}return e.x=ht(e.x+this.long0,this.over),e}var Ide=["Robinson","robin"];const Ade={init:Sde,forward:Tde,inverse:bde,names:Ide};function Rde(){this.name="geocent"}function Cde(n){var e=J9(n,this.es,this.a);return e}function kde(n){var e=e7(n,this.es,this.a,this.b);return e}var Pde=["Geocentric","geocentric","geocent","Geocent"];const Mde={init:Rde,forward:Cde,inverse:kde,names:Pde};var Ki={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},qg={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Nde(){if(Object.keys(qg).forEach((function(t){if(typeof this[t]>"u")this[t]=qg[t].def;else{if(qg[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);qg[t].num&&(this[t]=parseFloat(this[t]))}qg[t].degrees&&(this[t]=this[t]*Cr)}).bind(this)),Math.abs(Math.abs(this.lat0)-We)<st?this.mode=this.lat0<0?Ki.S_POLE:Ki.N_POLE:Math.abs(this.lat0)<st?this.mode=Ki.EQUIT:(this.mode=Ki.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Lde(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case Ki.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case Ki.EQUIT:s=t*r;break;case Ki.S_POLE:s=-e;break;case Ki.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case Ki.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case Ki.EQUIT:s*=e;break;case Ki.N_POLE:s*=-(t*r);break;case Ki.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function Ode(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=Is(n.x,n.y);if(Math.abs(s)<st)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case Ki.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case Ki.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case Ki.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case Ki.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var Dde=["Tilted_Perspective","tpers"];const Fde={init:Nde,forward:Lde,inverse:Ode,names:Dde};function jde(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Vde(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/Is(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Is(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Is(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Is(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Is(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Gde(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Is(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Is(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var Bde=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Ude={init:jde,forward:Vde,inverse:Gde,names:Bde};var Nm=1.340264,Lm=-.081106,Om=893e-6,Dm=.003796,dv=Math.sqrt(3)/2;function zde(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function $de(n){var e=ht(n.x-this.long0,this.over),t=n.y,r=Math.asin(dv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(dv*(Nm+3*Lm*i+s*(7*Om+9*Dm*i))),n.y=r*(Nm+Lm*i+s*(Om+Dm*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Wde(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,u;for(u=0;u<t&&(i=r*r,s=i*i*i,a=r*(Nm+Lm*i+s*(Om+Dm*i))-n.y,o=Nm+3*Lm*i+s*(7*Om+9*Dm*i),r-=l=a/o,!(Math.abs(l)<e));++u);return i=r*r,s=i*i*i,n.x=dv*n.x*(Nm+3*Lm*i+s*(7*Om+9*Dm*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/dv),n.x=ht(n.x+this.long0,this.over),n}var Hde=["eqearth","Equal Earth","Equal_Earth"];const Kde={init:zde,forward:$de,inverse:Wde,names:Hde};var Pp=1e-10;function Yde(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<Pp)throw new Error;this.es?(this.en=OR(this.es),this.m1=Y0(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=qde,this.forward=Xde):(Math.abs(this.phi1)+Pp>=We?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Qde,this.forward=Zde)}function Xde(n){var e=ht(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-Y0(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function qde(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=Is(n.x,n.y=this.am1-n.y),i=DR(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<We)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-We)<=Pp)r=0;else throw new Error;return n.x=ht(r+(this.long0||0),this.over),n.y=ku(i),n}function Zde(n){var e=ht(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>Pp?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Qde(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=Is(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>We)throw new Error;return Math.abs(Math.abs(t)-We)<=Pp?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=ht(e+(this.long0||0),this.over),n.y=ku(t),n}var Jde=["bonne","Bonne (Werner lat_1=90)"];const efe={init:Yde,names:Jde},$L={OBLIQUE:{forward:sfe,inverse:ofe},TRANSVERSE:{forward:afe,inverse:lfe}},fv={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function tfe(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=X9.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ca(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(fv),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Cr;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],u=fv[l],h=Object.entries(u);if(h.some(([g])=>typeof this[g]<"u")){t=u;for(let g=0;g<h.length;g++){const[y,v]=h[g],x=i(y);if(typeof x>"u")throw new Error("Missing parameter: "+y+".");this[v]=x}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=ife(this,t);this.lamp=s,Math.abs(a)>st?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=$L.OBLIQUE):this.projectionType=$L.TRANSVERSE}function nfe(n){return this.projectionType.forward(this,n)}function rfe(n){return this.projectionType.inverse(this,n)}function ife(n,e){let t,r;if(e===fv.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-We)<=st)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===fv.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>We-st)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>We-st)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<st)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<st)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function sfe(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=ht(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Cs,o.y*=Cs),o}function afe(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=ht(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Cs,a.y*=Cs),a}function ofe(n,e){n.isIdentity&&(e.x*=Cr,e.y*=Cr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=ht(e.x+n.long0),e}function lfe(n,e){n.isIdentity&&(e.x*=Cr,e.y*=Cr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=ht(e.x+n.long0),e}var cfe=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const ufe={init:tfe,forward:nfe,inverse:rfe,names:cfe};function hfe(n){n.Proj.projections.add(Y_),n.Proj.projections.add(X_),n.Proj.projections.add(Jce),n.Proj.projections.add(lue),n.Proj.projections.add(fue),n.Proj.projections.add(_ue),n.Proj.projections.add(Tue),n.Proj.projections.add(Cue),n.Proj.projections.add(Lue),n.Proj.projections.add(Vue),n.Proj.projections.add(Que),n.Proj.projections.add(ihe),n.Proj.projections.add(che),n.Proj.projections.add(mhe),n.Proj.projections.add(vhe),n.Proj.projections.add(bhe),n.Proj.projections.add(khe),n.Proj.projections.add(Ohe),n.Proj.projections.add(Bhe),n.Proj.projections.add(Hhe),n.Proj.projections.add(Zhe),n.Proj.projections.add(nde),n.Proj.projections.add(cde),n.Proj.projections.add(gde),n.Proj.projections.add(xde),n.Proj.projections.add(Ade),n.Proj.projections.add(Mde),n.Proj.projections.add(Fde),n.Proj.projections.add(Ude),n.Proj.projections.add(Kde),n.Proj.projections.add(efe),n.Proj.projections.add(ufe)}const wn=Object.assign(pce,{defaultDatum:"WGS84",Proj:Ca,WGS84:new Ca("WGS84"),Point:O0,toPoint:t7,defs:Ii,nadgrid:Qle,transform:cv,mgrs:yce,version:"__VERSION__"});hfe(wn);class f7{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=mi,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?qn(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=qn(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Ut()}readFeature(e,t){return Ut()}readFeatures(e,t){return Ut()}readGeometry(e,t){return Ut()}readProjection(e){return Ut()}writeFeature(e,t){return Ut()}writeFeatures(e,t){return Ut()}writeGeometry(e,t){return Ut()}}function uo(n,e,t){const r=t?qn(t.featureProjection):null,i=t?qn(t.dataProjection):null;let s=n;if(r&&i&&!Ch(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(qm(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let u=0,h=l.length;u<h;++u)l[u]=Math.round(l[u]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const dfe={Point:_i,LineString:na,Polygon:Pa,MultiPoint:dd,MultiLineString:Bl,MultiPolygon:Uh};function ffe(n,e,t){return Array.isArray(e[0])?(z5(n,0,e,t)||(n=n.slice(),yT(n,0,e,t)),n):(EI(n,0,e,t)||(n=n.slice(),hx(n,0,e,t)),n)}function g7(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>g7({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return uo(new Ys(r,r==="Polygon"?ffe(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function UR(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>UR(i,e));return new ro(r)}const t=dfe[n.type];return uo(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class gfe extends f7{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(g_(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(g_(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Ut()}readFeaturesFromObject(e,t){return Ut()}readGeometry(e,t){return this.readGeometryFromObject(g_(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Ut()}readProjection(e){return this.readProjectionFromObject(g_(e))}readProjectionFromObject(e){return Ut()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Ut()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Ut()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Ut()}}function g_(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class zR extends gfe{constructor(e){e=e||{},super(),this.dataProjection=qn(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=qn(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=$R(r.geometry);if(this.featureClass===Ys)return g7({geometry:i,id:r.id,properties:r.properties},t);const s=new mi;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(UR(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const u=this.readFeatureFromObject(a[o],t);u&&i.push(u)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return mfe(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=qn(t.properties.name);else if(t.type==="EPSG")r=qn("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=Bb(a,t),delete s[e.getGeometryName()]),Fh(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return Bb(e,this.adaptOptions(t))}}function $R(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=yfe(n);break}case"LineString":{t=_fe(n);break}case"Polygon":{t=Efe(n);break}case"MultiPoint":{t=vfe(n);break}case"MultiLineString":{t=xfe(n);break}case"MultiPolygon":{t=wfe(n);break}case"GeometryCollection":{t=pfe(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function mfe(n,e){const t=$R(n);return UR(t,e)}function pfe(n,e){return n.geometries.map(function(r){return $R(r)})}function yfe(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:hd(e.length)}}function _fe(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:hd(e[0]?.length||2)}}function xfe(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=Yp(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:hd(t)}}function vfe(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:hd(e[0]?.length||2)}}function wfe(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=x5(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:hd(r)}}function Efe(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=Yp(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:hd(r)}}function Bb(n,e){n=uo(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=Rfe(n);break}case"LineString":{r=Tfe(n);break}case"Polygon":{r=Cfe(n,e);break}case"MultiPoint":{r=Ife(n);break}case"MultiLineString":{r=bfe(n);break}case"MultiPolygon":{r=Afe(n,e);break}case"GeometryCollection":{r=Sfe(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function Sfe(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return Bb(r,e)})}}function Tfe(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function bfe(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Ife(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Afe(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function Rfe(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function Cfe(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const gv="http://www.w3.org/2001/XMLSchema-instance";function Ed(n,e){return X0().createElementNS(n,e)}function ho(n,e){return m7(n,e,[]).join("")}function m7(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)m7(r,e,t)}return t}function Cl(n){return"documentElement"in n}function kl(n){return new DOMParser().parseFromString(n,"application/xml")}function WL(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Ln(s,i)}})}function Za(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function WR(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Fe(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function Qe(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function p7(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=fo(i.localName)}y7(t,r,s,a)}}function fo(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return Ed(l,o)})}const Ji=fo();function Ms(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function ut(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Pu(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function gn(n,e,t,r,i){return r.push(n),Pu(e,t,r,i),r.pop()}function y7(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let u=0;u<a;++u)o=t[u],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[u]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function tr(n,e,t,r,i,s,a){return i.push(n),y7(e,t,r,i,s,a),i.pop()}let BS;function kfe(){return BS===void 0&&typeof XMLSerializer<"u"&&(BS=new XMLSerializer),BS}let US;function X0(){return US===void 0&&typeof document<"u"&&(US=document.implementation.createDocument("","",null)),US}class _7 extends f7{constructor(){super(),this.xmlSerializer_=kfe()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=kl(e);return this.readFeatureFromDocument(r,t)}return Cl(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=kl(e);return this.readFeaturesFromDocument(r,t)}return Cl(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Ln(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Ut()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=kl(e);return this.readGeometryFromDocument(r,t)}return Cl(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=kl(e);return this.readProjectionFromDocument(t)}return Cl(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function vu(n){const e=ho(n,!1);return Pfe(e)}function Pfe(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function $w(n){const e=ho(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function bn(n){const e=ho(n,!1);return Mfe(e)}function Mfe(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function Mp(n){const e=ho(n,!1);return Nfe(e)}function Nfe(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function rn(n){return ho(n,!1).trim()}function D0(n,e){kn(n,e?"1":"0")}function Lfe(n,e){n.appendChild(X0().createCDATASection(e))}function Ofe(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+Fg(t.getUTCMonth()+1,2)+"-"+Fg(t.getUTCDate(),2)+"T"+Fg(t.getUTCHours(),2)+":"+Fg(t.getUTCMinutes(),2)+":"+Fg(t.getUTCSeconds(),2)+"Z";n.appendChild(X0().createTextNode(r))}function ws(n,e){const t=e.toPrecision();n.appendChild(X0().createTextNode(t))}function mv(n,e){const t=e.toString();n.appendChild(X0().createTextNode(t))}const Dfe=/^\s/,Ffe=/\s$/,jfe=/(\n|\t|\r|<|&| {2})/;function kn(n,e){typeof e=="string"&&(Dfe.test(e)||Ffe.test(e)||jfe.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),Lfe(n,t)}):n.appendChild(X0().createTextNode(e))}const cr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Vfe="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",Gfe={rte:x7,trk:v7,wpt:w7},Bfe=ut(cr,{rte:Za(x7),trk:Za(v7),wpt:Za(w7)}),Ufe=ut(cr,{text:Fe(rn,"linkText"),type:Fe(rn,"linkType")}),zfe=ut(cr,{name:Fe(rn),email:p0e,link:k1}),$fe=ut(cr,{name:Fe(rn),desc:Fe(rn),author:Fe(f0e),copyright:Fe(g0e),link:k1,time:Fe($w),keywords:Fe(rn),bounds:m0e,extensions:Ww}),Wfe=ut(cr,{year:Fe(Mp),license:Fe(rn)}),Hfe=ut(cr,{rte:Qe(v0e),trk:Qe(w0e),wpt:Qe(S0e)});class Kfe extends _7{constructor(e){super(),e=e||{},this.dataProjection=qn("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(kl(e)):Cl(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!cr.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(cr.includes(t.namespaceURI)&&t.localName==="metadata")return gn({},$fe,t,[]);return null}readFeatureFromNode(e,t){if(!cr.includes(e.namespaceURI))return null;const r=Gfe[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!cr.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=gn([],Bfe,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Ed("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",gv),r.setAttributeNS(gv,"xsi:schemaLocation",Vfe),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),tr({node:r},Hfe,d0e,e,[t]),r}}const Yfe=ut(cr,{name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:k1,number:Fe(Mp),extensions:Ww,type:Fe(rn),rtept:y0e}),Xfe=ut(cr,{ele:Fe(bn),time:Fe($w)}),qfe=ut(cr,{name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:k1,number:Fe(Mp),type:Fe(rn),extensions:Ww,trkseg:x0e}),Zfe=ut(cr,{trkpt:_0e}),Qfe=ut(cr,{ele:Fe(bn),time:Fe($w)}),Jfe=ut(cr,{ele:Fe(bn),time:Fe($w),magvar:Fe(bn),geoidheight:Fe(bn),name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:k1,sym:Fe(rn),type:Fe(rn),fix:Fe(rn),sat:Fe(Mp),hdop:Fe(bn),vdop:Fe(bn),pdop:Fe(bn),ageofdgpsdata:Fe(bn),dgpsid:Fe(Mp),extensions:Ww}),e0e=["text","type"],t0e=ut(cr,{text:Qe(kn),type:Qe(kn)}),n0e=ut(cr,["name","cmt","desc","src","link","number","type","rtept"]),r0e=ut(cr,{name:Qe(kn),cmt:Qe(kn),desc:Qe(kn),src:Qe(kn),link:Qe(YR),number:Qe(mv),type:Qe(kn),rtept:p7(Qe(XR))}),i0e=ut(cr,["ele","time"]),s0e=ut(cr,["name","cmt","desc","src","link","number","type","trkseg"]),a0e=ut(cr,{name:Qe(kn),cmt:Qe(kn),desc:Qe(kn),src:Qe(kn),link:Qe(YR),number:Qe(mv),type:Qe(kn),trkseg:p7(Qe(E0e))}),o0e=fo("trkpt"),l0e=ut(cr,{trkpt:Qe(XR)}),c0e=ut(cr,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),u0e=ut(cr,{ele:Qe(ws),time:Qe(Ofe),magvar:Qe(ws),geoidheight:Qe(ws),name:Qe(kn),cmt:Qe(kn),desc:Qe(kn),src:Qe(kn),link:Qe(YR),sym:Qe(kn),type:Qe(kn),fix:Qe(kn),sat:Qe(mv),hdop:Qe(ws),vdop:Qe(ws),pdop:Qe(ws),ageofdgpsdata:Qe(ws),dgpsid:Qe(mv)}),h0e={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function d0e(n,e,t){const r=n.getGeometry();if(r){const i=h0e[r.getType()];if(i){const s=e[e.length-1].node;return Ed(s.namespaceURI,i)}}}function HR(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function KR(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function f0e(n,e){const t=gn({},zfe,n,e);if(t)return t}function g0e(n,e){const t=gn({},Wfe,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function m0e(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function p0e(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function k1(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Pu(Ufe,n,e)}function Ww(n,e){const t=e[e.length-1];t.extensionsNode_=n}function y0e(n,e){const t=gn({},Xfe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;HR(i,s,n,t)}}function _0e(n,e){const t=gn({},Qfe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;HR(i,s,n,t)}}function x0e(n,e){const t=e[e.length-1];Pu(Zfe,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function x7(n,e){const t=e[0],r=gn({flatCoordinates:[],layoutOptions:{}},Yfe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=KR(s,i),o=new na(i,a);uo(o,!1,t);const l=new mi(o);return l.setProperties(r,!0),l}function v7(n,e){const t=e[0],r=gn({flatCoordinates:[],ends:[],layoutOptions:{}},qfe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=KR(a,i,s),l=new Bl(i,o,s);uo(l,!1,t);const u=new mi(l);return u.setProperties(r,!0),u}function w7(n,e){const t=e[0],r=gn({},Jfe,n,e);if(!r)return;const i={},s=HR([],i,n,r),a=KR(i,s),o=new _i(s,a);uo(o,!1,t);const l=new mi(o);return l.setProperties(r,!0),l}function YR(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];tr({node:n},t0e,Ji,s,t,e0e)}function XR(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?i0e[s]:c0e[s],u=Ms(a,l);tr({node:n,properties:a},u0e,Ji,u,t,l)}function v0e(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=uo(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=n0e[o.namespaceURI],u=Ms(i,l);tr(s,r0e,Ji,u,t,l)}function w0e(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=uo(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=s0e[o.namespaceURI],u=Ms(i,l);tr(s,a0e,Ji,u,t,l)}function E0e(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},tr(r,l0e,o0e,e.getCoordinates(),t)}function S0e(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=uo(s,!0,r);i.geometryLayout=a.getLayout(),XR(n,a.getCoordinates(),t)}}const ec=["http://www.google.com/kml/ext/2.2"],bt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],T0e="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",HL={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},b0e=ut(bt,{ExtendedData:D7,Region:F7,MultiGeometry:Fe(N7,"geometry"),LineString:Fe(P7,"geometry"),LinearRing:Fe(M7,"geometry"),Point:Fe(L7,"geometry"),Polygon:Fe(O7,"geometry"),Style:Fe(QR),StyleMap:lge,address:Fe(rn),description:Fe(rn),name:Fe(rn),open:Fe(vu),phoneNumber:Fe(rn),styleUrl:Fe(I7),visibility:Fe(vu)},ut(ec,{MultiTrack:Fe(X0e,"geometry"),Track:Fe(k7,"geometry")})),I0e=ut(bt,{ExtendedData:D7,Region:F7,Link:vge,address:Fe(rn),description:Fe(rn),name:Fe(rn),open:Fe(vu),phoneNumber:Fe(rn),visibility:Fe(vu)}),A0e=ut(bt,{href:Fe(b7)}),R0e=ut(bt,{Altitude:Fe(bn),Longitude:Fe(bn),Latitude:Fe(bn),Tilt:Fe(bn),AltitudeMode:Fe(rn),Heading:Fe(bn),Roll:Fe(bn)}),E7=ut(bt,{LatLonAltBox:fge,Lod:mge}),C0e=ut(bt,["Document","Placemark"]),k0e=ut(bt,{Document:Qe(Rge),Placemark:Qe(G7)});let i0,Z_=null,Ub,Fm,jm,Vm,pv,zb=null,qR,$b=null,Wb,Ih=null,KL=null,Hb=null;function yv(n){return 32/Math.min(n[0],n[1])}function P0e(){i0=[255,255,255,1],Z_=new er({color:i0}),Ub=[20,2],Fm="pixels",jm="pixels",Vm=[64,64],pv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",zb=new Zp({anchor:Ub,anchorOrigin:"bottom-left",anchorXUnits:Fm,anchorYUnits:jm,crossOrigin:"anonymous",rotation:0,scale:yv(Vm),size:Vm,src:pv}),qR="NO_IMAGE",$b=new _r({color:i0,width:1}),Wb=new _r({color:[51,51,51,1],width:2}),Ih=new Go({font:"bold 16px Helvetica",fill:Z_,stroke:Wb,scale:.8}),KL=new En({fill:Z_,image:zb,text:Ih,stroke:$b,zIndex:0}),Hb=[KL]}let m_;function M0e(n){return n}class N0e extends _7{constructor(e){super(),e=e||{},Hb||P0e(),this.dataProjection=qn("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:Hb,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:M0e,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=ut(bt,{Document:WL(this.readDocumentOrFolder_,this),Folder:WL(this.readDocumentOrFolder_,this),Placemark:Za(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=gn([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=gn({geometry:null},b0e,e,t,this);if(!r)return;const i=new mi,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&uo(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,u=r.styleUrl,h=O0e(l,u,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=QR.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=R7.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!bt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!bt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Ln(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=kl(e);return this.readNameFromDocument(t)}return Cl(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(bt.includes(t.namespaceURI)&&t.localName=="name")return rn(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(bt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=kl(e);Ln(t,this.readNetworkLinksFromDocument(r))}else Cl(e)?Ln(t,this.readNetworkLinksFromDocument(e)):Ln(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Ln(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=gn({},I0e,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Ln(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=kl(e);Ln(t,this.readRegionFromDocument(r))}else Cl(e)?Ln(t,this.readRegionFromDocument(e)):Ln(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Ln(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName=="Region"){const i=gn({},E7,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Ln(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=kl(e);Ln(t,this.readCameraFromDocument(r))}else Cl(e)?Ln(t,this.readCameraFromDocument(e)):Ln(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Ln(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=gn({},R0e,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Ln(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Ed(bt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",ec[0]),r.setAttributeNS(i,"xmlns:xsi",gv),r.setAttributeNS(gv,"xsi:schemaLocation",T0e);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=C0e[r.namespaceURI],l=Ms(a,o);return tr(s,k0e,Ji,l,[t],o,this),r}}function L0e(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),u=i.getAnchor();t[0]=l[0]*(o[0]-u[0]),t[1]=l[1]*(o[1]/2-u[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Ih.getFont()),s.setScale(s.getScale()||Ih.getScale()),s.setFill(s.getFill()||Ih.getFill()),s.setStroke(s.getStroke()||Wb)):s=Ih.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new En({image:i,text:s})}function O0e(n,e,t,r,i){return(function(s,a){let o=i,l="",u=[];if(o){const f=s.getGeometry();if(f)if(f instanceof ro)u=f.getGeometriesArrayRecursive().filter(function(g){const y=g.getType();return y==="Point"||y==="MultiPoint"}),o=u.length>0;else{const g=f.getType();o=g==="Point"||g==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(m_||(m_=document.createElement("textarea")),m_.innerHTML=l,l=m_.value));let h=t;if(n?h=n:e&&(h=S7(e,t,r)),o){const f=L0e(h[0],l);if(u.length>0){f.setGeometry(new ro(u));const g=new En({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[f,g].concat(h.slice(1))}return f}return h})}function S7(n,e,t){return Array.isArray(n)?n:typeof n=="string"?S7(t[n],e,t):e}function Hw(n){const e=ho(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function T7(n){let e=ho(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function b7(n){const e=ho(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function I7(n){const e=ho(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function D0e(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:HL[e],y:parseFloat(n.getAttribute("y")),yunits:HL[t],origin:r}}function A7(n){return bn(n)}const F0e=ut(bt,{Pair:oge});function R7(n,e){return gn(void 0,F0e,n,e,this)}const j0e=ut(bt,{Icon:Fe(Q0e),color:Fe(Hw),heading:Fe(bn),hotSpot:Fe(D0e),scale:Fe(A7)});function V0e(n,e){const t=gn({},j0e,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=pv);let l,u,h,f="bottom-left";const g=t.hotSpot;g?(l=[g.x,g.y],u=g.xunits,h=g.yunits,f=g.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=Ub,u=Fm,h=jm):a.includes("arrow-reverse")?(l=[54,42],u=Fm,h=jm):a.includes("paddle")&&(l=[32,1],u=Fm,h=jm));let y;const v=i.x,x=i.y;v!==void 0&&x!==void 0&&(y=[v,x]);let E;const T=i.w,b=i.h;T!==void 0&&b!==void 0&&(E=[T,b]);let I;const M=t.heading;M!==void 0&&(I=Nl(M));const F=t.scale,G=t.color;if(s){a==pv&&(E=Vm);const R=new Zp({anchor:l,anchorOrigin:f,anchorXUnits:u,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:I,scale:F,size:E,src:this.iconUrlFunction_(a),color:G}),C=R.getScaleArray()[0],P=R.getSize();if(P===null){const N=R.getImageState();if(N===vt.IDLE||N===vt.LOADING){const O=function(){const z=R.getImageState();if(!(z===vt.IDLE||z===vt.LOADING)){const j=R.getSize();if(j&&j.length==2){const be=yv(j);R.setScale(C*be)}R.unlistenImageChange(O)}};R.listenImageChange(O),N===vt.IDLE&&R.load()}}else if(P.length==2){const N=yv(P);R.setScale(C*N)}r.imageStyle=R}else r.imageStyle=qR}const G0e=ut(bt,{color:Fe(Hw),scale:Fe(A7)});function B0e(n,e){const t=gn({},G0e,n,e);if(!t)return;const r=e[e.length-1],i=new Go({fill:new er({color:"color"in t?t.color:i0}),scale:t.scale});r.textStyle=i}const U0e=ut(bt,{color:Fe(Hw),width:Fe(bn)});function z0e(n,e){const t=gn({},U0e,n,e);if(!t)return;const r=e[e.length-1],i=new _r({color:"color"in t?t.color:i0,width:"width"in t?t.width:1});r.strokeStyle=i}const $0e=ut(bt,{color:Fe(Hw),fill:Fe(vu),outline:Fe(vu)});function W0e(n,e){const t=gn({},$0e,n,e);if(!t)return;const r=e[e.length-1],i=new er({color:"color"in t?t.color:i0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const H0e=ut(bt,{coordinates:WR(T7)});function C7(n,e){return gn(null,H0e,n,e)}function K0e(n,e){const r=e[e.length-1].coordinates,i=ho(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),u=parseFloat(a[3]);r.push([o,l,u])}else r.push([])}const Y0e=ut(ec,{Track:Za(k7)});function X0e(n,e){const t=gn([],Y0e,n,e);if(t)return new Bl(t)}const q0e=ut(bt,{when:wge},ut(ec,{coord:K0e}));function k7(n,e){const t=gn({coordinates:[],whens:[]},q0e,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new na(r,"XYZM")}const Z0e=ut(bt,{href:Fe(b7)},ut(ec,{x:Fe(bn),y:Fe(bn),w:Fe(bn),h:Fe(bn)}));function Q0e(n,e){const t=gn({},Z0e,n,e);return t||null}const J0e=ut(bt,{coordinates:WR(T7)});function ZR(n,e){return gn(null,J0e,n,e)}const Kw=ut(bt,{extrude:Fe(vu),tessellate:Fe(vu),altitudeMode:Fe(rn)});function P7(n,e){const t=gn({},Kw,n,e),r=ZR(n,e);if(r){const i=new na(r,"XYZ");return i.setProperties(t,!0),i}}function M7(n,e){const t=gn({},Kw,n,e),r=ZR(n,e);if(r){const i=new Pa(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const ege=ut(bt,{LineString:Za(P7),LinearRing:Za(M7),MultiGeometry:Za(N7),Point:Za(L7),Polygon:Za(O7)});function N7(n,e){const t=gn([],ege,n,e);if(!t)return null;if(t.length===0)return new ro(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const u=t[0];o=u.getLayout(),l=u.getFlatCoordinates();for(let h=1,f=t.length;h<f;++h)a=t[h],Ln(l,a.getFlatCoordinates());r=new dd(l,o),zS(r,t)}else if(s=="LineString")r=new Bl(t),zS(r,t);else if(s=="Polygon")r=new Uh(t),zS(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new ro(t);else throw new Error("Unknown geometry type found")}else r=new ro(t);return r}function L7(n,e){const t=gn({},Kw,n,e),r=ZR(n,e);if(r){const i=new _i(r,"XYZ");return i.setProperties(t,!0),i}}const tge=ut(bt,{innerBoundaryIs:yge,outerBoundaryIs:xge});function O7(n,e){const t=gn({},Kw,n,e),r=gn([null],tge,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Ln(i,r[o]),s.push(i.length);const a=new Pa(i,"XYZ",s);return a.setProperties(t,!0),a}}const nge=ut(bt,{IconStyle:V0e,LabelStyle:B0e,LineStyle:z0e,PolyStyle:W0e});function QR(n,e){const t=gn({},nge,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:Z_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=qR&&(s=t.imageStyle):s=zb;const a="textStyle"in t?t.textStyle:Ih,o="strokeStyle"in t?t.strokeStyle:$b,l=t.outline;return l!==void 0&&!l?[new En({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new ro(g.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(f!=="Polygon"&&f!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new En({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new ro(g.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(f==="Polygon"||f==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new En({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function zS(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let u=0;u<t;++u){const h=e[u];r[u]=h.get("extrude"),i[u]=h.get("tessellate"),s[u]=h.get("altitudeMode"),a=a||r[u]!==void 0,o=o||i[u]!==void 0,l=l||s[u]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const rge=ut(bt,{displayName:Fe(rn),value:Fe(rn)});function ige(n,e){const t=n.getAttribute("name");Pu(rge,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const sge=ut(bt,{Data:ige,SchemaData:uge});function D7(n,e){Pu(sge,n,e)}function F7(n,e){Pu(E7,n,e)}const age=ut(bt,{Style:Fe(QR),key:Fe(rn),styleUrl:Fe(I7)});function oge(n,e){const t=gn({},age,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function lge(n,e){const t=R7.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const cge=ut(bt,{SimpleData:hge});function uge(n,e){Pu(cge,n,e)}function hge(n,e){const t=n.getAttribute("name");if(t!==null){const r=rn(n),i=e[e.length-1];i[t]=r}}const dge=ut(bt,{altitudeMode:Fe(rn),minAltitude:Fe(bn),maxAltitude:Fe(bn),north:Fe(bn),south:Fe(bn),east:Fe(bn),west:Fe(bn)});function fge(n,e){const t=gn({},dge,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const gge=ut(bt,{minLodPixels:Fe(bn),maxLodPixels:Fe(bn),minFadeExtent:Fe(bn),maxFadeExtent:Fe(bn)});function mge(n,e){const t=gn({},gge,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const pge=ut(bt,{LinearRing:Za(C7)});function yge(n,e){const t=gn([],pge,n,e);t.length>0&&e[e.length-1].push(...t)}const _ge=ut(bt,{LinearRing:WR(C7)});function xge(n,e){const t=gn(void 0,_ge,n,e);if(t){const r=e[e.length-1];r[0]=t}}function vge(n,e){Pu(A0e,n,e)}function wge(n,e){const r=e[e.length-1].whens,i=ho(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function Yw(n,e){const t=Bh(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}kn(n,i.join(""))}function Ege(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let u=1;u<a;++u)l+=","+e[u];for(let u=s;u<o;u+=s){l+=" "+e[u];for(let h=1;h<a;++h)l+=","+e[u+h]}}kn(n,l)}const Q_=ut(bt,{Data:Qe(Sge),value:Qe(bge),displayName:Qe(Tge)});function Sge(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&tr(r,Q_,Ji,[i.displayName],t,["displayName"]),i!==null&&i.value&&tr(r,Q_,Ji,[i.value],t,["value"])):tr(r,Q_,Ji,[i],t,["value"])}function Tge(n,e){kn(n,e)}function bge(n,e){kn(n,e)}const Ige=ut(bt,{Placemark:Qe(G7)}),Age=function(n,e,t){const r=e[e.length-1].node;return Ed(r.namespaceURI,"Placemark")};function Rge(n,e,t){tr({node:n},Ige,Age,e,t,void 0,this)}const Cge=fo("Data");function kge(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)tr(r,Q_,Cge,[{name:i[o],value:s[o]}],t)}const YL=ut(bt,["href"],ut(ec,["x","y","w","h"])),XL=ut(bt,{href:Qe(kn)},ut(ec,{x:Qe(ws),y:Qe(ws),w:Qe(ws),h:Qe(ws)})),Pge=function(n,e,t){return Ed(ec[0],"gx:"+t)};function Mge(n,e,t){const r={node:n},i=t[t.length-1].node;let s=YL[i.namespaceURI],a=Ms(e,s);tr(r,XL,Ji,a,t,s),s=YL[ec[0]],a=Ms(e,s),tr(r,XL,Pge,a,t,s)}const Nge=ut(bt,["scale","heading","Icon","color","hotSpot"]),Lge=ut(bt,{Icon:Qe(Mge),color:Qe(Yw),heading:Qe(ws),hotSpot:Qe(ome),scale:Qe(U7)});function Oge(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const E=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),E&&(E[0]!==a[0]/2||E[1]!==a[1]/2)){const b={x:E[0],xunits:"pixels",y:a[1]-E[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let u=e.getScaleArray()[0],h=a;if(h===null&&(h=Vm),h.length==2){const E=yv(h);u=u/E}u!==1&&(i.scale=u);const f=e.getRotation();f!==0&&(i.heading=f);const g=e.getColor();g&&(i.color=g);const y=t[t.length-1].node,v=Nge[y.namespaceURI],x=Ms(i,v);tr(r,Lge,Ji,x,t,v)}const Dge=ut(bt,["color","scale"]),Fge=ut(bt,{color:Qe(Yw),scale:Qe(U7)});function jge(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=Dge[o.namespaceURI],u=Ms(i,l);tr(r,Fge,Ji,u,t,l)}const Vge=ut(bt,["color","width"]),Gge=ut(bt,{color:Qe(Yw),width:Qe(ws)});function Bge(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=Vge[s.namespaceURI],o=Ms(i,a);tr(r,Gge,Ji,o,t,a)}const Uge={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},j7=function(n,e,t){if(n){const r=e[e.length-1].node;return Ed(r.namespaceURI,Uge[n.getType()])}},zge=fo("Point"),$ge=fo("LineString"),Wge=fo("LinearRing"),Hge=fo("Polygon"),Kge=ut(bt,{LineString:Qe(s0),Point:Qe(s0),Polygon:Qe(B7),GeometryCollection:Qe(V7)});function V7(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=j7;else if(i==="MultiPoint")s=e.getPoints(),a=zge;else if(i==="MultiLineString")s=e.getLineStrings(),a=$ge;else if(i==="MultiPolygon")s=e.getPolygons(),a=Hge;else throw new Error("Unknown geometry type");tr(r,Kge,a,s,t)}const Yge=ut(bt,{LinearRing:Qe(s0)});function qL(n,e,t){tr({node:n},Yge,Wge,[e],t)}const $S=ut(bt,{ExtendedData:Qe(kge),MultiGeometry:Qe(V7),LineString:Qe(s0),LinearRing:Qe(s0),Point:Qe(s0),Polygon:Qe(B7),Style:Qe(ame),address:Qe(kn),description:Qe(kn),name:Qe(kn),open:Qe(D0),phoneNumber:Qe(kn),styleUrl:Qe(kn),visibility:Qe(D0)}),Xge=ut(bt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),qge=fo("ExtendedData");function G7(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const v=Array.isArray(y)?y:[y];let x=v;if(e.getGeometry()&&(x=v.filter(function(E){const T=E.getGeometryFunction()(e);if(T){const b=T.getType();return b==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(I){const M=I.getType();return M==="Point"||M==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let E=v,T=v;e.getGeometry()&&(E=v.filter(function(b){const I=b.getGeometryFunction()(e);if(I){const M=I.getType();return M==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(F){const G=F.getType();return G==="LineString"||G==="MultiLineString"}).length:M==="LineString"||M==="MultiLineString"}}),T=v.filter(function(b){const I=b.getGeometryFunction()(e);if(I){const M=I.getType();return M==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(F){const G=F.getType();return G==="Polygon"||G==="MultiPolygon"}).length:M==="Polygon"||M==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:E,polyStyles:T}}if(x.length&&i.name===void 0){const E=x[0].getText();E&&(i.name=E.getText())}}}const l=t[t.length-1].node,u=Xge[l.namespaceURI],h=Ms(i,u);if(tr(r,$S,Ji,h,t,u),a.length>0){const y=Ms(i,a);tr(r,$S,qge,[{names:a,values:y}],t)}const f=t[0];let g=e.getGeometry();g&&(g=uo(g,!0,f)),tr(r,$S,j7,[g],t)}const Zge=ut(bt,["extrude","tessellate","altitudeMode","coordinates"]),Qge=ut(bt,{extrude:Qe(D0),tessellate:Qe(D0),altitudeMode:Qe(kn),coordinates:Qe(Ege)});function s0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=Zge[a.namespaceURI],l=Ms(s,o);tr(i,Qge,Ji,l,t,o)}const Jge=ut(bt,["color","fill","outline"]),ZL=ut(bt,{outerBoundaryIs:Qe(qL),innerBoundaryIs:Qe(qL)}),eme=fo("innerBoundaryIs"),tme=fo("outerBoundaryIs");function B7(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};tr(s,ZL,eme,r,t),tr(s,ZL,tme,[i],t)}const nme=ut(bt,{color:Qe(Yw),fill:Qe(D0),outline:Qe(D0)});function rme(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=Jge[o.namespaceURI],u=Ms(a,l);tr(r,nme,Ji,u,t,l)}function U7(n,e){ws(n,Math.round(e*1e6)/1e6)}const ime=ut(bt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),sme=ut(bt,{IconStyle:Qe(Oge),LabelStyle:Qe(jge),LineStyle:Qe(Bge),PolyStyle:Qe(rme)});function ame(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const u=e.pointStyles[0].getImage();u&&typeof u.getSrc=="function"&&(i.IconStyle=u)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=ime[s.namespaceURI],o=Ms(i,a);tr(r,sme,Ji,o,t,a)}function ome(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function z7(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!b_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),sx(new Gv({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=b_(s);for(i=0;i<t;++i){const o=e[i],l=b_(o);if(!I_(s,o))if(n.defs[s]===n.defs[o])lT([a,l]);else{const u=n(s,o);NU(a,l,ZP(a,l,u.forward),ZP(l,a,u.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");wn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");z7(wn);let Ah=null,Gm=null,Nf=null;function Kb(n){Ah&&(n.removeLayer(Ah),Ah=null),Gm&&(n.removeLayer(Gm),Gm=null),Nf=null}async function lme(n,e){try{const t=vn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=wn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;Kb(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,u=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(u),!h.ok)return console.error("WFS request failed:",h.status),!1;const f=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(f).substring(0,500)),!f.features||f.features.length===0)return console.log("No parcel found at location"),!1;const g=f.features[0];console.log(" PARCEL ID:",g.id||g.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(g.bbox||"geen bbox"));const v=new zR().readFeature(g,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=v.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const E=g.properties||{};console.log(` Parcel: ${E.category||"unknown"} - ${E.gewasnaam||E.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(P=>P.toFixed(0)).join(", ")}`);const T=x.getExtent(),b=T[2]-T[0],I=T[3]-T[1],M=Math.max(b,I)*.05,F=[T[0]-M,T[1]-M,T[2]+M,T[3]+M],G=Math.max(b,I)*.3,R=[T[0]-G,T[1]-G,T[2]+G,T[3]+G];Nf=x,Ah=new AW({source:new eH({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:F,zIndex:998}),Ah.on("prerender",P=>{if(!Nf)return;const N=P.context;if(!N)return;const O=P.frameState;if(!O)return;N.save(),N.beginPath(),(Nf.getType()==="Polygon"?Nf.getCoordinates()[0]:Nf.getCoordinates()[0][0]).forEach((j,be)=>{const Pe=n.getPixelFromCoordinate(j);if(!Pe)return;const je=O.pixelRatio,Ne=Pe[0]*je,ue=Pe[1]*je;be===0?N.moveTo(Ne,ue):N.lineTo(Ne,ue)}),N.closePath(),N.clip()}),Ah.on("postrender",P=>{const N=P.context;N&&N.restore()}),n.addLayer(Ah);const C=new fd({features:[v]});return Gm=new md({source:C,style:new En({fill:new er({color:"rgba(0, 0, 0, 0)"}),stroke:new _r({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(Gm),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var _v={};_v.version="0.18.5";var $7=1252,cme=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],W7=function(n){cme.indexOf(n)!=-1&&($7=n)};function ume(){W7(1252)}var Np=function(n){W7(n)};function hme(){Np(1200),ume()}var p_=function(e){return String.fromCharCode(e)},QL=function(e){return String.fromCharCode(e)},xv,Qc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Lp(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,u=0;u<n.length;)t=n.charCodeAt(u++),s=t>>2,r=n.charCodeAt(u++),a=(t&3)<<4|r>>4,i=n.charCodeAt(u++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=Qc.charAt(s)+Qc.charAt(a)+Qc.charAt(o)+Qc.charAt(l);return e}function Yl(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<n.length;)s=Qc.indexOf(n.charAt(u++)),a=Qc.indexOf(n.charAt(u++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Qc.indexOf(n.charAt(u++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=Qc.indexOf(n.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Cn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),tc=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function sd(n){return Cn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function JL(n){return Cn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Qa=function(e){return Cn?tc(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Xw(n){if(typeof ArrayBuffer>"u")return Qa(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function P1(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function dme(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Pi=Cn?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:tc(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function fme(n){for(var e=[],t=0,r=n.length+250,i=sd(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=sd(65535),r=65530)}return e.push(i.slice(0,t)),Pi(e)}var Bm=/\u0000/g,y_=/[\u0001-\u0006]/g;function a0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function to(n,e){var t=""+n;return t.length>=e?t:Pr("0",e-t.length)+t}function JR(n,e){var t=""+n;return t.length>=e?t:Pr(" ",e-t.length)+t}function vv(n,e){var t=""+n;return t.length>=e?t:t+Pr(" ",e-t.length)}function gme(n,e){var t=""+Math.round(n);return t.length>=e?t:Pr("0",e-t.length)+t}function mme(n,e){var t=""+n;return t.length>=e?t:Pr("0",e-t.length)+t}var eO=Math.pow(2,32);function xf(n,e){if(n>eO||n<-eO)return gme(n,e);var t=Math.round(n);return mme(t,e)}function wv(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var tO=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],WS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function pme(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Nr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},nO={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yme={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ev(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,u=0,h=0,f=Math.floor(i);u<e&&(f=Math.floor(i),o=f*a+s,h=f*u+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=u,u=h;if(h>e&&(u>e?(h=l,o=s):(h=u,o=a)),!t)return[0,r*o,h];var g=Math.floor(r*o/h);return[g,r*o-g*h,h]}function __(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=Tme(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var H7=new Date(1899,11,31,0,0,0),_me=H7.getTime(),xme=new Date(1900,2,1,0,0,0);function K7(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=xme&&(t+=1440*60*1e3),(t-(_me+(n.getTimezoneOffset()-H7.getTimezoneOffset())*6e4))/(1440*60*1e3)}function eC(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vme(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function wme(n){var e=n<0?12:11,t=eC(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function Eme(n){var e=eC(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function Sme(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=wme(n):e===10?t=n.toFixed(10).substr(0,12):t=Eme(n),eC(vme(t.toUpperCase()))}function Yb(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Sme(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return wu(14,K7(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Tme(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function bme(n,e,t,r){var i="",s=0,a=0,o=t.y,l,u=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,u=e.length;break;case 3:return WS[t.m-1][1];case 5:return WS[t.m-1][0];default:return WS[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,u=e.length;break;case 3:return tO[t.q][0];default:return tO[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?to(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=to(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var h=u>0?to(l,u):"";return h}function Jc(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var Y7=/%/g;function Ime(n,e,t){var r=e.replace(Y7,""),i=e.length-r.length;return jl(n,r,t*Math.pow(10,2*i))+Pr("%",i)}function Ame(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return jl(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function X7(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+X7(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var q7=/# (\?+)( ?)\/( ?)(\d+)/;function Rme(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Pr(" ",n[1].length+1+n[4].length):JR(a,n[1].length)+n[2]+"/"+n[3]+to(o,n[4].length))}function Cme(n,e,t){return t+(e===0?"":""+e)+Pr(" ",n[1].length+2+n[4].length)}var Z7=/^#*0*\.([0#]+)/,Q7=/\).*[0#]/,J7=/\(###\) ###\\?-####/;function ss(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function rO(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function iO(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function kme(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function Pme(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function _a(n,e,t){if(n.charCodeAt(0)===40&&!e.match(Q7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?_a("n",r,t):"("+_a("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Ame(n,e,t);if(e.indexOf("%")!==-1)return Ime(n,e,t);if(e.indexOf("E")!==-1)return X7(e,t);if(e.charCodeAt(0)===36)return"$"+_a(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+xf(l,e.length);if(e.match(/^[#?]+$/))return i=xf(t,0),i==="0"&&(i=""),i.length>e.length?i:ss(e.substr(0,e.length-i.length))+i;if(s=e.match(q7))return Rme(s,l,u);if(e.match(/^#+0+$/))return u+xf(l,e.length-e.indexOf("0"));if(s=e.match(Z7))return i=rO(t,s[1].length).replace(/^([^\.]+)$/,"$1."+ss(s[1])).replace(/\.$/,"."+ss(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Pr("0",ss(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+rO(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Jc(xf(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+_a(n,e,-t):Jc(""+(Math.floor(t)+kme(t,s[1].length)))+"."+to(iO(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return _a(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=a0(_a(n,e.replace(/[\\-]/g,""),t)),a=0,a0(a0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(J7))return i=_a(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ev(l,Math.pow(10,a)-1,!1),i=""+u,h=jl("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=vv(o[2],a),h.length<s[4].length&&(h=ss(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ev(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?JR(o[1],a)+s[2]+"/"+s[3]+vv(o[2],a):Pr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=xf(t,0),e.length<=i.length?i:ss(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return ss(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=iO(t,s[1].length),t<0?"-"+_a(n,e,-t):Jc(Pme(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?to(0,3-v.length):"")+v})+"."+to(a,s[1].length);switch(e){case"###,##0.00":return _a(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=Jc(xf(l,0));return y!=="0"?u+y:"";case"###,###.00":return _a(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return _a(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Mme(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return jl(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function Nme(n,e,t){var r=e.replace(Y7,""),i=e.length-r.length;return jl(n,r,t*Math.pow(10,2*i))+Pr("%",i)}function eV(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+eV(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Po(n,e,t){if(n.charCodeAt(0)===40&&!e.match(Q7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Po("n",r,t):"("+Po("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Mme(n,e,t);if(e.indexOf("%")!==-1)return Nme(n,e,t);if(e.indexOf("E")!==-1)return eV(e,t);if(e.charCodeAt(0)===36)return"$"+Po(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+to(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:ss(e.substr(0,e.length-i.length))+i;if(s=e.match(q7))return Cme(s,l,u);if(e.match(/^#+0+$/))return u+to(l,e.length-e.indexOf("0"));if(s=e.match(Z7))return i=(""+t).replace(/^([^\.]+)$/,"$1."+ss(s[1])).replace(/\.$/,"."+ss(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Pr("0",ss(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Jc(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Po(n,e,-t):Jc(""+t)+"."+Pr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Po(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=a0(Po(n,e.replace(/[\\-]/g,""),t)),a=0,a0(a0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(J7))return i=Po(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ev(l,Math.pow(10,a)-1,!1),i=""+u,h=jl("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=vv(o[2],a),h.length<s[4].length&&(h=ss(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ev(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?JR(o[1],a)+s[2]+"/"+s[3]+vv(o[2],a):Pr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:ss(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return ss(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Po(n,e,-t):Jc(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?to(0,3-v.length):"")+v})+"."+to(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=Jc(""+l);return y!=="0"?u+y:"";default:if(e.match(/\.[0#?]*$/))return Po(n,e.slice(0,e.lastIndexOf(".")),t)+ss(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function jl(n,e,t){return(t|0)===t?Po(n,e,t):_a(n,e,t)}function Lme(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var tV=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nV(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":wv(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(tV))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Ome(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",u,h,f,g="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!wv(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),v=y==="("||y===")"?y:"t";i[i.length]={t:v,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(u==null&&(u=__(e,t,n.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=__(e,t),u==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=__(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):n.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(tV)){if(u==null&&(u=__(e,t),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",nV(n)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",E<1&&(E=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var I="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=bme(i[a].t.charCodeAt(0),i[a].v,u,T),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;I+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=Yb(e,t);break}var F="",G,R;if(I.length>0){I.charCodeAt(0)==40?(G=e<0&&I.charCodeAt(0)===45?-e:e,R=jl("n",I,G)):(G=e<0&&r>1?-e:e,R=jl("n",I,G),G<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),M=R.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var P=i.length;if(C===i.length&&R.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=R.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=R.substr(0,M+1),M=-1),i[a].t="t",P=a);M>=0&&P<i.length&&(i[P].v=R.substr(0,M+1)+i[P].v)}else if(C!==i.length&&R.indexOf("E")===-1){for(M=R.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,F=i[a].v.substr(h+1);h>=0;--h)M>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(F=R.charAt(M--)+F);i[a].v=F,i[a].t="t",P=a}for(M>=0&&P<i.length&&(i[P].v=R.substr(0,M+1)+i[P].v),M=R.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,F=i[a].v.substr(0,h);h<i[a].v.length;++h)M<R.length&&(F+=R.charAt(M++));i[a].v=F,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(G=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=jl(i[a].t,i[a].v,G),i[a].t="t");var N="";for(a=0;a!==i.length;++a)i[a]!=null&&(N+=i[a].v);return N}var sO=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function aO(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function Dme(n,e){var t=Lme(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(sO),o=t[1].match(sO);return aO(e,a)?[r,t[0]]:aO(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function wu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Nr)[n],r==null&&(r=t.table&&t.table[nO[n]]||Nr[nO[n]]),r==null&&(r=yme[n]||"General");break}if(wv(r,0))return Yb(e,t);e instanceof Date&&(e=K7(e,t.date1904));var i=Dme(r,e);if(wv(i[1]))return Yb(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Ome(i[1],e,t,i[0])}function rV(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Nr[t]==null){e<0&&(e=t);continue}if(Nr[t]==n){e=t;break}}e<0&&(e=391)}return Nr[e]=n,e}function qw(n){for(var e=0;e!=392;++e)n[e]!==void 0&&rV(n[e],e)}function Zw(){Nr=pme()}var iV=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Fme(n){var e=typeof n=="number"?Nr[n]:n;return e=e.replace(iV,"(\\d+)"),new RegExp("^"+e+"$")}function jme(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(iV)||[]).forEach(function(f,g){var y=parseInt(t[g+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:r==-1&&i==-1&&s==-1?h:u+"T"+h}var Vme=(function(){var n={};n.version="1.2.0";function e(){for(var R=0,C=new Array(256),P=0;P!=256;++P)R=P,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,C[P]=R;return typeof Int32Array<"u"?new Int32Array(C):C}var t=e();function r(R){var C=0,P=0,N=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)O[N]=R[N];for(N=0;N!=256;++N)for(P=R[N],C=256+N;C<4096;C+=256)P=O[C]=P>>>8^R[P&255];var z=[];for(N=1;N!=16;++N)z[N-1]=typeof Int32Array<"u"?O.subarray(N*256,N*256+256):O.slice(N*256,N*256+256);return z}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],h=i[5],f=i[6],g=i[7],y=i[8],v=i[9],x=i[10],E=i[11],T=i[12],b=i[13],I=i[14];function M(R,C){for(var P=C^-1,N=0,O=R.length;N<O;)P=P>>>8^t[(P^R.charCodeAt(N++))&255];return~P}function F(R,C){for(var P=C^-1,N=R.length-15,O=0;O<N;)P=I[R[O++]^P&255]^b[R[O++]^P>>8&255]^T[R[O++]^P>>16&255]^E[R[O++]^P>>>24]^x[R[O++]]^v[R[O++]]^y[R[O++]]^g[R[O++]]^f[R[O++]]^h[R[O++]]^u[R[O++]]^l[R[O++]]^o[R[O++]]^a[R[O++]]^s[R[O++]]^t[R[O++]];for(N+=15;O<N;)P=P>>>8^t[(P^R[O++])&255];return~P}function G(R,C){for(var P=C^-1,N=0,O=R.length,z=0,j=0;N<O;)z=R.charCodeAt(N++),z<128?P=P>>>8^t[(P^z)&255]:z<2048?(P=P>>>8^t[(P^(192|z>>6&31))&255],P=P>>>8^t[(P^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,j=R.charCodeAt(N++)&1023,P=P>>>8^t[(P^(240|z>>8&7))&255],P=P>>>8^t[(P^(128|z>>2&63))&255],P=P>>>8^t[(P^(128|j>>6&15|(z&3)<<4))&255],P=P>>>8^t[(P^(128|j&63))&255]):(P=P>>>8^t[(P^(224|z>>12&15))&255],P=P>>>8^t[(P^(128|z>>6&63))&255],P=P>>>8^t[(P^(128|z&63))&255]);return~P}return n.table=t,n.bstr=M,n.buf=F,n.str=G,n})(),Xn=(function(){var e={};e.version="1.2.1";function t(U,Z){for(var K=U.split("/"),Y=Z.split("/"),J=0,te=0,xe=Math.min(K.length,Y.length);J<xe;++J){if(te=K[J].length-Y[J].length)return te;if(K[J]!=Y[J])return K[J]<Y[J]?-1:1}return K.length-Y.length}function r(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:r(U.slice(0,-1));var Z=U.lastIndexOf("/");return Z===-1?U:U.slice(0,Z+1)}function i(U){if(U.charAt(U.length-1)=="/")return i(U.slice(0,-1));var Z=U.lastIndexOf("/");return Z===-1?U:U.slice(Z+1)}function s(U,Z){typeof Z=="string"&&(Z=new Date(Z));var K=Z.getHours();K=K<<6|Z.getMinutes(),K=K<<5|Z.getSeconds()>>>1,U.write_shift(2,K);var Y=Z.getFullYear()-1980;Y=Y<<4|Z.getMonth()+1,Y=Y<<5|Z.getDate(),U.write_shift(2,Y)}function a(U){var Z=U.read_shift(2)&65535,K=U.read_shift(2)&65535,Y=new Date,J=K&31;K>>>=5;var te=K&15;K>>>=4,Y.setMilliseconds(0),Y.setFullYear(K+1980),Y.setMonth(te-1),Y.setDate(J);var xe=Z&31;Z>>>=5;var ke=Z&63;return Z>>>=6,Y.setHours(Z),Y.setMinutes(ke),Y.setSeconds(xe<<1),Y}function o(U){Hs(U,0);for(var Z={},K=0;U.l<=U.length-4;){var Y=U.read_shift(2),J=U.read_shift(2),te=U.l+J,xe={};switch(Y){case 21589:K=U.read_shift(1),K&1&&(xe.mtime=U.read_shift(4)),J>5&&(K&2&&(xe.atime=U.read_shift(4)),K&4&&(xe.ctime=U.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}U.l=te,Z[Y]=xe}return Z}var l;function u(){return l||(l={})}function h(U,Z){if(U[0]==80&&U[1]==75)return q(U,Z);if((U[0]|32)==109&&(U[1]|32)==105)return St(U,Z);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var K=3,Y=512,J=0,te=0,xe=0,ke=0,ye=0,we=[],Se=U.slice(0,512);Hs(Se,0);var Ke=f(Se);switch(K=Ke[0],K){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ke[1]==0)return q(U,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Y!==512&&(Se=U.slice(0,Y),Hs(Se,28));var tt=U.slice(0,Y);g(Se,K);var gt=Se.read_shift(4,"i");if(K===3&&gt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+gt);Se.l+=4,xe=Se.read_shift(4,"i"),Se.l+=4,Se.chk("00100000","Mini Stream Cutoff Size: "),ke=Se.read_shift(4,"i"),J=Se.read_shift(4,"i"),ye=Se.read_shift(4,"i"),te=Se.read_shift(4,"i");for(var Ye=-1,Xe=0;Xe<109&&(Ye=Se.read_shift(4,"i"),!(Ye<0));++Xe)we[Xe]=Ye;var $t=y(U,Y);E(ye,te,$t,Y,we);var Nn=b($t,xe,we,Y);Nn[xe].name="!Directory",J>0&&ke!==j&&(Nn[ke].name="!MiniFAT"),Nn[we[0]].name="!FAT",Nn.fat_addrs=we,Nn.ssz=Y;var Vn={},gr=[],La=[],la=[];I(xe,Nn,$t,gr,J,Vn,La,ke),v(La,la,gr),gr.shift();var Ds={FileIndex:La,FullPaths:la};return Z&&Z.raw&&(Ds.raw={header:tt,sectors:$t}),Ds}function f(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(be,"Header Signature: "),U.l+=16;var Z=U.read_shift(2,"u");return[U.read_shift(2,"u"),Z]}function g(U,Z){var K=9;switch(U.l+=2,K=U.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function y(U,Z){for(var K=Math.ceil(U.length/Z)-1,Y=[],J=1;J<K;++J)Y[J-1]=U.slice(J*Z,(J+1)*Z);return Y[K-1]=U.slice(K*Z),Y}function v(U,Z,K){for(var Y=0,J=0,te=0,xe=0,ke=0,ye=K.length,we=[],Se=[];Y<ye;++Y)we[Y]=Se[Y]=Y,Z[Y]=K[Y];for(;ke<Se.length;++ke)Y=Se[ke],J=U[Y].L,te=U[Y].R,xe=U[Y].C,we[Y]===Y&&(J!==-1&&we[J]!==J&&(we[Y]=we[J]),te!==-1&&we[te]!==te&&(we[Y]=we[te])),xe!==-1&&(we[xe]=Y),J!==-1&&Y!=we[Y]&&(we[J]=we[Y],Se.lastIndexOf(J)<ke&&Se.push(J)),te!==-1&&Y!=we[Y]&&(we[te]=we[Y],Se.lastIndexOf(te)<ke&&Se.push(te));for(Y=1;Y<ye;++Y)we[Y]===Y&&(te!==-1&&we[te]!==te?we[Y]=we[te]:J!==-1&&we[J]!==J&&(we[Y]=we[J]));for(Y=1;Y<ye;++Y)if(U[Y].type!==0){if(ke=Y,ke!=we[ke])do ke=we[ke],Z[Y]=Z[ke]+"/"+Z[Y];while(ke!==0&&we[ke]!==-1&&ke!=we[ke]);we[Y]=-1}for(Z[0]+="/",Y=1;Y<ye;++Y)U[Y].type!==2&&(Z[Y]+="/")}function x(U,Z,K){for(var Y=U.start,J=U.size,te=[],xe=Y;K&&J>0&&xe>=0;)te.push(Z.slice(xe*z,xe*z+z)),J-=z,xe=_h(K,xe*4);return te.length===0?Ce(0):Pi(te).slice(0,U.size)}function E(U,Z,K,Y,J){var te=j;if(U===j){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var xe=K[U],ke=(Y>>>2)-1;if(!xe)return;for(var ye=0;ye<ke&&(te=_h(xe,ye*4))!==j;++ye)J.push(te);E(_h(xe,Y-4),Z-1,K,Y,J)}}function T(U,Z,K,Y,J){var te=[],xe=[];J||(J=[]);var ke=Y-1,ye=0,we=0;for(ye=Z;ye>=0;){J[ye]=!0,te[te.length]=ye,xe.push(U[ye]);var Se=K[Math.floor(ye*4/Y)];if(we=ye*4&ke,Y<4+we)throw new Error("FAT boundary crossed: "+ye+" 4 "+Y);if(!U[Se])break;ye=_h(U[Se],we)}return{nodes:te,data:gO([xe])}}function b(U,Z,K,Y){var J=U.length,te=[],xe=[],ke=[],ye=[],we=Y-1,Se=0,Ke=0,tt=0,gt=0;for(Se=0;Se<J;++Se)if(ke=[],tt=Se+Z,tt>=J&&(tt-=J),!xe[tt]){ye=[];var Ye=[];for(Ke=tt;Ke>=0;){Ye[Ke]=!0,xe[Ke]=!0,ke[ke.length]=Ke,ye.push(U[Ke]);var Xe=K[Math.floor(Ke*4/Y)];if(gt=Ke*4&we,Y<4+gt)throw new Error("FAT boundary crossed: "+Ke+" 4 "+Y);if(!U[Xe]||(Ke=_h(U[Xe],gt),Ye[Ke]))break}te[tt]={nodes:ke,data:gO([ye])}}return te}function I(U,Z,K,Y,J,te,xe,ke){for(var ye=0,we=Y.length?2:0,Se=Z[U].data,Ke=0,tt=0,gt;Ke<Se.length;Ke+=128){var Ye=Se.slice(Ke,Ke+128);Hs(Ye,64),tt=Ye.read_shift(2),gt=sC(Ye,0,tt-we),Y.push(gt);var Xe={name:gt,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},$t=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);$t!==0&&(Xe.ct=M(Ye,Ye.l-8));var Nn=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);Nn!==0&&(Xe.mt=M(Ye,Ye.l-8)),Xe.start=Ye.read_shift(4,"i"),Xe.size=Ye.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=j,Xe.name=""),Xe.type===5?(ye=Xe.start,J>0&&ye!==j&&(Z[ye].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",Z[Xe.start]===void 0&&(Z[Xe.start]=T(K,Xe.start,Z.fat_addrs,Z.ssz)),Z[Xe.start].name=Xe.name,Xe.content=Z[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:ye!==j&&Xe.start!==j&&Z[ye]&&(Xe.content=x(Xe,Z[ye].data,(Z[ke]||{}).data))),Xe.content&&Hs(Xe.content,0),te[gt]=Xe,xe.push(Xe)}}function M(U,Z){return new Date((qs(U,Z+4)/1e7*Math.pow(2,32)+qs(U,Z)/1e7-11644473600)*1e3)}function F(U,Z){return u(),h(l.readFileSync(U),Z)}function G(U,Z){var K=Z&&Z.type;switch(K||Cn&&Buffer.isBuffer(U)&&(K="buffer"),K||"base64"){case"file":return F(U,Z);case"base64":return h(Qa(Yl(U)),Z);case"binary":return h(Qa(U),Z)}return h(U,Z)}function R(U,Z){var K=Z||{},Y=K.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=Y+"/",U.FileIndex[0]={name:Y,type:5}),K.CLSID&&(U.FileIndex[0].clsid=K.CLSID),C(U)}function C(U){var Z="Sh33tJ5";if(!Xn.find(U,"/"+Z)){var K=Ce(4);K[0]=55,K[1]=K[3]=50,K[2]=54,U.FileIndex.push({name:Z,type:2,content:K,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+Z),P(U)}}function P(U,Z){R(U);for(var K=!1,Y=!1,J=U.FullPaths.length-1;J>=0;--J){var te=U.FileIndex[J];switch(te.type){case 0:Y?K=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(te.R*te.L*te.C)&&(K=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!Z)){var xe=new Date(1987,1,19),ke=0,ye=Object.create?Object.create(null):{},we=[];for(J=0;J<U.FullPaths.length;++J)ye[U.FullPaths[J]]=!0,U.FileIndex[J].type!==0&&we.push([U.FullPaths[J],U.FileIndex[J]]);for(J=0;J<we.length;++J){var Se=r(we[J][0]);Y=ye[Se],Y||(we.push([Se,{name:i(Se).replace("/",""),type:1,clsid:je,ct:xe,mt:xe,content:null}]),ye[Se]=!0)}for(we.sort(function(gt,Ye){return t(gt[0],Ye[0])}),U.FullPaths=[],U.FileIndex=[],J=0;J<we.length;++J)U.FullPaths[J]=we[J][0],U.FileIndex[J]=we[J][1];for(J=0;J<we.length;++J){var Ke=U.FileIndex[J],tt=U.FullPaths[J];if(Ke.name=i(tt).replace("/",""),Ke.L=Ke.R=Ke.C=-(Ke.color=1),Ke.size=Ke.content?Ke.content.length:0,Ke.start=0,Ke.clsid=Ke.clsid||je,J===0)Ke.C=we.length>1?1:-1,Ke.size=0,Ke.type=5;else if(tt.slice(-1)=="/"){for(ke=J+1;ke<we.length&&r(U.FullPaths[ke])!=tt;++ke);for(Ke.C=ke>=we.length?-1:ke,ke=J+1;ke<we.length&&r(U.FullPaths[ke])!=r(tt);++ke);Ke.R=ke>=we.length?-1:ke,Ke.type=1}else r(U.FullPaths[J+1]||"")==r(tt)&&(Ke.R=J+1),Ke.type=2}}}function N(U,Z){var K=Z||{};if(K.fileType=="mad")return sn(U,K);switch(P(U),K.fileType){case"zip":return ce(U,K)}var Y=(function(gt){for(var Ye=0,Xe=0,$t=0;$t<gt.FileIndex.length;++$t){var Nn=gt.FileIndex[$t];if(Nn.content){var Vn=Nn.content.length;Vn>0&&(Vn<4096?Ye+=Vn+63>>6:Xe+=Vn+511>>9)}}for(var gr=gt.FullPaths.length+3>>2,La=Ye+7>>3,la=Ye+127>>7,Ds=La+Xe+gr+la,Or=Ds+127>>7,nc=Or<=109?0:Math.ceil((Or-109)/127);Ds+Or+nc+127>>7>Or;)nc=++Or<=109?0:Math.ceil((Or-109)/127);var wr=[1,nc,Or,la,gr,Xe,Ye,0];return gt.FileIndex[0].size=Ye<<6,wr[7]=(gt.FileIndex[0].start=wr[0]+wr[1]+wr[2]+wr[3]+wr[4]+wr[5])+(wr[6]+7>>3),wr})(U),J=Ce(Y[7]<<9),te=0,xe=0;{for(te=0;te<8;++te)J.write_shift(1,Pe[te]);for(te=0;te<8;++te)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),te=0;te<3;++te)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,Y[2]),J.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:j),J.write_shift(4,Y[3]),J.write_shift(-4,Y[1]?Y[0]-1:j),J.write_shift(4,Y[1]),te=0;te<109;++te)J.write_shift(-4,te<Y[2]?Y[1]+te:-1)}if(Y[1])for(xe=0;xe<Y[1];++xe){for(;te<236+xe*127;++te)J.write_shift(-4,te<Y[2]?Y[1]+te:-1);J.write_shift(-4,xe===Y[1]-1?j:xe+1)}var ke=function(gt){for(xe+=gt;te<xe-1;++te)J.write_shift(-4,te+1);gt&&(++te,J.write_shift(-4,j))};for(xe=te=0,xe+=Y[1];te<xe;++te)J.write_shift(-4,Ne.DIFSECT);for(xe+=Y[2];te<xe;++te)J.write_shift(-4,Ne.FATSECT);ke(Y[3]),ke(Y[4]);for(var ye=0,we=0,Se=U.FileIndex[0];ye<U.FileIndex.length;++ye)Se=U.FileIndex[ye],Se.content&&(we=Se.content.length,!(we<4096)&&(Se.start=xe,ke(we+511>>9)));for(ke(Y[6]+7>>3);J.l&511;)J.write_shift(-4,Ne.ENDOFCHAIN);for(xe=te=0,ye=0;ye<U.FileIndex.length;++ye)Se=U.FileIndex[ye],Se.content&&(we=Se.content.length,!(!we||we>=4096)&&(Se.start=xe,ke(we+63>>6)));for(;J.l&511;)J.write_shift(-4,Ne.ENDOFCHAIN);for(te=0;te<Y[4]<<2;++te){var Ke=U.FullPaths[te];if(!Ke||Ke.length===0){for(ye=0;ye<17;++ye)J.write_shift(4,0);for(ye=0;ye<3;++ye)J.write_shift(4,-1);for(ye=0;ye<12;++ye)J.write_shift(4,0);continue}Se=U.FileIndex[te],te===0&&(Se.start=Se.size?Se.start-1:j);var tt=te===0&&K.root||Se.name;if(we=2*(tt.length+1),J.write_shift(64,tt,"utf16le"),J.write_shift(2,we),J.write_shift(1,Se.type),J.write_shift(1,Se.color),J.write_shift(-4,Se.L),J.write_shift(-4,Se.R),J.write_shift(-4,Se.C),Se.clsid)J.write_shift(16,Se.clsid,"hex");else for(ye=0;ye<4;++ye)J.write_shift(4,0);J.write_shift(4,Se.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,Se.start),J.write_shift(4,Se.size),J.write_shift(4,0)}for(te=1;te<U.FileIndex.length;++te)if(Se=U.FileIndex[te],Se.size>=4096)if(J.l=Se.start+1<<9,Cn&&Buffer.isBuffer(Se.content))Se.content.copy(J,J.l,0,Se.size),J.l+=Se.size+511&-512;else{for(ye=0;ye<Se.size;++ye)J.write_shift(1,Se.content[ye]);for(;ye&511;++ye)J.write_shift(1,0)}for(te=1;te<U.FileIndex.length;++te)if(Se=U.FileIndex[te],Se.size>0&&Se.size<4096)if(Cn&&Buffer.isBuffer(Se.content))Se.content.copy(J,J.l,0,Se.size),J.l+=Se.size+63&-64;else{for(ye=0;ye<Se.size;++ye)J.write_shift(1,Se.content[ye]);for(;ye&63;++ye)J.write_shift(1,0)}if(Cn)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function O(U,Z){var K=U.FullPaths.map(function(ye){return ye.toUpperCase()}),Y=K.map(function(ye){var we=ye.split("/");return we[we.length-(ye.slice(-1)=="/"?2:1)]}),J=!1;Z.charCodeAt(0)===47?(J=!0,Z=K[0].slice(0,-1)+Z):J=Z.indexOf("/")!==-1;var te=Z.toUpperCase(),xe=J===!0?K.indexOf(te):Y.indexOf(te);if(xe!==-1)return U.FileIndex[xe];var ke=!te.match(y_);for(te=te.replace(Bm,""),ke&&(te=te.replace(y_,"!")),xe=0;xe<K.length;++xe)if((ke?K[xe].replace(y_,"!"):K[xe]).replace(Bm,"")==te||(ke?Y[xe].replace(y_,"!"):Y[xe]).replace(Bm,"")==te)return U.FileIndex[xe];return null}var z=64,j=-2,be="d0cf11e0a1b11ae1",Pe=[208,207,17,224,161,177,26,225],je="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:je,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(U,Z,K){u();var Y=N(U,K);l.writeFileSync(Z,Y)}function Te(U){for(var Z=new Array(U.length),K=0;K<U.length;++K)Z[K]=String.fromCharCode(U[K]);return Z.join("")}function le(U,Z){var K=N(U,Z);switch(Z&&Z.type||"buffer"){case"file":return u(),l.writeFileSync(Z.filename,K),K;case"binary":return typeof K=="string"?K:Te(K);case"base64":return Lp(typeof K=="string"?K:Te(K));case"buffer":if(Cn)return Buffer.isBuffer(K)?K:tc(K);case"array":return typeof K=="string"?Qa(K):K}return K}var se;function V(U){try{var Z=U.InflateRaw,K=new Z;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)se=U;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function Q(U,Z){if(!se)return Lt(U,Z);var K=se.InflateRaw,Y=new K,J=Y._processChunk(U.slice(U.l),Y._finishFlushFlag);return U.l+=Y.bytesRead,J}function ne(U){return se?se.deflateRawSync(U):Br(U)}var ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],pe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],De=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Be(U){var Z=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var Ue=typeof Uint8Array<"u",_e=Ue?new Uint8Array(256):[],Ct=0;Ct<256;++Ct)_e[Ct]=Be(Ct);function kt(U,Z){var K=_e[U&255];return Z<=8?K>>>8-Z:(K=K<<8|_e[U>>8&255],Z<=16?K>>>16-Z:(K=K<<8|_e[U>>16&255],K>>>24-Z))}function hn(U,Z){var K=Z&7,Y=Z>>>3;return(U[Y]|(K<=6?0:U[Y+1]<<8))>>>K&3}function Mt(U,Z){var K=Z&7,Y=Z>>>3;return(U[Y]|(K<=5?0:U[Y+1]<<8))>>>K&7}function jn(U,Z){var K=Z&7,Y=Z>>>3;return(U[Y]|(K<=4?0:U[Y+1]<<8))>>>K&15}function Qt(U,Z){var K=Z&7,Y=Z>>>3;return(U[Y]|(K<=3?0:U[Y+1]<<8))>>>K&31}function ot(U,Z){var K=Z&7,Y=Z>>>3;return(U[Y]|(K<=1?0:U[Y+1]<<8))>>>K&127}function Zn(U,Z,K){var Y=Z&7,J=Z>>>3,te=(1<<K)-1,xe=U[J]>>>Y;return K<8-Y||(xe|=U[J+1]<<8-Y,K<16-Y)||(xe|=U[J+2]<<16-Y,K<24-Y)||(xe|=U[J+3]<<24-Y),xe&te}function on(U,Z,K){var Y=Z&7,J=Z>>>3;return Y<=5?U[J]|=(K&7)<<Y:(U[J]|=K<<Y&255,U[J+1]=(K&7)>>8-Y),Z+3}function en(U,Z,K){var Y=Z&7,J=Z>>>3;return K=(K&1)<<Y,U[J]|=K,Z+1}function Qn(U,Z,K){var Y=Z&7,J=Z>>>3;return K<<=Y,U[J]|=K&255,K>>>=8,U[J+1]=K,Z+8}function mt(U,Z,K){var Y=Z&7,J=Z>>>3;return K<<=Y,U[J]|=K&255,K>>>=8,U[J+1]=K&255,U[J+2]=K>>>8,Z+16}function Bt(U,Z){var K=U.length,Y=2*K>Z?2*K:Z+5,J=0;if(K>=Z)return U;if(Cn){var te=JL(Y);if(U.copy)U.copy(te);else for(;J<U.length;++J)te[J]=U[J];return te}else if(Ue){var xe=new Uint8Array(Y);if(xe.set)xe.set(U);else for(;J<K;++J)xe[J]=U[J];return xe}return U.length=Y,U}function Mn(U){for(var Z=new Array(U),K=0;K<U;++K)Z[K]=0;return Z}function _t(U,Z,K){var Y=1,J=0,te=0,xe=0,ke=0,ye=U.length,we=Ue?new Uint16Array(32):Mn(32);for(te=0;te<32;++te)we[te]=0;for(te=ye;te<K;++te)U[te]=0;ye=U.length;var Se=Ue?new Uint16Array(ye):Mn(ye);for(te=0;te<ye;++te)we[J=U[te]]++,Y<J&&(Y=J),Se[te]=0;for(we[0]=0,te=1;te<=Y;++te)we[te+16]=ke=ke+we[te-1]<<1;for(te=0;te<ye;++te)ke=U[te],ke!=0&&(Se[te]=we[ke+16]++);var Ke=0;for(te=0;te<ye;++te)if(Ke=U[te],Ke!=0)for(ke=kt(Se[te],Y)>>Y-Ke,xe=(1<<Y+4-Ke)-1;xe>=0;--xe)Z[ke|xe<<Ke]=Ke&15|te<<4;return Y}var Jt=Ue?new Uint16Array(512):Mn(512),Pt=Ue?new Uint16Array(32):Mn(32);if(!Ue){for(var sr=0;sr<512;++sr)Jt[sr]=0;for(sr=0;sr<32;++sr)Pt[sr]=0}(function(){for(var U=[],Z=0;Z<32;Z++)U.push(5);_t(U,Pt,32);var K=[];for(Z=0;Z<=143;Z++)K.push(8);for(;Z<=255;Z++)K.push(9);for(;Z<=279;Z++)K.push(7);for(;Z<=287;Z++)K.push(8);_t(K,Jt,288)})();var ai=(function(){for(var Z=Ue?new Uint8Array(32768):[],K=0,Y=0;K<De.length-1;++K)for(;Y<De[K+1];++Y)Z[Y]=K;for(;Y<32768;++Y)Z[Y]=29;var J=Ue?new Uint8Array(259):[];for(K=0,Y=0;K<pe.length-1;++K)for(;Y<pe[K+1];++Y)J[Y]=K;function te(ke,ye){for(var we=0;we<ke.length;){var Se=Math.min(65535,ke.length-we),Ke=we+Se==ke.length;for(ye.write_shift(1,+Ke),ye.write_shift(2,Se),ye.write_shift(2,~Se&65535);Se-- >0;)ye[ye.l++]=ke[we++]}return ye.l}function xe(ke,ye){for(var we=0,Se=0,Ke=Ue?new Uint16Array(32768):[];Se<ke.length;){var tt=Math.min(65535,ke.length-Se);if(tt<10){for(we=on(ye,we,+(Se+tt==ke.length)),we&7&&(we+=8-(we&7)),ye.l=we/8|0,ye.write_shift(2,tt),ye.write_shift(2,~tt&65535);tt-- >0;)ye[ye.l++]=ke[Se++];we=ye.l*8;continue}we=on(ye,we,+(Se+tt==ke.length)+2);for(var gt=0;tt-- >0;){var Ye=ke[Se];gt=(gt<<5^Ye)&32767;var Xe=-1,$t=0;if((Xe=Ke[gt])&&(Xe|=Se&-32768,Xe>Se&&(Xe-=32768),Xe<Se))for(;ke[Xe+$t]==ke[Se+$t]&&$t<250;)++$t;if($t>2){Ye=J[$t],Ye<=22?we=Qn(ye,we,_e[Ye+1]>>1)-1:(Qn(ye,we,3),we+=5,Qn(ye,we,_e[Ye-23]>>5),we+=3);var Nn=Ye<8?0:Ye-4>>2;Nn>0&&(mt(ye,we,$t-pe[Ye]),we+=Nn),Ye=Z[Se-Xe],we=Qn(ye,we,_e[Ye]>>3),we-=3;var Vn=Ye<4?0:Ye-2>>1;Vn>0&&(mt(ye,we,Se-Xe-De[Ye]),we+=Vn);for(var gr=0;gr<$t;++gr)Ke[gt]=Se&32767,gt=(gt<<5^ke[Se])&32767,++Se;tt-=$t-1}else Ye<=143?Ye=Ye+48:we=en(ye,we,1),we=Qn(ye,we,_e[Ye]),Ke[gt]=Se&32767,++Se}we=Qn(ye,we,0)-1}return ye.l=(we+7)/8|0,ye.l}return function(ye,we){return ye.length<8?te(ye,we):xe(ye,we)}})();function Br(U){var Z=Ce(50+Math.floor(U.length*1.1)),K=ai(U,Z);return Z.slice(0,K)}var zt=Ue?new Uint16Array(32768):Mn(32768),ns=Ue?new Uint16Array(32768):Mn(32768),Oe=Ue?new Uint16Array(128):Mn(128),Ee=1,me=1;function Nt(U,Z){var K=Qt(U,Z)+257;Z+=5;var Y=Qt(U,Z)+1;Z+=5;var J=jn(U,Z)+4;Z+=4;for(var te=0,xe=Ue?new Uint8Array(19):Mn(19),ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,we=Ue?new Uint8Array(8):Mn(8),Se=Ue?new Uint8Array(8):Mn(8),Ke=xe.length,tt=0;tt<J;++tt)xe[ie[tt]]=te=Mt(U,Z),ye<te&&(ye=te),we[te]++,Z+=3;var gt=0;for(we[0]=0,tt=1;tt<=ye;++tt)Se[tt]=gt=gt+we[tt-1]<<1;for(tt=0;tt<Ke;++tt)(gt=xe[tt])!=0&&(ke[tt]=Se[gt]++);var Ye=0;for(tt=0;tt<Ke;++tt)if(Ye=xe[tt],Ye!=0){gt=_e[ke[tt]]>>8-Ye;for(var Xe=(1<<7-Ye)-1;Xe>=0;--Xe)Oe[gt|Xe<<Ye]=Ye&7|tt<<3}var $t=[];for(ye=1;$t.length<K+Y;)switch(gt=Oe[ot(U,Z)],Z+=gt&7,gt>>>=3){case 16:for(te=3+hn(U,Z),Z+=2,gt=$t[$t.length-1];te-- >0;)$t.push(gt);break;case 17:for(te=3+Mt(U,Z),Z+=3;te-- >0;)$t.push(0);break;case 18:for(te=11+ot(U,Z),Z+=7;te-- >0;)$t.push(0);break;default:$t.push(gt),ye<gt&&(ye=gt);break}var Nn=$t.slice(0,K),Vn=$t.slice(K);for(tt=K;tt<286;++tt)Nn[tt]=0;for(tt=Y;tt<30;++tt)Vn[tt]=0;return Ee=_t(Nn,zt,286),me=_t(Vn,ns,30),Z}function L(U,Z){if(U[0]==3&&!(U[1]&3))return[sd(Z),2];for(var K=0,Y=0,J=JL(Z||1<<18),te=0,xe=J.length>>>0,ke=0,ye=0;(Y&1)==0;){if(Y=Mt(U,K),K+=3,Y>>>1)Y>>1==1?(ke=9,ye=5):(K=Nt(U,K),ke=Ee,ye=me);else{K&7&&(K+=8-(K&7));var we=U[K>>>3]|U[(K>>>3)+1]<<8;if(K+=32,we>0)for(!Z&&xe<te+we&&(J=Bt(J,te+we),xe=J.length);we-- >0;)J[te++]=U[K>>>3],K+=8;continue}for(;;){!Z&&xe<te+32767&&(J=Bt(J,te+32767),xe=J.length);var Se=Zn(U,K,ke),Ke=Y>>>1==1?Jt[Se]:zt[Se];if(K+=Ke&15,Ke>>>=4,(Ke>>>8&255)===0)J[te++]=Ke;else{if(Ke==256)break;Ke-=257;var tt=Ke<8?0:Ke-4>>2;tt>5&&(tt=0);var gt=te+pe[Ke];tt>0&&(gt+=Zn(U,K,tt),K+=tt),Se=Zn(U,K,ye),Ke=Y>>>1==1?Pt[Se]:ns[Se],K+=Ke&15,Ke>>>=4;var Ye=Ke<4?0:Ke-2>>1,Xe=De[Ke];for(Ye>0&&(Xe+=Zn(U,K,Ye),K+=Ye),!Z&&xe<gt&&(J=Bt(J,gt+100),xe=J.length);te<gt;)J[te]=J[te-Xe],++te}}}return Z?[J,K+7>>>3]:[J.slice(0,te),K+7>>>3]}function Lt(U,Z){var K=U.slice(U.l||0),Y=L(K,Z);return U.l+=Y[1],Y[0]}function W(U,Z){if(U)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function q(U,Z){var K=U;Hs(K,0);var Y=[],J=[],te={FileIndex:Y,FullPaths:J};R(te,{root:Z.root});for(var xe=K.length-4;(K[xe]!=80||K[xe+1]!=75||K[xe+2]!=5||K[xe+3]!=6)&&xe>=0;)--xe;K.l=xe+4,K.l+=4;var ke=K.read_shift(2);K.l+=6;var ye=K.read_shift(4);for(K.l=ye,xe=0;xe<ke;++xe){K.l+=20;var we=K.read_shift(4),Se=K.read_shift(4),Ke=K.read_shift(2),tt=K.read_shift(2),gt=K.read_shift(2);K.l+=8;var Ye=K.read_shift(4),Xe=o(K.slice(K.l+Ke,K.l+Ke+tt));K.l+=Ke+tt+gt;var $t=K.l;K.l=Ye+4,X(K,we,Se,te,Xe),K.l=$t}return te}function X(U,Z,K,Y,J){U.l+=2;var te=U.read_shift(2),xe=U.read_shift(2),ke=a(U);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var ye=U.read_shift(4),we=U.read_shift(4),Se=U.read_shift(4),Ke=U.read_shift(2),tt=U.read_shift(2),gt="",Ye=0;Ye<Ke;++Ye)gt+=String.fromCharCode(U[U.l++]);if(tt){var Xe=o(U.slice(U.l,U.l+tt));(Xe[21589]||{}).mt&&(ke=Xe[21589].mt),((J||{})[21589]||{}).mt&&(ke=J[21589].mt)}U.l+=tt;var $t=U.slice(U.l,U.l+we);switch(xe){case 8:$t=Q(U,Se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var Nn=!1;te&8&&(ye=U.read_shift(4),ye==134695760&&(ye=U.read_shift(4),Nn=!0),we=U.read_shift(4),Se=U.read_shift(4)),we!=Z&&W(Nn,"Bad compressed size: "+Z+" != "+we),Se!=K&&W(Nn,"Bad uncompressed size: "+K+" != "+Se),cn(Y,gt,$t,{unsafe:!0,mt:ke})}function ce(U,Z){var K=Z||{},Y=[],J=[],te=Ce(1),xe=K.compression?8:0,ke=0,ye=0,we=0,Se=0,Ke=0,tt=U.FullPaths[0],gt=tt,Ye=U.FileIndex[0],Xe=[],$t=0;for(ye=1;ye<U.FullPaths.length;++ye)if(gt=U.FullPaths[ye].slice(tt.length),Ye=U.FileIndex[ye],!(!Ye.size||!Ye.content||gt=="Sh33tJ5")){var Nn=Se,Vn=Ce(gt.length);for(we=0;we<gt.length;++we)Vn.write_shift(1,gt.charCodeAt(we)&127);Vn=Vn.slice(0,Vn.l),Xe[Ke]=Vme.buf(Ye.content,0);var gr=Ye.content;xe==8&&(gr=ne(gr)),te=Ce(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,ke),te.write_shift(2,xe),Ye.mt?s(te,Ye.mt):te.write_shift(4,0),te.write_shift(-4,Xe[Ke]),te.write_shift(4,gr.length),te.write_shift(4,Ye.content.length),te.write_shift(2,Vn.length),te.write_shift(2,0),Se+=te.length,Y.push(te),Se+=Vn.length,Y.push(Vn),Se+=gr.length,Y.push(gr),te=Ce(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,ke),te.write_shift(2,xe),te.write_shift(4,0),te.write_shift(-4,Xe[Ke]),te.write_shift(4,gr.length),te.write_shift(4,Ye.content.length),te.write_shift(2,Vn.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,Nn),$t+=te.l,J.push(te),$t+=Vn.length,J.push(Vn),++Ke}return te=Ce(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Ke),te.write_shift(2,Ke),te.write_shift(4,$t),te.write_shift(4,Se),te.write_shift(2,0),Pi([Pi(Y),Pi(J),te])}var he={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ve(U,Z){if(U.ctype)return U.ctype;var K=U.name||"",Y=K.match(/\.([^\.]+)$/);return Y&&he[Y[1]]||Z&&(Y=(K=Z).match(/[\.\\]([^\.\\])+$/),Y&&he[Y[1]])?he[Y[1]]:"application/octet-stream"}function Ie(U){for(var Z=Lp(U),K=[],Y=0;Y<Z.length;Y+=76)K.push(Z.slice(Y,Y+76));return K.join(`\r
`)+`\r
`}function $e(U){var Z=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var Se=we.charCodeAt(0).toString(16).toUpperCase();return"="+(Se.length==1?"0"+Se:Se)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Y=Z.split(`\r
`),J=0;J<Y.length;++J){var te=Y[J];if(te.length==0){K.push("");continue}for(var xe=0;xe<te.length;){var ke=76,ye=te.slice(xe,xe+ke);ye.charAt(ke-1)=="="?ke--:ye.charAt(ke-2)=="="?ke-=2:ye.charAt(ke-3)=="="&&(ke-=3),ye=te.slice(xe,xe+ke),xe+=ke,xe<te.length&&(ye+="="),K.push(ye)}}return K.join(`\r
`)}function et(U){for(var Z=[],K=0;K<U.length;++K){for(var Y=U[K];K<=U.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+U[++K];Z.push(Y)}for(var J=0;J<Z.length;++J)Z[J]=Z[J].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return Qa(Z.join(`\r
`))}function ft(U,Z,K){for(var Y="",J="",te="",xe,ke=0;ke<10;++ke){var ye=Z[ke];if(!ye||ye.match(/^\s*$/))break;var we=ye.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":Y=we[2].trim();break;case"content-type":te=we[2].trim();break;case"content-transfer-encoding":J=we[2].trim();break}}switch(++ke,J.toLowerCase()){case"base64":xe=Qa(Yl(Z.slice(ke).join("")));break;case"quoted-printable":xe=et(Z.slice(ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var Se=cn(U,Y.slice(K.length),xe,{unsafe:!0});te&&(Se.ctype=te)}function St(U,Z){if(Te(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=Z&&Z.root||"",Y=(Cn&&Buffer.isBuffer(U)?U.toString("binary"):Te(U)).split(`\r
`),J=0,te="";for(J=0;J<Y.length;++J)if(te=Y[J],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),K||(K=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),te.slice(0,K.length)!=K););var xe=(Y[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var ke="--"+(xe[1]||""),ye=[],we=[],Se={FileIndex:ye,FullPaths:we};R(Se);var Ke,tt=0;for(J=0;J<Y.length;++J){var gt=Y[J];gt!==ke&&gt!==ke+"--"||(tt++&&ft(Se,Y.slice(Ke,J),K),Ke=J)}return Se}function sn(U,Z){var K=Z||{},Y=K.boundary||"SheetJS";Y="------="+Y;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],te=U.FullPaths[0],xe=te,ke=U.FileIndex[0],ye=1;ye<U.FullPaths.length;++ye)if(xe=U.FullPaths[ye].slice(te.length),ke=U.FileIndex[ye],!(!ke.size||!ke.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($t){return"_x"+$t.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($t){return"_u"+$t.charCodeAt(0).toString(16)+"_"});for(var we=ke.content,Se=Cn&&Buffer.isBuffer(we)?we.toString("binary"):Te(we),Ke=0,tt=Math.min(1024,Se.length),gt=0,Ye=0;Ye<=tt;++Ye)(gt=Se.charCodeAt(Ye))>=32&&gt<128&&++Ke;var Xe=Ke>=tt*4/5;J.push(Y),J.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+xe),J.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),J.push("Content-Type: "+Ve(ke,xe)),J.push(""),J.push(Xe?$e(Se):Ie(Se))}return J.push(Y+`--\r
`),J.join(`\r
`)}function dr(U){var Z={};return R(Z,U),Z}function cn(U,Z,K,Y){var J=Y&&Y.unsafe;J||R(U);var te=!J&&Xn.find(U,Z);if(!te){var xe=U.FullPaths[0];Z.slice(0,xe.length)==xe?xe=Z:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+Z).replace("//","/")),te={name:i(Z),type:2},U.FileIndex.push(te),U.FullPaths.push(xe),J||Xn.utils.cfb_gc(U)}return te.content=K,te.size=K?K.length:0,Y&&(Y.CLSID&&(te.clsid=Y.CLSID),Y.mt&&(te.mt=Y.mt),Y.ct&&(te.ct=Y.ct)),te}function fr(U,Z){R(U);var K=Xn.find(U,Z);if(K){for(var Y=0;Y<U.FileIndex.length;++Y)if(U.FileIndex[Y]==K)return U.FileIndex.splice(Y,1),U.FullPaths.splice(Y,1),!0}return!1}function vr(U,Z,K){R(U);var Y=Xn.find(U,Z);if(Y){for(var J=0;J<U.FileIndex.length;++J)if(U.FileIndex[J]==Y)return U.FileIndex[J].name=i(K),U.FullPaths[J]=K,!0}return!1}function Fi(U){P(U,!0)}return e.find=O,e.read=G,e.parse=h,e.write=le,e.writeFile=ue,e.utils={cfb_new:dr,cfb_add:cn,cfb_del:fr,cfb_mov:vr,cfb_gc:Fi,ReadShift:zm,CheckField:EV,prep_blob:Hs,bconcat:Pi,use_zlib:V,_deflateRaw:Br,_inflateRaw:Lt,consts:Ne},e})();function Gme(n){return typeof n=="string"?Xw(n):Array.isArray(n)?dme(n):n}function M1(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Xw(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?Dp(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([Gme(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=P1(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Oi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function oO(n,e){for(var t=[],r=Oi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function tC(n){for(var e=[],t=Oi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function Qw(n){for(var e=[],t=Oi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function Bme(n){for(var e=[],t=Oi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var Sv=new Date(1899,11,30,0,0,0);function Ns(n,e){var t=n.getTime(),r=Sv.getTime()+(n.getTimezoneOffset()-Sv.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var sV=new Date,Ume=Sv.getTime()+(sV.getTimezoneOffset()-Sv.getTimezoneOffset())*6e4,lO=sV.getTimezoneOffset();function aV(n){var e=new Date;return e.setTime(n*24*60*60*1e3+Ume),e.getTimezoneOffset()!==lO&&e.setTime(e.getTime()+(e.getTimezoneOffset()-lO)*6e4),e}var cO=new Date("2017-02-19T19:06:09.000Z"),oV=isNaN(cO.getFullYear())?new Date("2/19/17"):cO,zme=oV.getFullYear()==2017;function fs(n,e){var t=new Date(n);if(zme)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(oV.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Jw(n,e){if(Cn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Ls(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ls(n[t]));return e}function Pr(n,e){for(var t="";t.length<e;)t+=n;return t}function Vl(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var $me=["january","february","march","april","may","june","july","august","september","october","november","december"];function Op(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&$me.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function nn(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Cn?r=tc(t):r=fme(t),Xn.utils.cfb_add(n,e,r)}Xn.utils.cfb_add(n,e,t)}else n.file(e,t)}function nC(){return Xn.utils.cfb_new()}var qr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Wme={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rC=tC(Wme),iC=/[&<>'"]/g,Hme=/[\u0000-\u0008\u000b-\u001f]/g;function Hn(n){var e=n+"";return e.replace(iC,function(t){return rC[t]}).replace(Hme,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function uO(n){return Hn(n).replace(/ /g,"_x0020_")}var lV=/[\u0000-\u001f]/g;function Kme(n){var e=n+"";return e.replace(iC,function(t){return rC[t]}).replace(/\n/g,"<br/>").replace(lV,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Yme(n){var e=n+"";return e.replace(iC,function(t){return rC[t]}).replace(lV,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Xme(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function qme(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function HS(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function hO(n){var e=sd(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function dO(n){return tc(n,"binary").toString("utf8")}var x_="foo bar baz",Um=Cn&&(dO(x_)==HS(x_)&&dO||hO(x_)==HS(x_)&&hO)||HS,Dp=Cn?function(n){return tc(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Zme=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),cV=/(^\s|\s$|\n)/;function Mi(n,e){return"<"+n+(e.match(cV)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Fp(n){return Oi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function nt(n,e,t){return"<"+n+(t!=null?Fp(t):"")+(e!=null?(e.match(cV)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function Xb(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function Qme(n,e){switch(typeof n){case"string":var t=nt("vt:lpwstr",Hn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return nt((n|0)==n?"vt:i4":"vt:r8",Hn(String(n)));case"boolean":return nt("vt:bool",n?"true":"false")}if(n instanceof Date)return nt("vt:filetime",Xb(n));throw new Error("Unable to serialize "+n)}var gi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},q0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Xs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Jme(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function epe(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var fO=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},gO=Cn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:tc(e)})):fO(n)}:fO,mO=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(mm(n,i)));return r.join("").replace(Bm,"")},sC=Cn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Bm,""):mO(n,e,t)}:mO,pO=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},uV=Cn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):pO(n,e,t)}:pO,yO=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Lf(n,i)));return r.join("")},N1=Cn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):yO(e,t,r)}:yO,hV=function(n,e){var t=qs(n,e);return t>0?N1(n,e+4,e+4+t-1):""},dV=hV,fV=function(n,e){var t=qs(n,e);return t>0?N1(n,e+4,e+4+t-1):""},gV=fV,mV=function(n,e){var t=2*qs(n,e);return t>0?N1(n,e+4,e+4+t-1):""},pV=mV,yV=function(e,t){var r=qs(e,t);return r>0?sC(e,t+4,t+4+r):""},_V=yV,xV=function(n,e){var t=qs(n,e);return t>0?N1(n,e+4,e+4+t):""},vV=xV,wV=function(n,e){return Jme(n,e)},Tv=wV,aC=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Cn&&(dV=function(e,t){if(!Buffer.isBuffer(e))return hV(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},gV=function(e,t){if(!Buffer.isBuffer(e))return fV(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},pV=function(e,t){if(!Buffer.isBuffer(e))return mV(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},_V=function(e,t){if(!Buffer.isBuffer(e))return yV(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},vV=function(e,t){if(!Buffer.isBuffer(e))return xV(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Tv=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):wV(e,t)},aC=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Lf=function(n,e){return n[e]},mm=function(n,e){return n[e+1]*256+n[e]},tpe=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},qs=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},_h=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},npe=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function zm(n,e){var t="",r,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Cn&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(mm(this,u)),u+=2;n*=2;break;case"utf8":t=N1(this,this.l,this.l+n);break;case"utf16le":n*=2,t=sC(this,this.l,this.l+n);break;case"wstr":return zm.call(this,n,"dbcs");case"lpstr-ansi":t=dV(this,this.l),n=4+qs(this,this.l);break;case"lpstr-cp":t=gV(this,this.l),n=4+qs(this,this.l);break;case"lpwstr":t=pV(this,this.l),n=4+2*qs(this,this.l);break;case"lpp4":n=4+qs(this,this.l),t=_V(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+qs(this,this.l),t=vV(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Lf(this,this.l+n++))!==0;)s.push(p_(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=mm(this,this.l+n))!==0;)s.push(p_(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Lf(this,u),this.l=u+1,o=zm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(p_(mm(this,u))),u+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Lf(this,u),this.l=u+1,o=zm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(p_(Lf(this,u))),u+=1}t=s.join("");break;default:switch(n){case 1:return r=Lf(this,this.l),this.l++,r;case 2:return r=(e==="i"?tpe:mm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?_h:npe)(this,this.l),this.l+=4,r):(i=qs(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=Tv(this,this.l):i=Tv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=uV(this,this.l,n);break}}return this.l+=n,t}var rpe=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},ipe=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},spe=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function ape(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)spe(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,rpe(this,e,this.l);break;case 8:if(r=8,t==="f"){epe(this,e,this.l);break}case 16:break;case-4:r=4,ipe(this,e,this.l);break}return this.l+=r,this}function EV(n,e){var t=uV(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Hs(n,e){n.l=e,n.read_shift=zm,n.chk=EV,n.write_shift=ape}function nl(n,e){n.l+=e}function Ce(n){var e=sd(n);return Hs(e,0),e}function ks(){var n=[],e=Cn?256:2048,t=function(u){var h=Ce(u);return Hs(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=t(Math.max(u+1,e)))},a=function(){return i(),Pi(n)},o=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ge(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=Jve[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&aC(t)&&n.push(t)}}function $m(n,e,t){var r=Ls(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function _O(n,e,t){var r=Ls(n);return r.s=$m(r.s,e.s,t),r.e=$m(r.e,e.s,t),r}function Wm(n,e){if(n.cRel&&n.c<0)for(n=Ls(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ls(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Yn(n);return!n.cRel&&n.cRel!=null&&(t=cpe(t)),!n.rRel&&n.rRel!=null&&(t=ope(t)),t}function KS(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+es(n.s.c)+":"+(n.e.cRel?"":"$")+es(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Li(n.s.r)+":"+(n.e.rRel?"":"$")+Li(n.e.r):Wm(n.s,e.biff)+":"+Wm(n.e,e.biff)}function oC(n){return parseInt(lpe(n),10)-1}function Li(n){return""+(n+1)}function ope(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lpe(n){return n.replace(/\$(\d+)$/,"$1")}function lC(n){for(var e=upe(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function es(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function cpe(n){return n.replace(/^([A-Z])/,"$$$1")}function upe(n){return n.replace(/^\$([A-Z])/,"$1")}function hpe(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pi(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Yn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function aa(n){var e=n.indexOf(":");return e==-1?{s:pi(n),e:pi(n)}:{s:pi(n.slice(0,e)),e:pi(n.slice(e+1))}}function Yr(n,e){return typeof e>"u"||typeof e=="number"?Yr(n.s,n.e):(typeof n!="string"&&(n=Yn(n)),typeof e!="string"&&(e=Yn(e)),n==e?n:n+":"+e)}function hr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function xO(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=wu(n.z,t?Ns(e):e)}catch{}try{return n.w=wu((n.XF||{}).numFmtId||(t?14:0),t?Ns(e):e)}catch{return""+e}}function Xl(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?L1[n.v]||n.v:e==null?xO(n,n.v):xO(n,e))}function Sd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function SV(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?pi(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=hr(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(u.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[f].length;++g)if(!(typeof e[f][g]>"u")){var y={v:e[f][g]},v=a+f,x=o+g;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),e[f][g]&&typeof e[f][g]=="object"&&!Array.isArray(e[f][g])&&!(e[f][g]instanceof Date))y=e[f][g];else if(Array.isArray(y.v)&&(y.f=e[f][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Nr[14],r.cellDates?(y.t="d",y.w=wu(y.z,Ns(y.v))):(y.t="n",y.v=Ns(y.v),y.w=wu(y.z,y.v))):y.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(y.z=s[v][x].z),s[v][x]=y;else{var E=Yn({c:x,r:v});s[E]&&s[E].z&&(y.z=s[E].z),s[E]=y}}}return u.s.c<1e7&&(s["!ref"]=Yr(u)),s}function Z0(n,e){return SV(null,n,e)}function dpe(n){return n.read_shift(4,"i")}function oo(n,e){return e||(e=Ce(4)),e.write_shift(4,n),e}function ts(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function yi(n,e){var t=!1;return e==null&&(t=!0,e=Ce(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function fpe(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function gpe(n,e){return e||(e=Ce(4)),e.write_shift(2,0),e.write_shift(2,0),e}function cC(n,e){var t=n.l,r=n.read_shift(1),i=ts(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(fpe(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function mpe(n,e){var t=!1;return e==null&&(t=!0,e=Ce(15+4*n.t.length)),e.write_shift(1,0),yi(n.t,e),t?e.slice(0,e.l):e}var ppe=cC;function ype(n,e){var t=!1;return e==null&&(t=!0,e=Ce(23+4*n.t.length)),e.write_shift(1,1),yi(n.t,e),e.write_shift(4,1),gpe({},e),t?e.slice(0,e.l):e}function Na(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Td(n,e){return e==null&&(e=Ce(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function bd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Id(n,e){return e==null&&(e=Ce(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var _pe=ts,TV=yi;function uC(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function bv(n,e){var t=!1;return e==null&&(t=!0,e=Ce(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var xpe=ts,qb=uC,hC=bv;function bV(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?Tv([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_h(e,0)>>2;return t?i/100:i}function IV(n,e){e==null&&(e=Ce(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function AV(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function vpe(n,e){return e||(e=Ce(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Ad=AV,Q0=vpe;function J0(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function ad(n,e){return(e||Ce(8)).write_shift(8,n,"f")}function wpe(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var u=kpe[i];u&&(e.rgb=kO(u));break;case 2:e.rgb=kO([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Iv(n,e){if(e||(e=Ce(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Epe(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Spe(n,e){e||(e=Ce(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var RV=2,$s=3,v_=11,Av=19,w_=64,Tpe=65,bpe=71,Ipe=4108,Ape=4126,Ri=80,vO={1:{n:"CodePage",t:RV},2:{n:"Category",t:Ri},3:{n:"PresentationFormat",t:Ri},4:{n:"ByteCount",t:$s},5:{n:"LineCount",t:$s},6:{n:"ParagraphCount",t:$s},7:{n:"SlideCount",t:$s},8:{n:"NoteCount",t:$s},9:{n:"HiddenCount",t:$s},10:{n:"MultimediaClipCount",t:$s},11:{n:"ScaleCrop",t:v_},12:{n:"HeadingPairs",t:Ipe},13:{n:"TitlesOfParts",t:Ape},14:{n:"Manager",t:Ri},15:{n:"Company",t:Ri},16:{n:"LinksUpToDate",t:v_},17:{n:"CharacterCount",t:$s},19:{n:"SharedDoc",t:v_},22:{n:"HyperlinksChanged",t:v_},23:{n:"AppVersion",t:$s,p:"version"},24:{n:"DigSig",t:Tpe},26:{n:"ContentType",t:Ri},27:{n:"ContentStatus",t:Ri},28:{n:"Language",t:Ri},29:{n:"Version",t:Ri},255:{},2147483648:{n:"Locale",t:Av},2147483651:{n:"Behavior",t:Av},1919054434:{}},wO={1:{n:"CodePage",t:RV},2:{n:"Title",t:Ri},3:{n:"Subject",t:Ri},4:{n:"Author",t:Ri},5:{n:"Keywords",t:Ri},6:{n:"Comments",t:Ri},7:{n:"Template",t:Ri},8:{n:"LastAuthor",t:Ri},9:{n:"RevNumber",t:Ri},10:{n:"EditTime",t:w_},11:{n:"LastPrinted",t:w_},12:{n:"CreatedDate",t:w_},13:{n:"ModifiedDate",t:w_},14:{n:"PageCount",t:$s},15:{n:"WordCount",t:$s},16:{n:"CharCount",t:$s},17:{n:"Thumbnail",t:bpe},18:{n:"Application",t:Ri},19:{n:"DocSecurity",t:$s},255:{},2147483648:{n:"Locale",t:Av},2147483651:{n:"Behavior",t:Av},1919054434:{}};function Rpe(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Cpe=Rpe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),kpe=Ls(Cpe),L1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ppe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},E_={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function CV(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function kV(n,e){var t=Bme(Ppe),r=[],i;r[r.length]=qr,r[r.length]=nt("Types",null,{xmlns:gi.CT,"xmlns:xsd":gi.xsd,"xmlns:xsi":gi.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return nt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=nt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:E_[l][e.bookType]||E_[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(u){r[r.length]=nt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:E_[l][e.bookType]||E_[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(u){r[r.length]=nt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Tn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function PV(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function o0(n){var e=[qr,nt("Relationships",null,{xmlns:gi.RELS})];return Oi(n["!id"]).forEach(function(t){e[e.length]=nt("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function zn(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Tn.HLINK,Tn.XPATH,Tn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function Mpe(n){var e=[qr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function EO(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Npe(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Lpe(n){var e=[qr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(EO(n[t][0],n[t][1])),e.push(Npe("",n[t][0]));return e.push(EO("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function MV(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_v.version+"</meta:generator></office:meta></office:document-meta>"}var Oh=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function YS(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Hn(e),r[r.length]=t?nt(n,e,t):Mi(n,e))}function NV(n,e){var t=e||{},r=[qr,nt("cp:coreProperties",null,{"xmlns:cp":gi.CORE_PROPS,"xmlns:dc":gi.dc,"xmlns:dcterms":gi.dcterms,"xmlns:dcmitype":gi.dcmitype,"xmlns:xsi":gi.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&YS("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Xb(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&YS("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Xb(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Oh.length;++s){var a=Oh[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&YS(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var l0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],LV=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function OV(n){var e=[],t=nt;return n||(n={}),n.Application="SheetJS",e[e.length]=qr,e[e.length]=nt("Properties",null,{xmlns:gi.EXT_PROPS,"xmlns:vt":gi.vt}),l0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Hn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Hn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function DV(n){var e=[qr,nt("Properties",null,{xmlns:gi.CUST_PROPS,"xmlns:vt":gi.vt})];if(!n)return e.join("");var t=1;return Oi(n).forEach(function(i){++t,e[e.length]=nt("property",Qme(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Hn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var SO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ope(n,e){var t=[];return Oi(SO).map(function(r){for(var i=0;i<Oh.length;++i)if(Oh[i][1]==r)return Oh[i];for(i=0;i<l0.length;++i)if(l0[i][1]==r)return l0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Mi(SO[r[1]]||r[1],i))}}),nt("DocumentProperties",t.join(""),{xmlns:Xs.o})}function Dpe(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Oi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<Oh.length;++a)if(s==Oh[a][1])return;for(a=0;a<l0.length;++a)if(s==l0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(nt(uO(s),o,{"dt:dt":l}))}}),e&&Oi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(nt(uO(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+Xs.o+'">'+i.join("")+"</"+r+">"}function Fpe(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Ce(8);return a.write_shift(4,r),a.write_shift(4,i),a}function TO(n,e){var t=Ce(4),r=Ce(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Ce(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=Fpe(e);break;case 31:case 80:for(r=Ce(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Pi([t,r])}var FV=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function jpe(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function bO(n,e,t){var r=Ce(8),i=[],s=[],a=8,o=0,l=Ce(8),u=Ce(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Ce(8),u.write_shift(4,0),i.unshift(u);var h=[Ce(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var f=n[o][0];for(l=Ce(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Pi(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(FV.indexOf(n[o][0])>-1||LV.indexOf(n[o][0])>-1)&&n[o][1]!=null){var g=n[o][1],y=0;if(e){y=+e[n[o][0]];var v=t[y];if(v.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=TO(v.t,g)}else{var E=jpe(g);E==-1&&(E=31,g=String(g)),l=TO(E,g)}s.push(l),u=Ce(8),u.write_shift(4,e?y:2+o),i.push(u),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Pi([r].concat(i).concat(s))}function IO(n,e,t,r,i,s){var a=Ce(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Xn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=bO(n,t,r);if(o.push(l),i){var u=bO(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Pi(o)}function Vpe(n,e){e||(e=Ce(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function Gpe(n,e){return n.read_shift(e)===1}function as(n,e){return e||(e=Ce(2)),e.write_shift(2,+!!n),e}function jV(n){return n.read_shift(2,"u")}function wa(n,e){return e||(e=Ce(2)),e.write_shift(2,n),e}function VV(n,e,t){return t||(t=Ce(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function GV(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function Bpe(n){var e=n.t||"",t=Ce(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Ce(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return Pi(i)}function Upe(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function zpe(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):Upe(n,r,t)}function $pe(n,e,t){if(t.biff>5)return zpe(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function BV(n,e,t){return t||(t=Ce(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function AO(n,e){e||(e=Ce(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function Wpe(n){var e=Ce(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),AO(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&AO(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function od(n,e,t,r){return r||(r=Ce(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function Hpe(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function Kpe(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function UV(n,e){return e||(e=Ce(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function dC(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ce(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Ype(n,e){var t=!e||e.biff==8,r=Ce(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function Xpe(n,e){var t=!e||e.biff>=8?2:1,r=Ce(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function qpe(n,e){var t=Ce(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=Bpe(n[i]);var s=Pi([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function Zpe(){var n=Ce(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Qpe(n){var e=Ce(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Jpe(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Ce(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function e1e(n,e,t,r){var i=Ce(10);return od(n,e,r,i),i.write_shift(4,t),i}function t1e(n,e,t,r,i){var s=!i||i.biff==8,a=Ce(8+ +s+(1+s)*t.length);return od(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function n1e(n,e,t,r){var i=t&&t.biff==5;r||(r=Ce(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function r1e(n,e){var t=e.biff==8||!e.biff?4:2,r=Ce(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function RO(n,e,t,r){var i=t&&t.biff==5;r||(r=Ce(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function i1e(n){var e=Ce(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function s1e(n,e,t,r,i,s){var a=Ce(8);return od(n,e,r,a),VV(t,s,a),a}function a1e(n,e,t,r){var i=Ce(14);return od(n,e,r,i),ad(t,i),i}function o1e(n,e,t){if(t.biff<8)return l1e(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(Hpe(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function l1e(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=GV(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function c1e(n){var e=Ce(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)UV(n[t],e);return e}function u1e(n){var e=Ce(24),t=pi(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Pi([e,Wpe(n[1])])}function h1e(n){var e=n[1].Tooltip,t=Ce(10+2*(e.length+1));t.write_shift(2,2048);var r=pi(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function d1e(n){return n||(n=Ce(4)),n.write_shift(2,1),n.write_shift(2,1),n}function f1e(n,e,t){if(!t.cellStyles)return nl(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function g1e(n,e){var t=Ce(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function m1e(n){for(var e=Ce(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function p1e(n,e,t){var r=Ce(15);return D1(r,n,e),r.write_shift(8,t,"f"),r}function y1e(n,e,t){var r=Ce(9);return D1(r,n,e),r.write_shift(2,t),r}var _1e=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=tC({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var u=[],h=sd(1);switch(l.type){case"base64":h=Qa(Yl(o));break;case"binary":h=Qa(o);break;case"buffer":case"array":h=o;break}Hs(h,0);var f=h.read_shift(1),g=!!(f&136),y=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,E=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(E=h.read_shift(2));var T=h.read_shift(2),b=l.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var I=[],M={},F=Math.min(h.length,f==2?521:E-10-(y?264:0)),G=v?32:11;h.l<F&&h[h.l]!=13;)switch(M={},M.name=xv.utils.decode(b,h.slice(h.l,h.l+G)).replace(/[\u0000\r\n].*$/g,""),h.l+=G,M.type=String.fromCharCode(h.read_shift(1)),f!=2&&!v&&(M.offset=h.read_shift(4)),M.len=h.read_shift(1),f==2&&(M.offset=h.read_shift(2)),M.dec=h.read_shift(1),M.name.length&&I.push(M),f!=2&&(h.l+=v?13:14),M.type){case"B":(!y||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var R=0,C=0;for(u[0]=[],C=0;C!=I.length;++C)u[0][C]=I[C].name;for(;x-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,u[++R]=[],C=0,C=0;C!=I.length;++C){var P=h.slice(h.l,h.l+I[C].len);h.l+=I[C].len,Hs(P,0);var N=xv.utils.decode(b,P);switch(I[C].type){case"C":N.trim().length&&(u[R][C]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[R][C]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[R][C]=N;break;case"F":u[R][C]=parseFloat(N.trim());break;case"+":case"I":u[R][C]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[R][C]=!0;break;case"N":case"F":u[R][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[R][C]="##MEMO##"+(v?parseInt(N.trim(),10):P.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[R][C]=+N||0);break;case"@":u[R][C]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[R][C]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[R][C]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[R][C]=-P.read_shift(-8,"f");break;case"B":if(y&&I[C].len==8){u[R][C]=P.read_shift(8,"f");break}case"G":case"P":P.l+=I[C].len;break;case"0":if(I[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[C].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=I,u}function r(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=Z0(t(o,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function i(o,l){try{return Sd(r(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Np(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=ks(),f=Mv(o,{header:1,raw:!0,cellDates:!0}),g=f[0],y=f.slice(1),v=o["!cols"]||[],x=0,E=0,T=0,b=1;for(x=0;x<g.length;++x){if(((v[x]||{}).DBF||{}).name){g[x]=v[x].DBF.name,++T;continue}if(g[x]!=null){if(++T,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(E=0;E<1024;++E)if(g.indexOf(g[x]+"_"+E)==-1){g[x]+="_"+E;break}}}}var I=hr(o["!ref"]),M=[],F=[],G=[];for(x=0;x<=I.e.c-I.s.c;++x){var R="",C="",P=0,N=[];for(E=0;E<y.length;++E)y[E][x]!=null&&N.push(y[E][x]);if(N.length==0||g[x]==null){M[x]="?";continue}for(E=0;E<N.length;++E){switch(typeof N[E]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=N[E]instanceof Date?"D":"C";break;default:C="C"}P=Math.max(P,String(N[E]).length),R=R&&R!=C?"C":C}P>250&&(P=250),C=((v[x]||{}).DBF||{}).type,C=="C"&&v[x].DBF.len>P&&(P=v[x].DBF.len),R=="B"&&C=="N"&&(R="N",G[x]=v[x].DBF.dec,P=v[x].DBF.len),F[x]=R=="C"||C=="N"?P:s[R]||0,b+=F[x],M[x]=R}var O=h.next(32);for(O.write_shift(4,318902576),O.write_shift(4,y.length),O.write_shift(2,296+32*T),O.write_shift(2,b),x=0;x<4;++x)O.write_shift(4,0);for(O.write_shift(4,0|(+e[$7]||3)<<8),x=0,E=0;x<g.length;++x)if(g[x]!=null){var z=h.next(32),j=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,j,"sbcs"),z.write_shift(1,M[x]=="?"?"C":M[x],"sbcs"),z.write_shift(4,E),z.write_shift(1,F[x]||s[M[x]]||0),z.write_shift(1,G[x]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),E+=F[x]||s[M[x]]||0}var be=h.next(264);for(be.write_shift(4,13),x=0;x<65;++x)be.write_shift(4,0);for(x=0;x<y.length;++x){var Pe=h.next(b);for(Pe.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(M[E]){case"L":Pe.write_shift(1,y[x][E]==null?63:y[x][E]?84:70);break;case"B":Pe.write_shift(8,y[x][E]||0,"f");break;case"N":var je="0";for(typeof y[x][E]=="number"&&(je=y[x][E].toFixed(G[E]||0)),T=0;T<F[E]-je.length;++T)Pe.write_shift(1,32);Pe.write_shift(1,je,"sbcs");break;case"D":y[x][E]?(Pe.write_shift(4,("0000"+y[x][E].getFullYear()).slice(-4),"sbcs"),Pe.write_shift(2,("00"+(y[x][E].getMonth()+1)).slice(-2),"sbcs"),Pe.write_shift(2,("00"+y[x][E].getDate()).slice(-2),"sbcs")):Pe.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(y[x][E]!=null?y[x][E]:"").slice(0,F[E]);for(Pe.write_shift(1,Ne,"sbcs"),T=0;T<F[E]-Ne.length;++T)Pe.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),x1e=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Oi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,y){var v=n[y];return typeof v=="number"?QL(v):v},r=function(g,y,v){var x=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?g:QL(x)};n["|"]=254;function i(g,y){switch(y.type){case"base64":return s(Yl(g),y);case"binary":return s(g,y);case"buffer":return s(Cn&&Buffer.isBuffer(g)?g.toString("binary"):P1(g),y);case"array":return s(Jw(g),y)}throw new Error("Unrecognized type "+y.type)}function s(g,y){var v=g.split(/[\n\r]+/),x=-1,E=-1,T=0,b=0,I=[],M=[],F=null,G={},R=[],C=[],P=[],N=0,O;for(+y.codepage>=0&&Np(+y.codepage);T!==v.length;++T){N=0;var z=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=z.replace(/;;/g,"\0").split(";").map(function(ie){return ie.replace(/\u0000/g,";")}),be=j[0],Pe;if(z.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&M.push(z.slice(3).replace(/;;/g,";"));break;case"C":var je=!1,Ne=!1,ue=!1,Te=!1,le=-1,se=-1;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"A":break;case"X":E=parseInt(j[b].slice(1))-1,Ne=!0;break;case"Y":for(x=parseInt(j[b].slice(1))-1,Ne||(E=0),O=I.length;O<=x;++O)I[O]=[];break;case"K":Pe=j[b].slice(1),Pe.charAt(0)==='"'?Pe=Pe.slice(1,Pe.length-1):Pe==="TRUE"?Pe=!0:Pe==="FALSE"?Pe=!1:isNaN(Vl(Pe))?isNaN(Op(Pe).getDate())||(Pe=fs(Pe)):(Pe=Vl(Pe),F!==null&&nV(F)&&(Pe=aV(Pe))),je=!0;break;case"E":Te=!0;var V=yye(j[b].slice(1),{r:x,c:E});I[x][E]=[I[x][E],V];break;case"S":ue=!0,I[x][E]=[I[x][E],"S5S"];break;case"G":break;case"R":le=parseInt(j[b].slice(1))-1;break;case"C":se=parseInt(j[b].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}if(je&&(I[x][E]&&I[x][E].length==2?I[x][E][0]=Pe:I[x][E]=Pe,F=null),ue){if(Te)throw new Error("SYLK shared formula cannot have own formula");var Q=le>-1&&I[le][se];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");I[x][E][1]=_ye(Q[1],{r:x-le,c:E-se})}break;case"F":var ne=0;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"X":E=parseInt(j[b].slice(1))-1,++ne;break;case"Y":for(x=parseInt(j[b].slice(1))-1,O=I.length;O<=x;++O)I[O]=[];break;case"M":N=parseInt(j[b].slice(1))/20;break;case"F":break;case"G":break;case"P":F=M[parseInt(j[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=j[b].slice(1).split(" "),O=parseInt(P[0],10);O<=parseInt(P[1],10);++O)N=parseInt(P[2],10),C[O-1]=N===0?{hidden:!0}:{wch:N},fC(C[O-1]);break;case"C":E=parseInt(j[b].slice(1))-1,C[E]||(C[E]={});break;case"R":x=parseInt(j[b].slice(1))-1,R[x]||(R[x]={}),N>0?(R[x].hpt=N,R[x].hpx=KV(N)):N===0&&(R[x].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}ne<1&&(F=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}}return R.length>0&&(G["!rows"]=R),C.length>0&&(G["!cols"]=C),y&&y.sheetRows&&(I=I.slice(0,y.sheetRows)),[I,G]}function a(g,y){var v=i(g,y),x=v[0],E=v[1],T=Z0(x,y);return Oi(E).forEach(function(b){T[b]=E[b]}),T}function o(g,y){return Sd(a(g,y),y)}function l(g,y,v,x){var E="C;Y"+(v+1)+";X"+(x+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+mC(g.f,{r:v,c:x}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function u(g,y){y.forEach(function(v,x){var E="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Rv(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Cv(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function h(g,y){y.forEach(function(v,x){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*kv(v.hpx)+";"),E.length>2&&g.push(E+"R"+(x+1))})}function f(g,y){var v=["ID;PWXL;N;E"],x=[],E=hr(g["!ref"]),T,b=Array.isArray(g),I=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&u(v,g["!cols"]),g["!rows"]&&h(v,g["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var M=E.s.r;M<=E.e.r;++M)for(var F=E.s.c;F<=E.e.c;++F){var G=Yn({r:M,c:F});T=b?(g[M]||[])[F]:g[G],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,g,M,F))}return v.join(I)+I+x.join(I)+I+"E"+I}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),v1e=(function(){function n(s,a){switch(a.type){case"base64":return e(Yl(s),a);case"binary":return e(s,a);case"buffer":return e(Cn&&Buffer.isBuffer(s)?s.toString("binary"):P1(s),a);case"array":return e(Jw(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var g=o[h].trim().split(","),y=g[0],v=g[1];++h;for(var x=o[h]||"";(x.match(/["]/g)||[]).length&1&&h<o.length-1;)x+=`
`+o[++h];switch(x=x.trim(),+y){case-1:if(x==="BOT"){f[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[l][u]=!0:x==="FALSE"?f[l][u]=!1:isNaN(Vl(v))?isNaN(Op(v).getDate())?f[l][u]=v:f[l][u]=fs(v):f[l][u]=Vl(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function t(s,a){return Z0(n(s,a),a)}function r(s,a){return Sd(t(s,a),a)}var i=(function(){var s=function(l,u,h,f,g){l.push(u),l.push(h+","+f),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,h,f){l.push(u+","+h),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],h=hr(l["!ref"]),f,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(u,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var x=Yn({r:y,c:v});if(f=g?(l[y]||[])[v]:l[x],!f){a(u,1,0,"");continue}switch(f.t){case"n":var E=f.w;!E&&f.v!=null&&(E=f.v),E==null?f.f&&!f.F?a(u,1,0,"="+f.f):a(u,1,0,""):a(u,0,E,"V");break;case"b":a(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=wu(f.z||Nr[14],Ns(fs(f.v)))),a(u,0,f.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var T=`\r
`,b=u.join(T);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),zV=(function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,g){for(var y=f.split(`
`),v=-1,x=-1,E=0,T=[];E!==y.length;++E){var b=y[E].trim().split(":");if(b[0]==="cell"){var I=pi(b[1]);if(T.length<=I.r)for(v=T.length;v<=I.r;++v)T[v]||(T[v]=[]);switch(v=I.r,x=I.c,b[2]){case"t":T[v][x]=n(b[3]);break;case"v":T[v][x]=+b[3];break;case"vtf":var M=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[v][x]=!!+b[4];break;default:T[v][x]=+b[4];break}b[2]=="vtf"&&(T[v][x]=[T[v][x],M])}}}return g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),T}function r(f,g){return Z0(t(f,g),g)}function i(f,g){return Sd(r(f,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var g=[],y=[],v,x="",E=aa(f["!ref"]),T=Array.isArray(f),b=E.s.r;b<=E.e.r;++b)for(var I=E.s.c;I<=E.e.c;++I)if(x=Yn({r:b,c:I}),v=T?(f[b]||[])[I]:f[x],!(!v||v.v==null||v.t==="z")){switch(y=["cell",x,"t"],v.t){case"s":case"str":y.push(e(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=e(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var M=Ns(fs(v.v));y[2]="vtc",y[3]="nd",y[4]=""+M,y[5]=v.w||wu(v.z||Nr[14],M);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(f){return[s,a,o,a,u(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),w1e=(function(){function n(h,f,g,y,v){v.raw?f[g][y]=h:h===""||(h==="TRUE"?f[g][y]=!0:h==="FALSE"?f[g][y]=!1:isNaN(Vl(h))?isNaN(Op(h).getDate())?f[g][y]=h:f[g][y]=fs(h):f[g][y]=Vl(h))}function e(h,f){var g=f||{},y=[];if(!h||h.length===0)return y;for(var v=h.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var E=10,T=0,b=0;b<=x;++b)T=v[b].indexOf(" "),T==-1?T=v[b].length:T++,E=Math.max(E,T);for(b=0;b<=x;++b){y[b]=[];var I=0;for(n(v[b].slice(0,E).trim(),y,b,I,g),I=1;I<=(v[b].length-E)/10+1;++I)n(v[b].slice(E+(I-1)*10,E+I*10).trim(),y,b,I,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var f={},g=!1,y=0,v=0;y<h.length;++y)(v=h.charCodeAt(y))==34?g=!g:!g&&v in t&&(f[v]=(f[v]||0)+1);v=[];for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&v.push([f[y],y]);if(!v.length){f=r;for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&v.push([f[y],y])}return v.sort(function(x,E){return x[0]-E[0]||r[x[1]]-r[E[1]]}),t[v.pop()[1]]||44}function s(h,f){var g=f||{},y="",v=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):g&&g.FS?y=g.FS:y=i(h.slice(0,1024));var E=0,T=0,b=0,I=0,M=0,F=y.charCodeAt(0),G=!1,R=0,C=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=g.dateNF!=null?Fme(g.dateNF):null;function N(){var O=h.slice(I,M),z={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)z.t="z";else if(g.raw)z.t="s",z.v=O;else if(O.trim().length===0)z.t="s",z.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(z.t="s",z.v=O.slice(2,-1).replace(/""/g,'"')):xye(O)?(z.t="n",z.f=O.slice(1)):(z.t="s",z.v=O);else if(O=="TRUE")z.t="b",z.v=!0;else if(O=="FALSE")z.t="b",z.v=!1;else if(!isNaN(b=Vl(O)))z.t="n",g.cellText!==!1&&(z.w=O),z.v=b;else if(!isNaN(Op(O).getDate())||P&&O.match(P)){z.z=g.dateNF||Nr[14];var j=0;P&&O.match(P)&&(O=jme(O,g.dateNF,O.match(P)||[]),j=1),g.cellDates?(z.t="d",z.v=fs(O,j)):(z.t="n",z.v=Ns(fs(O,j))),g.cellText!==!1&&(z.w=wu(z.z,z.v instanceof Date?Ns(z.v):z.v)),g.cellNF||delete z.z}else z.t="s",z.v=O;if(z.t=="z"||(g.dense?(v[E]||(v[E]=[]),v[E][T]=z):v[Yn({c:T,r:E})]=z),I=M+1,C=h.charCodeAt(I),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),R==F)++T;else if(T=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;M<h.length;++M)switch(R=h.charCodeAt(M)){case 34:C===34&&(G=!G);break;case F:case 10:case 13:if(!G&&N())break e;break}return M-I>0&&N(),v["!ref"]=Yr(x),v}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):Z0(e(h,f),f)}function o(h,f){var g="",y=f.type=="string"?[0,0,0,0]:Nwe(h,f);switch(f.type){case"base64":g=Yl(h);break;case"binary":g=h;break;case"buffer":f.codepage==65001?g=h.toString("utf8"):f.codepage&&typeof xv<"u"||(g=Cn&&Buffer.isBuffer(h)?h.toString("binary"):P1(h));break;case"array":g=Jw(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+f.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=Um(g.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?g=Um(g):f.type=="binary"&&typeof xv<"u",g.slice(0,19)=="socialcalc:version:"?zV.to_sheet(f.type=="string"?g:Um(g),f):a(g,f)}function l(h,f){return Sd(o(h,f),f)}function u(h){for(var f=[],g=hr(h["!ref"]),y,v=Array.isArray(h),x=g.s.r;x<=g.e.r;++x){for(var E=[],T=g.s.c;T<=g.e.c;++T){var b=Yn({r:x,c:T});if(y=v?(h[x]||[])[T]:h[b],!y||y.v==null){E.push("          ");continue}for(var I=(y.w||(Xl(y),y.w)||"").slice(0,10);I.length<10;)I+=" ";E.push(I+(T===0?" ":""))}f.push(E.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})(),CO=(function(){function n(V,Q,ne){if(V){Hs(V,V.l||0);for(var ie=ne.Enum||le;V.l<V.length;){var pe=V.read_shift(2),De=ie[pe]||ie[65535],Be=V.read_shift(2),Ue=V.l+Be,_e=De.f&&De.f(V,Be,ne);if(V.l=Ue,Q(_e,De,pe))return}}}function e(V,Q){switch(Q.type){case"base64":return t(Qa(Yl(V)),Q);case"binary":return t(Qa(V),Q);case"buffer":case"array":return t(V,Q)}throw"Unsupported type "+Q.type}function t(V,Q){if(!V)return V;var ne=Q||{},ie=ne.dense?[]:{},pe="Sheet1",De="",Be=0,Ue={},_e=[],Ct=[],kt={s:{r:0,c:0},e:{r:0,c:0}},hn=ne.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ne.Enum=le,n(V,function(ot,Zn,on){switch(on){case 0:ne.vers=ot,ot>=4096&&(ne.qpro=!0);break;case 6:kt=ot;break;case 204:ot&&(De=ot);break;case 222:De=ot;break;case 15:case 51:ne.qpro||(ot[1].v=ot[1].v.slice(1));case 13:case 14:case 16:on==14&&(ot[2]&112)==112&&(ot[2]&15)>1&&(ot[2]&15)<15&&(ot[1].z=ne.dateNF||Nr[14],ne.cellDates&&(ot[1].t="d",ot[1].v=aV(ot[1].v))),ne.qpro&&ot[3]>Be&&(ie["!ref"]=Yr(kt),Ue[pe]=ie,_e.push(pe),ie=ne.dense?[]:{},kt={s:{r:0,c:0},e:{r:0,c:0}},Be=ot[3],pe=De||"Sheet"+(Be+1),De="");var en=ne.dense?(ie[ot[0].r]||[])[ot[0].c]:ie[Yn(ot[0])];if(en){en.t=ot[1].t,en.v=ot[1].v,ot[1].z!=null&&(en.z=ot[1].z),ot[1].f!=null&&(en.f=ot[1].f);break}ne.dense?(ie[ot[0].r]||(ie[ot[0].r]=[]),ie[ot[0].r][ot[0].c]=ot[1]):ie[Yn(ot[0])]=ot[1];break}},ne);else if(V[2]==26||V[2]==14)ne.Enum=se,V[2]==14&&(ne.qpro=!0,V.l=0),n(V,function(ot,Zn,on){switch(on){case 204:pe=ot;break;case 22:ot[1].v=ot[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ot[3]>Be&&(ie["!ref"]=Yr(kt),Ue[pe]=ie,_e.push(pe),ie=ne.dense?[]:{},kt={s:{r:0,c:0},e:{r:0,c:0}},Be=ot[3],pe="Sheet"+(Be+1)),hn>0&&ot[0].r>=hn)break;ne.dense?(ie[ot[0].r]||(ie[ot[0].r]=[]),ie[ot[0].r][ot[0].c]=ot[1]):ie[Yn(ot[0])]=ot[1],kt.e.c<ot[0].c&&(kt.e.c=ot[0].c),kt.e.r<ot[0].r&&(kt.e.r=ot[0].r);break;case 27:ot[14e3]&&(Ct[ot[14e3][0]]=ot[14e3][1]);break;case 1537:Ct[ot[0]]=ot[1],ot[0]==Be&&(pe=ot[1]);break}},ne);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(ie["!ref"]=Yr(kt),Ue[De||pe]=ie,_e.push(De||pe),!Ct.length)return{SheetNames:_e,Sheets:Ue};for(var Mt={},jn=[],Qt=0;Qt<Ct.length;++Qt)Ue[_e[Qt]]?(jn.push(Ct[Qt]||_e[Qt]),Mt[Ct[Qt]]=Ue[Ct[Qt]]||Ue[_e[Qt]]):(jn.push(Ct[Qt]),Mt[Ct[Qt]]={"!ref":"A1"});return{SheetNames:jn,Sheets:Mt}}function r(V,Q){var ne=Q||{};if(+ne.codepage>=0&&Np(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK1 to JS string");var ie=ks(),pe=hr(V["!ref"]),De=Array.isArray(V),Be=[];rt(ie,0,s(1030)),rt(ie,6,l(pe));for(var Ue=Math.min(pe.e.r,8191),_e=pe.s.r;_e<=Ue;++_e)for(var Ct=Li(_e),kt=pe.s.c;kt<=pe.e.c;++kt){_e===pe.s.r&&(Be[kt]=es(kt));var hn=Be[kt]+Ct,Mt=De?(V[_e]||[])[kt]:V[hn];if(!(!Mt||Mt.t=="z"))if(Mt.t=="n")(Mt.v|0)==Mt.v&&Mt.v>=-32768&&Mt.v<=32767?rt(ie,13,y(_e,kt,Mt.v)):rt(ie,14,x(_e,kt,Mt.v));else{var jn=Xl(Mt);rt(ie,15,f(_e,kt,jn.slice(0,239)))}}return rt(ie,1),ie.end()}function i(V,Q){var ne=Q||{};if(+ne.codepage>=0&&Np(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK3 to JS string");var ie=ks();rt(ie,0,a(V));for(var pe=0,De=0;pe<V.SheetNames.length;++pe)(V.Sheets[V.SheetNames[pe]]||{})["!ref"]&&rt(ie,27,Te(V.SheetNames[pe],De++));var Be=0;for(pe=0;pe<V.SheetNames.length;++pe){var Ue=V.Sheets[V.SheetNames[pe]];if(!(!Ue||!Ue["!ref"])){for(var _e=hr(Ue["!ref"]),Ct=Array.isArray(Ue),kt=[],hn=Math.min(_e.e.r,8191),Mt=_e.s.r;Mt<=hn;++Mt)for(var jn=Li(Mt),Qt=_e.s.c;Qt<=_e.e.c;++Qt){Mt===_e.s.r&&(kt[Qt]=es(Qt));var ot=kt[Qt]+jn,Zn=Ct?(Ue[Mt]||[])[Qt]:Ue[ot];if(!(!Zn||Zn.t=="z"))if(Zn.t=="n")rt(ie,23,N(Mt,Qt,Be,Zn.v));else{var on=Xl(Zn);rt(ie,22,R(Mt,Qt,Be,on.slice(0,239)))}}++Be}}return rt(ie,1),ie.end()}function s(V){var Q=Ce(2);return Q.write_shift(2,V),Q}function a(V){var Q=Ce(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var ne=0,ie=0,pe=0,De=0;De<V.SheetNames.length;++De){var Be=V.SheetNames[De],Ue=V.Sheets[Be];if(!(!Ue||!Ue["!ref"])){++pe;var _e=aa(Ue["!ref"]);ne<_e.e.r&&(ne=_e.e.r),ie<_e.e.c&&(ie=_e.e.c)}}return ne>8191&&(ne=8191),Q.write_shift(2,ne),Q.write_shift(1,pe),Q.write_shift(1,ie),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function o(V,Q,ne){var ie={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&ne.qpro?(ie.s.c=V.read_shift(1),V.l++,ie.s.r=V.read_shift(2),ie.e.c=V.read_shift(1),V.l++,ie.e.r=V.read_shift(2),ie):(ie.s.c=V.read_shift(2),ie.s.r=V.read_shift(2),Q==12&&ne.qpro&&(V.l+=2),ie.e.c=V.read_shift(2),ie.e.r=V.read_shift(2),Q==12&&ne.qpro&&(V.l+=2),ie.s.c==65535&&(ie.s.c=ie.e.c=ie.s.r=ie.e.r=0),ie)}function l(V){var Q=Ce(8);return Q.write_shift(2,V.s.c),Q.write_shift(2,V.s.r),Q.write_shift(2,V.e.c),Q.write_shift(2,V.e.r),Q}function u(V,Q,ne){var ie=[{c:0,r:0},{t:"n",v:0},0,0];return ne.qpro&&ne.vers!=20768?(ie[0].c=V.read_shift(1),ie[3]=V.read_shift(1),ie[0].r=V.read_shift(2),V.l+=2):(ie[2]=V.read_shift(1),ie[0].c=V.read_shift(2),ie[0].r=V.read_shift(2)),ie}function h(V,Q,ne){var ie=V.l+Q,pe=u(V,Q,ne);if(pe[1].t="s",ne.vers==20768){V.l++;var De=V.read_shift(1);return pe[1].v=V.read_shift(De,"utf8"),pe}return ne.qpro&&V.l++,pe[1].v=V.read_shift(ie-V.l,"cstr"),pe}function f(V,Q,ne){var ie=Ce(7+ne.length);ie.write_shift(1,255),ie.write_shift(2,Q),ie.write_shift(2,V),ie.write_shift(1,39);for(var pe=0;pe<ie.length;++pe){var De=ne.charCodeAt(pe);ie.write_shift(1,De>=128?95:De)}return ie.write_shift(1,0),ie}function g(V,Q,ne){var ie=u(V,Q,ne);return ie[1].v=V.read_shift(2,"i"),ie}function y(V,Q,ne){var ie=Ce(7);return ie.write_shift(1,255),ie.write_shift(2,Q),ie.write_shift(2,V),ie.write_shift(2,ne,"i"),ie}function v(V,Q,ne){var ie=u(V,Q,ne);return ie[1].v=V.read_shift(8,"f"),ie}function x(V,Q,ne){var ie=Ce(13);return ie.write_shift(1,255),ie.write_shift(2,Q),ie.write_shift(2,V),ie.write_shift(8,ne,"f"),ie}function E(V,Q,ne){var ie=V.l+Q,pe=u(V,Q,ne);if(pe[1].v=V.read_shift(8,"f"),ne.qpro)V.l=ie;else{var De=V.read_shift(2);M(V.slice(V.l,V.l+De),pe),V.l+=De}return pe}function T(V,Q,ne){var ie=Q&32768;return Q&=-32769,Q=(ie?V:0)+(Q>=8192?Q-16384:Q),(ie?"":"$")+(ne?es(Q):Li(Q))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(V,Q){Hs(V,0);for(var ne=[],ie=0,pe="",De="",Be="",Ue="";V.l<V.length;){var _e=V[V.l++];switch(_e){case 0:ne.push(V.read_shift(8,"f"));break;case 1:De=T(Q[0].c,V.read_shift(2),!0),pe=T(Q[0].r,V.read_shift(2),!1),ne.push(De+pe);break;case 2:{var Ct=T(Q[0].c,V.read_shift(2),!0),kt=T(Q[0].r,V.read_shift(2),!1);De=T(Q[0].c,V.read_shift(2),!0),pe=T(Q[0].r,V.read_shift(2),!1),ne.push(Ct+kt+":"+De+pe)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ne.push("("+ne.pop()+")");break;case 5:ne.push(V.read_shift(2));break;case 6:{for(var hn="";_e=V[V.l++];)hn+=String.fromCharCode(_e);ne.push('"'+hn.replace(/"/g,'""')+'"')}break;case 8:ne.push("-"+ne.pop());break;case 23:ne.push("+"+ne.pop());break;case 22:ne.push("NOT("+ne.pop()+")");break;case 20:case 21:Ue=ne.pop(),Be=ne.pop(),ne.push(["AND","OR"][_e-20]+"("+Be+","+Ue+")");break;default:if(_e<32&&I[_e])Ue=ne.pop(),Be=ne.pop(),ne.push(Be+I[_e]+Ue);else if(b[_e]){if(ie=b[_e][1],ie==69&&(ie=V[V.l++]),ie>ne.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+ne.join("|")+"|");return}var Mt=ne.slice(-ie);ne.length-=ie,ne.push(b[_e][0]+"("+Mt.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}ne.length==1?Q[1].f=""+ne[0]:console.error("WK1 bad formula parse |"+ne.join("|")+"|")}function F(V){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=V.read_shift(2),Q[3]=V[V.l++],Q[0].c=V[V.l++],Q}function G(V,Q){var ne=F(V);return ne[1].t="s",ne[1].v=V.read_shift(Q-4,"cstr"),ne}function R(V,Q,ne,ie){var pe=Ce(6+ie.length);pe.write_shift(2,V),pe.write_shift(1,ne),pe.write_shift(1,Q),pe.write_shift(1,39);for(var De=0;De<ie.length;++De){var Be=ie.charCodeAt(De);pe.write_shift(1,Be>=128?95:Be)}return pe.write_shift(1,0),pe}function C(V,Q){var ne=F(V);ne[1].v=V.read_shift(2);var ie=ne[1].v>>1;if(ne[1].v&1)switch(ie&7){case 0:ie=(ie>>3)*5e3;break;case 1:ie=(ie>>3)*500;break;case 2:ie=(ie>>3)/20;break;case 3:ie=(ie>>3)/200;break;case 4:ie=(ie>>3)/2e3;break;case 5:ie=(ie>>3)/2e4;break;case 6:ie=(ie>>3)/16;break;case 7:ie=(ie>>3)/64;break}return ne[1].v=ie,ne}function P(V,Q){var ne=F(V),ie=V.read_shift(4),pe=V.read_shift(4),De=V.read_shift(2);if(De==65535)return ie===0&&pe===3221225472?(ne[1].t="e",ne[1].v=15):ie===0&&pe===3489660928?(ne[1].t="e",ne[1].v=42):ne[1].v=0,ne;var Be=De&32768;return De=(De&32767)-16446,ne[1].v=(1-Be*2)*(pe*Math.pow(2,De+32)+ie*Math.pow(2,De)),ne}function N(V,Q,ne,ie){var pe=Ce(14);if(pe.write_shift(2,V),pe.write_shift(1,ne),pe.write_shift(1,Q),ie==0)return pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(2,65535),pe;var De=0,Be=0,Ue=0,_e=0;return ie<0&&(De=1,ie=-ie),Be=Math.log2(ie)|0,ie/=Math.pow(2,Be-31),_e=ie>>>0,(_e&2147483648)==0&&(ie/=2,++Be,_e=ie>>>0),ie-=_e,_e|=2147483648,_e>>>=0,ie*=Math.pow(2,32),Ue=ie>>>0,pe.write_shift(4,Ue),pe.write_shift(4,_e),Be+=16383+(De?32768:0),pe.write_shift(2,Be),pe}function O(V,Q){var ne=P(V);return V.l+=Q-14,ne}function z(V,Q){var ne=F(V),ie=V.read_shift(4);return ne[1].v=ie>>6,ne}function j(V,Q){var ne=F(V),ie=V.read_shift(8,"f");return ne[1].v=ie,ne}function be(V,Q){var ne=j(V);return V.l+=Q-10,ne}function Pe(V,Q){return V[V.l+Q-1]==0?V.read_shift(Q,"cstr"):""}function je(V,Q){var ne=V[V.l++];ne>Q-1&&(ne=Q-1);for(var ie="";ie.length<ne;)ie+=String.fromCharCode(V[V.l++]);return ie}function Ne(V,Q,ne){if(!(!ne.qpro||Q<21)){var ie=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var pe=V.read_shift(Q-21,"cstr");return[ie,pe]}}function ue(V,Q){for(var ne={},ie=V.l+Q;V.l<ie;){var pe=V.read_shift(2);if(pe==14e3){for(ne[pe]=[0,""],ne[pe][0]=V.read_shift(2);V[V.l];)ne[pe][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ne}function Te(V,Q){var ne=Ce(5+V.length);ne.write_shift(2,14e3),ne.write_shift(2,Q);for(var ie=0;ie<V.length;++ie){var pe=V.charCodeAt(ie);ne[ne.l++]=pe>127?95:pe}return ne[ne.l++]=0,ne}var le={0:{n:"BOF",f:jV},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Pe},222:{n:"SHEETNAMELP",f:je},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),E1e=/^\s|\s$|[\t\n\r]/;function $V(n,e){if(!e.bookSST)return"";var t=[qr];t[t.length]=nt("sst",null,{xmlns:q0[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(E1e)&&(s+=' xml:space="preserve"'),s+=">"+Hn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function S1e(n){return[n.read_shift(4),n.read_shift(4)]}function T1e(n,e){return e||(e=Ce(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var b1e=mpe;function I1e(n){var e=ks();Ge(e,159,T1e(n));for(var t=0;t<n.length;++t)Ge(e,19,b1e(n[t]));return Ge(e,160),e.end()}function A1e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function WV(n){var e=0,t,r=A1e(n),i=r.length+1,s,a,o,l,u;for(t=sd(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var R1e=(function(){function n(i,s){switch(s.type){case"base64":return e(Yl(i),s);case"binary":return e(i,s);case"buffer":return e(Cn&&Buffer.isBuffer(i)?i.toString("binary"):P1(i),s);case"array":return e(Jw(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var g=/\\\w+\b/g,y=0,v,x=-1;v=g.exec(h);){switch(v[0]){case"\\cell":var E=h.slice(y,g.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[f][x]=T:o[Yn({r:f,c:x})]=T}break}y=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Yr(u),o}function t(i,s){return Sd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=hr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Yn({r:u,c:h});o=l?(i[u]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Xl(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function kO(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var C1e=6,Gl=C1e;function Rv(n){return Math.floor((n+Math.round(128/Gl)/256)*Gl)}function Cv(n){return Math.floor((n-5)/Gl*100+.5)/100}function Zb(n){return Math.round((n*Gl+5)/Gl*256)/256}function fC(n){n.width?(n.wpx=Rv(n.width),n.wch=Cv(n.wpx),n.MDW=Gl):n.wpx?(n.wch=Cv(n.wpx),n.width=Zb(n.wch),n.MDW=Gl):typeof n.wch=="number"&&(n.width=Zb(n.wch),n.wpx=Rv(n.width),n.MDW=Gl),n.customWidth&&delete n.customWidth}var k1e=96,HV=k1e;function kv(n){return n*96/HV}function KV(n){return n*HV/96}function P1e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=nt("numFmt",null,{numFmtId:r,formatCode:Hn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=nt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function M1e(n){var e=[];return e[e.length]=nt("cellXfs",null),n.forEach(function(t){e[e.length]=nt("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=nt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function YV(n,e){var t=[qr,nt("styleSheet",null,{xmlns:q0[0],"xmlns:vt":gi.vt})],r;return n.SSF&&(r=P1e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=M1e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function N1e(n,e){var t=n.read_shift(2),r=ts(n);return[t,r]}function L1e(n,e,t){t||(t=Ce(6+4*e.length)),t.write_shift(2,n),yi(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function O1e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=Epe(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=wpe(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ts(n),r}function D1e(n,e){e||(e=Ce(153)),e.write_shift(2,n.sz*20),Spe(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Iv(n.color,e);var r=0;return r=2,e.write_shift(1,r),yi(n.name,e),e.length>e.l?e.slice(0,e.l):e}var F1e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],XS,j1e=nl;function PO(n,e){e||(e=Ce(84)),XS||(XS=tC(F1e));var t=XS[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(Iv({auto:1},e),Iv({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function V1e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function XV(n,e,t){t||(t=Ce(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Zg(n,e){return e||(e=Ce(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var G1e=nl;function B1e(n,e){return e||(e=Ce(51)),e.write_shift(1,0),Zg(null,e),Zg(null,e),Zg(null,e),Zg(null,e),Zg(null,e),e.length>e.l?e.slice(0,e.l):e}function U1e(n,e){return e||(e=Ce(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),bv(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function z1e(n,e,t){var r=Ce(2052);return r.write_shift(4,n),bv(e,r),bv(t,r),r.length>r.l?r.slice(0,r.l):r}function $1e(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ge(n,615,oo(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ge(n,44,L1e(i,e[i]))}),Ge(n,616))}}function W1e(n){var e=1;Ge(n,611,oo(e)),Ge(n,43,D1e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ge(n,612)}function H1e(n){var e=2;Ge(n,603,oo(e)),Ge(n,45,PO({patternType:"none"})),Ge(n,45,PO({patternType:"gray125"})),Ge(n,604)}function K1e(n){var e=1;Ge(n,613,oo(e)),Ge(n,46,B1e()),Ge(n,614)}function Y1e(n){var e=1;Ge(n,626,oo(e)),Ge(n,47,XV({numFmtId:0},65535)),Ge(n,627)}function X1e(n,e){Ge(n,617,oo(e.length)),e.forEach(function(t){Ge(n,47,XV(t,0))}),Ge(n,618)}function q1e(n){var e=1;Ge(n,619,oo(e)),Ge(n,48,U1e({xfId:0,name:"Normal"})),Ge(n,620)}function Z1e(n){var e=0;Ge(n,505,oo(e)),Ge(n,506)}function Q1e(n){var e=0;Ge(n,508,z1e(e,"TableStyleMedium9","PivotStyleMedium4")),Ge(n,509)}function J1e(n,e){var t=ks();return Ge(t,278),$1e(t,n.SSF),W1e(t),H1e(t),K1e(t),Y1e(t),X1e(t,e.cellXfs),q1e(t),Z1e(t),Q1e(t),Ge(t,279),t.end()}function qV(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[qr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function eye(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:ts(n)}}function tye(n){var e=Ce(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),yi(n.name,e),e.slice(0,e.l)}function nye(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function rye(n){var e=Ce(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function iye(n,e){var t=Ce(8+2*e.length);return t.write_shift(4,n),yi(e,t),t.slice(0,t.l)}function sye(n){return n.l+=4,n.read_shift(4)!=0}function aye(n,e){var t=Ce(8);return t.write_shift(4,n),t.write_shift(4,1),t}function oye(){var n=ks();return Ge(n,332),Ge(n,334,oo(1)),Ge(n,335,tye({name:"XLDAPR",version:12e4,flags:3496657072})),Ge(n,336),Ge(n,339,iye(1,"XLDAPR")),Ge(n,52),Ge(n,35,oo(514)),Ge(n,4096,oo(0)),Ge(n,4097,wa(1)),Ge(n,36),Ge(n,53),Ge(n,340),Ge(n,337,aye(1)),Ge(n,51,rye([[1,0]])),Ge(n,338),Ge(n,333),n.end()}function ZV(){var n=[qr];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function lye(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Yn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Wf=1024;function QV(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[nt("xml",null,{"xmlns:v":Xs.v,"xmlns:o":Xs.o,"xmlns:x":Xs.x,"xmlns:mv":Xs.mv}).replace(/\/>/,">"),nt("o:shapelayout",nt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),nt("v:shapetype",[nt("v:stroke",null,{joinstyle:"miter"}),nt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Wf<n*1e3;)Wf+=1e3;return e.forEach(function(s){var a=pi(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?nt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=nt("v:fill",l,o),h={on:"t",obscured:"t"};++Wf,i=i.concat(["<v:shape"+Fp({id:"_x0000_s"+Wf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,nt("v:shadow",null,h),nt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Mi("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Mi("x:AutoFill","False"),Mi("x:Row",String(a.r)),Mi("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function JV(n){var e=[qr,nt("comments",null,{xmlns:q0[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Hn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Hn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Mi("t",Hn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Mi("t",Hn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function cye(n,e,t){var r=[qr,nt("ThreadedComments",null,{xmlns:gi.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(nt("threadedComment",Mi("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function uye(n){var e=[qr,nt("personList",null,{xmlns:gi.TCMNT,"xmlns:x":q0[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(nt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function hye(n){var e={};e.iauthor=n.read_shift(4);var t=Ad(n);return e.rfx=t.s,e.ref=Yn(t.s),n.l+=16,e}function dye(n,e){return e==null&&(e=Ce(36)),e.write_shift(4,n[1].iauthor),Q0(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var fye=ts;function gye(n){return yi(n.slice(0,54))}function mye(n){var e=ks(),t=[];return Ge(e,628),Ge(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ge(e,632,gye(i.a)))})}),Ge(e,631),Ge(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:pi(r[0]),e:pi(r[0])};Ge(e,635,dye([s,i])),i.t&&i.t.length>0&&Ge(e,637,ype(i)),Ge(e,636),delete i.iauthor})}),Ge(e,634),Ge(e,629),e.end()}function pye(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xn.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var eG=["xlsb","xlsm","xlam","biff8","xla"],yye=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?u+=e.r:--u,i+(o?"":"$")+es(h)+(l?"":"$")+Li(u)}return function(i,s){return e=s,i.replace(n,t)}})(),gC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mC=(function(){return function(e,t){return e.replace(gC,function(r,i,s,a,o,l){var u=lC(a)-(s?0:t.c),h=oC(l)-(o?0:t.r),f=h==0?"":o?h+1:"["+h+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+g})}})();function _ye(n,e){return n.replace(gC,function(t,r,i,s,a,o){return r+(i=="$"?i+s:es(lC(s)+e.c))+(a=="$"?a+o:Li(oC(o)+e.r))})}function xye(n){return n.length!=1}function $r(n){n.l+=1}function Eu(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function tG(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return nG(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=Eu(n),o=Eu(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function nG(n){var e=Eu(n),t=Eu(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function vye(n,e,t){if(t.biff<8)return nG(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=Eu(n),a=Eu(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function rG(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return wye(n);var r=n.read_shift(t&&t.biff==12?4:2),i=Eu(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function wye(n){var e=Eu(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Eye(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Sye(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return Tye(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function Tye(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function bye(n,e,t){var r=(n[n.l++]&96)>>5,i=tG(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function Iye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=tG(n,s,t);return[r,i,a]}function Aye(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function Rye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function Cye(n,e,t){var r=(n[n.l++]&96)>>5,i=vye(n,e-1,t);return[r,i]}function kye(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function MO(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function Pye(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function Mye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Nye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Lye(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function Oye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function iG(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function Dye(n){return n.read_shift(2),iG(n)}function Fye(n){return n.read_shift(2),iG(n)}function jye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=rG(n,0,t);return[r,i]}function Vye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=Sye(n,0,t);return[r,i]}function Gye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=rG(n,0,t);return[r,i,s]}function Bye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[B_e[i],oG[i],r]}function Uye(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:zye(n);return[i,(s[0]===0?oG:G_e)[s[1]]]}function zye(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function $ye(n,e,t){n.l+=t&&t.biff==2?3:4}function Wye(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Hye(n){return n.l++,L1[n.read_shift(1)]}function Kye(n){return n.l++,n.read_shift(2)}function Yye(n){return n.l++,n.read_shift(1)!==0}function Xye(n){return n.l++,J0(n)}function qye(n,e,t){return n.l++,GV(n,e-1,t)}function Zye(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Gpe(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=L1[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=J0(n);break;case 2:t[1]=$pe(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Qye(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?Ad:Kpe)(n));return i}function Jye(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Zye(n,t.biff);return a}function e_e(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function t_e(n,e,t){if(t.biff==5)return n_e(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function n_e(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function r_e(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function i_e(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function s_e(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function a_e(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var o_e=nl,l_e=nl,c_e=nl;function O1(n,e,t){return n.l+=2,[Eye(n)]}function pC(n){return n.l+=6,[]}var u_e=O1,h_e=pC,d_e=pC,f_e=O1;function sG(n){return n.l+=2,[jV(n),n.read_shift(2)&1]}var g_e=O1,m_e=sG,p_e=pC,y_e=O1,__e=O1,x_e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function v_e(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=x_e[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function w_e(n){return n.l+=2,[n.read_shift(4)]}function E_e(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function S_e(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function T_e(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function b_e(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function I_e(n){return n.l+=4,[0,0]}var NO={1:{n:"PtgExp",f:Wye},2:{n:"PtgTbl",f:c_e},3:{n:"PtgAdd",f:$r},4:{n:"PtgSub",f:$r},5:{n:"PtgMul",f:$r},6:{n:"PtgDiv",f:$r},7:{n:"PtgPower",f:$r},8:{n:"PtgConcat",f:$r},9:{n:"PtgLt",f:$r},10:{n:"PtgLe",f:$r},11:{n:"PtgEq",f:$r},12:{n:"PtgGe",f:$r},13:{n:"PtgGt",f:$r},14:{n:"PtgNe",f:$r},15:{n:"PtgIsect",f:$r},16:{n:"PtgUnion",f:$r},17:{n:"PtgRange",f:$r},18:{n:"PtgUplus",f:$r},19:{n:"PtgUminus",f:$r},20:{n:"PtgPercent",f:$r},21:{n:"PtgParen",f:$r},22:{n:"PtgMissArg",f:$r},23:{n:"PtgStr",f:qye},26:{n:"PtgSheet",f:E_e},27:{n:"PtgEndSheet",f:S_e},28:{n:"PtgErr",f:Hye},29:{n:"PtgBool",f:Yye},30:{n:"PtgInt",f:Kye},31:{n:"PtgNum",f:Xye},32:{n:"PtgArray",f:kye},33:{n:"PtgFunc",f:Bye},34:{n:"PtgFuncVar",f:Uye},35:{n:"PtgName",f:e_e},36:{n:"PtgRef",f:jye},37:{n:"PtgArea",f:bye},38:{n:"PtgMemArea",f:r_e},39:{n:"PtgMemErr",f:o_e},40:{n:"PtgMemNoMem",f:l_e},41:{n:"PtgMemFunc",f:i_e},42:{n:"PtgRefErr",f:s_e},43:{n:"PtgAreaErr",f:Aye},44:{n:"PtgRefN",f:Vye},45:{n:"PtgAreaN",f:Cye},46:{n:"PtgMemAreaN",f:T_e},47:{n:"PtgMemNoMemN",f:b_e},57:{n:"PtgNameX",f:t_e},58:{n:"PtgRef3d",f:Gye},59:{n:"PtgArea3d",f:Iye},60:{n:"PtgRefErr3d",f:a_e},61:{n:"PtgAreaErr3d",f:Rye},255:{}},A_e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},R_e={1:{n:"PtgElfLel",f:sG},2:{n:"PtgElfRw",f:y_e},3:{n:"PtgElfCol",f:u_e},6:{n:"PtgElfRwV",f:__e},7:{n:"PtgElfColV",f:f_e},10:{n:"PtgElfRadical",f:g_e},11:{n:"PtgElfRadicalS",f:p_e},13:{n:"PtgElfColS",f:h_e},15:{n:"PtgElfColSV",f:d_e},16:{n:"PtgElfRadicalLel",f:m_e},25:{n:"PtgList",f:v_e},29:{n:"PtgSxName",f:w_e},255:{}},C_e={0:{n:"PtgAttrNoop",f:I_e},1:{n:"PtgAttrSemi",f:Oye},2:{n:"PtgAttrIf",f:Nye},4:{n:"PtgAttrChoose",f:Pye},8:{n:"PtgAttrGoto",f:Mye},16:{n:"PtgAttrSum",f:$ye},32:{n:"PtgAttrBaxcel",f:MO},33:{n:"PtgAttrBaxcel",f:MO},64:{n:"PtgAttrSpace",f:Dye},65:{n:"PtgAttrSpaceSemi",f:Fye},128:{n:"PtgAttrIfError",f:Lye},255:{}};function k_e(n,e,t,r){if(r.biff<8)return nl(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=Jye(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=Qye(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(nl(n,e)),s}function P_e(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=NO[s]||NO[A_e[s]],(s===24||s===25)&&(i=(s===24?R_e:C_e)[n[n.l+1]]),!i||!i.f?nl(n,e):a.push([i.n,i.f(n,e,t)]);return a}function M_e(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var N_e={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function L_e(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function aG(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function LO(n,e,t){var r=aG(n,e,t);return r=="#REF"?r:L_e(r,t)}function F0(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,h,f=0,g=0,y,v="";if(!n[0]||!n[0][0])return"";for(var x=-1,E="",T=0,b=n[0].length;T<b;++T){var I=n[0][T];switch(I[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(n[0][x][1][0]){case 0:E=Pr(" ",n[0][x][1][1]);break;case 1:E=Pr("\r",n[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}u=u+E,x=-1}o.push(u+N_e[I[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=$m(I[1][1],a,i),o.push(Wm(h,s));break;case"PtgRefN":h=t?$m(I[1][1],t,i):I[1][1],o.push(Wm(h,s));break;case"PtgRef3d":f=I[1][1],h=$m(I[1][2],a,i),v=LO(r,f,i),o.push(v+"!"+Wm(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=I[1][0],F=I[1][1];M||(M=0),M&=127;var G=M==0?[]:o.slice(-M);o.length-=M,F==="User"&&(F=G.shift()),o.push(F+"("+G.join(",")+")");break;case"PtgBool":o.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(I[1]);break;case"PtgNum":o.push(String(I[1]));break;case"PtgStr":o.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(I[1]);break;case"PtgAreaN":y=_O(I[1][1],t?{s:t}:a,i),o.push(KS(y,i));break;case"PtgArea":y=_O(I[1][1],a,i),o.push(KS(y,i));break;case"PtgArea3d":f=I[1][1],y=I[1][2],v=LO(r,f,i),o.push(v+"!"+KS(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=I[1][2];var R=(r.names||[])[g-1]||(r[0]||[])[g],C=R?R.Name:"SH33TJSNAME"+String(g);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var P=I[1][1];g=I[1][2];var N;if(i.biff<=5)P<0&&(P=-P),r[P]&&(N=r[P][g]);else{var O="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][g]&&r[P][g].itab>0&&(O=r.SheetNames[r[P][g].itab-1]+"!"):O=r.SheetNames[g-1]+"!"),r[P]&&r[P][g])O+=r[P][g].Name;else if(r[0]&&r[0][g])O+=r[0][g].Name;else{var z=(aG(r,P,i)||"").split(";;");z[g-1]?O=z[g-1]:O+="SH33TJSERRX"}o.push(O);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var j="(",be=")";if(x>=0){switch(E="",n[0][x][1][0]){case 2:j=Pr(" ",n[0][x][1][1])+j;break;case 3:j=Pr("\r",n[0][x][1][1])+j;break;case 4:be=Pr(" ",n[0][x][1][1])+be;break;case 5:be=Pr("\r",n[0][x][1][1])+be;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}o.push(j+o.pop()+be);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:I[1][1],r:I[1][0]};var Pe={c:t.c,r:t.r};if(r.sharedf[Yn(h)]){var je=r.sharedf[Yn(h)];o.push(F0(je,a,Pe,r,i))}else{var Ne=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(F0(u[1],a,Pe,r,i)),Ne=!0;break}Ne||o.push(I[1])}break;case"PtgArray":o.push("{"+M_e(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ue.indexOf(n[0][T][0])==-1){I=n[0][x];var Te=!0;switch(I[1][0]){case 4:Te=!1;case 0:E=Pr(" ",I[1][1]);break;case 5:Te=!1;case 1:E=Pr("\r",I[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}o.push((Te?E:"")+o.pop()+(Te?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function O_e(n){if(n==null){var e=Ce(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return ad(n);return ad(0)}function D_e(n,e,t,r,i){var s=od(e,t,i),a=O_e(n.v),o=Ce(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Ce(n.bf.length),h=0;h<n.bf.length;++h)u[h]=n.bf[h];var f=Pi([s,a,o,u]);return f}function eE(n,e,t){var r=n.read_shift(4),i=P_e(n,r,t),s=n.read_shift(4),a=s>0?k_e(n,s,i,t):null;return[i,a]}var F_e=eE,tE=eE,j_e=eE,V_e=eE,G_e={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oG={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},B_e={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function U_e(n){var e="of:="+n.replace(gC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function z_e(n){return n.replace(/\./,"!")}var Hm=typeof Map<"u";function yC(n,e,t){var r=0,i=n.length;if(t){if(Hm?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Hm?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(Hm?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function nE(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(Gl=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=Cv(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=Zb(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function lG(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Mu(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){rV(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function $_e(n,e,t){if(n&&n["!ref"]){var r=hr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function W_e(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+Yr(n[t])+'"/>';return e+"</mergeCells>"}function H_e(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=Dp(Hn(l))}if(n&&n["!outline"]){var u={summaryBelow:1,summaryRight:1};n["!outline"].above&&(u.summaryBelow=0),n["!outline"].left&&(u.summaryRight=0),o=(o||"")+nt("outlinePr",null,u)}!s&&!o||(i[i.length]=nt("sheetPr",o,a))}var K_e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Y_e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function X_e(n){var e={sheet:1};return K_e.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),Y_e.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=WV(n.password).toString(16).toUpperCase()),nt("sheetProtection",null,e)}function q_e(n){return lG(n),nt("pageMargins",null,n)}function Z_e(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=nt("col",null,nE(i,r)));return t[t.length]="</cols>",t.join("")}function Q_e(n,e,t,r){var i=typeof n.ref=="string"?n.ref:Yr(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=aa(i);a.s.r==a.e.r&&(a.e.r=aa(e["!ref"]).e.r,i=Yr(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),nt("autoFilter",null,{ref:i})}function J_e(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),nt("sheetViews",nt("sheetView",null,i),{})}function exe(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=L1[n.v];break;case"d":r&&r.cellDates?i=fs(n.v,-1).toISOString():(n=Ls(n),n.t="n",i=""+(n.v=Ns(fs(n.v)))),typeof n.z>"u"&&(n.z=Nr[14]);break;default:i=n.v;break}var o=Mi("v",Hn(i)),l={r:e},u=Mu(r.cellXfs,n,r);switch(u!==0&&(l.s=u),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Mi("v",""+yC(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=nt("f",Hn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),nt("c",o,l)}function txe(n,e,t,r){var i=[],s=[],a=hr(n["!ref"]),o="",l,u="",h=[],f=0,g=0,y=n["!rows"],v=Array.isArray(n),x={r:u},E,T=-1;for(g=a.s.c;g<=a.e.c;++g)h[g]=es(g);for(f=a.s.r;f<=a.e.r;++f){for(s=[],u=Li(f),g=a.s.c;g<=a.e.c;++g){l=h[g]+u;var b=v?(n[f]||[])[g]:n[l];b!==void 0&&(o=exe(b,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[f])&&(x={r:u},y&&y[f]&&(E=y[f],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=kv(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=nt("row",s.join(""),x))}if(y)for(;f<y.length;++f)y&&y[f]&&(x={r:f+1},E=y[f],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=kv(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=nt("row","",x));return i.join("")}function cG(n,e,t,r){var i=[qr,nt("worksheet",null,{xmlns:q0[0],"xmlns:r":gi.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",h=hr(u);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=Yr(h)}r||(r={}),l["!comments"]=[];var f=[];H_e(l,t,n,e,i),i[i.length]=nt("dimension",null,{ref:u}),i[i.length]=J_e(l,e,n,t),e.sheetFormat&&(i[i.length]=nt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Z_e(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=txe(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=X_e(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Q_e(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=W_e(l["!merges"]));var g=-1,y,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(y={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=zn(r,-1,Hn(x[1].Target).replace(/#.*$/,""),Tn.HLINK),y["r:id"]="rId"+v),(g=x[1].Target.indexOf("#"))>-1&&(y.location=Hn(x[1].Target.slice(g+1))),x[1].Tooltip&&(y.tooltip=Hn(x[1].Tooltip)),i[i.length]=nt("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=q_e(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Mi("ignoredErrors",nt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(v=zn(r,-1,"../drawings/drawing"+(n+1)+".xml",Tn.DRAW),i[i.length]=nt("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=f),l["!comments"].length>0&&(v=zn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Tn.VML),i[i.length]=nt("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function nxe(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function rxe(n,e,t){var r=Ce(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=kv(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var u={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,g=-1,y=h<<10;y<h+1<<10;++y){u.c=y;var v=Array.isArray(t)?(t[u.r]||[])[u.c]:t[Yn(u)];v&&(f<0&&(f=y),g=y)}f<0||(++o,r.write_shift(4,f),r.write_shift(4,g))}var x=r.l;return r.l=l,r.write_shift(4,o),r.l=x,r.length>r.l?r.slice(0,r.l):r}function ixe(n,e,t,r){var i=rxe(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ge(n,0,i)}var sxe=Ad,axe=Q0;function oxe(){}function lxe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=_pe(n),t}function cxe(n,e,t){t==null&&(t=Ce(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return Iv({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),TV(n,t),t.slice(0,t.l)}function uxe(n){var e=Na(n);return[e]}function hxe(n,e,t){return t==null&&(t=Ce(8)),Td(e,t)}function dxe(n){var e=bd(n);return[e]}function fxe(n,e,t){return t==null&&(t=Ce(4)),Id(e,t)}function gxe(n){var e=Na(n),t=n.read_shift(1);return[e,t,"b"]}function mxe(n,e,t){return t==null&&(t=Ce(9)),Td(e,t),t.write_shift(1,n.v?1:0),t}function pxe(n){var e=bd(n),t=n.read_shift(1);return[e,t,"b"]}function yxe(n,e,t){return t==null&&(t=Ce(5)),Id(e,t),t.write_shift(1,n.v?1:0),t}function _xe(n){var e=Na(n),t=n.read_shift(1);return[e,t,"e"]}function xxe(n,e,t){return t==null&&(t=Ce(9)),Td(e,t),t.write_shift(1,n.v),t}function vxe(n){var e=bd(n),t=n.read_shift(1);return[e,t,"e"]}function wxe(n,e,t){return t==null&&(t=Ce(8)),Id(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function Exe(n){var e=Na(n),t=n.read_shift(4);return[e,t,"s"]}function Sxe(n,e,t){return t==null&&(t=Ce(12)),Td(e,t),t.write_shift(4,e.v),t}function Txe(n){var e=bd(n),t=n.read_shift(4);return[e,t,"s"]}function bxe(n,e,t){return t==null&&(t=Ce(8)),Id(e,t),t.write_shift(4,e.v),t}function Ixe(n){var e=Na(n),t=J0(n);return[e,t,"n"]}function Axe(n,e,t){return t==null&&(t=Ce(16)),Td(e,t),ad(n.v,t),t}function Rxe(n){var e=bd(n),t=J0(n);return[e,t,"n"]}function Cxe(n,e,t){return t==null&&(t=Ce(12)),Id(e,t),ad(n.v,t),t}function kxe(n){var e=Na(n),t=bV(n);return[e,t,"n"]}function Pxe(n,e,t){return t==null&&(t=Ce(12)),Td(e,t),IV(n.v,t),t}function Mxe(n){var e=bd(n),t=bV(n);return[e,t,"n"]}function Nxe(n,e,t){return t==null&&(t=Ce(8)),Id(e,t),IV(n.v,t),t}function Lxe(n){var e=Na(n),t=cC(n);return[e,t,"is"]}function Oxe(n){var e=Na(n),t=ts(n);return[e,t,"str"]}function Dxe(n,e,t){return t==null&&(t=Ce(12+4*n.v.length)),Td(e,t),yi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function Fxe(n){var e=bd(n),t=ts(n);return[e,t,"str"]}function jxe(n,e,t){return t==null&&(t=Ce(8+4*n.v.length)),Id(e,t),yi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function Vxe(n,e,t){var r=n.l+e,i=Na(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=tE(n,r-n.l,t);a[3]=F0(o,null,i,t.supbooks,t)}else n.l=r;return a}function Gxe(n,e,t){var r=n.l+e,i=Na(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=tE(n,r-n.l,t);a[3]=F0(o,null,i,t.supbooks,t)}else n.l=r;return a}function Bxe(n,e,t){var r=n.l+e,i=Na(n);i.r=t["!row"];var s=J0(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=tE(n,r-n.l,t);a[3]=F0(o,null,i,t.supbooks,t)}else n.l=r;return a}function Uxe(n,e,t){var r=n.l+e,i=Na(n);i.r=t["!row"];var s=ts(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=tE(n,r-n.l,t);a[3]=F0(o,null,i,t.supbooks,t)}else n.l=r;return a}var zxe=Ad,$xe=Q0;function Wxe(n,e){return e==null&&(e=Ce(4)),e.write_shift(4,n),e}function Hxe(n,e){var t=n.l+e,r=Ad(n),i=uC(n),s=ts(n),a=ts(n),o=ts(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function Kxe(n,e){var t=Ce(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Q0({s:pi(n[0]),e:pi(n[0])},t),hC("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return yi(i||"",t),yi(n[1].Tooltip||"",t),yi("",t),t.slice(0,t.l)}function Yxe(){}function Xxe(n,e,t){var r=n.l+e,i=AV(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=F_e(n,r-n.l,t);a[1]=o}else n.l=r;return a}function qxe(n,e,t){var r=n.l+e,i=Ad(n),s=[i];if(t.cellFormula){var a=V_e(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function Zxe(n,e,t){t==null&&(t=Ce(18));var r=nE(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var uG=["left","right","top","bottom","header","footer"];function Qxe(n){var e={};return uG.forEach(function(t){e[t]=J0(n)}),e}function Jxe(n,e){return e==null&&(e=Ce(48)),lG(n),uG.forEach(function(t){ad(n[t],e)}),e}function eve(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function tve(n,e,t){t==null&&(t=Ce(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function nve(n){var e=Ce(24);return e.write_shift(4,4),e.write_shift(4,1),Q0(n,e),e}function rve(n,e){return e==null&&(e=Ce(66)),e.write_shift(2,n.password?WV(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function ive(){}function sve(){}function ave(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ls(e),e.z=e.z||Nr[14],e.v=Ns(fs(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Mu(i.cellXfs,e,i),e.l&&s["!links"].push([Yn(l),e.l]),e.c&&s["!comments"].push([Yn(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=yC(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ge(n,18,bxe(e,l)):Ge(n,7,Sxe(e,l))):(l.t="str",a?Ge(n,17,jxe(e,l)):Ge(n,6,Dxe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ge(n,13,Nxe(e,l)):Ge(n,2,Pxe(e,l)):a?Ge(n,16,Cxe(e,l)):Ge(n,5,Axe(e,l)),!0;case"b":return l.t="b",a?Ge(n,15,yxe(e,l)):Ge(n,4,mxe(e,l)),!0;case"e":return l.t="e",a?Ge(n,14,wxe(e,l)):Ge(n,3,xxe(e,l)),!0}return a?Ge(n,12,fxe(e,l)):Ge(n,1,hxe(e,l)),!0}function ove(n,e,t,r){var i=hr(e["!ref"]||"A1"),s,a="",o=[];Ge(n,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=u;++h){a=Li(h),ixe(n,e,i,h);var f=!1;if(h<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){h===i.s.r&&(o[g]=es(g)),s=o[g]+a;var y=l?(e[h]||[])[g]:e[s];if(!y){f=!1;continue}f=ave(n,y,h,g,r,e,f)}}Ge(n,146)}function lve(n,e){!e||!e["!merges"]||(Ge(n,177,Wxe(e["!merges"].length)),e["!merges"].forEach(function(t){Ge(n,176,$xe(t))}),Ge(n,178))}function cve(n,e){!e||!e["!cols"]||(Ge(n,390),e["!cols"].forEach(function(t,r){t&&Ge(n,60,Zxe(r,t))}),Ge(n,391))}function uve(n,e){!e||!e["!ref"]||(Ge(n,648),Ge(n,649,nve(hr(e["!ref"]))),Ge(n,650))}function hve(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=zn(t,-1,r[1].Target.replace(/#.*$/,""),Tn.HLINK);Ge(n,494,Kxe(r,i))}}),delete e["!links"]}function dve(n,e,t,r){if(e["!comments"].length>0){var i=zn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Tn.VML);Ge(n,551,hC("rId"+i)),e["!legacy"]=i}}function fve(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Yr(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=aa(s);o.s.r==o.e.r&&(o.e.r=aa(e["!ref"]).e.r,s=Yr(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ge(n,161,Q0(hr(s))),Ge(n,162)}}function gve(n,e,t){Ge(n,133),Ge(n,137,tve(e,t)),Ge(n,138),Ge(n,134)}function mve(n,e){e["!protect"]&&Ge(n,535,rve(e["!protect"]))}function pve(n,e,t,r){var i=ks(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=hr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ge(i,129),(t.vbaraw||a["!outline"])&&Ge(i,147,cxe(o,a["!outline"])),Ge(i,148,axe(l)),gve(i,a,t.Workbook),cve(i,a),ove(i,a,n,e),mve(i,a),fve(i,a,t,n),lve(i,a),hve(i,a,r),a["!margins"]&&Ge(i,476,Jxe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&uve(i,a),dve(i,a,n,r),Ge(i,130),i.end()}function yve(n,e){n.l+=10;var t=ts(n);return{name:t}}var _ve=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function xve(n){return!n.Workbook||!n.Workbook.WBProps?"false":qme(n.Workbook.WBProps.date1904)?"true":"false"}var vve="][*?/\\".split("");function hG(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return vve.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function wve(n,e,t){n.forEach(function(r,i){hG(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Eve(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];wve(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)$_e(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function dG(n){var e=[qr];e[e.length]=nt("workbook",null,{xmlns:q0[0],"xmlns:r":gi.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(_ve.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=nt("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Hn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=nt("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=nt("definedName",Hn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Sve(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=qb(n),t.name=ts(n),t}function Tve(n,e){return e||(e=Ce(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),hC(n.strRelID,e),yi(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function bve(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?ts(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function Ive(n,e){e||(e=Ce(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),TV(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Ave(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=xpe(n),a=j_e(n,0,t),o=uC(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function Rve(n,e){Ge(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ge(n,156,Tve(i))}Ge(n,144)}function Cve(n,e){e||(e=Ce(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return yi("SheetJS",e),yi(_v.version,e),yi(_v.version,e),yi("7262",e),e.length>e.l?e.slice(0,e.l):e}function kve(n,e){e||(e=Ce(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function Pve(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ge(n,135),Ge(n,158,kve(i)),Ge(n,136))}}function Mve(n,e){var t=ks();return Ge(t,131),Ge(t,128,Cve()),Ge(t,153,Ive(n.Workbook&&n.Workbook.WBProps||null)),Pve(t,n),Rve(t,n),Ge(t,132),t.end()}function Nve(n,e,t){return(e.slice(-4)===".bin"?Mve:dG)(n)}function Lve(n,e,t,r,i){return(e.slice(-4)===".bin"?pve:cG)(n,t,r,i)}function Ove(n,e,t){return(e.slice(-4)===".bin"?J1e:YV)(n,t)}function Dve(n,e,t){return(e.slice(-4)===".bin"?I1e:$V)(n,t)}function Fve(n,e,t){return(e.slice(-4)===".bin"?mye:JV)(n)}function jve(n){return(n.slice(-4)===".bin"?oye:ZV)()}function Vve(n,e){var t=[];return n.Props&&t.push(Ope(n.Props,e)),n.Custprops&&t.push(Dpe(n.Props,n.Custprops)),t.join("")}function Gve(){return""}function Bve(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(nt("NumberFormat",null,{"ss:Format":Hn(Nr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(nt("Style",s.join(""),a))}),nt("Styles",t.join(""))}function fG(n){return nt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+mC(n.Ref,{r:0,c:0})})}function Uve(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(fG(i)))}return nt("Names",t.join(""))}function zve(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(fG(o)))}return s.join("")}function $ve(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(nt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(nt("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(nt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(nt("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Mi("ProtectContents","True")),n["!protect"].objects&&i.push(Mi("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Mi("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Mi("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Mi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":nt("WorksheetOptions",i.join(""),{xmlns:Xs.x})}function Wve(n){return n.map(function(e){var t=Xme(e.t||""),r=nt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return nt("Comment",r,{"ss:Author":e.a})}).join("")}function Hve(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Hn(mC(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=pi(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Hn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Hn(n.l.Tooltip))),t["!merges"])for(var u=t["!merges"],h=0;h!=u.length;++h)u[h].s.c!=a.c||u[h].s.r!=a.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",g="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",g=String(n.v);break;case"b":f="Boolean",g=n.v?"1":"0";break;case"e":f="Error",g=L1[n.v];break;case"d":f="DateTime",g=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Nr[14]);break;case"s":f="String",g=Yme(n.v||"");break}var y=Mu(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var v=n.v!=null?g:"",x=n.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(n.c||[]).length>0&&(x+=Wve(n.c)),nt("Cell",x,o)}function Kve(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=KV(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Yve(n,e,t,r){if(!n["!ref"])return"";var i=hr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(E,T){fC(E);var b=!!E.width,I=nE(T,E),M={"ss:Index":T+1};b&&(M["ss:Width"]=Rv(I.width)),E.hidden&&(M["ss:Hidden"]="1"),o.push(nt("Column",null,M))});for(var l=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){for(var h=[Kve(u,(n["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>u)&&!(s[a].e.c<f)&&!(s[a].e.r<u)){(s[a].s.c!=f||s[a].s.r!=u)&&(g=!0);break}if(!g){var y={r:u,c:f},v=Yn(y),x=l?(n[u]||[])[f]:n[v];h.push(Hve(x,v,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Xve(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?zve(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?Yve(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push($ve(s,e,n,t)),r.join("")}function qve(n,e){e||(e={}),n.SSF||(n.SSF=Ls(Nr)),n.SSF&&(Zw(),qw(n.SSF),e.revssf=Qw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Mu(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Vve(n,e)),t.push(Gve()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(nt("Worksheet",Xve(r,e,n),{"ss:Name":Hn(n.SheetNames[r])}));return t[2]=Bve(n,e),t[3]=Uve(n),qr+nt("Workbook",t.join(""),{xmlns:Xs.ss,"xmlns:o":Xs.o,"xmlns:x":Xs.x,"xmlns:ss":Xs.ss,"xmlns:dt":Xs.dt,"xmlns:html":Xs.html})}var qS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Zve(n,e){var t=[],r=[],i=[],s=0,a,o=oO(vO,"n"),l=oO(wO,"n");if(n.Props)for(a=Oi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Oi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)FV.indexOf(i[s][0])>-1||LV.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&Xn.utils.cfb_add(e,"/SummaryInformation",IO(r,qS.SI,l,wO)),(t.length||u.length)&&Xn.utils.cfb_add(e,"/DocumentSummaryInformation",IO(t,qS.DSI,o,vO,u.length?u:null,qS.UDI))}function Qve(n,e){var t=e||{},r=Xn.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Xn.utils.cfb_add(r,i,gG(n,t)),t.biff==8&&(n.Props||n.Custprops)&&Zve(n,r),t.biff==8&&n.vbaraw&&pye(r,Xn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var Jve={0:{f:nxe},1:{f:uxe},2:{f:kxe},3:{f:_xe},4:{f:gxe},5:{f:Ixe},6:{f:Oxe},7:{f:Exe},8:{f:Uxe},9:{f:Bxe},10:{f:Vxe},11:{f:Gxe},12:{f:dxe},13:{f:Mxe},14:{f:vxe},15:{f:pxe},16:{f:Rxe},17:{f:Fxe},18:{f:Txe},19:{f:cC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Ave},40:{},42:{},43:{f:O1e},44:{f:N1e},45:{f:j1e},46:{f:G1e},47:{f:V1e},48:{},49:{f:dpe},50:{},51:{f:nye},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:f1e},62:{f:Lxe},63:{f:lye},64:{f:ive},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nl,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eve},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:lxe},148:{f:sxe,p:16},151:{f:Yxe},152:{},153:{f:bve},154:{},155:{},156:{f:Sve},157:{},158:{},159:{T:1,f:S1e},160:{T:-1},161:{T:1,f:Ad},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zxe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:eye},336:{T:-1},337:{f:sye,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qb},357:{},358:{},359:{},360:{T:1},361:{},362:{f:o1e},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Xxe},427:{f:qxe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Qxe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:oxe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Hxe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qb},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fye},633:{T:1},634:{T:-1},635:{T:1,f:hye},636:{T:-1},637:{f:ppe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yve},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:sve},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function rt(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&aC(t)&&n.push(t)}}function ewe(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return rt(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u;l<i;){for(h=n.next(4),h.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u}}}function D1(n,e,t){return n||(n=Ce(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function twe(n,e,t,r){var i=Ce(9);return D1(i,n,e),VV(t,r||"b",i),i}function nwe(n,e,t){var r=Ce(8+2*t.length);return D1(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function rwe(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ns(fs(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?rt(n,2,y1e(t,r,i)):rt(n,3,p1e(t,r,i));return;case"b":case"e":rt(n,5,twe(t,r,e.v,e.t));return;case"s":case"str":rt(n,4,nwe(t,r,(e.v||"").slice(0,255)));return}rt(n,1,D1(null,t,r))}function iwe(n,e,t,r){var i=Array.isArray(e),s=hr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Yr(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Li(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=es(h)),a=l[h]+o;var f=i?(e[u]||[])[h]:e[a];f&&rwe(n,f,u,h)}}}function swe(n,e){for(var t=e||{},r=ks(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return rt(r,t.biff==4?1033:t.biff==3?521:9,dC(n,16,t)),iwe(r,n.Sheets[n.SheetNames[i]],i,t),rt(r,10),r.end()}function awe(n,e,t){rt(n,49,Jpe({sz:12,name:"Arial"},t))}function owe(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&rt(n,1054,n1e(i,e[i],t))})}function lwe(n,e){var t=Ce(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),rt(n,2151,t),t=Ce(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),UV(hr(e["!ref"]||"A1"),t),t.write_shift(4,4),rt(n,2152,t)}function cwe(n,e){for(var t=0;t<16;++t)rt(n,224,RO({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){rt(n,224,RO(r,0,e))})}function uwe(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];rt(n,440,u1e(r)),r[1].Tooltip&&rt(n,2048,h1e(r))}delete e["!links"]}function hwe(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&rt(n,125,g1e(nE(i,r),i))})}}function dwe(n,e,t,r,i){var s=16+Mu(i.cellXfs,e,i);if(e.v==null&&!e.bf){rt(n,513,od(t,r,s));return}if(e.bf)rt(n,6,D_e(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ns(fs(e.v)):e.v;rt(n,515,a1e(t,r,a,s));break;case"b":case"e":rt(n,517,s1e(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=yC(i.Strings,e.v,i.revStrings);rt(n,253,e1e(t,r,o,s))}else rt(n,516,t1e(t,r,(e.v||"").slice(0,255),s,i));break;default:rt(n,513,od(t,r,s))}}function fwe(n,e,t){var r=ks(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),u=e.biff==8,h,f="",g=[],y=hr(s["!ref"]||"A1"),v=u?65536:16384;if(y.e.c>255||y.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}rt(r,2057,dC(t,16,e)),rt(r,13,wa(1)),rt(r,12,wa(100)),rt(r,15,as(!0)),rt(r,17,as(!1)),rt(r,16,ad(.001)),rt(r,95,as(!0)),rt(r,42,as(!1)),rt(r,43,as(!1)),rt(r,130,wa(1)),rt(r,128,i1e()),rt(r,131,as(!1)),rt(r,132,as(!1)),u&&hwe(r,s["!cols"]),rt(r,512,r1e(y,e)),u&&(s["!links"]=[]);for(var x=y.s.r;x<=y.e.r;++x){f=Li(x);for(var E=y.s.c;E<=y.e.c;++E){x===y.s.r&&(g[E]=es(E)),h=g[E]+f;var T=l?(s[x]||[])[E]:s[h];T&&(dwe(r,T,x,E,e),u&&T.l&&s["!links"].push([h,T.l]))}}var b=o.CodeName||o.name||i;return u&&rt(r,574,Qpe((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&rt(r,229,c1e(s["!merges"])),u&&uwe(r,s),rt(r,442,BV(b)),u&&lwe(r,s),rt(r,10),r.end()}function gwe(n,e,t){var r=ks(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(rt(r,2057,dC(n,5,t)),t.bookType=="xla"&&rt(r,135),rt(r,225,o?wa(1200):null),rt(r,193,Vpe(2)),l&&rt(r,191),l&&rt(r,192),rt(r,226),rt(r,92,Ype("SheetJS",t)),rt(r,66,wa(o?1200:1252)),o&&rt(r,353,wa(0)),o&&rt(r,448),rt(r,317,m1e(n.SheetNames.length)),o&&n.vbaraw&&rt(r,211),o&&n.vbaraw){var u=a.CodeName||"ThisWorkbook";rt(r,442,BV(u))}rt(r,156,wa(17)),rt(r,25,as(!1)),rt(r,18,as(!1)),rt(r,19,wa(0)),o&&rt(r,431,as(!1)),o&&rt(r,444,wa(0)),rt(r,61,Zpe()),rt(r,64,as(!1)),rt(r,141,wa(0)),rt(r,34,as(xve(n)=="true")),rt(r,14,as(!0)),o&&rt(r,439,as(!1)),rt(r,218,wa(0)),awe(r,n,t),owe(r,n.SSF,t),cwe(r,t),o&&rt(r,352,as(!1));var h=r.end(),f=ks();o&&rt(f,140,d1e()),o&&t.Strings&&ewe(f,252,qpe(t.Strings)),rt(f,10);var g=f.end(),y=ks(),v=0,x=0;for(x=0;x<n.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*n.SheetNames[x].length;var E=h.length+v+g.length;for(x=0;x<n.SheetNames.length;++x){var T=s[x]||{};rt(y,133,Xpe({pos:E,hs:T.Hidden||0,dt:0,name:n.SheetNames[x]},t)),E+=e[x].length}var b=y.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var I=[];return h.length&&I.push(h),b.length&&I.push(b),g.length&&I.push(g),Pi(I)}function mwe(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Ls(Nr)),n&&n.SSF&&(Zw(),qw(n.SSF),t.revssf=Qw(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_C(t),t.cellXfs=[],Mu(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=fwe(i,t,n);return r.unshift(gwe(n,r,t)),Pi(r)}function gG(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=aa(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return mwe(n,e);case 4:case 3:case 2:return swe(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function pwe(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>t||i[u].s.c>a)&&!(i[u].e.r<t||i[u].e.c<a)){if(i[u].s.r<t||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var h=Yn({r:t,c:a}),f=r.dense?(n[t]||[])[a]:n[h],g=f&&f.v!=null&&(f.h||Kme(f.w||(Xl(f),f.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?g='<span contenteditable="true">'+g+"</span>":f&&(y["data-t"]=f&&f.t||"z",f.v!=null&&(y["data-v"]=f.v),f.z!=null&&(y["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+f.l.Target+'">'+g+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(nt("td",g,y))}}var v="<tr>";return v+s.join("")+"</tr>"}var ywe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_we="</body></html>";function xwe(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function mG(n,e){var t=e||{},r=t.header!=null?t.header:ywe,i=t.footer!=null?t.footer:_we,s=[r],a=aa(n["!ref"]);t.dense=Array.isArray(n),s.push(xwe(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(pwe(n,a,o,t));return s.push("</table>"+i),s.join("")}function pG(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?pi(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=aa(n["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var f=[],g=0,y=n["!rows"]||(n["!rows"]=[]),v=0,x=0,E=0,T=0,b=0,I=0;for(n["!cols"]||(n["!cols"]=[]);v<o.length&&x<l;++v){var M=o[v];if(OO(M)){if(r.display)continue;y[x]={hidden:!0}}var F=M.children;for(E=T=0;E<F.length;++E){var G=F[E];if(!(r.display&&OO(G))){var R=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):Zme(G.innerHTML),C=G.getAttribute("data-z")||G.getAttribute("z");for(g=0;g<f.length;++g){var P=f[g];P.s.c==T+s&&P.s.r<x+i&&x+i<=P.e.r&&(T=P.e.c+1-s,g=-1)}I=+G.getAttribute("colspan")||1,((b=+G.getAttribute("rowspan")||1)>1||I>1)&&f.push({s:{r:x+i,c:T+s},e:{r:x+i+(b||1)-1,c:T+s+(I||1)-1}});var N={t:"s",v:R},O=G.getAttribute("data-t")||G.getAttribute("t")||"";R!=null&&(R.length==0?N.t=O||"z":r.raw||R.trim().length==0||O=="s"||(R==="TRUE"?N={t:"b",v:!0}:R==="FALSE"?N={t:"b",v:!1}:isNaN(Vl(R))?isNaN(Op(R).getDate())||(N={t:"d",v:fs(R)},r.cellDates||(N={t:"n",v:Ns(N.v)}),N.z=r.dateNF||Nr[14]):N={t:"n",v:Vl(R)})),N.z===void 0&&C!=null&&(N.z=C);var z="",j=G.getElementsByTagName("A");if(j&&j.length)for(var be=0;be<j.length&&!(j[be].hasAttribute("href")&&(z=j[be].getAttribute("href"),z.charAt(0)!="#"));++be);z&&z.charAt(0)!="#"&&(N.l={Target:z}),r.dense?(n[x+i]||(n[x+i]=[]),n[x+i][T+s]=N):n[Yn({c:T+s,r:x+i})]=N,u.e.c<T+s&&(u.e.c=T+s),T+=I}}++x}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+i),n["!ref"]=Yr(u),x>=l&&(n["!fullref"]=Yr((u.e.r=o.length-v+x-1+i,u))),n}function yG(n,e){var t=e||{},r=t.dense?[]:{};return pG(r,n,e)}function vwe(n,e){return Sd(yG(n,e),e)}function OO(n){var e="",t=wwe(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function wwe(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Ewe=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Fp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return qr+e}})(),DO=(function(){var n=function(s){return Hn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Hn(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,f=aa(s["!ref"]||"A1"),g=s["!merges"]||[],y=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(u=0;u<f.s.r;++u)x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)l.push(e);for(;h<=f.e.c;++h){var T=!1,b={},I="";for(y=0;y!=g.length;++y)if(!(g[y].s.c>h)&&!(g[y].s.r>u)&&!(g[y].e.c<h)&&!(g[y].e.r<u)){(g[y].s.c!=h||g[y].s.r!=u)&&(T=!0),b["table:number-columns-spanned"]=g[y].e.c-g[y].s.c+1,b["table:number-rows-spanned"]=g[y].e.r-g[y].s.r+1;break}if(T){l.push(t);continue}var M=Yn({r:u,c:h}),F=v?(s[u]||[])[h]:s[M];if(F&&F.f&&(b["table:formula"]=Hn(U_e(F.f)),F.F&&F.F.slice(0,M.length)==M)){var G=aa(F.F);b["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,b["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!F){l.push(e);continue}switch(F.t){case"b":I=F.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=F.v?"true":"false";break;case"n":I=F.w||String(F.v||0),b["office:value-type"]="float",b["office:value"]=F.v||0;break;case"s":case"str":I=F.v==null?"":F.v,b["office:value-type"]="string";break;case"d":I=F.w||fs(F.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=fs(F.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var R=n(I);if(F.l&&F.l.Target){var C=F.l.Target;C=C.charAt(0)=="#"?"#"+z_e(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),R=nt("text:a",R,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+nt("table:table-cell",nt("text:p",R,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;fC(f),f.ods=o;var g=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=l;var f=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[qr],u=Fp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Fp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+h+`>
`),l.push(MV().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(r(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function _G(n,e){if(e.bookType=="fods")return DO(n,e);var t=nC(),r="",i=[],s=[];return r="mimetype",nn(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",nn(t,r,DO(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",nn(t,r,Ewe(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",nn(t,r,qr+MV()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",nn(t,r,Lpe(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",nn(t,r,Mpe(i)),t}function Pv(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Swe(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Qa(Dp(n))}function Twe(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Su(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function bwe(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function jp(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Un(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function c0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function ei(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=jp(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=jp(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function bi(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Un(r*8+i.type)),i.type==2&&e.push(Un(i.data.length)),e.push(i.data))})}),Su(e)}function za(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=jp(n,r),s=ei(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:c0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=ei(o.data),u=c0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+u)}),r[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=c0(s[3][0].data)>>>0>0),t.push(a)}return t}function vf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Un(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Un(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Un(a.data.length)}],r[2].push({data:bi(a.meta),type:2})});var s=bi(r);e.push(Un(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Su(e)}function Iwe(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=jp(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Su(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var h=Su(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function $a(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(Iwe(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Su(e)}function wf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Un(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Su(e)}function ZS(n,e){var t=new Uint8Array(32),r=Pv(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,bwe(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function QS(n,e){var t=new Uint8Array(32),r=Pv(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Nc(n){var e=ei(n);return jp(e[1][0].data)}function Awe(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&c0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Pv(n[7][0].data),h=0,f=[],g=Pv(n[4][0].data),y=0,v=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,h,!0),g.setUint16(x*2,y,!0);var E,T;switch(typeof e[x]){case"string":E=ZS({t:"s",v:e[x]},t),T=QS({t:"s",v:e[x]},t);break;case"number":E=ZS({t:"n",v:e[x]},t),T=QS({t:"n",v:e[x]},t);break;case"boolean":E=ZS({t:"b",v:e[x]},t),T=QS({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}f.push(E),h+=E.length,v.push(T),y+=T.length,++l}for(n[2][0].data=Un(l);x<n[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return n[6][0].data=Su(f),n[3][0].data=Su(v),l}function Rwe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=aa(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Yr(r)));var s=Mv(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(Q){return Q.forEach(function(ne){typeof ne=="string"&&a.push(ne)})});var o={},l=[],u=Xn.read(e.numbers,{type:"base64"});u.FileIndex.map(function(Q,ne){return[Q,u.FullPaths[ne]]}).forEach(function(Q){var ne=Q[0],ie=Q[1];if(ne.type==2&&ne.name.match(/\.iwa/)){var pe=ne.content,De=$a(pe),Be=za(De);Be.forEach(function(Ue){l.push(Ue.id),o[Ue.id]={deps:[],location:ie,type:c0(Ue.messages[0].meta[1][0].data)}})}}),l.sort(function(Q,ne){return Q-ne});var h=l.filter(function(Q){return Q>1}).map(function(Q){return[Q,Un(Q)]});u.FileIndex.map(function(Q,ne){return[Q,u.FullPaths[ne]]}).forEach(function(Q){var ne=Q[0];if(Q[1],!!ne.name.match(/\.iwa/)){var ie=za($a(ne.content));ie.forEach(function(pe){pe.messages.forEach(function(De){h.forEach(function(Be){pe.messages.some(function(Ue){return c0(Ue.meta[1][0].data)!=11006&&Twe(Ue.data,Be[1])})&&o[Be[0]].deps.push(pe.id)})})})}});for(var f=Xn.find(u,o[1].location),g=za($a(f.content)),y,v=0;v<g.length;++v){var x=g[v];x.id==1&&(y=x)}var E=Nc(ei(y.messages[0].data)[1][0].data);for(f=Xn.find(u,o[E].location),g=za($a(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);for(E=Nc(ei(y.messages[0].data)[2][0].data),f=Xn.find(u,o[E].location),g=za($a(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);for(E=Nc(ei(y.messages[0].data)[2][0].data),f=Xn.find(u,o[E].location),g=za($a(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);var T=ei(y.messages[0].data);{T[6][0].data=Un(r.e.r+1),T[7][0].data=Un(r.e.c+1);var b=Nc(T[46][0].data),I=Xn.find(u,o[b].location),M=za($a(I.content));{for(var F=0;F<M.length&&M[F].id!=b;++F);if(M[F].id!=b)throw"Bad ColumnRowUIDMapArchive";var G=ei(M[F].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var R=0;R<=r.e.c;++R){var C=[];C[1]=C[2]=[{type:0,data:Un(R+420690)}],G[1].push({type:2,data:bi(C)}),G[2].push({type:0,data:Un(R)}),G[3].push({type:0,data:Un(R)})}G[4]=[],G[5]=[],G[6]=[];for(var P=0;P<=r.e.r;++P)C=[],C[1]=C[2]=[{type:0,data:Un(P+726270)}],G[4].push({type:2,data:bi(C)}),G[5].push({type:0,data:Un(P)}),G[6].push({type:0,data:Un(P)});M[F].messages[0].data=bi(G)}I.content=wf(vf(M)),I.size=I.content.length,delete T[46];var N=ei(T[4][0].data);{N[7][0].data=Un(r.e.r+1);var O=ei(N[1][0].data),z=Nc(O[2][0].data);I=Xn.find(u,o[z].location),M=za($a(I.content));{if(M[0].id!=z)throw"Bad HeaderStorageBucket";var j=ei(M[0].messages[0].data);for(P=0;P<s.length;++P){var be=ei(j[2][0].data);be[1][0].data=Un(P),be[4][0].data=Un(s[P].length),j[2][P]={type:j[2][0].type,data:bi(be)}}M[0].messages[0].data=bi(j)}I.content=wf(vf(M)),I.size=I.content.length;var Pe=Nc(N[2][0].data);I=Xn.find(u,o[Pe].location),M=za($a(I.content));{if(M[0].id!=Pe)throw"Bad HeaderStorageBucket";for(j=ei(M[0].messages[0].data),R=0;R<=r.e.c;++R)be=ei(j[2][0].data),be[1][0].data=Un(R),be[4][0].data=Un(r.e.r+1),j[2][R]={type:j[2][0].type,data:bi(be)};M[0].messages[0].data=bi(j)}I.content=wf(vf(M)),I.size=I.content.length;var je=Nc(N[4][0].data);(function(){for(var Q=Xn.find(u,o[je].location),ne=za($a(Q.content)),ie,pe=0;pe<ne.length;++pe){var De=ne[pe];De.id==je&&(ie=De)}var Be=ei(ie.messages[0].data);{Be[3]=[];var Ue=[];a.forEach(function(kt,hn){Ue[1]=[{type:0,data:Un(hn)}],Ue[2]=[{type:0,data:Un(1)}],Ue[3]=[{type:2,data:Swe(kt)}],Be[3].push({type:2,data:bi(Ue)})})}ie.messages[0].data=bi(Be);var _e=vf(ne),Ct=wf(_e);Q.content=Ct,Q.size=Q.content.length})();var Ne=ei(N[3][0].data);{var ue=Ne[1][0];delete Ne[2];var Te=ei(ue.data);{var le=Nc(Te[2][0].data);(function(){for(var Q=Xn.find(u,o[le].location),ne=za($a(Q.content)),ie,pe=0;pe<ne.length;++pe){var De=ne[pe];De.id==le&&(ie=De)}var Be=ei(ie.messages[0].data);{delete Be[6],delete Ne[7];var Ue=new Uint8Array(Be[5][0].data);Be[5]=[];for(var _e=0,Ct=0;Ct<=r.e.r;++Ct){var kt=ei(Ue);_e+=Awe(kt,s[Ct],a),kt[1][0].data=Un(Ct),Be[5].push({data:bi(kt),type:2})}Be[1]=[{type:0,data:Un(r.e.c+1)}],Be[2]=[{type:0,data:Un(r.e.r+1)}],Be[3]=[{type:0,data:Un(_e)}],Be[4]=[{type:0,data:Un(r.e.r+1)}]}ie.messages[0].data=bi(Be);var hn=vf(ne),Mt=wf(hn);Q.content=Mt,Q.size=Q.content.length})()}ue.data=bi(Te)}N[3][0].data=bi(Ne)}T[4][0].data=bi(N)}y.messages[0].data=bi(T);var se=vf(g),V=wf(se);return f.content=V,f.size=f.content.length,u}function Cwe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function _C(n){Cwe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function kwe(n,e){return e.bookType=="ods"?_G(n,e):e.bookType=="numbers"?Rwe(n,e):e.bookType=="xlsb"?Pwe(n,e):Mwe(n,e)}function Pwe(n,e){Wf=1024,n&&!n.SSF&&(n.SSF=Ls(Nr)),n&&n.SSF&&(Zw(),qw(n.SSF),e.revssf=Qw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Hm?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=eG.indexOf(e.bookType)>-1,i=CV();_C(e=e||{});var s=nC(),a="",o=0;if(e.cellXfs=[],Mu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",nn(s,a,NV(n.Props,e)),i.coreprops.push(a),zn(e.rels,2,a,Tn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,nn(s,a,OV(n.Props)),i.extprops.push(a),zn(e.rels,3,a,Tn.EXT_PROPS),n.Custprops!==n.Props&&Oi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",nn(s,a,DV(n.Custprops)),i.custprops.push(a),zn(e.rels,4,a,Tn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},f=n.Sheets[n.SheetNames[o-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,nn(s,a,Lve(o-1,a,e,n,h)),i.sheets.push(a),zn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Tn.WS[0])}if(f){var y=f["!comments"],v=!1,x="";y&&y.length>0&&(x="xl/comments"+o+"."+t,nn(s,x,Fve(y,x)),i.comments.push(x),zn(h,-1,"../comments"+o+"."+t,Tn.CMNT),v=!0),f["!legacy"]&&v&&nn(s,"xl/drawings/vmlDrawing"+o+".vml",QV(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&nn(s,PV(a),o0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,nn(s,a,Dve(e.Strings,a,e)),i.strs.push(a),zn(e.wbrels,-1,"sharedStrings."+t,Tn.SST)),a="xl/workbook."+t,nn(s,a,Nve(n,a)),i.workbooks.push(a),zn(e.rels,1,a,Tn.WB),a="xl/theme/theme1.xml",nn(s,a,qV(n.Themes,e)),i.themes.push(a),zn(e.wbrels,-1,"theme/theme1.xml",Tn.THEME),a="xl/styles."+t,nn(s,a,Ove(n,a,e)),i.styles.push(a),zn(e.wbrels,-1,"styles."+t,Tn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",nn(s,a,n.vbaraw),i.vba.push(a),zn(e.wbrels,-1,"vbaProject.bin",Tn.VBA)),a="xl/metadata."+t,nn(s,a,jve(a)),i.metadata.push(a),zn(e.wbrels,-1,"metadata."+t,Tn.XLMETA),nn(s,"[Content_Types].xml",kV(i,e)),nn(s,"_rels/.rels",o0(e.rels)),nn(s,"xl/_rels/workbook."+t+".rels",o0(e.wbrels)),delete e.revssf,delete e.ssf,s}function Mwe(n,e){Wf=1024,n&&!n.SSF&&(n.SSF=Ls(Nr)),n&&n.SSF&&(Zw(),qw(n.SSF),e.revssf=Qw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Hm?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=eG.indexOf(e.bookType)>-1,i=CV();_C(e=e||{});var s=nC(),a="",o=0;if(e.cellXfs=[],Mu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",nn(s,a,NV(n.Props,e)),i.coreprops.push(a),zn(e.rels,2,a,Tn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,nn(s,a,OV(n.Props)),i.extprops.push(a),zn(e.rels,3,a,Tn.EXT_PROPS),n.Custprops!==n.Props&&Oi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",nn(s,a,DV(n.Custprops)),i.custprops.push(a),zn(e.rels,4,a,Tn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var f={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,nn(s,a,cG(o-1,e,n,f)),i.sheets.push(a),zn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Tn.WS[0])}if(g){var v=g["!comments"],x=!1,E="";if(v&&v.length>0){var T=!1;v.forEach(function(b){b[1].forEach(function(I){I.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+t,nn(s,E,cye(v,h,e)),i.threadedcomments.push(E),zn(f,-1,"../threadedComments/threadedComment"+o+"."+t,Tn.TCMNT)),E="xl/comments"+o+"."+t,nn(s,E,JV(v)),i.comments.push(E),zn(f,-1,"../comments"+o+"."+t,Tn.CMNT),x=!0}g["!legacy"]&&x&&nn(s,"xl/drawings/vmlDrawing"+o+".vml",QV(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}f["!id"].rId1&&nn(s,PV(a),o0(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,nn(s,a,$V(e.Strings,e)),i.strs.push(a),zn(e.wbrels,-1,"sharedStrings."+t,Tn.SST)),a="xl/workbook."+t,nn(s,a,dG(n)),i.workbooks.push(a),zn(e.rels,1,a,Tn.WB),a="xl/theme/theme1.xml",nn(s,a,qV(n.Themes,e)),i.themes.push(a),zn(e.wbrels,-1,"theme/theme1.xml",Tn.THEME),a="xl/styles."+t,nn(s,a,YV(n,e)),i.styles.push(a),zn(e.wbrels,-1,"styles."+t,Tn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",nn(s,a,n.vbaraw),i.vba.push(a),zn(e.wbrels,-1,"vbaProject.bin",Tn.VBA)),a="xl/metadata."+t,nn(s,a,ZV()),i.metadata.push(a),zn(e.wbrels,-1,"metadata."+t,Tn.XLMETA),h.length>1&&(a="xl/persons/person.xml",nn(s,a,uye(h)),i.people.push(a),zn(e.wbrels,-1,"persons/person.xml",Tn.PEOPLE)),nn(s,"[Content_Types].xml",kV(i,e)),nn(s,"_rels/.rels",o0(e.rels)),nn(s,"xl/_rels/workbook."+t+".rels",o0(e.wbrels)),delete e.revssf,delete e.ssf,s}function Nwe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Yl(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function xG(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return M1(e.file,Xn.write(n,{type:Cn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Xn.write(n,e)}function Lwe(n,e){var t=Ls(e||{}),r=kwe(n,t);return Owe(r,t)}function Owe(n,e){var t={},r=Cn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?Xn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Xw(i))}return e.password&&typeof encrypt_agile<"u"?xG(encrypt_agile(i,e.password),e):e.type==="file"?M1(e.file,i):e.type=="string"?Um(i):i}function Dwe(n,e){var t=e||{},r=Qve(n,t);return xG(r,t)}function Mo(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return Lp(Dp(r));case"binary":return Dp(r);case"string":return n;case"file":return M1(e.file,r,"utf8");case"buffer":return Cn?tc(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Mo(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Fwe(n,e){switch(e.type){case"base64":return Lp(n);case"binary":return n;case"string":return n;case"file":return M1(e.file,n,"binary");case"buffer":return Cn?tc(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function S_(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?Lp(t):e.type=="string"?Um(t):t;case"file":return M1(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function vG(n,e){hme(),Eve(n);var t=Ls(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=vG(n,t);return t.type="array",Xw(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Mo(qve(n,t),t);case"slk":case"sylk":return Mo(x1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Mo(mG(n.Sheets[n.SheetNames[i]],t),t);case"txt":return Fwe(wG(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Mo(xC(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Mo(v1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return S_(_1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Mo(w1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Mo(R1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Mo(zV.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Mo(_G(n,t),t);case"wk1":return S_(CO.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return S_(CO.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),S_(gG(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Dwe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Lwe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function jwe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function Vwe(n,e,t){var r={};return r.type="file",r.file=e,jwe(r),vG(n,r)}function Gwe(n,e,t,r,i,s,a,o){var l=Li(t),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var v=a?n[t][y]:n[r[y]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[y]!=null&&(g[s[y]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[y]!=null){if(x==null)if(v.t=="e"&&x===null)g[s[y]]=null;else if(u!==void 0)g[s[y]]=u;else if(h&&x===null)g[s[y]]=null;else continue;else g[s[y]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:Xl(v,x,o);x!=null&&(f=!1)}}return{row:g,isempty:f}}function Mv(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:n["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof h){case"string":l=hr(h);break;case"number":l=hr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var f=Li(l.s.r),g=[],y=[],v=0,x=0,E=Array.isArray(n),T=l.s.r,b=0,I={};E&&!n[T]&&(n[T]=[]);var M=u.skipHidden&&n["!cols"]||[],F=u.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(M[b]||{}).hidden)switch(g[b]=es(b),t=E?n[T][b]:n[g[b]+f],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=g[b];break;case 3:s[b]=u.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=Xl(t,null,u),x=I[a]||0,!x)I[a]=1;else{do o=a+"_"+x++;while(I[o]);I[a]=x,I[o]=1}s[b]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(F[T]||{}).hidden){var G=Gwe(n,l,T,g,r,s,E,u);(G.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(y[v++]=G.row)}return y.length=v,y}var FO=/"/g;function Bwe(n,e,t,r,i,s,a,o){for(var l=!0,u=[],h="",f=Li(t),g=e.s.c;g<=e.e.c;++g)if(r[g]){var y=o.dense?(n[t]||[])[g]:n[r[g]+f];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:Xl(y,null,o));for(var v=0,x=0;v!==h.length;++v)if((x=h.charCodeAt(v))===i||x===s||x===34||o.forceQuotes){h='"'+h.replace(FO,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(FO,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&l?null:u.join(a)}function xC(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=hr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];r.dense=Array.isArray(n);for(var g=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(g[v]||{}).hidden||(f[v]=es(v));for(var x=0,E=i.s.r;E<=i.e.r;++E)(y[E]||{}).hidden||(h=Bwe(n,i,E,f,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(u,"")),(h||r.blankrows!==!1)&&t.push((x++?o:"")+h)));return delete r.dense,t.join("")}function wG(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=xC(n,e);return t}function Uwe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=hr(n["!ref"]),s="",a=[],o,l=[],u=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=es(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Li(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=u?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function EG(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?pi(r.origin):r.origin;a=l.r,o=l.c}var u,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=hr(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var g=r.header||[],y=0;e.forEach(function(x,E){Oi(x).forEach(function(T){(y=g.indexOf(T))==-1&&(g[y=g.length]=T);var b=x[T],I="z",M="",F=Yn({c:o+y,r:a+E+i});u=Vp(s,F),b&&typeof b=="object"&&!(b instanceof Date)?s[F]=b:(typeof b=="number"?I="n":typeof b=="boolean"?I="b":typeof b=="string"?I="s":b instanceof Date?(I="d",r.cellDates||(I="n",b=Ns(b)),M=r.dateNF||Nr[14]):b===null&&r.nullError&&(I="e",b=0),u?(u.t=I,u.v=b,delete u.w,delete u.R,M&&(u.z=M)):s[F]=u={t:I,v:b},M&&(u.z=M))})}),h.e.c=Math.max(h.e.c,o+g.length-1);var v=Li(a);if(i)for(y=0;y<g.length;++y)s[es(y+o)+v]={t:"s",v:g[y]};return s["!ref"]=Yr(h),s}function zwe(n,e){return EG(null,n,e)}function Vp(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=pi(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Vp(n,Yn(e)):Vp(n,Yn({r:e,c:t||0}))}function $we(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Wwe(){return{SheetNames:[],Sheets:{}}}function Hwe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(hG(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function Kwe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=$we(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function Ywe(n,e){return n.z=e,n}function SG(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function Xwe(n,e,t){return SG(n,"#"+e,t)}function qwe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function Zwe(n,e,t,r){for(var i=typeof e!="string"?e:hr(e),s=typeof e=="string"?e:Yr(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Vp(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var JS={encode_col:es,encode_row:Li,encode_cell:Yn,encode_range:Yr,decode_col:lC,decode_row:oC,split_cell:hpe,decode_cell:pi,decode_range:aa,format_cell:Xl,sheet_add_aoa:SV,sheet_add_json:EG,sheet_add_dom:pG,aoa_to_sheet:Z0,json_to_sheet:zwe,table_to_sheet:yG,table_to_book:vwe,sheet_to_csv:xC,sheet_to_txt:wG,sheet_to_json:Mv,sheet_to_html:mG,sheet_to_formulae:Uwe,sheet_to_row_object_array:Mv,sheet_get_cell:Vp,book_new:Wwe,book_append_sheet:Hwe,book_set_sheet_visibility:Kwe,cell_set_number_format:Ywe,cell_set_hyperlink:SG,cell_set_internal_link:Xwe,cell_add_comment:qwe,sheet_set_array_formula:Zwe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Yo=oa()(vd((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(u=>{const h=new Date(u.timestamp).toLocaleDateString("nl-NL"),f=u.notes?`"${u.notes.replace(/"/g,'""')}"`:"";return`${u.id},${u.location.lat},${u.location.lng},${h},${u.objectType},${u.material},${u.period},${u.depth||""},${u.condition||""},${u.weight||""},${u.length||""},${f},${u.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=JS.json_to_sheet(r),s=JS.book_new();JS.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,Vwe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const u=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${u}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const u=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${u}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),Qwe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"4/5 n.Chr. - ca. 270 n.Chr.",beschrijving:"Fectio was een van de belangrijkste Romeinse legerbases in Nederland. Het fort lag bij de splitsing van de Rijn en de Vecht, een strategisch punt.",watWasHier:"Hier was een groot castellum (legerplaats) met ruimte voor ongeveer 500 soldaten. Er waren barakken, een badhuis, een hospitaal en pakhuizen. Buiten het fort woonden handelaren en families van soldaten.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren van het fort. In het museum zijn veel vondsten te zien, waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens, paardentuig, en militaire uitrusting. Door de natte bodem zijn hier ook organische materialen zoals leer en hout bewaard.",betekenis:"Fectio was onderdeel van de Limes, de noordgrens van het Romeinse Rijk. Vanaf hier werden troepen en goederen vervoerd over de Rijn.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"47 n.Chr. - ca. 270 n.Chr.",beschrijving:'Traiectum is het huidige Utrecht. De naam betekent "oversteekplaats". Hier stak een belangrijke weg de Rijn over.',watWasHier:"Een klein castellum met een bezetting van enkele honderden soldaten. Het fort bewaakte de oversteek van de Rijn. Er was een brug of veerpont.",watTeZien:"De Domkerk staat deels op de fundamenten van het Romeinse fort. In het Centraal Museum zijn Romeinse vondsten te zien. Onder het Domplein zijn resten gevonden.",verwachteVondsten:"Munten, sieraden, aardewerk, bouwmateriaal (tegels, bakstenen), en offers aan de rivier. Bij de brug werden vaak munten geofferd.",betekenis:"Traiectum was een belangrijk knooppunt waar de landweg de rivier kruiste. Later groeide het uit tot de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Laurum lag in het huidige Woerden. Het was een middelgroot fort aan de Rijn.",watWasHier:"Een castellum met ruimte voor ongeveer 500 soldaten. Er zijn resten gevonden van houten barakken, een badhuis en pakhuizen. Buiten het fort lag een vicus (burgerdorp).",watTeZien:"In het Stadsmuseum Woerden zijn vondsten te zien, waaronder een bijzondere Romeinse boot. De contouren van het fort zijn in het stratenpatroon te herkennen.",verwachteVondsten:"Militaria, aardewerk, munten, en schrijfplankjes. Door de natte veengrond zijn ook houten voorwerpen en leren schoenen bewaard gebleven.",betekenis:"Laurum toont hoe de Romeinen in het veengebied bouwden. De soldaten moesten constant vechten tegen het water.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Dit fort lag in Valkenburg (ZH). De naam verwijst naar Agrippina, de moeder van keizer Nero.",watWasHier:"Een middelgroot castellum met barakken voor hulptroepen. Er waren ook werkplaatsen en opslagruimtes. Het fort werd meerdere keren herbouwd na overstromingen.",watTeZien:"Het Archeologisch Steunpunt Valkenburg toont de geschiedenis. Delen van het fort zijn opgegraven en worden beschermd.",verwachteVondsten:"Militaire uitrusting, aardewerk uit het Rijnland en Galli, munten, en bouwmateriaal. Hier zijn ook inscripties gevonden.",betekenis:"Een van de best onderzochte forten aan de Rijn. Geeft veel informatie over het dagelijks leven van Romeinse soldaten.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"19 v.Chr. - ca. 70 n.Chr.",beschrijving:"Op de Hunnerberg bij Nijmegen lag een groot legerkamp. Hier waren tijdelijk twee volledige legioenen (10.000 soldaten) gestationeerd.",watWasHier:"Een enorm legerkamp van 42 hectare, een van de grootste ten noorden van de Alpen. Hier werden veldtochten naar Germani voorbereid.",watTeZien:"Op de Hunnerberg zijn de wallen nog zichtbaar in het landschap. Het Museum Het Valkhof toont veel vondsten.",verwachteVondsten:"Militaire uitrusting van hoge kwaliteit, munten van Augustus en Tiberius, legioenstempels op dakpannen, en resten van wapens.",betekenis:"Dit was de belangrijkste legerbasis in het vroege Romeinse Nederland. Vanaf hier werden de oorlogen tegen de Germanen gevoerd.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Op het Kops Plateau in Nijmegen lag een vroege militaire basis, later de hoofdstad van de Bataven.",watWasHier:"Eerst een Romeins kamp, later de civiele hoofdstad Oppidum Batavorum. Hier woonden Romeinen en Bataven samen.",watTeZien:"Het Kops Plateau is nu een natuurgebied. Opgravingen hebben veel informatie opgeleverd. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege Romeinse militaria, Keltisch-Bataafse voorwerpen, importaardewerk, en munten uit de tijd van Augustus.",betekenis:"Dit was het eerste contactpunt tussen Romeinen en Bataven. Hier begon de romanisering van Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 n.Chr. - 400 n.Chr.",beschrijving:"Op het Valkhof stond een laat-Romeinse versterking. Later bouwde Karel de Grote hier een palts.",watWasHier:"Een versterkte positie uit de tijd dat het Romeinse Rijk onder druk stond. De soldaten bewaakten de Waaloever.",watTeZien:"Het Valkhofpark met de Sint-Nicolaaskapel (deels Karolingisch). Museum Het Valkhof toont de geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, gordeltjes en riemtongen, aardewerk uit de 3e en 4e eeuw, en militaire gespen.",betekenis:"Toont de overgang van het Romeinse Rijk naar de vroege middeleeuwen. Nijmegen bleef een belangrijk centrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 n.Chr. - 270 n.Chr.",beschrijving:"Dit fort lag in Leidsche Rijn bij Utrecht. Het is nu een archeologisch park.",watWasHier:"Een middengroot castellum met houten gebouwen. Buiten de muren lag een burgerdorp. Hier is een compleet Romeins schip gevonden.",watTeZien:"Archeologisch Park Castellum Hoge Woerd met de reconstructie van het fort en een museum. Je kunt over de fundamenten lopen.",verwachteVondsten:"Militaire uitrusting, scheepsonderdelen, aardewerk, munten, en door de natte grond ook organisch materiaal.",betekenis:"Een van de best bewaarde en gepresenteerde Romeinse forten in Nederland. Ideaal om te zien hoe een fort eruitzag.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum Batavorum",latinNaam:"Lugdunum Batavorum",type:"castellum",periode:"ca. 40 n.Chr. - 270 n.Chr.",beschrijving:"Lugdunum lag in Katwijk, aan de monding van de Rijn in zee. Het was het westelijkste fort van de Limes.",watWasHier:"Een castellum dat de riviermonding bewaakte. Hier eindigde de Rijn en begon de zee. Er was ook een vuurtoren.",watTeZien:"Het fort is door de zee weggespoeld. In het Rijksmuseum van Oudheden in Leiden zijn vondsten te zien.",verwachteVondsten:"Op het strand worden soms voorwerpen gevonden na stormen. Munten, aardewerk en militaria.",betekenis:"Het westelijke eindpunt van de Limes. Hier begonnen zeereizen naar Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-batavorum-katwijk/"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e eeuw n.Chr.",beschrijving:"Bij Naaldwijk lag mogelijk een basis voor de Romeinse vloot (Classis Germanica).",watWasHier:"Een haven met schepen die langs de kust patrouilleerden en troepen naar Britannia vervoerden.",watTeZien:"Het gebied is nu landbouwgrond. Vondsten zijn in lokale musea te zien.",verwachteVondsten:"Scheepsonderdelen, ankers, militaire uitrusting voor mariniers, importaardewerk.",betekenis:"Toont het belang van de Romeinse vloot voor de verdediging van de kust.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 n.Chr.",beschrijving:"Bij Ockenburg in Den Haag stond een klein Romeins fortje dat de kust bewaakte.",watWasHier:"Een kleine wachtpost met ruimte voor een handvol soldaten. Het lag op een strandwal.",watTeZien:"Het terrein is beschermd maar niet toegankelijk. Vondsten zijn in het Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, en munten.",betekenis:"Toont dat de Romeinen ook de kust bewaakten, niet alleen de rivieren.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Ceuclum lag bij Cuijk aan de Maas. Het bewaakte een brug over de rivier.",watWasHier:"Een middelgroot castellum bij een belangrijke rivierovergang. De weg naar het noorden liep hier.",watTeZien:"In Cuijk zijn restanten gevonden. Het Maasmuseum toont lokale vondsten.",verwachteVondsten:"Munten, fibulae, aardewerk, en materiaal gerelateerd aan de brug.",betekenis:"Een belangrijke schakel in het Romeinse wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Arnhem-Meinerswijk lag een Romeins fort aan de Rijn.",watWasHier:"Een castellum dat de rivierroute bewaakte. Het lag in de uiterwaarden.",watTeZien:"Het terrein is nu natuurgebied. Vondsten zijn in Museum Arnhem te zien.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Onderdeel van de keten van forten langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Levefanum lag bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en de Kromme Rijn.",watWasHier:"Een militaire post bij een strategische riviersplitsing. Mogelijk ook een haven.",watTeZien:"Het terrein is bebouwd. Dorestad Museum toont de latere geschiedenis van deze plek.",verwachteVondsten:"Munten, aardewerk, militaria, en handelsproducten.",betekenis:"Een belangrijk controlepunt voor het scheepvaartverkeer.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum",type:"minifort",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Nigrum Pullum (Zwarte Poel) lag bij Zwammerdam. Het was een klein fortje in het veengebied.",watWasHier:"Een klein fort met pakhuizen. Er zijn meerdere Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, bouwmaterialen, aardewerk, en door de natte grond organisch materiaal.",betekenis:"Beroemd om de goed bewaarde Romeinse schepen. Toont transport over water.",bronnen:["https://www.rmo.nl"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 n.Chr.",beschrijving:"In Vleuterweide bij Utrecht stond een stenen wachttoren. Dit was ongebruikelijk - de meeste waren van hout.",watWasHier:"Een versterkte toren met uitzicht over de omgeving. Mogelijk woonden hier ook families van soldaten.",watTeZien:"De fundamenten zijn gemarkeerd in de wijk. Vondsten zijn in het Centraal Museum Utrecht.",verwachteVondsten:"Bouwmaterialen (dakpannen, stenen), aardewerk, en persoonlijke bezittingen.",betekenis:"Een van de weinige bekende stenen wachttorens. Toont variatie in Romeinse bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Bunnik stond een houten wachttoren aan de Rijn.",watWasHier:"Een uitkijkpost waar soldaten de rivier in de gaten hielden en signalen doorgaven.",watTeZien:"De exacte locatie is niet precies bekend. Het gebied is nu bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel van het signaleringssysteem langs de Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"3e - 4e eeuw n.Chr.",beschrijving:"In het centrum van Maastricht stond een laat-Romeinse versterking bij de brug over de Maas.",watWasHier:"Een verdedigingswerk uit de tijd dat het Rijk onder druk stond. Het bewaakte de rivierovergang.",watTeZien:"Onder het Vrijthof zijn resten gevonden. Centre Ceramique toont de Romeinse geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, militaire riembeslag, aardewerk, en bouwmaterialen.",betekenis:"Toont de continuiteit - Maastricht bleef belangrijk van de Romeinse tijd tot nu.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij de Roompot in Zeeland lag een Romeins fort dat de zeeroute bewaakte.",watWasHier:"Een versterking aan de kust die schepen beschermde en piraterij teginging.",watTeZien:"Het fort is door de zee verzwolgen. Soms spoelen vondsten aan.",verwachteVondsten:"Door erosie kunnen munten en voorwerpen op het strand gevonden worden.",betekenis:"Toont dat de Romeinen ook de Zeeuwse wateren controleerden.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Carvium lag bij Herwen, waar de Rijn en de Waal samenkwamen.",watWasHier:"Een fort bij een strategisch punt waar twee grote rivieren samenkwamen.",watTeZien:"Het gebied is nu natuurgebied. Vondsten zijn in Museum Het Valkhof in Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Controleerde een belangrijk knooppunt van waterwegen.",bronnen:[]}},Jwe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een Romeinse militaire versterking langs de noordgrens van het Rijk.",watWasHier:"Een militaire post met soldaten die de grens bewaakten. Vaak was er ook een burgerdorp (vicus) in de buurt.",watTeZien:"De meeste forten zijn nu verdwenen of overbouwd. Lokale musea tonen vaak vondsten.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens en gereedschap.",betekenis:"Onderdeel van de Limes, de noordelijke grens van het Romeinse Rijk die door Nederland liep."},eEe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};wn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function tEe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function nEe(n){try{const e=vn(n),t=wn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,u=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(u!=null){const h=typeof u=="number"?u:parseFloat(u);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const rEe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},iEe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function jO(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function sEe(){const n=Di(mt=>mt.map),e=Yo(mt=>mt.removeVondst),t=Yo(mt=>mt.updateVondst),r=Yo(mt=>mt.vondsten),{layers:i,addPoint:s,addLayer:a}=Qi(),[o,l]=ee.useState([]),[u,h]=ee.useState(0),[f,g]=ee.useState(!1),[y,v]=ee.useState(null),[x,E]=ee.useState(!1),[T,b]=ee.useState(!1),[I,M]=ee.useState(null),[F,G]=ee.useState(null),[R,C]=ee.useState(null),[P,N]=ee.useState(!1),[O,z]=ee.useState(null),[j,be]=ee.useState(null),[Pe,je]=ee.useState(null),[Ne,ue]=ee.useState(!1),[Te,le]=ee.useState(""),[se,V]=ee.useState([]),Q=se[u]||null,[ne,ie]=ee.useState(()=>{const mt=localStorage.getItem("popupTextScale");return mt?parseInt(mt):100}),pe=mt=>{ie(mt),localStorage.setItem("popupTextScale",mt.toString())},De=o[u]||"",Be=o.length>1,Ue=mt=>{const Bt=mt.match(/<strong[^>]*>(.*?)<\/strong>/);if(Bt){const Mn=Bt[1].replace(/<[^>]+>/g,""),_t=mt.replace(Bt[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:Mn,contentWithoutTitle:_t}}return{title:"",contentWithoutTitle:mt}},_e=mt=>mt.replace(/class="([^"]*)"/g,(Mn,_t)=>{if(_t.includes("text-xs")){const Jt=_t.replace(/\btext-xs\b/g,"").trim();return Jt?`style="font-size:0.857em" class="${Jt}"`:'style="font-size:0.857em"'}if(_t.includes("text-sm")){const Jt=_t.replace(/\btext-sm\b/g,"").trim();return Jt?`class="${Jt}"`:""}return Mn}).replace(/class=""/g,""),{title:Ct,contentWithoutTitle:kt}=Ue(De),hn=_e(kt),Mt=De.includes("Landbouwperceel"),jn=De.includes("data-vondst-id="),Qt=()=>{h(mt=>(mt-1+o.length)%o.length)},ot=()=>{h(mt=>(mt+1)%o.length)},Zn=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||T){console.log(" STOP - map:",!!n,"coord:",y,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),b(!0);try{await lme(n,y)&&E(!0)}catch(mt){console.error("Failed to load height map:",mt)}finally{b(!1)}},on=()=>{n&&(Kb(n),E(!1))};ee.useEffect(()=>{if(!n)return;const mt=_t=>{let Jt='<strong class="text-purple-800">AMK Monument</strong>';if(_t.toponiem&&(Jt+=`<br/><span class="text-sm font-semibold">${_t.toponiem}</span>`),_t.kwaliteitswaarde&&(Jt+=`<br/><span class="text-sm text-purple-700">${_t.kwaliteitswaarde}</span>`),_t.omschrijving&&(Jt+=`<br/><span class="text-xs text-gray-600 mt-1 block">${_t.omschrijving}</span>`),_t.txt_label){const Pt=_t.txt_label.split(", ").slice(0,3).join(", ");Jt+=`<br/><span class="text-xs text-gray-500 italic">${Pt}${_t.txt_label.split(", ").length>3?"...":""}</span>`}return Jt},Bt=async(_t,Jt)=>{const Pt=[],sr=n.getLayers().getArray().filter(ai=>ai instanceof sh&&ai.getVisible()?ai.getSource()instanceof lH:!1);for(const ai of sr){const Br=ai.getSource();if(!Br)continue;const zt=ai.get("title")||"";if(zt.startsWith("Paleokaart"))continue;if(zt==="Archeo Landschappen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,X=q.landschapsnaam||q.naam||"Archeologisch Landschap",ce=q.omschrijving||"";let he=`<strong class="text-green-800">${X}</strong>`;ce&&(he+=`<br/><span class="text-sm text-gray-600">${ce}</span>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Pt.push(he)}}catch(Oe){console.warn("Archeo Landschappen WMS query failed:",Oe)}continue}if(zt==="Essen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(q.naam||q.Naam||q.NAME)&&(X+=`<br/><span class="text-sm font-semibold text-amber-700">${q.naam||q.Naam||q.NAME}</span>`),(q.type||q.Type||q.TYPE)&&(X+=`<br/><span class="text-xs text-gray-600">${q.type||q.Type||q.TYPE}</span>`),(q.omschrijving||q.Omschrijving)&&(X+=`<br/><span class="text-xs text-gray-500">${q.omschrijving||q.Omschrijving}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',X+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',X+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Pt.push(X)}}catch(Oe){console.warn("Essen WMS query failed:",Oe)}continue}if(zt==="FAMKE Steentijd"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';X+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart voor oude vondsten</span>';const ce=q.advies||q.Advies||"";if(ce){X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',X+=`<div class="text-sm text-amber-700 mt-1">${ce}</div>`;const he=ce.toLowerCase();let Ve="",Ie="text-gray-600",$e="";he.includes("karterend")?(Ve="Op deze plek verwachten archeologen vondsten uit de steentijd of bronstijd. Bij graafwerk moet er eerst onderzoek komen.",$e="Goede kans op oude vondsten (vuursteen, bijlen, aardewerk)",Ie="text-amber-600"):he.includes("waarderend")?(Ve="Hier zijn mogelijk belangrijke vindplaatsen. Proefsleuven zijn nodig om te kijken wat er precies zit.",$e="Mogelijk interessante vondsten uit de prehistorie",Ie="text-orange-600"):he.includes("geen")?(Ve="De kans op prehistorische vondsten is hier klein. De grond is waarschijnlijk te jong of te veel verstoord.",$e="Weinig kans op steentijd-vondsten",Ie="text-green-600"):he.includes("quickscan")&&(Ve="Hier is eerst bureau-onderzoek nodig. Er kunnen vondsten zitten, maar dat is nog niet zeker.",$e="Onbekend, nader onderzoek nodig",Ie="text-blue-600"),Ve&&(X+=`<div class="text-sm ${Ie} mt-1">${Ve}</div>`),$e&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>'}Pt.push(X)}}catch(Oe){console.warn("FAMKE WMS query failed:",Oe)}continue}if(zt==="Archeo Onderzoeken"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}&FEATURE_COUNT=20`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0)for(const q of W.features){const X=q.properties;let ce='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';const he=X.type_onderzoek||"";he&&(ce+=`<br/><span class="text-sm font-semibold text-blue-700">${he}</span>`);const Ve=X.projectnaam||X.project_naam||X.naam||"";if(Ve&&(ce+=`<br/><span class="text-sm text-gray-800">${Ve}</span>`),X.onderzoeksmeldingnummer&&(ce+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${X.onderzoeksmeldingnummer}</span>`),X.uitvoerder&&(ce+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${X.uitvoerder}</span>`),X.startdatum||X.einddatum){const $e=[X.startdatum,X.einddatum].filter(Boolean).join(" - ");ce+=`<br/><span class="text-xs text-gray-600">Periode: ${$e}</span>`}X.gemeente&&(ce+=`<br/><span class="text-xs text-gray-500">${X.gemeente}</span>`);const Ie=[];if(X.periode_paleolithicum&&Ie.push("Paleolithicum"),X.periode_mesolithicum&&Ie.push("Mesolithicum"),X.periode_neolithicum&&Ie.push("Neolithicum"),X.periode_bronstijd&&Ie.push("Bronstijd"),X.periode_ijzertijd&&Ie.push("IJzertijd"),X.periode_romeins&&Ie.push("Romeins"),X.periode_middeleeuwen&&Ie.push("Middeleeuwen"),X.periode_nieuwe_tijd&&Ie.push("Nieuwe tijd"),Ie.length>0&&(ce+=`<br/><span class="text-sm text-purple-700">Datering: ${Ie.join(", ")}</span>`),ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',he.toLowerCase().includes("opgraving")?ce+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':he.toLowerCase().includes("bureauonderzoek")?ce+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':he.toLowerCase().includes("booronderzoek")?ce+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':he.toLowerCase().includes("proefsleuven")?ce+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':he.toLowerCase().includes("begeleiding")?ce+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':he.toLowerCase().includes("inventariserend")?ce+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':ce+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>',X.onderzoeksmeldingnummer){const $e=X.onderzoeksmeldingnummer;ce+=`<div class="text-sm text-gray-700 mt-1"><a href="https://easy.dans.knaw.nl/ui/datasets?q=${encodeURIComponent($e)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek rapport in DANS-EASY</a></div>`,ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in ARCHIS</a></div>'}ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://bibliotheek.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bibliotheek voor Archeologie</a></div>',Pt.push(ce)}}catch(Oe){console.warn("Archeo Onderzoeken WMS query failed:",Oe)}continue}if(zt==="IKAW"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=500,L=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,X=Math.round(q.PALETTE_INDEX||q.palette_index||0),ce=iEe[X]||`Trefkans onbekend (${X})`;let he='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';he+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',he+=`<div class="text-sm text-orange-700 mt-1">${ce}</div>`;const Ie={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[X];Ie&&(he+=`<div class="text-sm ${Ie.kleur} mt-1">${Ie.tekst}</div>`,he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+=`<div class="text-sm text-gray-700 mt-1">${Ie.vondsten}</div>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Pt.push(he)}}catch(Oe){console.warn("IKAW WMS query failed:",Oe)}continue}if(zt==="Inundatiegebieden"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-blue-800">Inundatiegebied</strong>';(q["linie-naam"]||q.linie_naam)&&(X+=`<br/><span class="text-sm font-semibold text-blue-700">${q["linie-naam"]||q.linie_naam}</span>`),q.naam&&(X+=`<br/><span class="text-sm text-gray-700">${q.naam}</span>`),q.periode&&(X+=`<br/><span class="text-xs text-gray-500">${q.periode}</span>`),q.lin_period&&(X+=`<br/><span class="text-xs text-gray-400">${q.lin_period}</span>`),Pt.push(X)}}catch(Oe){console.warn("Inundatiegebieden WMS query failed:",Oe)}continue}if(zt==="Militaire Objecten"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=50,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,X=q.obj_soort||"",ce=q.obj_naam||"",he=q.lin_period||"",Ve=q["linie-naam"]||q.linie_naam||"";let Ie=X||"Militair Object",$e="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",et="";const ft=X.toLowerCase();ft.includes("fort")?($e="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",et="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):ft.includes("schans")?($e="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",et="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):ft.includes("batterij")||ft.includes("battery")?($e="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",et="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):ft.includes("bunker")||ft.includes("kazemat")?($e="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",et="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):ft.includes("sluis")||ft.includes("inlaatwerk")?($e="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",et="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):ft.includes("toren")||ft.includes("wachttoren")?($e="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",et="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):ft.includes("kazerne")&&($e="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",et="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let St=`<strong class="text-stone-800">${Ie}</strong>`;ce&&(St+=`<br/><span class="text-sm font-semibold text-stone-700">${ce}</span>`),Ve&&(St+=`<br/><span class="text-sm text-blue-600">${Ve}</span>`),he&&(St+=`<br/><span class="text-xs text-gray-500">${he}</span>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',St+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,et&&(St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',St+=`<div class="text-sm text-gray-700 mt-1">${et}</div>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',St+='<div class="text-sm text-gray-700 mt-1">',St+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',St+="</div>",Pt.push(St)}}catch(Oe){console.warn("Militaire Objecten WMS query failed:",Oe)}continue}if(zt==="Verdedigingslinies"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-amber-800">Verdedigingslinie</strong>';const ce={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},he=q.naam||q.lin_naam||"";if(he){X+=`<br/><span class="text-sm font-semibold text-amber-700">${he}</span>`;const Ve=Object.entries(ce).find(([Ie])=>he.toLowerCase().includes(Ie.toLowerCase())||Ie.toLowerCase().includes(he.toLowerCase()));Ve&&(X+=`<br/><span class="text-sm text-gray-700">${Ve[1]}</span>`)}q.lin_period&&(X+=`<br/><span class="text-xs text-purple-600">${q.lin_period}</span>`),q.status&&(X+=`<br/><span class="text-xs text-gray-400">${q.status}</span>`),Pt.push(X)}}catch(Oe){console.warn("Verdedigingslinies WMS query failed:",Oe)}continue}if(zt==="Rijksmonumenten"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=50,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-red-800">Rijksmonument</strong>';(q.cbsNaam||q.cbs_naam)&&(X+=`<br/><span class="text-sm font-semibold">${q.cbsNaam||q.cbs_naam}</span>`),q.hoofdcategorie&&(X+=`<br/><span class="text-sm text-red-700">${q.hoofdcategorie}</span>`),q.subcategorie&&(X+=`<br/><span class="text-xs text-gray-600">${q.subcategorie}</span>`),q.rijksmonumentnummer&&(X+=`<br/><span class="text-xs text-gray-500">Nr: ${q.rijksmonumentnummer}</span>`),(q.bouwjaar||q.oorspronkelijkebouwjaar)&&(X+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${q.bouwjaar||q.oorspronkelijkebouwjaar}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',q.rijksmonumentnummer&&(X+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${q.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),X+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Pt.push(X)}}catch(Oe){console.warn("Rijksmonumenten WMS query failed:",Oe)}continue}if(zt==="Werelderfgoed"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=500,L=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(q.siteName||q.naam)&&(X+=`<br/><span class="text-sm font-semibold text-cyan-700">${q.siteName||q.naam}</span>`),q.siteDesignation&&(X+=`<br/><span class="text-xs text-gray-600">${q.siteDesignation}</span>`),Pt.push(X)}}catch(Oe){console.warn("Werelderfgoed WMS query failed:",Oe)}continue}if(zt==="Terpen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,X=q.naam||q.NAAM||q.Naam||"Terp",ce=q.plaats||q.PLAATS||q.Plaats||"";let he=`<strong class="text-orange-800">${X}</strong>`;ce&&(he+=`<br/><span class="text-sm text-gray-500">${ce}</span>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Een terp is een kunstmatige heuvel. Mensen bouwden deze heuvels om droog te wonen in het vlakke, natte land. Terpen zijn vaak meer dan 2000 jaar oud.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Op en rond terpen worden vaak vondsten gedaan:</div>',he+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',he+="<li>Middeleeuws aardewerk en botten</li>",he+="<li>Munten uit verschillende periodes</li>",he+="<li>Metalen voorwerpen (gespen, fibulae, sieraden)</li>",he+="<li>Soms Romeinse of zelfs prehistorische vondsten</li>",he+="</ul>",he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waarom zijn terpen interessant?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Terpen waren vaak dorpskernen waar mensen eeuwenlang woonden. Door de ophoging bleven veel voorwerpen goed bewaard. Let op: sommige terpen zijn beschermd monument!</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Veel terpen zijn nog zichtbaar in het landschap. Vraag altijd toestemming aan de grondeigenaar voordat je gaat detecteren.</div>',Pt.push(he)}}catch(Oe){console.warn("Terpen WMS query failed:",Oe)}continue}if(zt==="Religieus Erfgoed"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=50,L=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,X=q.naam||q.NAAM||q.name||q.NAME||"Onbekend",ce=q.denominatie||q.DENOMINATIE||q.religie||"",he=q.type||q.TYPE||q.functie||"",Ve=q.bouwjaar||q.BOUWJAAR||q.jaar||"",Ie=q.gemeente||q.GEMEENTE||q.plaats||"";let $e=`<strong class="text-purple-800">${X}</strong>`;const et=he.toLowerCase();let ft="Een religieus gebouw of heilige plek.",St="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";et.includes("kerk")||et.includes("church")?(ft="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",St="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):et.includes("kapel")||et.includes("chapel")?(ft="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",St="Devotionalia, munten, kruisjes, rozenkransen"):et.includes("synagoge")?(ft="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",St="Munten, knopen, kleine religieuze voorwerpen"):et.includes("klooster")||et.includes("monastery")?(ft="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",St="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):et.includes("toren")||et.includes("tower")?(ft="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",St="Munten, knopen, bouwmateriaal"):(et.includes("begraafplaats")||et.includes("cemetery"))&&(ft="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",St="Detecteren hier niet toegestaan"),ce&&($e+=`<br/><span class="text-sm text-purple-600">${ce}</span>`),he&&($e+=`<br/><span class="text-sm text-gray-600">${he}</span>`),Ve&&($e+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Ve}</span>`),Ie&&($e+=`<br/><span class="text-xs text-gray-400">${Ie}</span>`),$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${ft}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${St}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',et.includes("begraafplaats")?$e+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':$e+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Pt.push($e)}}catch(Oe){console.warn("Religieus Erfgoed WMS query failed:",Oe)}continue}if(zt==="Gewaspercelen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=50,Nt=`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`,L=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Nt}`,Lt=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Nt}`,[W,q]=await Promise.all([fetch(L),fetch(Lt).catch(()=>null)]),X=await W.json();if(X.features&&X.features.length>0){const ce=X.features[0].properties;let he='<strong class="text-green-800">Landbouwperceel</strong>';if((ce.gewas||ce.gewasnaam)&&(he+=`<br/><span class="text-sm font-semibold text-green-700">${ce.gewas||ce.gewasnaam}</span>`),(ce.categorie||ce.category)&&(he+=`<br/><span class="text-xs text-gray-600">${ce.categorie||ce.category}</span>`),ce.oppervlakte&&(he+=`<br/><span class="text-xs text-gray-500">${ce.oppervlakte} ha</span>`),q)try{const Ve=await q.json();if(Ve.features&&Ve.features.length>0){const Ie=Ve.features[0].properties,$e=Ie.first_soilname||Ie.soilname||Ie.bodemtype,et=Ie.first_soilcode||Ie.soilcode||Ie.maparea_soilcode;if($e){he+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${$e}</span>`;const ft=jO($e,et);ft.length>0&&(he+=`<br/><span class="text-xs text-gray-500 italic">${ft.join("  ")}</span>`)}}}catch{}Pt.push(he)}}catch(Oe){console.warn("BRP Gewaspercelen WMS query failed:",Oe)}continue}if(zt==="Kadastrale Grenzen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=20,L=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,X=q.kadastraleGemeenteWaarde||q.kadastrale_gemeente_waarde||q.kadastraleGemeente||rEe[String(q.kadastraleGemeenteCode)]||q.kadastraleGemeenteCode,ce=q.sectie||q.Sectie||"",he=q.perceelnummer||q.perceelNummer||q.Perceelnummer||"",Ve=q.kadastraleGrootteWaarde||q.kadastrale_grootte_waarde||q.kadastraleGrootte||q.oppervlakte,Ie=q.AKRKadastraleGemeenteCodeWaarde||q.akrKadastraleGemeenteCodeWaarde||"",$e=[X,ce,he].filter(Boolean).join(" "),et=Ie&&ce&&he?`${Ie}-${ce}-${he}`:"";let ft='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if($e&&(ft+=`<br/><span class="text-sm text-indigo-700">${$e}</span>`),et&&(ft+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${et}</span>`),Ve){const St=typeof Ve=="number"?Ve:parseFloat(Ve);isNaN(St)||(ft+=`<br/><span class="text-xs text-gray-600">${St.toLocaleString("nl-NL")} m</span>`)}ft+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Pt.push(ft)}}catch(Oe){console.warn("Kadastrale Grenzen WMS query failed:",Oe)}continue}if(zt==="Scheepswrakken"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-cyan-800">Scheepswrak</strong>';(q.naam||q.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-cyan-700">${q.naam||q.NAAM}</span>`),(q.type||q.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${q.type||q.TYPE}</span>`),(q.datering||q.DATERING)&&(X+=`<br/><span class="text-xs text-gray-500">Datering: ${q.datering||q.DATERING}</span>`),(q.bron||q.BRON)&&(X+=`<br/><span class="text-xs text-gray-400">${q.bron||q.BRON}</span>`),Pt.push(X)}}catch(Oe){console.warn("Scheepswrakken WMS query failed:",Oe)}continue}if(zt==="Woonheuvels ZH"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-orange-800">Woonheuvel</strong>';(q.naam||q.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-orange-700">${q.naam||q.NAAM}</span>`),(q.type||q.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${q.type||q.TYPE}</span>`),Pt.push(X)}}catch(Oe){console.warn("Woonheuvels WMS query failed:",Oe)}continue}if(zt==="Romeinse Forten"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-red-800">Romeins Fort</strong>';(q.naam||q.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-red-700">${q.naam||q.NAAM}</span>`),(q.type||q.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${q.type||q.TYPE}</span>`),(q.periode||q.PERIODE)&&(X+=`<br/><span class="text-xs text-gray-500">${q.periode||q.PERIODE}</span>`),Pt.push(X)}}catch(Oe){console.warn("Romeinse Forten WMS query failed:",Oe)}continue}if(zt==="Windmolens"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=50,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-amber-800">Windmolen</strong>';(q.naam||q.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-amber-700">${q.naam||q.NAAM}</span>`),(q.type||q.TYPE||q.functie||q.FUNCTIE)&&(X+=`<br/><span class="text-sm text-gray-700">${q.type||q.TYPE||q.functie||q.FUNCTIE}</span>`),(q.bouwjaar||q.BOUWJAAR)&&(X+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${q.bouwjaar||q.BOUWJAAR}</span>`),Pt.push(X)}}catch(Oe){console.warn("Windmolens WMS query failed:",Oe)}continue}if(zt==="Erfgoedlijnen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-purple-800">Erfgoedlijn</strong>';(q.naam||q.NAAM||q.erfgoedlijn)&&(X+=`<br/><span class="text-sm font-semibold text-purple-700">${q.naam||q.NAAM||q.erfgoedlijn}</span>`),(q.type||q.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${q.type||q.TYPE}</span>`),(q.omschrijving||q.OMSCHRIJVING)&&(X+=`<br/><span class="text-xs text-gray-500">${q.omschrijving||q.OMSCHRIJVING}</span>`),Pt.push(X)}}catch(Oe){console.warn("Erfgoedlijnen WMS query failed:",Oe)}continue}if(zt==="Oude Kernen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-stone-800">Historische Kern</strong>';(q.naam||q.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-stone-700">${q.naam||q.NAAM}</span>`),(q.type||q.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${q.type||q.TYPE}</span>`),(q.periode||q.PERIODE)&&(X+=`<br/><span class="text-xs text-gray-500">${q.periode||q.PERIODE}</span>`),Pt.push(X)}}catch(Oe){console.warn("Oude Kernen WMS query failed:",Oe)}continue}if(zt==="Relictenkaart Punten"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,X={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},ce=q.type?.replace(/[0-9]/g,"")||"",he=X[ce]||q.type||"Cultuurhistorisch object";let Ve='<strong class="text-emerald-800">Relict</strong>';Ve+=`<br/><span class="text-sm font-semibold text-emerald-700">${he}</span>`,q.type&&ce!==q.type&&(Ve+=`<br/><span class="text-xs text-gray-500">Code: ${q.type}</span>`),q.streek&&(Ve+=`<br/><span class="text-xs text-gray-400">Streek: ${q.streek}</span>`),Pt.push(Ve)}}catch(Oe){console.warn("Relictenkaart Punten WMS query failed:",Oe)}continue}if(zt==="Relictenkaart Lijnen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,ce={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[q.klasse]||`Historisch lijnrelict (${q.klasse})`;let he='<strong class="text-teal-800">Lijnrelict</strong>';he+=`<br/><span class="text-sm font-semibold text-teal-700">${ce}</span>`,Pt.push(he)}}catch(Oe){console.warn("Relictenkaart Lijnen WMS query failed:",Oe)}continue}if(zt==="Relictenkaart Vlakken"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=100,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties,ce={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[q.klasse]||`Historisch landschap (${q.klasse})`;let he='<strong class="text-lime-800">Landschapsrelict</strong>';if(he+=`<br/><span class="text-sm font-semibold text-lime-700">${ce}</span>`,q.st_area_shape_){const Ve=(q.st_area_shape_/1e4).toFixed(1);he+=`<br/><span class="text-xs text-gray-500">${Ve} ha</span>`}Pt.push(he)}}catch(Oe){console.warn("Relictenkaart Vlakken WMS query failed:",Oe)}continue}if(zt==="Verdronken Dorpen"){try{const Oe=vn(_t),Ee=wn("EPSG:4326","EPSG:28992",Oe),me=200,L=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ee[0]-me},${Ee[1]-me},${Ee[0]+me},${Ee[1]+me}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const q=W.features[0].properties;let X='<strong class="text-blue-800">Verdronken Dorp</strong>';(q.naam||q.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-blue-700">${q.naam||q.NAAM}</span>`),(q.verdronken||q.VERDRONKEN||q.jaar||q.JAAR)&&(X+=`<br/><span class="text-xs text-gray-600">Verdronken: ${q.verdronken||q.VERDRONKEN||q.jaar||q.JAAR}</span>`),(q.gemeente||q.GEMEENTE)&&(X+=`<br/><span class="text-xs text-gray-500">${q.gemeente||q.GEMEENTE}</span>`),(q.bron||q.BRON)&&(X+=`<br/><span class="text-xs text-gray-400">${q.bron||q.BRON}</span>`),Pt.push(X)}}catch(Oe){console.warn("Verdronken Dorpen WMS query failed:",Oe)}continue}const ns=Br.getFeatureInfoUrl(_t,Jt,"EPSG:3857",{INFO_FORMAT:"application/json"});if(ns)try{const Ee=await(await fetch(ns)).json();if(Ee.features&&Ee.features.length>0){const me=Ee.features[0].properties;if(zt==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const q=me.value_list??me.GRAY_INDEX??me.value??me.gray_index??me.dtm_05m??me.DTM_05M??me.hoogte??me.HOOGTE??me.elevation??me.ELEVATION;if(q!=null&&!isNaN(Number(q))){const X=typeof q=="number"?q.toFixed(2):Number(q).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${X} m NAP</span>`,Pt.push(W)}else{let X=!1;const ce=["geometry","id","fid","gml_id","bbox"];for(const[he,Ve]of Object.entries(me))!ce.includes(he.toLowerCase())&&Ve!==null&&Ve!==""&&(W+=`<br/><span class="text-xs text-gray-600">${he}: ${Ve}</span>`,X=!0);X&&Pt.push(W)}continue}if(zt==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',q=!1;const X=me.landform_subgroup_description,ce=me.relief_klasse,he=me.relief_subklasse,Ve=me.genese_description,Ie=me.active_process;if(X&&(W+=`<br/><span class="text-sm text-green-700">${X}</span>`,q=!0),ce){const $e=he&&he!==ce?`${ce} (${he})`:ce;W+=`<br/><span class="text-xs text-gray-600">Relief: ${$e}</span>`,q=!0}if(Ve&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Ve}</span>`,q=!0),Ie&&Ie!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${Ie}</span>`,q=!0),!q){const $e=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[et,ft]of Object.entries(me))!$e.includes(et.toLowerCase())&&ft!==null&&ft!==""&&!et.includes("validfrom")&&!et.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${et}: ${ft}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Pt.push(W);continue}let Nt=`<strong>${zt}</strong>`;const L=me.first_soilname||me.soilname,Lt=me.soilcode||me.first_soilcode;if(L&&(Nt+=`<br/><span class="text-sm text-amber-700">${L}</span>`,zt==="Bodemkaart")){const W=jO(L,Lt);W.length>0&&(Nt+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(me.soilslope&&me.soilslope!=="Niet opgenomen"&&(Nt+=`<br/><span class="text-xs text-gray-500">Helling: ${me.soilslope}</span>`),!L){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[q,X]of Object.entries(me))!W.includes(q)&&X&&X!=="Niet opgenomen"&&(Nt+=`<br/><span class="text-xs text-gray-600">${q}: ${X}</span>`)}Pt.push(Nt)}}catch(Oe){console.warn("WMS GetFeatureInfo failed:",Oe)}}return Pt},Mn=async _t=>{const Jt=[],Pt=[],sr=Ee=>{if(!Ee)return;const me=Ee.getType(),L=Ee.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:me,coordinates:L}},ai=nEe(_t.coordinate),Br=[];n.forEachFeatureAtPixel(_t.pixel,Ee=>{Br.push(Ee)});for(const Ee of Br){const me=Ee.getProperties(),{geometry:Nt,...L}=me;if(L.vondst){const X=L.vondst,ce=`<strong>${X.objectType}</strong>
            <div data-vondst-id="${X.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${X.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${X.period}</span>
            ${X.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${X.depth} cm</span>`:""}
            ${X.condition&&X.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${X.condition}</span>`:""}
            ${X.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${X.weight} gram</span>`:""}
            ${X.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${X.notes}</span>`:""}
            ${X.photoUrl?`<br/><a href="${X.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(X.timestamp).toLocaleDateString("nl-NL")}</span>`;Jt.push(ce),Pt.push(null),M(X.id);continue}if(L.layerType==="customPoint"&&L.customPoint){const X=L.customPoint,ce=L.customLayerName||"Mijn Laag",he=L.customLayerColor||"#f97316";let Ve="";if(X.popupContent?(Ve=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${he}"></span>
              <span class="text-xs font-medium" style="color: ${he}">${ce}</span>
            </div>`,Ve+=X.popupContent):(Ve=`<strong>${X.name}</strong>`,Ve+=`<br/><span class="text-xs text-gray-500">${ce}</span>`,X.category&&X.category!=="Overig"&&(Ve+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${X.category}</span>`)),X.photos&&X.photos.length>0){Ve+='<div class="flex flex-wrap gap-1 my-2">';for(const Ie of X.photos.slice(0,3)){const $e=Ie.thumbnailUrl||Ie.thumbnailBase64;$e&&(Ve+=`<img src="${$e}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}X.photos.length>3&&(Ve+=`<span class="text-xs text-gray-400 self-end">+${X.photos.length-3} meer</span>`),Ve+="</div>"}X.notes&&!X.popupContent&&(Ve+=`<br/><span class="text-sm text-gray-600 mt-1">${X.notes}</span>`),X.url&&(Ve+=`<br/><a href="${X.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Ve+=`<br/><span class="text-xs text-gray-400">${new Date(X.createdAt).toLocaleDateString("nl-NL")}</span>`,Jt.push(Ve),Pt.push(null);continue}if(L.layerType==="importedLayer"){const X=L.layerName||"Gemporteerde laag",ce=L.layerColor||"#8b5cf6",he=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Ve=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.description||"Feature";let Ie=`<strong style="color: ${ce}">${Ve}</strong>`;Ie+=`<br/><span class="text-xs text-gray-500">${X}</span>`;const $e=Object.entries(L).filter(([et])=>!he.includes(et)&&et!=="name"&&et!=="Name");if($e.length>0){Ie+='<div class="mt-2 space-y-1">';for(const[et,ft]of $e)if(ft!=null&&ft!==""){const St=et.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,dr=>dr.toUpperCase());let sn=String(ft);sn.length>200&&(sn=sn.substring(0,200)+"..."),sn.startsWith("http://")||sn.startsWith("https://")?Ie+=`<div class="text-sm"><span class="text-gray-500">${St}:</span> <a href="${sn}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Ie+=`<div class="text-sm"><span class="text-gray-500">${St}:</span> <span class="text-gray-700">${sn}</span></div>`}Ie+="</div>"}Jt.push(Ie),Pt.push({geometry:sr(Nt),properties:L,popupHtml:Ie});continue}if(L.kwaliteitswaarde&&L.kwaliteitswaarde.includes("archeologische waarde")){const X=mt(L);Jt.push(X),Pt.push({geometry:sr(Nt),properties:L,popupHtml:X});continue}if(L.layerType==="romeinsFort"||L.layerType==="romeinsFortLijn"){const X=L.Name||L.name||"",ce=L.description||"",he=Qwe[X]||null,Ve=he||Jwe;let Ie=`<strong class="text-red-800">${he?Ve.naam:X||"Romeins Fort"}</strong>`;he?.latinNaam&&he.latinNaam!==Ve.naam&&(Ie+=`<br/><span class="text-sm text-red-600 italic">${he.latinNaam}</span>`),Ie+=`<br/><span class="text-sm text-gray-600">${eEe[Ve.type]||Ve.type}</span>`,Ie+=`<br/><span class="text-xs text-gray-500">${Ve.periode}</span>`,L.layerType==="romeinsFortLijn"&&(Ie+='<br/><span class="text-xs text-red-700 mt-1"> Gereconstrueerde fortomtrek</span>'),Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over dit fort</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Ve.beschrijving}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat was hier?</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Ve.watWasHier}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is er nu nog te zien?</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Ve.watTeZien}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Ve.verwachteVondsten}</div>`,Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Historische betekenis</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${Ve.betekenis}</div>`,he?.bronnen&&he.bronnen.length>0?(Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Ie+='<div class="text-sm text-gray-700 mt-1">',he.bronnen.forEach($e=>{const et=$e.replace(/^https?:\/\//,"").split("/")[0];Ie+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline block">${et}</a>`}),Ie+="</div>"):(Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Ie+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Limes_(Romeinse_Rijk)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Romeinse Limes</a></div>'),!he&&ce&&(Ie+=`<div class="mt-3"><span class="text-xs text-gray-500 italic">${ce}</span></div>`),Jt.push(Ie),Pt.push({geometry:sr(Nt),properties:L,popupHtml:Ie});continue}let Lt=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.route_name||L.road_name;Lt||(L.leisure==="playground"?Lt="Speeltuin":L.leisure==="park"?Lt="Park":L.leisure==="swimming_area"||L.sport==="swimming"?Lt="Zwemplek":L.tourism==="museum"?Lt="Museum":L.amenity==="cafe"||L.amenity==="restaurant"?Lt=L.amenity==="cafe"?"Caf":"Restaurant":L.historic==="castle"?Lt="Kasteel":Lt="Info"),(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats")))&&(Lt="Bunker"),L.historic==="battlefield"&&(Lt="Historisch slagveld");let W=`<strong>${Lt}</strong>`;if(L.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${L.category}</span>`),L.from_to&&L.from_to!==Lt&&(W+=`<br/><span class="text-sm text-gray-600">${L.from_to}</span>`),L.route&&L.route!==Lt&&(W+=`<br/><span class="text-sm text-gray-600">${L.route}</span>`),L.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${L.TOPONIEM}</span>`,L.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${L.PLAATS}</span>`)),(L.AARD_VINDP||L.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${L.AARD_VINDP||L.Aard_vindp}</span>`),L.BEGIN_PER&&L.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.BEGIN_PER} - ${L.EIND_PER}</span>`),(L.AARD_OPM||L.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${L.AARD_OPM||L.Aard_opmer}</span>`),L.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${L.Gemeente}</span>`),L.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${L.Bron}</span>`),L.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${L.Bron_besch}</span>`),L.Dat_st_z&&L.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${L.Dat_st_z} - ${L.Dat_ei_z}</span>`),L.Begin&&L.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.Begin} - ${L.Einde}</span>`),L.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${L.Uiterwaard}</span>`),L.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${L.rivier}</span>`),L.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${L.Beschrijvi}</span>`),L.leisure&&L.name){const X=L.leisure==="playground"?"Speeltuin":L.leisure==="park"?"Park":L.leisure==="swimming_area"?"Zwemplek":null;X&&(W+=`<br/><span class="text-xs text-green-600">${X}</span>`)}if((L.tourism==="museum"||L.museum)&&L.name&&(W+='<br/><span class="text-xs text-purple-600">Museum</span>'),(L.leisure==="swimming_area"||L.sport==="swimming")&&L.name&&(W+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),L.osm_id&&L.address!==void 0&&(W+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',L.address&&(W+=`<br/><span class="text-xs text-gray-500">${L.address}</span>`),L.phone&&(W+=`<br/><span class="text-xs text-gray-600">${L.phone}</span>`)),L.site_type==="tumulus"){const X=Ee.getGeometry()?.getCoordinates();let ce="",he="";if(X){const Ve=vn(X),Ie=Ve[0],$e=Ve[1];Ie>5.5&&Ie<6.3&&$e>52&&$e<52.5?(ce="Veluwe",he="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Ie>6.2&&Ie<7.1&&$e>52.6&&$e<53.3?(ce="Drenthe",he="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Ie>4.5&&Ie<6&&$e>51.3&&$e<51.9?(ce="Noord-Brabant",he="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Ie>5.5&&Ie<6.3&&$e>50.7&&$e<51.6?(ce="Limburg",he="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Ie>5&&Ie<5.6&&$e>52&&$e<52.4&&(ce="Utrechtse Heuvelrug",he="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ce&&(W+=`<br/><span class="text-sm text-gray-500">${ce}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',he&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',L.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${L.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(L.historic==="castle"||L.castle_type){const X={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ce=L.castle_type?X[L.castle_type]:null,he=ce?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-600">${he}</span>`,L.start_date&&(W+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${L.start_date}</span>`),L.heritage&&(W+='<br/><span class="text-sm text-amber-600">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ce?W+=`<div class="text-sm text-gray-700 mt-1">${ce.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce?W+=`<div class="text-sm text-gray-700 mt-1">${ce.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',L.wikipedia||L.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',L.wikipedia){const Ve=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ve}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}L.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(L.historic==="ruins"){const X=L.ruins_type||"";let ce="Rune",he="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Ve="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(X.toLowerCase().includes("church")||X.toLowerCase().includes("kerk")?(ce="Kerkrune",he="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Ve="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):X.toLowerCase().includes("castle")||X.toLowerCase().includes("kasteel")?(ce="Kasteelrune",he="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Ve="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):X.toLowerCase().includes("mill")||X.toLowerCase().includes("molen")?(ce="Molenrune",he="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Ve="Gereedschap, munten, huishoudelijke voorwerpen"):X.toLowerCase().includes("fort")&&(ce="Fortrune",he="De overblijfselen van een militair fort of verdedigingswerk.",Ve="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-gray-600">${ce}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`,L.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.wikipedia){const Ie=L.wikipedia.startsWith("http")?L.wikipedia:`https://${L.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${L.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Ie}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats"))){const X={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ce=L.name||"",he=L.bunker_type?X[L.bunker_type]||L.bunker_type:"";ce&&ce!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${ce}</span>`),he&&he!==ce&&(W+=`<br/><span class="text-xs text-gray-500">${he}</span>`);const Ve=Ee.getGeometry()?.getCoordinates();let Ie="",$e="",et="";if(Ve){const ft=vn(Ve),St=ft[0],sn=ft[1],dr=St<4.8||St<5.2&&sn>51.8&&sn<53.5,cn=St>4.2&&St<4.4&&sn>52&&sn<52.15,fr=St>4.5&&St<4.7&&sn>52.4&&sn<52.5,vr=St>4&&St<4.2&&sn>51.95&&sn<52.05,Fi=St<4.2&&sn<51.6,U=St>5.2&&St<5.8&&sn>51.9&&sn<52.3;cn?(Ie="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",$e="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",et="Atlantikwall Museum Scheveningen"):fr?(Ie="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",$e="https://www.bunkermuseum.nl/",et="Bunkermuseum IJmuiden"):vr?(Ie="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",$e="https://www.atlantikwallhoekvanholland.nl/",et="Atlantikwall Hoek van Holland"):Fi?(Ie="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",$e="https://www.bunkermuseumzoutelande.nl/",et="Bunkermuseum Zoutelande"):dr?(Ie="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="Atlantikwall (Wikipedia)"):U?(Ie="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",$e="https://nl.wikipedia.org/wiki/Grebbelinie",et="Grebbelinie (Wikipedia)"):(Ie="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)")}else Ie="Een bunker uit de Tweede Wereldoorlog.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ie}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${et}</a>`,L.website?W+=`<br/><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(L.historic==="battlefield"){const X=L.name||"Onbekend slagveld",he={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[X];if(X!=="Onbekend slagveld"&&X!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${X}</span>`),he)W+=`<br/><span class="text-xs text-gray-500">${he.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${he.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,X.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),X.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(L.date&&(W+=`<br/><span class="text-xs text-gray-500">${L.date}</span>`),L.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),L.wikipedia){const Ve=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ve}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bron==="Paleobiology Database"){const X=Ie=>{const $e={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[et,ft]of Object.entries($e))if(Ie.toLowerCase().includes(et.toLowerCase()))return ft;return""},ce=Ie=>{const $e={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[et,ft]of Object.entries($e))if(Ie.toLowerCase().includes(et.toLowerCase()))return ft;return""},he=Ie=>{const $e={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let et=Ie;for(const[ft,St]of Object.entries($e))et=et.replace(new RegExp(ft,"gi"),St);return et},Ve=Ie=>{const $e={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let et=Ie;for(const[ft,St]of Object.entries($e))et=et.replace(new RegExp(ft,"gi"),St);return et};if(L.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${L.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',L.taxonomie&&L.taxonomie!=="Onbekend"){const Ie=X(L.taxonomie);Ie?(W+=`<div class="text-sm text-gray-700 mt-1">${Ie}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${L.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${L.taxonomie}</div>`}if(L.aantal_fossielen){const Ie=parseInt(L.aantal_fossielen),$e=Ie>100?"Veel fossielen gevonden op deze locatie.":Ie>10?"Meerdere fossielen gevonden op deze locatie.":`${L.aantal_fossielen} fossiel${Ie>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${$e}</div>`}if(L.periode&&L.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Ie=ce(L.periode);W+=`<div class="text-sm text-gray-700 mt-1">${L.periode}</div>`,Ie&&(W+=`<div class="text-sm text-gray-600">${Ie}</div>`),L.ouderdom&&L.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${L.ouderdom}</div>`)}(L.gesteente||L.formatie||L.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',L.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${he(L.gesteente)}</div>`),L.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${L.formatie}</div>`,L.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${L.lid}</div>`)),L.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${Ve(L.milieu)}</div>`))}if(L.layerType==="fossielHotspot"){const X=[];if(L.type&&X.push(L.type),L.region&&X.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};X.push(ce[L.country]||L.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),(L.finds||L.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${L.period}</div>`),L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const he=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="mineralenHotspot"){const X=[];if(L.region&&X.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};X.push(ce[L.country]||L.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),L.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.minerals}</div>`,L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const he=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")||L.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="goudrivier"){const X=[];if(L.river&&X.push(L.river),L.region&&X.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};X.push(ce[L.country]||L.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),(L.goldType||L.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.goldType}</div>`),L.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${L.origin}</div>`)),L.legal||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',L.legal){const he=L.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${L.legal}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="wandelroute"){const X=[];if(L.region&&X.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi"};X.push(ce[L.country]||L.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),L.distance||L.duration){const ce=L.distance?`${L.distance} km`:"",he=L.duration?`${L.duration}`:"",Ve=[ce,he].filter(Boolean).join("  ");Ve&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${Ve}</span>`)}(L.description||L.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${L.highlights}</div>`)),L.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.startAddress}</div>`),L.url&&(W+=`<div class="mt-3"><a href="${L.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(L.layerType==="hunebed"){L.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`);const X=[];if(L.stones){const ce=L.stones.toLowerCase(),he=ce.match(/(\d+)\s*dekst[^\s,]*/i),Ve=ce.match(/(\d+)\s*draagst[^\s,]*/i),Ie=ce.match(/(\d+)\s*sluitst[^\s,]*/i),$e=ce.match(/(\d+)\s*poortst[^\s,]*/i),et=ce.match(/(\d+)\s*gangdekst[^\s,]*/i),ft=ce.match(/(\d+)\s*gangzijst[^\s,]*/i);he&&X.push(`${he[1]} deksteen${parseInt(he[1])>1?"en":""} (de grote steen${parseInt(he[1])>1?"en":""} bovenop)`),Ve&&X.push(`${Ve[1]} draagstenen (de stenen die de dekstenen dragen)`),Ie&&X.push(`${Ie[1]} sluitsteen${parseInt(Ie[1])>1?"en":""} (afsluiting aan de korte zijden)`),$e&&X.push(`${$e[1]} poortsteen${parseInt($e[1])>1?"en":""} (bij de ingang)`),et&&X.push(`${et[1]} gangdeksteen${parseInt(et[1])>1?"en":""} (boven de toegangsgang)`),ft&&X.push(`${ft[1]} gangzijstenen (langs de toegangsgang)`)}if(L.length&&X.push(`Een grafkamer van ${L.length} lang`),L.width&&X.push(`${L.width}`),X.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',X.forEach(ce=>{W+=`<li>${ce}</li>`}),W+="</ul>"),L.notable){const ce=L.notable.toLowerCase();let he="Wat is hier bijzonder?";ce.includes("grootste")?he="Waarom is dit het grootste hunebed?":ce.includes("klein")||ce.includes("kindhunebed")?he="Waarom is dit hunebed zo klein?":ce.includes("cluster")||ce.includes("naast elkaar")?he="Waarom liggen hier meerdere hunebedden?":(ce.includes("enige")||ce.includes("westelijk")||ce.includes("noordelijk"))&&(he="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${he}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${L.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',L.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',L.access?W+=`<div class="text-sm text-gray-700 mt-1">${L.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',L.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${L.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((L.inventarisnummer||L.locatie_naam)&&(L.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${L.locatie_naam}</span>`),L.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${L.inventarisnummer}</span>`),L.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${L.datering_tekst}</span>`)),(L.veensoort||L.dikte)&&(L.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${L.veensoort}</span>`),L.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${L.dikte}</span>`)),L.nature&&L.debut){W+=`<br/><span class="text-sm text-purple-700">${L.nature}</span>`;const X=L.debut===L.fin?L.debut:`${L.debut} - ${L.fin}`;X&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${X}</span>`),L.structure&&(W+=`<br/><span class="text-xs text-gray-600">${L.structure}</span>`),L.commune&&(W+=`<br/><span class="text-xs text-gray-500">${L.commune}</span>`),L.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${L.decouvert}</span>`),L.numero&&(W+=`<br/><span class="text-xs text-gray-400">${L.numero}</span>`)}if((L.NATURE_OPE||L.CODE_OPERA)&&(L.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${L.TITRE}</span>`),L.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${L.NATURE_OPE}</span>`),L.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${L.AUTEUR}</span>`),L.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.DATE}</span>`),L.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${L.COMMUNE}</span>`)),L.type_protection&&(L.n_site||L.t_site)){const X=L.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${X}">${L.type_protection}</span>`,L.n_site&&(W+=`<br/><span class="text-sm font-semibold">${L.n_site}</span>`),L.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${L.t_site}</span>`),L.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${L.c_site}</span>`),L.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${L.d_creation}</span>`)}if(L.type_protection&&L.cod_diren){const X=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${X}">${L.type_protection}</span>`,L.proced&&(W+=`<br/><span class="text-xs text-gray-600">${L.proced}</span>`),L.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.d_proced}</span>`),L.comment){const ce=String(L.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(L.comment).length>150?"...":""}</span>`}}if(L.type_protection&&L.nomsite){const X=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${X}">${L.type_protection}</span>`,L.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${L.caractere}</span>`),L.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.datedecis}</span>`),L.descriptio){const ce=String(L.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(L.descriptio).length>150?"...":""}</span>`}}if(L.secteur&&L.style){if(W+=`<br/><span class="text-sm text-gray-700">${L.secteur}</span>`,L["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${L["sous-secteur"]}</span>`),L.description){const X=String(L.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${X}${String(L.description).length>150?"...":""}</span>`}L.url&&(W+=`<br/><a href="${L.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(L.nature_operation||L.synthese){L.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${L.nature_operation}</span>`),L.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${L.responsable_operation}</span>`),L.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.date_operation}</span>`);const X=[];if(L.prehistoire==="Oui"&&X.push("Prehistorie"),L.protohistoire==="Oui"&&X.push("Protohistorie"),L.antiquite==="Oui"&&X.push("Romeins"),L.moyen_age==="Oui"&&X.push("Middeleeuwen"),L.temps_modernes==="Oui"&&X.push("Moderne tijd"),X.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${X.join(", ")}</span>`),L.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${L.adresse}</span>`),L.synthese){const ce=String(L.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(L.synthese).length>200?"...":""}</span>`}}if(L.operator&&(W+=`<br/><span class="text-sm text-gray-600">${L.operator}</span>`),L.opening_hours){const X=tEe(String(L.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${X}</span>`}if(L.website&&(W+=`<br/><a href="${L.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),L.addr_street){const X=[L.addr_street,L.addr_housenumber,L.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${X}</span>`}const q=L.description||L.omschrijving||L.descr||L.info;q&&q!==Lt&&(W+=`<br/><span class="text-sm text-gray-600">${q}</span>`),Jt.push(W),Pt.push({geometry:sr(Nt),properties:L,popupHtml:W})}const zt=n.getView().getResolution()||1,ns=await Bt(_t.coordinate,zt);Jt.push(...ns);for(const Ee of ns)Pt.push(null);const Oe=await ai;if(Jt.length===0&&Oe!==null){const Ee=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${Oe.toFixed(2)} m NAP</span>
          </div>`;Jt.push(Ee),Pt.push(null)}if(Jt.length>0&&Oe!==null&&(Jt[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${Oe.toFixed(2)} m NAP</span>
        </div>`),Jt.length>0){l(Jt),V(Pt),h(0),console.log(` KLIK OPGESLAGEN: [${_t.coordinate[0].toFixed(0)}, ${_t.coordinate[1].toFixed(0)}]`),v(_t.coordinate),E(!1),N(!1),ue(!1),le(""),z(null);const Ee=vn(_t.coordinate);be(Ee),C(`https://www.google.com/maps/dir/?api=1&destination=${Ee[1]},${Ee[0]}`),g(!0)}};return n.on("click",Mn),()=>{n.un("click",Mn)}},[n]);const en=()=>{g(!1),n&&x&&(Kb(n),E(!1))},Qn=(mt,Bt)=>{Bt.offset.y>100&&en()};return m.jsx(ir,{children:f&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:en}),m.jsxs(At.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",style:{fontSize:`${14*ne/100}px`},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:Qn,children:[m.jsx("div",{className:"flex justify-center pt-2 pb-1",children:m.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),m.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[Be&&m.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[m.jsx("button",{onClick:Qt,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:m.jsx(cae,{size:18})}),m.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[u+1,"/",o.length]}),m.jsx("button",{onClick:ot,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:m.jsx(Bw,{size:18})})]}),m.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Ct||"Info"}),j&&m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>N(!P),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${O?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:O?m.jsx(Kl,{size:18}):m.jsx(co,{size:18})}),P&&m.jsxs("div",{className:"absolute right-0 top-8 z-50 bg-white rounded-lg shadow-md py-1 min-w-[180px] max-w-[220px]",children:[m.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),m.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(mt=>!mt.archived).map(mt=>m.jsxs("button",{onClick:()=>{const Bt=Q;s(mt.id,{name:Ct||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Ct,geometry:Bt?.geometry,sourceProperties:Bt?.properties,popupContent:Bt?.popupHtml}),N(!1),z(mt.name),setTimeout(()=>z(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:mt.color}}),m.jsx("span",{className:"truncate",children:mt.name})]},mt.id))}),m.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Ne?m.jsxs("div",{className:"px-2 py-1",children:[m.jsx("input",{type:"text",value:Te,onChange:mt=>le(mt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:mt=>{if(mt.key==="Enter"&&Te.trim()){const Bt=a(Te.trim()),Mn=Q;s(Bt,{name:Ct||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Ct,geometry:Mn?.geometry,sourceProperties:Mn?.properties,popupContent:Mn?.popupHtml}),N(!1),ue(!1),le(""),z(Te.trim()),setTimeout(()=>z(null),2e3)}else mt.key==="Escape"&&(ue(!1),le(""))}}),m.jsxs("div",{className:"flex gap-1 mt-1",children:[m.jsx("button",{onClick:()=>{if(Te.trim()){const mt=a(Te.trim()),Bt=Q;s(mt,{name:Ct||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Ct,geometry:Bt?.geometry,sourceProperties:Bt?.properties,popupContent:Bt?.popupHtml}),N(!1),ue(!1),le(""),z(Te.trim()),setTimeout(()=>z(null),2e3)}},disabled:!Te.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),m.jsx("button",{onClick:()=>{ue(!1),le("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):m.jsxs("button",{onClick:()=>ue(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),R&&m.jsx("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Open in Google Maps","aria-label":"Open in Google Maps",children:m.jsx(T1,{size:18})}),m.jsx("button",{onClick:en,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:m.jsx(vi,{size:18})})]}),m.jsx("div",{className:"px-4 py-3 max-h-[45vh] overflow-y-auto select-text",style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:hn}}),m.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2",children:[m.jsx(Koe,{size:14,className:"text-gray-400 flex-shrink-0"}),m.jsx("input",{type:"range",min:"80",max:"150",value:ne,onChange:mt=>pe(parseInt(mt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[ne,"%"]})]}),jn&&I&&!F&&m.jsxs("div",{className:"px-4 pb-4 flex gap-2",children:[m.jsxs("button",{onClick:()=>{const mt=r.find(Bt=>Bt.id===I);mt&&G(mt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(L0,{size:16}),m.jsx("span",{children:"Bewerken"})]}),m.jsxs("button",{onClick:()=>{e(I),g(!1),M(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(Cu,{size:16}),m.jsx("span",{children:"Verwijderen"})]})]}),F&&m.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3",children:[m.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),m.jsx("input",{type:"text",value:F.objectType,onChange:mt=>G({...F,objectType:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),m.jsx("input",{type:"text",value:F.material,onChange:mt=>G({...F,material:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),m.jsx("input",{type:"text",value:F.period,onChange:mt=>G({...F,period:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),m.jsx("textarea",{value:F.notes,onChange:mt=>G({...F,notes:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:()=>G(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),m.jsx("button",{onClick:()=>{t(F.id,{objectType:F.objectType,material:F.material,period:F.period,notes:F.notes}),G(null),g(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),Mt&&y&&m.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:x?m.jsxs("button",{onClick:on,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(Pb,{size:16}),m.jsx("span",{children:"Hoogtekaart verbergen"})]}):m.jsx("button",{onClick:Zn,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?m.jsxs(m.Fragment,{children:[m.jsx(AR,{size:16,className:"animate-spin"}),m.jsx("span",{children:"Laden..."})]}):m.jsxs(m.Fragment,{children:[m.jsx(Pb,{size:16}),m.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const VO=1e-4;function aEe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<VO&&i<VO})}function oEe(){const n=Di(P=>P.map),e=yr(P=>P.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=yr(),s=Qi(P=>P.layers),[a,o]=ee.useState(null),[l,u]=ee.useState(!1),[h,f]=ee.useState(!1),[g,y]=ee.useState(!1),v=ee.useRef(null),x=ee.useRef(null);ee.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const P=n.getViewport();if(!P){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",P);const N=600,O=15,z=Te=>{if(console.log(" Touch start, touches:",Te.touches.length),Te.touches.length!==1)return;const le=Te.touches[0];x.current={x:le.clientX,y:le.clientY},console.log(" Starting long press timer at:",x.current),v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",x.current),!x.current)return;const se=window.__olMap;if(!se){console.log(" Map not available (global)");return}const V=P.getBoundingClientRect(),Q=[x.current.x-V.left,x.current.y-V.top],ne=se.getCoordinateFromPixel(Q);if(ne){const ie=vn(ne);Te.preventDefault(),o({pixel:[x.current.x,x.current.y],coordinate:ie}),u(!0),f(!1),setTimeout(()=>f(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ie)}},N)},j=Te=>{if(!v.current||!x.current)return;const le=Te.touches[0],se=le.clientX-x.current.x,V=le.clientY-x.current.y,Q=Math.sqrt(se*se+V*V);Q>O&&(console.log(" Touch moved too much, cancelling. Distance:",Q),clearTimeout(v.current),v.current=null)},be=()=>{console.log(" Touch end, timer active:",!!v.current),v.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(v.current),v.current=null),x.current=null},Pe=Te=>{l&&Te.preventDefault()},je=Te=>{Te.button===0&&(console.log(" Mouse down"),x.current={x:Te.clientX,y:Te.clientY},v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!x.current)return;const le=window.__olMap;if(console.log(" __olMap:",le),console.log(" __olMap constructor:",le?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof le?.getCoordinateAtPixel),!le){console.log(" Map not available (global)");return}const se=P.getBoundingClientRect(),V=[x.current.x-se.left,x.current.y-se.top];console.log(" Pixel:",V);const Q=le.getCoordinateFromPixel(V);if(console.log(" Coordinate:",Q),Q){const ne=vn(Q);o({pixel:[x.current.x,x.current.y],coordinate:ne}),u(!0),f(!1),setTimeout(()=>f(!0),300),console.log(" Long press (mouse) detected at:",ne)}},N))},Ne=Te=>{if(!v.current||!x.current)return;const le=Te.clientX-x.current.x,se=Te.clientY-x.current.y;Math.sqrt(le*le+se*se)>O&&(console.log(" Mouse moved, cancelling"),clearTimeout(v.current),v.current=null)},ue=()=>{console.log(" Mouse up"),v.current&&(clearTimeout(v.current),v.current=null),x.current=null};return P.addEventListener("touchstart",z,{passive:!1}),P.addEventListener("touchmove",j,{passive:!0}),P.addEventListener("touchend",be),P.addEventListener("touchcancel",be),P.addEventListener("contextmenu",Pe),P.addEventListener("mousedown",je),P.addEventListener("mousemove",Ne),P.addEventListener("mouseup",ue),P.addEventListener("mouseleave",ue),()=>{P.removeEventListener("touchstart",z),P.removeEventListener("touchmove",j),P.removeEventListener("touchend",be),P.removeEventListener("touchcancel",be),P.removeEventListener("contextmenu",Pe),P.removeEventListener("mousedown",je),P.removeEventListener("mousemove",Ne),P.removeEventListener("mouseup",ue),P.removeEventListener("mouseleave",ue),v.current&&clearTimeout(v.current)}},[n,l]);const E=()=>{h&&(u(!1),o(null),f(!1),y(!1))},T=()=>{u(!1),o(null),f(!1),y(!1)},b=P=>{if(!a)return;const[N,O]=a.coordinate;t(P,{lat:O,lng:N}),T()},I=()=>{r(),T()},M=()=>{if(!a)return;const[P,N]=a.coordinate;e({lat:N,lng:P}),u(!1),o(null),f(!1)},F=()=>{if(!a)return;const[P,N]=a.coordinate,O=`https://www.google.com/maps?q=${N},${P}`;window.open(O,"_blank"),u(!1),o(null),f(!1)},G=()=>{if(!a)return;const P=document.createElement("input");P.type="file",P.accept="image/*",P.capture="environment",P.onchange=async N=>{const O=N.target.files?.[0];if(!O)return;const[z,j]=a.coordinate;e({lat:j,lng:z},O)},P.click(),T()},R=()=>{i(),T()},C=P=>{const[N,O]=P;return`${O.toFixed(5)}N, ${N.toFixed(5)}E`};return m.jsx(ir,{children:l&&a&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:E}),m.jsxs(At.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:Math.min(a.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[m.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[m.jsx(el,{size:16}),m.jsx("span",{className:"text-xs font-mono",children:C(a.coordinate)})]})}),m.jsxs("div",{className:"bg-white",children:[m.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(Cb,{size:20,className:"text-orange-500"}),m.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),m.jsxs("button",{onClick:G,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(bR,{size:20,className:"text-green-500"}),m.jsx("span",{className:"font-medium",children:"Foto maken"})]}),m.jsxs("div",{className:"relative",children:[m.jsxs("button",{onClick:()=>y(!g),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(so,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),m.jsx(Bw,{size:16,className:`text-gray-400 transition-transform ${g?"rotate-90":""}`})]}),m.jsx(ir,{children:g&&m.jsx(At.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Maak eerst een laag aan"})]}):m.jsxs(m.Fragment,{children:[s.map(P=>{const N=a?aEe(P,a.coordinate):!1;return m.jsxs("button",{onClick:()=>!N&&b(P.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${N?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:N?"Al toegevoegd aan deze laag":void 0,disabled:N,children:[N&&m.jsx(Kl,{size:14,className:"text-green-500 flex-shrink-0"}),m.jsx("span",{className:"truncate",children:P.name}),m.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:N?"al toegevoegd":`(${P.points.length})`})]},P.id)}),m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),m.jsxs("button",{onClick:R,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(Roe,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),m.jsxs("button",{onClick:F,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(T1,{size:20,className:"text-blue-600"}),m.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]})]}),m.jsx("div",{className:"bg-white",children:m.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[m.jsx(vi,{size:18}),m.jsx("span",{children:"Annuleren"})]})})]})]})})}const lEe={Compass:Eae,TreePalm:Woe,Mountain:Pb,Waves:Zoe,Search:Mb,Target:Uoe,Layers:so,Grid:Gae},cEe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},uEe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},GO=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],hEe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],dEe=[5.2913,52.1326],fEe=8;function gEe(){const n=fi(N=>N.setLayerVisibility),e=os(N=>N.stopTracking),t=Di(N=>N.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=yr(),{presets:a,applyPreset:o,updatePreset:l,createPreset:u,resetToDefaults:h}=JF(),f=fi(N=>N.visible),g=Lr(N=>N.presetPanelFontScale),y=Lr(N=>N.setPresetPanelFontScale),v=12*g/100,[x,E]=ee.useState(null),[T,b]=ee.useState(!1),[I,M]=ee.useState(""),F=()=>{s(),GO.forEach(N=>n(N,!1)),hEe.forEach(N=>{n(N,N==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:ka(dEe),zoom:fEe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},G=N=>{o(N),s()},R=(N,O)=>{N.stopPropagation();const z=Object.entries(f).filter(([j,be])=>be&&GO.includes(j)).map(([j])=>j);l(O,{layers:z}),E(O),setTimeout(()=>E(null),2e3),console.log(" Lagen opgeslagen naar preset")},C=()=>{I.trim()&&(u(I.trim(),"Layers"),M(""),b(!1))},P=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return m.jsxs(m.Fragment,{children:[m.jsx(At.button,{onClick:F,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:m.jsx(yoe,{size:20,className:"text-gray-600"})}),m.jsx(At.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?m.jsx(L9,{size:20,className:"text-blue-600"}):m.jsx(so,{size:20,className:"text-blue-600"})}),m.jsx(ir,{children:r&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),m.jsxs(At.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${v}px`},children:[m.jsx("span",{className:"font-medium text-white",children:"Presets"}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:g,onInput:N=>{y(parseInt(N.target.value))},onChange:N=>y(parseInt(N.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${g}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),m.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(N=>{const O=lEe[N.icon]||so,z=cEe[N.icon]||"text-blue-600",j=uEe[N.icon]||"hover:bg-blue-50",be=x===N.id;return m.jsxs("button",{onClick:()=>G(N.id),className:`w-full h-8 flex items-center gap-2 px-2 ${j} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${be?"bg-green-50":""}`,style:{fontSize:`${v}px`},children:[m.jsx(O,{size:14,className:`${z} flex-shrink-0`}),m.jsx("span",{className:"text-gray-700 truncate flex-1",children:N.name}),be?m.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:m.jsx(Kl,{size:14,className:"text-green-500"})}):m.jsx("span",{onClick:Pe=>R(Pe,N.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:m.jsx(V9,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},N.id)})}),m.jsx("div",{className:"border-t border-gray-200 p-2",children:T?m.jsxs("div",{className:"flex gap-1",children:[m.jsx("input",{type:"text",value:I,onChange:N=>M(N.target.value),onKeyDown:N=>{N.key==="Enter"&&C(),N.key==="Escape"&&b(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${v}px`}}),m.jsx("button",{onClick:C,disabled:!I.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:m.jsx(Kl,{size:14})})]}):m.jsxs("div",{className:"flex gap-1",children:[m.jsxs("button",{onClick:()=>b(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${v}px`},children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe preset"})]}),m.jsx("button",{onClick:P,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:m.jsx(xoe,{size:14})})]})})]})]})})]})}function mEe(){const n=Di(a=>a.map),[e,t]=ee.useState(0),[r,i]=ee.useState(!1);ee.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),u=l*180/Math.PI;t(u),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return m.jsx(ir,{children:r&&m.jsx(At.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:m.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[m.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),m.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),m.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const pEe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],yEe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function _Ee(){const[n,e]=ee.useState(!1),[t,r]=ee.useState(!1),i=fi(h=>h.visible),s=fi(h=>h.opacity),a=fi(h=>h.setLayerOpacity),o=pEe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),u=o.length>3;return m.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[m.jsxs(At.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[m.jsx(Moe,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&m.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),m.jsxs(At.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[m.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),m.jsx("div",{className:"space-y-3",children:l.map(h=>{const f=s[h.name]??h.default;return m.jsxs("div",{children:[m.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"range",min:"0",max:"100",value:f*100,onChange:g=>a(h.name,parseInt(g.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${yEe[h.color]}`}),m.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(f*100),"%"]})]})]},h.name)})}),u&&m.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?m.jsxs(m.Fragment,{children:[m.jsx(L9,{size:14}),"Minder tonen"]}):m.jsxs(m.Fragment,{children:[m.jsx(IR,{size:14}),o.length-3," meer..."]})})]})]})})]})}function xEe(){const n=Di(I=>I.map),[e,t]=ee.useState(!1),[r,i]=ee.useState(""),[s,a]=ee.useState([]),[o,l]=ee.useState(!1),[u,h]=ee.useState(!1),f=ee.useRef(null),g=ee.useRef(null),y=ee.useRef();ee.useEffect(()=>{e&&f.current&&f.current.focus()},[e]),ee.useEffect(()=>{if(!e)return;const I=M=>{g.current&&!g.current.contains(M.target)&&v()};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[e]),ee.useEffect(()=>{if(!e)return;const I=M=>{M.key==="Escape"&&v()};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[e]),ee.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();M.response?.docs&&a(M.response.docs)}catch(I){console.error("Search error:",I),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const v=()=>{t(!1),i(""),a([]),l(!1)},x=async I=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(I)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const R=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(R)return{lng:parseFloat(R[1]),lat:parseFloat(R[2])}}}catch(M){console.error("Lookup error:",M)}return null},E=async I=>{if(!n)return;const M=await x(I.id);M&&n.getView().animate({center:ka([M.lng,M.lat]),zoom:16,duration:1e3}),v()},T=async(I,M)=>{M.stopPropagation();const F=await x(I.id);if(F){const G=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(G,"_blank")}v()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?m.jsxs("div",{ref:g,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[m.jsxs(At.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[m.jsx(Mb,{size:18,className:"search-icon"}),m.jsx("input",{ref:f,type:"text",value:r,onChange:I=>{i(I.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),m.jsx("button",{onClick:v,className:"search-clear",title:"Sluiten",children:m.jsx(vi,{size:18})})]}),m.jsx(ir,{children:o&&s.length>0&&m.jsx(At.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(I=>m.jsxs("li",{className:"search-result-item",children:[m.jsx("div",{className:"search-result-content",onClick:()=>E(I),children:m.jsx("span",{className:"search-result-text",children:I.weergavenaam})}),m.jsx("button",{className:"search-navigate-btn",onClick:M=>T(I,M),title:"Open in Google Maps",children:m.jsx(T1,{size:20})})]},I.id))})}),o&&u&&m.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):m.jsx(At.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:m.jsx(Mb,{size:22,className:"text-gray-600"})})}function vEe(){const n=Di(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return m.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[m.jsx(At.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:m.jsx(co,{size:18,className:"text-gray-600"})}),m.jsx(At.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:m.jsx(noe,{size:18,className:"text-gray-600"})})]})}const wEe="detector2024",Qb="detectorapp-auth";function EEe({children:n}){const[e,t]=ee.useState(!1),[r,i]=ee.useState(""),[s,a]=ee.useState(!1),[o,l]=ee.useState(""),[u,h]=ee.useState(!0);ee.useEffect(()=>{localStorage.getItem(Qb)==="authenticated"&&t(!0),h(!1)},[]);const f=g=>{g.preventDefault(),l(""),r===wEe?(localStorage.setItem(Qb,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return u?m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:m.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?m.jsx(m.Fragment,{children:n}):m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:m.jsxs(At.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(kb,{size:32,className:"text-blue-600"})}),m.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),m.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),m.jsxs("form",{onSubmit:f,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{type:s?"text":"password",value:r,onChange:g=>i(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),m.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?m.jsx(nv,{size:20}):m.jsx(rv,{size:20})})]})]}),o&&m.jsx(At.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),m.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),m.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function SEe(){localStorage.removeItem(Qb),window.location.reload()}function TEe({isOpen:n,onClose:e}){const t=Yo(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((u,h)=>h[1]-u[1]),o=l=>Math.max(...Object.values(l),1);return m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(At.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(N9,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(vi,{size:18})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?m.jsxs("div",{className:"text-center py-8 text-gray-500",children:[m.jsx(el,{size:48,className:"mx-auto mb-3 opacity-30"}),m.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),m.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[m.jsx(eT,{icon:m.jsx(el,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),m.jsx(eT,{icon:m.jsx(sv,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),m.jsx(eT,{icon:m.jsx(Toe,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),m.jsx(T_,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),m.jsx(T_,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),m.jsx(T_,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&m.jsx(T_,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),m.jsxs("div",{children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[m.jsx(M9,{size:14}),"Recente Vondsten"]}),m.jsx("div",{className:"space-y-2",children:r.recent.map(l=>m.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[m.jsxs("div",{children:[m.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),m.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),m.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),m.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function eT({icon:n,value:e,label:t,color:r}){return m.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[m.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),m.jsx("div",{className:"text-xl font-bold",children:e}),m.jsx("div",{className:"text-xs opacity-70",children:t})]})}function T_({title:n,data:e,max:t,color:r}){return e.length===0?null:m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),m.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),m.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:m.jsx(At.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),m.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function bEe(n){const{type:e,coordinates:t}=n,r=o=>ka(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new _i(r(t));case"LineString":return new na(i(t));case"Polygon":return new Pa(s(t));case"MultiPoint":return new dd(i(t));case"MultiLineString":return new Bl(s(t));case"MultiPolygon":return new Uh(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function IEe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new En({image:new Ps({radius:o,fill:new er({color:r}),stroke:new _r({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new En({stroke:new _r({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=AEe(r,.3);return new En({fill:new er({color:l}),stroke:new _r({color:r,width:2})})}return new En({image:new Ps({radius:o,fill:new er({color:r}),stroke:new _r({color:"#ffffff",width:2})})})}function AEe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function REe(){const n=Di(r=>r.map),e=x1(r=>r.layers),t=ee.useRef(new Map);return ee.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new fd;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const u=bEe(o.geometry);if(!u)return;const h=new mi({geometry:u,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((f,g)=>IEe(i,o.geometry.type,g)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new md({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),ee.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}wn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");z7(wn);function CEe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function kEe(n){const[e,t]=n;return wn("EPSG:28992","EPSG:4326",[e,t])}function TG(n,e){return typeof n[0]=="number"?e(n):n.map(t=>TG(t,e))}function PEe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function MEe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((u,h)=>({type:"Feature",geometry:u,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const u=PEe(s[0].geometry);u&&(a=CEe(u))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(u=>{if(!u.geometry)return u;const h=TG(u.geometry.coordinates,kEe);return{...u,geometry:{...u.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(u=>u.geometry).map(u=>u.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function NEe(n){const e=[],t=[];try{const r=await n.text(),s=new N0e({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new zR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},y=g.name||g.Name||`Feature ${f+1}`,v=g.description||g.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...g,name:y,description:v}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function LEe(n){const e=[],t=[];try{const r=await n.text(),s=new Kfe().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new zR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},y=g.name||g.Name||`Waypoint ${f+1}`,v=g.desc||g.description||"",x=g.time||null,E=g.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...g,name:y,description:v,time:x,elevation:E}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return u.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function vC(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function OEe(){return".geojson,.json,.kml,.gpx"}function wC(){return"GeoJSON, KML (Google My Maps), GPX"}async function DEe(n){switch(vC(n.name)){case"geojson":return MEe(n);case"kml":return NEe(n);case"gpx":return LEe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${wC()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function FEe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:vC(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${wC()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function jEe({isOpen:n,onClose:e}){const t=x1(C=>C.addLayer),r=ee.useRef(null),[i,s]=ee.useState("idle"),[a,o]=ee.useState(null),[l,u]=ee.useState(null),[h,f]=ee.useState(""),[g,y]=ee.useState(null),[v,x]=ee.useState(!1),E=ee.useCallback(()=>{s("idle"),o(null),u(null),f(""),y(null),r.current&&(r.current.value="")},[]),T=ee.useCallback(()=>{E(),e()},[E,e]),b=ee.useCallback(async C=>{const P=FEe(C);if(!P.valid){y(P.error||"Ongeldig bestand"),s("error");return}o(C),s("parsing"),y(null);const N=C.name.replace(/\.[^/.]+$/,"");f(N);try{const O=await DEe(C);if(!O.success){y(O.errors.join(`
`)),s("error");return}if(O.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}u(O),s("preview")}catch(O){y(O instanceof Error?O.message:"Onbekende fout bij parsen"),s("error")}},[]),I=ee.useCallback(C=>{const P=C.target.files?.[0];P&&b(P)},[b]),M=ee.useCallback(C=>{C.preventDefault(),x(!0)},[]),F=ee.useCallback(C=>{C.preventDefault(),x(!1)},[]),G=ee.useCallback(C=>{C.preventDefault(),x(!1);const P=C.dataTransfer.files?.[0];P&&b(P)},[b]),R=ee.useCallback(()=>{if(!l||!h.trim())return;const C=a?vC(a.name):"geojson";t({name:h.trim(),type:C==="unsupported"?"geojson":C,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),m.jsxs(At.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Uw,{size:18}),m.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),m.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(vi,{size:18})})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:M,onDragLeave:F,onDrop:G,children:[m.jsx(D9,{size:40,className:"mx-auto text-gray-400 mb-3"}),m.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),m.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),m.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),m.jsx("input",{ref:r,type:"file",accept:OEe(),onChange:I,className:"hidden"})]}),m.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[m.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),m.jsx("p",{children:wC()})]})]}),i==="parsing"&&m.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[m.jsx(AR,{size:40,className:"text-purple-500 animate-spin mb-4"}),m.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),m.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[m.jsx(O9,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),m.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:g})]})]}),m.jsx("button",{onClick:E,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[m.jsx(gae,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),m.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&m.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[m.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),m.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((C,P)=>m.jsx("li",{children:C},P))})]}),m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Features:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Types:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),m.jsx("input",{type:"text",value:h,onChange:C=>f(C.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[m.jsx("button",{onClick:E,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),m.jsx("button",{onClick:R,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function VEe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=Lw();return ee.useEffect(()=>{s()},[s]),e?m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[m.jsx(Rb,{size:16,className:"animate-pulse"}),m.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?m.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?m.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:m.jsx(PR,{size:16,className:"text-green-600"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),m.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[m.jsx(Rb,{size:12}),"Cloud sync actief"]})]}),m.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(RR,{size:16})})]}):m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[m.jsx(yae,{size:16}),m.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),m.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[m.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),m.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&m.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const GEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function BEe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=yr(),s=Lr(),{presets:a,createPreset:o,deletePreset:l,updatePreset:u}=JF(),h=Yo(Q=>Q.vondsten),f=x1(Q=>Q.layers),{layers:g,updateLayer:y}=Qi(),{devMode:v,setDevMode:x,tier:E}=$A(),[T,b]=ee.useState(""),[I,M]=ee.useState(!1),[F,G]=ee.useState(!1),[R,C]=ee.useState(null),[P,N]=ee.useState(""),[O,z]=ee.useState(null),[j,be]=ee.useState(""),[Pe,je]=ee.useState("algemeen"),Ne=14*s.fontScale/100,ue=()=>{T.trim()&&(o(T.trim(),"Layers"),b(""),M(!1))},Te=(Q,ne)=>{C(Q),N(ne)},le=Q=>{P.trim()&&(u(Q,{name:P.trim()}),console.log(` Preset hernoemd naar "${P.trim()}"`)),C(null),N("")},se=()=>{C(null),N("")},V=[{id:"algemeen",label:"Algemeen",icon:m.jsx(Loe,{size:14})},{id:"lagen",label:"Lagen",icon:m.jsx(so,{size:14})},{id:"vondsten",label:"Vondsten",icon:m.jsx(el,{size:14})}];return m.jsxs(m.Fragment,{children:[m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(At.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Ne}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Nb,{size:18,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:Q=>{s.setFontScale(parseInt(Q.target.value))},onChange:Q=>s.setFontScale(parseInt(Q.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:m.jsx(vi,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:V.map(Q=>m.jsxs("button",{onClick:()=>je(Q.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Pe===Q.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[Q.icon,Q.label]},Q.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Ne}px`},children:[Pe==="algemeen"&&m.jsxs(m.Fragment,{children:[m.jsx(ko,{title:"Account",icon:m.jsx(PR,{size:16}),children:m.jsx(VEe,{})}),m.jsxs(ko,{title:"Kaart",icon:m.jsx(CR,{size:16}),children:[m.jsx(UEe,{label:"Standaard achtergrond",children:m.jsxs("select",{value:s.defaultBackground,onChange:Q=>s.setDefaultBackground(Q.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),m.jsx("option",{value:"OpenStreetMap",children:"OSM"}),m.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),m.jsx(rh,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),m.jsxs(ko,{title:"GPS",icon:m.jsx(kR,{size:16}),children:[m.jsx(rh,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),m.jsx(rh,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),m.jsx(ko,{title:"Feedback",icon:m.jsx(Doe,{size:16}),children:m.jsx(rh,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback})}),m.jsxs(ko,{title:"Development",icon:m.jsx(vae,{size:16}),children:[m.jsx(rh,{label:"Dev Mode (alles ontgrendeld)",checked:v,onChange:x}),m.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",m.jsx("span",{className:"font-medium text-blue-600",children:E}),v&&m.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Pe==="lagen"&&m.jsxs(m.Fragment,{children:[m.jsx(ko,{title:"Mijn lagen",icon:m.jsx(so,{size:16}),isOwn:!0,children:m.jsxs("div",{className:"space-y-1",children:[g.filter(Q=>!Q.archived).length===0?m.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):g.filter(Q=>!Q.archived).map(Q=>m.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:O===Q.id?m.jsx("input",{type:"text",value:j,onChange:ne=>be(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"?(j.trim()&&y(Q.id,{name:j.trim()}),z(null)):ne.key==="Escape"&&z(null)},onBlur:()=>{j.trim()&&y(Q.id,{name:j.trim()}),z(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:Q.name}),m.jsxs("span",{className:"text-xs text-gray-400",children:[Q.points.length," punten"]}),m.jsx("button",{onClick:()=>{z(Q.id),be(Q.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:m.jsx(L0,{size:12})})]})},Q.id)),m.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(Nb,{size:14}),m.jsx("span",{children:"Lagen beheren"})]})]})}),m.jsx(ko,{title:"Lagen importeren",icon:m.jsx(Uw,{size:16}),children:m.jsxs("div",{className:"space-y-1",children:[f.length>0&&m.jsxs(m.Fragment,{children:[f.map(Q=>m.jsx(B9,{layer:Q},Q.id)),m.jsx("div",{className:"border-t border-gray-100 my-2"})]}),m.jsxs("button",{onClick:()=>G(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe laag importeren"})]}),m.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),m.jsx(ko,{title:"Presets",icon:m.jsx(so,{size:16}),children:m.jsxs("div",{className:"space-y-2",children:[a.map(Q=>m.jsx("div",{className:"flex items-center justify-between py-1",children:R===Q.id?m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("input",{type:"text",value:P,onChange:ne=>N(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&le(Q.id),ne.key==="Escape"&&se()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),m.jsx("button",{onClick:()=>le(Q.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),m.jsx("button",{onClick:se,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[Q.name,Q.isBuiltIn&&m.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),m.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",Q.layers.length," lagen)"]})]}),!Q.isBuiltIn&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>Te(Q.id,Q.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:m.jsx(L0,{size:14})}),m.jsx("button",{onClick:()=>l(Q.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:m.jsx(Cu,{size:14})})]})]})},Q.id)),I?m.jsxs("div",{className:"flex gap-2 mt-2",children:[m.jsx("input",{type:"text",value:T,onChange:Q=>b(Q.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:Q=>Q.key==="Enter"&&ue(),autoFocus:!0}),m.jsx("button",{onClick:ue,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),m.jsx("button",{onClick:()=>M(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):m.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Pe==="vondsten"&&m.jsxs(m.Fragment,{children:[m.jsxs(ko,{title:"Vondsten",icon:m.jsx(el,{size:16}),isOwn:!0,children:[m.jsx(rh,{label:"Vondsten knop tonen",checked:s.showVondstButton,onChange:s.setShowVondstButton}),m.jsx("p",{className:"text-gray-500 mt-1 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),m.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(N9,{size:14}),m.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),m.jsx(zEe,{})]}),m.jsxs(ko,{title:"Route opnemen",icon:m.jsx(iv,{size:16}),isOwn:!0,children:[m.jsx(rh,{label:"Route knop tonen",checked:s.showRouteRecordButton,onChange:s.setShowRouteRecordButton}),m.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Neem je route op tijdens het detecteren of wandelen. Routes worden lokaal opgeslagen en kunnen als GPX gexporteerd worden."})]})]})]}),m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Ne}px`},children:[m.jsxs("a",{href:GEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(P9,{size:16}),m.jsx("span",{children:"Meld een bug"})]}),m.jsxs("button",{onClick:SEe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(RR,{size:16}),m.jsx("span",{children:"Uitloggen"})]}),m.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),m.jsx(TEe,{isOpen:t,onClose:r}),m.jsx(jEe,{isOpen:F,onClose:()=>G(!1)})]})}function ko({title:n,icon:e,children:t,isOwn:r}){return m.jsxs("section",{children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[m.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),m.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),m.jsx("div",{className:"space-y-2",children:t})]})}function UEe({label:n,children:e}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function rh({label:n,checked:e,onChange:t}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),m.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function zEe(){const[n,e]=ee.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=Yo(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],u=h=>{h(),e(!1)};return t.length===0?m.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[m.jsx(tv,{size:14}),m.jsx("span",{children:"Geen vondsten om te exporteren"})]}):m.jsxs("div",{className:"relative mt-2",children:[m.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(tv,{size:14}),m.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),m.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&m.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,f)=>m.jsxs("button",{onClick:()=>u(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[m.jsx("span",{className:"text-gray-700",children:h.label}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},f))})]})}const Nv="2.27.8";function $Ee({size:n=18}){return m.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function WEe(){const[n,e]=ee.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=Lw(),{toggleInfoPanel:a,toggleSettingsPanel:o}=yr(),l=Lr(T=>T.menuFontScale),u=Lr(T=>T.setMenuFontScale),h={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},f=()=>e(!1),g=()=>{f(),a()},y=()=>{f(),o()},v=()=>{f(),i()},x=()=>{f(),s()},E=13*l/100;return m.jsxs(m.Fragment,{children:[m.jsx(At.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:h,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?m.jsx(vi,{size:22,className:"text-white"}):m.jsx(eoe,{size:22,className:"text-gray-600"})}),m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),m.jsxs(At.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${E}px`},children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[m.jsx("span",{className:"font-medium text-white",style:{fontSize:`${E}px`},children:"Menu"}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:T=>u(parseInt(T.target.value)),onChange:T=>u(parseInt(T.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?m.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:m.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?m.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?m.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:m.jsx(PR,{size:16,className:"text-white"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),m.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),m.jsx("button",{onClick:x,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(RR,{size:16})})]})}):m.jsxs("button",{onClick:v,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[m.jsx($Ee,{size:18}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),m.jsx("div",{className:"py-1",children:m.jsxs("button",{onClick:g,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[m.jsx(F9,{size:18,className:"text-blue-500"}),m.jsx("span",{children:"Info & handleiding"})]})}),m.jsx("div",{className:"mt-auto border-t border-gray-100",children:m.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[m.jsx(Nb,{size:18,className:"text-gray-500"}),m.jsx("span",{children:"Instellingen"})]})}),m.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",Nv]})]})]})})]})}const HEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function KEe(){const{infoPanelOpen:n,toggleInfoPanel:e}=yr(),[t,r]=ee.useState("info"),i=[{id:"info",label:"Info",icon:m.jsx(F9,{size:14})},{id:"functies",label:"Functies",icon:m.jsx(D9,{size:14})},{id:"handleiding",label:"Handleiding",icon:m.jsx(tae,{size:14})}];return m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(At.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[m.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",Nv]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:m.jsx(vi,{size:18,className:"text-white",strokeWidth:2.5})})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>m.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&m.jsx(YEe,{}),t==="functies"&&m.jsx(XEe,{}),t==="handleiding"&&m.jsx(qEe,{}),m.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[m.jsxs("a",{href:HEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[m.jsx(P9,{size:14}),m.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),m.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",Nv," - Gratis en zonder tracking"]})]})]})]})]})})}function YEe(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),m.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),m.jsxs("ul",{className:"space-y-2 text-gray-600",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Mindat.org"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Paleontica / Fossielen data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Map5.nl / Kadaster"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciale data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Locatiegegevens:"})," Alleen voor navigatie, niet opgeslagen of gedeeld."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Geen tracking:"})," Geen analytics, cookies of gebruiksstatistieken."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Lokale opslag:"})," Standaard blijft alle data op je apparaat."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Google sync (optioneel):"})," Met Google login worden lagen en vondsten veilig gesynchroniseerd. Alleen jij hebt toegang."]})]})]})]})}function XEe(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(CR,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(jae,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Mae,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Rb,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(kR,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),m.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),m.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),m.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),m.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),m.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(el,{size:16,className:"text-orange-600"}),"Vondsten"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),m.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),m.jsx("li",{children:"Foto's toevoegen (link of upload)"}),m.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),m.jsx("li",{children:"Dashboard met statistieken"}),m.jsx("li",{children:"Cloud sync met Google account"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(so,{size:16,className:"text-purple-600"}),"Presets"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(soe,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),m.jsx("li",{children:"Oppervlakte in m en hectare"}),m.jsx("li",{children:"Gewas en bouwplan met uitleg"}),m.jsx("li",{children:"Bodemtype met beschrijving"}),m.jsx("li",{children:"AHN hoogte in meters NAP"}),m.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),m.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(koe,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function qEe(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),m.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[m.jsxs("li",{children:["Tik op de ",m.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),m.jsxs("li",{children:["Kies een ",m.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),m.jsxs("li",{children:["Of open ",m.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),m.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsx("p",{children:"Rechtsboven vind je het menu met:"}),m.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"})," Tik op de ",m.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),m.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),m.jsxs("li",{children:["Combineer ",m.jsx("strong",{children:"AMK"})," met ",m.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),m.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),m.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),m.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(T1,{size:16,className:"text-blue-600"}),"Handige links"]}),m.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("li",{children:[m.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function bG(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function BO(n){let e=0;for(let t=1;t<n.length;t++)e+=bG(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const Dh=oa()(vd((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let u=a;o&&(u+=l-o);const h=l-s-u,f=BO(i),g={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:f,totalDuration:h,pausedDuration:u,createdAt:new Date().toISOString()};return n(y=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[g,...y.savedRoutes]})),g},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if(bG(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.has(t)?i.delete(t):i.add(t),{visibleRouteIds:i}})},showRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.add(t),{visibleRouteIds:i}})},hideRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.delete(t),{visibleRouteIds:i}})},showAllRoutes:()=>{n(t=>({visibleRouteIds:new Set(t.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{n({visibleRouteIds:new Set})},setAutoPauseEnabled:t=>{n({autoPauseEnabled:t})},setAutoPauseSeconds:t=>{n({autoPauseSeconds:t})},getCurrentDistance:()=>{const{currentPoints:t}=e();return BO(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:n=>({savedRoutes:n.savedRoutes,visibleRouteIds:Array.from(n.visibleRouteIds),autoPauseEnabled:n.autoPauseEnabled,autoPauseSeconds:n.autoPauseSeconds}),merge:(n,e)=>({...e,...n,visibleRouteIds:new Set(n?.visibleRouteIds||[])})}));function IG(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}function tT({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=ee.useState(!1),[l,u]=ee.useState(!1),[h,f]=ee.useState(""),g=e&&!r.includes(e),y=()=>{u(!0),f(g?e:""),o(!1)},v=()=>{h.trim()&&t(h.trim()),u(!1)};return l?m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:h,onChange:x=>f(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),v()),x.key==="Escape"&&u(!1)},onBlur:v,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):m.jsxs("div",{className:"relative",children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[m.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",g&&m.jsx(SL,{size:12,className:"inline ml-1 text-orange-500"})]}),m.jsx(IR,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&m.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[m.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[m.jsx(SL,{size:12}),"Eigen invoer..."]}),m.jsx("div",{className:"border-t border-gray-100"}),r.map(x=>m.jsx("button",{type:"button",onClick:()=>{t(x),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${x===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:x},x))]})]})}function AG({onClose:n,initialLocation:e}){const t=os(_e=>_e.position),r=Di(_e=>_e.map),i=yr(_e=>_e.vondstFormPhoto),s=Qi(_e=>_e.layers),a=Qi(_e=>_e.addPoint),o=Dh(_e=>_e.state),l=Dh(_e=>_e.startTime);Dh(_e=>_e.savedRoutes);const u=()=>o==="idle"||!l?null:`Route ${new Date(l).toLocaleDateString("nl-NL")} ${new Date(l).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,h=o==="recording"||o==="paused",f=u(),[g,y]=ee.useState(""),[v,x]=ee.useState(""),[E,T]=ee.useState(""),[b,I]=ee.useState(""),[M,F]=ee.useState(!1),[G,R]=ee.useState(void 0),[C,P]=ee.useState(void 0),[N,O]=ee.useState(Ya),[z,j]=ee.useState(i),[be,Pe]=ee.useState(null);ee.useEffect(()=>{if(z){const _e=URL.createObjectURL(z);return Pe(_e),()=>URL.revokeObjectURL(_e)}else Pe(null)},[z]);const[je,Ne]=ee.useState(e?"map-pick":t?"gps":"map-center"),[ue,Te]=ee.useState(e||null),[le,se]=ee.useState(!1),V=()=>{if(je==="gps"&&t)return{lat:t.lat,lng:t.lng};if(je==="map-pick"&&ue)return ue;if(r){const _e=r.getView().getCenter();if(_e){const[Ct,kt]=vn(_e);return{lat:kt,lng:Ct}}}return null},Q=V();ee.useEffect(()=>{if(!le||!r)return;const _e=Ct=>{const[kt,hn]=vn(Ct.coordinate);Te({lat:hn,lng:kt}),Ne("map-pick"),se(!1)};return r.on("click",_e),()=>r.un("click",_e)},[le,r]);const ne=()=>se(!0),ie=()=>{t&&(Ne("gps"),Te(null))},pe=()=>{const _e=document.createElement("input");_e.type="file",_e.accept="image/*",_e.capture="environment",_e.onchange=Ct=>{const kt=Ct.target.files?.[0];kt&&j(kt)},_e.click()},De=()=>j(null),Be=async _e=>{_e.preventDefault();const Ct=V();if(!Ct){alert("Geen locatie beschikbaar");return}if(!v){alert("Vul een naam/type in");return}F(!0);try{let kt=g||"";if(N===Ya){const Mt=[];E&&Mt.push(`Materiaal: ${E}`),b&&Mt.push(`Periode: ${b}`),G&&Mt.push(`Gewicht: ${G}g`),C&&Mt.push(`Lengte: ${C}mm`),Mt.length>0&&(kt=Mt.join(" | ")+(g?` | ${g}`:""))}a(N,{coordinates:[Ct.lng,Ct.lat],name:v,category:N===Ya?v:"Overig",notes:kt||"",...h&&l?{routeId:`recording-${l}`,routeName:f||void 0}:{}});const hn=s.find(Mt=>Mt.id===N)?.name||"Vondsten";alert(`Toegevoegd aan ${hn}! `),n()}catch(kt){alert("Fout bij opslaan: "+kt.message)}finally{F(!1)}},Ue=ee.useMemo(()=>s.map(_e=>({id:_e.id,name:_e.name,color:_e.color})),[s]);return le?m.jsx(At.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:m.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(Cb,{size:24,className:"animate-pulse"}),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),m.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),m.jsx("button",{onClick:()=>se(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):m.jsx(At.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:m.jsxs(At.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[m.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[m.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),m.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(vi,{size:20})})]}),m.jsxs("form",{onSubmit:Be,className:"flex-1 overflow-y-auto",children:[m.jsxs("div",{className:"p-5 space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),be?m.jsxs("div",{className:"relative",children:[m.jsx("img",{src:be,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),m.jsx("button",{type:"button",onClick:De,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:m.jsx(Cu,{size:16})})]}):m.jsxs("button",{type:"button",onClick:pe,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[m.jsx(bR,{size:32}),m.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),Q&&m.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[m.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[Q.lat.toFixed(6),"N, ",Q.lng.toFixed(6),"E"]}),m.jsx("div",{className:"text-xs text-orange-600 mt-1",children:je==="gps"?" GPS locatie":je==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!Q&&m.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:m.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),m.jsxs("div",{className:"flex gap-2",children:[t&&je!=="gps"&&m.jsxs("button",{type:"button",onClick:ie,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[m.jsx(kR,{size:16}),"GPS"]}),m.jsxs("button",{type:"button",onClick:ne,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[m.jsx(Cb,{size:16}),"Kies op kaart"]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:Ue.map(_e=>m.jsx("button",{type:"button",onClick:()=>O(_e.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${N===_e.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:_e.name},_e.id))})]}),N===Ya&&m.jsx(tT,{label:"Type vondst",value:v,onChange:x,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),N!==Ya&&m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:v,onChange:_e=>x(_e.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),N===Ya&&m.jsxs(m.Fragment,{children:[m.jsx(tT,{label:"Materiaal",value:E,onChange:T,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),m.jsx(tT,{label:"Periode",value:b,onChange:I,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),m.jsxs("div",{className:"flex gap-3",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),m.jsx("input",{type:"number",value:G??"",onChange:_e=>R(_e.target.value?parseFloat(_e.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),m.jsx("input",{type:"number",value:C??"",onChange:_e=>P(_e.target.value?parseFloat(_e.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),m.jsx("textarea",{value:g,onChange:_e=>y(_e.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),m.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:m.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),m.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[m.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),m.jsx("button",{type:"submit",disabled:M||!Q||le||!v,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:M?"Opslaan...":"Opslaan"})]})]})]})})}function ZEe(){const{user:n,setUser:e,setLoading:t}=Lw();return ee.useEffect(()=>{const s=x6(t0,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await CX(t0)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await v6(t0)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function QEe(){const{isAuthenticated:n,loginAnonymous:e}=ZEe(),t=Lr(u=>u.vondstenLocalOnly),r=Lr(u=>u.showVondstButton),i=yr(u=>u.vondstFormOpen),s=yr(u=>u.vondstFormLocation),a=yr(u=>u.openVondstForm),o=yr(u=>u.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return m.jsxs(m.Fragment,{children:[m.jsx(At.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:m.jsx(el,{size:22,strokeWidth:2})}),m.jsx(ir,{children:i&&m.jsx(AG,{onClose:o,initialLocation:s||void 0})})]})}function JEe(){const n=Lr(le=>le.showRouteRecordButton),e=yr(le=>le.toggleRouteDashboard),{state:t,startRecording:r,pauseRecording:i,resumeRecording:s,stopRecording:a,cancelRecording:o,addPoint:l,getCurrentDistance:u,getCurrentDuration:h,getAverageSpeed:f,currentPoints:g,savedRoutes:y}=Dh(),[v,x]=ee.useState(!1),[E,T]=ee.useState(""),[b,I]=ee.useState(!1),M=ee.useRef(null),F=le=>{const se=Math.floor(le/1e3),V=Math.floor(se/3600),Q=Math.floor(se%3600/60),ne=se%60;return V>0?`${V}:${Q.toString().padStart(2,"0")}:${ne.toString().padStart(2,"0")}`:`${Q}:${ne.toString().padStart(2,"0")}`},G=le=>le<1e3?`${Math.round(le)} m`:`${(le/1e3).toFixed(2)} km`,R=le=>`${le.toFixed(1)} km/h`;if(ee.useEffect(()=>(t==="recording"?"geolocation"in navigator&&M.current===null&&(M.current=navigator.geolocation.watchPosition(le=>{l(le.coords.longitude,le.coords.latitude,le.coords.accuracy)},le=>{console.error("GPS error:",le)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3})):M.current!==null&&(navigator.geolocation.clearWatch(M.current),M.current=null),()=>{M.current!==null&&(navigator.geolocation.clearWatch(M.current),M.current=null)}),[t,l]),!n)return null;const C=()=>{r(),I(!0)},P=()=>{i()},N=()=>{s()},O=()=>{T(`Route ${new Date().toLocaleDateString("nl-NL")}`),x(!0)},z=()=>{const le=a(E);x(!1),I(!1),T(""),le&&confirm(`Route "${le.name}" opgeslagen! (${G(le.totalDistance)})

Direct exporteren als GPX?`)&&IG(le)},j=()=>{g.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(o(),x(!1),I(!1))},be=u(),Pe=h(),je=f(),Ne=le=>{switch(le){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-purple-500 hover:bg-purple-600"}},ue=le=>{switch(le){case"recording":return m.jsx(loe,{size:22,strokeWidth:2});case"paused":return m.jsx(goe,{size:22,strokeWidth:2});default:return m.jsx(iv,{size:22,strokeWidth:2})}},Te=()=>{switch(t){case"idle":C();break;case"recording":P();break;case"paused":N();break}};return m.jsxs(m.Fragment,{children:[m.jsxs(At.button,{className:`fixed bottom-2 right-[114px] z-[1000] w-11 h-11 ${Ne(t)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Te,title:t==="idle"?"Route opnemen":t==="recording"?"Pauzeren":"Hervatten",children:[ue(t),t==="recording"&&m.jsx(At.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),m.jsx(ir,{children:t==="idle"&&y.length>0&&m.jsxs(At.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-purple-400 hover:bg-purple-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e,title:`Mijn routes (${y.length})`,children:[m.jsx(j9,{size:18,strokeWidth:2}),m.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-purple-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:y.length})]})}),m.jsx(ir,{children:(t==="recording"||t==="paused")&&m.jsx(At.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:O,title:"Stoppen en opslaan",children:m.jsx(joe,{size:18,strokeWidth:2,fill:"currentColor"})})}),m.jsx(ir,{children:b&&t!=="idle"&&m.jsxs(At.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[m.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t==="recording"?" Opname":" Gepauzeerd"}),m.jsx("button",{onClick:()=>I(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:m.jsx(vi,{size:14})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(sv,{size:16,className:"text-purple-500"}),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:G(be)})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Ab,{size:16,className:"text-blue-500"}),m.jsx(e2e,{duration:Pe,recordingState:t,formatTime:F})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Dae,{size:16,className:"text-green-500"}),m.jsx("span",{className:"text-sm text-gray-600",children:R(je)})]}),m.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[g.length," punten opgenomen"]})]})]})}),m.jsx(ir,{children:v&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>x(!1)}),m.jsxs(At.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Afstand:"}),m.jsx("span",{className:"font-medium",children:G(be)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Duur:"}),m.jsx("span",{className:"font-medium",children:F(Pe)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),m.jsx("span",{className:"font-medium",children:R(je)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Punten:"}),m.jsx("span",{className:"font-medium",children:g.length})]})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),m.jsx("input",{type:"text",value:E,onChange:le=>T(le.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:j,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),m.jsxs("button",{onClick:z,disabled:g.length<2,className:"flex-1 px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[m.jsx(V9,{size:16}),"Opslaan"]})]}),g.length<2&&m.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function e2e({duration:n,recordingState:e,formatTime:t}){const[r,i]=ee.useState(n);return ee.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),ee.useEffect(()=>{i(n)},[n]),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function t2e(){const n=Di(s=>s.map),{currentPoints:e,state:t}=Dh(),r=ee.useRef(null),i=ee.useRef(null);return ee.useEffect(()=>{if(!n)return;const s=new fd;i.current=s;const a=new md({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),ee.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>ka(a.coordinates));if(s.length>=2){const a=new mi({geometry:new na(s)});a.setStyle(new En({stroke:new _r({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new mi({geometry:new _i(s[0])});a.setStyle(new En({image:new Ps({radius:8,fill:new er({color:"rgba(34, 197, 94, 1)"}),stroke:new _r({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new mi({geometry:new _i(s[s.length-1])});a.setStyle(new En({image:new Ps({radius:6,fill:new er({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new _r({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const UO=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function n2e(){const n=Di(s=>s.map),{savedRoutes:e,visibleRouteIds:t}=Dh(),r=ee.useRef(null),i=ee.useRef(null);return ee.useEffect(()=>{if(!n)return;const s=new fd;i.current=s;const a=new md({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),ee.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(a=>t.has(a.id)).forEach((a,o)=>{const l=UO[o%UO.length],u=a.points.map(x=>ka(x.coordinates));if(u.length<2)return;const h=new mi({geometry:new na(u),routeId:a.id,routeName:a.name});h.setStyle(new En({stroke:new _r({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(h);const f=new mi({geometry:new _i(u[0]),routeId:a.id,type:"start"});f.setStyle(new En({image:new Ps({radius:8,fill:new er({color:"#22c55e"}),stroke:new _r({color:"white",width:2})}),text:new Go({text:"S",font:"bold 10px sans-serif",fill:new er({color:"white"}),offsetY:1})})),i.current.addFeature(f);const g=new mi({geometry:new _i(u[u.length-1]),routeId:a.id,type:"end"});g.setStyle(new En({image:new Ps({radius:8,fill:new er({color:"#ef4444"}),stroke:new _r({color:"white",width:2})}),text:new Go({text:"E",font:"bold 10px sans-serif",fill:new er({color:"white"}),offsetY:1})})),i.current.addFeature(g);const y=Math.floor(u.length/2),v=new mi({geometry:new _i(u[y]),routeId:a.id,type:"label"});v.setStyle(new En({text:new Go({text:a.name,font:"12px sans-serif",fill:new er({color:"#1f2937"}),stroke:new _r({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(v)})},[e,t]),null}function r2e({route:n,size:e=80}){const t=ee.useRef(null);return ee.useEffect(()=>{const r=t.current;if(!r||n.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=n.points.map(M=>M.coordinates[0]),a=n.points.map(M=>M.coordinates[1]),o=Math.min(...s),l=Math.max(...s),u=Math.min(...a),h=Math.max(...a),f=8,g=e-f*2,y=e-f*2,v=M=>l===o?e/2:f+(M-o)/(l-o)*g,x=M=>h===u?e/2:f+y-(M-u)/(h-u)*y;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),n.points.forEach((M,F)=>{const G=v(M.coordinates[0]),R=x(M.coordinates[1]);F===0?i.moveTo(G,R):i.lineTo(G,R)}),i.stroke();const E=v(n.points[0].coordinates[0]),T=x(n.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(E,T,4,0,Math.PI*2),i.fill();const b=v(n.points[n.points.length-1].coordinates[0]),I=x(n.points[n.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(b,I,4,0,Math.PI*2),i.fill()},[n,e]),n.points.length<2?m.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:m.jsx(el,{size:20})}):m.jsx("canvas",{ref:t,width:e,height:e,className:"rounded"})}const zO=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,$O=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},i2e=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function s2e({isOpen:n,onClose:e,onViewRoute:t}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:a,visibleRouteIds:o,toggleRouteVisibility:l,showAllRoutes:u,hideAllRoutes:h}=Dh(),[f,g]=ee.useState(null),[y,v]=ee.useState(""),x=G=>{g(G.id),v(G.name)},E=G=>{y.trim()&&s(G,y.trim()),g(null),v("")},T=G=>{confirm(`Weet je zeker dat je "${G.name}" wilt verwijderen?`)&&i(G.id)},b=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&a()},I=G=>{l(G);const R=r.find(C=>C.id===G);R&&t&&t(R)},M=r.reduce((G,R)=>G+R.totalDistance,0),F=r.reduce((G,R)=>G+R.totalDuration,0);return m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(At.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(iv,{size:20}),m.jsx("span",{className:"font-medium",children:"Mijn Routes"}),m.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:m.jsx(vi,{size:18})})]}),r.length>0&&m.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[m.jsxs("div",{className:"flex gap-4",children:[m.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[m.jsx(sv,{size:14}),m.jsxs("span",{children:["Totaal: ",zO(M)]})]}),m.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[m.jsx(Ab,{size:14}),m.jsx("span",{children:$O(F)})]})]}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{onClick:u,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:m.jsx(rv,{size:14})}),m.jsx("button",{onClick:h,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:m.jsx(nv,{size:14})})]})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?m.jsxs("div",{className:"text-center py-12 text-gray-500",children:[m.jsx(iv,{size:48,className:"mx-auto mb-3 text-gray-300"}),m.jsx("p",{className:"font-medium",children:"Nog geen routes"}),m.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(G=>m.jsxs(At.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[m.jsx(r2e,{route:G,size:70}),m.jsxs("div",{className:"flex-1 min-w-0",children:[f===G.id?m.jsx("input",{type:"text",value:y,onChange:R=>v(R.target.value),onKeyDown:R=>{R.key==="Enter"&&E(G.id),R.key==="Escape"&&g(null)},onBlur:()=>E(G.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):m.jsx("h3",{className:"font-medium text-gray-800 truncate",children:G.name}),m.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(M9,{size:12}),i2e(G.createdAt)]})}),m.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(sv,{size:12}),zO(G.totalDistance)]}),m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(Ab,{size:12}),$O(G.totalDuration)]}),m.jsxs("span",{children:[G.points.length," punten"]})]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("button",{onClick:()=>I(G.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${o.has(G.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:o.has(G.id)?"Verbergen op kaart":"Tonen op kaart",children:o.has(G.id)?m.jsx(rv,{size:16}):m.jsx(nv,{size:16})}),m.jsx("button",{onClick:()=>x(G),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:m.jsx(L0,{size:16})}),m.jsx("button",{onClick:()=>IG(G),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:m.jsx(tv,{size:16})}),m.jsx("button",{onClick:()=>T(G),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:m.jsx(Cu,{size:16})})]})]},G.id))}),r.length>0&&m.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:m.jsx("button",{onClick:b,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})})]})]})})}const WO={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},a2e={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function o2e(){const n=Di(i=>i.map),e=Yo(i=>i.vondsten),t=Lr(i=>i.showLocalVondsten),r=ee.useRef(null);return ee.useEffect(()=>{if(!n)return;const i=new fd;return e.forEach(s=>{const a=new mi({geometry:new _i(ka([s.location.lng,s.location.lat])),vondst:s}),o=WO[s.objectType]||WO.Anders,l=a2e[s.objectType]||"?";a.setStyle((u,h)=>{let v=12;h>50?v=6:h>10?v=Math.max(6,12-(h-10)/10):h<2&&(v=14);const x=Math.max(8,Math.min(12,v-2));return new En({image:new Ps({radius:v,fill:new er({color:o}),stroke:new _r({color:"#ffffff",width:v>8?2:1})}),text:v>=8?new Go({text:l,font:`bold ${x}px sans-serif`,fill:new er({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new md({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),ee.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const l2e={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function c2e(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?ka(s):s.map(r),i=r(t);switch(e){case"Point":return new _i(i);case"LineString":return new na(i);case"Polygon":return new Pa(i);case"MultiPoint":return new dd(i);case"MultiLineString":return new Bl(i);case"MultiPolygon":return new Uh(i);default:return new _i(ka(t))}}function u2e(){const n=Di(i=>i.map),e=Qi(i=>i.layers),t=Lr(i=>i.showCustomPointLayers),r=ee.useRef(new Map);return ee.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new fd;s.points.forEach(l=>{let u;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?u=c2e(l.geometry):u=new _i(ka(l.coordinates));const f=new mi({geometry:u,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),g=l2e[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;f.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new En({fill:new er({color:s.color+"40"}),stroke:new _r({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new En({stroke:new _r({color:s.color,width:3})}):new En({image:new Ps({radius:8,fill:new er({color:s.color}),stroke:new _r({color:"#ffffff",width:2})})}))}else f.setStyle((y,v)=>{let b=12;v>50?b=6:v>10?b=Math.max(6,12-(v-10)/10):v<2&&(b=14);const I=Math.max(8,Math.min(12,b-2));return new En({image:new Ps({radius:b,fill:new er({color:s.color}),stroke:new _r({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new Go({text:g,font:`bold ${I}px sans-serif`,fill:new er({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(f)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new md({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function h2e(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=yr(),{addLayer:t}=Qi(),r=Lr(),[i,s]=ee.useState(""),[a,o]=ee.useState([...jc]),[l,u]=ee.useState(""),h=14*r.fontScale/100,f=()=>{const E=l.trim();E&&!a.includes(E)&&(o([...a,E]),u(""))},g=E=>{o(a.filter(T=>T!==E))},y=E=>{a.includes(E)?o(a.filter(T=>T!==E)):o([...a,E])},v=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...jc]),u(""),e())},x=()=>{s(""),o([...jc]),u(""),e()};return m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),m.jsxs(At.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(so,{size:18}),m.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:E=>r.setFontScale(parseInt(E.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(vi,{size:18})})]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),m.jsx("input",{type:"text",value:i,onChange:E=>s(E.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:jc.map(E=>m.jsx("button",{onClick:()=>y(E),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(E)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:E},E))})]}),a.filter(E=>!jc.includes(E)).length>0&&m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(E=>!jc.includes(E)).map(E=>m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{onClick:()=>y(E),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:E}),m.jsx("button",{onClick:()=>g(E),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:m.jsx(Cu,{size:12})})]},E))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{type:"text",value:l,onChange:E=>u(E.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:E=>E.key==="Enter"&&f()}),m.jsx("button",{onClick:f,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:m.jsx(co,{size:20})})]})]})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[m.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:v,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const RG=200,d2e=.7;async function f2e(n,e=RG){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(u=>{u?t(u):r(new Error("Failed to create blob from canvas"))},"image/jpeg",d2e)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function g2e(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function m2e(n){const e=await f2e(n,RG),t=await g2e(e);return{thumbnailBlob:e,thumbnailBase64:t}}function p2e(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const nT=5;function y2e({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=ee.useRef(null),s=ee.useRef(null),a=async l=>{const u=l.target.files;if(!u||u.length===0)return;const h=nT-n.length,f=Array.from(u).slice(0,h);for(const g of f)try{const{thumbnailBase64:y}=await m2e(g),v={id:p2e(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(v)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<nT;return m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",nT,")"]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>m.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[m.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&m.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:m.jsx(vi,{size:12,className:"text-white"})}),l.pendingUpload&&m.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&m.jsxs(m.Fragment,{children:[m.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[m.jsx(bR,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),m.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[m.jsx(Uae,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),m.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),m.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function _2e(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=yr(),{addPoint:i,getLayer:s}=Qi(),a=Lr(),[o,l]=ee.useState(""),[u,h]=ee.useState(""),[f,g]=ee.useState(""),[y,v]=ee.useState([]),x=e?s(e):null,E=14*a.fontScale/100,T=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:u.trim(),url:f.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),g(""),v([]),r())},b=()=>{l(""),h(""),g(""),v([]),r()};return x?m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),m.jsxs(At.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(el,{size:18}),m.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:I=>a.setFontScale(parseInt(I.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(vi,{size:18})})]})]}),m.jsx("div",{className:"px-4 py-1.5",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),m.jsx("span",{className:"text-sm text-gray-600",children:x.name})]})}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${E}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),m.jsx("input",{type:"text",value:o,onChange:I=>l(I.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsx(y2e,{photos:y,onAddPhoto:I=>v([...y,I]),onRemovePhoto:I=>v(y.filter(M=>M.id!==I))}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),m.jsx("textarea",{value:u,onChange:I=>h(I.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),m.jsx("input",{type:"url",value:f,onChange:I=>g(I.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),m.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${E}px`},children:[m.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:T,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function x2e(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=yr(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:u}=Qi(),h=Lr(),f=14*h.fontScale/100,[g,y]=ee.useState(null),[v,x]=ee.useState(null),[E,T]=ee.useState(null),[b,I]=ee.useState(!1),M=i.filter(j=>!j.archived),F=i.filter(j=>j.archived),G=b?F:M,R=j=>{v===j?(s(j),x(null)):(x(j),setTimeout(()=>x(null),3e3))},C=j=>{l(j)},P=async j=>{const be=j.target.files?.[0];if(be){try{const Pe=await be.text(),je=u(Pe);je.success||(T(je.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}j.target.value=""}},N=()=>{y(null),x(null),T(null),I(!1),e()},O=j=>{r(j)},z=()=>{N(),t()};return m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:N}),m.jsxs(At.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(so,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(vi,{size:18})})]})]}),m.jsxs("div",{className:"flex border-b border-gray-100",children:[m.jsxs("button",{onClick:()=>I(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",M.length,")"]}),m.jsxs("button",{onClick:()=>I(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[m.jsx(k9,{size:14}),"Archief (",F.length,")"]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${f}px`},children:[G.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:b?m.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),m.jsxs("button",{onClick:z,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[m.jsx(co,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):m.jsx("div",{className:"divide-y divide-gray-100",children:G.map(j=>m.jsx(w2e,{layer:j,isExpanded:g===j.id,onToggleExpand:()=>y(g===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>O(j.id),onExport:()=>C(j.id),onDelete:()=>R(j.id),confirmDelete:v===j.id,onRename:be=>Qi.getState().updateLayer(j.id,{name:be}),onChangeColor:be=>Qi.getState().updateLayer(j.id,{color:be})},j.id))}),E&&m.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:E})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${f}px`},children:[m.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[m.jsx(Uw,{size:16}),m.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),m.jsx("input",{type:"file",accept:".geojson,.json",onChange:P,className:"hidden"})]}),m.jsxs("button",{onClick:z,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[m.jsx(co,{size:16}),m.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const v2e=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function w2e({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:u,onChangeColor:h}){const[f,g]=ee.useState(!1),[y,v]=ee.useState(n.name),[x,E]=ee.useState(!1),T=ee.useRef(null);ee.useEffect(()=>{f&&T.current&&(T.current.focus(),T.current.select())},[f]);const b=()=>{v(n.name),g(!0)},I=()=>{const C=y.trim();C&&C!==n.name&&u(C),g(!1)},M=()=>{v(n.name),g(!1)},F=C=>{C.key==="Enter"?I():C.key==="Escape"&&M()},G=n.points.filter(C=>C.status==="completed").length,R=n.points.length;return m.jsxs("div",{className:"bg-white",children:[m.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[m.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?m.jsx(IR,{size:16}):m.jsx(Bw,{size:16})}),m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>E(!x),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),x&&m.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:v2e.map(C=>m.jsx("button",{onClick:()=>{h(C),E(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${C===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:C}},C))})]}),f?m.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[m.jsx("input",{ref:T,type:"text",value:y,onChange:C=>v(C.target.value),onKeyDown:F,onBlur:I,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),m.jsx("button",{onClick:I,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:m.jsx(Kl,{size:16})})]}):m.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),m.jsx("div",{className:"text-xs text-gray-500",children:R>0?m.jsxs("span",{className:G===R?"text-green-600":"",children:[G,"/",R," voltooid"]}):"Geen punten"})]}),!f&&m.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:m.jsx(L0,{size:16})}),m.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:m.jsx(j9,{size:18})}),!n.archived&&m.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?m.jsx(rv,{size:18}):m.jsx(nv,{size:18})}),m.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?m.jsx(qse,{size:18}):m.jsx(k9,{size:18})}),m.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:m.jsx(tv,{size:18})}),m.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(Cu,{size:18})})]}),m.jsx(ir,{children:e&&m.jsx(At.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:m.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(C=>m.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:C},C))}),n.points.length>0&&m.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(C=>m.jsx("div",{className:"flex items-center gap-2",children:m.jsx("span",{className:`font-medium ${C.status==="completed"?"text-green-600 line-through":C.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:C.name})},C.id)),n.points.length>5&&m.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),m.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function E2e(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=yr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=Qi(),o=Lr(),[l,u]=ee.useState("all"),[h,f]=ee.useState(null),[g,y]=ee.useState(""),[v,x]=ee.useState(null),E=e?r(e):null,T=14*o.fontScale/100;if(!E)return null;const b=E.points.filter(O=>l==="all"?!0:O.status===l),I=E.points.length,M=E.points.filter(O=>O.status==="completed").length,F=E.points.filter(O=>O.status==="todo").length,G=E.points.filter(O=>O.status==="skipped").length,R=(O,z)=>{i(E.id,O,z)},C=O=>{s(E.id,O,{notes:g}),f(null),y("")},P=O=>{v===O?(a(E.id,O),x(null)):(x(O),setTimeout(()=>x(null),3e3))},N=()=>{f(null),x(null),t()};return m.jsx(ir,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(At.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:N}),m.jsxs(At.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:E.color}}),m.jsx("span",{className:"font-medium truncate",children:E.name})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:O=>o.setFontScale(parseInt(O.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(vi,{size:18})})]})]}),m.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[m.jsxs("span",{className:"text-orange-800 font-medium",children:[M,"/",I," voltooid"]}),m.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[m.jsxs("span",{className:"text-orange-600",children:[F," te doen"]}),G>0&&m.jsxs("span",{className:"text-gray-500",children:[G," overgeslagen"]})]})]}),m.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(O=>m.jsxs("button",{onClick:()=>u(O),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===O?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[O==="all"&&"Alles",O==="todo"&&"Te doen",O==="completed"&&"Voltooid",O==="skipped"&&"Overgeslagen"]},O))}),m.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:b.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:m.jsx("p",{children:"Geen punten gevonden"})}):m.jsx("div",{className:"divide-y divide-gray-100",children:b.map(O=>m.jsx("div",{className:"p-3",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[m.jsx("button",{onClick:()=>R(O.id,O.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:O.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:m.jsx(Kl,{size:14,className:O.status==="completed"?"text-green-600":"text-gray-400"})}),m.jsx("button",{onClick:()=>R(O.id,O.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:O.status==="skipped"?"Markeer als te doen":"Overslaan",children:m.jsx(Jse,{size:14,className:O.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),O.photos&&O.photos.length>0&&m.jsxs("div",{className:"relative flex-shrink-0",children:[m.jsx("img",{src:O.photos[0].thumbnailUrl||O.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),O.photos.length>1&&m.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",O.photos.length-1]})]}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:`font-medium truncate ${O.status==="completed"?"text-green-700 line-through":O.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:O.name}),O.sourceLayer&&m.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",O.sourceLayer]})]}),h===O.id?m.jsxs("div",{className:"mt-2",children:[m.jsx("textarea",{value:g,onChange:z=>y(z.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),m.jsxs("div",{className:"flex gap-2 mt-1",children:[m.jsx("button",{onClick:()=>C(O.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),m.jsx("button",{onClick:()=>{f(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):O.notes?m.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.notes}):null,O.url&&m.jsxs("a",{href:O.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[m.jsx(T1,{size:12}),"Link"]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("button",{onClick:()=>{f(O.id),y(O.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:m.jsx(hoe,{size:14})}),m.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${O.coordinates[1]},${O.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:m.jsx(el,{size:14})}),m.jsx("button",{onClick:()=>P(O.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${v===O.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:v===O.id?"Klik nogmaals":"Verwijderen",children:m.jsx(Cu,{size:14})})]})]})},O.id))})})]})]})})}class HO{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function S2e(){const n=os(u=>u.tracking),e=os(u=>u.headingSource);os(u=>u.speed);const t=os(u=>u.setSmoothedHeading),r=ee.useRef(new HO(6)),i=ee.useRef(new HO(10)),s=ee.useRef(0),a=ee.useRef(null),o=33,l=ee.useCallback((u,h)=>{const f=performance.now();if(f-s.current<o)return;const g=h==="gps"?r.current:i.current;g.add(u);const y=g.getSmoothed();y!==null&&(s.current=f,t(y))},[t]);ee.useEffect(()=>{if(!n)return;const u=f=>{f.coords.heading!==null&&f.coords.speed!==null&&f.coords.speed>.8&&f.coords.accuracy<20&&l(f.coords.heading,"gps")},h=navigator.geolocation.watchPosition(u,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),ee.useEffect(()=>{if(!n||e!=="compass")return;let u=0;const h=50,f=y=>{const v=performance.now();if(!(v-u<h)&&(u=v,y.alpha!==null)){const x=(360-y.alpha)%360;l(x,"compass")}},g=y=>{const v=performance.now();v-u<h||(u=v,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",f),window.addEventListener("deviceorientation",g),()=>{window.removeEventListener("deviceorientationabsolute",f),window.removeEventListener("deviceorientation",g)}},[n,e,l]),ee.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),ee.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function T2e(){const n=Di(i=>i.map),e=fi(i=>i.setLayerOpacity),t=fi(i=>i.visible),r=ee.useRef(null);ee.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const KO=2e3;function b2e(){const n=Lw(g=>g.user),{layers:e,clearAll:t}=Qi(),{vondsten:r,clearAll:i}=Yo(),s=ee.useRef(null),a=ee.useRef(!0),o=ee.useRef(""),l=ee.useRef(""),u=ee.useCallback(async g=>{if(n)try{const y=Jf(qc,"users",n.uid);await ZN(y,{layers:g,layersUpdatedAt:QN()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=ee.useCallback(async g=>{if(n)try{const y=Jf(qc,"users",n.uid);await ZN(y,{vondsten:g,vondstenUpdatedAt:QN()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),f=ee.useCallback(async()=>{if(n)try{const g=Jf(qc,"users",n.uid),y=await Ree(g);if(y.exists()){const v=y.data();if(v.layers&&Array.isArray(v.layers)){const x=v.layers,E=Qi.getState().layers,T=[...x],b=new Set(x.map(I=>I.id));E.forEach(I=>{b.has(I.id)||T.push(I)}),Qi.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${x.length} lagen geladen uit cloud`)}if(v.vondsten&&Array.isArray(v.vondsten)){const x=v.vondsten,E=Yo.getState().vondsten,T=[...x],b=new Set(x.map(I=>I.id));E.forEach(I=>{b.has(I.id)||T.push(I)}),Yo.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${x.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await u(e),await h(r);a.current=!1}catch(g){console.error(" Fout bij laden uit cloud:",g),a.current=!1}},[n,e,r,u,h]);return ee.useEffect(()=>{n?(a.current=!0,f()):(a.current=!0,o.current="",l.current="")},[n?.uid]),ee.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(e);if(g!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=g,u(e)},KO),()=>{s.current&&clearTimeout(s.current)}},[n,e,u]),ee.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(r);if(g!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=g,h(r)},KO),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:u,syncVondstenToCloud:h}}function I2e(){S2e(),T2e(),b2e();const e=14*Lr(o=>o.fontScale)/100,t=yr(o=>o.vondstFormOpen),r=yr(o=>o.vondstFormLocation),i=yr(o=>o.closeVondstForm),s=yr(o=>o.routeDashboardOpen),a=yr(o=>o.toggleRouteDashboard);return m.jsx(EEe,{children:m.jsxs("div",{style:{fontSize:`${e}px`},children:[m.jsx(yte,{}),m.jsx(nle,{}),m.jsx(o2e,{}),m.jsx(REe,{}),m.jsx(u2e,{}),m.jsx(t2e,{}),m.jsx(n2e,{}),m.jsx(sEe,{}),m.jsx(oEe,{}),m.jsx(xEe,{}),m.jsx(ele,{}),m.jsx(QEe,{}),m.jsx(JEe,{}),m.jsx(vEe,{}),m.jsx(ile,{}),m.jsx(ole,{}),m.jsx(_Ee,{}),m.jsx(WEe,{}),m.jsx(gEe,{}),m.jsx(KEe,{}),m.jsx(mEe,{}),m.jsx(BEe,{}),m.jsx(h2e,{}),m.jsx(_2e,{}),m.jsx(x2e,{}),m.jsx(E2e,{}),m.jsx(s2e,{isOpen:s,onClose:a}),m.jsx(ir,{children:t&&m.jsx(AG,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${Nv}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");$B.createRoot(document.getElementById("root")).render(m.jsx(I2e,{}));export{Ps as C,er as F,zR as G,AW as I,na as L,_i as P,En as S,sh as T,fd as V,lH as a,eH as b,md as c,_r as d,Go as e,mi as f,ka as g,Zp as h,wn as p,z7 as r};
//# sourceMappingURL=index-Cwzo5UxU.js.map
