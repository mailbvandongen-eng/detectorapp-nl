const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-DeBz156x.js","assets/iconStyles-bffvME3Z.js","assets/amkOL-BGO7ii-8.js","assets/layerLoaderOL-4-eDR9jb.js","assets/romeinsOL-Rma_ltcc.js","assets/kastelenOL-BWhJ0oca.js","assets/ruinesOL-MkJA2UXF.js","assets/hunebeddenOL-CQgUVDKG.js","assets/uikavArcheoPuntenOL-ESKrnua6.js","assets/uikavVlakkenOL-DQ0L17tv.js","assets/uikavBufferlaagOL-DnrRTw2y.js","assets/uikavExpertOL-BNci7A6K.js","assets/uikavUiterwaardenOL-D0LPUOA4.js","assets/speeltuinenOL-C97MTqeE.js","assets/museaOL-B-0of52j.js","assets/strandjesOL-9MISvd3o.js","assets/parkenOL-BdJTUUOt.js","assets/kringloopwinkelsOL-BXBm-CH4.js","assets/fossielenOL-Cu6y50Xa.js","assets/fossielUtils-CS886Dv5.js","assets/fossielenBelgieOL-BjdacabX.js","assets/fossielenDuitslandOL-B5-3NJk1.js","assets/fossielenFrankrijkOL-B6HsuTuW.js","assets/bunkersOL-Jrnx-C7e.js","assets/grafheuvelsOL-DWDZ5hHO.js","assets/slagveldenOL-CqV7m5ja.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function $A(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var iS={exports:{}},rm={},sS={exports:{}},gn={};var O4;function dU(){if(O4)return gn;O4=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function m(re){return re===null||typeof re!="object"?null:(re=g&&re[g]||re["@@iterator"],typeof re=="function"?re:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function w(re,V,se){this.props=re,this.context=V,this.refs=x,this.updater=se||y}w.prototype.isReactComponent={},w.prototype.setState=function(re,V){if(typeof re!="object"&&typeof re!="function"&&re!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,re,V,"setState")},w.prototype.forceUpdate=function(re){this.updater.enqueueForceUpdate(this,re,"forceUpdate")};function T(){}T.prototype=w.prototype;function b(re,V,se){this.props=re,this.context=V,this.refs=x,this.updater=se||y}var A=b.prototype=new T;A.constructor=b,v(A,w.prototype),A.isPureReactComponent=!0;var M=Array.isArray,O=Object.prototype.hasOwnProperty,z={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function R(re,V,se){var ne,q={},le=null,Ie=null;if(V!=null)for(ne in V.ref!==void 0&&(Ie=V.ref),V.key!==void 0&&(le=""+V.key),V)O.call(V,ne)&&!I.hasOwnProperty(ne)&&(q[ne]=V[ne]);var Fe=arguments.length-2;if(Fe===1)q.children=se;else if(1<Fe){for(var he=Array(Fe),Pe=0;Pe<Fe;Pe++)he[Pe]=arguments[Pe+2];q.children=he}if(re&&re.defaultProps)for(ne in Fe=re.defaultProps,Fe)q[ne]===void 0&&(q[ne]=Fe[ne]);return{$$typeof:n,type:re,key:le,ref:Ie,props:q,_owner:z.current}}function P(re,V){return{$$typeof:n,type:re.type,key:V,ref:re.ref,props:re.props,_owner:re._owner}}function F(re){return typeof re=="object"&&re!==null&&re.$$typeof===n}function N(re){var V={"=":"=0",":":"=2"};return"$"+re.replace(/[=:]/g,function(se){return V[se]})}var B=/\/+/g;function j(re,V){return typeof re=="object"&&re!==null&&re.key!=null?N(""+re.key):V.toString(36)}function ve(re,V,se,ne,q){var le=typeof re;(le==="undefined"||le==="boolean")&&(re=null);var Ie=!1;if(re===null)Ie=!0;else switch(le){case"string":case"number":Ie=!0;break;case"object":switch(re.$$typeof){case n:case e:Ie=!0}}if(Ie)return Ie=re,q=q(Ie),re=ne===""?"."+j(Ie,0):ne,M(q)?(se="",re!=null&&(se=re.replace(B,"$&/")+"/"),ve(q,V,se,"",function(Pe){return Pe})):q!=null&&(F(q)&&(q=P(q,se+(!q.key||Ie&&Ie.key===q.key?"":(""+q.key).replace(B,"$&/")+"/")+re)),V.push(q)),1;if(Ie=0,ne=ne===""?".":ne+":",M(re))for(var Fe=0;Fe<re.length;Fe++){le=re[Fe];var he=ne+j(le,Fe);Ie+=ve(le,V,se,he,q)}else if(he=m(re),typeof he=="function")for(re=he.call(re),Fe=0;!(le=re.next()).done;)le=le.value,he=ne+j(le,Fe++),Ie+=ve(le,V,se,he,q);else if(le==="object")throw V=String(re),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(re).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Ie}function ke(re,V,se){if(re==null)return re;var ne=[],q=0;return ve(re,ne,"","",function(le){return V.call(se,le,q++)}),ne}function Ve(re){if(re._status===-1){var V=re._result;V=V(),V.then(function(se){(re._status===0||re._status===-1)&&(re._status=1,re._result=se)},function(se){(re._status===0||re._status===-1)&&(re._status=2,re._result=se)}),re._status===-1&&(re._status=0,re._result=V)}if(re._status===1)return re._result.default;throw re._result}var Me={current:null},ue={transition:null},Ae={ReactCurrentDispatcher:Me,ReactCurrentBatchConfig:ue,ReactCurrentOwner:z};function be(){throw Error("act(...) is not supported in production builds of React.")}return gn.Children={map:ke,forEach:function(re,V,se){ke(re,function(){V.apply(this,arguments)},se)},count:function(re){var V=0;return ke(re,function(){V++}),V},toArray:function(re){return ke(re,function(V){return V})||[]},only:function(re){if(!F(re))throw Error("React.Children.only expected to receive a single React element child.");return re}},gn.Component=w,gn.Fragment=t,gn.Profiler=i,gn.PureComponent=b,gn.StrictMode=r,gn.Suspense=l,gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ae,gn.act=be,gn.cloneElement=function(re,V,se){if(re==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+re+".");var ne=v({},re.props),q=re.key,le=re.ref,Ie=re._owner;if(V!=null){if(V.ref!==void 0&&(le=V.ref,Ie=z.current),V.key!==void 0&&(q=""+V.key),re.type&&re.type.defaultProps)var Fe=re.type.defaultProps;for(he in V)O.call(V,he)&&!I.hasOwnProperty(he)&&(ne[he]=V[he]===void 0&&Fe!==void 0?Fe[he]:V[he])}var he=arguments.length-2;if(he===1)ne.children=se;else if(1<he){Fe=Array(he);for(var Pe=0;Pe<he;Pe++)Fe[Pe]=arguments[Pe+2];ne.children=Fe}return{$$typeof:n,type:re.type,key:q,ref:le,props:ne,_owner:Ie}},gn.createContext=function(re){return re={$$typeof:a,_currentValue:re,_currentValue2:re,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},re.Provider={$$typeof:s,_context:re},re.Consumer=re},gn.createElement=R,gn.createFactory=function(re){var V=R.bind(null,re);return V.type=re,V},gn.createRef=function(){return{current:null}},gn.forwardRef=function(re){return{$$typeof:o,render:re}},gn.isValidElement=F,gn.lazy=function(re){return{$$typeof:h,_payload:{_status:-1,_result:re},_init:Ve}},gn.memo=function(re,V){return{$$typeof:c,type:re,compare:V===void 0?null:V}},gn.startTransition=function(re){var V=ue.transition;ue.transition={};try{re()}finally{ue.transition=V}},gn.unstable_act=be,gn.useCallback=function(re,V){return Me.current.useCallback(re,V)},gn.useContext=function(re){return Me.current.useContext(re)},gn.useDebugValue=function(){},gn.useDeferredValue=function(re){return Me.current.useDeferredValue(re)},gn.useEffect=function(re,V){return Me.current.useEffect(re,V)},gn.useId=function(){return Me.current.useId()},gn.useImperativeHandle=function(re,V,se){return Me.current.useImperativeHandle(re,V,se)},gn.useInsertionEffect=function(re,V){return Me.current.useInsertionEffect(re,V)},gn.useLayoutEffect=function(re,V){return Me.current.useLayoutEffect(re,V)},gn.useMemo=function(re,V){return Me.current.useMemo(re,V)},gn.useReducer=function(re,V,se){return Me.current.useReducer(re,V,se)},gn.useRef=function(re){return Me.current.useRef(re)},gn.useState=function(re){return Me.current.useState(re)},gn.useSyncExternalStore=function(re,V,se){return Me.current.useSyncExternalStore(re,V,se)},gn.useTransition=function(){return Me.current.useTransition()},gn.version="18.3.1",gn}var D4;function c1(){return D4||(D4=1,sS.exports=dU()),sS.exports}var F4;function fU(){if(F4)return rm;F4=1;var n=c1(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var h,g={},m=null,y=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(g[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)g[h]===void 0&&(g[h]=l[h]);return{$$typeof:e,type:o,key:m,ref:y,props:g,_owner:i.current}}return rm.Fragment=t,rm.jsx=a,rm.jsxs=a,rm}var j4;function gU(){return j4||(j4=1,iS.exports=fU()),iS.exports}var f=gU(),ox={},aS={exports:{}},Ps={},oS={exports:{}},lS={};var V4;function mU(){return V4||(V4=1,(function(n){function e(ue,Ae){var be=ue.length;ue.push(Ae);e:for(;0<be;){var re=be-1>>>1,V=ue[re];if(0<i(V,Ae))ue[re]=Ae,ue[be]=V,be=re;else break e}}function t(ue){return ue.length===0?null:ue[0]}function r(ue){if(ue.length===0)return null;var Ae=ue[0],be=ue.pop();if(be!==Ae){ue[0]=be;e:for(var re=0,V=ue.length,se=V>>>1;re<se;){var ne=2*(re+1)-1,q=ue[ne],le=ne+1,Ie=ue[le];if(0>i(q,be))le<V&&0>i(Ie,q)?(ue[re]=Ie,ue[le]=be,re=le):(ue[re]=q,ue[ne]=be,re=ne);else if(le<V&&0>i(Ie,be))ue[re]=Ie,ue[le]=be,re=le;else break e}}return Ae}function i(ue,Ae){var be=ue.sortIndex-Ae.sortIndex;return be!==0?be:ue.id-Ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,g=null,m=3,y=!1,v=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(ue){for(var Ae=t(c);Ae!==null;){if(Ae.callback===null)r(c);else if(Ae.startTime<=ue)r(c),Ae.sortIndex=Ae.expirationTime,e(l,Ae);else break;Ae=t(c)}}function M(ue){if(x=!1,A(ue),!v)if(t(l)!==null)v=!0,Ve(O);else{var Ae=t(c);Ae!==null&&Me(M,Ae.startTime-ue)}}function O(ue,Ae){v=!1,x&&(x=!1,T(R),R=-1),y=!0;var be=m;try{for(A(Ae),g=t(l);g!==null&&(!(g.expirationTime>Ae)||ue&&!N());){var re=g.callback;if(typeof re=="function"){g.callback=null,m=g.priorityLevel;var V=re(g.expirationTime<=Ae);Ae=n.unstable_now(),typeof V=="function"?g.callback=V:g===t(l)&&r(l),A(Ae)}else r(l);g=t(l)}if(g!==null)var se=!0;else{var ne=t(c);ne!==null&&Me(M,ne.startTime-Ae),se=!1}return se}finally{g=null,m=be,y=!1}}var z=!1,I=null,R=-1,P=5,F=-1;function N(){return!(n.unstable_now()-F<P)}function B(){if(I!==null){var ue=n.unstable_now();F=ue;var Ae=!0;try{Ae=I(!0,ue)}finally{Ae?j():(z=!1,I=null)}}else z=!1}var j;if(typeof b=="function")j=function(){b(B)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,ke=ve.port2;ve.port1.onmessage=B,j=function(){ke.postMessage(null)}}else j=function(){w(B,0)};function Ve(ue){I=ue,z||(z=!0,j())}function Me(ue,Ae){R=w(function(){ue(n.unstable_now())},Ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){v||y||(v=!0,Ve(O))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ue){switch(m){case 1:case 2:case 3:var Ae=3;break;default:Ae=m}var be=m;m=Ae;try{return ue()}finally{m=be}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,Ae){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var be=m;m=ue;try{return Ae()}finally{m=be}},n.unstable_scheduleCallback=function(ue,Ae,be){var re=n.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?re+be:re):be=re,ue){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=be+V,ue={id:h++,callback:Ae,priorityLevel:ue,startTime:be,expirationTime:V,sortIndex:-1},be>re?(ue.sortIndex=be,e(c,ue),t(l)===null&&ue===t(c)&&(x?(T(R),R=-1):x=!0,Me(M,be-re))):(ue.sortIndex=V,e(l,ue),v||y||(v=!0,Ve(O))),ue},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(ue){var Ae=m;return function(){var be=m;m=Ae;try{return ue.apply(this,arguments)}finally{m=be}}}})(lS)),lS}var B4;function pU(){return B4||(B4=1,oS.exports=mU()),oS.exports}var G4;function yU(){if(G4)return Ps;G4=1;var n=c1(),e=pU();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(u,d){a(u,d),a(u+"Capture",d)}function a(u,d){for(i[u]=d,u=0;u<d.length;u++)r.add(d[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function m(u){return l.call(g,u)?!0:l.call(h,u)?!1:c.test(u)?g[u]=!0:(h[u]=!0,!1)}function y(u,d,p,E){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return E?!1:p!==null?!p.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function v(u,d,p,E){if(d===null||typeof d>"u"||y(u,d,p,E))return!0;if(E)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(u,d,p,E,S,C,G){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=E,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=u,this.type=d,this.sanitizeURL=C,this.removeEmptyString=G}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){w[u]=new x(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];w[d]=new x(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){w[u]=new x(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){w[u]=new x(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){w[u]=new x(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){w[u]=new x(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){w[u]=new x(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){w[u]=new x(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){w[u]=new x(u,5,!1,u.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function b(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(T,b);w[d]=new x(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(T,b);w[d]=new x(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(T,b);w[d]=new x(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){w[u]=new x(u,1,!1,u.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){w[u]=new x(u,1,!1,u.toLowerCase(),null,!0,!0)});function A(u,d,p,E){var S=w.hasOwnProperty(d)?w[d]:null;(S!==null?S.type!==0:E||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(v(d,p,S,E)&&(p=null),E||S===null?m(d)&&(p===null?u.removeAttribute(d):u.setAttribute(d,""+p)):S.mustUseProperty?u[S.propertyName]=p===null?S.type===3?!1:"":p:(d=S.attributeName,E=S.attributeNamespace,p===null?u.removeAttribute(d):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,E?u.setAttributeNS(E,d,p):u.setAttribute(d,p))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),z=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),N=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),ke=Symbol.for("react.memo"),Ve=Symbol.for("react.lazy"),Me=Symbol.for("react.offscreen"),ue=Symbol.iterator;function Ae(u){return u===null||typeof u!="object"?null:(u=ue&&u[ue]||u["@@iterator"],typeof u=="function"?u:null)}var be=Object.assign,re;function V(u){if(re===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);re=d&&d[1]||""}return`
`+re+u}var se=!1;function ne(u,d){if(!u||se)return"";se=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Re){var E=Re}Reflect.construct(u,[],d)}else{try{d.call()}catch(Re){E=Re}u.call(d.prototype)}else{try{throw Error()}catch(Re){E=Re}u()}}catch(Re){if(Re&&E&&typeof Re.stack=="string"){for(var S=Re.stack.split(`
`),C=E.stack.split(`
`),G=S.length-1,ie=C.length-1;1<=G&&0<=ie&&S[G]!==C[ie];)ie--;for(;1<=G&&0<=ie;G--,ie--)if(S[G]!==C[ie]){if(G!==1||ie!==1)do if(G--,ie--,0>ie||S[G]!==C[ie]){var ae=`
`+S[G].replace(" at new "," at ");return u.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",u.displayName)),ae}while(1<=G&&0<=ie);break}}}finally{se=!1,Error.prepareStackTrace=p}return(u=u?u.displayName||u.name:"")?V(u):""}function q(u){switch(u.tag){case 5:return V(u.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return u=ne(u.type,!1),u;case 11:return u=ne(u.type.render,!1),u;case 1:return u=ne(u.type,!0),u;default:return""}}function le(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case I:return"Fragment";case z:return"Portal";case P:return"Profiler";case R:return"StrictMode";case j:return"Suspense";case ve:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case N:return(u.displayName||"Context")+".Consumer";case F:return(u._context.displayName||"Context")+".Provider";case B:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ke:return d=u.displayName||null,d!==null?d:le(u.type)||"Memo";case Ve:d=u._payload,u=u._init;try{return le(u(d))}catch{}}return null}function Ie(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(d);case 8:return d===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Fe(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function he(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Pe(u){var d=he(u)?"checked":"value",p=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),E=""+u[d];if(!u.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,C=p.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return S.call(this)},set:function(G){E=""+G,C.call(this,G)}}),Object.defineProperty(u,d,{enumerable:p.enumerable}),{getValue:function(){return E},setValue:function(G){E=""+G},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function Be(u){u._valueTracker||(u._valueTracker=Pe(u))}function Rt(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var p=d.getValue(),E="";return u&&(E=he(u)?u.checked?"true":"false":u.value),u=E,u!==p?(d.setValue(u),!0):!1}function Dt(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Nt(u,d){var p=d.checked;return be({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??u._wrapperState.initialChecked})}function ln(u,d){var p=d.defaultValue==null?"":d.defaultValue,E=d.checked!=null?d.checked:d.defaultChecked;p=Fe(d.value!=null?d.value:p),u._wrapperState={initialChecked:E,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function rn(u,d){d=d.checked,d!=null&&A(u,"checked",d,!1)}function ut(u,d){rn(u,d);var p=Fe(d.value),E=d.type;if(p!=null)E==="number"?(p===0&&u.value===""||u.value!=p)&&(u.value=""+p):u.value!==""+p&&(u.value=""+p);else if(E==="submit"||E==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?dn(u,d.type,p):d.hasOwnProperty("defaultValue")&&dn(u,d.type,Fe(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function tr(u,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var E=d.type;if(!(E!=="submit"&&E!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,p||d===u.value||(u.value=d),u.defaultValue=d}p=u.name,p!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,p!==""&&(u.name=p)}function dn(u,d,p){(d!=="number"||Dt(u.ownerDocument)!==u)&&(p==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+p&&(u.defaultValue=""+p))}var cn=Array.isArray;function nr(u,d,p,E){if(u=u.options,d){d={};for(var S=0;S<p.length;S++)d["$"+p[S]]=!0;for(p=0;p<u.length;p++)S=d.hasOwnProperty("$"+u[p].value),u[p].selected!==S&&(u[p].selected=S),S&&E&&(u[p].defaultSelected=!0)}else{for(p=""+Fe(p),d=null,S=0;S<u.length;S++){if(u[S].value===p){u[S].selected=!0,E&&(u[S].defaultSelected=!0);return}d!==null||u[S].disabled||(d=u[S])}d!==null&&(d.selected=!0)}}function li(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return be({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Fn(u,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(cn(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}u._wrapperState={initialValue:Fe(p)}}function dt(u,d){var p=Fe(d.value),E=Fe(d.defaultValue);p!=null&&(p=""+p,p!==u.value&&(u.value=p),d.defaultValue==null&&u.defaultValue!==p&&(u.defaultValue=p)),E!=null&&(u.defaultValue=""+E)}function fn(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function ur(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vt(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?ur(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var Zt,Gt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,E,S){MSApp.execUnsafeLocalFunction(function(){return u(d,p,E,S)})}:u})(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(Zt=Zt||document.createElement("div"),Zt.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=Zt.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function Xr(u,d){if(d){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=d;return}}u.textContent=d}var xr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ki=["Webkit","ms","Moz","O"];Object.keys(xr).forEach(function(u){Ki.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),xr[d]=xr[u]})});function Qt(u,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||xr.hasOwnProperty(u)&&xr[u]?(""+d).trim():d+"px"}function xi(u,d){u=u.style;for(var p in d)if(d.hasOwnProperty(p)){var E=p.indexOf("--")===0,S=Qt(p,d[p],E);p==="float"&&(p="cssFloat"),E?u.setProperty(p,S):u[p]=S}}var je=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(u,d){if(d){if(je[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function ye(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zt=null;function L(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var kt=null,W=null,Y=null;function Q(u){if(u=zg(u)){if(typeof kt!="function")throw Error(t(280));var d=u.stateNode;d&&(d=Ey(d),kt(u.stateNode,u.type,d))}}function fe(u){W?Y?Y.push(u):Y=[u]:W=u}function ce(){if(W){var u=W,d=Y;if(Y=W=null,Q(u),d)for(u=0;u<d.length;u++)Q(d[u])}}function $e(u,d){return u(d)}function De(){}var ze=!1;function it(u,d,p){if(ze)return u(d,p);ze=!0;try{return $e(u,d,p)}finally{ze=!1,(W!==null||Y!==null)&&(De(),ce())}}function xt(u,d){var p=u.stateNode;if(p===null)return null;var E=Ey(p);if(E===null)return null;p=E[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(u=u.type,E=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!E;break e;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var At=!1;if(o)try{var Lt={};Object.defineProperty(Lt,"passive",{get:function(){At=!0}}),window.addEventListener("test",Lt,Lt),window.removeEventListener("test",Lt,Lt)}catch{At=!1}function or(u,d,p,E,S,C,G,ie,ae){var Re=Array.prototype.slice.call(arguments,3);try{d.apply(p,Re)}catch(Ke){this.onError(Ke)}}var br=!1,Xi=null,U=!1,J=null,K={onError:function(u){br=!0,Xi=u}};function Z(u,d,p,E,S,C,G,ie,ae){br=!1,Xi=null,or.apply(K,arguments)}function ee(u,d,p,E,S,C,G,ie,ae){if(Z.apply(this,arguments),br){if(br){var Re=Xi;br=!1,Xi=null}else throw Error(t(198));U||(U=!0,J=Re)}}function te(u){var d=u,p=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(p=d.return),u=d.return;while(u)}return d.tag===3?p:null}function we(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function Le(u){if(te(u)!==u)throw Error(t(188))}function _e(u){var d=u.alternate;if(!d){if(d=te(u),d===null)throw Error(t(188));return d!==u?null:u}for(var p=u,E=d;;){var S=p.return;if(S===null)break;var C=S.alternate;if(C===null){if(E=S.return,E!==null){p=E;continue}break}if(S.child===C.child){for(C=S.child;C;){if(C===p)return Le(S),u;if(C===E)return Le(S),d;C=C.sibling}throw Error(t(188))}if(p.return!==E.return)p=S,E=C;else{for(var G=!1,ie=S.child;ie;){if(ie===p){G=!0,p=S,E=C;break}if(ie===E){G=!0,E=S,p=C;break}ie=ie.sibling}if(!G){for(ie=C.child;ie;){if(ie===p){G=!0,p=C,E=S;break}if(ie===E){G=!0,E=C,p=S;break}ie=ie.sibling}if(!G)throw Error(t(189))}}if(p.alternate!==E)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?u:d}function Se(u){return u=_e(u),u!==null?Te(u):null}function Te(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=Te(u);if(d!==null)return d;u=u.sibling}return null}var Xe=e.unstable_scheduleCallback,nt=e.unstable_cancelCallback,pt=e.unstable_shouldYield,qe=e.unstable_requestPaint,Ye=e.unstable_now,Ht=e.unstable_getCurrentPriorityLevel,jn=e.unstable_ImmediatePriority,Un=e.unstable_UserBlockingPriority,_r=e.unstable_NormalPriority,Xa=e.unstable_LowPriority,xa=e.unstable_IdlePriority,qs=null,Br=null;function Ec(u){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(qs,u,void 0,(u.current.flags&128)===128)}catch{}}var Ar=Math.clz32?Math.clz32:Zu,Io=Math.log,_a=Math.LN2;function Zu(u){return u>>>=0,u===0?32:31-(Io(u)/_a|0)|0}var Co=64,Sc=4194304;function Pn(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function El(u,d){var p=u.pendingLanes;if(p===0)return 0;var E=0,S=u.suspendedLanes,C=u.pingedLanes,G=p&268435455;if(G!==0){var ie=G&~S;ie!==0?E=Pn(ie):(C&=G,C!==0&&(E=Pn(C)))}else G=p&~S,G!==0?E=Pn(G):C!==0&&(E=Pn(C));if(E===0)return 0;if(d!==0&&d!==E&&(d&S)===0&&(S=E&-E,C=d&-d,S>=C||S===16&&(C&4194240)!==0))return d;if((E&4)!==0&&(E|=p&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=E;0<d;)p=31-Ar(d),S=1<<p,E|=u[p],d&=~S;return E}function Qu(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ju(u,d){for(var p=u.suspendedLanes,E=u.pingedLanes,S=u.expirationTimes,C=u.pendingLanes;0<C;){var G=31-Ar(C),ie=1<<G,ae=S[G];ae===-1?((ie&p)===0||(ie&E)!==0)&&(S[G]=Qu(ie,d)):ae<=d&&(u.expiredLanes|=ie),C&=~ie}}function wg(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Eg(){var u=Co;return Co<<=1,(Co&4194240)===0&&(Co=64),u}function Sg(u){for(var d=[],p=0;31>p;p++)d.push(u);return d}function eh(u,d,p){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-Ar(d),u[d]=p}function DE(u,d){var p=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var E=u.eventTimes;for(u=u.expirationTimes;0<p;){var S=31-Ar(p),C=1<<S;d[S]=0,E[S]=-1,u[S]=-1,p&=~C}}function Tg(u,d){var p=u.entangledLanes|=d;for(u=u.entanglements;p;){var E=31-Ar(p),S=1<<E;S&d|u[E]&d&&(u[E]|=d),p&=~S}}var vn=0;function ko(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var bg,zd,Ag,Rg,Ig,Po=!1,Ud=[],Mo=null,No=null,Mi=null,th=new Map,Sl=new Map,Ys=[],ay="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tc(u,d){switch(u){case"focusin":case"focusout":Mo=null;break;case"dragenter":case"dragleave":No=null;break;case"mouseover":case"mouseout":Mi=null;break;case"pointerover":case"pointerout":th.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sl.delete(d.pointerId)}}function qa(u,d,p,E,S,C){return u===null||u.nativeEvent!==C?(u={blockedOn:d,domEventName:p,eventSystemFlags:E,nativeEvent:C,targetContainers:[S]},d!==null&&(d=zg(d),d!==null&&zd(d)),u):(u.eventSystemFlags|=E,d=u.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),u)}function oy(u,d,p,E,S){switch(d){case"focusin":return Mo=qa(Mo,u,d,p,E,S),!0;case"dragenter":return No=qa(No,u,d,p,E,S),!0;case"mouseover":return Mi=qa(Mi,u,d,p,E,S),!0;case"pointerover":var C=S.pointerId;return th.set(C,qa(th.get(C)||null,u,d,p,E,S)),!0;case"gotpointercapture":return C=S.pointerId,Sl.set(C,qa(Sl.get(C)||null,u,d,p,E,S)),!0}return!1}function $d(u){var d=sh(u.target);if(d!==null){var p=te(d);if(p!==null){if(d=p.tag,d===13){if(d=we(p),d!==null){u.blockedOn=d,Ig(u.priority,function(){Ag(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function rr(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var p=Wd(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(p===null){p=u.nativeEvent;var E=new p.constructor(p.type,p);zt=E,p.target.dispatchEvent(E),zt=null}else return d=zg(p),d!==null&&zd(d),u.blockedOn=p,!1;d.shift()}return!0}function ly(u,d,p){rr(u)&&p.delete(d)}function FE(){Po=!1,Mo!==null&&rr(Mo)&&(Mo=null),No!==null&&rr(No)&&(No=null),Mi!==null&&rr(Mi)&&(Mi=null),th.forEach(ly),Sl.forEach(ly)}function bc(u,d){u.blockedOn===d&&(u.blockedOn=null,Po||(Po=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,FE)))}function Ac(u){function d(S){return bc(S,u)}if(0<Ud.length){bc(Ud[0],u);for(var p=1;p<Ud.length;p++){var E=Ud[p];E.blockedOn===u&&(E.blockedOn=null)}}for(Mo!==null&&bc(Mo,u),No!==null&&bc(No,u),Mi!==null&&bc(Mi,u),th.forEach(d),Sl.forEach(d),p=0;p<Ys.length;p++)E=Ys[p],E.blockedOn===u&&(E.blockedOn=null);for(;0<Ys.length&&(p=Ys[0],p.blockedOn===null);)$d(p),p.blockedOn===null&&Ys.shift()}var Tl=M.ReactCurrentBatchConfig,bl=!0;function Lo(u,d,p,E){var S=vn,C=Tl.transition;Tl.transition=null;try{vn=1,Cg(u,d,p,E)}finally{vn=S,Tl.transition=C}}function cy(u,d,p,E){var S=vn,C=Tl.transition;Tl.transition=null;try{vn=4,Cg(u,d,p,E)}finally{vn=S,Tl.transition=C}}function Cg(u,d,p,E){if(bl){var S=Wd(u,d,p,E);if(S===null)XE(u,d,E,Oo,p),Tc(u,E);else if(oy(S,u,d,p,E))E.stopPropagation();else if(Tc(u,E),d&4&&-1<ay.indexOf(u)){for(;S!==null;){var C=zg(S);if(C!==null&&bg(C),C=Wd(u,d,p,E),C===null&&XE(u,d,E,Oo,p),C===S)break;S=C}S!==null&&E.stopPropagation()}else XE(u,d,E,null,p)}}var Oo=null;function Wd(u,d,p,E){if(Oo=null,u=L(E),u=sh(u),u!==null)if(d=te(u),d===null)u=null;else if(p=d.tag,p===13){if(u=we(d),u!==null)return u;u=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return Oo=u,null}function Hd(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ht()){case jn:return 1;case Un:return 4;case _r:case Xa:return 16;case xa:return 536870912;default:return 16}default:return 16}}var Zs=null,Kd=null,Al=null;function uy(){if(Al)return Al;var u,d=Kd,p=d.length,E,S="value"in Zs?Zs.value:Zs.textContent,C=S.length;for(u=0;u<p&&d[u]===S[u];u++);var G=p-u;for(E=1;E<=G&&d[p-E]===S[C-E];E++);return Al=S.slice(u,1<E?1-E:void 0)}function nh(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Do(){return!0}function kg(){return!1}function qi(u){function d(p,E,S,C,G){this._reactName=p,this._targetInst=S,this.type=E,this.nativeEvent=C,this.target=G,this.currentTarget=null;for(var ie in u)u.hasOwnProperty(ie)&&(p=u[ie],this[ie]=p?p(C):C[ie]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Do:kg,this.isPropagationStopped=kg,this}return be(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Do)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Do)},persist:function(){},isPersistent:Do}),d}var Fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rh=qi(Fo),Rc=be({},Fo,{view:0,detail:0}),Xd=qi(Rc),qd,Yd,Qs,ih=be({},Rc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nn,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Qs&&(Qs&&u.type==="mousemove"?(qd=u.screenX-Qs.screenX,Yd=u.screenY-Qs.screenY):Yd=qd=0,Qs=u),qd)},movementY:function(u){return"movementY"in u?u.movementY:Yd}}),Pg=qi(ih),hy=be({},ih,{dataTransfer:0}),dy=qi(hy),Zd=be({},Rc,{relatedTarget:0}),Ni=qi(Zd),fy=be({},Fo,{animationName:0,elapsedTime:0,pseudoElement:0}),gy=qi(fy),Ic=be({},Fo,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),_=qi(Ic),k=be({},Fo,{data:0}),D=qi(k),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},me={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ce={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function at(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=Ce[u])?!!d[u]:!1}function nn(){return at}var Gr=be({},Rc,{key:function(u){if(u.key){var d=H[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=nh(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?me[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nn,charCode:function(u){return u.type==="keypress"?nh(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?nh(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),$n=qi(Gr),qr=be({},ih,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Js=qi(qr),Rl=be({},Rc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nn}),jo=qi(Rl),Vo=be({},Fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qd=qi(Vo),Mg=be({},ih,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),az=qi(Mg),oz=[9,13,27,32],jE=o&&"CompositionEvent"in window,Ng=null;o&&"documentMode"in document&&(Ng=document.documentMode);var lz=o&&"TextEvent"in window&&!Ng,Rk=o&&(!jE||Ng&&8<Ng&&11>=Ng),Ik=" ",Ck=!1;function kk(u,d){switch(u){case"keyup":return oz.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pk(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Jd=!1;function cz(u,d){switch(u){case"compositionend":return Pk(d);case"keypress":return d.which!==32?null:(Ck=!0,Ik);case"textInput":return u=d.data,u===Ik&&Ck?null:u;default:return null}}function uz(u,d){if(Jd)return u==="compositionend"||!jE&&kk(u,d)?(u=uy(),Al=Kd=Zs=null,Jd=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Rk&&d.locale!=="ko"?null:d.data;default:return null}}var hz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mk(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!hz[u.type]:d==="textarea"}function Nk(u,d,p,E){fe(E),d=_y(d,"onChange"),0<d.length&&(p=new rh("onChange","change",null,p,E),u.push({event:p,listeners:d}))}var Lg=null,Og=null;function dz(u){Zk(u,0)}function my(u){var d=sf(u);if(Rt(d))return u}function fz(u,d){if(u==="change")return d}var Lk=!1;if(o){var VE;if(o){var BE="oninput"in document;if(!BE){var Ok=document.createElement("div");Ok.setAttribute("oninput","return;"),BE=typeof Ok.oninput=="function"}VE=BE}else VE=!1;Lk=VE&&(!document.documentMode||9<document.documentMode)}function Dk(){Lg&&(Lg.detachEvent("onpropertychange",Fk),Og=Lg=null)}function Fk(u){if(u.propertyName==="value"&&my(Og)){var d=[];Nk(d,Og,u,L(u)),it(dz,d)}}function gz(u,d,p){u==="focusin"?(Dk(),Lg=d,Og=p,Lg.attachEvent("onpropertychange",Fk)):u==="focusout"&&Dk()}function mz(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return my(Og)}function pz(u,d){if(u==="click")return my(d)}function yz(u,d){if(u==="input"||u==="change")return my(d)}function xz(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Ya=typeof Object.is=="function"?Object.is:xz;function Dg(u,d){if(Ya(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var p=Object.keys(u),E=Object.keys(d);if(p.length!==E.length)return!1;for(E=0;E<p.length;E++){var S=p[E];if(!l.call(d,S)||!Ya(u[S],d[S]))return!1}return!0}function jk(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Vk(u,d){var p=jk(u);u=0;for(var E;p;){if(p.nodeType===3){if(E=u+p.textContent.length,u<=d&&E>=d)return{node:p,offset:d-u};u=E}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=jk(p)}}function Bk(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?Bk(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function Gk(){for(var u=window,d=Dt();d instanceof u.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)u=d.contentWindow;else break;d=Dt(u.document)}return d}function GE(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function _z(u){var d=Gk(),p=u.focusedElem,E=u.selectionRange;if(d!==p&&p&&p.ownerDocument&&Bk(p.ownerDocument.documentElement,p)){if(E!==null&&GE(p)){if(d=E.start,u=E.end,u===void 0&&(u=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(u,p.value.length);else if(u=(d=p.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var S=p.textContent.length,C=Math.min(E.start,S);E=E.end===void 0?C:Math.min(E.end,S),!u.extend&&C>E&&(S=E,E=C,C=S),S=Vk(p,C);var G=Vk(p,E);S&&G&&(u.rangeCount!==1||u.anchorNode!==S.node||u.anchorOffset!==S.offset||u.focusNode!==G.node||u.focusOffset!==G.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),u.removeAllRanges(),C>E?(u.addRange(d),u.extend(G.node,G.offset)):(d.setEnd(G.node,G.offset),u.addRange(d)))}}for(d=[],u=p;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)u=d[p],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var vz=o&&"documentMode"in document&&11>=document.documentMode,ef=null,zE=null,Fg=null,UE=!1;function zk(u,d,p){var E=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;UE||ef==null||ef!==Dt(E)||(E=ef,"selectionStart"in E&&GE(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Fg&&Dg(Fg,E)||(Fg=E,E=_y(zE,"onSelect"),0<E.length&&(d=new rh("onSelect","select",null,d,p),u.push({event:d,listeners:E}),d.target=ef)))}function py(u,d){var p={};return p[u.toLowerCase()]=d.toLowerCase(),p["Webkit"+u]="webkit"+d,p["Moz"+u]="moz"+d,p}var tf={animationend:py("Animation","AnimationEnd"),animationiteration:py("Animation","AnimationIteration"),animationstart:py("Animation","AnimationStart"),transitionend:py("Transition","TransitionEnd")},$E={},Uk={};o&&(Uk=document.createElement("div").style,"AnimationEvent"in window||(delete tf.animationend.animation,delete tf.animationiteration.animation,delete tf.animationstart.animation),"TransitionEvent"in window||delete tf.transitionend.transition);function yy(u){if($E[u])return $E[u];if(!tf[u])return u;var d=tf[u],p;for(p in d)if(d.hasOwnProperty(p)&&p in Uk)return $E[u]=d[p];return u}var $k=yy("animationend"),Wk=yy("animationiteration"),Hk=yy("animationstart"),Kk=yy("transitionend"),Xk=new Map,qk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cc(u,d){Xk.set(u,d),s(d,[u])}for(var WE=0;WE<qk.length;WE++){var HE=qk[WE],wz=HE.toLowerCase(),Ez=HE[0].toUpperCase()+HE.slice(1);Cc(wz,"on"+Ez)}Cc($k,"onAnimationEnd"),Cc(Wk,"onAnimationIteration"),Cc(Hk,"onAnimationStart"),Cc("dblclick","onDoubleClick"),Cc("focusin","onFocus"),Cc("focusout","onBlur"),Cc(Kk,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sz=new Set("cancel close invalid load scroll toggle".split(" ").concat(jg));function Yk(u,d,p){var E=u.type||"unknown-event";u.currentTarget=p,ee(E,d,void 0,u),u.currentTarget=null}function Zk(u,d){d=(d&4)!==0;for(var p=0;p<u.length;p++){var E=u[p],S=E.event;E=E.listeners;e:{var C=void 0;if(d)for(var G=E.length-1;0<=G;G--){var ie=E[G],ae=ie.instance,Re=ie.currentTarget;if(ie=ie.listener,ae!==C&&S.isPropagationStopped())break e;Yk(S,ie,Re),C=ae}else for(G=0;G<E.length;G++){if(ie=E[G],ae=ie.instance,Re=ie.currentTarget,ie=ie.listener,ae!==C&&S.isPropagationStopped())break e;Yk(S,ie,Re),C=ae}}}if(U)throw u=J,U=!1,J=null,u}function hr(u,d){var p=d[e2];p===void 0&&(p=d[e2]=new Set);var E=u+"__bubble";p.has(E)||(Qk(d,u,2,!1),p.add(E))}function KE(u,d,p){var E=0;d&&(E|=4),Qk(p,u,E,d)}var xy="_reactListening"+Math.random().toString(36).slice(2);function Vg(u){if(!u[xy]){u[xy]=!0,r.forEach(function(p){p!=="selectionchange"&&(Sz.has(p)||KE(p,!1,u),KE(p,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[xy]||(d[xy]=!0,KE("selectionchange",!1,d))}}function Qk(u,d,p,E){switch(Hd(d)){case 1:var S=Lo;break;case 4:S=cy;break;default:S=Cg}p=S.bind(null,d,p,u),S=void 0,!At||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),E?S!==void 0?u.addEventListener(d,p,{capture:!0,passive:S}):u.addEventListener(d,p,!0):S!==void 0?u.addEventListener(d,p,{passive:S}):u.addEventListener(d,p,!1)}function XE(u,d,p,E,S){var C=E;if((d&1)===0&&(d&2)===0&&E!==null)e:for(;;){if(E===null)return;var G=E.tag;if(G===3||G===4){var ie=E.stateNode.containerInfo;if(ie===S||ie.nodeType===8&&ie.parentNode===S)break;if(G===4)for(G=E.return;G!==null;){var ae=G.tag;if((ae===3||ae===4)&&(ae=G.stateNode.containerInfo,ae===S||ae.nodeType===8&&ae.parentNode===S))return;G=G.return}for(;ie!==null;){if(G=sh(ie),G===null)return;if(ae=G.tag,ae===5||ae===6){E=C=G;continue e}ie=ie.parentNode}}E=E.return}it(function(){var Re=C,Ke=L(p),Ze=[];e:{var We=Xk.get(u);if(We!==void 0){var _t=rh,St=u;switch(u){case"keypress":if(nh(p)===0)break e;case"keydown":case"keyup":_t=$n;break;case"focusin":St="focus",_t=Ni;break;case"focusout":St="blur",_t=Ni;break;case"beforeblur":case"afterblur":_t=Ni;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_t=Pg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_t=dy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_t=jo;break;case $k:case Wk:case Hk:_t=gy;break;case Kk:_t=Qd;break;case"scroll":_t=Xd;break;case"wheel":_t=az;break;case"copy":case"cut":case"paste":_t=_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_t=Js}var It=(d&4)!==0,zr=!It&&u==="scroll",ge=It?We!==null?We+"Capture":null:We;It=[];for(var oe=Re,Ee;oe!==null;){Ee=oe;var et=Ee.stateNode;if(Ee.tag===5&&et!==null&&(Ee=et,ge!==null&&(et=xt(oe,ge),et!=null&&It.push(Bg(oe,et,Ee)))),zr)break;oe=oe.return}0<It.length&&(We=new _t(We,St,null,p,Ke),Ze.push({event:We,listeners:It}))}}if((d&7)===0){e:{if(We=u==="mouseover"||u==="pointerover",_t=u==="mouseout"||u==="pointerout",We&&p!==zt&&(St=p.relatedTarget||p.fromElement)&&(sh(St)||St[Il]))break e;if((_t||We)&&(We=Ke.window===Ke?Ke:(We=Ke.ownerDocument)?We.defaultView||We.parentWindow:window,_t?(St=p.relatedTarget||p.toElement,_t=Re,St=St?sh(St):null,St!==null&&(zr=te(St),St!==zr||St.tag!==5&&St.tag!==6)&&(St=null)):(_t=null,St=Re),_t!==St)){if(It=Pg,et="onMouseLeave",ge="onMouseEnter",oe="mouse",(u==="pointerout"||u==="pointerover")&&(It=Js,et="onPointerLeave",ge="onPointerEnter",oe="pointer"),zr=_t==null?We:sf(_t),Ee=St==null?We:sf(St),We=new It(et,oe+"leave",_t,p,Ke),We.target=zr,We.relatedTarget=Ee,et=null,sh(Ke)===Re&&(It=new It(ge,oe+"enter",St,p,Ke),It.target=Ee,It.relatedTarget=zr,et=It),zr=et,_t&&St)t:{for(It=_t,ge=St,oe=0,Ee=It;Ee;Ee=nf(Ee))oe++;for(Ee=0,et=ge;et;et=nf(et))Ee++;for(;0<oe-Ee;)It=nf(It),oe--;for(;0<Ee-oe;)ge=nf(ge),Ee--;for(;oe--;){if(It===ge||ge!==null&&It===ge.alternate)break t;It=nf(It),ge=nf(ge)}It=null}else It=null;_t!==null&&Jk(Ze,We,_t,It,!1),St!==null&&zr!==null&&Jk(Ze,zr,St,It,!0)}}e:{if(We=Re?sf(Re):window,_t=We.nodeName&&We.nodeName.toLowerCase(),_t==="select"||_t==="input"&&We.type==="file")var Pt=fz;else if(Mk(We))if(Lk)Pt=yz;else{Pt=mz;var Vt=gz}else(_t=We.nodeName)&&_t.toLowerCase()==="input"&&(We.type==="checkbox"||We.type==="radio")&&(Pt=pz);if(Pt&&(Pt=Pt(u,Re))){Nk(Ze,Pt,p,Ke);break e}Vt&&Vt(u,We,Re),u==="focusout"&&(Vt=We._wrapperState)&&Vt.controlled&&We.type==="number"&&dn(We,"number",We.value)}switch(Vt=Re?sf(Re):window,u){case"focusin":(Mk(Vt)||Vt.contentEditable==="true")&&(ef=Vt,zE=Re,Fg=null);break;case"focusout":Fg=zE=ef=null;break;case"mousedown":UE=!0;break;case"contextmenu":case"mouseup":case"dragend":UE=!1,zk(Ze,p,Ke);break;case"selectionchange":if(vz)break;case"keydown":case"keyup":zk(Ze,p,Ke)}var Bt;if(jE)e:{switch(u){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else Jd?kk(u,p)&&(Kt="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(Kt="onCompositionStart");Kt&&(Rk&&p.locale!=="ko"&&(Jd||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&Jd&&(Bt=uy()):(Zs=Ke,Kd="value"in Zs?Zs.value:Zs.textContent,Jd=!0)),Vt=_y(Re,Kt),0<Vt.length&&(Kt=new D(Kt,u,null,p,Ke),Ze.push({event:Kt,listeners:Vt}),Bt?Kt.data=Bt:(Bt=Pk(p),Bt!==null&&(Kt.data=Bt)))),(Bt=lz?cz(u,p):uz(u,p))&&(Re=_y(Re,"onBeforeInput"),0<Re.length&&(Ke=new D("onBeforeInput","beforeinput",null,p,Ke),Ze.push({event:Ke,listeners:Re}),Ke.data=Bt))}Zk(Ze,d)})}function Bg(u,d,p){return{instance:u,listener:d,currentTarget:p}}function _y(u,d){for(var p=d+"Capture",E=[];u!==null;){var S=u,C=S.stateNode;S.tag===5&&C!==null&&(S=C,C=xt(u,p),C!=null&&E.unshift(Bg(u,C,S)),C=xt(u,d),C!=null&&E.push(Bg(u,C,S))),u=u.return}return E}function nf(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function Jk(u,d,p,E,S){for(var C=d._reactName,G=[];p!==null&&p!==E;){var ie=p,ae=ie.alternate,Re=ie.stateNode;if(ae!==null&&ae===E)break;ie.tag===5&&Re!==null&&(ie=Re,S?(ae=xt(p,C),ae!=null&&G.unshift(Bg(p,ae,ie))):S||(ae=xt(p,C),ae!=null&&G.push(Bg(p,ae,ie)))),p=p.return}G.length!==0&&u.push({event:d,listeners:G})}var Tz=/\r\n?/g,bz=/\u0000|\uFFFD/g;function eP(u){return(typeof u=="string"?u:""+u).replace(Tz,`
`).replace(bz,"")}function vy(u,d,p){if(d=eP(d),eP(u)!==d&&p)throw Error(t(425))}function wy(){}var qE=null,YE=null;function ZE(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var QE=typeof setTimeout=="function"?setTimeout:void 0,Az=typeof clearTimeout=="function"?clearTimeout:void 0,tP=typeof Promise=="function"?Promise:void 0,Rz=typeof queueMicrotask=="function"?queueMicrotask:typeof tP<"u"?function(u){return tP.resolve(null).then(u).catch(Iz)}:QE;function Iz(u){setTimeout(function(){throw u})}function JE(u,d){var p=d,E=0;do{var S=p.nextSibling;if(u.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(E===0){u.removeChild(S),Ac(d);return}E--}else p!=="$"&&p!=="$?"&&p!=="$!"||E++;p=S}while(p);Ac(d)}function kc(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function nP(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return u;d--}else p==="/$"&&d++}u=u.previousSibling}return null}var rf=Math.random().toString(36).slice(2),Bo="__reactFiber$"+rf,Gg="__reactProps$"+rf,Il="__reactContainer$"+rf,e2="__reactEvents$"+rf,Cz="__reactListeners$"+rf,kz="__reactHandles$"+rf;function sh(u){var d=u[Bo];if(d)return d;for(var p=u.parentNode;p;){if(d=p[Il]||p[Bo]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(u=nP(u);u!==null;){if(p=u[Bo])return p;u=nP(u)}return d}u=p,p=u.parentNode}return null}function zg(u){return u=u[Bo]||u[Il],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function sf(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Ey(u){return u[Gg]||null}var t2=[],af=-1;function Pc(u){return{current:u}}function dr(u){0>af||(u.current=t2[af],t2[af]=null,af--)}function lr(u,d){af++,t2[af]=u.current,u.current=d}var Mc={},Yi=Pc(Mc),As=Pc(!1),ah=Mc;function of(u,d){var p=u.type.contextTypes;if(!p)return Mc;var E=u.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===d)return E.__reactInternalMemoizedMaskedChildContext;var S={},C;for(C in p)S[C]=d[C];return E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=S),S}function Rs(u){return u=u.childContextTypes,u!=null}function Sy(){dr(As),dr(Yi)}function rP(u,d,p){if(Yi.current!==Mc)throw Error(t(168));lr(Yi,d),lr(As,p)}function iP(u,d,p){var E=u.stateNode;if(d=d.childContextTypes,typeof E.getChildContext!="function")return p;E=E.getChildContext();for(var S in E)if(!(S in d))throw Error(t(108,Ie(u)||"Unknown",S));return be({},p,E)}function Ty(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Mc,ah=Yi.current,lr(Yi,u),lr(As,As.current),!0}function sP(u,d,p){var E=u.stateNode;if(!E)throw Error(t(169));p?(u=iP(u,d,ah),E.__reactInternalMemoizedMergedChildContext=u,dr(As),dr(Yi),lr(Yi,u)):dr(As),lr(As,p)}var Cl=null,by=!1,n2=!1;function aP(u){Cl===null?Cl=[u]:Cl.push(u)}function Pz(u){by=!0,aP(u)}function Nc(){if(!n2&&Cl!==null){n2=!0;var u=0,d=vn;try{var p=Cl;for(vn=1;u<p.length;u++){var E=p[u];do E=E(!0);while(E!==null)}Cl=null,by=!1}catch(S){throw Cl!==null&&(Cl=Cl.slice(u+1)),Xe(jn,Nc),S}finally{vn=d,n2=!1}}return null}var lf=[],cf=0,Ay=null,Ry=0,va=[],wa=0,oh=null,kl=1,Pl="";function lh(u,d){lf[cf++]=Ry,lf[cf++]=Ay,Ay=u,Ry=d}function oP(u,d,p){va[wa++]=kl,va[wa++]=Pl,va[wa++]=oh,oh=u;var E=kl;u=Pl;var S=32-Ar(E)-1;E&=~(1<<S),p+=1;var C=32-Ar(d)+S;if(30<C){var G=S-S%5;C=(E&(1<<G)-1).toString(32),E>>=G,S-=G,kl=1<<32-Ar(d)+S|p<<S|E,Pl=C+u}else kl=1<<C|p<<S|E,Pl=u}function r2(u){u.return!==null&&(lh(u,1),oP(u,1,0))}function i2(u){for(;u===Ay;)Ay=lf[--cf],lf[cf]=null,Ry=lf[--cf],lf[cf]=null;for(;u===oh;)oh=va[--wa],va[wa]=null,Pl=va[--wa],va[wa]=null,kl=va[--wa],va[wa]=null}var ea=null,ta=null,vr=!1,Za=null;function lP(u,d){var p=ba(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=u,d=u.deletions,d===null?(u.deletions=[p],u.flags|=16):d.push(p)}function cP(u,d){switch(u.tag){case 5:var p=u.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,ea=u,ta=kc(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,ea=u,ta=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=oh!==null?{id:kl,overflow:Pl}:null,u.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=ba(18,null,null,0),p.stateNode=d,p.return=u,u.child=p,ea=u,ta=null,!0):!1;default:return!1}}function s2(u){return(u.mode&1)!==0&&(u.flags&128)===0}function a2(u){if(vr){var d=ta;if(d){var p=d;if(!cP(u,d)){if(s2(u))throw Error(t(418));d=kc(p.nextSibling);var E=ea;d&&cP(u,d)?lP(E,p):(u.flags=u.flags&-4097|2,vr=!1,ea=u)}}else{if(s2(u))throw Error(t(418));u.flags=u.flags&-4097|2,vr=!1,ea=u}}}function uP(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ea=u}function Iy(u){if(u!==ea)return!1;if(!vr)return uP(u),vr=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!ZE(u.type,u.memoizedProps)),d&&(d=ta)){if(s2(u))throw hP(),Error(t(418));for(;d;)lP(u,d),d=kc(d.nextSibling)}if(uP(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="/$"){if(d===0){ta=kc(u.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}u=u.nextSibling}ta=null}}else ta=ea?kc(u.stateNode.nextSibling):null;return!0}function hP(){for(var u=ta;u;)u=kc(u.nextSibling)}function uf(){ta=ea=null,vr=!1}function o2(u){Za===null?Za=[u]:Za.push(u)}var Mz=M.ReactCurrentBatchConfig;function Ug(u,d,p){if(u=p.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var E=p.stateNode}if(!E)throw Error(t(147,u));var S=E,C=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===C?d.ref:(d=function(G){var ie=S.refs;G===null?delete ie[C]:ie[C]=G},d._stringRef=C,d)}if(typeof u!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,u))}return u}function Cy(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function dP(u){var d=u._init;return d(u._payload)}function fP(u){function d(ge,oe){if(u){var Ee=ge.deletions;Ee===null?(ge.deletions=[oe],ge.flags|=16):Ee.push(oe)}}function p(ge,oe){if(!u)return null;for(;oe!==null;)d(ge,oe),oe=oe.sibling;return null}function E(ge,oe){for(ge=new Map;oe!==null;)oe.key!==null?ge.set(oe.key,oe):ge.set(oe.index,oe),oe=oe.sibling;return ge}function S(ge,oe){return ge=Gc(ge,oe),ge.index=0,ge.sibling=null,ge}function C(ge,oe,Ee){return ge.index=Ee,u?(Ee=ge.alternate,Ee!==null?(Ee=Ee.index,Ee<oe?(ge.flags|=2,oe):Ee):(ge.flags|=2,oe)):(ge.flags|=1048576,oe)}function G(ge){return u&&ge.alternate===null&&(ge.flags|=2),ge}function ie(ge,oe,Ee,et){return oe===null||oe.tag!==6?(oe=Q2(Ee,ge.mode,et),oe.return=ge,oe):(oe=S(oe,Ee),oe.return=ge,oe)}function ae(ge,oe,Ee,et){var Pt=Ee.type;return Pt===I?Ke(ge,oe,Ee.props.children,et,Ee.key):oe!==null&&(oe.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===Ve&&dP(Pt)===oe.type)?(et=S(oe,Ee.props),et.ref=Ug(ge,oe,Ee),et.return=ge,et):(et=Jy(Ee.type,Ee.key,Ee.props,null,ge.mode,et),et.ref=Ug(ge,oe,Ee),et.return=ge,et)}function Re(ge,oe,Ee,et){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==Ee.containerInfo||oe.stateNode.implementation!==Ee.implementation?(oe=J2(Ee,ge.mode,et),oe.return=ge,oe):(oe=S(oe,Ee.children||[]),oe.return=ge,oe)}function Ke(ge,oe,Ee,et,Pt){return oe===null||oe.tag!==7?(oe=ph(Ee,ge.mode,et,Pt),oe.return=ge,oe):(oe=S(oe,Ee),oe.return=ge,oe)}function Ze(ge,oe,Ee){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Q2(""+oe,ge.mode,Ee),oe.return=ge,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:return Ee=Jy(oe.type,oe.key,oe.props,null,ge.mode,Ee),Ee.ref=Ug(ge,null,oe),Ee.return=ge,Ee;case z:return oe=J2(oe,ge.mode,Ee),oe.return=ge,oe;case Ve:var et=oe._init;return Ze(ge,et(oe._payload),Ee)}if(cn(oe)||Ae(oe))return oe=ph(oe,ge.mode,Ee,null),oe.return=ge,oe;Cy(ge,oe)}return null}function We(ge,oe,Ee,et){var Pt=oe!==null?oe.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return Pt!==null?null:ie(ge,oe,""+Ee,et);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case O:return Ee.key===Pt?ae(ge,oe,Ee,et):null;case z:return Ee.key===Pt?Re(ge,oe,Ee,et):null;case Ve:return Pt=Ee._init,We(ge,oe,Pt(Ee._payload),et)}if(cn(Ee)||Ae(Ee))return Pt!==null?null:Ke(ge,oe,Ee,et,null);Cy(ge,Ee)}return null}function _t(ge,oe,Ee,et,Pt){if(typeof et=="string"&&et!==""||typeof et=="number")return ge=ge.get(Ee)||null,ie(oe,ge,""+et,Pt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case O:return ge=ge.get(et.key===null?Ee:et.key)||null,ae(oe,ge,et,Pt);case z:return ge=ge.get(et.key===null?Ee:et.key)||null,Re(oe,ge,et,Pt);case Ve:var Vt=et._init;return _t(ge,oe,Ee,Vt(et._payload),Pt)}if(cn(et)||Ae(et))return ge=ge.get(Ee)||null,Ke(oe,ge,et,Pt,null);Cy(oe,et)}return null}function St(ge,oe,Ee,et){for(var Pt=null,Vt=null,Bt=oe,Kt=oe=0,wi=null;Bt!==null&&Kt<Ee.length;Kt++){Bt.index>Kt?(wi=Bt,Bt=null):wi=Bt.sibling;var An=We(ge,Bt,Ee[Kt],et);if(An===null){Bt===null&&(Bt=wi);break}u&&Bt&&An.alternate===null&&d(ge,Bt),oe=C(An,oe,Kt),Vt===null?Pt=An:Vt.sibling=An,Vt=An,Bt=wi}if(Kt===Ee.length)return p(ge,Bt),vr&&lh(ge,Kt),Pt;if(Bt===null){for(;Kt<Ee.length;Kt++)Bt=Ze(ge,Ee[Kt],et),Bt!==null&&(oe=C(Bt,oe,Kt),Vt===null?Pt=Bt:Vt.sibling=Bt,Vt=Bt);return vr&&lh(ge,Kt),Pt}for(Bt=E(ge,Bt);Kt<Ee.length;Kt++)wi=_t(Bt,ge,Kt,Ee[Kt],et),wi!==null&&(u&&wi.alternate!==null&&Bt.delete(wi.key===null?Kt:wi.key),oe=C(wi,oe,Kt),Vt===null?Pt=wi:Vt.sibling=wi,Vt=wi);return u&&Bt.forEach(function(zc){return d(ge,zc)}),vr&&lh(ge,Kt),Pt}function It(ge,oe,Ee,et){var Pt=Ae(Ee);if(typeof Pt!="function")throw Error(t(150));if(Ee=Pt.call(Ee),Ee==null)throw Error(t(151));for(var Vt=Pt=null,Bt=oe,Kt=oe=0,wi=null,An=Ee.next();Bt!==null&&!An.done;Kt++,An=Ee.next()){Bt.index>Kt?(wi=Bt,Bt=null):wi=Bt.sibling;var zc=We(ge,Bt,An.value,et);if(zc===null){Bt===null&&(Bt=wi);break}u&&Bt&&zc.alternate===null&&d(ge,Bt),oe=C(zc,oe,Kt),Vt===null?Pt=zc:Vt.sibling=zc,Vt=zc,Bt=wi}if(An.done)return p(ge,Bt),vr&&lh(ge,Kt),Pt;if(Bt===null){for(;!An.done;Kt++,An=Ee.next())An=Ze(ge,An.value,et),An!==null&&(oe=C(An,oe,Kt),Vt===null?Pt=An:Vt.sibling=An,Vt=An);return vr&&lh(ge,Kt),Pt}for(Bt=E(ge,Bt);!An.done;Kt++,An=Ee.next())An=_t(Bt,ge,Kt,An.value,et),An!==null&&(u&&An.alternate!==null&&Bt.delete(An.key===null?Kt:An.key),oe=C(An,oe,Kt),Vt===null?Pt=An:Vt.sibling=An,Vt=An);return u&&Bt.forEach(function(hU){return d(ge,hU)}),vr&&lh(ge,Kt),Pt}function zr(ge,oe,Ee,et){if(typeof Ee=="object"&&Ee!==null&&Ee.type===I&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case O:e:{for(var Pt=Ee.key,Vt=oe;Vt!==null;){if(Vt.key===Pt){if(Pt=Ee.type,Pt===I){if(Vt.tag===7){p(ge,Vt.sibling),oe=S(Vt,Ee.props.children),oe.return=ge,ge=oe;break e}}else if(Vt.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===Ve&&dP(Pt)===Vt.type){p(ge,Vt.sibling),oe=S(Vt,Ee.props),oe.ref=Ug(ge,Vt,Ee),oe.return=ge,ge=oe;break e}p(ge,Vt);break}else d(ge,Vt);Vt=Vt.sibling}Ee.type===I?(oe=ph(Ee.props.children,ge.mode,et,Ee.key),oe.return=ge,ge=oe):(et=Jy(Ee.type,Ee.key,Ee.props,null,ge.mode,et),et.ref=Ug(ge,oe,Ee),et.return=ge,ge=et)}return G(ge);case z:e:{for(Vt=Ee.key;oe!==null;){if(oe.key===Vt)if(oe.tag===4&&oe.stateNode.containerInfo===Ee.containerInfo&&oe.stateNode.implementation===Ee.implementation){p(ge,oe.sibling),oe=S(oe,Ee.children||[]),oe.return=ge,ge=oe;break e}else{p(ge,oe);break}else d(ge,oe);oe=oe.sibling}oe=J2(Ee,ge.mode,et),oe.return=ge,ge=oe}return G(ge);case Ve:return Vt=Ee._init,zr(ge,oe,Vt(Ee._payload),et)}if(cn(Ee))return St(ge,oe,Ee,et);if(Ae(Ee))return It(ge,oe,Ee,et);Cy(ge,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"?(Ee=""+Ee,oe!==null&&oe.tag===6?(p(ge,oe.sibling),oe=S(oe,Ee),oe.return=ge,ge=oe):(p(ge,oe),oe=Q2(Ee,ge.mode,et),oe.return=ge,ge=oe),G(ge)):p(ge,oe)}return zr}var hf=fP(!0),gP=fP(!1),ky=Pc(null),Py=null,df=null,l2=null;function c2(){l2=df=Py=null}function u2(u){var d=ky.current;dr(ky),u._currentValue=d}function h2(u,d,p){for(;u!==null;){var E=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,E!==null&&(E.childLanes|=d)):E!==null&&(E.childLanes&d)!==d&&(E.childLanes|=d),u===p)break;u=u.return}}function ff(u,d){Py=u,l2=df=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(Is=!0),u.firstContext=null)}function Ea(u){var d=u._currentValue;if(l2!==u)if(u={context:u,memoizedValue:d,next:null},df===null){if(Py===null)throw Error(t(308));df=u,Py.dependencies={lanes:0,firstContext:u}}else df=df.next=u;return d}var ch=null;function d2(u){ch===null?ch=[u]:ch.push(u)}function mP(u,d,p,E){var S=d.interleaved;return S===null?(p.next=p,d2(d)):(p.next=S.next,S.next=p),d.interleaved=p,Ml(u,E)}function Ml(u,d){u.lanes|=d;var p=u.alternate;for(p!==null&&(p.lanes|=d),p=u,u=u.return;u!==null;)u.childLanes|=d,p=u.alternate,p!==null&&(p.childLanes|=d),p=u,u=u.return;return p.tag===3?p.stateNode:null}var Lc=!1;function f2(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pP(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Nl(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function Oc(u,d,p){var E=u.updateQueue;if(E===null)return null;if(E=E.shared,(Sn&2)!==0){var S=E.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),E.pending=d,Ml(u,p)}return S=E.interleaved,S===null?(d.next=d,d2(E)):(d.next=S.next,S.next=d),E.interleaved=d,Ml(u,p)}function My(u,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Tg(u,p)}}function yP(u,d){var p=u.updateQueue,E=u.alternate;if(E!==null&&(E=E.updateQueue,p===E)){var S=null,C=null;if(p=p.firstBaseUpdate,p!==null){do{var G={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};C===null?S=C=G:C=C.next=G,p=p.next}while(p!==null);C===null?S=C=d:C=C.next=d}else S=C=d;p={baseState:E.baseState,firstBaseUpdate:S,lastBaseUpdate:C,shared:E.shared,effects:E.effects},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=d}function Ny(u,d,p,E){var S=u.updateQueue;Lc=!1;var C=S.firstBaseUpdate,G=S.lastBaseUpdate,ie=S.shared.pending;if(ie!==null){S.shared.pending=null;var ae=ie,Re=ae.next;ae.next=null,G===null?C=Re:G.next=Re,G=ae;var Ke=u.alternate;Ke!==null&&(Ke=Ke.updateQueue,ie=Ke.lastBaseUpdate,ie!==G&&(ie===null?Ke.firstBaseUpdate=Re:ie.next=Re,Ke.lastBaseUpdate=ae))}if(C!==null){var Ze=S.baseState;G=0,Ke=Re=ae=null,ie=C;do{var We=ie.lane,_t=ie.eventTime;if((E&We)===We){Ke!==null&&(Ke=Ke.next={eventTime:_t,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var St=u,It=ie;switch(We=d,_t=p,It.tag){case 1:if(St=It.payload,typeof St=="function"){Ze=St.call(_t,Ze,We);break e}Ze=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=It.payload,We=typeof St=="function"?St.call(_t,Ze,We):St,We==null)break e;Ze=be({},Ze,We);break e;case 2:Lc=!0}}ie.callback!==null&&ie.lane!==0&&(u.flags|=64,We=S.effects,We===null?S.effects=[ie]:We.push(ie))}else _t={eventTime:_t,lane:We,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},Ke===null?(Re=Ke=_t,ae=Ze):Ke=Ke.next=_t,G|=We;if(ie=ie.next,ie===null){if(ie=S.shared.pending,ie===null)break;We=ie,ie=We.next,We.next=null,S.lastBaseUpdate=We,S.shared.pending=null}}while(!0);if(Ke===null&&(ae=Ze),S.baseState=ae,S.firstBaseUpdate=Re,S.lastBaseUpdate=Ke,d=S.shared.interleaved,d!==null){S=d;do G|=S.lane,S=S.next;while(S!==d)}else C===null&&(S.shared.lanes=0);dh|=G,u.lanes=G,u.memoizedState=Ze}}function xP(u,d,p){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var E=u[d],S=E.callback;if(S!==null){if(E.callback=null,E=p,typeof S!="function")throw Error(t(191,S));S.call(E)}}}var $g={},Go=Pc($g),Wg=Pc($g),Hg=Pc($g);function uh(u){if(u===$g)throw Error(t(174));return u}function g2(u,d){switch(lr(Hg,d),lr(Wg,u),lr(Go,$g),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:vt(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=vt(d,u)}dr(Go),lr(Go,d)}function gf(){dr(Go),dr(Wg),dr(Hg)}function _P(u){uh(Hg.current);var d=uh(Go.current),p=vt(d,u.type);d!==p&&(lr(Wg,u),lr(Go,p))}function m2(u){Wg.current===u&&(dr(Go),dr(Wg))}var Rr=Pc(0);function Ly(u){for(var d=u;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var p2=[];function y2(){for(var u=0;u<p2.length;u++)p2[u]._workInProgressVersionPrimary=null;p2.length=0}var Oy=M.ReactCurrentDispatcher,x2=M.ReactCurrentBatchConfig,hh=0,Ir=null,ci=null,_i=null,Dy=!1,Kg=!1,Xg=0,Nz=0;function Zi(){throw Error(t(321))}function _2(u,d){if(d===null)return!1;for(var p=0;p<d.length&&p<u.length;p++)if(!Ya(u[p],d[p]))return!1;return!0}function v2(u,d,p,E,S,C){if(hh=C,Ir=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Oy.current=u===null||u.memoizedState===null?Fz:jz,u=p(E,S),Kg){C=0;do{if(Kg=!1,Xg=0,25<=C)throw Error(t(301));C+=1,_i=ci=null,d.updateQueue=null,Oy.current=Vz,u=p(E,S)}while(Kg)}if(Oy.current=Vy,d=ci!==null&&ci.next!==null,hh=0,_i=ci=Ir=null,Dy=!1,d)throw Error(t(300));return u}function w2(){var u=Xg!==0;return Xg=0,u}function zo(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _i===null?Ir.memoizedState=_i=u:_i=_i.next=u,_i}function Sa(){if(ci===null){var u=Ir.alternate;u=u!==null?u.memoizedState:null}else u=ci.next;var d=_i===null?Ir.memoizedState:_i.next;if(d!==null)_i=d,ci=u;else{if(u===null)throw Error(t(310));ci=u,u={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},_i===null?Ir.memoizedState=_i=u:_i=_i.next=u}return _i}function qg(u,d){return typeof d=="function"?d(u):d}function E2(u){var d=Sa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=ci,S=E.baseQueue,C=p.pending;if(C!==null){if(S!==null){var G=S.next;S.next=C.next,C.next=G}E.baseQueue=S=C,p.pending=null}if(S!==null){C=S.next,E=E.baseState;var ie=G=null,ae=null,Re=C;do{var Ke=Re.lane;if((hh&Ke)===Ke)ae!==null&&(ae=ae.next={lane:0,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null}),E=Re.hasEagerState?Re.eagerState:u(E,Re.action);else{var Ze={lane:Ke,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null};ae===null?(ie=ae=Ze,G=E):ae=ae.next=Ze,Ir.lanes|=Ke,dh|=Ke}Re=Re.next}while(Re!==null&&Re!==C);ae===null?G=E:ae.next=ie,Ya(E,d.memoizedState)||(Is=!0),d.memoizedState=E,d.baseState=G,d.baseQueue=ae,p.lastRenderedState=E}if(u=p.interleaved,u!==null){S=u;do C=S.lane,Ir.lanes|=C,dh|=C,S=S.next;while(S!==u)}else S===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function S2(u){var d=Sa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=p.dispatch,S=p.pending,C=d.memoizedState;if(S!==null){p.pending=null;var G=S=S.next;do C=u(C,G.action),G=G.next;while(G!==S);Ya(C,d.memoizedState)||(Is=!0),d.memoizedState=C,d.baseQueue===null&&(d.baseState=C),p.lastRenderedState=C}return[C,E]}function vP(){}function wP(u,d){var p=Ir,E=Sa(),S=d(),C=!Ya(E.memoizedState,S);if(C&&(E.memoizedState=S,Is=!0),E=E.queue,T2(TP.bind(null,p,E,u),[u]),E.getSnapshot!==d||C||_i!==null&&_i.memoizedState.tag&1){if(p.flags|=2048,Yg(9,SP.bind(null,p,E,S,d),void 0,null),vi===null)throw Error(t(349));(hh&30)!==0||EP(p,d,S)}return S}function EP(u,d,p){u.flags|=16384,u={getSnapshot:d,value:p},d=Ir.updateQueue,d===null?(d={lastEffect:null,stores:null},Ir.updateQueue=d,d.stores=[u]):(p=d.stores,p===null?d.stores=[u]:p.push(u))}function SP(u,d,p,E){d.value=p,d.getSnapshot=E,bP(d)&&AP(u)}function TP(u,d,p){return p(function(){bP(d)&&AP(u)})}function bP(u){var d=u.getSnapshot;u=u.value;try{var p=d();return!Ya(u,p)}catch{return!0}}function AP(u){var d=Ml(u,1);d!==null&&to(d,u,1,-1)}function RP(u){var d=zo();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qg,lastRenderedState:u},d.queue=u,u=u.dispatch=Dz.bind(null,Ir,u),[d.memoizedState,u]}function Yg(u,d,p,E){return u={tag:u,create:d,destroy:p,deps:E,next:null},d=Ir.updateQueue,d===null?(d={lastEffect:null,stores:null},Ir.updateQueue=d,d.lastEffect=u.next=u):(p=d.lastEffect,p===null?d.lastEffect=u.next=u:(E=p.next,p.next=u,u.next=E,d.lastEffect=u)),u}function IP(){return Sa().memoizedState}function Fy(u,d,p,E){var S=zo();Ir.flags|=u,S.memoizedState=Yg(1|d,p,void 0,E===void 0?null:E)}function jy(u,d,p,E){var S=Sa();E=E===void 0?null:E;var C=void 0;if(ci!==null){var G=ci.memoizedState;if(C=G.destroy,E!==null&&_2(E,G.deps)){S.memoizedState=Yg(d,p,C,E);return}}Ir.flags|=u,S.memoizedState=Yg(1|d,p,C,E)}function CP(u,d){return Fy(8390656,8,u,d)}function T2(u,d){return jy(2048,8,u,d)}function kP(u,d){return jy(4,2,u,d)}function PP(u,d){return jy(4,4,u,d)}function MP(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function NP(u,d,p){return p=p!=null?p.concat([u]):null,jy(4,4,MP.bind(null,d,u),p)}function b2(){}function LP(u,d){var p=Sa();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&_2(d,E[1])?E[0]:(p.memoizedState=[u,d],u)}function OP(u,d){var p=Sa();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&_2(d,E[1])?E[0]:(u=u(),p.memoizedState=[u,d],u)}function DP(u,d,p){return(hh&21)===0?(u.baseState&&(u.baseState=!1,Is=!0),u.memoizedState=p):(Ya(p,d)||(p=Eg(),Ir.lanes|=p,dh|=p,u.baseState=!0),d)}function Lz(u,d){var p=vn;vn=p!==0&&4>p?p:4,u(!0);var E=x2.transition;x2.transition={};try{u(!1),d()}finally{vn=p,x2.transition=E}}function FP(){return Sa().memoizedState}function Oz(u,d,p){var E=Vc(u);if(p={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null},jP(u))VP(d,p);else if(p=mP(u,d,p,E),p!==null){var S=ps();to(p,u,E,S),BP(p,d,E)}}function Dz(u,d,p){var E=Vc(u),S={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null};if(jP(u))VP(d,S);else{var C=u.alternate;if(u.lanes===0&&(C===null||C.lanes===0)&&(C=d.lastRenderedReducer,C!==null))try{var G=d.lastRenderedState,ie=C(G,p);if(S.hasEagerState=!0,S.eagerState=ie,Ya(ie,G)){var ae=d.interleaved;ae===null?(S.next=S,d2(d)):(S.next=ae.next,ae.next=S),d.interleaved=S;return}}catch{}p=mP(u,d,S,E),p!==null&&(S=ps(),to(p,u,E,S),BP(p,d,E))}}function jP(u){var d=u.alternate;return u===Ir||d!==null&&d===Ir}function VP(u,d){Kg=Dy=!0;var p=u.pending;p===null?d.next=d:(d.next=p.next,p.next=d),u.pending=d}function BP(u,d,p){if((p&4194240)!==0){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Tg(u,p)}}var Vy={readContext:Ea,useCallback:Zi,useContext:Zi,useEffect:Zi,useImperativeHandle:Zi,useInsertionEffect:Zi,useLayoutEffect:Zi,useMemo:Zi,useReducer:Zi,useRef:Zi,useState:Zi,useDebugValue:Zi,useDeferredValue:Zi,useTransition:Zi,useMutableSource:Zi,useSyncExternalStore:Zi,useId:Zi,unstable_isNewReconciler:!1},Fz={readContext:Ea,useCallback:function(u,d){return zo().memoizedState=[u,d===void 0?null:d],u},useContext:Ea,useEffect:CP,useImperativeHandle:function(u,d,p){return p=p!=null?p.concat([u]):null,Fy(4194308,4,MP.bind(null,d,u),p)},useLayoutEffect:function(u,d){return Fy(4194308,4,u,d)},useInsertionEffect:function(u,d){return Fy(4,2,u,d)},useMemo:function(u,d){var p=zo();return d=d===void 0?null:d,u=u(),p.memoizedState=[u,d],u},useReducer:function(u,d,p){var E=zo();return d=p!==void 0?p(d):d,E.memoizedState=E.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},E.queue=u,u=u.dispatch=Oz.bind(null,Ir,u),[E.memoizedState,u]},useRef:function(u){var d=zo();return u={current:u},d.memoizedState=u},useState:RP,useDebugValue:b2,useDeferredValue:function(u){return zo().memoizedState=u},useTransition:function(){var u=RP(!1),d=u[0];return u=Lz.bind(null,u[1]),zo().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,p){var E=Ir,S=zo();if(vr){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),vi===null)throw Error(t(349));(hh&30)!==0||EP(E,d,p)}S.memoizedState=p;var C={value:p,getSnapshot:d};return S.queue=C,CP(TP.bind(null,E,C,u),[u]),E.flags|=2048,Yg(9,SP.bind(null,E,C,p,d),void 0,null),p},useId:function(){var u=zo(),d=vi.identifierPrefix;if(vr){var p=Pl,E=kl;p=(E&~(1<<32-Ar(E)-1)).toString(32)+p,d=":"+d+"R"+p,p=Xg++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=Nz++,d=":"+d+"r"+p.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},jz={readContext:Ea,useCallback:LP,useContext:Ea,useEffect:T2,useImperativeHandle:NP,useInsertionEffect:kP,useLayoutEffect:PP,useMemo:OP,useReducer:E2,useRef:IP,useState:function(){return E2(qg)},useDebugValue:b2,useDeferredValue:function(u){var d=Sa();return DP(d,ci.memoizedState,u)},useTransition:function(){var u=E2(qg)[0],d=Sa().memoizedState;return[u,d]},useMutableSource:vP,useSyncExternalStore:wP,useId:FP,unstable_isNewReconciler:!1},Vz={readContext:Ea,useCallback:LP,useContext:Ea,useEffect:T2,useImperativeHandle:NP,useInsertionEffect:kP,useLayoutEffect:PP,useMemo:OP,useReducer:S2,useRef:IP,useState:function(){return S2(qg)},useDebugValue:b2,useDeferredValue:function(u){var d=Sa();return ci===null?d.memoizedState=u:DP(d,ci.memoizedState,u)},useTransition:function(){var u=S2(qg)[0],d=Sa().memoizedState;return[u,d]},useMutableSource:vP,useSyncExternalStore:wP,useId:FP,unstable_isNewReconciler:!1};function Qa(u,d){if(u&&u.defaultProps){d=be({},d),u=u.defaultProps;for(var p in u)d[p]===void 0&&(d[p]=u[p]);return d}return d}function A2(u,d,p,E){d=u.memoizedState,p=p(E,d),p=p==null?d:be({},d,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var By={isMounted:function(u){return(u=u._reactInternals)?te(u)===u:!1},enqueueSetState:function(u,d,p){u=u._reactInternals;var E=ps(),S=Vc(u),C=Nl(E,S);C.payload=d,p!=null&&(C.callback=p),d=Oc(u,C,S),d!==null&&(to(d,u,S,E),My(d,u,S))},enqueueReplaceState:function(u,d,p){u=u._reactInternals;var E=ps(),S=Vc(u),C=Nl(E,S);C.tag=1,C.payload=d,p!=null&&(C.callback=p),d=Oc(u,C,S),d!==null&&(to(d,u,S,E),My(d,u,S))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var p=ps(),E=Vc(u),S=Nl(p,E);S.tag=2,d!=null&&(S.callback=d),d=Oc(u,S,E),d!==null&&(to(d,u,E,p),My(d,u,E))}};function GP(u,d,p,E,S,C,G){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(E,C,G):d.prototype&&d.prototype.isPureReactComponent?!Dg(p,E)||!Dg(S,C):!0}function zP(u,d,p){var E=!1,S=Mc,C=d.contextType;return typeof C=="object"&&C!==null?C=Ea(C):(S=Rs(d)?ah:Yi.current,E=d.contextTypes,C=(E=E!=null)?of(u,S):Mc),d=new d(p,C),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=By,u.stateNode=d,d._reactInternals=u,E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=S,u.__reactInternalMemoizedMaskedChildContext=C),d}function UP(u,d,p,E){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,E),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,E),d.state!==u&&By.enqueueReplaceState(d,d.state,null)}function R2(u,d,p,E){var S=u.stateNode;S.props=p,S.state=u.memoizedState,S.refs={},f2(u);var C=d.contextType;typeof C=="object"&&C!==null?S.context=Ea(C):(C=Rs(d)?ah:Yi.current,S.context=of(u,C)),S.state=u.memoizedState,C=d.getDerivedStateFromProps,typeof C=="function"&&(A2(u,d,C,p),S.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&By.enqueueReplaceState(S,S.state,null),Ny(u,p,S,E),S.state=u.memoizedState),typeof S.componentDidMount=="function"&&(u.flags|=4194308)}function mf(u,d){try{var p="",E=d;do p+=q(E),E=E.return;while(E);var S=p}catch(C){S=`
Error generating stack: `+C.message+`
`+C.stack}return{value:u,source:d,stack:S,digest:null}}function I2(u,d,p){return{value:u,source:null,stack:p??null,digest:d??null}}function C2(u,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var Bz=typeof WeakMap=="function"?WeakMap:Map;function $P(u,d,p){p=Nl(-1,p),p.tag=3,p.payload={element:null};var E=d.value;return p.callback=function(){Ky||(Ky=!0,$2=E),C2(u,d)},p}function WP(u,d,p){p=Nl(-1,p),p.tag=3;var E=u.type.getDerivedStateFromError;if(typeof E=="function"){var S=d.value;p.payload=function(){return E(S)},p.callback=function(){C2(u,d)}}var C=u.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(p.callback=function(){C2(u,d),typeof E!="function"&&(Fc===null?Fc=new Set([this]):Fc.add(this));var G=d.stack;this.componentDidCatch(d.value,{componentStack:G!==null?G:""})}),p}function HP(u,d,p){var E=u.pingCache;if(E===null){E=u.pingCache=new Bz;var S=new Set;E.set(d,S)}else S=E.get(d),S===void 0&&(S=new Set,E.set(d,S));S.has(p)||(S.add(p),u=eU.bind(null,u,d,p),d.then(u,u))}function KP(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function XP(u,d,p,E,S){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=Nl(-1,1),d.tag=2,Oc(p,d,1))),p.lanes|=1),u):(u.flags|=65536,u.lanes=S,u)}var Gz=M.ReactCurrentOwner,Is=!1;function ms(u,d,p,E){d.child=u===null?gP(d,null,p,E):hf(d,u.child,p,E)}function qP(u,d,p,E,S){p=p.render;var C=d.ref;return ff(d,S),E=v2(u,d,p,E,C,S),p=w2(),u!==null&&!Is?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Ll(u,d,S)):(vr&&p&&r2(d),d.flags|=1,ms(u,d,E,S),d.child)}function YP(u,d,p,E,S){if(u===null){var C=p.type;return typeof C=="function"&&!Z2(C)&&C.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=C,ZP(u,d,C,E,S)):(u=Jy(p.type,null,E,d,d.mode,S),u.ref=d.ref,u.return=d,d.child=u)}if(C=u.child,(u.lanes&S)===0){var G=C.memoizedProps;if(p=p.compare,p=p!==null?p:Dg,p(G,E)&&u.ref===d.ref)return Ll(u,d,S)}return d.flags|=1,u=Gc(C,E),u.ref=d.ref,u.return=d,d.child=u}function ZP(u,d,p,E,S){if(u!==null){var C=u.memoizedProps;if(Dg(C,E)&&u.ref===d.ref)if(Is=!1,d.pendingProps=E=C,(u.lanes&S)!==0)(u.flags&131072)!==0&&(Is=!0);else return d.lanes=u.lanes,Ll(u,d,S)}return k2(u,d,p,E,S)}function QP(u,d,p){var E=d.pendingProps,S=E.children,C=u!==null?u.memoizedState:null;if(E.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},lr(yf,na),na|=p;else{if((p&1073741824)===0)return u=C!==null?C.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,lr(yf,na),na|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=C!==null?C.baseLanes:p,lr(yf,na),na|=E}else C!==null?(E=C.baseLanes|p,d.memoizedState=null):E=p,lr(yf,na),na|=E;return ms(u,d,S,p),d.child}function JP(u,d){var p=d.ref;(u===null&&p!==null||u!==null&&u.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function k2(u,d,p,E,S){var C=Rs(p)?ah:Yi.current;return C=of(d,C),ff(d,S),p=v2(u,d,p,E,C,S),E=w2(),u!==null&&!Is?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Ll(u,d,S)):(vr&&E&&r2(d),d.flags|=1,ms(u,d,p,S),d.child)}function e4(u,d,p,E,S){if(Rs(p)){var C=!0;Ty(d)}else C=!1;if(ff(d,S),d.stateNode===null)zy(u,d),zP(d,p,E),R2(d,p,E,S),E=!0;else if(u===null){var G=d.stateNode,ie=d.memoizedProps;G.props=ie;var ae=G.context,Re=p.contextType;typeof Re=="object"&&Re!==null?Re=Ea(Re):(Re=Rs(p)?ah:Yi.current,Re=of(d,Re));var Ke=p.getDerivedStateFromProps,Ze=typeof Ke=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ze||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(ie!==E||ae!==Re)&&UP(d,G,E,Re),Lc=!1;var We=d.memoizedState;G.state=We,Ny(d,E,G,S),ae=d.memoizedState,ie!==E||We!==ae||As.current||Lc?(typeof Ke=="function"&&(A2(d,p,Ke,E),ae=d.memoizedState),(ie=Lc||GP(d,p,ie,E,We,ae,Re))?(Ze||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(d.flags|=4194308)):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=E,d.memoizedState=ae),G.props=E,G.state=ae,G.context=Re,E=ie):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),E=!1)}else{G=d.stateNode,pP(u,d),ie=d.memoizedProps,Re=d.type===d.elementType?ie:Qa(d.type,ie),G.props=Re,Ze=d.pendingProps,We=G.context,ae=p.contextType,typeof ae=="object"&&ae!==null?ae=Ea(ae):(ae=Rs(p)?ah:Yi.current,ae=of(d,ae));var _t=p.getDerivedStateFromProps;(Ke=typeof _t=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(ie!==Ze||We!==ae)&&UP(d,G,E,ae),Lc=!1,We=d.memoizedState,G.state=We,Ny(d,E,G,S);var St=d.memoizedState;ie!==Ze||We!==St||As.current||Lc?(typeof _t=="function"&&(A2(d,p,_t,E),St=d.memoizedState),(Re=Lc||GP(d,p,Re,E,We,St,ae)||!1)?(Ke||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(E,St,ae),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(E,St,ae)),typeof G.componentDidUpdate=="function"&&(d.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof G.componentDidUpdate!="function"||ie===u.memoizedProps&&We===u.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||ie===u.memoizedProps&&We===u.memoizedState||(d.flags|=1024),d.memoizedProps=E,d.memoizedState=St),G.props=E,G.state=St,G.context=ae,E=Re):(typeof G.componentDidUpdate!="function"||ie===u.memoizedProps&&We===u.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||ie===u.memoizedProps&&We===u.memoizedState||(d.flags|=1024),E=!1)}return P2(u,d,p,E,C,S)}function P2(u,d,p,E,S,C){JP(u,d);var G=(d.flags&128)!==0;if(!E&&!G)return S&&sP(d,p,!1),Ll(u,d,C);E=d.stateNode,Gz.current=d;var ie=G&&typeof p.getDerivedStateFromError!="function"?null:E.render();return d.flags|=1,u!==null&&G?(d.child=hf(d,u.child,null,C),d.child=hf(d,null,ie,C)):ms(u,d,ie,C),d.memoizedState=E.state,S&&sP(d,p,!0),d.child}function t4(u){var d=u.stateNode;d.pendingContext?rP(u,d.pendingContext,d.pendingContext!==d.context):d.context&&rP(u,d.context,!1),g2(u,d.containerInfo)}function n4(u,d,p,E,S){return uf(),o2(S),d.flags|=256,ms(u,d,p,E),d.child}var M2={dehydrated:null,treeContext:null,retryLane:0};function N2(u){return{baseLanes:u,cachePool:null,transitions:null}}function r4(u,d,p){var E=d.pendingProps,S=Rr.current,C=!1,G=(d.flags&128)!==0,ie;if((ie=G)||(ie=u!==null&&u.memoizedState===null?!1:(S&2)!==0),ie?(C=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(S|=1),lr(Rr,S&1),u===null)return a2(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(G=E.children,u=E.fallback,C?(E=d.mode,C=d.child,G={mode:"hidden",children:G},(E&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=G):C=ex(G,E,0,null),u=ph(u,E,p,null),C.return=d,u.return=d,C.sibling=u,d.child=C,d.child.memoizedState=N2(p),d.memoizedState=M2,u):L2(d,G));if(S=u.memoizedState,S!==null&&(ie=S.dehydrated,ie!==null))return zz(u,d,G,E,ie,S,p);if(C){C=E.fallback,G=d.mode,S=u.child,ie=S.sibling;var ae={mode:"hidden",children:E.children};return(G&1)===0&&d.child!==S?(E=d.child,E.childLanes=0,E.pendingProps=ae,d.deletions=null):(E=Gc(S,ae),E.subtreeFlags=S.subtreeFlags&14680064),ie!==null?C=Gc(ie,C):(C=ph(C,G,p,null),C.flags|=2),C.return=d,E.return=d,E.sibling=C,d.child=E,E=C,C=d.child,G=u.child.memoizedState,G=G===null?N2(p):{baseLanes:G.baseLanes|p,cachePool:null,transitions:G.transitions},C.memoizedState=G,C.childLanes=u.childLanes&~p,d.memoizedState=M2,E}return C=u.child,u=C.sibling,E=Gc(C,{mode:"visible",children:E.children}),(d.mode&1)===0&&(E.lanes=p),E.return=d,E.sibling=null,u!==null&&(p=d.deletions,p===null?(d.deletions=[u],d.flags|=16):p.push(u)),d.child=E,d.memoizedState=null,E}function L2(u,d){return d=ex({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function Gy(u,d,p,E){return E!==null&&o2(E),hf(d,u.child,null,p),u=L2(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function zz(u,d,p,E,S,C,G){if(p)return d.flags&256?(d.flags&=-257,E=I2(Error(t(422))),Gy(u,d,G,E)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(C=E.fallback,S=d.mode,E=ex({mode:"visible",children:E.children},S,0,null),C=ph(C,S,G,null),C.flags|=2,E.return=d,C.return=d,E.sibling=C,d.child=E,(d.mode&1)!==0&&hf(d,u.child,null,G),d.child.memoizedState=N2(G),d.memoizedState=M2,C);if((d.mode&1)===0)return Gy(u,d,G,null);if(S.data==="$!"){if(E=S.nextSibling&&S.nextSibling.dataset,E)var ie=E.dgst;return E=ie,C=Error(t(419)),E=I2(C,E,void 0),Gy(u,d,G,E)}if(ie=(G&u.childLanes)!==0,Is||ie){if(E=vi,E!==null){switch(G&-G){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(E.suspendedLanes|G))!==0?0:S,S!==0&&S!==C.retryLane&&(C.retryLane=S,Ml(u,S),to(E,u,S,-1))}return Y2(),E=I2(Error(t(421))),Gy(u,d,G,E)}return S.data==="$?"?(d.flags|=128,d.child=u.child,d=tU.bind(null,u),S._reactRetry=d,null):(u=C.treeContext,ta=kc(S.nextSibling),ea=d,vr=!0,Za=null,u!==null&&(va[wa++]=kl,va[wa++]=Pl,va[wa++]=oh,kl=u.id,Pl=u.overflow,oh=d),d=L2(d,E.children),d.flags|=4096,d)}function i4(u,d,p){u.lanes|=d;var E=u.alternate;E!==null&&(E.lanes|=d),h2(u.return,d,p)}function O2(u,d,p,E,S){var C=u.memoizedState;C===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:E,tail:p,tailMode:S}:(C.isBackwards=d,C.rendering=null,C.renderingStartTime=0,C.last=E,C.tail=p,C.tailMode=S)}function s4(u,d,p){var E=d.pendingProps,S=E.revealOrder,C=E.tail;if(ms(u,d,E.children,p),E=Rr.current,(E&2)!==0)E=E&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&i4(u,p,d);else if(u.tag===19)i4(u,p,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}E&=1}if(lr(Rr,E),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(p=d.child,S=null;p!==null;)u=p.alternate,u!==null&&Ly(u)===null&&(S=p),p=p.sibling;p=S,p===null?(S=d.child,d.child=null):(S=p.sibling,p.sibling=null),O2(d,!1,S,p,C);break;case"backwards":for(p=null,S=d.child,d.child=null;S!==null;){if(u=S.alternate,u!==null&&Ly(u)===null){d.child=S;break}u=S.sibling,S.sibling=p,p=S,S=u}O2(d,!0,p,null,C);break;case"together":O2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function zy(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Ll(u,d,p){if(u!==null&&(d.dependencies=u.dependencies),dh|=d.lanes,(p&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,p=Gc(u,u.pendingProps),d.child=p,p.return=d;u.sibling!==null;)u=u.sibling,p=p.sibling=Gc(u,u.pendingProps),p.return=d;p.sibling=null}return d.child}function Uz(u,d,p){switch(d.tag){case 3:t4(d),uf();break;case 5:_P(d);break;case 1:Rs(d.type)&&Ty(d);break;case 4:g2(d,d.stateNode.containerInfo);break;case 10:var E=d.type._context,S=d.memoizedProps.value;lr(ky,E._currentValue),E._currentValue=S;break;case 13:if(E=d.memoizedState,E!==null)return E.dehydrated!==null?(lr(Rr,Rr.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?r4(u,d,p):(lr(Rr,Rr.current&1),u=Ll(u,d,p),u!==null?u.sibling:null);lr(Rr,Rr.current&1);break;case 19:if(E=(p&d.childLanes)!==0,(u.flags&128)!==0){if(E)return s4(u,d,p);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),lr(Rr,Rr.current),E)break;return null;case 22:case 23:return d.lanes=0,QP(u,d,p)}return Ll(u,d,p)}var a4,D2,o4,l4;a4=function(u,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)u.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},D2=function(){},o4=function(u,d,p,E){var S=u.memoizedProps;if(S!==E){u=d.stateNode,uh(Go.current);var C=null;switch(p){case"input":S=Nt(u,S),E=Nt(u,E),C=[];break;case"select":S=be({},S,{value:void 0}),E=be({},E,{value:void 0}),C=[];break;case"textarea":S=li(u,S),E=li(u,E),C=[];break;default:typeof S.onClick!="function"&&typeof E.onClick=="function"&&(u.onclick=wy)}xe(p,E);var G;p=null;for(Re in S)if(!E.hasOwnProperty(Re)&&S.hasOwnProperty(Re)&&S[Re]!=null)if(Re==="style"){var ie=S[Re];for(G in ie)ie.hasOwnProperty(G)&&(p||(p={}),p[G]="")}else Re!=="dangerouslySetInnerHTML"&&Re!=="children"&&Re!=="suppressContentEditableWarning"&&Re!=="suppressHydrationWarning"&&Re!=="autoFocus"&&(i.hasOwnProperty(Re)?C||(C=[]):(C=C||[]).push(Re,null));for(Re in E){var ae=E[Re];if(ie=S?.[Re],E.hasOwnProperty(Re)&&ae!==ie&&(ae!=null||ie!=null))if(Re==="style")if(ie){for(G in ie)!ie.hasOwnProperty(G)||ae&&ae.hasOwnProperty(G)||(p||(p={}),p[G]="");for(G in ae)ae.hasOwnProperty(G)&&ie[G]!==ae[G]&&(p||(p={}),p[G]=ae[G])}else p||(C||(C=[]),C.push(Re,p)),p=ae;else Re==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ie=ie?ie.__html:void 0,ae!=null&&ie!==ae&&(C=C||[]).push(Re,ae)):Re==="children"?typeof ae!="string"&&typeof ae!="number"||(C=C||[]).push(Re,""+ae):Re!=="suppressContentEditableWarning"&&Re!=="suppressHydrationWarning"&&(i.hasOwnProperty(Re)?(ae!=null&&Re==="onScroll"&&hr("scroll",u),C||ie===ae||(C=[])):(C=C||[]).push(Re,ae))}p&&(C=C||[]).push("style",p);var Re=C;(d.updateQueue=Re)&&(d.flags|=4)}},l4=function(u,d,p,E){p!==E&&(d.flags|=4)};function Zg(u,d){if(!vr)switch(u.tailMode){case"hidden":d=u.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var E=null;p!==null;)p.alternate!==null&&(E=p),p=p.sibling;E===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:E.sibling=null}}function Qi(u){var d=u.alternate!==null&&u.alternate.child===u.child,p=0,E=0;if(d)for(var S=u.child;S!==null;)p|=S.lanes|S.childLanes,E|=S.subtreeFlags&14680064,E|=S.flags&14680064,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)p|=S.lanes|S.childLanes,E|=S.subtreeFlags,E|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=E,u.childLanes=p,d}function $z(u,d,p){var E=d.pendingProps;switch(i2(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qi(d),null;case 1:return Rs(d.type)&&Sy(),Qi(d),null;case 3:return E=d.stateNode,gf(),dr(As),dr(Yi),y2(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(u===null||u.child===null)&&(Iy(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Za!==null&&(K2(Za),Za=null))),D2(u,d),Qi(d),null;case 5:m2(d);var S=uh(Hg.current);if(p=d.type,u!==null&&d.stateNode!=null)o4(u,d,p,E,S),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!E){if(d.stateNode===null)throw Error(t(166));return Qi(d),null}if(u=uh(Go.current),Iy(d)){E=d.stateNode,p=d.type;var C=d.memoizedProps;switch(E[Bo]=d,E[Gg]=C,u=(d.mode&1)!==0,p){case"dialog":hr("cancel",E),hr("close",E);break;case"iframe":case"object":case"embed":hr("load",E);break;case"video":case"audio":for(S=0;S<jg.length;S++)hr(jg[S],E);break;case"source":hr("error",E);break;case"img":case"image":case"link":hr("error",E),hr("load",E);break;case"details":hr("toggle",E);break;case"input":ln(E,C),hr("invalid",E);break;case"select":E._wrapperState={wasMultiple:!!C.multiple},hr("invalid",E);break;case"textarea":Fn(E,C),hr("invalid",E)}xe(p,C),S=null;for(var G in C)if(C.hasOwnProperty(G)){var ie=C[G];G==="children"?typeof ie=="string"?E.textContent!==ie&&(C.suppressHydrationWarning!==!0&&vy(E.textContent,ie,u),S=["children",ie]):typeof ie=="number"&&E.textContent!==""+ie&&(C.suppressHydrationWarning!==!0&&vy(E.textContent,ie,u),S=["children",""+ie]):i.hasOwnProperty(G)&&ie!=null&&G==="onScroll"&&hr("scroll",E)}switch(p){case"input":Be(E),tr(E,C,!0);break;case"textarea":Be(E),fn(E);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(E.onclick=wy)}E=S,d.updateQueue=E,E!==null&&(d.flags|=4)}else{G=S.nodeType===9?S:S.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=ur(p)),u==="http://www.w3.org/1999/xhtml"?p==="script"?(u=G.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof E.is=="string"?u=G.createElement(p,{is:E.is}):(u=G.createElement(p),p==="select"&&(G=u,E.multiple?G.multiple=!0:E.size&&(G.size=E.size))):u=G.createElementNS(u,p),u[Bo]=d,u[Gg]=E,a4(u,d,!1,!1),d.stateNode=u;e:{switch(G=ye(p,E),p){case"dialog":hr("cancel",u),hr("close",u),S=E;break;case"iframe":case"object":case"embed":hr("load",u),S=E;break;case"video":case"audio":for(S=0;S<jg.length;S++)hr(jg[S],u);S=E;break;case"source":hr("error",u),S=E;break;case"img":case"image":case"link":hr("error",u),hr("load",u),S=E;break;case"details":hr("toggle",u),S=E;break;case"input":ln(u,E),S=Nt(u,E),hr("invalid",u);break;case"option":S=E;break;case"select":u._wrapperState={wasMultiple:!!E.multiple},S=be({},E,{value:void 0}),hr("invalid",u);break;case"textarea":Fn(u,E),S=li(u,E),hr("invalid",u);break;default:S=E}xe(p,S),ie=S;for(C in ie)if(ie.hasOwnProperty(C)){var ae=ie[C];C==="style"?xi(u,ae):C==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&Gt(u,ae)):C==="children"?typeof ae=="string"?(p!=="textarea"||ae!=="")&&Xr(u,ae):typeof ae=="number"&&Xr(u,""+ae):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(i.hasOwnProperty(C)?ae!=null&&C==="onScroll"&&hr("scroll",u):ae!=null&&A(u,C,ae,G))}switch(p){case"input":Be(u),tr(u,E,!1);break;case"textarea":Be(u),fn(u);break;case"option":E.value!=null&&u.setAttribute("value",""+Fe(E.value));break;case"select":u.multiple=!!E.multiple,C=E.value,C!=null?nr(u,!!E.multiple,C,!1):E.defaultValue!=null&&nr(u,!!E.multiple,E.defaultValue,!0);break;default:typeof S.onClick=="function"&&(u.onclick=wy)}switch(p){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break e;case"img":E=!0;break e;default:E=!1}}E&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Qi(d),null;case 6:if(u&&d.stateNode!=null)l4(u,d,u.memoizedProps,E);else{if(typeof E!="string"&&d.stateNode===null)throw Error(t(166));if(p=uh(Hg.current),uh(Go.current),Iy(d)){if(E=d.stateNode,p=d.memoizedProps,E[Bo]=d,(C=E.nodeValue!==p)&&(u=ea,u!==null))switch(u.tag){case 3:vy(E.nodeValue,p,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&vy(E.nodeValue,p,(u.mode&1)!==0)}C&&(d.flags|=4)}else E=(p.nodeType===9?p:p.ownerDocument).createTextNode(E),E[Bo]=d,d.stateNode=E}return Qi(d),null;case 13:if(dr(Rr),E=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(vr&&ta!==null&&(d.mode&1)!==0&&(d.flags&128)===0)hP(),uf(),d.flags|=98560,C=!1;else if(C=Iy(d),E!==null&&E.dehydrated!==null){if(u===null){if(!C)throw Error(t(318));if(C=d.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(t(317));C[Bo]=d}else uf(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Qi(d),C=!1}else Za!==null&&(K2(Za),Za=null),C=!0;if(!C)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(E=E!==null,E!==(u!==null&&u.memoizedState!==null)&&E&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(Rr.current&1)!==0?ui===0&&(ui=3):Y2())),d.updateQueue!==null&&(d.flags|=4),Qi(d),null);case 4:return gf(),D2(u,d),u===null&&Vg(d.stateNode.containerInfo),Qi(d),null;case 10:return u2(d.type._context),Qi(d),null;case 17:return Rs(d.type)&&Sy(),Qi(d),null;case 19:if(dr(Rr),C=d.memoizedState,C===null)return Qi(d),null;if(E=(d.flags&128)!==0,G=C.rendering,G===null)if(E)Zg(C,!1);else{if(ui!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(G=Ly(u),G!==null){for(d.flags|=128,Zg(C,!1),E=G.updateQueue,E!==null&&(d.updateQueue=E,d.flags|=4),d.subtreeFlags=0,E=p,p=d.child;p!==null;)C=p,u=E,C.flags&=14680066,G=C.alternate,G===null?(C.childLanes=0,C.lanes=u,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=G.childLanes,C.lanes=G.lanes,C.child=G.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=G.memoizedProps,C.memoizedState=G.memoizedState,C.updateQueue=G.updateQueue,C.type=G.type,u=G.dependencies,C.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),p=p.sibling;return lr(Rr,Rr.current&1|2),d.child}u=u.sibling}C.tail!==null&&Ye()>xf&&(d.flags|=128,E=!0,Zg(C,!1),d.lanes=4194304)}else{if(!E)if(u=Ly(G),u!==null){if(d.flags|=128,E=!0,p=u.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),Zg(C,!0),C.tail===null&&C.tailMode==="hidden"&&!G.alternate&&!vr)return Qi(d),null}else 2*Ye()-C.renderingStartTime>xf&&p!==1073741824&&(d.flags|=128,E=!0,Zg(C,!1),d.lanes=4194304);C.isBackwards?(G.sibling=d.child,d.child=G):(p=C.last,p!==null?p.sibling=G:d.child=G,C.last=G)}return C.tail!==null?(d=C.tail,C.rendering=d,C.tail=d.sibling,C.renderingStartTime=Ye(),d.sibling=null,p=Rr.current,lr(Rr,E?p&1|2:p&1),d):(Qi(d),null);case 22:case 23:return q2(),E=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==E&&(d.flags|=8192),E&&(d.mode&1)!==0?(na&1073741824)!==0&&(Qi(d),d.subtreeFlags&6&&(d.flags|=8192)):Qi(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function Wz(u,d){switch(i2(d),d.tag){case 1:return Rs(d.type)&&Sy(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return gf(),dr(As),dr(Yi),y2(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return m2(d),null;case 13:if(dr(Rr),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));uf()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return dr(Rr),null;case 4:return gf(),null;case 10:return u2(d.type._context),null;case 22:case 23:return q2(),null;case 24:return null;default:return null}}var Uy=!1,Ji=!1,Hz=typeof WeakSet=="function"?WeakSet:Set,wt=null;function pf(u,d){var p=u.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(E){Mr(u,d,E)}else p.current=null}function F2(u,d,p){try{p()}catch(E){Mr(u,d,E)}}var c4=!1;function Kz(u,d){if(qE=bl,u=Gk(),GE(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else e:{p=(p=u.ownerDocument)&&p.defaultView||window;var E=p.getSelection&&p.getSelection();if(E&&E.rangeCount!==0){p=E.anchorNode;var S=E.anchorOffset,C=E.focusNode;E=E.focusOffset;try{p.nodeType,C.nodeType}catch{p=null;break e}var G=0,ie=-1,ae=-1,Re=0,Ke=0,Ze=u,We=null;t:for(;;){for(var _t;Ze!==p||S!==0&&Ze.nodeType!==3||(ie=G+S),Ze!==C||E!==0&&Ze.nodeType!==3||(ae=G+E),Ze.nodeType===3&&(G+=Ze.nodeValue.length),(_t=Ze.firstChild)!==null;)We=Ze,Ze=_t;for(;;){if(Ze===u)break t;if(We===p&&++Re===S&&(ie=G),We===C&&++Ke===E&&(ae=G),(_t=Ze.nextSibling)!==null)break;Ze=We,We=Ze.parentNode}Ze=_t}p=ie===-1||ae===-1?null:{start:ie,end:ae}}else p=null}p=p||{start:0,end:0}}else p=null;for(YE={focusedElem:u,selectionRange:p},bl=!1,wt=d;wt!==null;)if(d=wt,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,wt=u;else for(;wt!==null;){d=wt;try{var St=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(St!==null){var It=St.memoizedProps,zr=St.memoizedState,ge=d.stateNode,oe=ge.getSnapshotBeforeUpdate(d.elementType===d.type?It:Qa(d.type,It),zr);ge.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var Ee=d.stateNode.containerInfo;Ee.nodeType===1?Ee.textContent="":Ee.nodeType===9&&Ee.documentElement&&Ee.removeChild(Ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(et){Mr(d,d.return,et)}if(u=d.sibling,u!==null){u.return=d.return,wt=u;break}wt=d.return}return St=c4,c4=!1,St}function Qg(u,d,p){var E=d.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var S=E=E.next;do{if((S.tag&u)===u){var C=S.destroy;S.destroy=void 0,C!==void 0&&F2(d,p,C)}S=S.next}while(S!==E)}}function $y(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&u)===u){var E=p.create;p.destroy=E()}p=p.next}while(p!==d)}}function j2(u){var d=u.ref;if(d!==null){var p=u.stateNode;switch(u.tag){case 5:u=p;break;default:u=p}typeof d=="function"?d(u):d.current=u}}function u4(u){var d=u.alternate;d!==null&&(u.alternate=null,u4(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[Bo],delete d[Gg],delete d[e2],delete d[Cz],delete d[kz])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function h4(u){return u.tag===5||u.tag===3||u.tag===4}function d4(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||h4(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function V2(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(u,d):p.insertBefore(u,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(u,p)):(d=p,d.appendChild(u)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=wy));else if(E!==4&&(u=u.child,u!==null))for(V2(u,d,p),u=u.sibling;u!==null;)V2(u,d,p),u=u.sibling}function B2(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.insertBefore(u,d):p.appendChild(u);else if(E!==4&&(u=u.child,u!==null))for(B2(u,d,p),u=u.sibling;u!==null;)B2(u,d,p),u=u.sibling}var Li=null,Ja=!1;function Dc(u,d,p){for(p=p.child;p!==null;)f4(u,d,p),p=p.sibling}function f4(u,d,p){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(qs,p)}catch{}switch(p.tag){case 5:Ji||pf(p,d);case 6:var E=Li,S=Ja;Li=null,Dc(u,d,p),Li=E,Ja=S,Li!==null&&(Ja?(u=Li,p=p.stateNode,u.nodeType===8?u.parentNode.removeChild(p):u.removeChild(p)):Li.removeChild(p.stateNode));break;case 18:Li!==null&&(Ja?(u=Li,p=p.stateNode,u.nodeType===8?JE(u.parentNode,p):u.nodeType===1&&JE(u,p),Ac(u)):JE(Li,p.stateNode));break;case 4:E=Li,S=Ja,Li=p.stateNode.containerInfo,Ja=!0,Dc(u,d,p),Li=E,Ja=S;break;case 0:case 11:case 14:case 15:if(!Ji&&(E=p.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){S=E=E.next;do{var C=S,G=C.destroy;C=C.tag,G!==void 0&&((C&2)!==0||(C&4)!==0)&&F2(p,d,G),S=S.next}while(S!==E)}Dc(u,d,p);break;case 1:if(!Ji&&(pf(p,d),E=p.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=p.memoizedProps,E.state=p.memoizedState,E.componentWillUnmount()}catch(ie){Mr(p,d,ie)}Dc(u,d,p);break;case 21:Dc(u,d,p);break;case 22:p.mode&1?(Ji=(E=Ji)||p.memoizedState!==null,Dc(u,d,p),Ji=E):Dc(u,d,p);break;default:Dc(u,d,p)}}function g4(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var p=u.stateNode;p===null&&(p=u.stateNode=new Hz),d.forEach(function(E){var S=nU.bind(null,u,E);p.has(E)||(p.add(E),E.then(S,S))})}}function eo(u,d){var p=d.deletions;if(p!==null)for(var E=0;E<p.length;E++){var S=p[E];try{var C=u,G=d,ie=G;e:for(;ie!==null;){switch(ie.tag){case 5:Li=ie.stateNode,Ja=!1;break e;case 3:Li=ie.stateNode.containerInfo,Ja=!0;break e;case 4:Li=ie.stateNode.containerInfo,Ja=!0;break e}ie=ie.return}if(Li===null)throw Error(t(160));f4(C,G,S),Li=null,Ja=!1;var ae=S.alternate;ae!==null&&(ae.return=null),S.return=null}catch(Re){Mr(S,d,Re)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)m4(d,u),d=d.sibling}function m4(u,d){var p=u.alternate,E=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(eo(d,u),Uo(u),E&4){try{Qg(3,u,u.return),$y(3,u)}catch(It){Mr(u,u.return,It)}try{Qg(5,u,u.return)}catch(It){Mr(u,u.return,It)}}break;case 1:eo(d,u),Uo(u),E&512&&p!==null&&pf(p,p.return);break;case 5:if(eo(d,u),Uo(u),E&512&&p!==null&&pf(p,p.return),u.flags&32){var S=u.stateNode;try{Xr(S,"")}catch(It){Mr(u,u.return,It)}}if(E&4&&(S=u.stateNode,S!=null)){var C=u.memoizedProps,G=p!==null?p.memoizedProps:C,ie=u.type,ae=u.updateQueue;if(u.updateQueue=null,ae!==null)try{ie==="input"&&C.type==="radio"&&C.name!=null&&rn(S,C),ye(ie,G);var Re=ye(ie,C);for(G=0;G<ae.length;G+=2){var Ke=ae[G],Ze=ae[G+1];Ke==="style"?xi(S,Ze):Ke==="dangerouslySetInnerHTML"?Gt(S,Ze):Ke==="children"?Xr(S,Ze):A(S,Ke,Ze,Re)}switch(ie){case"input":ut(S,C);break;case"textarea":dt(S,C);break;case"select":var We=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!C.multiple;var _t=C.value;_t!=null?nr(S,!!C.multiple,_t,!1):We!==!!C.multiple&&(C.defaultValue!=null?nr(S,!!C.multiple,C.defaultValue,!0):nr(S,!!C.multiple,C.multiple?[]:"",!1))}S[Gg]=C}catch(It){Mr(u,u.return,It)}}break;case 6:if(eo(d,u),Uo(u),E&4){if(u.stateNode===null)throw Error(t(162));S=u.stateNode,C=u.memoizedProps;try{S.nodeValue=C}catch(It){Mr(u,u.return,It)}}break;case 3:if(eo(d,u),Uo(u),E&4&&p!==null&&p.memoizedState.isDehydrated)try{Ac(d.containerInfo)}catch(It){Mr(u,u.return,It)}break;case 4:eo(d,u),Uo(u);break;case 13:eo(d,u),Uo(u),S=u.child,S.flags&8192&&(C=S.memoizedState!==null,S.stateNode.isHidden=C,!C||S.alternate!==null&&S.alternate.memoizedState!==null||(U2=Ye())),E&4&&g4(u);break;case 22:if(Ke=p!==null&&p.memoizedState!==null,u.mode&1?(Ji=(Re=Ji)||Ke,eo(d,u),Ji=Re):eo(d,u),Uo(u),E&8192){if(Re=u.memoizedState!==null,(u.stateNode.isHidden=Re)&&!Ke&&(u.mode&1)!==0)for(wt=u,Ke=u.child;Ke!==null;){for(Ze=wt=Ke;wt!==null;){switch(We=wt,_t=We.child,We.tag){case 0:case 11:case 14:case 15:Qg(4,We,We.return);break;case 1:pf(We,We.return);var St=We.stateNode;if(typeof St.componentWillUnmount=="function"){E=We,p=We.return;try{d=E,St.props=d.memoizedProps,St.state=d.memoizedState,St.componentWillUnmount()}catch(It){Mr(E,p,It)}}break;case 5:pf(We,We.return);break;case 22:if(We.memoizedState!==null){x4(Ze);continue}}_t!==null?(_t.return=We,wt=_t):x4(Ze)}Ke=Ke.sibling}e:for(Ke=null,Ze=u;;){if(Ze.tag===5){if(Ke===null){Ke=Ze;try{S=Ze.stateNode,Re?(C=S.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(ie=Ze.stateNode,ae=Ze.memoizedProps.style,G=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,ie.style.display=Qt("display",G))}catch(It){Mr(u,u.return,It)}}}else if(Ze.tag===6){if(Ke===null)try{Ze.stateNode.nodeValue=Re?"":Ze.memoizedProps}catch(It){Mr(u,u.return,It)}}else if((Ze.tag!==22&&Ze.tag!==23||Ze.memoizedState===null||Ze===u)&&Ze.child!==null){Ze.child.return=Ze,Ze=Ze.child;continue}if(Ze===u)break e;for(;Ze.sibling===null;){if(Ze.return===null||Ze.return===u)break e;Ke===Ze&&(Ke=null),Ze=Ze.return}Ke===Ze&&(Ke=null),Ze.sibling.return=Ze.return,Ze=Ze.sibling}}break;case 19:eo(d,u),Uo(u),E&4&&g4(u);break;case 21:break;default:eo(d,u),Uo(u)}}function Uo(u){var d=u.flags;if(d&2){try{e:{for(var p=u.return;p!==null;){if(h4(p)){var E=p;break e}p=p.return}throw Error(t(160))}switch(E.tag){case 5:var S=E.stateNode;E.flags&32&&(Xr(S,""),E.flags&=-33);var C=d4(u);B2(u,C,S);break;case 3:case 4:var G=E.stateNode.containerInfo,ie=d4(u);V2(u,ie,G);break;default:throw Error(t(161))}}catch(ae){Mr(u,u.return,ae)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function Xz(u,d,p){wt=u,p4(u)}function p4(u,d,p){for(var E=(u.mode&1)!==0;wt!==null;){var S=wt,C=S.child;if(S.tag===22&&E){var G=S.memoizedState!==null||Uy;if(!G){var ie=S.alternate,ae=ie!==null&&ie.memoizedState!==null||Ji;ie=Uy;var Re=Ji;if(Uy=G,(Ji=ae)&&!Re)for(wt=S;wt!==null;)G=wt,ae=G.child,G.tag===22&&G.memoizedState!==null?_4(S):ae!==null?(ae.return=G,wt=ae):_4(S);for(;C!==null;)wt=C,p4(C),C=C.sibling;wt=S,Uy=ie,Ji=Re}y4(u)}else(S.subtreeFlags&8772)!==0&&C!==null?(C.return=S,wt=C):y4(u)}}function y4(u){for(;wt!==null;){var d=wt;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Ji||$y(5,d);break;case 1:var E=d.stateNode;if(d.flags&4&&!Ji)if(p===null)E.componentDidMount();else{var S=d.elementType===d.type?p.memoizedProps:Qa(d.type,p.memoizedProps);E.componentDidUpdate(S,p.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var C=d.updateQueue;C!==null&&xP(d,C,E);break;case 3:var G=d.updateQueue;if(G!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}xP(d,G,p)}break;case 5:var ie=d.stateNode;if(p===null&&d.flags&4){p=ie;var ae=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&p.focus();break;case"img":ae.src&&(p.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Re=d.alternate;if(Re!==null){var Ke=Re.memoizedState;if(Ke!==null){var Ze=Ke.dehydrated;Ze!==null&&Ac(Ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ji||d.flags&512&&j2(d)}catch(We){Mr(d,d.return,We)}}if(d===u){wt=null;break}if(p=d.sibling,p!==null){p.return=d.return,wt=p;break}wt=d.return}}function x4(u){for(;wt!==null;){var d=wt;if(d===u){wt=null;break}var p=d.sibling;if(p!==null){p.return=d.return,wt=p;break}wt=d.return}}function _4(u){for(;wt!==null;){var d=wt;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{$y(4,d)}catch(ae){Mr(d,p,ae)}break;case 1:var E=d.stateNode;if(typeof E.componentDidMount=="function"){var S=d.return;try{E.componentDidMount()}catch(ae){Mr(d,S,ae)}}var C=d.return;try{j2(d)}catch(ae){Mr(d,C,ae)}break;case 5:var G=d.return;try{j2(d)}catch(ae){Mr(d,G,ae)}}}catch(ae){Mr(d,d.return,ae)}if(d===u){wt=null;break}var ie=d.sibling;if(ie!==null){ie.return=d.return,wt=ie;break}wt=d.return}}var qz=Math.ceil,Wy=M.ReactCurrentDispatcher,G2=M.ReactCurrentOwner,Ta=M.ReactCurrentBatchConfig,Sn=0,vi=null,Yr=null,Oi=0,na=0,yf=Pc(0),ui=0,Jg=null,dh=0,Hy=0,z2=0,em=null,Cs=null,U2=0,xf=1/0,Ol=null,Ky=!1,$2=null,Fc=null,Xy=!1,jc=null,qy=0,tm=0,W2=null,Yy=-1,Zy=0;function ps(){return(Sn&6)!==0?Ye():Yy!==-1?Yy:Yy=Ye()}function Vc(u){return(u.mode&1)===0?1:(Sn&2)!==0&&Oi!==0?Oi&-Oi:Mz.transition!==null?(Zy===0&&(Zy=Eg()),Zy):(u=vn,u!==0||(u=window.event,u=u===void 0?16:Hd(u.type)),u)}function to(u,d,p,E){if(50<tm)throw tm=0,W2=null,Error(t(185));eh(u,p,E),((Sn&2)===0||u!==vi)&&(u===vi&&((Sn&2)===0&&(Hy|=p),ui===4&&Bc(u,Oi)),ks(u,E),p===1&&Sn===0&&(d.mode&1)===0&&(xf=Ye()+500,by&&Nc()))}function ks(u,d){var p=u.callbackNode;Ju(u,d);var E=El(u,u===vi?Oi:0);if(E===0)p!==null&&nt(p),u.callbackNode=null,u.callbackPriority=0;else if(d=E&-E,u.callbackPriority!==d){if(p!=null&&nt(p),d===1)u.tag===0?Pz(w4.bind(null,u)):aP(w4.bind(null,u)),Rz(function(){(Sn&6)===0&&Nc()}),p=null;else{switch(ko(E)){case 1:p=jn;break;case 4:p=Un;break;case 16:p=_r;break;case 536870912:p=xa;break;default:p=_r}p=C4(p,v4.bind(null,u))}u.callbackPriority=d,u.callbackNode=p}}function v4(u,d){if(Yy=-1,Zy=0,(Sn&6)!==0)throw Error(t(327));var p=u.callbackNode;if(_f()&&u.callbackNode!==p)return null;var E=El(u,u===vi?Oi:0);if(E===0)return null;if((E&30)!==0||(E&u.expiredLanes)!==0||d)d=Qy(u,E);else{d=E;var S=Sn;Sn|=2;var C=S4();(vi!==u||Oi!==d)&&(Ol=null,xf=Ye()+500,gh(u,d));do try{Qz();break}catch(ie){E4(u,ie)}while(!0);c2(),Wy.current=C,Sn=S,Yr!==null?d=0:(vi=null,Oi=0,d=ui)}if(d!==0){if(d===2&&(S=wg(u),S!==0&&(E=S,d=H2(u,S))),d===1)throw p=Jg,gh(u,0),Bc(u,E),ks(u,Ye()),p;if(d===6)Bc(u,E);else{if(S=u.current.alternate,(E&30)===0&&!Yz(S)&&(d=Qy(u,E),d===2&&(C=wg(u),C!==0&&(E=C,d=H2(u,C))),d===1))throw p=Jg,gh(u,0),Bc(u,E),ks(u,Ye()),p;switch(u.finishedWork=S,u.finishedLanes=E,d){case 0:case 1:throw Error(t(345));case 2:mh(u,Cs,Ol);break;case 3:if(Bc(u,E),(E&130023424)===E&&(d=U2+500-Ye(),10<d)){if(El(u,0)!==0)break;if(S=u.suspendedLanes,(S&E)!==E){ps(),u.pingedLanes|=u.suspendedLanes&S;break}u.timeoutHandle=QE(mh.bind(null,u,Cs,Ol),d);break}mh(u,Cs,Ol);break;case 4:if(Bc(u,E),(E&4194240)===E)break;for(d=u.eventTimes,S=-1;0<E;){var G=31-Ar(E);C=1<<G,G=d[G],G>S&&(S=G),E&=~C}if(E=S,E=Ye()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*qz(E/1960))-E,10<E){u.timeoutHandle=QE(mh.bind(null,u,Cs,Ol),E);break}mh(u,Cs,Ol);break;case 5:mh(u,Cs,Ol);break;default:throw Error(t(329))}}}return ks(u,Ye()),u.callbackNode===p?v4.bind(null,u):null}function H2(u,d){var p=em;return u.current.memoizedState.isDehydrated&&(gh(u,d).flags|=256),u=Qy(u,d),u!==2&&(d=Cs,Cs=p,d!==null&&K2(d)),u}function K2(u){Cs===null?Cs=u:Cs.push.apply(Cs,u)}function Yz(u){for(var d=u;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var E=0;E<p.length;E++){var S=p[E],C=S.getSnapshot;S=S.value;try{if(!Ya(C(),S))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Bc(u,d){for(d&=~z2,d&=~Hy,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var p=31-Ar(d),E=1<<p;u[p]=-1,d&=~E}}function w4(u){if((Sn&6)!==0)throw Error(t(327));_f();var d=El(u,0);if((d&1)===0)return ks(u,Ye()),null;var p=Qy(u,d);if(u.tag!==0&&p===2){var E=wg(u);E!==0&&(d=E,p=H2(u,E))}if(p===1)throw p=Jg,gh(u,0),Bc(u,d),ks(u,Ye()),p;if(p===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,mh(u,Cs,Ol),ks(u,Ye()),null}function X2(u,d){var p=Sn;Sn|=1;try{return u(d)}finally{Sn=p,Sn===0&&(xf=Ye()+500,by&&Nc())}}function fh(u){jc!==null&&jc.tag===0&&(Sn&6)===0&&_f();var d=Sn;Sn|=1;var p=Ta.transition,E=vn;try{if(Ta.transition=null,vn=1,u)return u()}finally{vn=E,Ta.transition=p,Sn=d,(Sn&6)===0&&Nc()}}function q2(){na=yf.current,dr(yf)}function gh(u,d){u.finishedWork=null,u.finishedLanes=0;var p=u.timeoutHandle;if(p!==-1&&(u.timeoutHandle=-1,Az(p)),Yr!==null)for(p=Yr.return;p!==null;){var E=p;switch(i2(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&Sy();break;case 3:gf(),dr(As),dr(Yi),y2();break;case 5:m2(E);break;case 4:gf();break;case 13:dr(Rr);break;case 19:dr(Rr);break;case 10:u2(E.type._context);break;case 22:case 23:q2()}p=p.return}if(vi=u,Yr=u=Gc(u.current,null),Oi=na=d,ui=0,Jg=null,z2=Hy=dh=0,Cs=em=null,ch!==null){for(d=0;d<ch.length;d++)if(p=ch[d],E=p.interleaved,E!==null){p.interleaved=null;var S=E.next,C=p.pending;if(C!==null){var G=C.next;C.next=S,E.next=G}p.pending=E}ch=null}return u}function E4(u,d){do{var p=Yr;try{if(c2(),Oy.current=Vy,Dy){for(var E=Ir.memoizedState;E!==null;){var S=E.queue;S!==null&&(S.pending=null),E=E.next}Dy=!1}if(hh=0,_i=ci=Ir=null,Kg=!1,Xg=0,G2.current=null,p===null||p.return===null){ui=1,Jg=d,Yr=null;break}e:{var C=u,G=p.return,ie=p,ae=d;if(d=Oi,ie.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Re=ae,Ke=ie,Ze=Ke.tag;if((Ke.mode&1)===0&&(Ze===0||Ze===11||Ze===15)){var We=Ke.alternate;We?(Ke.updateQueue=We.updateQueue,Ke.memoizedState=We.memoizedState,Ke.lanes=We.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var _t=KP(G);if(_t!==null){_t.flags&=-257,XP(_t,G,ie,C,d),_t.mode&1&&HP(C,Re,d),d=_t,ae=Re;var St=d.updateQueue;if(St===null){var It=new Set;It.add(ae),d.updateQueue=It}else St.add(ae);break e}else{if((d&1)===0){HP(C,Re,d),Y2();break e}ae=Error(t(426))}}else if(vr&&ie.mode&1){var zr=KP(G);if(zr!==null){(zr.flags&65536)===0&&(zr.flags|=256),XP(zr,G,ie,C,d),o2(mf(ae,ie));break e}}C=ae=mf(ae,ie),ui!==4&&(ui=2),em===null?em=[C]:em.push(C),C=G;do{switch(C.tag){case 3:C.flags|=65536,d&=-d,C.lanes|=d;var ge=$P(C,ae,d);yP(C,ge);break e;case 1:ie=ae;var oe=C.type,Ee=C.stateNode;if((C.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||Ee!==null&&typeof Ee.componentDidCatch=="function"&&(Fc===null||!Fc.has(Ee)))){C.flags|=65536,d&=-d,C.lanes|=d;var et=WP(C,ie,d);yP(C,et);break e}}C=C.return}while(C!==null)}b4(p)}catch(Pt){d=Pt,Yr===p&&p!==null&&(Yr=p=p.return);continue}break}while(!0)}function S4(){var u=Wy.current;return Wy.current=Vy,u===null?Vy:u}function Y2(){(ui===0||ui===3||ui===2)&&(ui=4),vi===null||(dh&268435455)===0&&(Hy&268435455)===0||Bc(vi,Oi)}function Qy(u,d){var p=Sn;Sn|=2;var E=S4();(vi!==u||Oi!==d)&&(Ol=null,gh(u,d));do try{Zz();break}catch(S){E4(u,S)}while(!0);if(c2(),Sn=p,Wy.current=E,Yr!==null)throw Error(t(261));return vi=null,Oi=0,ui}function Zz(){for(;Yr!==null;)T4(Yr)}function Qz(){for(;Yr!==null&&!pt();)T4(Yr)}function T4(u){var d=I4(u.alternate,u,na);u.memoizedProps=u.pendingProps,d===null?b4(u):Yr=d,G2.current=null}function b4(u){var d=u;do{var p=d.alternate;if(u=d.return,(d.flags&32768)===0){if(p=$z(p,d,na),p!==null){Yr=p;return}}else{if(p=Wz(p,d),p!==null){p.flags&=32767,Yr=p;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{ui=6,Yr=null;return}}if(d=d.sibling,d!==null){Yr=d;return}Yr=d=u}while(d!==null);ui===0&&(ui=5)}function mh(u,d,p){var E=vn,S=Ta.transition;try{Ta.transition=null,vn=1,Jz(u,d,p,E)}finally{Ta.transition=S,vn=E}return null}function Jz(u,d,p,E){do _f();while(jc!==null);if((Sn&6)!==0)throw Error(t(327));p=u.finishedWork;var S=u.finishedLanes;if(p===null)return null;if(u.finishedWork=null,u.finishedLanes=0,p===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var C=p.lanes|p.childLanes;if(DE(u,C),u===vi&&(Yr=vi=null,Oi=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Xy||(Xy=!0,C4(_r,function(){return _f(),null})),C=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||C){C=Ta.transition,Ta.transition=null;var G=vn;vn=1;var ie=Sn;Sn|=4,G2.current=null,Kz(u,p),m4(p,u),_z(YE),bl=!!qE,YE=qE=null,u.current=p,Xz(p),qe(),Sn=ie,vn=G,Ta.transition=C}else u.current=p;if(Xy&&(Xy=!1,jc=u,qy=S),C=u.pendingLanes,C===0&&(Fc=null),Ec(p.stateNode),ks(u,Ye()),d!==null)for(E=u.onRecoverableError,p=0;p<d.length;p++)S=d[p],E(S.value,{componentStack:S.stack,digest:S.digest});if(Ky)throw Ky=!1,u=$2,$2=null,u;return(qy&1)!==0&&u.tag!==0&&_f(),C=u.pendingLanes,(C&1)!==0?u===W2?tm++:(tm=0,W2=u):tm=0,Nc(),null}function _f(){if(jc!==null){var u=ko(qy),d=Ta.transition,p=vn;try{if(Ta.transition=null,vn=16>u?16:u,jc===null)var E=!1;else{if(u=jc,jc=null,qy=0,(Sn&6)!==0)throw Error(t(331));var S=Sn;for(Sn|=4,wt=u.current;wt!==null;){var C=wt,G=C.child;if((wt.flags&16)!==0){var ie=C.deletions;if(ie!==null){for(var ae=0;ae<ie.length;ae++){var Re=ie[ae];for(wt=Re;wt!==null;){var Ke=wt;switch(Ke.tag){case 0:case 11:case 15:Qg(8,Ke,C)}var Ze=Ke.child;if(Ze!==null)Ze.return=Ke,wt=Ze;else for(;wt!==null;){Ke=wt;var We=Ke.sibling,_t=Ke.return;if(u4(Ke),Ke===Re){wt=null;break}if(We!==null){We.return=_t,wt=We;break}wt=_t}}}var St=C.alternate;if(St!==null){var It=St.child;if(It!==null){St.child=null;do{var zr=It.sibling;It.sibling=null,It=zr}while(It!==null)}}wt=C}}if((C.subtreeFlags&2064)!==0&&G!==null)G.return=C,wt=G;else e:for(;wt!==null;){if(C=wt,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:Qg(9,C,C.return)}var ge=C.sibling;if(ge!==null){ge.return=C.return,wt=ge;break e}wt=C.return}}var oe=u.current;for(wt=oe;wt!==null;){G=wt;var Ee=G.child;if((G.subtreeFlags&2064)!==0&&Ee!==null)Ee.return=G,wt=Ee;else e:for(G=oe;wt!==null;){if(ie=wt,(ie.flags&2048)!==0)try{switch(ie.tag){case 0:case 11:case 15:$y(9,ie)}}catch(Pt){Mr(ie,ie.return,Pt)}if(ie===G){wt=null;break e}var et=ie.sibling;if(et!==null){et.return=ie.return,wt=et;break e}wt=ie.return}}if(Sn=S,Nc(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(qs,u)}catch{}E=!0}return E}finally{vn=p,Ta.transition=d}}return!1}function A4(u,d,p){d=mf(p,d),d=$P(u,d,1),u=Oc(u,d,1),d=ps(),u!==null&&(eh(u,1,d),ks(u,d))}function Mr(u,d,p){if(u.tag===3)A4(u,u,p);else for(;d!==null;){if(d.tag===3){A4(d,u,p);break}else if(d.tag===1){var E=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Fc===null||!Fc.has(E))){u=mf(p,u),u=WP(d,u,1),d=Oc(d,u,1),u=ps(),d!==null&&(eh(d,1,u),ks(d,u));break}}d=d.return}}function eU(u,d,p){var E=u.pingCache;E!==null&&E.delete(d),d=ps(),u.pingedLanes|=u.suspendedLanes&p,vi===u&&(Oi&p)===p&&(ui===4||ui===3&&(Oi&130023424)===Oi&&500>Ye()-U2?gh(u,0):z2|=p),ks(u,d)}function R4(u,d){d===0&&((u.mode&1)===0?d=1:(d=Sc,Sc<<=1,(Sc&130023424)===0&&(Sc=4194304)));var p=ps();u=Ml(u,d),u!==null&&(eh(u,d,p),ks(u,p))}function tU(u){var d=u.memoizedState,p=0;d!==null&&(p=d.retryLane),R4(u,p)}function nU(u,d){var p=0;switch(u.tag){case 13:var E=u.stateNode,S=u.memoizedState;S!==null&&(p=S.retryLane);break;case 19:E=u.stateNode;break;default:throw Error(t(314))}E!==null&&E.delete(d),R4(u,p)}var I4;I4=function(u,d,p){if(u!==null)if(u.memoizedProps!==d.pendingProps||As.current)Is=!0;else{if((u.lanes&p)===0&&(d.flags&128)===0)return Is=!1,Uz(u,d,p);Is=(u.flags&131072)!==0}else Is=!1,vr&&(d.flags&1048576)!==0&&oP(d,Ry,d.index);switch(d.lanes=0,d.tag){case 2:var E=d.type;zy(u,d),u=d.pendingProps;var S=of(d,Yi.current);ff(d,p),S=v2(null,d,E,u,S,p);var C=w2();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,Rs(E)?(C=!0,Ty(d)):C=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,f2(d),S.updater=By,d.stateNode=S,S._reactInternals=d,R2(d,E,u,p),d=P2(null,d,E,!0,C,p)):(d.tag=0,vr&&C&&r2(d),ms(null,d,S,p),d=d.child),d;case 16:E=d.elementType;e:{switch(zy(u,d),u=d.pendingProps,S=E._init,E=S(E._payload),d.type=E,S=d.tag=iU(E),u=Qa(E,u),S){case 0:d=k2(null,d,E,u,p);break e;case 1:d=e4(null,d,E,u,p);break e;case 11:d=qP(null,d,E,u,p);break e;case 14:d=YP(null,d,E,Qa(E.type,u),p);break e}throw Error(t(306,E,""))}return d;case 0:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Qa(E,S),k2(u,d,E,S,p);case 1:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Qa(E,S),e4(u,d,E,S,p);case 3:e:{if(t4(d),u===null)throw Error(t(387));E=d.pendingProps,C=d.memoizedState,S=C.element,pP(u,d),Ny(d,E,null,p);var G=d.memoizedState;if(E=G.element,C.isDehydrated)if(C={element:E,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},d.updateQueue.baseState=C,d.memoizedState=C,d.flags&256){S=mf(Error(t(423)),d),d=n4(u,d,E,p,S);break e}else if(E!==S){S=mf(Error(t(424)),d),d=n4(u,d,E,p,S);break e}else for(ta=kc(d.stateNode.containerInfo.firstChild),ea=d,vr=!0,Za=null,p=gP(d,null,E,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(uf(),E===S){d=Ll(u,d,p);break e}ms(u,d,E,p)}d=d.child}return d;case 5:return _P(d),u===null&&a2(d),E=d.type,S=d.pendingProps,C=u!==null?u.memoizedProps:null,G=S.children,ZE(E,S)?G=null:C!==null&&ZE(E,C)&&(d.flags|=32),JP(u,d),ms(u,d,G,p),d.child;case 6:return u===null&&a2(d),null;case 13:return r4(u,d,p);case 4:return g2(d,d.stateNode.containerInfo),E=d.pendingProps,u===null?d.child=hf(d,null,E,p):ms(u,d,E,p),d.child;case 11:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Qa(E,S),qP(u,d,E,S,p);case 7:return ms(u,d,d.pendingProps,p),d.child;case 8:return ms(u,d,d.pendingProps.children,p),d.child;case 12:return ms(u,d,d.pendingProps.children,p),d.child;case 10:e:{if(E=d.type._context,S=d.pendingProps,C=d.memoizedProps,G=S.value,lr(ky,E._currentValue),E._currentValue=G,C!==null)if(Ya(C.value,G)){if(C.children===S.children&&!As.current){d=Ll(u,d,p);break e}}else for(C=d.child,C!==null&&(C.return=d);C!==null;){var ie=C.dependencies;if(ie!==null){G=C.child;for(var ae=ie.firstContext;ae!==null;){if(ae.context===E){if(C.tag===1){ae=Nl(-1,p&-p),ae.tag=2;var Re=C.updateQueue;if(Re!==null){Re=Re.shared;var Ke=Re.pending;Ke===null?ae.next=ae:(ae.next=Ke.next,Ke.next=ae),Re.pending=ae}}C.lanes|=p,ae=C.alternate,ae!==null&&(ae.lanes|=p),h2(C.return,p,d),ie.lanes|=p;break}ae=ae.next}}else if(C.tag===10)G=C.type===d.type?null:C.child;else if(C.tag===18){if(G=C.return,G===null)throw Error(t(341));G.lanes|=p,ie=G.alternate,ie!==null&&(ie.lanes|=p),h2(G,p,d),G=C.sibling}else G=C.child;if(G!==null)G.return=C;else for(G=C;G!==null;){if(G===d){G=null;break}if(C=G.sibling,C!==null){C.return=G.return,G=C;break}G=G.return}C=G}ms(u,d,S.children,p),d=d.child}return d;case 9:return S=d.type,E=d.pendingProps.children,ff(d,p),S=Ea(S),E=E(S),d.flags|=1,ms(u,d,E,p),d.child;case 14:return E=d.type,S=Qa(E,d.pendingProps),S=Qa(E.type,S),YP(u,d,E,S,p);case 15:return ZP(u,d,d.type,d.pendingProps,p);case 17:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:Qa(E,S),zy(u,d),d.tag=1,Rs(E)?(u=!0,Ty(d)):u=!1,ff(d,p),zP(d,E,S),R2(d,E,S,p),P2(null,d,E,!0,u,p);case 19:return s4(u,d,p);case 22:return QP(u,d,p)}throw Error(t(156,d.tag))};function C4(u,d){return Xe(u,d)}function rU(u,d,p,E){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ba(u,d,p,E){return new rU(u,d,p,E)}function Z2(u){return u=u.prototype,!(!u||!u.isReactComponent)}function iU(u){if(typeof u=="function")return Z2(u)?1:0;if(u!=null){if(u=u.$$typeof,u===B)return 11;if(u===ke)return 14}return 2}function Gc(u,d){var p=u.alternate;return p===null?(p=ba(u.tag,d,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=d,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&14680064,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,d=u.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p}function Jy(u,d,p,E,S,C){var G=2;if(E=u,typeof u=="function")Z2(u)&&(G=1);else if(typeof u=="string")G=5;else e:switch(u){case I:return ph(p.children,S,C,d);case R:G=8,S|=8;break;case P:return u=ba(12,p,d,S|2),u.elementType=P,u.lanes=C,u;case j:return u=ba(13,p,d,S),u.elementType=j,u.lanes=C,u;case ve:return u=ba(19,p,d,S),u.elementType=ve,u.lanes=C,u;case Me:return ex(p,S,C,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case F:G=10;break e;case N:G=9;break e;case B:G=11;break e;case ke:G=14;break e;case Ve:G=16,E=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=ba(G,p,d,S),d.elementType=u,d.type=E,d.lanes=C,d}function ph(u,d,p,E){return u=ba(7,u,E,d),u.lanes=p,u}function ex(u,d,p,E){return u=ba(22,u,E,d),u.elementType=Me,u.lanes=p,u.stateNode={isHidden:!1},u}function Q2(u,d,p){return u=ba(6,u,null,d),u.lanes=p,u}function J2(u,d,p){return d=ba(4,u.children!==null?u.children:[],u.key,d),d.lanes=p,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function sU(u,d,p,E,S){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sg(0),this.expirationTimes=Sg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sg(0),this.identifierPrefix=E,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function eS(u,d,p,E,S,C,G,ie,ae){return u=new sU(u,d,p,ie,ae),d===1?(d=1,C===!0&&(d|=8)):d=0,C=ba(3,null,null,d),u.current=C,C.stateNode=u,C.memoizedState={element:E,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},f2(C),u}function aU(u,d,p){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:E==null?null:""+E,children:u,containerInfo:d,implementation:p}}function k4(u){if(!u)return Mc;u=u._reactInternals;e:{if(te(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(Rs(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var p=u.type;if(Rs(p))return iP(u,p,d)}return d}function P4(u,d,p,E,S,C,G,ie,ae){return u=eS(p,E,!0,u,S,C,G,ie,ae),u.context=k4(null),p=u.current,E=ps(),S=Vc(p),C=Nl(E,S),C.callback=d??null,Oc(p,C,S),u.current.lanes=S,eh(u,S,E),ks(u,E),u}function tx(u,d,p,E){var S=d.current,C=ps(),G=Vc(S);return p=k4(p),d.context===null?d.context=p:d.pendingContext=p,d=Nl(C,G),d.payload={element:u},E=E===void 0?null:E,E!==null&&(d.callback=E),u=Oc(S,d,G),u!==null&&(to(u,S,G,C),My(u,S,G)),G}function nx(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function M4(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<d?p:d}}function tS(u,d){M4(u,d),(u=u.alternate)&&M4(u,d)}function oU(){return null}var N4=typeof reportError=="function"?reportError:function(u){console.error(u)};function nS(u){this._internalRoot=u}rx.prototype.render=nS.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));tx(u,d,null,null)},rx.prototype.unmount=nS.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;fh(function(){tx(null,u,null,null)}),d[Il]=null}};function rx(u){this._internalRoot=u}rx.prototype.unstable_scheduleHydration=function(u){if(u){var d=Rg();u={blockedOn:null,target:u,priority:d};for(var p=0;p<Ys.length&&d!==0&&d<Ys[p].priority;p++);Ys.splice(p,0,u),p===0&&$d(u)}};function rS(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function ix(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function L4(){}function lU(u,d,p,E,S){if(S){if(typeof E=="function"){var C=E;E=function(){var Re=nx(G);C.call(Re)}}var G=P4(d,E,u,0,null,!1,!1,"",L4);return u._reactRootContainer=G,u[Il]=G.current,Vg(u.nodeType===8?u.parentNode:u),fh(),G}for(;S=u.lastChild;)u.removeChild(S);if(typeof E=="function"){var ie=E;E=function(){var Re=nx(ae);ie.call(Re)}}var ae=eS(u,0,!1,null,null,!1,!1,"",L4);return u._reactRootContainer=ae,u[Il]=ae.current,Vg(u.nodeType===8?u.parentNode:u),fh(function(){tx(d,ae,p,E)}),ae}function sx(u,d,p,E,S){var C=p._reactRootContainer;if(C){var G=C;if(typeof S=="function"){var ie=S;S=function(){var ae=nx(G);ie.call(ae)}}tx(d,G,u,S)}else G=lU(p,d,u,S,E);return nx(G)}bg=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var p=Pn(d.pendingLanes);p!==0&&(Tg(d,p|1),ks(d,Ye()),(Sn&6)===0&&(xf=Ye()+500,Nc()))}break;case 13:fh(function(){var E=Ml(u,1);if(E!==null){var S=ps();to(E,u,1,S)}}),tS(u,1)}},zd=function(u){if(u.tag===13){var d=Ml(u,134217728);if(d!==null){var p=ps();to(d,u,134217728,p)}tS(u,134217728)}},Ag=function(u){if(u.tag===13){var d=Vc(u),p=Ml(u,d);if(p!==null){var E=ps();to(p,u,d,E)}tS(u,d)}},Rg=function(){return vn},Ig=function(u,d){var p=vn;try{return vn=u,d()}finally{vn=p}},kt=function(u,d,p){switch(d){case"input":if(ut(u,p),d=p.name,p.type==="radio"&&d!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var E=p[d];if(E!==u&&E.form===u.form){var S=Ey(E);if(!S)throw Error(t(90));Rt(E),ut(E,S)}}}break;case"textarea":dt(u,p);break;case"select":d=p.value,d!=null&&nr(u,!!p.multiple,d,!1)}},$e=X2,De=fh;var cU={usingClientEntryPoint:!1,Events:[zg,sf,Ey,fe,ce,X2]},nm={findFiberByHostInstance:sh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uU={bundleType:nm.bundleType,version:nm.version,rendererPackageName:nm.rendererPackageName,rendererConfig:nm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Se(u),u===null?null:u.stateNode},findFiberByHostInstance:nm.findFiberByHostInstance||oU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ax=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ax.isDisabled&&ax.supportsFiber)try{qs=ax.inject(uU),Br=ax}catch{}}return Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cU,Ps.createPortal=function(u,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rS(d))throw Error(t(200));return aU(u,d,null,p)},Ps.createRoot=function(u,d){if(!rS(u))throw Error(t(299));var p=!1,E="",S=N4;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(E=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=eS(u,1,!1,null,null,p,!1,E,S),u[Il]=d.current,Vg(u.nodeType===8?u.parentNode:u),new nS(d)},Ps.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Se(d),u=u===null?null:u.stateNode,u},Ps.flushSync=function(u){return fh(u)},Ps.hydrate=function(u,d,p){if(!ix(d))throw Error(t(200));return sx(null,u,d,!0,p)},Ps.hydrateRoot=function(u,d,p){if(!rS(u))throw Error(t(405));var E=p!=null&&p.hydratedSources||null,S=!1,C="",G=N4;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(C=p.identifierPrefix),p.onRecoverableError!==void 0&&(G=p.onRecoverableError)),d=P4(d,null,u,1,p??null,S,!1,C,G),u[Il]=d.current,Vg(u),E)for(u=0;u<E.length;u++)p=E[u],S=p._getVersion,S=S(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,S]:d.mutableSourceEagerHydrationData.push(p,S);return new rx(d)},Ps.render=function(u,d,p){if(!ix(d))throw Error(t(200));return sx(null,u,d,!1,p)},Ps.unmountComponentAtNode=function(u){if(!ix(u))throw Error(t(40));return u._reactRootContainer?(fh(function(){sx(null,null,u,!1,function(){u._reactRootContainer=null,u[Il]=null})}),!0):!1},Ps.unstable_batchedUpdates=X2,Ps.unstable_renderSubtreeIntoContainer=function(u,d,p,E){if(!ix(p))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return sx(u,d,p,!1,E)},Ps.version="18.3.1-next-f1338f8080-20240426",Ps}var z4;function xU(){if(z4)return aS.exports;z4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),aS.exports=yU(),aS.exports}var U4;function _U(){if(U4)return ox;U4=1;var n=xU();return ox.createRoot=n.createRoot,ox.hydrateRoot=n.hydrateRoot,ox}var vU=_U();const wU=$A(vU);var X=c1();const EU=$A(X),Ls={ADD:"add",REMOVE:"remove"},I0={PROPERTYCHANGE:"propertychange"},Jt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class u1{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function SU(n,e,t){let r,i;t=t||Xl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Xl(n,e){return n>e?1:n<e?-1:0}function TU(n,e){return n<e?1:n>e?-1:0}function hw(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function bU(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Vn(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function fc(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function AU(n,e,t){const r=e||Xl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function gp(){return!0}function dw(){return!1}function mp(){}function hD(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!fc(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function dD(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function rg(n){for(const e in n)delete n[e]}function td(n){let e;for(e in n)return!1;return!e}class pl{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let h1=class extends u1{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new pl(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let c=0,h=i.length;c<h;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let c=o[r];for(delete o[r];c--;)this.removeEventListener(r,mp);delete a[r]}return l}disposeInternal(){this.listeners_&&rg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=mp,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function mn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function b_(n,e,t,r){return mn(n,e,t,r,!0)}function ir(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),rg(n))}class d1 extends h1{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Jt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=mn(this,e[s],t);return i}return mn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=b_(this,e[s],t)}else r=b_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)RU(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}d1.prototype.on;d1.prototype.once;d1.prototype.un;function RU(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)ir(n[e]);else ir(n)}function Wt(){throw new Error("Unimplemented abstract method.")}let IU=0;function $t(n){return n.ol_uid||(n.ol_uid=String(++IU))}class $4 extends pl{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class yl extends d1{constructor(e){super(),this.on,this.once,this.un,$t(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new $4(r,e,t)),r=I0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new $4(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],td(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const W4={LENGTH:"length"};class lx extends pl{constructor(e,t,r){super(e),this.element=t,this.index=r}}class Na extends yl{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(W4.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new lx(Ls.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new lx(Ls.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new lx(Ls.REMOVE,i,e)),this.dispatchEvent(new lx(Ls.ADD,t,e))}updateLength_(){this.set(W4.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function En(n,e){if(!n)throw new Error(e)}let gr=class fD extends yl{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new fD(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ir(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=mn(e,Jt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?CU(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function CU(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(En(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const Ei={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function H4(n){const e=zs();for(let t=0,r=n.length;t<r;++t)Om(e,n[t]);return e}function C0(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function gD(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function bd(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function nd(n,e){return WA(n,e[0],e[1])}function lu(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function WA(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function KT(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=Ei.UNKNOWN;return a<t?l=l|Ei.LEFT:a>i&&(l=l|Ei.RIGHT),o<r?l=l|Ei.BELOW:o>s&&(l=l|Ei.ABOVE),l===Ei.UNKNOWN&&(l=Ei.INTERSECTING),l}function zs(){return[1/0,1/0,-1/0,-1/0]}function Cu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function f1(n){return Cu(1/0,1/0,-1/0,-1/0,n)}function mD(n,e){const t=n[0],r=n[1];return Cu(t,r,t,r,e)}function HA(n,e,t,r,i){const s=f1(i);return yD(s,n,e,t,r)}function rd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function pD(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Om(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function yD(n,e,t,r,i){for(;t<r;t+=i)kU(n,e[t],e[t+1]);return n}function kU(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function xD(n,e){let t;return t=e(fw(n)),t||(t=e(gw(n)),t)||(t=e(mw(n)),t)||(t=e(Ad(n)),t)?t:!1}function XT(n){let e=0;return ig(n)||(e=pn(n)*ti(n)),e}function fw(n){return[n[0],n[1]]}function gw(n){return[n[2],n[1]]}function ul(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function PU(n,e){let t;if(e==="bottom-left")t=fw(n);else if(e==="bottom-right")t=gw(n);else if(e==="top-left")t=Ad(n);else if(e==="top-right")t=mw(n);else throw new Error("Invalid corner");return t}function A_(n,e,t,r,i){const[s,a,o,l,c,h,g,m]=_D(n,e,t,r);return Cu(Math.min(s,o,c,g),Math.min(a,l,h,m),Math.max(s,o,c,g),Math.max(a,l,h,m),i)}function _D(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,c=i*o,h=s*a,g=s*o,m=n[0],y=n[1];return[m-l+g,y-c-h,m-l-g,y-c+h,m+l-g,y+c+h,m+l+g,y+c-h,m-l+g,y-c-h]}function ti(n){return n[3]-n[1]}function ql(n,e,t){const r=t||zs();return _s(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):f1(r),r}function Ad(n){return[n[0],n[3]]}function mw(n){return[n[2],n[3]]}function pn(n){return n[2]-n[0]}function _s(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function ig(n){return n[2]<n[0]||n[3]<n[1]}function MU(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function NU(n,e,t){let r=!1;const i=KT(n,e),s=KT(n,t);if(i===Ei.INTERSECTING||s===Ei.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],c=n[3],h=e[0],g=e[1],m=t[0],y=t[1],v=(y-g)/(m-h);let x,w;s&Ei.ABOVE&&!(i&Ei.ABOVE)&&(x=m-(y-c)/v,r=x>=a&&x<=l),!r&&s&Ei.RIGHT&&!(i&Ei.RIGHT)&&(w=y-(m-l)*v,r=w>=o&&w<=c),!r&&s&Ei.BELOW&&!(i&Ei.BELOW)&&(x=m-(y-o)/v,r=x>=a&&x<=l),!r&&s&Ei.LEFT&&!(i&Ei.LEFT)&&(w=y-(m-a)*v,r=w>=o&&w<=c)}return r}function vD(n,e){const t=e.getExtent(),r=ul(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=pn(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function wD(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];vD(n,e);const i=pn(r);if(pn(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function cr(n,e,t){return Math.min(Math.max(n,e),t)}function LU(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return Hh(n,e,t,r)}function Hh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function OU(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let c=r;c<e+1;c++)r==c?n[o][c]=0:n[o][c]+=l*n[r][c]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function K4(n){return n*180/Math.PI}function Yl(n){return n*Math.PI/180}function vu(n,e){const t=n%e;return t*e<0?t+e:t}function oa(n,e,t){return n+t*(e-n)}function g1(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function R_(n,e){return Math.round(g1(n,e))}function cx(n,e){return Math.floor(g1(n,e))}function cu(n,e){return Math.ceil(g1(n,e))}function qT(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function im(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function ED(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function DU(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function I_(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function KA(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function FU(n,e){return n[0]*=e,n[1]*=e,n}function SD(n,e){if(e.canWrapX()){const t=pn(e.getExtent()),r=TD(n,e,t);r&&(n[0]-=r*t)}return n}function TD(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||pn(r),i=Math.floor((n[0]-r[0])/t)),i}function bD(...n){console.warn(...n)}const k0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let pw=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||k0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const m1=6378137,Jf=Math.PI*m1,jU=[-Jf,-Jf,Jf,Jf],VU=[-180,-85,180,85],ux=m1*Math.log(Math.tan(Math.PI/2));class vf extends pw{constructor(e){super({code:e,units:"m",extent:jU,global:!0,worldExtent:VU,getPointResolution:function(t,r){return t/Math.cosh(r[1]/m1)}})}}const X4=[new vf("EPSG:3857"),new vf("EPSG:102100"),new vf("EPSG:102113"),new vf("EPSG:900913"),new vf("http://www.opengis.net/def/crs/EPSG/0/3857"),new vf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function BU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=Jf*n[s]/180;let a=m1*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>ux?a=ux:a<-ux&&(a=-ux),e[s+1]=a}return e}function GU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/Jf,e[s+1]=360*Math.atan(Math.exp(n[s+1]/m1))/Math.PI-90;return e}const zU=6378137,q4=[-180,-90,180,90],UU=Math.PI*zU/180;class yh extends pw{constructor(e,t){super({code:e,units:"degrees",extent:q4,axisOrientation:t,global:!0,metersPerUnit:UU,worldExtent:q4})}}const Y4=[new yh("CRS:84"),new yh("EPSG:4326","neu"),new yh("urn:ogc:def:crs:OGC:1.3:CRS84"),new yh("urn:ogc:def:crs:OGC:2:84"),new yh("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new yh("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new yh("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let YT={};function Yx(n){return YT[n]||YT[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function $U(n,e){YT[n]=e}let h0={};function id(n,e,t){const r=n.getCode(),i=e.getCode();r in h0||(h0[r]={}),h0[r][i]=t}function Zx(n,e){return n in h0&&e in h0[n]?h0[n][e]:null}const C_=.9996,Fa=.00669438,yw=Fa*Fa,xw=yw*Fa,Dh=Fa/(1-Fa),Z4=Math.sqrt(1-Fa),P0=(1-Z4)/(1+Z4),AD=P0*P0,XA=AD*P0,qA=XA*P0,RD=qA*P0,ID=1-Fa/4-3*yw/64-5*xw/256,WU=3*Fa/8+3*yw/32+45*xw/1024,HU=15*yw/256+45*xw/1024,KU=35*xw/3072,XU=3/2*P0-27/32*XA+269/512*RD,qU=21/16*AD-55/32*qA,YU=151/96*XA-417/128*RD,ZU=1097/512*qA,k_=6378137;function QU(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/C_/(k_*ID),o=a+XU*Math.sin(2*a)+qU*Math.sin(4*a)+YU*Math.sin(6*a)+ZU*Math.sin(8*a),l=Math.sin(o),c=l*l,h=Math.cos(o),g=l/h,m=g*g,y=m*m,v=1-Fa*c,x=Math.sqrt(1-Fa*c),w=k_/x,T=(1-Fa)/v,b=Dh*h**2,A=b*b,M=r/(w*C_),O=M*M,z=O*M,I=z*M,R=I*M,P=R*M,F=o-g/T*(O/2-I/24*(5+3*m+10*b-4*A-9*Dh))+P/720*(61+90*m+298*b+45*y-252*Dh-3*A);let N=(M-z/6*(1+2*m+b)+R/120*(5-2*b+28*m-3*A+8*Dh+24*y))/h;return N=qT(N+Yl(CD(t.number)),-Math.PI,Math.PI),[K4(N),K4(F)]}const Q4=-80,J4=84,JU=-180,e$=180;function t$(n,e,t){n=qT(n,JU,e$),e<Q4?e=Q4:e>J4&&(e=J4);const r=Yl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,c=Yl(n),h=CD(t.number),g=Yl(h),m=k_/Math.sqrt(1-Fa*i**2),y=Dh*s**2,v=s*qT(c-g,-Math.PI,Math.PI),x=v*v,w=x*v,T=w*v,b=T*v,A=b*v,M=k_*(ID*r-WU*Math.sin(2*r)+HU*Math.sin(4*r)-KU*Math.sin(6*r)),O=C_*m*(v+w/6*(1-o+y)+b/120*(5-18*o+l+72*y-58*Dh))+5e5;let z=C_*(M+m*a*(x/2+T/24*(5-o+9*y+4*y**2)+A/720*(61-58*o+l+600*y-330*Dh)));return t.north||(z+=1e7),[O,z]}function CD(n){return(n-1)*6-180+3}const n$=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function kD(n){let e=0;for(const i of n$){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function eM(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],c=t[o+1],h=n(l,c,e);r[o]=h[0],r[o+1]=h[1]}return r}}function r$(n){return kD(n)?new pw({code:n,units:"m"}):null}function i$(n){const e=kD(n.getCode());return e?{forward:eM(t$,e),inverse:eM(QU,e)}:null}const s$=63710088e-1;function tM(n,e,t){t=t||s$;const r=Yl(n[1]),i=Yl(e[1]),s=(i-r)/2,a=Yl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const a$=[i$],o$=[r$];let ZT=!0;function PD(n){ZT=!1}function YA(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function P_(n){$U(n.getCode(),n),id(n,n,YA)}function l$(n){n.forEach(P_)}function er(n){if(typeof n!="string")return n;const e=Yx(n);if(e)return e;for(const t of o$){const r=t(n);if(r)return r}return null}function M_(n,e,t,r){n=er(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/k0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=QA(n,er("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=o(c,c,2);const h=tM(c.slice(0,2),c.slice(2,4)),g=tM(c.slice(4,6),c.slice(6,8));i=(h+g)/2}const l=r?k0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function QT(n){l$(n),n.forEach(function(e){n.forEach(function(t){e!==t&&id(e,t,YA)})})}function c$(n,e,t,r){n.forEach(function(i){e.forEach(function(s){id(i,s,t),id(s,i,r)})})}function ZA(n,e){return n?typeof n=="string"?er(n):n:er(e)}function JT(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let c=0,h=i;c<h;++c)t[a+c]=c>=l?e[a+c]:o[c]}return t})}function u$(n,e,t,r){const i=er(n),s=er(e);id(i,s,JT(t)),id(s,i,JT(r))}function fr(n,e){return PD(),p1(n,"EPSG:4326","EPSG:3857")}function Tn(n,e){const t=p1(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=vu(r+180,360)-180),t}function Kh(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||QA(n,e)===YA)&&t}function QA(n,e){const t=n.getCode(),r=e.getCode();let i=Zx(t,r);if(i)return i;let s=null,a=null;for(const l of a$)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=cS(s.inverse,a.forward);else{const l=Zx(t,o);l&&(i=cS(l,a.forward))}else{const l=Zx(o,r);l&&(i=cS(s.inverse,l))}return i&&(P_(n),P_(e),id(n,e,i)),i}function cS(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function pp(n,e){const t=er(n),r=er(e);return QA(t,r)}function p1(n,e,t){const r=pp(e,t);if(!r){const i=er(e).getCode(),s=er(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function eb(n,e){return n}function Vl(n,e){return ZT&&!I_(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(ZT=!1,bD("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function MD(n,e){return n}function Zo(n,e){return n}function nM(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=pn(a);r=r.slice(0),s=TD(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=cr(r[0],a[0],a[2]),r[1]=cr(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*pn(e.getExtent())),i}}function h$(){QT(X4),QT(Y4),c$(Y4,X4,BU,GU)}h$();const d$=new Array(6);function mi(){return[1,0,0,1,0,0]}function ND(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=n[4],o=n[5],l=e[0],c=e[1],h=e[2],g=e[3],m=e[4],y=e[5];return n[0]=t*l+i*c,n[1]=r*l+s*c,n[2]=t*h+i*g,n[3]=r*h+s*g,n[4]=t*m+i*y+a,n[5]=r*m+s*y+o,n}function f$(n,e,t,r,i,s,a){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=a,n}function LD(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Dr(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function g$(n,e,t){return ND(n,f$(d$,1,0,0,1,e,t))}function Ga(n,e,t,r,i,s,a,o){const l=Math.sin(s),c=Math.cos(s);return n[0]=r*c,n[1]=i*l,n[2]=-r*l,n[3]=i*c,n[4]=a*r*c-o*r*l+e,n[5]=a*i*l+o*i*c+t,n}function yp(n,e){const t=m$(e);En(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function m$(n){return n[0]*n[3]-n[1]*n[2]}const p$=[1e5,1e5,1e5,1e5,2,2];function y$(n){return"matrix("+n.join(", ")+")"}function tb(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function x$(n,e){const t=tb(n),r=tb(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*p$[i])!==0)return!1;return!0}function tl(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const c=n[l],h=n[l+1];s[o++]=i[0]*c+i[2]*h+i[4],s[o++]=i[1]*c+i[3]*h+i[5];for(let g=2;g<a;g++)s[o++]=n[l+g]}return s&&s.length!=o&&(s.length=o),s}function OD(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),c=s[0],h=s[1];let g=0;for(let m=e;m<t;m+=r){const y=n[m]-c,v=n[m+1]-h;a[g++]=c+y*o-v*l,a[g++]=h+y*l+v*o;for(let x=m+2;x<m+r;++x)a[g++]=n[x]}return a&&a.length!=g&&(a.length=g),a}function _$(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],c=a[1];let h=0;for(let g=e;g<t;g+=r){const m=n[g]-l,y=n[g+1]-c;o[h++]=l+i*m,o[h++]=c+s*y;for(let v=g+2;v<g+r;++v)o[h++]=n[v]}return o&&o.length!=h&&(o.length=h),o}function v$(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let c=l+2;c<l+r;++c)a[o++]=n[c]}return a&&a.length!=o&&(a.length=o),a}const rM=mi(),w$=[NaN,NaN];class DD extends yl{constructor(){super(),this.extent_=zs(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=hD((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Wt()}closestPointXY(e,t,r,i){return Wt()}containsXY(e,t){return this.closestPointXY(e,t,w$,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Wt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&f1(t),this.extentRevision_=this.getRevision()}return MU(this.extent_,e)}rotate(e,t){Wt()}scale(e,t,r){Wt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Wt()}getType(){return Wt()}applyTransform(e){Wt()}intersectsExtent(e){return Wt()}translate(e,t){Wt()}transform(e,t){const r=er(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),c=r.getWorldExtent(),h=ti(c)/ti(l);Ga(rM,c[0],c[3],h,-h,0,0,0);const g=tl(s,0,s.length,o,rM,a),m=pp(r,t);return m?m(g,g,o):g}:pp(r,t);return this.applyTransform(i),this}}class Rd extends DD{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return HA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Wt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=iM(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Wt()}setLayout(e,t,r){let i;if(e)i=iM(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=Id(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();OD(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=ul(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();_$(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();v$(r,0,r.length,i,e,t,r),this.changed()}}}function Id(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function iM(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function E$(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return tl(r,0,r.length,i,e,t)}function sM(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],c=n[t]-o,h=n[t+1]-l;let g;if(c===0&&h===0)g=e;else{const m=((i-o)*c+(s-l)*h)/(c*c+h*h);if(m>1)g=t;else if(m>0){for(let y=0;y<r;++y)a[y]=oa(n[e+y],n[t+y],m);a.length=r;return}else g=e}for(let m=0;m<r;++m)a[m]=n[g+m];a.length=r}function JA(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],c=Hh(s,a,o,l);c>i&&(i=c),s=o,a=l}return i}function eR(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=JA(n,e,o,r,i),e=o}return i}function S$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=eR(n,e,o,r,i),e=o[o.length-1]}return i}function tR(n,e,t,r,i,s,a,o,l,c,h){if(e==t)return c;let g,m;if(i===0){if(m=Hh(a,o,n[e],n[e+1]),m<c){for(g=0;g<r;++g)l[g]=n[e+g];return l.length=r,m}return c}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(sM(n,y-r,y,r,a,o,h),m=Hh(a,o,h[0],h[1]),m<c){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(m)-Math.sqrt(c))/i|0,1);if(s&&(sM(n,t-r,e,r,a,o,h),m=Hh(a,o,h[0],h[1]),m<c)){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r}return c}function nR(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];c=tR(n,e,y,r,i,s,a,o,l,c,h),e=y}return c}function T$(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];c=nR(n,e,y,r,i,s,a,o,l,c,h),e=y[y.length-1]}return c}function b$(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function _w(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function y1(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=_w(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function FD(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=y1(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function uu(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function xp(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=uu(n,e,l,r,i[s]),e=l}return i.length=s,i}function nb(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:xp(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function N_(n,e,t,r,i,s,a){let o,l;const c=(t-e)/r;if(c===1)o=e;else if(c===2)o=e,l=i;else if(c!==0){let h=n[e],g=n[e+1],m=0;const y=[0];for(let w=e+r;w<t;w+=r){const T=n[w],b=n[w+1];m+=Math.sqrt((T-h)*(T-h)+(b-g)*(b-g)),y.push(m),h=T,g=b}const v=i*m,x=SU(y,v);x<0?(l=(v-y[-x-2])/(y[-x-1]-y[-x-2]),o=e+(-x-2)*r):o=e+x*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:oa(n[o+h],n[o+r+h],l);return s}function rb(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const m=o+l>>1;i<n[(m+1)*r-1]?l=m:o=m+1}const c=n[o*r-1];if(i==c)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],g=(i-c)/(h-c);a=[];for(let m=0;m<r-1;++m)a.push(oa(n[(o-1)*r+m],n[o*r+m],g));return a.push(i),a}function A$(n,e,t,r,i,s,a){if(a)return rb(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,c=t.length;l<c;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return rb(n,e,h,r,i,!1);e=h}}return null}function R$(n,e,t,r,i){return!xD(i,function(a){return!Fh(n,e,t,r,a[0],a[1])})}function Fh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const c=n[e],h=n[e+1];l<=s?h>s&&(c-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(c-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=c,l=h}return a!==0}function rR(n,e,t,r,i,s){if(t.length===0||!Fh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(Fh(n,t[a-1],t[a],r,i,s))return!1;return!0}function I$(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(rR(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function jD(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function vw(n,e,t,r,i,s){return s=s??yD(zs(),n,e,t,r),_s(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:jD(n,e,t,r,function(a,o){return NU(i,a,o)}):!1}function C$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(vw(n,e,t[s],r,i))return!0;e=t[s]}return!1}function VD(n,e,t,r,i){return!!(vw(n,e,t,r,i)||Fh(n,e,t,r,i[0],i[1])||Fh(n,e,t,r,i[0],i[3])||Fh(n,e,t,r,i[2],i[1])||Fh(n,e,t,r,i[2],i[3]))}function BD(n,e,t,r,i){if(!VD(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(R$(n,t[s-1],t[s],r,i)&&!vw(n,t[s-1],t[s],r,i))return!1;return!0}function k$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(BD(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function iR(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],c=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return a}function ww(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const c=[e,t-r];let h=0;for(;c.length>0;){const g=c.pop(),m=c.pop();let y=0;const v=n[m],x=n[m+1],w=n[g],T=n[g+1];for(let b=m+r;b<g;b+=r){const A=n[b],M=n[b+1],O=LU(A,M,v,x,w,T);O>y&&(h=b,y=O)}y>i&&(l[(h-e)/r]=1,m+r<h&&c.push(m,h),h+r<g&&c.push(h,g))}for(let g=0;g<o;++g)l[g]&&(s[a++]=n[e+g*r],s[a++]=n[e+g*r+1]);return a}function GD(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=ww(n,e,h,r,i,s,a),o.push(a),e=h}return a}function wh(n,e){return e*Math.round(n/e)}function P$(n,e,t,r,i,s,a){if(e==t)return a;let o=wh(n[e],i),l=wh(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let c,h;do if(c=wh(n[e],i),h=wh(n[e+1],i),e+=r,e==t)return s[a++]=c,s[a++]=h,a;while(c==o&&h==l);for(;e<t;){const g=wh(n[e],i),m=wh(n[e+1],i);if(e+=r,g==c&&m==h)continue;const y=c-o,v=h-l,x=g-o,w=m-l;if(y*w==v*x&&(y<0&&x<y||y==x||y>0&&x>y)&&(v<0&&w<v||v==w||v>0&&w>v)){c=g,h=m;continue}s[a++]=c,s[a++]=h,o=c,l=h,c=g,h=m}return s[a++]=c,s[a++]=h,a}function sR(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=P$(n,e,h,r,i,s,a),o.push(a),e=h}return a}function M$(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l],g=[];a=sR(n,e,h,r,i,s,a,g),o.push(g),e=h[h.length-1]}return a}class bi extends Rd{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Vn(this.flatCoordinates,e),this.changed()}clone(){const e=new bi(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(JA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),tR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return jD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,rb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return uu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return N_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return iR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new bi(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return vw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_w(this.flatCoordinates,0,e,this.stride),this.changed()}}let ri=class zD extends Rd{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new zD(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=Hh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return mD(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return WA(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=b$(this.flatCoordinates,0,e,this.stride),this.changed()}};const Ti={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},sd=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",N$=sd.includes("safari")&&!sd.includes("chrom"),L$=N$&&(sd.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(sd)),O$=sd.includes("webkit")&&!sd.includes("edge"),UD=sd.includes("macintosh"),D$=typeof devicePixelRatio<"u"?devicePixelRatio:1,ha=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,aR=typeof Image<"u"&&Image.prototype.decode,$D=typeof createImageBitmap=="function",WD=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Et={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ii(n,e,t,r){let i;return t&&t.length?i=t.shift():ha?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let uS;function L_(){return uS||(uS=ii(1,1)),uS}function Ew(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function aM(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function F$(n){for(;n.lastChild;)n.lastChild.remove()}function j$(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function HD(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function hu(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const oR=[NaN,NaN,NaN,0];let hS;function V$(){return hS||(hS=ii(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),hS}const B$=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,G$=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,z$=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,U$=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function hx(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Dm(n){throw new Error('failed to parse "'+n+'" as color')}function KD(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(G$)||n.match(B$)||n.match(z$);if(s){const a=s[4],o=100/255;return[cr(hx(s[1],o)+.5|0,0,255),cr(hx(s[2],o)+.5|0,0,255),cr(hx(s[3],o)+.5|0,0,255),a!==void 0?cr(hx(a,100),0,1):1]}Dm(n)}if(n.startsWith("#")){if(U$.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}Dm(n)}const e=V$();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Dm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return KD(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=g1(i[3]/255,3),i}function $$(n){return typeof n=="string"?n:cR(n)}const W$=1024,sm={};let dS=0;function H$(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function fS(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function gS(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function mS(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function pS(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function oM(n){const e=mS(n[0]),t=mS(n[1]),r=mS(n[2]),i=pS(e*.222488403+t*.716873169+r*.06060791),s=500*(pS(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-pS(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function K$(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=gS(e),s=gS(e+t/500*Math.cos(r)),a=gS(e-t/200*Math.sin(r)),o=fS(s*3.021973625-i*1.617392459-a*.404875592),l=fS(s*-.943766287+i*1.916279586+a*.027607165),c=fS(s*.069407491-i*.22898585+a*1.159737864);return[cr(o+.5|0,0,255),cr(l+.5|0,0,255),cr(c+.5|0,0,255),n[3]]}function lR(n){if(n==="none")return oR;if(sm.hasOwnProperty(n))return sm[n];if(dS>=W$){let t=0;for(const r in sm)(t++&3)===0&&(delete sm[r],--dS)}const e=KD(n);e.length!==4&&Dm(n);for(const t of e)isNaN(t)&&Dm(n);return sm[n]=e,++dS,e}function za(n){return Array.isArray(n)?n:lR(n)}function cR(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class XD extends h1{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?Et.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Jt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Et.IDLE&&this.loader){this.state=Et.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;dD(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||$D&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=Et.LOADED}).catch(r=>{this.state=Et.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function X$(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[b_(r,Jt.LOAD,function(){a=!0,s||e()})];return r.src&&aR?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(b_(r,Jt.ERROR,t)),function(){i=!1,o.forEach(ir)}}function q$(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function qD(n,e){return e&&(n.src=e),n.src&&aR?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):q$(n)}function YD(n,e){return e&&(n.src=e),n.src&&aR&&$D?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):qD(n)}class Y${constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=yS(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=yS(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=yS(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===Et.IDLE&&i.load(),i.getImageState()===Et.LOADING?i.ready().then(()=>{this.patternCache_[a]=L_().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=L_().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function yS(n,e,t){const r=t?za(t):"null";return e+":"+n+":"+r}const La=new Y$;let am=null;class ZD extends h1{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?Et.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Et.LOADED){am||(am=ii(1,1,void 0,{willReadFrequently:!0})),am.drawImage(this.image_,0,0);try{am.getImageData(0,0,1,1),this.tainted_=!1}catch{am=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Jt.CHANGE)}handleImageError_(){this.imageState_=Et.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Et.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=ii(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Et.IDLE){this.image_||this.initializeImage_(),this.imageState_=Et.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&qD(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Et.LOADED)return;const t=this.image_,r=ii(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=$$(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Et.LOADED||this.imageState_===Et.ERROR)e();else{const t=()=>{(this.imageState_===Et.LOADED||this.imageState_===Et.ERROR)&&(this.removeEventListener(Jt.CHANGE,t),e())};this.addEventListener(Jt.CHANGE,t)}})),this.ready_}}function O_(n,e,t,r,i,s){let a=e===void 0?void 0:La.get(e,t,i);return a||(a=new ZD(n,n&&"src"in n?n.src||void 0:e,t,r,i),La.set(e,t,i,a,s)),s&&a&&!La.getPattern(e,t,i)&&La.set(e,t,i,a,s),a}function Qo(n){return n?Array.isArray(n)?cR(n):typeof n=="object"&&"src"in n?Z$(n):n:null}function Z$(n){if(!n.offset||!n.size)return La.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=La.getPattern(e,void 0,n.color);if(t)return t;const r=La.get(n.src,"anonymous",null);if(r.getImageState()!==Et.LOADED)return null;const i=ii(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),O_(i.canvas,e,void 0,Et.LOADED,n.color,!0),La.getPattern(e,void 0,n.color)}class QD{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const dx="ol-hidden",x1="ol-unselectable",uR="ol-control",lM="ol-collapsed",Q$=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),cM=["style","variant","weight","size","lineHeight","family"],ib={normal:400,bold:700},sb=function(n){const e=n.match(Q$);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=cM.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[cM[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in ib&&(t.weight=ib[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},JD="10px sans-serif",Os="#000",M0="round",Zl=[],Ql=0,N0="round",_p=10,vp="#000",wp="center",D_="middle",jh=[0,0,0,0],Ep=1,Vf=new yl;let om=null,uM;const ab={},J$=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function eW(n,e,t){return`${n} ${e} 16px "${t}"`}const tW=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=sb(s),l=o.families[0].toLowerCase(),c=o.weight;return a.some(h=>{const g=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=ib[h.weight]||h.weight;return g===l&&h.style===o.style&&m==c})}async function i(){await t.ready;let s=!0;const a=Vf.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const c=o[l];let h=a[c];h<100&&(await r(c)?(rg(ab),Vf.set(c,100)):(h+=10,Vf.set(c,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=ha?self.fonts:document.fonts);const a=sb(s);if(!a)return;const o=a.families;let l=!1;for(const c of o){if(J$.has(c))continue;const h=eW(a.style,a.weight,c);Vf.get(h)===void 0&&(Vf.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),nW=(function(){let n;return function(e){let t=ab[e];if(t==null){if(ha){const r=sb(e),i=eF(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);ab[e]=t}return t}})();function eF(n,e){return om||(om=ii(1,1)),n!=uM&&(om.font=n,uM=om.font),om.measureText(e)}function tF(n,e){return eF(n,e).width}function hM(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,tF(n,s)),0);return t[e]=r,r}function rW(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const g=e[c];if(g===`
`||c===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const m=e[c+1]||n.font,y=tF(m,g);t.push(y),a+=y;const v=nW(m);r.push(v),l=Math.max(l,v)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function iW(n,e,t,r,i,s,a,o,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),sW(r,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,c,a*h[0],o*h[1]),n.restore()}function sW(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class aW extends QD{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?g1(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=mi()}drawImages_(e,t,r,i){if(!this.image_)return;const s=tl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,g=s.length;h<g;h+=2){const m=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=m+this.imageAnchorX_,x=y+this.imageAnchorY_;Ga(o,v,x,1,1,c,-v,-x),a.save(),a.transform.apply(a,o),a.translate(v,x),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=tl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,c-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,c),this.textFillState_&&a.fillText(this.text_,l,c))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=tl(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let c=2;c<l;c+=2)a.lineTo(o[c],o[c+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=E$(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(_s(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,c=a.length;l<c;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const c=s[o];i=this.drawRings_(r,i,c,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),fc(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:wp;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Qo(r||Os)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||Zl;this.strokeState_={lineCap:i!==void 0?i:M0,lineDash:this.pixelRatio_===1?h:h.map(g=>g*this.pixelRatio_),lineDashOffset:(a||Ql)*this.pixelRatio_,lineJoin:o!==void 0?o:N0,lineWidth:(l!==void 0?l:Ep)*this.pixelRatio_,miterLimit:c!==void 0?c:_p,strokeStyle:Qo(r||vp)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Qo(y||Os)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),v=r.getLineCap(),x=r.getLineDash(),w=r.getLineDashOffset(),T=r.getLineJoin(),b=r.getWidth(),A=r.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:M0,lineDash:x||Zl,lineDashOffset:w||Ql,lineJoin:T!==void 0?T:N0,lineWidth:b!==void 0?b:Ep,miterLimit:A!==void 0?A:_p,strokeStyle:Qo(y||vp)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:i!==void 0?i:JD,textAlign:g!==void 0?g:wp,textBaseline:m!==void 0?m:D_},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,v,x)=>y+=x%2?" ":v,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const oW=.5,nF={Point:mW,LineString:dW,Polygon:yW,MultiPoint:pW,MultiLineString:fW,MultiPolygon:gW,GeometryCollection:hW,Circle:cW};function lW(n,e){return parseInt($t(n),10)-parseInt($t(e),10)}function dM(n,e){const t=rF(n,e);return t*t}function rF(n,e){return oW*n/e}function cW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function fM(n,e,t,r,i,s,a,o){const l=[],c=t.getImage();if(c){let m=!0;const y=c.getImageState();y==Et.LOADED||y==Et.ERROR?m=!1:y==Et.IDLE&&c.load(),m&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const g=l.length>0;return g&&Promise.all(l).then(()=>i(null)),uW(n,e,t,r,s,a,o),g}function uW(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())iF(n,l,t,e,a);else{const h=nF[l.getType()];h(n,l,t,e,a,s)}}function iF(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)iF(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function hW(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const c=nF[a[o].getType()];c(n,a[o],t,r,i,s)}}function dW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function fW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function gW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function mW(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),c=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=Et.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,c),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,c),h.drawText(e,r,i)}}function pW(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(a.getImageState()!=Et.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(a,h),g.drawMultiPoint(e,r,i)}if(c){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(l,h),g.drawText(e,r,i)}}function yW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let xW=!1;function _W(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=xW,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=o.responseText:c=="xml"?h=o.responseXML||o.responseText:c=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function gM(n,e){return function(t,r,i,s,a){_W(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function vW(n,e){return[[-1/0,-1/0,1/0,1/0]]}function sF(n,e,t,r){const i=[];let s=zs();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=HA(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function hR(n,e,t,r,i,s,a){let o,l,c,h,g,m,y;const v=i[s+1],x=[];for(let b=0,A=t.length;b<A;++b){const M=t[b];for(h=n[M-r],m=n[M-r+1],o=e;o<M;o+=r)g=n[o],y=n[o+1],(v<=m&&y<=v||m<=v&&v<=y)&&(c=(v-m)/(y-m)*(g-h)+h,x.push(c)),h=g,m=y}let w=NaN,T=-1/0;for(x.sort(Xl),h=x[0],o=1,l=x.length;o<l;++o){g=x[o];const b=Math.abs(g-h);b>T&&(c=(h+g)/2,rR(n,e,t,r,c,v)&&(w=c,T=b)),h=g}return isNaN(w)&&(w=i[s]),a?(a.push(w,v,T),a):[w,v,T]}function aF(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=hR(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function wW(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function dR(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function fR(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=dR(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function oF(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!fR(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function F_(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=dR(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&wW(n,e,o,r),e=o}return e}function ob(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=F_(n,e,t[s],r,i);return e}function lF(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],c=dR(n,r,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class xo extends DD{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(ir),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(mn(e[t],Jt.CHANGE,this.changed,this))}clone(){const e=new xo(xS(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<bd(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){f1(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)pD(e,t[r].getExtent());return e}getGeometries(){return xS(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new xo(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=ul(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(xS(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function xS(n){return n.map(e=>e.clone())}function cF(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const c=n[e]-s,h=n[e+1]-a;i+=l*c-o*h,o=c,l=h}return i/2}function uF(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=cF(n,e,o,r),e=o}return i}function EW(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=uF(n,e,o,r),e=o[o.length-1]}return i}class Sp extends Rd{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Sp(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(JA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),tR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return cF(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return uu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Sp(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_w(this.flatCoordinates,0,e,this.stride),this.changed()}}class ic extends Rd{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,c=i.length;l<c;++l){const h=i[l];Vn(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Vn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ic(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(eR(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),nR(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,A$(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return xp(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new bi(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],c=new bi(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=iR(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],c=N_(t,r,l,s,.5);Vn(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=GD(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new ic(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return C$(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=y1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class Cd extends Rd{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Vn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new Cd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<bd(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const c=Hh(e,t,s[o],s[o+1]);if(c<i){i=c;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return uu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new ri(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new ri(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(WA(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_w(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ua extends Rd{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Vn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ua(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(eR(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),nR(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return rR(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return uF(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),F_(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,xp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=ul(this.getExtent());this.flatInteriorPoint_=hR(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ri(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Sp(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],c=new Sp(t.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;fR(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=F_(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=sR(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ua(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return BD(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=y1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function mM(n){if(ig(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ua(s,"XY",[s.length])}class ad extends Rd{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const c=i[o],h=s.length,g=c.getEnds();for(let m=0,y=g.length;m<y;++m)g[m]+=h;Vn(s,c.getFlatCoordinates()),a.push(g)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Vn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new ad(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(S$(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),T$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return I$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return EW(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),ob(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,nb(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=sF(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=aF(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Cd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;oF(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=ob(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=M$(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new ad(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ua(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),c=l[l.length-1];if(s!==0)for(let g=0,m=l.length;g<m;++g)l[g]-=s;const h=new Ua(t.slice(s,c),e,l);i.push(h),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return k$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=FD(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const pM=mi();class Ds{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?mD(this.flatCoordinates_):HA(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=ul(this.getExtent());this.flatInteriorPoints_=hR(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=lF(this.flatCoordinates_,this.ends_),t=sF(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=aF(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=N_(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=N_(e,t,a,2,.5);Vn(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=er(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=ti(r)/ti(t);Ga(pM,r[0],r[3],i,-i,0,0,0),tl(this.flatCoordinates_,0,this.flatCoordinates_.length,2,pM,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ds(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=hD((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=ww(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=GD(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=sR(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Ds(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ds.prototype.getFlatCoordinates=Ds.prototype.getOrientedFlatCoordinates;function hF(n,e,t=0,r=n.length-1,i=SW){for(;r>t;){if(r-t>600){const l=r-t+1,c=e-t+1,h=Math.log(l),g=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*g*(l-g)/l)*(c-l/2<0?-1:1),y=Math.max(t,Math.floor(e-c*g/l+m)),v=Math.min(r,Math.floor(e+(l-c)*g/l+m));hF(n,e,y,v,i)}const s=n[e];let a=t,o=r;for(lm(n,t,e),i(n[r],s)>0&&lm(n,t,r);a<o;){for(lm(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?lm(n,t,o):(o++,lm(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function lm(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function SW(n,e){return n<e?-1:n>e?1:0}let dF=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!gx(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;gx(e,l)&&(t.leaf?r.push(o):vS(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!gx(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(gx(e,a)){if(t.leaf||vS(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Bf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),c=!0),r.leaf){const h=TW(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&vS(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=Bf(e.slice(t,r+1)),wf(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=Bf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));yM(e,t,r,c,this.compareMinX);for(let h=t;h<=r;h+=c){const g=Math.min(h+c-1,r);yM(e,h,g,l,this.compareMinY);for(let m=h;m<=g;m+=l){const y=Math.min(m+l-1,g);o.children.push(this._build(e,m,y,i-1))}}return wf(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=_S(c),g=RW(e,c)-h;g<a?(a=g,s=h<s?h:s,o=c):g===a&&h<s&&(s=h,o=c)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),vm(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=Bf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,wf(r,this.toBBox),wf(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=Bf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,wf(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=_m(e,0,o,this.toBBox),c=_m(e,o,r,this.toBBox),h=IW(l,c),g=_S(l)+_S(c);h<s?(s=h,i=o,a=g<a?g:a):h===s&&g<a&&(a=g,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:bW,s=e.leaf?this.compareMinY:AW,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=_m(e,0,t,s),o=_m(e,r-t,r,s);let l=fx(a)+fx(o);for(let c=t;c<r-t;c++){const h=e.children[c];vm(a,e.leaf?s(h):h),l+=fx(a)}for(let c=r-t-1;c>=t;c--){const h=e.children[c];vm(o,e.leaf?s(h):h),l+=fx(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)vm(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():wf(e[t],this.toBBox)}};function TW(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function wf(n,e){_m(n,0,n.children.length,e,n)}function _m(n,e,t,r,i){i||(i=Bf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];vm(i,n.leaf?r(a):a)}return i}function vm(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function bW(n,e){return n.minX-e.minX}function AW(n,e){return n.minY-e.minY}function _S(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function fx(n){return n.maxX-n.minX+(n.maxY-n.minY)}function RW(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function IW(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function vS(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function gx(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Bf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function yM(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;hF(n,a,e,t,i),s.push(e,a,a,t)}}class xM{constructor(e){this.rbush_=new dF(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[$t(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[$t(o)]=l}this.rbush_.load(r)}remove(e){const t=$t(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[$t(t)],i=[r.minX,r.minY,r.maxX,r.maxY];rd(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return td(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Cu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class gR extends yl{constructor(e){super(),this.projection=er(e.projection),this.attributions_=_M(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=_M(e),this.changed()}setState(e){this.state_=e,this.changed()}}function _M(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const ns={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Uc extends pl{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class xl extends gR{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=mp,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(En(this.format_,"`format` must be set when `url` is set"),this.loader_=gM(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:vW;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new xM:null,this.loadedExtentsRtree_=new xM,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new Na(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=$t(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Uc(ns.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ds||(this.featureChangeKeys_[e]=[mn(t,Jt.CHANGE,this.handleFeatureChange_,this),mn(t,I0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Ds){const s=this.idIndex_[i];s instanceof Ds?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(En(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=$t(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=$t(o);this.setupChangeEvents_(l,o);const c=o.getGeometry();if(c){const h=c.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(ns.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new Uc(ns.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ns.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(ns.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Ls.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(Ls.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(ir);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Uc(ns.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Ds||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Ds||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),td(this.nullGeometryFeatures_)||Vn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=wD(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||gp,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),g=o;if(o=h instanceof Ds?0:h.closestPointXY(r,i,a,o),o<g){s=c;const m=Math.sqrt(o);l[0]=r-m,l[1]=i-m,l[2]=r+m,l[3]=i+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=$t(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new Uc(ns.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:$t(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&td(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return lu(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Uc(ns.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Uc(ns.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Uc(ns.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(rd(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=$t(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(ir),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(ns.REMOVEFEATURE)&&this.dispatchEvent(new Uc(ns.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){En(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(gM(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Xn{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Xn({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=O_(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Et.IDLE&&t.load(),t.getImageState()===Et.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?$t(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:za(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class zn{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new zn({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function vM(n){return n[0]>0&&n[1]>0}function CW(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function ws(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Sw{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ws(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Sw({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Wt()}getImage(e){return Wt()}getHitDetectionImage(){return Wt()}getPixelRatio(e){return 1}getImageState(){return Wt()}getImageSize(){return Wt()}getOrigin(){return Wt()}getSize(){return Wt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ws(e)}listenImageChange(e){Wt()}load(){Wt()}unlistenImageChange(e){Wt()}ready(){return Promise.resolve()}}class Tw extends Sw{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Et.LOADING:Et.LOADED,this.imageState_===Et.LOADING&&this.ready().then(()=>this.imageState_=Et.LOADED),this.render()}clone(){const e=this.getScale(),t=new Tw({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=La.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=ii(a,a);this.draw_(s,o,e),i=o.canvas,La.set(r,null,null,new ZD(i,void 0,null,Et.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const z=i;i=s,s=z}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),c=Math.sqrt(s*s-l*l),h=i-c,g=Math.sqrt(l*l+h*h),m=g/l;if(e==="miter"&&m<=r)return m*t;const y=t/2/m,v=t/2*(h/g),w=Math.sqrt((i+y)*(i+y)+v*v)-i;if(this.radius2_===void 0||e==="bevel")return w*2;const T=i*Math.sin(o),b=Math.sqrt(i*i-T*T),A=s-b,O=Math.sqrt(T*T+A*A)/T;if(O<=r){const z=O*t/2-s-i;return 2*Math.max(w,z)}return w*2}createRenderOptions(){let e=M0,t=N0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Qo(this.stroke_.getColor()??vp),o=this.stroke_.getWidth()??Ep,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??N0,e=this.stroke_.getLineCap()??M0,r=this.stroke_.getMiterLimit()??_p);const l=this.calculateLineJoinSize_(t,o,r),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=Os),t.fillStyle=Qo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=za(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=ii(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,c=o%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Os,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Us extends Tw{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Us({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class hn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=wM,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new hn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=wM,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function kW(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(En(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let wS=null;function fF(n,e){if(!wS){const t=new Xn({color:"rgba(255,255,255,0.4)"}),r=new zn({color:"#3399CC",width:1.25});wS=[new hn({image:new Us({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return wS}function wM(n){return n.getGeometry()}const PW="#333";class ja{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ws(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Xn({color:PW}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ja({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Xn?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ws(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Jr={ANIMATING:0,INTERACTING:1},Ft={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},mx=[Ft.FILL],du=[Ft.STROKE],Vh=[Ft.BEGIN_PATH],EM=[Ft.CLOSE_PATH];class _1 extends QD{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],nd(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const c=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],g=e[t+1];const m=this.tmpCoordinate_;let y=!0,v,x,w;for(v=t+i;v<r;v+=i)m[0]=e[v],m[1]=e[v+1],w=KT(c,m),w!==x?(y&&(o[l++]=h,o[l++]=g,y=!1),o[l++]=m[0],o[l++]=m[1]):w===Ei.INTERSECTING?(o[l++]=m[0],o[l++]=m[1],y=!1):y=!0,h=m[0],g=m[1],x=w;return(s&&y||v===t+i)&&(o[l++]=h,o[l++]=g),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],c=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let c,h,g,m,y;switch(a){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),m=[];const v=e.getEndss();y=0;for(let x=0,w=v.length;x<w;++x){const T=[];y=this.drawCustomCoordinates_(c,y,v[x],o,T),m.push(T)}this.instructions.push([Ft.CUSTOM,l,m,e,r,nb,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,m,e,i||r,nb,s]);break;case"Polygon":case"MultiLineString":g=[],c=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(c,0,e.getEnds(),o,g),this.instructions.push([Ft.CUSTOM,l,g,e,r,xp,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,g,e,i||r,xp,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,o,!1,!1),this.instructions.push([Ft.CUSTOM,l,h,e,r,uu,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,h,e,i||r,uu,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,o),h>l&&(this.instructions.push([Ft.CUSTOM,l,h,e,r,uu,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,h,e,i||r,uu,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Ft.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Ft.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Ft.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ft.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Ft.END_GEOMETRY?a=t:s==Ft.BEGIN_GEOMETRY&&(i[2]=t,bU(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Qo(r||Os)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Qo(r||vp);const i=e.getLineCap();t.lineCap=i!==void 0?i:M0;const s=e.getLineDash();t.lineDash=s?s.slice():Zl;const a=e.getLineDashOffset();t.lineDashOffset=a||Ql;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:N0;const l=e.getWidth();t.lineWidth=l!==void 0?l:Ep;const c=e.getMiterLimit();t.miterLimit=c!==void 0?c:_p,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Ft.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ft.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!fc(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ft.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=gD(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;C0(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class MW extends _1{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!nd(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Ft.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ft.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||nd(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ft.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ft.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class NW extends _1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Ft.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Ql],Vh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(du),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Ql],Vh);const o=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinates_(l,h,o[g],c);this.hitDetectionInstructions.push(du),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(du),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(du),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Vh)}}class SM extends _1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Vh),this.hitDetectionInstructions.push(Vh);for(let c=0;c<l;++c){const h=r[c],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[Ft.MOVE_TO_LINE_TO,g,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(EM),this.hitDetectionInstructions.push(EM)),t=h}return a&&(this.instructions.push(mx),this.hitDetectionInstructions.push(mx)),o&&(this.instructions.push(du),this.hitDetectionInstructions.push(du)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Ql]);const o=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Ft.CIRCLE,c];this.instructions.push(Vh,h),this.hitDetectionInstructions.push(Vh,h),i.fillStyle!==void 0&&(this.instructions.push(mx),this.hitDetectionInstructions.push(mx)),i.strokeStyle!==void 0&&(this.instructions.push(du),this.hitDetectionInstructions.push(du)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Ql]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,o,c),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ft.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zl,Ql]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinatess_(l,h,o[g],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=wh(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function LW(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[c,h]=l.slice(-2),g=e[a+i],m=e[a+i+1],y=Math.sqrt((g-c)*(g-c)+(m-h)*(m-h));if(o+=y,o>=n){const v=(n-o+y)/y,x=oa(c,g,v),w=oa(h,m,v);l.push(x,w),s.push(l),l=[x,w],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const v=y-o,x=oa(c,g,v/y),w=oa(h,m,v/y);l.push(x,w),s.push(l),l=[x,w],o=0,a+=i}}return o>0&&s.push(l),s}function OW(n,e,t,r,i){let s=t,a=t,o=0,l=0,c=t,h,g,m,y,v,x,w,T,b,A;for(g=t;g<r;g+=i){const M=e[g],O=e[g+1];v!==void 0&&(b=M-v,A=O-x,y=Math.sqrt(b*b+A*A),w!==void 0&&(l+=m,h=Math.acos((w*b+T*A)/(m*y)),h>n&&(l>o&&(o=l,s=c,a=g),l=0,c=g-i)),m=y,w=b,T=A),v=M,x=O}return l+=y,l>o?[c,g]:[s,a]}const j_={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class DW extends _1{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Os]={fillStyle:Os},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const c=e.getType();let h=null,g=e.getStride();if(a.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!_s(this.maxExtent,e.getExtent()))return;let m;if(h=e.getFlatCoordinates(),c=="LineString")m=[h.length];else if(c=="MultiLineString")m=e.getEnds();else if(c=="Polygon")m=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const w=e.getEndss();m=[];for(let T=0,b=w.length;T<b;++T)m.push(w[T][0])}this.beginGeometry(e,t,r);const y=a.repeat,v=y?void 0:a.textAlign;let x=0;for(let w=0,T=m.length;w<T;++w){let b;y?b=LW(y*this.resolution,h,x,m[w],g):b=[h.slice(x,m[w])];for(let A=0,M=b.length;A<M;++A){const O=b[A];let z=0,I=O.length;if(v==null){const P=OW(a.maxAngle,O,0,O.length,2);z=P[0],I=P[1]}for(let P=z;P<I;P+=g)o.push(O[P],O[P+1]);const R=o.length;x=m[w],this.drawChars_(l,R),l=R}}this.endGeometry(t)}else{let m=a.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),g=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||m.push(h[2]/this.resolution),g=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();h=[];for(let O=0,z=M.length;O<z;O+=3)a.overflow||m.push(M[O+2]/this.resolution),h.push(M[O],M[O+1]);if(h.length===0)return;g=2;break}const y=this.appendFlatPointCoordinates(h,g);if(y===l)return;if(m&&(y-l)/2!==h.length/g){let M=l/2;m=m.filter((O,z)=>{const I=o[(M+z)*2]===h[z*g]&&o[(M+z)*2+1]===h[z*g+1];return I||--M,I})}this.saveTextStates_();const v=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,x=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let w=a.padding;if(w!=jh&&(a.scale[0]<0||a.scale[1]<0)){let M=a.padding[0],O=a.padding[1],z=a.padding[2],I=a.padding[3];a.scale[0]<0&&(O=-O,I=-I),a.scale[1]<0&&(M=-M,z=-z),w=[M,O,z,I]}const T=this.pixelRatio;this.instructions.push([Ft.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==jh?jh:w.map(function(M){return M*T}),v,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const b=1/T,A=v?v.slice(0):null;A&&(A[1]=Os),this.hitDetectionInstructions.push([Ft.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,w,A,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Os:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||wp,justify:t.justify,textBaseline:t.textBaseline||D_,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=j_[i.textBaseline],h=this.textOffsetY_*l,g=this.text_,m=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Ft.DRAW_CHARS,e,t,c,i.overflow,o,i.maxAngle,l,h,s,m*l,g,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ft.DRAW_CHARS,e,t,c,i.overflow,o&&Os,i.maxAngle,l,h,s,m*l,g,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Qo(a.getColor()||Os)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=o.getLineDash(),w=o.getLineDashOffset(),T=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||M0,s.lineDash=x?x.slice():Zl,s.lineDashOffset=w===void 0?Ql:w,s.lineJoin=o.getLineJoin()||N0,s.lineWidth=T===void 0?Ep:T,s.miterLimit=b===void 0?_p:b,s.strokeStyle=Qo(o.getColor()||vp)}r=this.textState_;const l=e.getFont()||JD;tW(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||D_,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||jh,r.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),y=e.getKeepUpright(),v=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=v===void 0?0:v,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:$t(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+$t(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const FW={Circle:SM,Default:_1,Image:MW,LineString:NW,Polygon:SM,Text:DW};class jW{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=FW[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function VW(n,e,t,r,i,s,a,o,l,c,h,g,m=!0){let y=n[e],v=n[e+1],x=0,w=0,T=0,b=0;function A(){x=y,w=v,e+=r,y=n[e],v=n[e+1],b+=T,T=Math.sqrt((y-x)*(y-x)+(v-w)*(v-w))}do A();while(e<t-r&&b+T<s);let M=T===0?0:(s-b)/T;const O=oa(x,y,M),z=oa(w,v,M),I=e-r,R=b,P=s+o*l(c,i,h);for(;e<t-r&&b+T<P;)A();M=T===0?0:(P-b)/T;const F=oa(x,y,M),N=oa(w,v,M);let B=!1;if(m)if(g){const Me=[O,z,F,N];OD(Me,0,4,2,g,Me,Me),B=Me[0]>Me[2]}else B=O>F;const j=Math.PI,ve=[],ke=I+r===e;e=I,T=0,b=R,y=n[e],v=n[e+1];let Ve;if(ke){A(),Ve=Math.atan2(v-w,y-x),B&&(Ve+=Ve>0?-j:j);const Me=(F+O)/2,ue=(N+z)/2;return ve[0]=[Me,ue,(P-s)/2,Ve,i],ve}i=i.replace(/\n/g," ");for(let Me=0,ue=i.length;Me<ue;){A();let Ae=Math.atan2(v-w,y-x);if(B&&(Ae+=Ae>0?-j:j),Ve!==void 0){let q=Ae-Ve;if(q+=q>j?-2*j:q<-j?2*j:0,Math.abs(q)>a)return null}Ve=Ae;const be=Me;let re=0;for(;Me<ue;++Me){const q=B?ue-Me-1:Me,le=o*l(c,i[q],h);if(e+r<t&&b+T<s+re+le/2)break;re+=le}if(Me===be)continue;const V=B?i.substring(ue-be,ue-Me):i.substring(be,Me);M=T===0?0:(s+re/2-b)/T;const se=oa(x,y,M),ne=oa(w,v,M);ve.push([se,ne,re/2,Ae,V]),s+=re}return ve}class gF{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(L_(),{get:(e,t)=>{if(typeof L_()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Ef=zs(),$c=[],Dl=[],Fl=[],Wc=[];function TM(n){return n[3].declutterBox}const bM=new RegExp("[-----]");function ES(n,e){return e==="start"?e=bM.test(n)?"right":"left":e==="end"&&(e=bM.test(n)?"left":"right"),j_[e]}function BW(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function GW(n,e,t){return t%2===0&&(n+=e),n}class zW{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=mi(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new gF:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],g=l.justify?j_[l.justify]:ES(Array.isArray(e)?e[0]:e,l.textAlign||wp),m=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(BW,[]),{width:v,height:x,widths:w,heights:T,lineWidths:b}=rW(l,y),A=v+m,M=[],O=(A+2)*h[0],z=(x+m)*h[1],I={width:O<0?Math.floor(O):Math.ceil(O),height:z<0?Math.floor(z):Math.ceil(z),contextInstructions:M};(h[0]!=1||h[1]!=1)&&M.push("scale",h),i&&(M.push("strokeStyle",a.strokeStyle),M.push("lineWidth",m),M.push("lineCap",a.lineCap),M.push("lineJoin",a.lineJoin),M.push("miterLimit",a.miterLimit),M.push("setLineDash",[a.lineDash]),M.push("lineDashOffset",a.lineDashOffset)),r&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const R=.5-g;let P=g*A+R*m;const F=[],N=[];let B=0,j=0,ve=0,ke=0,Ve;for(let Me=0,ue=y.length;Me<ue;Me+=2){const Ae=y[Me];if(Ae===`
`){j+=B,B=0,P=g*A+R*m,++ke;continue}const be=y[Me+1]||l.font;be!==Ve&&(i&&F.push("font",be),r&&N.push("font",be),Ve=be),B=Math.max(B,T[ve]);const re=[Ae,P+R*w[ve]+g*(w[ve]-b[ke]),.5*(m+B)+j];P+=w[ve],i&&F.push("strokeText",re),r&&N.push("fillText",re),++ve}return Array.prototype.push.apply(M,F),Array.prototype.push.apply(M,N),this.labels_[s]=I,I}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,c,h,g,m,y,v,x,w){o*=m[0],l*=m[1];let T=r-o,b=i-l;const A=s+c>e?e-c:s,M=a+h>t?t-h:a,O=v[3]+A*m[0]+v[1],z=v[0]+M*m[1]+v[2],I=T-v[3],R=b-v[0];(x||g!==0)&&($c[0]=I,Wc[0]=I,$c[1]=R,Dl[1]=R,Dl[0]=I+O,Fl[0]=Dl[0],Fl[1]=R+z,Wc[1]=Fl[1]);let P;return g!==0?(P=Ga(mi(),r,i,1,1,g,-r,-i),Dr(P,$c),Dr(P,Dl),Dr(P,Fl),Dr(P,Wc),Cu(Math.min($c[0],Dl[0],Fl[0],Wc[0]),Math.min($c[1],Dl[1],Fl[1],Wc[1]),Math.max($c[0],Dl[0],Fl[0],Wc[0]),Math.max($c[1],Dl[1],Fl[1],Wc[1]),Ef)):Cu(Math.min(I,I+O),Math.min(R,R+z),Math.max(I,I+O),Math.max(R,R+z),Ef),y&&(T=Math.round(T),b=Math.round(b)),{drawImageX:T,drawImageY:b,drawImageW:A,drawImageH:M,originX:c,originY:h,declutterBox:{minX:Ef[0],minY:Ef[1],maxX:Ef[2],maxY:Ef[3],value:w},canvasTransform:P,scale:m}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),c=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,$c,Dl,Fl,Wc,a,o),iW(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=Dr(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,c=ES(Array.isArray(e)?e[0]:e,s.textAlign||wp),h=j_[s.textBaseline||D_],g=o&&o.lineWidth?o.lineWidth:0,m=a.width/l-2*s.scale[0],y=c*m+2*(.5-c)*g,v=h*a.height/l+2*(.5-h)*g;return{label:a,anchorX:y,anchorY:v}}execute_(e,t,r,i,s,a,o,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&fc(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=tl(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),LD(this.renderedTransform_,r));let g=0;const m=i.length;let y=0,v,x,w,T,b,A,M,O,z,I,R,P,F,N=0,B=0;const j=this.coordinateCache_,ve=this.viewRotation_,ke=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Ve={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ve},Me=this.instructions!=i||this.overlaps?0:200;let ue,Ae,be,re;for(;g<m;){const V=i[g];switch(V[0]){case Ft.BEGIN_GEOMETRY:ue=V[1],re=V[3],ue.getGeometry()?o!==void 0&&!_s(o,re.getExtent())?g=V[2]+1:++g:g=V[2],c&&(c.zIndex=V[4]);break;case Ft.BEGIN_PATH:N>Me&&(this.fill_(e),N=0),B>Me&&(e.stroke(),B=0),!N&&!B&&(e.beginPath(),b=NaN,A=NaN),++g;break;case Ft.CIRCLE:y=V[1];const ne=h[y],q=h[y+1],le=h[y+2],Ie=h[y+3],Fe=le-ne,he=Ie-q,Pe=Math.sqrt(Fe*Fe+he*he);e.moveTo(ne+Pe,q),e.arc(ne,q,Pe,0,2*Math.PI,!0),++g;break;case Ft.CLOSE_PATH:e.closePath(),++g;break;case Ft.CUSTOM:y=V[1],v=V[2];const Be=V[3],Rt=V[4],Dt=V[5];Ve.geometry=Be,Ve.feature=ue,g in j||(j[g]=[]);const Nt=j[g];Dt?Dt(h,y,v,2,Nt):(Nt[0]=h[y],Nt[1]=h[y+1],Nt.length=2),c&&(c.zIndex=V[6]),Rt(Nt,Ve),++g;break;case Ft.DRAW_IMAGE:y=V[1],v=V[2],z=V[3],x=V[4],w=V[5];let ln=V[6];const rn=V[7],ut=V[8],tr=V[9],dn=V[10];let cn=V[11];const nr=V[12];let li=V[13];T=V[14]||"declutter";const Fn=V[15];if(!z&&V.length>=20){I=V[19],R=V[20],P=V[21],F=V[22];const ce=this.drawLabelWithPointPlacement_(I,R,P,F);z=ce.label,V[3]=z;const $e=V[23];x=(ce.anchorX-$e)*this.pixelRatio,V[4]=x;const De=V[24];w=(ce.anchorY-De)*this.pixelRatio,V[5]=w,ln=z.height,V[6]=ln,li=z.width,V[13]=li}let dt;V.length>25&&(dt=V[25]);let fn,ur,vt;V.length>17?(fn=V[16],ur=V[17],vt=V[18]):(fn=jh,ur=null,vt=null),dn&&ke?cn+=ve:!dn&&!ke&&(cn-=ve);let Zt=0;for(;y<v;y+=2){if(dt&&dt[Zt++]<li/this.pixelRatio)continue;const ce=this.calculateImageOrLabelDimensions_(z.width,z.height,h[y],h[y+1],li,ln,x,w,ut,tr,cn,nr,s,fn,!!ur||!!vt,ue),$e=[e,t,z,ce,rn,ur,vt];if(l){let De,ze,it;if(Fn){const Lt=v-y;if(!Fn[Lt]){Fn[Lt]={args:$e,declutterMode:T};continue}const or=Fn[Lt];De=or.args,ze=or.declutterMode,delete Fn[Lt],it=TM(De)}let xt,At;if(De&&(ze!=="declutter"||!l.collides(it))&&(xt=!0),(T!=="declutter"||!l.collides(ce.declutterBox))&&(At=!0),ze==="declutter"&&T==="declutter"){const Lt=xt&&At;xt=Lt,At=Lt}xt&&(ze!=="none"&&l.insert(it),this.replayImageOrLabel_.apply(this,De)),At&&(T!=="none"&&l.insert(ce.declutterBox),this.replayImageOrLabel_.apply(this,$e))}else this.replayImageOrLabel_.apply(this,$e)}++g;break;case Ft.DRAW_CHARS:const Gt=V[1],Xr=V[2],xr=V[3],Ki=V[4];F=V[5];const Qt=V[6],xi=V[7],je=V[8];P=V[9];const xe=V[10];I=V[11],Array.isArray(I)&&(I=I.reduce(GW,"")),R=V[12];const ye=[V[13],V[13]];T=V[14]||"declutter";const zt=V[15],L=this.textStates[R],kt=L.font,W=[L.scale[0]*xi,L.scale[1]*xi];let Y;kt in this.widths_?Y=this.widths_[kt]:(Y={},this.widths_[kt]=Y);const Q=iR(h,Gt,Xr,2),fe=Math.abs(W[0])*hM(kt,I,Y);if(Ki||fe<=Q){const ce=this.textStates[R].textAlign,$e=(Q-fe)*ES(I,ce),De=VW(h,Gt,Xr,2,I,$e,Qt,Math.abs(W[0]),hM,kt,Y,ke?0:this.viewRotation_,zt);e:if(De){const ze=[];let it,xt,At,Lt,or;if(P)for(it=0,xt=De.length;it<xt;++it){or=De[it],At=or[4],Lt=this.createLabel(At,R,"",P),x=or[2]+(W[0]<0?-xe:xe),w=xr*Lt.height+(.5-xr)*2*xe*W[1]/W[0]-je;const br=this.calculateImageOrLabelDimensions_(Lt.width,Lt.height,or[0],or[1],Lt.width,Lt.height,x,w,0,0,or[3],ye,!1,jh,!1,ue);if(l&&T==="declutter"&&l.collides(br.declutterBox))break e;ze.push([e,t,Lt,br,1,null,null])}if(F)for(it=0,xt=De.length;it<xt;++it){or=De[it],At=or[4],Lt=this.createLabel(At,R,F,""),x=or[2],w=xr*Lt.height-je;const br=this.calculateImageOrLabelDimensions_(Lt.width,Lt.height,or[0],or[1],Lt.width,Lt.height,x,w,0,0,or[3],ye,!1,jh,!1,ue);if(l&&T==="declutter"&&l.collides(br.declutterBox))break e;ze.push([e,t,Lt,br,1,null,null])}l&&T!=="none"&&l.load(ze.map(TM));for(let br=0,Xi=ze.length;br<Xi;++br)this.replayImageOrLabel_.apply(this,ze[br])}}++g;break;case Ft.END_GEOMETRY:if(a!==void 0){ue=V[1];const ce=a(ue,re,T);if(ce)return ce}++g;break;case Ft.FILL:Me?N++:this.fill_(e),++g;break;case Ft.MOVE_TO_LINE_TO:for(y=V[1],v=V[2],Ae=h[y],be=h[y+1],e.moveTo(Ae,be),b=Ae+.5|0,A=be+.5|0,y+=2;y<v;y+=2)Ae=h[y],be=h[y+1],M=Ae+.5|0,O=be+.5|0,(y==v-2||M!==b||O!==A)&&(e.lineTo(Ae,be),b=M,A=O);++g;break;case Ft.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],N&&(this.fill_(e),N=0,B&&(e.stroke(),B=0)),e.fillStyle=V[1],++g;break;case Ft.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,V),++g;break;case Ft.STROKE:Me?B++:e.stroke(),++g;break;default:++g;break}}N&&this.fill_(e),B&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const kh=["Polygon","Circle","LineString","Image","Text","Default"],mF=["Image","Text"],UW=kh.filter(n=>!mF.includes(n));class $W{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=mi(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new zW(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=Ga(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ii(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):c||h.clearRect(0,0,o,o);let g;this.renderBuffer_!==void 0&&(g=zs(),Om(g,e),C0(g,t*(this.renderBuffer_+i),g));const m=WW(i);let y;function v(O,z,I){const R=h.getImageData(0,0,o,o).data;for(let P=0,F=m.length;P<F;P++)if(R[m[P]]>0){if(!a||I==="none"||y!=="Image"&&y!=="Text"||a.includes(O)){const N=(m[P]-3)/4,B=i-N%o,j=i-(N/o|0),ve=s(O,z,B*B+j*j);if(ve)return ve}h.clearRect(0,0,o,o);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Xl);let w,T,b,A,M;for(w=x.length-1;w>=0;--w){const O=x[w].toString();for(b=this.executorsByZIndex_[O],T=kh.length-1;T>=0;--T)if(y=kh[T],A=b[y],A!==void 0&&(M=A.executeHitDetection(h,l,r,v,g),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return tl(o,0,8,2,e,o),o}isEmpty(){return td(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?TU:Xl),a=a||kh;const c=kh.length;for(let h=0,g=l.length;h<g;++h){const m=l[h].toString(),y=this.executorsByZIndex_[m];for(let v=0,x=a.length;v<x;++v){const w=a[v],T=y[w];if(T!==void 0){const b=o===null?void 0:T.getZIndexContext(),A=b?b.getContext():e,M=this.maxExtent_&&w!=="Image"&&w!=="Text";if(M&&(A.save(),this.clip(A,r)),!b||w==="Text"||w==="Image"?T.execute(A,t,r,i,s,o):b.pushFunction(O=>T.execute(O,t,r,i,s,o)),M&&A.restore(),b){b.offset();const O=l[h]*c+kh.indexOf(w);this.deferredZIndexContexts_[O]||(this.deferredZIndexContexts_[O]=[]),this.deferredZIndexContexts_[O].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Xl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const SS={};function WW(n){if(SS[n]!==void 0)return SS[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return SS[n]=i,i}function AM(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let sg=class pF extends Sw{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;En(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||$t(a)),En(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),En(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Et.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?Et.LOADED:Et.IDLE:l=Et.LOADING:l=Et.LOADED),this.color_=e.color!==void 0?za(e.color):null,this.iconImage_=O_(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)c=g.width,h=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(AM(y[0],y[1],e.width,e.height))};this.listenImageChange(m);return}}c!==void 0&&this.setScale(AM(c,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new pF({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=O_(null,e,this.crossOrigin_,Et.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Et.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Et.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Jt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Jt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const qo=.5;function HW(n,e,t,r,i,s,a,o,l){const c=i,h=n[0]*qo,g=n[1]*qo,m=ii(h,g);m.imageSmoothingEnabled=!1;const y=m.canvas,v=new aW(m,qo,i,null,a,o,null),x=t.length,w=Math.floor((256*256*256-1)/x),T={};for(let A=1;A<=x;++A){const M=t[A-1],O=M.getStyleFunction()||r;if(!O)continue;let z=O(M,s);if(!z)continue;Array.isArray(z)||(z=[z]);const R=(A*w).toString(16).padStart(7,"#00000");for(let P=0,F=z.length;P<F;++P){const N=z[P],B=N.getGeometryFunction()(M);if(!B||!_s(c,B.getExtent()))continue;const j=N.clone(),ve=j.getFill();ve&&ve.setColor(R);const ke=j.getStroke();ke&&(ke.setColor(R),ke.setLineDash(null)),j.setText(void 0);const Ve=N.getImage();if(Ve){const be=Ve.getImageSize();if(!be)continue;const re=ii(be[0],be[1],void 0,{alpha:!1}),V=re.canvas;re.fillStyle=R,re.fillRect(0,0,V.width,V.height),j.setImage(new sg({img:V,anchor:Ve.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Ve.getOrigin(),opacity:1,size:Ve.getSize(),scale:Ve.getScale(),rotation:Ve.getRotation(),rotateWithView:Ve.getRotateWithView()}))}const Me=j.getZIndex()||0;let ue=T[Me];ue||(ue={},T[Me]=ue,ue.Polygon=[],ue.Circle=[],ue.LineString=[],ue.Point=[]);const Ae=B.getType();if(Ae==="GeometryCollection"){const be=B.getGeometriesArrayRecursive();for(let re=0,V=be.length;re<V;++re){const se=be[re];ue[se.getType().replace("Multi","")].push(se,j)}}else ue[Ae.replace("Multi","")].push(B,j)}}const b=Object.keys(T).map(Number).sort(Xl);for(let A=0,M=b.length;A<M;++A){const O=T[b[A]];for(const z in O){const I=O[z];for(let R=0,P=I.length;R<P;R+=2){v.setStyle(I[R+1]);for(let F=0,N=e.length;F<N;++F)v.setTransform(e[F]),v.drawGeometry(I[R])}}}return m.getImageData(0,0,y.width,y.height)}function KW(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*qo),s=Math.floor(Math.round(n[1])*qo),a=(cr(i,0,t.width-1)+cr(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),g=Math.floor((256*256*256-1)/e.length);h&&h%g===0&&r.push(e[h/g-1])}return r}class Fm extends pl{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const XW=5;class yF extends d1{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=XW}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Wt()}getData(e){return null}prepareFrame(e){return Wt()}renderFrame(e,t){return Wt()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Et.LOADED||t.getState()===Et.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Et.LOADED&&t!=Et.ERROR&&e.addEventListener(Jt.CHANGE,this.boundHandleImageChange_),t==Et.IDLE&&(e.load(),t=e.getState()),t==Et.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const RM=[];let Gf=null;function qW(){Gf=ii(1,1,void 0,{willReadFrequently:!0})}class mR extends yF{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=mi(),this.pixelTransform=mi(),this.inversePixelTransform=mi(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){Gf||qW(),Gf.clearRect(0,0,1,1);let i;try{Gf.drawImage(e,t,r,1,1,0,0,1,1),i=Gf.getImageData(0,0,1,1).data}catch{return Gf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&fc(za(e.style.backgroundColor),za(r)))){const o=e.firstElementChild;hu(o)&&(a=o.getContext("2d"))}if(a&&x$(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=ha?HD():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=ii();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=Ad(r),s=mw(r),a=gw(r),o=fw(r);Dr(t.coordinateToPixelTransform,i),Dr(t.coordinateToPixelTransform,s),Dr(t.coordinateToPixelTransform,a),Dr(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;Dr(l,i),Dr(l,s),Dr(l,a),Dr(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(pn(r)/i*a),l=Math.round(ti(r)/i*a);Ga(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),yp(this.inversePixelTransform,this.pixelTransform);const c=y$(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new Fm(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Ti.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Ti.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new gF),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ti.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ti.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,c=a/2,h=i/t,g=-h,m=-e[0]+o,y=-e[1];return Ga(this.tempTransform,l,c,h,g,-r,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class YW extends mR{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=zs(),this.wrappedRenderedExtent_=zs(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),y=t.pixelRatio,v=t.viewHints,x=!(v[Jr.ANIMATING]||v[Jr.INTERACTING]),w=this.context,T=Math.round(pn(i)/o*y),b=Math.round(ti(i)/o*y),A=g.getWrapX()&&l.canWrapX(),M=A?pn(h):null,O=A?Math.ceil((i[2]-h[2])/M)+1:1;let z=A?Math.floor((i[0]-h[0])/M):0;do{let I=this.getRenderTransform(a,o,0,y,T,b,z*M);t.declutter&&(I=I.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],I,c,x,r===void 0?kh:r?mF:UW,r?m&&t.declutter[m]:void 0)}while(++z<O)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ii(this.context.canvas.width,this.context.canvas.height,RM))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Ew(this.context),RM.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Ti.PRERENDER)||this.getLayer().hasListener(Ti.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Zo(r.extent);o=_s(l,e.extent),this.clipped_=o&&!lu(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],g=r[0]*qo,m=r[1]*qo;h.push(this.getRenderTransform(i,s,a,qo,g,m,0).slice());const y=c.getSource(),v=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!lu(v,l)){let x=l[0];const w=pn(v);let T=0,b;for(;x<v[0];)--T,b=w*T,h.push(this.getRenderTransform(i,s,a,qo,g,m,b).slice()),x+=w;for(T=0,x=l[2];x>v[2];)++T,b=w*T,h.push(this.getRenderTransform(i,s,a,qo,g,m,b).slice()),x-=w}this.hitDetectionImageData_=HW(r,h,this.renderedFeatures_,c.getStyleFunction(),l,s,a,dM(s,this.renderedPixelRatio_))}t(KW(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),c={},h=function(m,y,v){const x=$t(m),w=c[x];if(w){if(w!==!0&&v<w.distanceSq){if(v===0)return c[x]=!0,s.splice(s.lastIndexOf(w),1),i(m,l,y);w.geometry=y,w.distanceSq=v}}else{if(v===0)return c[x]=!0,i(m,l,y);s.push(c[x]={feature:m,layer:l,geometry:y,distanceSq:v,callback:i})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[Jr.ANIMATING],s=e.viewHints[Jr.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,g=c.resolution,m=e.pixelRatio,y=t.getRevision(),v=t.getRenderBuffer();let x=t.getRenderOrder();x===void 0&&(x=lW);const w=c.center.slice(),T=C0(l,v*g),b=T.slice(),A=[T.slice()],M=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!lu(M,e.extent)){const ve=pn(M),ke=Math.max(pn(T)/2,ve);T[0]=M[0]-ke,T[2]=M[2]+ke,SD(w,h);const Ve=vD(A[0],h);Ve[0]<M[0]&&Ve[2]<M[2]?A.push([Ve[0]+ve,Ve[1],Ve[2]+ve,Ve[3]]):Ve[0]>M[0]&&Ve[2]>M[2]&&A.push([Ve[0]-ve,Ve[1],Ve[2]-ve,Ve[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==y&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&lu(this.wrappedRenderedExtent_,T))return fc(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const O=new jW(rF(g,m),T,g,m);let z;for(let ve=0,ke=A.length;ve<ke;++ve)r.loadFeatures(A[ve],g,h);const I=dM(g,m);let R=!0;const P=(ve,ke)=>{let Ve;const Me=ve.getStyleFunction()||t.getStyleFunction();if(Me&&(Ve=Me(ve,g)),Ve){const ue=this.renderFeature(ve,I,Ve,O,z,this.getLayer().getDeclutter(),ke);R=R&&!ue}},F=MD(T),N=r.getFeaturesInExtent(F);x&&N.sort(x);for(let ve=0,ke=N.length;ve<ke;++ve)P(N[ve],ve);this.renderedFeatures_=N,this.ready=R;const B=O.finish(),j=new $W(T,g,m,r.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=y,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=T,this.renderedCenter_=w,this.renderedProjection_=h,this.renderedPixelRatio_=m,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,h=r.length;c<h;++c)l=fM(i,e,r[c],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=fM(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let kd=0;const ei=1<<kd++,Tt=1<<kd++,gi=1<<kd++,Er=1<<kd++,$s=1<<kd++,Oa=1<<kd++,px=Math.pow(2,kd)-1,pR={[ei]:"boolean",[Tt]:"number",[gi]:"string",[Er]:"color",[$s]:"number[]",[Oa]:"size"},ZW=Object.keys(pR).map(Number).sort(Xl);function QW(n){return n in pR}function e0(n){const e=[];for(const t of ZW)wm(n,t)&&e.push(pR[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function wm(n,e){return(n&e)===e}function Ko(n,e){return n===e}class fi{constructor(e,t){if(!QW(e))throw new Error(`literal expressions must have a specific type, got ${e0(e)}`);this.type=e,this.value=t}}class xF{constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function yR(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ii(n,e,t){switch(typeof n){case"boolean":{if(Ko(e,gi))return new fi(gi,n?"true":"false");if(!wm(e,ei))throw new Error(`got a boolean, but expected ${e0(e)}`);return new fi(ei,n)}case"number":{if(Ko(e,Oa))return new fi(Oa,ws(n));if(Ko(e,ei))return new fi(ei,!!n);if(Ko(e,gi))return new fi(gi,n.toString());if(!wm(e,Tt))throw new Error(`got a number, but expected ${e0(e)}`);return new fi(Tt,n)}case"string":{if(Ko(e,Er))return new fi(Er,lR(n));if(Ko(e,ei))return new fi(ei,!!n);if(!wm(e,gi))throw new Error(`got a string, but expected ${e0(e)}`);return new fi(gi,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return cH(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(Ko(e,Oa)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new fi(Oa,n)}if(Ko(e,Er)){if(n.length===3)return new fi(Er,[...n,1]);if(n.length===4)return new fi(Er,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!wm(e,$s))throw new Error(`got an array of numbers, but expected ${e0(e)}`);return new fi($s,n)}const pe={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},JW={[pe.Get]:Xt(sn(1,1/0),IM),[pe.Var]:Xt(sn(1,1),eH),[pe.Has]:Xt(sn(1,1/0),IM),[pe.Id]:Xt(tH,Sf),[pe.Concat]:Xt(sn(2,1/0),Mn(gi)),[pe.GeometryType]:Xt(nH,Sf),[pe.LineMetric]:Xt(Sf),[pe.Resolution]:Xt(TS,Sf),[pe.Zoom]:Xt(TS,Sf),[pe.Time]:Xt(TS,Sf),[pe.Any]:Xt(sn(2,1/0),Mn(ei)),[pe.All]:Xt(sn(2,1/0),Mn(ei)),[pe.Not]:Xt(sn(1,1),Mn(ei)),[pe.Equal]:Xt(sn(2,2),Mn(px)),[pe.NotEqual]:Xt(sn(2,2),Mn(px)),[pe.GreaterThan]:Xt(sn(2,2),Mn(Tt)),[pe.GreaterThanOrEqualTo]:Xt(sn(2,2),Mn(Tt)),[pe.LessThan]:Xt(sn(2,2),Mn(Tt)),[pe.LessThanOrEqualTo]:Xt(sn(2,2),Mn(Tt)),[pe.Multiply]:Xt(sn(2,1/0),CM),[pe.Coalesce]:Xt(sn(2,1/0),CM),[pe.Divide]:Xt(sn(2,2),Mn(Tt)),[pe.Add]:Xt(sn(2,1/0),Mn(Tt)),[pe.Subtract]:Xt(sn(2,2),Mn(Tt)),[pe.Clamp]:Xt(sn(3,3),Mn(Tt)),[pe.Mod]:Xt(sn(2,2),Mn(Tt)),[pe.Pow]:Xt(sn(2,2),Mn(Tt)),[pe.Abs]:Xt(sn(1,1),Mn(Tt)),[pe.Floor]:Xt(sn(1,1),Mn(Tt)),[pe.Ceil]:Xt(sn(1,1),Mn(Tt)),[pe.Round]:Xt(sn(1,1),Mn(Tt)),[pe.Sin]:Xt(sn(1,1),Mn(Tt)),[pe.Cos]:Xt(sn(1,1),Mn(Tt)),[pe.Atan]:Xt(sn(1,2),Mn(Tt)),[pe.Sqrt]:Xt(sn(1,1),Mn(Tt)),[pe.Match]:Xt(sn(4,1/0),kM,iH),[pe.Between]:Xt(sn(3,3),Mn(Tt)),[pe.Interpolate]:Xt(sn(6,1/0),kM,sH),[pe.Case]:Xt(sn(3,1/0),rH,aH),[pe.In]:Xt(sn(2,2),oH),[pe.Number]:Xt(sn(1,1/0),Mn(px)),[pe.String]:Xt(sn(1,1/0),Mn(px)),[pe.Array]:Xt(sn(1,1/0),Mn(Tt)),[pe.Color]:Xt(sn(1,4),Mn(Tt)),[pe.Band]:Xt(sn(1,3),Mn(Tt)),[pe.Palette]:Xt(sn(2,2),lH),[pe.ToString]:Xt(sn(1,1),Mn(ei|Tt|gi|Er))};function IM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new fi(Tt,a);break}case"string":{i[s]=new fi(gi,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function eH(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new fi(gi,r)]}function tH(n,e,t){t.featureId=!0}function nH(n,e,t){t.geometryType=!0}function TS(n,e,t){t.mapState=!0}function Sf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function sn(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function CM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Ii(n[s+1],e,t);i[s]=a}return i}function Mn(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Ii(e[a+1],n,r);s[a]=o}return s}}function rH(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function kM(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function iH(n,e,t){const r=n.length-1,i=gi|Tt|ei,s=Ii(n[1],i,t),a=Ii(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=Ii(n[l+2],s.type,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Ii(n[l+3],a.type,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...o,a]}function sH(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new fi(Tt,i);let a;try{a=Ii(n[2],Tt,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const c=Ii(n[l+3],Tt,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Ii(n[l+4],e,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,a,...o]}function aH(n,e,t){const r=Ii(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Ii(n[s+1],ei,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Ii(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function oH(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=gi}else i=Tt;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Ii(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Ii(n[1],i,t),...s]}function lH(n,e,t){let r;try{r=Ii(n[1],Tt,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Ii(i[a],Er,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof fi))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Xt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new xF(t,i,...s)}}function cH(n,e,t){const r=n[0],i=JW[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function xR(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return xR(n.getGeometries()[0]);default:return""}}function _F(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function gc(n,e,t){const r=Ii(n,e,t);return To(r)}function To(n,e){if(n instanceof fi){if(n.type===Er&&typeof n.value=="string"){const r=lR(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case pe.Number:case pe.String:case pe.Coalesce:return uH(n);case pe.Get:case pe.Var:case pe.Has:return hH(n);case pe.Id:return r=>r.featureId;case pe.GeometryType:return r=>r.geometryType;case pe.Concat:{const r=n.args.map(i=>To(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case pe.Resolution:return r=>r.resolution;case pe.Any:case pe.All:case pe.Between:case pe.In:case pe.Not:return fH(n);case pe.Equal:case pe.NotEqual:case pe.LessThan:case pe.LessThanOrEqualTo:case pe.GreaterThan:case pe.GreaterThanOrEqualTo:return dH(n);case pe.Multiply:case pe.Divide:case pe.Add:case pe.Subtract:case pe.Clamp:case pe.Mod:case pe.Pow:case pe.Abs:case pe.Floor:case pe.Ceil:case pe.Round:case pe.Sin:case pe.Cos:case pe.Atan:case pe.Sqrt:return gH(n);case pe.Case:return mH(n);case pe.Match:return pH(n);case pe.Interpolate:return yH(n);case pe.ToString:return xH(n);default:throw new Error(`Unsupported operator ${t}`)}}function uH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=To(n.args[s]);switch(t){case pe.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case pe.Number:case pe.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function hH(n,e){const r=n.args[0].value;switch(n.operator){case pe.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case pe.Var:return i=>i.variables[r];case pe.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function dH(n,e){const t=n.operator,r=To(n.args[0]),i=To(n.args[1]);switch(t){case pe.Equal:return s=>r(s)===i(s);case pe.NotEqual:return s=>r(s)!==i(s);case pe.LessThan:return s=>r(s)<i(s);case pe.LessThanOrEqualTo:return s=>r(s)<=i(s);case pe.GreaterThan:return s=>r(s)>i(s);case pe.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function fH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=To(n.args[s]);switch(t){case pe.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case pe.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case pe.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case pe.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case pe.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function gH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=To(n.args[s]);switch(t){case pe.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case pe.Divide:return s=>i[0](s)/i[1](s);case pe.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case pe.Subtract:return s=>i[0](s)-i[1](s);case pe.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case pe.Mod:return s=>i[0](s)%i[1](s);case pe.Pow:return s=>Math.pow(i[0](s),i[1](s));case pe.Abs:return s=>Math.abs(i[0](s));case pe.Floor:return s=>Math.floor(i[0](s));case pe.Ceil:return s=>Math.ceil(i[0](s));case pe.Round:return s=>Math.round(i[0](s));case pe.Sin:return s=>Math.sin(i[0](s));case pe.Cos:return s=>Math.cos(i[0](s));case pe.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case pe.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function mH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=To(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function pH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=To(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function yH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=To(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let c=2;c<t;c+=2){const h=r[c](i);let g=r[c+1](i);const m=Array.isArray(g);if(m&&(g=H$(g)),h>=a)return c===2?g:m?_H(s,a,o,l,h,g):Em(s,a,o,l,h,g);o=h,l=g}return l}}function xH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=To(n.args[s]);switch(t){case pe.ToString:return s=>{const a=i[0](s);return n.args[0].type===Er?cR(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Em(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function _H(n,e,t,r,i,s){if(i-t===0)return r;const o=oM(r),l=oM(s);let c=l[2]-o[2];c>180?c-=360:c<-180&&(c+=360);const h=[Em(n,e,t,o[0],i,l[0]),Em(n,e,t,o[1],i,l[1]),o[2]+Em(n,e,t,0,i,c),Em(n,e,t,r[3],i,s[3])];return K$(h)}function vH(n){return!0}function wH(n){const e=yR(),t=EH(n,e),r=_F();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=xR(i.getGeometry())),t(r)}}function PM(n){const e=yR(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=lb(n[a],e);const i=_F(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const c=a.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<t;++c){const h=r[c](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function EH(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?gc(s.filter,ei,e):vH;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let c=0;c<l;++c)o[c]=lb(s.style[c],e)}else o=[lb(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const c of r[o].styles){const h=c(i);h&&s.push(h)}}}return s}}function lb(n,e){const t=Tp(n,"",e),r=bp(n,"",e),i=SH(n,e),s=TH(n,e),a=Fs(n,"z-index",e);if(!t&&!r&&!i&&!s&&!td(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new hn;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),o.setFill(h)}if(r){const h=r(l);h&&(c=!1),o.setStroke(h)}if(i){const h=i(l);h&&(c=!1),o.setText(h)}if(s){const h=s(l);h&&(c=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),c?null:o}}function Tp(n,e,t){let r;if(e+"fill-pattern-src"in n)r=IH(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=_R(n,e+"fill-color",t)}if(!r)return null;const i=new Xn;return function(s){const a=r(s);return a===oR?null:(i.setColor(a),i)}}function bp(n,e,t){const r=Fs(n,e+"stroke-width",t),i=_R(n,e+"stroke-color",t);if(!r&&!i)return null;const s=Gl(n,e+"stroke-line-cap",t),a=Gl(n,e+"stroke-line-join",t),o=vF(n,e+"stroke-line-dash",t),l=Fs(n,e+"stroke-line-dash-offset",t),c=Fs(n,e+"stroke-miter-limit",t),h=new zn;return function(g){if(i){const m=i(g);if(m===oR)return null;h.setColor(m)}if(r&&h.setWidth(r(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(m)}if(a){const m=a(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(m)}return o&&h.setLineDash(o(g)),l&&h.setLineDashOffset(l(g)),c&&h.setMiterLimit(c(g)),h}}function SH(n,e){const t="text-",r=Gl(n,t+"value",e);if(!r)return null;const i=Tp(n,t,e),s=Tp(n,t+"background-",e),a=bp(n,t,e),o=bp(n,t+"background-",e),l=Gl(n,t+"font",e),c=Fs(n,t+"max-angle",e),h=Fs(n,t+"offset-x",e),g=Fs(n,t+"offset-y",e),m=d0(n,t+"overflow",e),y=Gl(n,t+"placement",e),v=Fs(n,t+"repeat",e),x=bw(n,t+"scale",e),w=d0(n,t+"rotate-with-view",e),T=Fs(n,t+"rotation",e),b=Gl(n,t+"align",e),A=Gl(n,t+"justify",e),M=Gl(n,t+"baseline",e),O=d0(n,t+"keep-upright",e),z=vF(n,t+"padding",e),I=Aw(n,t+"declutter-mode"),R=new ja({declutterMode:I});return function(P){if(R.setText(r(P)),i&&R.setFill(i(P)),s&&R.setBackgroundFill(s(P)),a&&R.setStroke(a(P)),o&&R.setBackgroundStroke(o(P)),l&&R.setFont(l(P)),c&&R.setMaxAngle(c(P)),h&&R.setOffsetX(h(P)),g&&R.setOffsetY(g(P)),m&&R.setOverflow(m(P)),y){const F=y(P);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(F)}if(v&&R.setRepeat(v(P)),x&&R.setScale(x(P)),w&&R.setRotateWithView(w(P)),T&&R.setRotation(T(P)),b){const F=b(P);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(F)}if(A){const F=A(P);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(F)}if(M){const F=M(P);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(F)}return z&&R.setPadding(z(P)),O&&R.setKeepUpright(O(P)),R}}function TH(n,e){return"icon-src"in n?bH(n,e):"shape-points"in n?AH(n,e):"circle-radius"in n?RH(n,e):null}function bH(n,e){const t="icon-",r=t+"src",i=wF(n[r],r),s=V_(n,t+"anchor",e),a=bw(n,t+"scale",e),o=Fs(n,t+"opacity",e),l=V_(n,t+"displacement",e),c=Fs(n,t+"rotation",e),h=d0(n,t+"rotate-with-view",e),g=NM(n,t+"anchor-origin"),m=LM(n,t+"anchor-x-units"),y=LM(n,t+"anchor-y-units"),v=MH(n,t+"color"),x=kH(n,t+"cross-origin"),w=PH(n,t+"offset"),T=NM(n,t+"offset-origin"),b=B_(n,t+"width"),A=B_(n,t+"height"),M=CH(n,t+"size"),O=Aw(n,t+"declutter-mode"),z=new sg({src:i,anchorOrigin:g,anchorXUnits:m,anchorYUnits:y,color:v,crossOrigin:x,offset:w,offsetOrigin:T,height:A,width:b,size:M,declutterMode:O});return function(I){return o&&z.setOpacity(o(I)),l&&z.setDisplacement(l(I)),c&&z.setRotation(c(I)),h&&z.setRotateWithView(h(I)),a&&z.setScale(a(I)),s&&z.setAnchor(s(I)),z}}function AH(n,e){const t="shape-",r=t+"points",i=t+"radius",s=cb(n[r],r),a=cb(n[i],i),o=Tp(n,t,e),l=bp(n,t,e),c=bw(n,t+"scale",e),h=V_(n,t+"displacement",e),g=Fs(n,t+"rotation",e),m=d0(n,t+"rotate-with-view",e),y=B_(n,t+"radius2"),v=B_(n,t+"angle"),x=Aw(n,t+"declutter-mode"),w=new Tw({points:s,radius:a,radius2:y,angle:v,declutterMode:x});return function(T){return o&&w.setFill(o(T)),l&&w.setStroke(l(T)),h&&w.setDisplacement(h(T)),g&&w.setRotation(g(T)),m&&w.setRotateWithView(m(T)),c&&w.setScale(c(T)),w}}function RH(n,e){const t="circle-",r=Tp(n,t,e),i=bp(n,t,e),s=Fs(n,t+"radius",e),a=bw(n,t+"scale",e),o=V_(n,t+"displacement",e),l=Fs(n,t+"rotation",e),c=d0(n,t+"rotate-with-view",e),h=Aw(n,t+"declutter-mode"),g=new Us({radius:5,declutterMode:h});return function(m){return s&&g.setRadius(s(m)),r&&g.setFill(r(m)),i&&g.setStroke(i(m)),o&&g.setDisplacement(o(m)),l&&g.setRotation(l(m)),c&&g.setRotateWithView(c(m)),a&&g.setScale(a(m)),g}}function Fs(n,e,t){if(!(e in n))return;const r=gc(n[e],Tt,t);return function(i){return cb(r(i),e)}}function Gl(n,e,t){if(!(e in n))return null;const r=gc(n[e],gi,t);return function(i){return wF(r(i),e)}}function IH(n,e,t){const r=Gl(n,e+"pattern-src",t),i=MM(n,e+"pattern-offset",t),s=MM(n,e+"pattern-size",t),a=_R(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function d0(n,e,t){if(!(e in n))return null;const r=gc(n[e],ei,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function _R(n,e,t){if(!(e in n))return null;const r=gc(n[e],Er,t);return function(i){return EF(r(i),e)}}function vF(n,e,t){if(!(e in n))return null;const r=gc(n[e],$s,t);return function(i){return v1(r(i),e)}}function V_(n,e,t){if(!(e in n))return null;const r=gc(n[e],$s,t);return function(i){const s=v1(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function MM(n,e,t){if(!(e in n))return null;const r=gc(n[e],$s,t);return function(i){return SF(r(i),e)}}function bw(n,e,t){if(!(e in n))return null;const r=gc(n[e],$s|Tt,t);return function(i){return NH(r(i),e)}}function B_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function CH(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return ws(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function kH(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function NM(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function LM(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function PH(n,e){const t=n[e];if(t!==void 0)return v1(t,e)}function Aw(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function MH(n,e){const t=n[e];if(t!==void 0)return EF(t,e)}function v1(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function wF(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function cb(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function EF(n,e){if(typeof n=="string")return n;const t=v1(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function SF(n,e){const t=v1(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function NH(n,e){return typeof n=="number"?n:SF(n,e)}const no={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function OM(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,h=o?o[0]:0,g=o?o[1]:0;let m=n[0]+l/2+h,y=n[2]-l/2+h,v=n[1]+c/2+g,x=n[3]-c/2+g;m>y&&(m=(y+m)/2,y=m),v>x&&(v=(x+v)/2,x=v);let w=cr(r[0],m,y),T=cr(r[1],v,x);if(a&&t&&i){const b=30*i;w+=-b*Math.log(1+Math.max(0,m-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-y)/b),T+=-b*Math.log(1+Math.max(0,v-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-x)/b)}return[w,T]})}function LH(n){return n}function TF(n){return Math.pow(n,3)}function ag(n){return 1-TF(1-n)}function OH(n){return 3*n*n-2*n*n*n}function DH(n){return n}function vR(n,e,t,r){const i=pn(e)/t[0],s=ti(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function wR(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),cr(r,t/2,e*2)}function FH(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],c=n[n.length-1],h=t?vR(l,t,a,r):l;if(o)return e?wR(i,h,c):cr(i,c,h);const g=Math.min(h,i),m=Math.floor(hw(n,g,s));return n[m]>h&&m<n.length-1?n[m+1]:n[m]}})}function jH(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,c){if(a!==void 0){const h=i?vR(e,i,l,s):e;if(c)return r?wR(a,h,t):cr(a,t,h);const g=1e-9,m=Math.ceil(Math.log(e/h)/Math.log(n)-g),y=-o*(.5-g)+.5,v=Math.min(h,a),x=Math.floor(Math.log(e/v)/Math.log(n)+y),w=Math.max(m,x),T=e/Math.pow(n,w);return cr(T,t,h)}})}function DM(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const c=r?vR(n,r,o,i):n;return!t||!l?cr(s,e,c):wR(s,c,e)}})}function ER(n){if(n!==void 0)return 0}function FM(n){if(n!==void 0)return n}function VH(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function BH(n){const e=Yl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const GH=42,SR=256,bS=0;class Yo extends yl{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=ZA(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&PD(),e.center&&(e.center=Vl(e.center,this.projection_)),e.extent&&(e.extent=Zo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in no)delete t[o];this.setProperties(t,!0);const r=UH(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=zH(e),s=r.constraint,a=$H(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Vl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Vl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&yx(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<t;++i){const h=arguments[i],g={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||OH,callback:r};if(h.center&&(g.sourceCenter=a,g.targetCenter=h.center.slice(),a=g.targetCenter),h.zoom!==void 0?(g.sourceResolution=o,g.targetResolution=this.getResolutionForZoom(h.zoom),o=g.targetResolution):h.resolution&&(g.sourceResolution=o,g.targetResolution=h.resolution,o=g.targetResolution),h.rotation!==void 0){g.sourceRotation=l;const m=vu(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=l+m,l=g.targetRotation}WH(g)?g.complete=!0:s+=g.duration,c.push(g)}this.animations_.push(c),this.setHint(Jr.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Jr.ANIMATING]>0}getInteracting(){return this.hints_[Jr.INTERACTING]>0}cancelAnimations(){this.setHint(Jr.ANIMATING,-this.hints_[Jr.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&yx(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const g=l.easing(h);if(l.sourceCenter){const m=l.sourceCenter[0],y=l.sourceCenter[1],v=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const w=m+g*(v-m),T=y+g*(x-y);this.targetCenter_=[w,T]}if(l.sourceResolution&&l.targetResolution){const m=g===1?l.targetResolution:l.sourceResolution+g*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const m=g===1?vu(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+g*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(Jr.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&yx(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],KA(r,e-this.getRotation()),DU(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&eb(e,this.getProjection())}getCenterInternal(){return this.get(no.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return MD(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();En(t,"The view center is not defined");const r=this.getResolution();En(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return En(i!==void 0,"The view rotation is not defined"),A_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(no.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Zo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=pn(e)/t[0],i=ti(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(no.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=AS(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=hw(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=cr(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,cr(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(En(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){En(!ig(e),"Cannot fit empty extent provided as `geometry`");const i=Zo(e,this.getProjection());r=mM(i)}else if(e.getType()==="Circle"){const i=Zo(e.getExtent(),this.getProjection());r=mM(i),r.rotate(this.getRotation(),ul(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,c=-1/0,h=-1/0;for(let g=0,m=s.length;g<m;g+=a){const y=s[g]*r-s[g+1]*i,v=s[g]*i+s[g+1]*r;o=Math.min(o,y),l=Math.min(l,v),c=Math.max(c,y),h=Math.max(h,v)}return[o,l,c,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),g=Math.cos(c),m=ul(o);m[0]+=(i[1]-i[3])/2*l,m[1]+=(i[0]-i[2])/2*l;const y=m[0]*g-m[1]*h,v=m[1]*g+m[0]*h,x=this.getConstrainedCenter([y,v],l),w=t.callback?t.callback:mp;t.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:t.duration,easing:t.easing},w):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),yx(w,!0))}centerOn(e,t,r){this.centerOnInternal(Vl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(AS(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=AS(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=eb(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Vl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Vl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Vl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(no.ROTATION)!==i&&this.set(no.ROTATION,i),this.get(no.RESOLUTION)!==a&&(this.set(no.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(no.CENTER)||!I_(this.get(no.CENTER),o))&&this.set(no.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!I_(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:ag,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Jr.INTERACTING,1)}endInteraction(e,t,r){r=r&&Vl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(Jr.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function yx(n,e){setTimeout(function(){n(e)},0)}function zH(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return OM(n.extent,n.constrainOnlyCenter,t)}const e=ZA(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,OM(t,!1,!1)}return LH}function UH(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:bS,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=ZA(n.projection,"EPSG:3857"),y=m.getExtent();let v=n.constrainOnlyCenter,x=n.extent;if(!c&&!x&&m.isGlobal()&&(v=!1,x=y),n.resolutions!==void 0){const w=n.resolutions;t=w[a],r=w[o]!==void 0?w[o]:w[w.length-1],n.constrainResolution?e=FH(w,h,!v&&x,g):e=DM(t,r,h,!v&&x,g)}else{const T=(y?Math.max(pn(y),ti(y)):360*k0.degrees/m.getMetersPerUnit())/SR/Math.pow(2,bS),b=T/Math.pow(2,28-bS);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=jH(l,t,r,h,!v&&x,g):e=DM(t,r,h,!v&&x,g)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function $H(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?BH():t===!1?FM:typeof t=="number"?VH(t):FM}return ER}function WH(n){return!(n.sourceCenter&&n.targetCenter&&!I_(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function AS(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const c=o*s-l*a,h=l*s+o*a;return[c,h]}const Nn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class bF extends yl{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Nn.OPACITY]=e.opacity!==void 0?e.opacity:1,En(typeof t[Nn.OPACITY]=="number","Layer opacity must be a number"),t[Nn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Nn.Z_INDEX]=e.zIndex,t[Nn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Nn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Nn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Nn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=cr(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Wt()}getLayerStatesArray(e){return Wt()}getExtent(){return this.get(Nn.EXTENT)}getMaxResolution(){return this.get(Nn.MAX_RESOLUTION)}getMinResolution(){return this.get(Nn.MIN_RESOLUTION)}getMinZoom(){return this.get(Nn.MIN_ZOOM)}getMaxZoom(){return this.get(Nn.MAX_ZOOM)}getOpacity(){return this.get(Nn.OPACITY)}getSourceState(){return Wt()}getVisible(){return this.get(Nn.VISIBLE)}getZIndex(){return this.get(Nn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Nn.EXTENT,e)}setMaxResolution(e){this.set(Nn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Nn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Nn.MAX_ZOOM,e)}setMinZoom(e){this.set(Nn.MIN_ZOOM,e)}setOpacity(e){En(typeof e=="number","Layer opacity must be a number"),this.set(Nn.OPACITY,e)}setVisible(e){this.set(Nn.VISIBLE,e)}setZIndex(e){this.set(Nn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class w1 extends bF{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Nn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Nn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ir(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=mn(e,Jt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Yo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return TR(i,t.viewState)&&(!s||_s(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Yo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Nn.MAP,e)}getMapInternal(){return this.get(Nn.MAP)}setMap(e){this.mapPrecomposeKey_&&(ir(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(ir(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=mn(e,Ti.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=mn(this,Jt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);En(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Nn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function TR(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const jM={RENDER_ORDER:"renderOrder"};class Rw extends w1{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(jM.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new dF(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(jM.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?fF:e;const t=HH(e);this.styleFunction_=e===null?void 0:kW(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function HH(n){if(n===void 0)return fF;if(!n)return null;if(typeof n=="function"||n instanceof hn)return n;if(!Array.isArray(n))return PM([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof hn){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof hn))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return wH(i)}return PM(n)}class mc extends Rw{constructor(e){super(e)}createRenderer(){return new YW(this)}}const Hc={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class nu extends pl{constructor(e,t){super(e),this.layer=t}}const RS={LAYERS:"layers"};let Iw=class AF extends bF{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(RS.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Na(r.slice(),{unique:!0}):En(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Na(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ir),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(mn(e,Ls.ADD,this.handleLayersAdd_,this),mn(e,Ls.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(ir);rg(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new nu(Hc.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[mn(e,I0.PROPERTYCHANGE,this.handleLayerChange_,this),mn(e,Jt.CHANGE,this.handleLayerChange_,this)];e instanceof AF&&t.push(mn(e,Hc.ADDLAYER,this.handleLayerGroupAdd_,this),mn(e,Hc.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[$t(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new nu(Hc.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new nu(Hc.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new nu(Hc.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=$t(t);this.listenerKeys_[r].forEach(ir),delete this.listenerKeys_[r],this.dispatchEvent(new nu(Hc.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(RS.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new nu(Hc.REMOVELAYER,r[i]))}this.set(RS.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=ql(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const jt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function RF(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ub(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const G_=34962,bR=34963,KH=35044,IS=35048,XH=5121,qH=5123,YH=5125,IF=5126,VM=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function ZH(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!L$},e);const t=VM.length;for(let r=0;r<t;++r)try{const i=n.getContext(VM[r],e);if(i)return i}catch{}return null}const QH={STATIC_DRAW:KH};class CS{constructor(e,t){this.array_=null,this.type_=e,En(e===G_||e===bR,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:QH.STATIC_DRAW}ofSize(e){return this.array_=new(xx(this.type_))(e),this}fromArray(e){return this.array_=xx(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(xx(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const t=xx(this.type_);if(!(e instanceof t))throw new Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function xx(n){switch(n){case G_:return Float32Array;case bR:return Uint32Array;default:return Float32Array}}const _x={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},JH=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,eK=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class BM{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||JH),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||eK),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(a=>{this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=t.RGBA,a=0,o=t.RGBA,l=t.UNSIGNED_BYTE,c=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,s,r[0],r[1],a,o,l,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,i){const s=this.getGL(),a=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=$t(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const o=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:t.uniform2f(s.location,r[0],r[1]);return;case 3:t.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:t.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(s.location,r)})}}const Bl={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},Fi={UNSIGNED_BYTE:XH,UNSIGNED_SHORT:qH,UNSIGNED_INT:YH,FLOAT:IF},z_={};function GM(n){return"shared/"+n}let zM=0;function tK(){const n="unique/"+zM;return zM+=1,n}function nK(n){let e=z_[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:ZH(t)},z_[n]=e}return e.users+=1,e.context}function rK(n){const e=z_[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,r=t.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=t.canvas;i.width=1,i.height=1,delete z_[n]}class iK extends u1{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?GM(e.canvasCacheKey):tK(),this.gl_=nK(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(_x.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(_x.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=mi(),this.offsetScaleMatrix_=mi(),this.tmpMat4_=RF(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new BM({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new BM({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===GM(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return En(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const t=this.gl_,r=$t(e);let i=this.bufferCache_[r];if(!i){const s=t.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=$t(e);delete this.bufferCache_[t]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(_x.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(_x.RESTORED,this.boundHandleWebGLContextRestored_),rK(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){const i=this.gl_,s=this.getCanvas(),a=e.size,o=e.pixelRatio;(s.width!==a[0]*o||s.height!==a[1]*o)&&(s.width=a[0]*o,s.height=a[1]*o,s.style.width=a[0]+"px",s.style.height=a[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,t){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),t&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){const e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,t,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}bindAttribute(e,t,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(t);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,r,i){const s=this.gl_,a=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,a[0],a[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,a=t-e,o=e*s;r.drawElements(r.TRIANGLES,a,i,o)}drawElementsInstanced(e,t,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),a=i.UNSIGNED_INT,o=4,l=t-e,c=e*o;s.drawElementsInstancedANGLE(i.TRIANGLES,l,a,c,r);for(let h=0;h<this.maxAttributeCount_;h++)s.vertexAttribDivisorANGLE(h,0)}finalizeDraw(e,t,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(Bl.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Bl.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Bl.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Bl.PIXEL_RATIO,i),this.setUniformFloatVec2(Bl.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Bl.ROTATION,r)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Bl.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Bl.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,i,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const a=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&a&&s.prevValue!==r&&(s.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,ub(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:t.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,t){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){const r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(t,r.VERTEX_SHADER),a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,s),r.linkProgram(a),!r.getShaderParameter(i,r.COMPILE_STATUS)){const o=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(o)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const o=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(o)}if(r.deleteShader(s),!r.getProgramParameter(a,r.LINK_STATUS)){const o=`GL program linking failed: ${r.getProgramInfoLog(a)}`;throw new Error(o)}return a}getUniformLocation(e){const t=$t(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=$t(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,a=e.viewState.center;return Ga(t,0,0,2/(s*r[0]),2/(s*r[1]),-i,-a[0],-a[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,t,r,i,s,a){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,r,!1,i,s),a&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(o,1))}enableAttributes_(e,t){const r=sK(e);let i=0;for(let s=0;s<e.length;s++){const a=e[s];a.name&&this.enableAttributeArray_(a.name,a.size,a.type||IF,r,i,t),i+=a.size*CF(a.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){rg(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r,i){const s=this.gl_;r=r||s.createTexture();const a=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const o=0,l=s.RGBA,c=0,h=s.RGBA,g=s.UNSIGNED_BYTE;return t instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,t):t?s.texImage2D(s.TEXTURE_2D,o,l,h,g,t):s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,null),r}}function sK(n){let e=0;for(let t=0;t<n.length;t++){const r=n[t];e+=r.size*CF(r.type)}return e}function CF(n){switch(n){case Fi.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Fi.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Fi.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Fi.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class AR extends h1{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Jt.CHANGE)}release(){this.setState(jt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==jt.EMPTY){if(this.state!==jt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Wt()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:TF(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function hb(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const aK=new Error("disposed"),oK=[256,256];class UM extends AR{constructor(e){const t=jt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=hb(this.data_);return e?[e.width,e.height]:oK}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==jt.IDLE&&this.state!==jt.ERROR)return;this.state=jt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=jt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=jt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(aK),this.controller_=null),super.disposeInternal()}}class kF extends AR{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,ha?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=jt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=jt.ERROR,this.unlistenImage_(),this.image_=lK(),this.changed()}handleImageLoad_(){if(ha)this.state=jt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=jt.LOADED:this.state=jt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==jt.ERROR&&(this.state=jt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==jt.IDLE&&(this.state=jt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=X$(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function lK(){const n=ii(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let kS;const f0=[];function $M(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function PS(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function cK(){if(kS===void 0){const n=ii(6,6,f0);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",$M(n,4,5,4,0),$M(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;kS=PS(e,0)||PS(e,4)||PS(e,8),Ew(n),f0.push(n.canvas)}return kS}function U_(n,e,t,r){const i=p1(t,e,n);let s=M_(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||nd(l,i)){const c=M_(n,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function uK(n,e,t,r){const i=ul(t);let s=U_(n,e,i,r);return(!isFinite(s)||s<=0)&&xD(t,function(a){return s=U_(n,e,a,r),isFinite(s)&&s>0}),s}function PF(n,e,t,r,i,s,a,o,l,c,h,g,m,y){const v=ii(Math.round(t*n),Math.round(t*e),f0);if(g||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(t,t);function x(O){return Math.round(O*t)/t}v.globalCompositeOperation="lighter";const w=zs();l.forEach(function(O,z,I){pD(w,O.extent)});let T;const b=t/r,A=(g?1:1+Math.pow(2,-24))/b;(!m||l.length!==1||c!==0)&&(T=ii(Math.round(pn(w)*b),Math.round(ti(w)*b),f0),g||(T.imageSmoothingEnabled=!1),l.forEach(function(O,z,I){if(O.image.width>0&&O.image.height>0){if(O.clipExtent){T.save();const B=(O.clipExtent[0]-w[0])*b,j=-(O.clipExtent[3]-w[3])*b,ve=pn(O.clipExtent)*b,ke=ti(O.clipExtent)*b;T.rect(g?B:Math.round(B),g?j:Math.round(j),g?ve:Math.round(B+ve)-Math.round(B),g?ke:Math.round(j+ke)-Math.round(j)),T.clip()}const R=(O.extent[0]-w[0])*b,P=-(O.extent[3]-w[3])*b,F=pn(O.extent)*b,N=ti(O.extent)*b;T.drawImage(O.image,c,c,O.image.width-2*c,O.image.height-2*c,g?R:Math.round(R),g?P:Math.round(P),g?F:Math.round(R+F)-Math.round(R),g?N:Math.round(P+N)-Math.round(P)),O.clipExtent&&T.restore()}}));const M=Ad(a);return o.getTriangles().forEach(function(O,z,I){const R=O.source,P=O.target;let F=R[0][0],N=R[0][1],B=R[1][0],j=R[1][1],ve=R[2][0],ke=R[2][1];const Ve=x((P[0][0]-M[0])/s),Me=x(-(P[0][1]-M[1])/s),ue=x((P[1][0]-M[0])/s),Ae=x(-(P[1][1]-M[1])/s),be=x((P[2][0]-M[0])/s),re=x(-(P[2][1]-M[1])/s),V=F,se=N;F=0,N=0,B-=V,j-=se,ve-=V,ke-=se;const ne=[[B,j,0,0,ue-Ve],[ve,ke,0,0,be-Ve],[0,0,B,j,Ae-Me],[0,0,ve,ke,re-Me]],q=OU(ne);if(!q)return;if(v.save(),v.beginPath(),cK()||!g){v.moveTo(ue,Ae);const Ie=4,Fe=Ve-ue,he=Me-Ae;for(let Pe=0;Pe<Ie;Pe++)v.lineTo(ue+x((Pe+1)*Fe/Ie),Ae+x(Pe*he/(Ie-1))),Pe!=Ie-1&&v.lineTo(ue+x((Pe+1)*Fe/Ie),Ae+x((Pe+1)*he/(Ie-1)));v.lineTo(be,re)}else v.moveTo(ue,Ae),v.lineTo(Ve,Me),v.lineTo(be,re);v.clip(),v.transform(q[0],q[2],q[1],q[3],Ve,Me),v.translate(w[0]-V,w[3]-se);let le;if(T)le=T.canvas,v.scale(A,-A);else{const Ie=l[0],Fe=Ie.extent;le=Ie.image,v.scale(pn(Fe)/le.width,-ti(Fe)/le.height)}v.drawImage(le,0,0),v.restore()}),T&&(Ew(T),f0.push(T.canvas)),h&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,o.getTriangles().forEach(function(O,z,I){const R=O.target,P=(R[0][0]-M[0])/s,F=-(R[0][1]-M[1])/s,N=(R[1][0]-M[0])/s,B=-(R[1][1]-M[1])/s,j=(R[2][0]-M[0])/s,ve=-(R[2][1]-M[1])/s;v.beginPath(),v.moveTo(N,B),v.lineTo(P,F),v.lineTo(j,ve),v.closePath(),v.stroke()}),v.restore()),v.canvas}const hK=10,WM=.25;class MF{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const c=o?JT(A=>Dr(o,p1(A,this.targetProj_,this.sourceProj_))):pp(this.targetProj_,this.sourceProj_);this.transformInv_=function(A){const M=A[0]+"/"+A[1];return l[M]||(l[M]=c(A)),l[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&pn(i)>=pn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?pn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?pn(this.targetProj_.getExtent()):null;const h=Ad(r),g=mw(r),m=gw(r),y=fw(r),v=this.transformInv_(h),x=this.transformInv_(g),w=this.transformInv_(m),T=this.transformInv_(y),b=hK+(a?Math.max(0,Math.ceil(Math.log2(XT(r)/(a*a*256*256)))):0);if(this.addQuad_(h,g,m,y,v,x,w,T,b),this.wrapsXInSource_){let A=1/0;this.triangles_.forEach(function(M,O,z){A=Math.min(A,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-A>this.sourceWorldWidth_/2){const O=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];O[0][0]-A>this.sourceWorldWidth_/2&&(O[0][0]-=this.sourceWorldWidth_),O[1][0]-A>this.sourceWorldWidth_/2&&(O[1][0]-=this.sourceWorldWidth_),O[2][0]-A>this.sourceWorldWidth_/2&&(O[2][0]-=this.sourceWorldWidth_);const z=Math.min(O[0][0],O[1][0],O[2][0]);Math.max(O[0][0],O[1][0],O[2][0])-z<this.sourceWorldWidth_/2&&(M.source=O)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,c){const h=H4([s,a,o,l]),g=this.sourceWorldWidth_?pn(h)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&g>.5&&g<1;let v=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=H4([e,t,r,i]);v=pn(w)/this.targetWorldWidth_>WM||v}!y&&this.sourceProj_.isGlobal()&&g&&(v=g>WM||v)}if(!v&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!_s(h,this.maxSourceExtent_))return;let x=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)v=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(c>0){if(!v){const w=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(w);let b;y?b=(vu(s[0],m)+vu(o[0],m))/2-vu(T[0],m):b=(s[0]+o[0])/2-T[0];const A=(s[1]+o[1])/2-T[1];v=b*b+A*A>this.errorThresholdSquared_}if(v){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const w=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(w),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],A=this.transformInv_(b);this.addQuad_(e,t,w,b,s,a,T,A,c-1),this.addQuad_(b,w,r,i,A,T,o,l,c-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(w),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],A=this.transformInv_(b);this.addQuad_(e,w,b,i,s,T,A,l,c-1),this.addQuad_(w,t,r,b,T,a,o,A,c-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,o,l),(x&14)==0&&this.addTriangle_(e,r,t,s,o,a),x&&((x&13)==0&&this.addTriangle_(t,i,e,a,l,s),(x&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=zs();return this.triangles_.forEach(function(t,r,i){const s=t.source;Om(e,s[0]),Om(e,s[1]),Om(e,s[2])}),e}getTriangles(){return this.triangles_}}const NF=.5;class LF extends AR{constructor(e,t,r,i,s,a,o,l,c,h,g,m){super(s,jt.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const w=v?ql(y,v):y;if(XT(w)===0){this.state=jt.EMPTY;return}const T=e.getExtent();T&&(x?x=ql(x,T):x=T);const b=i.getResolution(this.wrappedTileCoord_[0]),A=uK(e,r,w,b);if(!isFinite(A)||A<=0){this.state=jt.EMPTY;return}const M=h!==void 0?h:NF;if(this.triangulation_=new MF(e,r,w,x,A*M,b),this.triangulation_.getTriangles().length===0){this.state=jt.EMPTY;return}this.sourceZ_=t.getZForResolution(A);let O=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(O[1]=cr(O[1],x[1],x[3]),O[3]=cr(O[3],x[1],x[3])):O=ql(O,x)),!XT(O))this.state=jt.EMPTY;else{let z=0,I=0;e.canWrapX()&&(z=pn(T),I=Math.floor((O[0]-T[0])/z)),wD(O.slice(),e,!0).forEach(P=>{const F=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let N=F.minX;N<=F.maxX;N++)for(let B=F.minY;B<=F.maxY;B++){const j=c(this.sourceZ_,N,B,o);if(j){const ve=I*z;this.sourceTiles_.push({tile:j,offset:ve})}}++I}),this.sourceTiles_.length===0&&(this.state=jt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==jt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=jt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=PF(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=jt.LOADED}this.changed()}load(){if(this.state==jt.IDLE){this.state=jt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==jt.IDLE||r==jt.LOADING){e++;const i=mn(t,Jt.CHANGE,s=>{const a=t.getState();(a==jt.LOADED||a==jt.ERROR||a==jt.EMPTY)&&(ir(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==jt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ir),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Ew(this.canvas_.getContext("2d")),f0.push(this.canvas_),this.canvas_=null),super.release()}}class RR{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Tf(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new RR(n,e,t,r)}class HM{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof u1&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return En(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return En(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){En(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function $_(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function dK(n,e,t){return n+"/"+e+"/"+t}function Qx(n,e,t,r,i){return`${$t(n)},${e},${dK(t,r,i)}`}function OF(n){return fK(n[0],n[1],n[2])}function fK(n,e,t){return(e<<n)+t}function gK(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class IR extends yF{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=mi(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Nn.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Ti.PRECOMPOSE)){const i=new Fm(Ti.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Ti.POSTCOMPOSE)){const i=new Fm(Ti.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,r=-1,i;for(let a=0,o=e.layerStatesArray.length;a<o;a++){const l=e.layerStatesArray[a].layer,c=l.getRenderer();if(!(c instanceof IR)){t=!0;continue}const h=l.getClassName();if((t||h!==i)&&(r+=1,t=!1),i=h,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new iK({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Nn.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){Ga(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new Fm(e,this.inversePixelTransform_,r,t);i.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(Ti.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(Ti.POSTRENDER,e,t)}}const MS={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class mK{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function pK(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}function wu(n){const e=n.toString();return e.includes(".")?e:e+".0"}function CR(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(wu).join(", ")})`}function Jx(n){const e=za(n),t=e.length>3?e[3]:1;return CR([e[0]/255,e[1]/255,e[2]/255,t])}function yK(n){const e=ws(n);return CR(e)}const NS={};let xK=0;function Ap(n){return n in NS||(NS[n]=xK++),NS[n]}function zl(n){return wu(Ap(n))}function kR(n){return"u_var_"+n}function DF(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const LS="getBandValue",_K="u_paletteTextures",FF="featureId",jF="geometryType",db=-9999999;function vK(n,e,t,r){const i=Ii(n,e,t);return PR(i,e,r)}function Rn(n){return(e,t,r)=>{const i=t.args.length,s=new Array(i);for(let a=0;a<i;++a)s[a]=PR(t.args[a],r,e);return n(s,e)}}const wK={[pe.Get]:(n,e)=>{const r=e.args[0].value;r in n.properties||(n.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Ko(e.type,ei)&&(s=`(${s} > 0.0)`),s},[pe.Id]:n=>(n.featureId=!0,"a_"+FF),[pe.GeometryType]:n=>(n.geometryType=!0,"a_"+jF),[pe.LineMetric]:()=>"currentLineMetric",[pe.Var]:(n,e)=>{const r=e.args[0].value;r in n.variables||(n.variables[r]={name:r,type:e.type});let s=kR(r);return Ko(e.type,ei)&&(s=`(${s} > 0.0)`),s},[pe.Has]:(n,e)=>{const r=e.args[0].value;return r in n.properties||(n.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${wu(db)})`},[pe.Resolution]:()=>"u_resolution",[pe.Zoom]:()=>"u_zoom",[pe.Time]:()=>"u_time",[pe.Any]:Rn(n=>`(${n.join(" || ")})`),[pe.All]:Rn(n=>`(${n.join(" && ")})`),[pe.Not]:Rn(([n])=>`(!${n})`),[pe.Equal]:Rn(([n,e])=>`(${n} == ${e})`),[pe.NotEqual]:Rn(([n,e])=>`(${n} != ${e})`),[pe.GreaterThan]:Rn(([n,e])=>`(${n} > ${e})`),[pe.GreaterThanOrEqualTo]:Rn(([n,e])=>`(${n} >= ${e})`),[pe.LessThan]:Rn(([n,e])=>`(${n} < ${e})`),[pe.LessThanOrEqualTo]:Rn(([n,e])=>`(${n} <= ${e})`),[pe.Multiply]:Rn(n=>`(${n.join(" * ")})`),[pe.Divide]:Rn(([n,e])=>`(${n} / ${e})`),[pe.Add]:Rn(n=>`(${n.join(" + ")})`),[pe.Subtract]:Rn(([n,e])=>`(${n} - ${e})`),[pe.Clamp]:Rn(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[pe.Mod]:Rn(([n,e])=>`mod(${n}, ${e})`),[pe.Pow]:Rn(([n,e])=>`pow(${n}, ${e})`),[pe.Abs]:Rn(([n])=>`abs(${n})`),[pe.Floor]:Rn(([n])=>`floor(${n})`),[pe.Ceil]:Rn(([n])=>`ceil(${n})`),[pe.Round]:Rn(([n])=>`floor(${n} + 0.5)`),[pe.Sin]:Rn(([n])=>`sin(${n})`),[pe.Cos]:Rn(([n])=>`cos(${n})`),[pe.Atan]:Rn(([n,e])=>e!==void 0?`atan(${n}, ${e})`:`atan(${n})`),[pe.Sqrt]:Rn(([n])=>`sqrt(${n})`),[pe.Match]:Rn(n=>{const e=n[0],t=n[n.length-1];let r=null;for(let i=n.length-3;i>=1;i-=2){const s=n[i],a=n[i+1];r=`(${e} == ${s} ? ${a} : ${r||t})`}return r}),[pe.Between]:Rn(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[pe.Interpolate]:Rn(([n,e,...t])=>{let r="";for(let i=0;i<t.length-2;i+=2){const s=t[i],a=r||t[i+1],o=t[i+2],l=t[i+3];let c;n===wu(1)?c=`(${e} - ${s}) / (${o} - ${s})`:c=`(pow(${n}, (${e} - ${s})) - 1.0) / (pow(${n}, (${o} - ${s})) - 1.0)`,r=`mix(${a}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[pe.Case]:Rn(n=>{const e=n[n.length-1];let t=null;for(let r=n.length-3;r>=0;r-=2){const i=n[r],s=n[r+1];t=`(${i} ? ${s} : ${t||e})`}return t}),[pe.In]:Rn(([n,...e],t)=>{const r=pK("in",t),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${n})`}),[pe.Array]:Rn(n=>`vec${n.length}(${n.join(", ")})`),[pe.Color]:Rn(n=>{if(n.length===1)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(n.length===2)return`vec4(vec3(${n[0]} / 255.0), ${n[1]})`;const e=n.slice(0,3).map(r=>`${r} / 255.0`);if(n.length===3)return`vec4(${e.join(", ")}, 1.0)`;const t=n[3];return`vec4(${e.join(", ")}, ${t})`}),[pe.Band]:Rn(([n,e,t],r)=>{if(!(LS in r.functions)){let i="";const s=r.bandCount||1;for(let a=0;a<s;a++){const o=Math.floor(a/4);let l=a%4;a===s-1&&l===1&&(l=3);const c=`${MS.TILE_TEXTURE_ARRAY}[${o}]`;i+=`  if (band == ${a+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[LS]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${MS.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${MS.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${LS}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[pe.Palette]:(n,e)=>{const[t,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const h=r[c].value,g=za(h),m=c*4;s[m]=g[0],s[m+1]=g[1],s[m+2]=g[2],s[m+3]=g[3]*255}n.paletteTextures||(n.paletteTextures=[]);const a=`${_K}[${n.paletteTextures.length}]`,o=new mK(a,s);n.paletteTextures.push(o);const l=PR(t,Tt,n);return`texture2D(${a}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function PR(n,e,t){if(n instanceof xF){const r=wK[n.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return r(t,n,e)}if((n.type&Tt)>0)return wu(n.value);if((n.type&ei)>0)return n.value.toString();if((n.type&gi)>0)return zl(n.value.toString());if((n.type&Er)>0)return Jx(n.value);if((n.type&$s)>0)return CR(n.value);if((n.type&Oa)>0)return yK(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${e0(e)})`)}function EK(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const KM=.985;function qt(n,e,t){const r=yR();return vK(e,t,r,n)}function SK(n){const e=za(n),t=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[t+r,i+s]}const TK=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function MR(n){return n===Er||n===Oa?2:n===$s?4:1}function fb(n){const e=MR(n);return e>1?`vec${e}`:"float"}function VF(n,e){for(const t in e.variables){const r=e.variables[t],i=kR(r.name);let s=fb(r.type);r.type===Er&&(s="vec4"),n.addUniform(i,s)}for(const t in e.properties){const r=e.properties[t],i=fb(r.type),s=`a_prop_${r.name}`;r.type===Er?n.addAttribute(s,i,`unpackColor(${s})`,"vec4"):n.addAttribute(s,i)}for(const t in e.functions)n.addVertexShaderFunction(e.functions[t]),n.addFragmentShaderFunction(e.functions[t])}function BF(n,e){const t={};for(const r in n.variables){const i=n.variables[r],s=kR(i.name);t[s]=()=>{const a=e[i.name];if(typeof a=="number")return a;if(typeof a=="boolean")return a?1:0;if(i.type===Er){const o=[...za(a||"#eee")];return o[0]/=255,o[1]/=255,o[2]/=255,o[3]??=1,o}return typeof a=="string"?Ap(a):a}}return t}function GF(n){const e={};for(const t in n.properties){const r=n.properties[t],i=s=>{const a=s.get(r.name);return r.type===Er?SK([...za(a||"#eee")]):typeof a=="string"?Ap(a):typeof a=="boolean"?a?1:0:a};e[`prop_${r.name}`]={size:MR(r.type),callback:i}}return e}const bf=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${TK}
`,Af=EK();class zF{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${wu(Af["circle-radius"])} + ${wu(Af["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=Jx(Af["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=wu(Af["stroke-width"]),this.strokeColorExpression_=Jx(Af["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=zl("round"),this.strokeJoinExpression_=zl("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=Jx(Af["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,t){return this.uniforms_.push({name:e,type:t}),this}addAttribute(e,t,r,i){return this.attributes_.push({name:e,type:t,varyingName:e.replace(/^a_/,"v_"),varyingType:i??t,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${KM} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${KM}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${zl("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${zl("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${zl("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${zl("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class W_{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,t){for(let r=0;r<e.length;r++)this.addFeature(e[r],t)}addFeature(e,t){let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const t=$t(e),r=this.pointBatch.entries[t];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[t],r}clearFeatureEntryInLineStringBatch_(e){const t=$t(e),r=this.lineStringBatch.entries[t];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[t],r}clearFeatureEntryInPolygonBatch_(e){const t=$t(e),r=this.polygonBatch.entries[t];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[t],r}addGeometry_(e,t){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,t);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),t,$t(t),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,$t(t),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,$t(t),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,$t(t),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,$t(t),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,t,$t(t),s,i.getLayout?.());break}}}addCoordinates_(e,t,r,i,s,a,o){let l;switch(e){case"MultiPolygon":{const c=r;for(let h=0,g=c.length;h<g;h++){let m=c[h];const y=h>0?c[h-1]:null,v=y?y[y.length-1]:0,x=m[m.length-1];m=v>0?m.map(w=>w-v):m,this.addCoordinates_("Polygon",t.slice(v,x),m,i,s,a,o)}break}case"MultiLineString":{const c=r;for(let h=0,g=c.length;h<g;h++){const m=h>0?c[h-1]:0;this.addCoordinates_("LineString",t.slice(m,c[h]),null,i,s,a,o)}break}case"MultiPoint":for(let c=0,h=t.length;c<h;c+=a)this.addCoordinates_("Point",t.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof Ds){const m=lF(t,c);if(m.length>1){this.addCoordinates_("MultiPolygon",t,m,i,s,a,o);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=t.length/a;const h=r.length,g=r.map((m,y,v)=>y>0?(m-v[y-1])/a:m/a);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(bK(t,a)),this.polygonBatch.entries[s].ringsVerticesCounts.push(g),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let m=0,y=c.length;m<y;m++){const v=m>0?c[m-1]:0;this.addCoordinates_("LinearRing",t.slice(v,c[m]),null,i,s,a,o)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(t);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=t.length/a,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(AK(t,a,o)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,t){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return t.ref=i,r||(this.refToFeature_.set(i,t.feature),this.uidToRef_.set(e,i)),t}removeRef_(e,t){if(!e)throw new Error("This feature has no ref: "+t);this.refToFeature_.delete(e),this.uidToRef_.delete(t),this.freeGlobalRef_.push(e)}changeFeature(e,t){if(!this.uidToRef_.get($t(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}removeFeature(e){let t=this.clearFeatureEntryInPointBatch_(e);t=this.clearFeatureEntryInPolygonBatch_(e)||t,t=this.clearFeatureEntryInLineStringBatch_(e)||t,t&&this.removeRef_(t.ref,$t(t.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const t=new W_;t.globalCounter_=this.globalCounter_,t.uidToRef_=this.uidToRef_,t.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(t.addFeature(i),r=!1);return r?new W_:t}}function bK(n,e){return e===2?n:n.filter((t,r)=>r%e<2)}function AK(n,e,t){return e===3&&t==="XYM"?n:e===4?n.filter((r,i)=>i%e!==2):e===3?n.map((r,i)=>i%e!==2?r:0):new Array(n.length*1.5).fill(0).map((r,i)=>i%3===2?0:n[Math.round(i/1.5)])}function RK(){const n='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}const OS={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function IK(n,e){e=e||[];const t=256,r=t-1,i=Math.floor(n/t/t/t)/r,s=Math.floor(n/t/t)%t/r,a=Math.floor(n/t)%t/r,o=n%t/r;return e[0]=i*256*255+s*255,e[1]=a*256*255+o*255,e}function CK(n){let e=0;const t=256,r=t-1;return e+=Math.round(n[0]*t*t*t*r),e+=Math.round(n[1]*t*t*r),e+=Math.round(n[2]*t*r),e+=Math.round(n[3]*r),e}function NR(n,e,t,r){let i=0;for(const s in e){const a=e[s],o=a.callback.call(t,t.feature);let l=o?.[0]??o;l===db&&console.warn('The "has" operator might return false positives.'),l===void 0?l=db:l===null&&(l=0),n[r+i++]=l,!(!a.size||a.size===1)&&(n[r+i++]=o[1],!(a.size<3)&&(n[r+i++]=o[2],!(a.size<4)&&(n[r+i++]=o[3])))}return i}function Cw(n){return Object.keys(n).reduce((e,t)=>e+(n[t].size||1),0)}function kK(n,e,t,r){const i=(2+Cw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Dr(r,s),e[a++]=s[0],e[a++]=s[1],a+=NR(e,t,l,a)}return e}function PK(n,e,t,r){const i=3*n.verticesCount+(1+Cw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,tl(l.flatCoordss[c],0,s.length,3,r,s,3),a+=NR(e,t,l,a),e[a++]=s.length/3;for(let g=0,m=s.length;g<m;g+=3)e[a++]=s[g],e[a++]=s[g+1],e[a++]=s[g+2]}}return e}function MK(n,e,t,r){const i=2*n.verticesCount+(1+Cw(t))*n.geometriesCount+n.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,tl(l.flatCoordss[c],0,s.length,2,r,s),a+=NR(e,t,l,a),e[a++]=l.ringsVerticesCounts[c].length;for(let g=0,m=l.ringsVerticesCounts[c].length;g<m;g++)e[a++]=l.ringsVerticesCounts[c][g];for(let g=0,m=s.length;g<m;g+=2)e[a++]=s[g],e[a++]=s[g+1]}}return e}function H_(n){return(JSON.stringify(n).split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0),0)>>>0).toString()}function LR(n,e,t,r){if(`${r}radius`in n&&r!=="icon-"){let i=qt(t,n[`${r}radius`],Tt);if(`${r}radius2`in n){const s=qt(t,n[`${r}radius2`],Tt);i=`max(${i}, ${s})`}`${r}stroke-width`in n&&(i=`(${i} + ${qt(t,n[`${r}stroke-width`],Tt)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in n){const i=qt(t,n[`${r}scale`],Oa);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in n&&e.setSymbolOffsetExpression(qt(t,n[`${r}displacement`],$s)),`${r}rotation`in n&&e.setSymbolRotationExpression(qt(t,n[`${r}rotation`],Tt)),`${r}rotate-with-view`in n&&e.setSymbolRotateWithView(!!n[`${r}rotate-with-view`])}function UF(n,e,t,r,i){let s="vec4(0.)";if(e!==null&&(s=e),t!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${n})`;s=`mix(${t}, ${s}, ${l})`}const a=`(1.0 - smoothstep(-0.63, 0.58, ${n}))`;let o=`${s} * vec4(1.0, 1.0, 1.0, ${a})`;return i!==null&&(o=`${o} * vec4(1.0, 1.0, 1.0, ${i})`),o}function OR(n,e,t,r,i){const s=new Image;s.crossOrigin=n[`${r}cross-origin`]===void 0?"anonymous":n[`${r}cross-origin`],En(typeof n[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=n[`${r}src`],t[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const a=`u_texture${i}_size`;return t[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),a}function DR(n,e,t,r,i){let s=qt(t,n[`${e}offset`],Oa);if(`${e}offset-origin`in n)switch(n[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function NK(n,e,t,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,LR(n,e,r,"circle-");let i=null;"circle-opacity"in n&&(i=qt(r,n["circle-opacity"],Tt));let s="coordsPx";"circle-scale"in n&&(s=`coordsPx / ${qt(r,n["circle-scale"],Oa)}`);let a=null;"circle-fill-color"in n&&(a=qt(r,n["circle-fill-color"],Er));let o=null;"circle-stroke-color"in n&&(o=qt(r,n["circle-stroke-color"],Er));let l=qt(r,n["circle-radius"],Tt),c=null;"circle-stroke-width"in n&&(c=qt(r,n["circle-stroke-width"],Tt),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,g=UF(h,a,o,c,i);e.setSymbolColorExpression(g)}function LK(n,e,t,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,LR(n,e,r,"shape-");let i=null;"shape-opacity"in n&&(i=qt(r,n["shape-opacity"],Tt));let s="coordsPx";"shape-scale"in n&&(s=`coordsPx / ${qt(r,n["shape-scale"],Oa)}`);let a=null;"shape-fill-color"in n&&(a=qt(r,n["shape-fill-color"],Er));let o=null;"shape-stroke-color"in n&&(o=qt(r,n["shape-stroke-color"],Er));let l=null;"shape-stroke-width"in n&&(l=qt(r,n["shape-stroke-width"],Tt));const c=qt(r,n["shape-points"],Tt);let h="0.";"shape-angle"in n&&(h=qt(r,n["shape-angle"],Tt));let g,m=qt(r,n["shape-radius"],Tt);if(l!==null&&(m=`${m} + ${l} * 0.5`),"shape-radius2"in n){let v=qt(r,n["shape-radius2"],Tt);l!==null&&(v=`${v} + ${l} * 0.5`),g=`starDistanceField(${s}, ${c}, ${m}, ${v}, ${h})`}else g=`regularDistanceField(${s}, ${c}, ${m}, ${h})`;const y=UF(g,a,o,l,i);e.setSymbolColorExpression(y)}function OK(n,e,t,r){let i="vec4(1.0)";"icon-color"in n&&(i=qt(r,n["icon-color"],Er)),"icon-opacity"in n&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${qt(r,n["icon-opacity"],Tt)})`);const s=H_(n["icon-src"]),a=OR(n,e,t,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(a),"icon-width"in n&&"icon-height"in n&&e.setSymbolSizeExpression(`vec2(${qt(r,n["icon-width"],Tt)}, ${qt(r,n["icon-height"],Tt)})`),"icon-offset"in n&&"icon-size"in n){const o=qt(r,n["icon-size"],$s),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(o);const c=DR(n,"icon-",r,"v_quadSizePx",o);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${o})) / (${l}).xyxy`)}if(LR(n,e,r,"icon-"),"icon-anchor"in n){const o=qt(r,n["icon-anchor"],$s);let l="1.0";"icon-scale"in n&&(l=qt(r,n["icon-scale"],Oa));let c;n["icon-anchor-x-units"]==="pixels"&&n["icon-anchor-y-units"]==="pixels"?c=`${o} * ${l}`:n["icon-anchor-x-units"]==="pixels"?c=`${o} * vec2(vec2(${l}).x, v_quadSizePx.y)`:n["icon-anchor-y-units"]==="pixels"?c=`${o} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${o} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in n)switch(n["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${h}`)}}function DK(n,e,t,r){if("stroke-color"in n&&e.setStrokeColorExpression(qt(r,n["stroke-color"],Er)),"stroke-pattern-src"in n){const i=H_(n["stroke-pattern-src"]),s=OR(n,e,t,"stroke-pattern-",i);let a=s,o="vec2(0.)";"stroke-pattern-offset"in n&&"stroke-pattern-size"in n&&(a=qt(r,n["stroke-pattern-size"],$s),o=DR(n,"stroke-pattern-",r,s,a));let l="0.";"stroke-pattern-spacing"in n&&(l=qt(r,n["stroke-pattern-spacing"],Tt));let c="0.";"stroke-pattern-start-offset"in n&&(c=qt(r,n["stroke-pattern-start-offset"],Tt)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const h=`u_texture${i}`;let g="1.";"stroke-color"in n&&(g=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${g} * sampleStrokePattern(${h}, ${s}, ${o}, ${a}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${a}, ${l}, v_width)`)}if("stroke-width"in n&&e.setStrokeWidthExpression(qt(r,n["stroke-width"],Tt)),"stroke-offset"in n&&e.setStrokeOffsetExpression(qt(r,n["stroke-offset"],Tt)),"stroke-line-cap"in n&&e.setStrokeCapExpression(qt(r,n["stroke-line-cap"],gi)),"stroke-line-join"in n&&e.setStrokeJoinExpression(qt(r,n["stroke-line-join"],gi)),"stroke-miter-limit"in n&&e.setStrokeMiterLimitExpression(qt(r,n["stroke-miter-limit"],Tt)),"stroke-line-dash"in n){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${zl("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${zl("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=n["stroke-line-dash"].map(v=>qt(r,v,Tt));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in n&&(s=qt(r,n["stroke-line-dash-offset"],Tt));const o=`dashDistanceField_${H_(n["stroke-line-dash"])}`,l=i.map((v,x)=>`float dashLength${x}`).join(", "),c=i.map((v,x)=>`dashLength${x}`).join(" + ");let h="0.",g=`getSingleDashDistance(distance, radius, ${h}, dashLength0, totalDashLength, capType, lineWidth)`;for(let v=2;v<i.length;v+=2)h=`${h} + dashLength${v-2} + dashLength${v-1}`,g=`min(${g}, getSingleDashDistance(distance, radius, ${h}, dashLength${v}, totalDashLength, capType, lineWidth))`;r.functions[o]=`float ${o}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${g};
}`;const m=i.map((v,x)=>`${v}`).join(", ");e.setStrokeDistanceFieldExpression(`${o}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${m})`);let y=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,y=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${y})`),e.setStrokePatternLengthExpression(y)}}function FK(n,e,t,r){if("fill-color"in n&&e.setFillColorExpression(qt(r,n["fill-color"],Er)),"fill-pattern-src"in n){const i=H_(n["fill-pattern-src"]),s=OR(n,e,t,"fill-pattern-",i);let a=s,o="vec2(0.)";"fill-pattern-offset"in n&&"fill-pattern-size"in n&&(a=qt(r,n["fill-pattern-size"],$s),o=DR(n,"fill-pattern-",r,s,a)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in n&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${o}, ${a}, pxOrigin, pxPos)`)}}function XM(n,e,t){const r=DF(),i=new zF,s={};if("icon-src"in n?OK(n,i,s,r):"shape-points"in n?LK(n,i,s,r):"circle-radius"in n&&NK(n,i,s,r),DK(n,i,s,r),FK(n,i,s,r),t){const l=qt(r,t,ei);i.setFragmentDiscardExpression(`!${l}`)}const a={};function o(l,c,h,g){if(!r[l])return;const m=fb(h),y=MR(h);i.addAttribute(`a_${c}`,m),a[c]={size:y,callback:g}}return o("geometryType",jF,gi,l=>Ap(xR(l.getGeometry()))),o("featureId",FF,gi|Tt,l=>{const c=l.getId()??null;return typeof c=="string"?Ap(c):c}),VF(i,r),{builder:i,attributes:{...a,...GF(r)},uniforms:{...s,...BF(r,e)}}}const jK=[];let DS;function VK(){return DS||(DS=RK()),DS}let BK=0;const Aa={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class GK{constructor(e,t,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=zK(e,t),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return IK(this.ref,jK)},size:2});for(const s of this.styleShaders){for(const a in s.attributes)a in this.customAttributes_||(this.customAttributes_[a]=s.attributes[a]);for(const a in s.uniforms)a in this.uniforms_||(this.uniforms_[a]=s.uniforms[a])}this.renderPasses_=this.styleShaders.map(s=>{const a={},o=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:Fi.FLOAT}));return s.builder.getFillVertexShader()&&(a.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Aa.POSITION,size:2,type:Fi.FLOAT},...o],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(a.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Aa.LOCAL_POSITION,size:2,type:Fi.FLOAT}],instancedAttributesDesc:[{name:Aa.SEGMENT_START,size:2,type:Fi.FLOAT},{name:Aa.MEASURE_START,size:1,type:Fi.FLOAT},{name:Aa.SEGMENT_END,size:2,type:Fi.FLOAT},{name:Aa.MEASURE_END,size:1,type:Fi.FLOAT},{name:Aa.JOIN_ANGLES,size:2,type:Fi.FLOAT},{name:Aa.DISTANCE_LOW,size:1,type:Fi.FLOAT},{name:Aa.DISTANCE_HIGH,size:1,type:Fi.FLOAT},{name:Aa.ANGLE_TANGENT_SUM,size:1,type:Fi.FLOAT},...o],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(a.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Aa.LOCAL_POSITION,size:2,type:Fi.FLOAT}],instancedAttributesDesc:[{name:Aa.POSITION,size:2,type:Fi.FLOAT},...o],instancePrimitiveVertexCount:6}),a}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,t){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,t),[i,s,a]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",t),this.generateBuffersForType_(r.lineStringInstructions,"LineString",t),this.generateBuffersForType_(r.pointInstructions,"Point",t)]),o=yp(mi(),t);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:a,invertVerticesTransform:o}}generateRenderInstructions_(e,t){const r=this.hasFill_?MK(e.polygonBatch,new Float32Array(0),this.customAttributes_,t):null,i=this.hasStroke_?PK(e.lineStringBatch,new Float32Array(0),this.customAttributes_,t):null,s=this.hasSymbol_?kK(e.pointBatch,new Float32Array(0),this.customAttributes_,t):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,t,r){if(e===null)return null;const i=BK++;let s;switch(t){case"Polygon":s=OS.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=OS.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=OS.GENERATE_POINT_BUFFERS;break}const a={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:Cw(this.customAttributes_)},o=VK();return o.postMessage(a,[e.buffer]),e=null,new Promise(l=>{const c=h=>{const g=h.data;if(g.id!==i||(o.removeEventListener("message",c),!this.helper_.getGL()))return;const m=new CS(bR,IS).fromArrayBuffer(g.indicesBuffer),y=new CS(G_,IS).fromArrayBuffer(g.vertexAttributesBuffer),v=new CS(G_,IS).fromArrayBuffer(g.instanceAttributesBuffer);this.helper_.flushBufferData(m),this.helper_.flushBufferData(y),this.helper_.flushBufferData(v),l([m,y,v])};o.addEventListener("message",c)})}render(e,t,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,t,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,t,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,t,r)}renderInternal_(e,t,r,i,s,a){const o=e.getSize();if(o===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(t),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),a(),l){const c=i.instancedAttributesDesc.reduce((g,m)=>g+(m.size||1),0),h=r.getSize()/c;this.helper_.drawElementsInstanced(0,o,h)}else this.helper_.drawElements(0,o)}setHelper(e,t=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),t&&(t.polygonBuffers&&(this.helper_.flushBufferData(t.polygonBuffers[0]),this.helper_.flushBufferData(t.polygonBuffers[1]),this.helper_.flushBufferData(t.polygonBuffers[2])),t.lineStringBuffers&&(this.helper_.flushBufferData(t.lineStringBuffers[0]),this.helper_.flushBufferData(t.lineStringBuffers[1]),this.helper_.flushBufferData(t.lineStringBuffers[2])),t.pointBuffers&&(this.helper_.flushBufferData(t.pointBuffers[0]),this.helper_.flushBufferData(t.pointBuffers[1]),this.helper_.flushBufferData(t.pointBuffers[2])))}}function zK(n,e){const t=Array.isArray(n)?n:[n];if("style"in t[0]){const r=[],i=t,s=[];for(const a of i){const o=Array.isArray(a.style)?a.style:[a.style];let l=a.filter;a.else&&s.length&&(l=["all",...s.map(h=>["!",h])],a.filter&&l.push(a.filter),l.length<3&&(l=l[1])),a.filter&&s.push(a.filter);const c=o.map(h=>XM(h,e,l));r.push(...c)}return r}return"builder"in t[0]?t:t.map(r=>XM(r,e,null))}const $o=new Uint8Array(4);class UK{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){fc(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return $o[0]=0,$o[1]=0,$o[2]=0,$o[3]=0,$o;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return $o[0]=this.data_[r*4],$o[1]=this.data_[r*4+1],$o[2]=this.data_[r*4+2],$o[3]=this.data_[r*4+3],$o}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function $K(n,e){const t=n.viewState.projection,i=e.getSource().getWrapX()&&t.canWrapX(),s=t.getExtent(),a=n.extent,o=i?pn(s):null,l=i?Math.ceil((a[2]-s[2])/o)+1:1;return[i?Math.floor((a[0]-s[0])/o):0,l,o]}const Rf={...Bl,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class WK extends IR{constructor(e,t){const r={[Rf.RENDER_EXTENT]:[0,0,0,0],[Rf.PATTERN_ORIGIN]:[0,0],[Rf.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:t.postProcesses}),this.hitDetectionEnabled_=!t.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=zs(),this.currentTransform_=mi(),this.tmpCoords_=[0,0],this.tmpTransform_=mi(),this.tmpMat4_=RF(),this.currentFrameStateTransform_=mi(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(t),this.batch_=new W_,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const t=this.getLayer().getSource();let r;this.batch_.addFeatures(t.getFeatures(),r),this.sourceListenKeys_=[mn(t,ns.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),mn(t,ns.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),mn(t,ns.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),mn(t,ns.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new GK(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new UK(this.helper))}handleSourceFeatureAdded_(e,t){const r=t.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,t){const r=t.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const t=e.feature;this.batch_.removeFeature(t)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){LD(this.tmpTransform_,this.currentFrameStateTransform_),ND(this.tmpTransform_,e),this.helper.setUniformMatrixValue(Rf.PROJECTION_MATRIX,ub(this.tmpMat4_,this.tmpTransform_)),yp(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(Rf.SCREEN_TO_WORLD_MATRIX,ub(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,yp(this.tmpTransform_,e),Dr(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(Rf.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[r,i,s]=$K(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const a=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),a}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[Jr.ANIMATING]&&!e.viewHints[Jr.INTERACTING],a=!rd(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(a||o)){const l=i.projection,c=i.resolution,h=t instanceof Rw?t.getRenderBuffer():0,g=C0(e.extent,h*c);r.loadFeatures(g,c,l),this.ready=!1;const m=this.helper.makeProjectionTransform(e,mi());this.styleRenderer_.generateBuffers(this.batch_,m).then(y=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=y,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,t,r,i,s){let a=r;t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),g$(this.currentFrameStateTransform_,a*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(t)});while(++a<i)}forEachFeatureAtCoordinate(e,t,r,i,s){if(En(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const a=Dr(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],c=CK(l),h=this.batch_.getFeatureFromRef(c);if(h)return i(h,this.getLayer(),null)}disposeBuffers(e){const t=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&t(e.pointBuffers),e.lineStringBuffers&&t(e.lineStringBuffers),e.polygonBuffers&&t(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){ir(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const jl={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},HK=["#00f","#0ff","#0f0","#ff0","#f00"];class KK extends Rw{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(jl.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:HK),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(jl.BLUR)}getGradient(){return this.get(jl.GRADIENT)}getRadius(){return this.get(jl.RADIUS)}handleGradientChanged_(){this.gradient_=XK(this.getGradient())}setBlur(e){const t=this.get(jl.BLUR);if(this.set(jl.BLUR,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(jl.GRADIENT,e)}setRadius(e){const t=this.get(jl.RADIUS);if(this.set(jl.RADIUS,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new zF,t=DF(),r=qt(t,this.filter_,ei);let i=qt(t,this.getRadius(),Tt),s=qt(t,this.getBlur(),Tt);const a={};typeof this.getBlur()=="number"&&(s="a_blur",a.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",a.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const o={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const g=typeof this.weight_=="string"?m=>m.get(this.weight_):this.weight_;o.prop_weight={size:1,callback:m=>{const y=g(m);return y!==void 0?cr(y,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const g=["clamp",this.weight_,0,1];l=qt(t,g,Tt)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),VF(e,t);const c=GF(t),h=BF(t,this.styleVariables_);return new WK(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...o},uniforms:{...h,...a}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function XK(n){const r=ii(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let a=0,o=n.length;a<o;++a)i.addColorStop(a*s,n[a]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class qK extends mR{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=ql(l,Zo(t.extent,i.projection))),!o[Jr.ANIMATING]&&!o[Jr.INTERACTING]&&!ig(l))if(a){const c=i.projection,h=a.getImage(l,s,r,c);h&&(this.loadImage(h)?this.image=h:h.getState()===Et.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Dr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!nd(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=pn(a),c=Math.floor(o.width*((i[0]-a[0])/l));if(c<0||c>=o.width)return null;const h=ti(a),g=Math.floor(o.height*((a[3]-i[1])/h));return g<0||g>=o.height?null:this.getImageData(o,c,g)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,g=e.viewState,m=g.center,y=g.resolution,v=h*a/(y*l),x=h*o/(y*l);this.prepareContainer(e,t);const w=this.context.canvas.width,T=this.context.canvas.height,b=this.getRenderContext(e);let A=!1,M=!0;if(c.extent){const P=Zo(c.extent,g.projection);M=_s(P,e.extent),A=M&&!lu(P,e.extent),A&&this.clipUnrotated(b,e,P)}const O=r.getImage(),z=Ga(this.tempTransform,w/2,T/2,v,x,0,l*(i[0]-m[0])/a,l*(m[1]-i[3])/o);this.renderedResolution=o*h/l;const I=O.width*z[0],R=O.height*z[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),M&&I>=.5&&R>=.5){const P=z[4],F=z[5],N=c.opacity;N!==1&&(b.save(),b.globalAlpha=N),b.drawImage(O,0,0,+O.width,+O.height,P,F,I,R),N!==1&&b.restore()}return this.postRender(this.context,e),A&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class YK extends w1{constructor(e){e=e||{},super(e)}}class ZK extends YK{constructor(e){super(e)}createRenderer(){return new qK(this)}getData(e){return super.getData(e)}}function FS(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function QK(n,e,t){const r=n[t];return r?r.delete(e):!1}function qM(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=ql(e,Zo(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=ql(e,i))}return e}class JK extends mR{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=zs(),this.tempTileRange_=new RR(0,0,0,0),this.tempTileCoord_=$_(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new HM(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new HM(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=Qx(o,o.getKey(),e,t,r);let c;if(s.containsKey(l))c=s.get(l);else{const h=i.viewState.projection,g=o.getProjection();if(c=o.getTile(e,t,r,i.pixelRatio,h,!g||Kh(g,h)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Dr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!nd(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),c=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const g=l.getTileCoordForCoordAndZ(i,h),m=this.getTile(h,g[1],g[2],t);if(!m||m.getState()!==jt.LOADED)continue;const y=l.getOrigin(h),v=ws(l.getTileSize(h)),x=l.getResolution(h);let w;if(m instanceof kF||m instanceof LF)w=m.getImage();else if(m instanceof UM){if(w=hb(m.getData()),!w)continue}else continue;const T=Math.floor(c*((i[0]-y[0])/x-g[1]*v[0])),b=Math.floor(c*((y[1]-i[1])/x-g[2]*v[1])),A=Math.round(c*o.getGutterForProjection(a.projection));return this.getImageData(w,T+A,b+A)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=$t(l);h in e.wantedTiles||(e.wantedTiles[h]={});const g=e.wantedTiles[h],m=o.getMapInternal(),y=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),v=a.rotation,x=v?_D(a.center,a.resolution,v,e.size):void 0;for(let w=r;w>=y;--w){const T=c.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),b=c.getResolution(w);for(let A=T.minX;A<=T.maxX;++A)for(let M=T.minY;M<=T.maxY;++M){if(v&&!c.tileCoordIntersectsViewport([w,A,M],x))continue;const O=this.getTile(w,A,M,e);if(!O||!FS(i,O,w))continue;const I=O.getKey();if(g[I]=!0,O.getState()===jt.IDLE&&!e.tileQueue.isKeyQueued(I)){const R=$_(w,A,M,this.tempTileCoord_);e.tileQueue.enqueue([O,h,c.getTileCoordCenter(R),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const c=Qx(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(c)){const h=r.peek(c);if(h.getState()===jt.LOADED)return h.endTransition($t(this)),FS(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let g=s.minY;g<=s.maxY;++g){const m=Qx(l,c,r,h,g);let y=!1;if(o.containsKey(m)){const v=o.peek(m);v.getState()===jt.LOADED&&(FS(i,v,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),g=h.getTileGridForProjection(s),m=g.getZForResolution(a,h.zDirection),y=g.getResolution(m),v=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let x=e.extent;const w=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,b=this.context.canvas.height,A=r.extent&&Zo(r.extent);A&&(x=ql(x,Zo(r.extent)));const M=y*T/2/w,O=y*b/2/w,z=[o[0]-M,o[1]-O,o[0]+M,o[1]+O],I={};this.renderedTiles.length=0;const R=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ue=g.getZForResolution(i.nextResolution,h.zDirection),Ae=qM(e,e.nextExtent);this.enqueueTiles(e,Ae,ue,I,R)}const P=qM(e,x);if(this.enqueueTiles(e,P,m,I,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,P,m-1,I,R-1)},0),!(m in I))return this.container;const F=$t(this),N=e.time;for(const ue of I[m]){const Ae=ue.getState();if(Ae===jt.EMPTY)continue;const be=ue.tileCoord;if(Ae===jt.LOADED&&ue.getAlpha(F,N)===1){ue.endTransition(F);continue}if(Ae!==jt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(be,I)){QK(I,ue,m),e.animate=!0;continue}if(this.findAltTiles_(g,be,m+1,I))continue;const se=g.getMinZoom();for(let ne=m-1;ne>=se&&!this.findAltTiles_(g,be,ne,I);--ne);}const B=y/a*l/w,j=this.getRenderContext(e);Ga(this.tempTransform,T/2,b/2,B,B,0,-T/2,-b/2),r.extent&&this.clipUnrotated(j,e,A),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const ve=Object.keys(I).map(Number);ve.sort(Xl);let ke;const Ve=[],Me=[];for(let ue=ve.length-1;ue>=0;--ue){const Ae=ve[ue],be=h.getTilePixelSize(Ae,l,s),V=g.getResolution(Ae)/y,se=be[0]*V*B,ne=be[1]*V*B,q=g.getTileCoordForCoordAndZ(Ad(z),Ae),le=g.getTileCoordExtent(q),Ie=Dr(this.tempTransform,[w*(le[0]-z[0])/y,w*(z[3]-le[3])/y]),Fe=w*h.getGutterForProjection(s);for(const he of I[Ae]){if(he.getState()!==jt.LOADED)continue;const Pe=he.tileCoord,Be=q[1]-Pe[1],Rt=Math.round(Ie[0]-(Be-1)*se),Dt=q[2]-Pe[2],Nt=Math.round(Ie[1]-(Dt-1)*ne),ln=Math.round(Ie[0]-Be*se),rn=Math.round(Ie[1]-Dt*ne),ut=Rt-ln,tr=Nt-rn,dn=ve.length===1;let cn=!1;ke=[ln,rn,ln+ut,rn,ln+ut,rn+tr,ln,rn+tr];for(let nr=0,li=Ve.length;nr<li;++nr)if(!dn&&Ae<Me[nr]){const Fn=Ve[nr];_s([ln,rn,ln+ut,rn+tr],[Fn[0],Fn[3],Fn[4],Fn[7]])&&(cn||(j.save(),cn=!0),j.beginPath(),j.moveTo(ke[0],ke[1]),j.lineTo(ke[2],ke[3]),j.lineTo(ke[4],ke[5]),j.lineTo(ke[6],ke[7]),j.moveTo(Fn[6],Fn[7]),j.lineTo(Fn[4],Fn[5]),j.lineTo(Fn[2],Fn[3]),j.lineTo(Fn[0],Fn[1]),j.clip())}Ve.push(ke),Me.push(Ae),this.drawTile(he,e,ln,rn,ut,tr,Fe,dn),cn&&j.restore(),this.renderedTiles.unshift(he),this.updateUsedTiles(e.usedTiles,h,he)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!rd(this.renderedExtent_,z),this.renderedExtent_=z,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const ue=(Ae,be)=>{const re=$t(h),V=be.wantedTiles[re],se=V?Object.keys(V).length:0;this.updateCacheSize(se),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ue)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let c;if(e instanceof UM){if(c=hb(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),g=$t(this),m=t.layerStatesArray[t.layerIndex],y=m.opacity*(l?e.getAlpha(g,t.time):1),v=y!==h.globalAlpha;v&&(h.save(),h.globalAlpha=y),h.drawImage(c,o,o,c.width-2*o,c.height-2*o,r,i,s,a),v&&h.restore(),y!==m.opacity?t.animate=!0:l&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=$t(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const vx={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class eX extends w1{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(vx.PRELOAD)}setPreload(e){this.set(vx.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(vx.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(vx.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Eh extends eX{constructor(e){super(e)}createRenderer(){return new JK(this,{cacheSize:this.getCacheSize()})}}function gb(n){return Array.isArray(n)?Math.min(...n):n}const If=[0,0,0],Kc=5;class $F{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,En(AU(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,En(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Ad(r)),En(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,En(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:SR,En(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new RR(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,c=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=Tf(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,c,r),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return Tf(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return Tf(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),c=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return Tf(c,c,h,h,r);const g=Math.floor(l*(s+1))-1,m=Math.floor(l*(a+1))-1;return Tf(c,g,h,m,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,If);const i=If[1],s=If[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,If);const a=If[1],o=If[2];return Tf(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=ws(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=ws(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,c=o+s[1]*i;return Cu(a,o,l,c,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),c=ws(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/c[0],g=o*(l[1]-t)/r/c[1];return i?(h=cu(h,Kc)-1,g=cu(g,Kc)-1):(h=cx(h,Kc),g=cx(g,Kc)),$_(a,h,g,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=ws(this.getTileSize(r),this.tmpSize_);let c=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(c=cu(c,Kc)-1,h=cu(h,Kc)-1):(c=cx(c,Kc),h=cx(h,Kc)),$_(r,c,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=hw(this.resolutions_,e,t||0);return cr(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return VD(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function WF(n){let e=n.getDefaultTileGrid();return e||(e=iX(n),n.setDefaultTileGrid(e)),e}function tX(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=FR(t);if(!nd(s,i)){const a=pn(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function nX(n,e,t,r){r=r!==void 0?r:"top-left";const i=HF(n,e,t);return new $F({extent:n,origin:PU(n,r),resolutions:i,tileSize:t})}function rX(n){const e=n||{},t=e.extent||er("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:HF(t,e.maxZoom,e.tileSize,e.maxResolution)};return new $F(r)}function HF(n,e,t,r){e=e!==void 0?e:GH,t=ws(t!==void 0?t:SR);const i=ti(n),s=pn(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function iX(n,e,t,r){const i=FR(n);return nX(i,e,t,r)}function FR(n){n=er(n);let e=n.getExtent();if(!e){const t=180*k0.degrees/n.getMetersPerUnit();e=Cu(-t,-t,t,t)}return e}function jR(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const sX=/\{z\}/g,aX=/\{x\}/g,oX=/\{y\}/g,lX=/\{-y\}/g;function cX(n,e,t,r,i){return n.replace(sX,e.toString()).replace(aX,t.toString()).replace(oX,r.toString()).replace(lX,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function uX(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function hX(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return cX(n,a,t[1],t[2],s)})}function dX(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=hX(n[i],e);return fX(r)}function fX(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=OF(e),s=vu(i,n.length);return n[s](e,t,r)})}class gX extends gR{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ws(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||$t(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Wt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:WF(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=ws(i.getTileSize(e),this.tmpSize);return s==1?a:CW(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=tX(i,e,r)),gK(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class mX extends pl{constructor(e,t){super(e),this.tile=t}}const jS={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class VR extends gX{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===VR.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=$t(t),i=t.getState();let s;i==jt.LOADING?(this.tileLoadingKeys_[r]=!0,s=jS.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==jt.ERROR?jS.TILELOADERROR:i==jt.LOADED?jS.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new mX(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=uX(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(dX(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class KF extends VR{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:XF,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:kF,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Kh(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Kh(t,e)))return this.tileGrid;const r=$t(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=WF(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),c=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,c!==void 0?jt.IDLE:jt.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Jt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Kh(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],c=this.getKey(),h=this.getTileGridForProjection(o),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(l,s),y=new LF(o,h,s,g,l,m,this.getTilePixelRatio(i),this.getGutter(),(v,x,w,T)=>this.getTileInternal(v,x,w,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=c,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=Qx(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const c=this.createTile_(e,t,r,i,s,o);return a?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=er(e);if(r){const i=$t(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function XF(n,e){if(ha){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class zf extends KF{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:rX({extent:FR(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const pX="modulepreload",yX=function(n){return"/detectorapp-nl/"+n},YM={},ht=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(c=>{if(c=yX(c),c in YM)return;YM[c]=!0;const h=c.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":pX,h||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),h)return new Promise((y,v)=>{m.addEventListener("load",y),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class xX extends XD{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const h=c?ql(r,c):r,g=ul(h),m=U_(e,t,g,i),y=NF,v=new MF(e,t,h,l,m*y,i),x=v.calculateSourceExtent(),w=ig(x)?null:a(x,m,s),T=w?Et.IDLE:Et.EMPTY,b=w?w.getPixelRatio():1;super(r,i,b,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=w,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Et.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Et.LOADED){const t=pn(this.targetExtent_)/this.targetResolution_,r=ti(this.targetExtent_)/this.targetResolution_;this.canvas_=PF(t,r,this.sourcePixelRatio_,gb(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Et.IDLE){this.state=Et.LOADING,this.changed();const e=this.sourceImage_.getState();e==Et.LOADED||e==Et.ERROR?this.reproject_():(this.sourceListenerKey_=mn(this.sourceImage_,Jt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==Et.LOADED||r==Et.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){ir(this.sourceListenerKey_),this.sourceListenerKey_=null}}const fu=4,VS={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class _X extends pl{constructor(e,t){super(e),this.image=t}}class vX extends gR{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=hw(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Kh(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Kh(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&rd(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new xX(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=qF(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&lu(this.wantedExtent_,s)||lu(this.image.getExtent(),s))&&(this.wantedResolution_&&gb(this.wantedResolution_)===a||gb(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new XD(s,a,r,this.loader),this.image.addEventListener(Jt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case Et.LOADING:this.loading=!0,r=VS.IMAGELOADSTART;break;case Et.LOADED:this.loading=!1,r=VS.IMAGELOADEND;break;case Et.ERROR:this.loading=!1,r=VS.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new _X(r,t))}}function wX(n,e){n.getImage().src=e}function qF(n,e,t,r){const i=e/t,s=ul(n),a=cu(pn(n)/i,fu),o=cu(ti(n)/i,fu),l=cu((r-1)*a/2,fu),c=a+2*l,h=cu((r-1)*o/2,fu),g=o+2*h;return A_(s,i,0,[c,g])}function EX(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[R_(pn(e)/o,fu),R_(ti(e)/o,fu)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return jR(c,s)}function SX(n){const e=n.load?n.load:YD,t=er(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=qF(s,a,o,r);const c=EX(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,c).then(g=>{const m=pn(s)/g.width*o;return{image:g,extent:s,resolution:m,pixelRatio:o}})}}class TX extends vX{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:wX,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=SX({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),YD(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const mb="1.3.0";function bX(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=ED(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),jR(n,i)}function AX(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[R_(pn(n)/o,fu),R_(ti(n)/o,fu)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return bX(i,n,l,r,s)}function ZM(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:mb,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const RX='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class IX extends zf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[RX];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!ha&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||XF)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const K_=1/0;class CX{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,rg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){En(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=K_?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<i&&r[c]<r[l]?c:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==K_?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class kX extends CX{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Jt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===jt.LOADED||r===jt.ERROR||r===jt.EMPTY){r!==jt.ERROR&&t.removeEventListener(Jt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===jt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function PX(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return K_;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class MX extends KF{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=zs(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=er(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=p1(e,s,a),c=U_(a,s,e,t),h=o.getZForResolution(c,this.zDirection),g=o.getResolution(h),m=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=m[0])return;let y=o.getTileCoordExtent(m,this.tmpExtent_);const v=this.gutter_;v!==0&&(y=C0(y,g*v,y));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,ZM(this.params_,"GetFeatureInfo"),i);const w=Math.floor((l[0]-y[0])/g),T=Math.floor((y[3]-l[1])/g);return x[this.v13_?"I":"X"]=w,x[this.v13_?"J":"Y"]=T,this.getRequestUrl_(m,y,1,a||s,x)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:mb,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),jR(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=vu(OF(e),a.length);o=a[l]}return AX(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||mb;this.v13_=ED(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=C0(a,s*o,a));const l=Object.assign({},ZM(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Uf extends pl{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Jc extends Uf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Nr={SINGLECLICK:"singleclick",CLICK:Jt.CLICK,DBLCLICK:Jt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},pb={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class NX extends h1{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=mn(r,pb.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=mn(r,pb.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Jt.TOUCHMOVE,this.boundHandleTouchMove_,WD?{passive:!1}:!1)}emulateClick_(e){let t=new Jc(Nr.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Jc(Nr.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Jc(Nr.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Nr.POINTERUP||t.type==Nr.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Nr.POINTERDOWN||t.type==Nr.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Jc(Nr.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ir),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Jc(Nr.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(mn(r,Nr.POINTERMOVE,this.handlePointerMove_,this),mn(r,Nr.POINTERUP,this.handlePointerUp_,this),mn(this.element_,Nr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(mn(this.element_.getRootNode(),Nr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Jc(Nr.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Jc(Nr.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ir(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Jt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ir(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ir),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const eu={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ts={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class kw extends yl{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)ir(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==mp&&this.listenerKeys.push(mn(e,eu.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class LX extends kw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Jt.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+x1+" "+uR+(this.collapsed_&&this.collapsible_?" "+lM:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>dD(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!fc(t,this.renderedAttributions_)){F$(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(lM),this.collapsed_?aM(this.collapseLabel_,this.label_):aM(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class OX extends kw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Jt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+x1+" "+uR,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(dx)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ag}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(dx);!s&&r===0?this.element.classList.add(dx):s&&r!==0&&this.element.classList.remove(dx)}this.label_.style.transform=i}this.rotation_=r}}class DX extends kw{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Jt.CLICK,this.handleClick_.bind(this,r),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=c,g.appendChild(typeof o=="string"?document.createTextNode(o):o),g.addEventListener(Jt.CLICK,this.handleClick_.bind(this,-r),!1);const m=t+" "+x1+" "+uR,y=this.element;y.className=m,y.appendChild(h),y.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:ag})):r.setZoom(s)}}}function FX(n){n=n||{};const e=new Na;return(n.zoom===void 0||n.zoom)&&e.push(new DX(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new OX(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new LX(n.attributionOptions)),e}class jX{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const QM={ACTIVE:"active"};class E1 extends yl{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(QM.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(QM.ACTIVE,e)}setMap(e){this.map_=e}}function VX(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:DH,center:n.getConstrainedCenter(i)})}}function BR(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:ag})}class BX extends E1{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Nr.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();BR(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function yb(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const GX=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},zX=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},YF=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?zX(n):!0},UX=gp,ZF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(O$&&UD&&e.ctrlKey)},QF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},$X=function(n){const e=n.originalEvent;return UD?e.metaKey:e.ctrlKey},WX=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},JF=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},BS=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},HX=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class S1 extends E1{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Nr.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Nr.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Nr.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Nr.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function GR(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class KX extends S1{constructor(e){super({stopDown:dw}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:yb(QF,HX);this.condition_=e.onFocusOnly?yb(YF,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(GR(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();FU(s,o.getResolution()),KA(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:ag})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class XX extends S1{constructor(e){e=e||{},super({stopDown:dw}),this.condition_=e.condition?e.condition:GX,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!BS(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===ER)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return BS(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return BS(e)&&ZF(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class qX extends u1{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ua([i])}getGeometry(){return this.geometry_}}const Cf={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class cm extends pl{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class YX extends S1{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new qX(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??ZF,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new cm(Cf.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new cm(t?Cf.BOXEND:Cf.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new cm(Cf.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new cm(Cf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new cm(Cf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class ZX extends YX{constructor(e){e=e||{};const t=e.condition?e.condition:WX;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:ag})}}const xh={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class QX extends E1{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return QF(t)&&JF(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Jt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==xh.DOWN||i==xh.LEFT||i==xh.RIGHT||i==xh.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,c=0;i==xh.DOWN?c=-o:i==xh.LEFT?l=-o:i==xh.RIGHT?l=o:c=o;const h=[l,c];KA(h,a.getRotation()),VX(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class JX extends E1{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!$X(t)&&JF(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Jt.KEYDOWN||e.type==Jt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();BR(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const eq=40,tq=300;class nq extends E1{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:UX;this.condition_=e.onFocusOnly?yb(YF,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Jt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=eq;break;case WheelEvent.DOM_DELTA_PAGE:s*=tq;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-cr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),BR(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class rq extends S1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=dw),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==ER&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(GR(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class iq extends S1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=dw),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(GR(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function sq(n){n=n||{};const e=new Na,t=new jX(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new XX),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new BX({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new KX({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new rq),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new iq({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new QX),e.push(new JX({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new nq({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new ZX({duration:n.zoomDuration})),e}class aq extends u1{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Wt()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Ga(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),yp(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let c;const h=t.viewState;function g(M,O,z,I){return s.call(a,O,M?z:null,I)}const m=h.projection,y=SD(e.slice(),m),v=[[0,0]];if(m.canWrapX()&&i){const M=m.getExtent(),O=pn(M);v.push([-O,0],[O,0])}const x=t.layerStatesArray,w=x.length,T=[],b=[];for(let M=0;M<v.length;M++)for(let O=w-1;O>=0;--O){const z=x[O],I=z.layer;if(I.hasRenderer()&&TR(z,h)&&o.call(l,I)){const R=I.getRenderer(),P=I.getSource();if(R&&P){const F=P.getWrapX()?y:e,N=g.bind(null,z.managed);b[0]=F[0]+v[M][0],b[1]=F[1]+v[M][1],c=R.forEachFeatureAtCoordinate(b,t,r,N,T)}if(c)return c}}if(T.length===0)return;const A=1/T.length;return T.forEach((M,O)=>M.distanceSq+=O*A),T.sort((M,O)=>M.distanceSq-O.distanceSq),T.some(M=>c=M.callback(M.feature,M.layer,M.geometry)),c}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,gp,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Wt()}scheduleExpireIconCache(e){La.canExpireCache()&&e.postRenderFunctions.push(oq)}}function oq(n,e){La.expire()}class lq extends aq{constructor(e){super(e),this.fontChangeListenerKey_=mn(Vf,I0.PROPERTYCHANGE,e.redrawText,e),this.element_=ha?HD():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=x1+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new Fm(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){ir(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ti.PRECOMPOSE,e);const t=e.layerStatesArray.sort((c,h)=>c.zIndex-h.zIndex);t.some(c=>c.layer instanceof Rw&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let c=0,h=t.length;c<h;++c){const g=t[c];e.layerIndex=c;const m=g.layer,y=m.getSourceState();if(!TR(g,i)||y!="ready"&&y!="undefined"){m.unrender();continue}const v=m.render(e,a);v&&(v!==a&&(this.children_.push(v),a=v),s.push(g))}this.declutter(e,s),j$(this.element_,this.children_);const l=this.getMap().getTargetElement();if(hu(l)){const c=l.getContext("2d");for(const h of this.children_){const g=h.firstElementChild||h,m=h.style.backgroundColor;if(m&&(!hu(g)||g.width>0)&&(c.fillStyle=m,c.fillRect(0,0,l.width,l.height)),hu(g)&&g.width>0){const y=h.style.opacity||g.style.opacity;c.globalAlpha=y===""?1:Number(y);const v=g.style.transform;if(v)c.setTransform(...tb(v));else{const x=parseFloat(g.style.width)/g.width,w=parseFloat(g.style.height)/g.height;c.setTransform(x,0,0,w,0,0)}c.drawImage(g,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Ti.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function e6(n){if(n instanceof w1){n.setMapInternal(null);return}n instanceof Iw&&n.getLayers().forEach(e6)}function t6(n,e){if(n instanceof w1){n.setMapInternal(e);return}if(n instanceof Iw){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)t6(t[r],e)}}let cq=class extends yl{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=uq(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:D$,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=mi(),this.pixelToCoordinateTransform_=mi(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ha||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ha||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(ha?new Na:FX()),this.interactions=t.interactions||(ha?new Na:sq({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new kX(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ts.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(ts.VIEW,this.handleViewChanged_),this.addChangeListener(ts.SIZE,this.handleSizeChanged_),this.addChangeListener(ts.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Yo)&&e.view.then(function(i){r.setView(new Yo(i))}),this.controls.addEventListener(Ls.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Ls.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Ls.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Ls.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Ls.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Ls.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){t6(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:gp,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof Iw?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:gp,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(ts.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return eb(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Dr(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ts.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Na){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Vl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Dr(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ts.SIZE)}getView(){return this.get(ts.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return PX(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Jc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===pb.POINTERDOWN||r===Jt.WHEEL||r===Jt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[Jr.ANIMATING]||a[Jr.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ti.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ti.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Uf(eu.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Uf(eu.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)ir(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Jt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Jt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!hu(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(hu(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new lq(this)),!hu(t)){this.mapBrowserEventHandler_=new NX(this,this.moveTolerance_);for(const i in Nr)this.mapBrowserEventHandler_.addEventListener(Nr[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Jt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Jt.WHEEL,this.boundHandleBrowserEvent_,WD?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[mn(r,Jt.KEYDOWN,this.handleBrowserEvent,this),mn(r,Jt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ir(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ir(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=mn(e,I0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=mn(e,Jt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ir),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new nu("addlayer",e)),this.layerGroupPropertyListenerKeys_=[mn(e,I0.PROPERTYCHANGE,this.render,this),mn(e,Jt.CHANGE,this.render,this),mn(e,"addlayer",this.handleLayerAdd_,this),mn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){e6(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&vM(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:A_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:$t(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=A_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!ig(this.previousExtent_)&&!rd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Uf(eu.MOVESTART,this,i)),this.previousExtent_=f1(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Jr.ANIMATING]&&!s.viewHints[Jr.INTERACTING]&&!rd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Uf(eu.MOVEEND,this,s)),gD(s.extent,this.previousExtent_))),this.dispatchEvent(new Uf(eu.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(eu.LOADSTART)||this.hasListener(eu.LOADEND)||this.hasListener(Ti.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new nu("removelayer",t)),this.set(ts.LAYERGROUP,e)}setSize(e){this.set(ts.SIZE,e)}setTarget(e){this.set(ts.TARGET,e)}setView(e){if(!e||e instanceof Yo){this.set(ts.VIEW,e);return}this.set(ts.VIEW,new Yo);const t=this;e.then(function(r){t.setView(new Yo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(hu(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!vM(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&bD("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!fc(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function uq(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Iw({layers:n.layers});t[ts.LAYERGROUP]=r,t[ts.TARGET]=n.target,t[ts.VIEW]=n.view instanceof Yo?n.view:new Yo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new Na(n.controls.slice()):(En(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Na(n.interactions.slice()):(En(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new Na(n.overlays.slice()):(En(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new Na,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const GS="units",hq=[1,2,5],um=25.4/.28;class dq extends kw{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+x1,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(GS,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(GS)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(GS,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=M_(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||um)/um,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||um)/um:void 0;let c=o*a,h="";if(i=="degrees"){const A=k0.degrees;c*=A,c<A/60?(h="",a*=3600):c<A?(h="",a*=60):h=""}else if(i=="imperial")c<.9144?(h="in",a/=.0254):c<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")c<1e-6?(h="nm",a*=1e9):c<.001?(h="m",a*=1e6):c<1?(h="mm",a*=1e3):c<1e3?h="m":(h="km",a/=1e3);else if(i=="us")c<.9144?(h="in",a*=39.37):c<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let g=3*Math.floor(Math.log(o*a)/Math.log(10)),m,y,v,x=0,w,T;for(;;){v=Math.floor(g/3);const A=Math.pow(10,v);if(m=hq[(g%3+3)%3]*A,y=Math.round(m/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){m=x,y=w,v=T;break}else if(y>=o)break;x=m,w=y,T=v,++g}const b=this.scaleBar_?this.createScaleBar(y,m,h):m.toFixed(v<0?-v:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const g=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${g}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,c=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=M_(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||um,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const fq={},JM=n=>{let e;const t=new Set,r=(h,g)=>{const m=typeof h=="function"?h(e):h;if(!Object.is(m,e)){const y=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(v=>v(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(fq?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},c=e=n(r,i,l);return l},gq=n=>n?JM(n):JM;var zS={exports:{}},US={},$S={exports:{}},WS={};var eN;function mq(){if(eN)return WS;eN=1;var n=c1();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(g,m){var y=m(),v=r({inst:{value:y,getSnapshot:m}}),x=v[0].inst,w=v[1];return s(function(){x.value=y,x.getSnapshot=m,l(x)&&w({inst:x})},[g,y,m]),i(function(){return l(x)&&w({inst:x}),g(function(){l(x)&&w({inst:x})})},[g]),a(y),y}function l(g){var m=g.getSnapshot;g=g.value;try{var y=m();return!t(g,y)}catch{return!0}}function c(g,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return WS.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,WS}var tN;function pq(){return tN||(tN=1,$S.exports=mq()),$S.exports}var nN;function yq(){if(nN)return US;nN=1;var n=c1(),e=pq();function t(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return US.useSyncExternalStoreWithSelector=function(c,h,g,m,y){var v=s(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=o(function(){function T(z){if(!b){if(b=!0,A=z,z=m(z),y!==void 0&&x.hasValue){var I=x.value;if(y(I,z))return M=I}return M=z}if(I=M,r(A,z))return I;var R=m(z);return y!==void 0&&y(I,R)?(A=z,I):(A=z,M=R)}var b=!1,A,M,O=g===void 0?null:g;return[function(){return T(h())},O===null?void 0:function(){return T(O())}]},[h,g,m,y]);var w=i(c,v[0],v[1]);return a(function(){x.hasValue=!0,x.value=w},[w]),l(w),w},US}var rN;function xq(){return rN||(rN=1,zS.exports=yq()),zS.exports}var _q=xq();const vq=$A(_q),n6={},{useDebugValue:wq}=EU,{useSyncExternalStoreWithSelector:Eq}=vq;let iN=!1;const Sq=n=>n;function Tq(n,e=Sq,t){(n6?"production":void 0)!=="production"&&t&&!iN&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),iN=!0);const r=Eq(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return wq(r),r}const bq=n=>{(n6?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?gq(n):n,t=(r,i)=>Tq(e,r,i);return Object.assign(t,e),t},bs=n=>bq;var r6=Symbol.for("immer-nothing"),sN=Symbol.for("immer-draftable"),ga=Symbol.for("immer-state");function uo(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Rp=Object.getPrototypeOf;function L0(n){return!!n&&!!n[ga]}function od(n){return n?i6(n)||Array.isArray(n)||!!n[sN]||!!n.constructor?.[sN]||T1(n)||Mw(n):!1}var Aq=Object.prototype.constructor.toString(),aN=new WeakMap;function i6(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=aN.get(t);return r===void 0&&(r=Function.toString.call(t),aN.set(t,r)),r===Aq}function X_(n,e,t=!0){Pw(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Pw(n){const e=n[ga];return e?e.type_:Array.isArray(n)?1:T1(n)?2:Mw(n)?3:0}function xb(n,e){return Pw(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function s6(n,e,t){const r=Pw(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function Rq(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function T1(n){return n instanceof Map}function Mw(n){return n instanceof Set}function Sh(n){return n.copy_||n.base_}function _b(n,e){if(T1(n))return new Map(n);if(Mw(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=i6(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[ga];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(Rp(n),r)}else{const r=Rp(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function zR(n,e=!1){return Nw(n)||L0(n)||!od(n)||(Pw(n)>1&&Object.defineProperties(n,{set:wx,add:wx,clear:wx,delete:wx}),Object.freeze(n),e&&Object.values(n).forEach(t=>zR(t,!0))),n}function Iq(){uo(2)}var wx={value:Iq};function Nw(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var Cq={};function ld(n){const e=Cq[n];return e||uo(0,n),e}var Ip;function a6(){return Ip}function kq(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function oN(n,e){e&&(ld("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function vb(n){wb(n),n.drafts_.forEach(Pq),n.drafts_=null}function wb(n){n===Ip&&(Ip=n.parent_)}function lN(n){return Ip=kq(Ip,n)}function Pq(n){const e=n[ga];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function cN(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[ga].modified_&&(vb(e),uo(4)),od(n)&&(n=q_(e,n),e.parent_||Y_(e,n)),e.patches_&&ld("Patches").generateReplacementPatches_(t[ga].base_,n,e.patches_,e.inversePatches_)):n=q_(e,t,[]),vb(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==r6?n:void 0}function q_(n,e,t){if(Nw(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[ga];if(!i)return X_(e,(s,a)=>uN(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return Y_(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),X_(a,(l,c)=>uN(n,i,s,l,c,t,o),r),Y_(n,s,!1),t&&n.patches_&&ld("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function uN(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=Nw(i);if(!(o&&!a)){if(L0(i)){const l=s&&e&&e.type_!==3&&!xb(e.assigned_,r)?s.concat(r):void 0,c=q_(n,i,l);if(s6(t,r,c),L0(c))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(od(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;q_(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(T1(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&Y_(n,i)}}}function Y_(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&zR(e,t)}function Mq(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:a6(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=UR;t&&(i=[r],s=Cp);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var UR={get(n,e){if(e===ga)return n;const t=Sh(n);if(!xb(t,e))return Nq(n,t,e);const r=t[e];return n.finalized_||!od(r)?r:r===HS(n.base_,e)?(KS(n),n.copy_[e]=Sb(r,n)):r},has(n,e){return e in Sh(n)},ownKeys(n){return Reflect.ownKeys(Sh(n))},set(n,e,t){const r=o6(Sh(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=HS(Sh(n),e),s=i?.[ga];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Rq(t,i)&&(t!==void 0||xb(n.base_,e)))return!0;KS(n),Eb(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return HS(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,KS(n),Eb(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Sh(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){uo(11)},getPrototypeOf(n){return Rp(n.base_)},setPrototypeOf(){uo(12)}},Cp={};X_(UR,(n,e)=>{Cp[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Cp.deleteProperty=function(n,e){return Cp.set.call(this,n,e,void 0)};Cp.set=function(n,e,t){return UR.set.call(this,n[0],e,t,n[0])};function HS(n,e){const t=n[ga];return(t?Sh(t):n)[e]}function Nq(n,e,t){const r=o6(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function o6(n,e){if(!(e in n))return;let t=Rp(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Rp(t)}}function Eb(n){n.modified_||(n.modified_=!0,n.parent_&&Eb(n.parent_))}function KS(n){n.copy_||(n.copy_=_b(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Lq=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...c){return a.produce(l,h=>t.call(this,h,...c))}}typeof t!="function"&&uo(6),r!==void 0&&typeof r!="function"&&uo(7);let i;if(od(e)){const s=lN(this),a=Sb(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?vb(s):wb(s)}return oN(s,r),cN(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===r6&&(i=void 0),this.autoFreeze_&&zR(i,!0),r){const s=[],a=[];ld("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else uo(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){od(n)||uo(8),L0(n)&&(n=Oq(n));const e=lN(this),t=Sb(n,void 0);return t[ga].isManual_=!0,wb(e),t}finishDraft(n,e){const t=n&&n[ga];(!t||!t.isManual_)&&uo(9);const{scope_:r}=t;return oN(r,e),cN(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=ld("Patches").applyPatches_;return L0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function Sb(n,e){const t=T1(n)?ld("MapSet").proxyMap_(n,e):Mw(n)?ld("MapSet").proxySet_(n,e):Mq(n,e);return(e?e.scope_:a6()).drafts_.push(t),t}function Oq(n){return L0(n)||uo(10,n),l6(n)}function l6(n){if(!od(n)||Nw(n))return n;const e=n[ga];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=_b(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=_b(n,!0);return X_(t,(i,s)=>{s6(t,i,l6(s))},r),e&&(e.finalized_=!1),t}var Dq=new Lq,Fq=Dq.produce;const jq=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?Fq(i):i;return e(o,s,...a)},n(r.setState,t,r)),og=jq,as=bs()(og((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),Lw={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await ht(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await ht(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await ht(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await ht(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await ht(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await ht(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await ht(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await ht(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await ht(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await ht(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await ht(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-DkEjuwii.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await ht(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-73VNl8uz.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await ht(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-73VNl8uz.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await ht(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-73VNl8uz.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await ht(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-CCv2BFkT.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await ht(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-CCv2BFkT.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await ht(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-CCv2BFkT.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await ht(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-CCv2BFkT.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await ht(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-CCv2BFkT.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await ht(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-CCv2BFkT.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await ht(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-CCv2BFkT.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await ht(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-KfrYU0Di.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await ht(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-Ce_PIGea.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await ht(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-Ce_PIGea.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await ht(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-Ce_PIGea.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await ht(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await ht(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await ht(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await ht(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await ht(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-DeBz156x.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await ht(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-DeBz156x.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await ht(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await ht(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await ht(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await ht(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await ht(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await ht(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await ht(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-BzA5EgIO.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await ht(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-BGO7ii-8.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await ht(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-BGO7ii-8.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await ht(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-BGO7ii-8.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await ht(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-BGO7ii-8.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await ht(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-BGO7ii-8.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await ht(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-BGO7ii-8.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await ht(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-Rma_ltcc.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await ht(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-Rma_ltcc.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await ht(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-BWhJ0oca.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await ht(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-MkJA2UXF.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await ht(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-DcZtU6iy.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await ht(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-CQgUVDKG.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await ht(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-ESKrnua6.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await ht(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-DQ0L17tv.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await ht(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-DnrRTw2y.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await ht(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-BNci7A6K.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await ht(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-D0LPUOA4.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await ht(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-C97MTqeE.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await ht(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-B-0of52j.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await ht(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-9MISvd3o.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await ht(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-BdJTUUOt.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await ht(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-BXBm-CH4.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},"Openbare Toiletten":{name:"Openbare Toiletten",factory:async()=>{const{createToilettenLayerOL:n}=await ht(async()=>{const{createToilettenLayerOL:e}=await import("./toilettenOL-B8gmiStI.js");return{createToilettenLayerOL:e}},[]);return n()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:n}=await ht(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-J9OGeNsx.js");return{createRuiterpadenLayerOL:e}},[]);return n()},immediateLoad:!1},Natuurparkeren:{name:"Natuurparkeren",factory:async()=>{const{createNatuurParkeerLayerOL:n}=await ht(async()=>{const{createNatuurParkeerLayerOL:e}=await import("./natuurParkeerOL-CiNCO7a_.js");return{createNatuurParkeerLayerOL:e}},[]);return n()},immediateLoad:!1},Strandopgangen:{name:"Strandopgangen",factory:async()=>{const{createStrandopgangenLayerOL:n}=await ht(async()=>{const{createStrandopgangenLayerOL:e}=await import("./strandopgangenOL-BpDXJNfS.js");return{createStrandopgangenLayerOL:e}},[]);return n()},immediateLoad:!1},Winkelcentra:{name:"Winkelcentra",factory:async()=>{const{createWinkelcentraLayerOL:n}=await ht(async()=>{const{createWinkelcentraLayerOL:e}=await import("./winkelcentraOL-C9srFWqR.js");return{createWinkelcentraLayerOL:e}},[]);return n()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:n}=await ht(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-3WQHx2lU.js");return{createLaarzenpadenLayerOL:e}},[]);return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await ht(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-Cu6y50Xa.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await ht(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-BjdacabX.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await ht(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-B5-3NJk1.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await ht(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-B6HsuTuW.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await ht(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-CTpmSnH5.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await ht(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-B-v-FVR4.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await ht(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-BUXCQW8O.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await ht(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-burnmG_k.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await ht(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-Jrnx-C7e.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await ht(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-DWDZ5hHO.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await ht(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-CqV7m5ja.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await ht(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-BBkALuN8.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function Vq(){return Object.values(Lw).filter(n=>n.immediateLoad)}const Hr=bs()(og((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ai=bs()(og((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,"Openbare Toiletten":!1,Ruiterpaden:!1,Natuurparkeren:!1,Strandopgangen:!1,Winkelcentra:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"Archeo Landschappen":.5,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=Lw[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=Hr.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),Sr=bs()(og((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{n(t=>{t.routeDashboardOpen=!t.routeDashboardOpen})}}))),Bq=()=>{};var hN={};const c6=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Gq=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},u6={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=s>>2,g=(s&3)<<4|o>>4;let m=(o&15)<<2|c>>6,y=c&63;l||(y=64,a||(m=64)),r.push(t[h],t[g],t[m],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(c6(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Gq(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||c==null||g==null)throw new zq;const m=s<<2|o>>4;if(r.push(m),c!==64){const y=o<<4&240|c>>2;if(r.push(y),g!==64){const v=c<<6&192|g;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class zq extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Uq=function(n){const e=c6(n);return u6.encodeByteArray(e,!0)},Z_=function(n){return Uq(n).replace(/\./g,"")},h6=function(n){try{return u6.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function d6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const $q=()=>d6().__FIREBASE_DEFAULTS__,Wq=()=>{if(typeof process>"u"||typeof hN>"u")return;const n=hN.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Hq=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&h6(n[1]);return e&&JSON.parse(e)},Ow=()=>{try{return Bq()||$q()||Wq()||Hq()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},f6=n=>Ow()?.emulatorHosts?.[n],g6=n=>{const e=f6(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},m6=()=>Ow()?.config,p6=n=>Ow()?.[`_${n}`];class Kq{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Pd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $R(n){return(await fetch(n,{credentials:"include"})).ok}function y6(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Z_(JSON.stringify(t)),Z_(JSON.stringify(a)),""].join(".")}const jm={};function Xq(){const n={prod:[],emulator:[]};for(const e of Object.keys(jm))jm[e]?n.emulator.push(e):n.prod.push(e);return n}function qq(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let dN=!1;function WR(n,e){if(typeof window>"u"||typeof document>"u"||!Pd(window.location.host)||jm[n]===e||jm[n]||dN)return;jm[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=Xq().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{dN=!0,a()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=qq(r),y=t("text"),v=document.getElementById(y)||document.createElement("span"),x=t("learnmore"),w=document.getElementById(x)||document.createElement("a"),T=t("preprendIcon"),b=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const A=m.element;o(A),h(w,x);const M=c();l(b,T),A.append(b,v,w,M),document.body.appendChild(A)}s?(v.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function pi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Yq(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pi())}function x6(){const n=Ow()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Zq(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Qq(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Jq(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eY(){const n=pi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function _6(){return!x6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function v6(){return!x6()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function w6(){try{return typeof indexedDB=="object"}catch{return!1}}function tY(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const nY="FirebaseError";class _l extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=nY,Object.setPrototypeOf(this,_l.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b1.prototype.create)}}class b1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?rY(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new _l(i,o,r)}}function rY(n,e){return n.replace(iY,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const iY=/\{\$([^}]+)}/g;function sY(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function cd(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(fN(s)&&fN(a)){if(!cd(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function fN(n){return n!==null&&typeof n=="object"}function A1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function aY(n,e){const t=new oY(n,e);return t.subscribe.bind(t)}class oY{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");lY(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=XS),i.error===void 0&&(i.error=XS),i.complete===void 0&&(i.complete=XS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lY(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function XS(){}function Pi(n){return n&&n._delegate?n._delegate:n}class ku{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Th="[DEFAULT]";class cY{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Kq;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hY(e))try{this.getOrInitializeService({instanceIdentifier:Th})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Th){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Th){return this.instances.has(e)}getOptions(e=Th){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:uY(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Th){return this.component?this.component.multipleInstances?e:Th:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uY(n){return n===Th?void 0:n}function hY(n){return n.instantiationMode==="EAGER"}class dY{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cY(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var yn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yn||(yn={}));const fY={debug:yn.DEBUG,verbose:yn.VERBOSE,info:yn.INFO,warn:yn.WARN,error:yn.ERROR,silent:yn.SILENT},gY=yn.INFO,mY={[yn.DEBUG]:"log",[yn.VERBOSE]:"log",[yn.INFO]:"info",[yn.WARN]:"warn",[yn.ERROR]:"error"},pY=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=mY[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class HR{constructor(e){this.name=e,this._logLevel=gY,this._logHandler=pY,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fY[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yn.DEBUG,...e),this._logHandler(this,yn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yn.VERBOSE,...e),this._logHandler(this,yn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yn.INFO,...e),this._logHandler(this,yn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yn.WARN,...e),this._logHandler(this,yn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yn.ERROR,...e),this._logHandler(this,yn.ERROR,...e)}}const yY=(n,e)=>e.some(t=>n instanceof t);let gN,mN;function xY(){return gN||(gN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _Y(){return mN||(mN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const E6=new WeakMap,Tb=new WeakMap,S6=new WeakMap,qS=new WeakMap,KR=new WeakMap;function vY(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Eu(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&E6.set(t,n)}).catch(()=>{}),KR.set(e,n),e}function wY(n){if(Tb.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});Tb.set(n,e)}let bb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Tb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||S6.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Eu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function EY(n){bb=n(bb)}function SY(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(YS(this),e,...t);return S6.set(r,e.sort?e.sort():[e]),Eu(r)}:_Y().includes(n)?function(...e){return n.apply(YS(this),e),Eu(E6.get(this))}:function(...e){return Eu(n.apply(YS(this),e))}}function TY(n){return typeof n=="function"?SY(n):(n instanceof IDBTransaction&&wY(n),yY(n,xY())?new Proxy(n,bb):n)}function Eu(n){if(n instanceof IDBRequest)return vY(n);if(qS.has(n))return qS.get(n);const e=TY(n);return e!==n&&(qS.set(n,e),KR.set(e,n)),e}const YS=n=>KR.get(n);function bY(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=Eu(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Eu(a.result),l.oldVersion,l.newVersion,Eu(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const AY=["get","getKey","getAll","getAllKeys","count"],RY=["put","add","delete","clear"],ZS=new Map;function pN(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ZS.get(e))return ZS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=RY.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||AY.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),i&&l.done]))[0]};return ZS.set(e,s),s}EY(n=>({...n,get:(e,t,r)=>pN(e,t)||n.get(e,t,r),has:(e,t)=>!!pN(e,t)||n.has(e,t)}));class IY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(CY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function CY(n){return n.getComponent()?.type==="VERSION"}const Ab="@firebase/app",yN="0.14.6";const sc=new HR("@firebase/app"),kY="@firebase/app-compat",PY="@firebase/analytics-compat",MY="@firebase/analytics",NY="@firebase/app-check-compat",LY="@firebase/app-check",OY="@firebase/auth",DY="@firebase/auth-compat",FY="@firebase/database",jY="@firebase/data-connect",VY="@firebase/database-compat",BY="@firebase/functions",GY="@firebase/functions-compat",zY="@firebase/installations",UY="@firebase/installations-compat",$Y="@firebase/messaging",WY="@firebase/messaging-compat",HY="@firebase/performance",KY="@firebase/performance-compat",XY="@firebase/remote-config",qY="@firebase/remote-config-compat",YY="@firebase/storage",ZY="@firebase/storage-compat",QY="@firebase/firestore",JY="@firebase/ai",eZ="@firebase/firestore-compat",tZ="firebase",nZ="12.6.0";const Rb="[DEFAULT]",rZ={[Ab]:"fire-core",[kY]:"fire-core-compat",[MY]:"fire-analytics",[PY]:"fire-analytics-compat",[LY]:"fire-app-check",[NY]:"fire-app-check-compat",[OY]:"fire-auth",[DY]:"fire-auth-compat",[FY]:"fire-rtdb",[jY]:"fire-data-connect",[VY]:"fire-rtdb-compat",[BY]:"fire-fn",[GY]:"fire-fn-compat",[zY]:"fire-iid",[UY]:"fire-iid-compat",[$Y]:"fire-fcm",[WY]:"fire-fcm-compat",[HY]:"fire-perf",[KY]:"fire-perf-compat",[XY]:"fire-rc",[qY]:"fire-rc-compat",[YY]:"fire-gcs",[ZY]:"fire-gcs-compat",[QY]:"fire-fst",[eZ]:"fire-fst-compat",[JY]:"fire-vertex","fire-js":"fire-js",[tZ]:"fire-js-all"};const Q_=new Map,iZ=new Map,Ib=new Map;function xN(n,e){try{n.container.addComponent(e)}catch(t){sc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ud(n){const e=n.name;if(Ib.has(e))return sc.debug(`There were multiple attempts to register component ${e}.`),!1;Ib.set(e,n);for(const t of Q_.values())xN(t,n);for(const t of iZ.values())xN(t,n);return!0}function Dw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ua(n){return n==null?!1:n.settings!==void 0}const sZ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Su=new b1("app","Firebase",sZ);class aZ{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ku("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Su.create("app-deleted",{appName:this._name})}}const Md=nZ;function T6(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Rb,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Su.create("bad-app-name",{appName:String(i)});if(t||(t=m6()),!t)throw Su.create("no-options");const s=Q_.get(i);if(s){if(cd(t,s.options)&&cd(r,s.config))return s;throw Su.create("duplicate-app",{appName:i})}const a=new dY(i);for(const l of Ib.values())a.addComponent(l);const o=new aZ(t,r,a);return Q_.set(i,o),o}function XR(n=Rb){const e=Q_.get(n);if(!e&&n===Rb&&m6())return T6();if(!e)throw Su.create("no-app",{appName:n});return e}function nl(n,e,t){let r=rZ[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sc.warn(a.join(" "));return}ud(new ku(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const oZ="firebase-heartbeat-database",lZ=1,kp="firebase-heartbeat-store";let QS=null;function b6(){return QS||(QS=bY(oZ,lZ,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(kp)}catch(t){console.warn(t)}}}}).catch(n=>{throw Su.create("idb-open",{originalErrorMessage:n.message})})),QS}async function cZ(n){try{const t=(await b6()).transaction(kp),r=await t.objectStore(kp).get(A6(n));return await t.done,r}catch(e){if(e instanceof _l)sc.warn(e.message);else{const t=Su.create("idb-get",{originalErrorMessage:e?.message});sc.warn(t.message)}}}async function _N(n,e){try{const r=(await b6()).transaction(kp,"readwrite");await r.objectStore(kp).put(e,A6(n)),await r.done}catch(t){if(t instanceof _l)sc.warn(t.message);else{const r=Su.create("idb-set",{originalErrorMessage:t?.message});sc.warn(r.message)}}}function A6(n){return`${n.name}!${n.options.appId}`}const uZ=1024,hZ=30;class dZ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gZ(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=vN();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>hZ){const i=mZ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){sc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=vN(),{heartbeatsToSend:t,unsentEntries:r}=fZ(this._heartbeatsCache.heartbeats),i=Z_(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return sc.warn(e),""}}}function vN(){return new Date().toISOString().substring(0,10)}function fZ(n,e=uZ){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),wN(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),wN(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class gZ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w6()?tY().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await cZ(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return _N(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return _N(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function wN(n){return Z_(JSON.stringify({version:2,heartbeats:n})).length}function mZ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function pZ(n){ud(new ku("platform-logger",e=>new IY(e),"PRIVATE")),ud(new ku("heartbeat",e=>new dZ(e),"PRIVATE")),nl(Ab,yN,n),nl(Ab,yN,"esm2020"),nl("fire-js","")}pZ("");function R6(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yZ=R6,I6=new b1("auth","Firebase",R6());const J_=new HR("@firebase/auth");function xZ(n,...e){J_.logLevel<=yn.WARN&&J_.warn(`Auth (${Md}): ${n}`,...e)}function e_(n,...e){J_.logLevel<=yn.ERROR&&J_.error(`Auth (${Md}): ${n}`,...e)}function hl(n,...e){throw YR(n,...e)}function _o(n,...e){return YR(n,...e)}function qR(n,e,t){const r={...yZ(),[e]:t};return new b1("auth","Firebase",r).create(e,{appName:n.name})}function Tu(n){return qR(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _Z(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&hl(n,"argument-error"),qR(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function YR(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return I6.create(n,...e)}function Yt(n,e,...t){if(!n)throw YR(e,...t)}function Ul(n){const e="INTERNAL ASSERTION FAILED: "+n;throw e_(e),new Error(e)}function ac(n,e){n||Ul(e)}function Cb(){return typeof self<"u"&&self.location?.href||""}function vZ(){return EN()==="http:"||EN()==="https:"}function EN(){return typeof self<"u"&&self.location?.protocol||null}function wZ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vZ()||Qq()||"connection"in navigator)?navigator.onLine:!0}function EZ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class R1{constructor(e,t){this.shortDelay=e,this.longDelay=t,ac(t>e,"Short delay should be less than long delay!"),this.isMobile=Yq()||Jq()}get(){return wZ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ZR(n,e){ac(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class C6{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ul("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ul("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ul("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const SZ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const TZ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bZ=new R1(3e4,6e4);function Fw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function lg(n,e,t,r,i={}){return k6(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=A1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...s};return Zq()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(c.credentials="include"),C6.fetch()(await M6(n,n.config.apiHost,t,o),c)})}async function k6(n,e,t){n._canInitEmulator=!1;const r={...SZ,...e};try{const i=new AZ(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Ex(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ex(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Ex(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Ex(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw qR(n,h,c);hl(n,h)}}catch(i){if(i instanceof _l)throw i;hl(n,"network-request-failed",{message:String(i)})}}async function P6(n,e,t,r,i={}){const s=await lg(n,e,t,r,i);return"mfaPendingCredential"in s&&hl(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function M6(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?ZR(n.config,i):`${n.config.apiScheme}://${i}`;return TZ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class AZ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(_o(this.auth,"network-request-failed")),bZ.get())})}}function Ex(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=_o(n,e,r);return i.customData._tokenResponse=t,i}async function RZ(n,e){return lg(n,"POST","/v1/accounts:delete",e)}async function ev(n,e){return lg(n,"POST","/v1/accounts:lookup",e)}function Vm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function IZ(n,e=!1){const t=Pi(n),r=await t.getIdToken(e),i=QR(r);Yt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Vm(JS(i.auth_time)),issuedAtTime:Vm(JS(i.iat)),expirationTime:Vm(JS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function JS(n){return Number(n)*1e3}function QR(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return e_("JWT malformed, contained fewer than 3 sections"),null;try{const i=h6(t);return i?JSON.parse(i):(e_("Failed to decode base64 JWT payload"),null)}catch(i){return e_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function SN(n){const e=QR(n);return Yt(e,"internal-error"),Yt(typeof e.exp<"u","internal-error"),Yt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Pp(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof _l&&CZ(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function CZ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class kZ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class kb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vm(this.lastLoginAt),this.creationTime=Vm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function tv(n){const e=n.auth,t=await n.getIdToken(),r=await Pp(n,ev(e,{idToken:t}));Yt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?N6(i.providerUserInfo):[],a=MZ(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,c=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new kb(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function PZ(n){const e=Pi(n);await tv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function MZ(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function N6(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function NZ(n,e){const t=await k6(n,{},async()=>{const r=A1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await M6(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(l.credentials="include"),C6.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function LZ(n,e){return lg(n,"POST","/v2/accounts:revokeToken",Fw(n,e))}class g0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Yt(e.idToken,"internal-error"),Yt(typeof e.idToken<"u","internal-error"),Yt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):SN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Yt(e.length!==0,"internal-error");const t=SN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Yt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await NZ(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new g0;return r&&(Yt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Yt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Yt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new g0,this.toJSON())}_performRefresh(){return Ul("not implemented")}}function Xc(n,e){Yt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class mo{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new kZ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new kb(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Pp(this,this.stsTokenManager.getToken(this.auth,e));return Yt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return IZ(this,e)}reload(){return PZ(this)}_assign(e){this!==e&&(Yt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Yt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await tv(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ua(this.auth.app))return Promise.reject(Tu(this.auth));const e=await this.getIdToken();return await Pp(this,RZ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:y,providerData:v,stsTokenManager:x}=t;Yt(g&&x,e,"internal-error");const w=g0.fromJSON(this.name,x);Yt(typeof g=="string",e,"internal-error"),Xc(r,e.name),Xc(i,e.name),Yt(typeof m=="boolean",e,"internal-error"),Yt(typeof y=="boolean",e,"internal-error"),Xc(s,e.name),Xc(a,e.name),Xc(o,e.name),Xc(l,e.name),Xc(c,e.name),Xc(h,e.name);const T=new mo({uid:g,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:w,createdAt:c,lastLoginAt:h});return v&&Array.isArray(v)&&(T.providerData=v.map(b=>({...b}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new g0;i.updateFromServerResponse(t);const s=new mo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await tv(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Yt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?N6(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new g0;o.updateFromIdToken(r);const l=new mo({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new kb(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const TN=new Map;function $l(n){ac(n instanceof Function,"Expected a class definition");let e=TN.get(n);return e?(ac(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,TN.set(n,e),e)}class L6{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}L6.type="NONE";const bN=L6;function t_(n,e,t){return`firebase:${n}:${e}:${t}`}class m0{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=t_(this.userKey,i.apiKey,s),this.fullPersistenceKey=t_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ev(this.auth,{idToken:e}).catch(()=>{});return t?mo._fromGetAccountInfoResponse(this.auth,t,e):null}return mo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new m0($l(bN),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||$l(bN);const a=t_(r,e.config.apiKey,e.name);let o=null;for(const c of t)try{const h=await c._get(a);if(h){let g;if(typeof h=="string"){const m=await ev(e,{idToken:h}).catch(()=>{});if(!m)break;g=await mo._fromGetAccountInfoResponse(e,m,h)}else g=mo._fromJSON(e,h);c!==s&&(o=g),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new m0(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new m0(s,e,r))}}function AN(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(j6(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(O6(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(B6(e))return"Blackberry";if(G6(e))return"Webos";if(D6(e))return"Safari";if((e.includes("chrome/")||F6(e))&&!e.includes("edge/"))return"Chrome";if(V6(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function O6(n=pi()){return/firefox\//i.test(n)}function D6(n=pi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function F6(n=pi()){return/crios\//i.test(n)}function j6(n=pi()){return/iemobile/i.test(n)}function V6(n=pi()){return/android/i.test(n)}function B6(n=pi()){return/blackberry/i.test(n)}function G6(n=pi()){return/webos/i.test(n)}function JR(n=pi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function OZ(n=pi()){return JR(n)&&!!window.navigator?.standalone}function DZ(){return eY()&&document.documentMode===10}function z6(n=pi()){return JR(n)||V6(n)||G6(n)||B6(n)||/windows phone/i.test(n)||j6(n)}function U6(n,e=[]){let t;switch(n){case"Browser":t=AN(pi());break;case"Worker":t=`${AN(pi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Md}/${r}`}class FZ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function jZ(n,e={}){return lg(n,"GET","/v2/passwordPolicy",Fw(n,e))}const VZ=6;class BZ{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??VZ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class GZ{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new RN(this),this.idTokenSubscription=new RN(this),this.beforeStateQueue=new FZ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=I6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$l(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await m0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ev(this,{idToken:e}),r=await mo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ua(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Yt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tv(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EZ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ua(this.app))return Promise.reject(Tu(this));const t=e?Pi(e):null;return t&&Yt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Yt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ua(this.app)?Promise.reject(Tu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ua(this.app)?Promise.reject(Tu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($l(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jZ(this),t=new BZ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new b1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await LZ(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$l(e)||this._popupRedirectResolver;Yt(t,this,"argument-error"),this.redirectPersistenceManager=await m0.create(this,[$l(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Yt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Yt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=U6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ua(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&xZ(`Error while retrieving App Check token: ${e.error}`),e?.token}}function I1(n){return Pi(n)}class RN{constructor(e){this.auth=e,this.observer=null,this.addObserver=aY(t=>this.observer=t)}get next(){return Yt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let eI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zZ(n){eI=n}function UZ(n){return eI.loadJS(n)}function $Z(){return eI.gapiScript}function WZ(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function HZ(n,e){const t=Dw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(cd(s,e??{}))return i;hl(i,"already-initialized")}return t.initialize({options:e})}function KZ(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map($l);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function XZ(n,e,t){const r=I1(n);Yt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=$6(e),{host:a,port:o}=qZ(e),l=o===null?"":`:${o}`,c={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Yt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Yt(cd(c,r.config.emulator)&&cd(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Pd(a)?($R(`${s}//${a}${l}`),WR("Auth",!0)):YZ()}function $6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function qZ(n){const e=$6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:IN(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:IN(a)}}}function IN(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function YZ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class W6{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ul("not implemented")}_getIdTokenResponse(e){return Ul("not implemented")}_linkToIdToken(e,t){return Ul("not implemented")}_getReauthenticationResolver(e){return Ul("not implemented")}}async function p0(n,e){return P6(n,"POST","/v1/accounts:signInWithIdp",Fw(n,e))}const ZZ="http://localhost";class hd extends W6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new hd(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return p0(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,p0(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,p0(e,t)}buildRequest(){const e={requestUri:ZZ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=A1(t)}return e}}class tI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class C1 extends tI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class iu extends C1{constructor(){super("facebook.com")}static credential(e){return hd._fromParams({providerId:iu.PROVIDER_ID,signInMethod:iu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return iu.credentialFromTaggedObject(e)}static credentialFromError(e){return iu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return iu.credential(e.oauthAccessToken)}catch{return null}}}iu.FACEBOOK_SIGN_IN_METHOD="facebook.com";iu.PROVIDER_ID="facebook.com";class ho extends C1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hd._fromParams({providerId:ho.PROVIDER_ID,signInMethod:ho.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ho.credentialFromTaggedObject(e)}static credentialFromError(e){return ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ho.credential(t,r)}catch{return null}}}ho.GOOGLE_SIGN_IN_METHOD="google.com";ho.PROVIDER_ID="google.com";class su extends C1{constructor(){super("github.com")}static credential(e){return hd._fromParams({providerId:su.PROVIDER_ID,signInMethod:su.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return su.credentialFromTaggedObject(e)}static credentialFromError(e){return su.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return su.credential(e.oauthAccessToken)}catch{return null}}}su.GITHUB_SIGN_IN_METHOD="github.com";su.PROVIDER_ID="github.com";class au extends C1{constructor(){super("twitter.com")}static credential(e,t){return hd._fromParams({providerId:au.PROVIDER_ID,signInMethod:au.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return au.credentialFromTaggedObject(e)}static credentialFromError(e){return au.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return au.credential(t,r)}catch{return null}}}au.TWITTER_SIGN_IN_METHOD="twitter.com";au.PROVIDER_ID="twitter.com";async function QZ(n,e){return P6(n,"POST","/v1/accounts:signUp",Fw(n,e))}class Pu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await mo._fromIdTokenResponse(e,r,i),a=CN(r);return new Pu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=CN(r);return new Pu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function CN(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function JZ(n){if(ua(n.app))return Promise.reject(Tu(n));const e=I1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Pu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await QZ(e,{returnSecureToken:!0}),r=await Pu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class nv extends _l{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,nv.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new nv(e,t,r,i)}}function H6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?nv._fromErrorAndOperation(n,s,e,r):s})}async function eQ(n,e,t=!1){const r=await Pp(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Pu._forOperation(n,"link",r)}async function tQ(n,e,t=!1){const{auth:r}=n;if(ua(r.app))return Promise.reject(Tu(r));const i="reauthenticate";try{const s=await Pp(n,H6(r,i,e,n),t);Yt(s.idToken,r,"internal-error");const a=QR(s.idToken);Yt(a,r,"internal-error");const{sub:o}=a;return Yt(n.uid===o,r,"user-mismatch"),Pu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&hl(r,"user-mismatch"),s}}async function nQ(n,e,t=!1){if(ua(n.app))return Promise.reject(Tu(n));const r="signIn",i=await H6(n,r,e),s=await Pu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function rQ(n,e,t,r){return Pi(n).onIdTokenChanged(e,t,r)}function iQ(n,e,t){return Pi(n).beforeAuthStateChanged(e,t)}function K6(n,e,t,r){return Pi(n).onAuthStateChanged(e,t,r)}function X6(n){return Pi(n).signOut()}const rv="__sak";class q6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(rv,"1"),this.storage.removeItem(rv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const sQ=1e3,aQ=10;class Y6 extends q6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=z6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);DZ()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,aQ):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},sQ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Y6.type="LOCAL";const oQ=Y6;class Z6 extends q6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Z6.type="SESSION";const Q6=Z6;function lQ(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class jw{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new jw(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async c=>c(t.origin,s)),l=await lQ(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jw.receivers=[];function nI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class cQ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=nI("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){const m=g;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function rl(){return window}function uQ(n){rl().location.href=n}function J6(){return typeof rl().WorkerGlobalScope<"u"&&typeof rl().importScripts=="function"}async function hQ(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function dQ(){return navigator?.serviceWorker?.controller||null}function fQ(){return J6()?self:null}const ej="firebaseLocalStorageDb",gQ=1,iv="firebaseLocalStorage",tj="fbase_key";class k1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Vw(n,e){return n.transaction([iv],e?"readwrite":"readonly").objectStore(iv)}function mQ(){const n=indexedDB.deleteDatabase(ej);return new k1(n).toPromise()}function Pb(){const n=indexedDB.open(ej,gQ);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(iv,{keyPath:tj})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(iv)?e(r):(r.close(),await mQ(),e(await Pb()))})})}async function kN(n,e,t){const r=Vw(n,!0).put({[tj]:e,value:t});return new k1(r).toPromise()}async function pQ(n,e){const t=Vw(n,!1).get(e),r=await new k1(t).toPromise();return r===void 0?null:r.value}function PN(n,e){const t=Vw(n,!0).delete(e);return new k1(t).toPromise()}const yQ=800,xQ=3;class nj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Pb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>xQ)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return J6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jw._getInstance(fQ()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await hQ(),!this.activeServiceWorker)return;this.sender=new cQ(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||dQ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Pb();return await kN(e,rv,"1"),await PN(e,rv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>kN(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>pQ(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>PN(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Vw(i,!1).getAll();return new k1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yQ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}nj.type="LOCAL";const _Q=nj;new R1(3e4,6e4);function rj(n,e){return e?$l(e):(Yt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class rI extends W6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return p0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return p0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return p0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function vQ(n){return nQ(n.auth,new rI(n),n.bypassAuthState)}function wQ(n){const{auth:e,user:t}=n;return Yt(t,e,"internal-error"),tQ(t,new rI(n),n.bypassAuthState)}async function EQ(n){const{auth:e,user:t}=n;return Yt(t,e,"internal-error"),eQ(t,new rI(n),n.bypassAuthState)}class ij{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vQ;case"linkViaPopup":case"linkViaRedirect":return EQ;case"reauthViaPopup":case"reauthViaRedirect":return wQ;default:hl(this.auth,"internal-error")}}resolve(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const SQ=new R1(2e3,1e4);async function MN(n,e,t){if(ua(n.app))return Promise.reject(_o(n,"operation-not-supported-in-this-environment"));const r=I1(n);_Z(n,e,tI);const i=rj(r,t);return new Bh(r,"signInViaPopup",e,i).executeNotNull()}class Bh extends ij{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Bh.currentPopupAction&&Bh.currentPopupAction.cancel(),Bh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Yt(e,this.auth,"internal-error"),e}async onExecution(){ac(this.filter.length===1,"Popup operations only handle one event");const e=nI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_o(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(_o(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_o(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,SQ.get())};e()}}Bh.currentPopupAction=null;const TQ="pendingRedirect",n_=new Map;class bQ extends ij{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=n_.get(this.auth._key());if(!e){try{const r=await AQ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}n_.set(this.auth._key(),e)}return this.bypassAuthState||n_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function AQ(n,e){const t=CQ(e),r=IQ(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function RQ(n,e){n_.set(n._key(),e)}function IQ(n){return $l(n._redirectPersistence)}function CQ(n){return t_(TQ,n.config.apiKey,n.name)}async function kQ(n,e,t=!1){if(ua(n.app))return Promise.reject(Tu(n));const r=I1(n),i=rj(r,e),a=await new bQ(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const PQ=600*1e3;class MQ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!NQ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!sj(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(_o(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=PQ&&this.cachedEventUids.clear(),this.cachedEventUids.has(NN(e))}saveEventToCache(e){this.cachedEventUids.add(NN(e)),this.lastProcessedEventTime=Date.now()}}function NN(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function sj({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function NQ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sj(n);default:return!1}}async function LQ(n,e={}){return lg(n,"GET","/v1/projects",e)}const OQ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DQ=/^https?/;async function FQ(n){if(n.config.emulator)return;const{authorizedDomains:e}=await LQ(n);for(const t of e)try{if(jQ(t))return}catch{}hl(n,"unauthorized-domain")}function jQ(n){const e=Cb(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!DQ.test(t))return!1;if(OQ.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const VQ=new R1(3e4,6e4);function LN(){const n=rl().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function BQ(n){return new Promise((e,t)=>{function r(){LN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{LN(),t(_o(n,"network-request-failed"))},timeout:VQ.get()})}if(rl().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rl().gapi?.load)r();else{const i=WZ("iframefcb");return rl()[i]=()=>{gapi.load?r():t(_o(n,"network-request-failed"))},UZ(`${$Z()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw r_=null,e})}let r_=null;function GQ(n){return r_=r_||BQ(n),r_}const zQ=new R1(5e3,15e3),UQ="__/auth/iframe",$Q="emulator/auth/iframe",WQ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HQ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function KQ(n){const e=n.config;Yt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ZR(e,$Q):`https://${n.config.authDomain}/${UQ}`,r={apiKey:e.apiKey,appName:n.name,v:Md},i=HQ.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${A1(r).slice(1)}`}async function XQ(n){const e=await GQ(n),t=rl().gapi;return Yt(t,n,"internal-error"),e.open({where:document.body,url:KQ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:WQ,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=_o(n,"network-request-failed"),o=rl().setTimeout(()=>{s(a)},zQ.get());function l(){rl().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const qQ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},YQ=500,ZQ=600,QQ="_blank",JQ="http://localhost";class ON{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function eJ(n,e,t,r=YQ,i=ZQ){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...qQ,width:r.toString(),height:i.toString(),top:s,left:a},c=pi().toLowerCase();t&&(o=F6(c)?QQ:t),O6(c)&&(e=e||JQ,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[y,v])=>`${m}${y}=${v},`,"");if(OZ(c)&&o!=="_self")return tJ(e||"",o),new ON(null);const g=window.open(e||"",o,h);Yt(g,n,"popup-blocked");try{g.focus()}catch{}return new ON(g)}function tJ(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const nJ="__/auth/handler",rJ="emulator/auth/handler",iJ=encodeURIComponent("fac");async function DN(n,e,t,r,i,s){Yt(n.config.authDomain,n,"auth-domain-config-required"),Yt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Md,eventId:i};if(e instanceof tI){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",sY(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,g]of Object.entries({}))a[h]=g}if(e instanceof C1){const h=e.getScopes().filter(g=>g!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),c=l?`#${iJ}=${encodeURIComponent(l)}`:"";return`${sJ(n)}?${A1(o).slice(1)}${c}`}function sJ({config:n}){return n.emulator?ZR(n,rJ):`https://${n.authDomain}/${nJ}`}const eT="webStorageSupport";class aJ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Q6,this._completeRedirectFn=kQ,this._overrideRedirectResult=RQ}async _openPopup(e,t,r,i){ac(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await DN(e,t,r,Cb(),i);return eJ(e,s,nI())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await DN(e,t,r,Cb(),i);return uQ(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ac(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await XQ(e),r=new MQ(e);return t.register("authEvent",i=>(Yt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(eT,{type:eT},i=>{const s=i?.[0]?.[eT];s!==void 0&&t(!!s),hl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=FQ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return z6()||D6()||JR()}}const oJ=aJ;var FN="@firebase/auth",jN="1.12.0";class lJ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Yt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function cJ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uJ(n){ud(new ku("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Yt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:U6(n)},c=new GZ(r,i,s,l);return KZ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ud(new ku("auth-internal",e=>{const t=I1(e.getProvider("auth").getImmediate());return(r=>new lJ(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),nl(FN,jN,cJ(n)),nl(FN,jN,"esm2020")}const hJ=300,dJ=p6("authIdTokenMaxAge")||hJ;let VN=null;const fJ=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>dJ)return;const i=t?.token;VN!==i&&(VN=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gJ(n=XR()){const e=Dw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=HZ(n,{popupRedirectResolver:oJ,persistence:[_Q,oQ,Q6]}),r=p6("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=fJ(s.toString());iQ(t,a,()=>a(t.currentUser)),rQ(t,o=>a(o))}}const i=f6("auth");return i&&XZ(t,`http://${i}`),t}function mJ(){return document.getElementsByTagName("head")?.[0]??document}zZ({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=_o("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",mJ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uJ("Browser");var pJ="firebase",yJ="12.7.0";nl(pJ,yJ,"app");var BN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var bu,aj;(function(){var n;function e(I,R){function P(){}P.prototype=R.prototype,I.F=R.prototype,I.prototype=new P,I.prototype.constructor=I,I.D=function(F,N,B){for(var j=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)j[ve-2]=arguments[ve];return R.prototype[N].apply(F,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,R,P){P||(P=0);const F=Array(16);if(typeof R=="string")for(var N=0;N<16;++N)F[N]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(N=0;N<16;++N)F[N]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=I.g[0],P=I.g[1],N=I.g[2];let B=I.g[3],j;j=R+(B^P&(N^B))+F[0]+3614090360&4294967295,R=P+(j<<7&4294967295|j>>>25),j=B+(N^R&(P^N))+F[1]+3905402710&4294967295,B=R+(j<<12&4294967295|j>>>20),j=N+(P^B&(R^P))+F[2]+606105819&4294967295,N=B+(j<<17&4294967295|j>>>15),j=P+(R^N&(B^R))+F[3]+3250441966&4294967295,P=N+(j<<22&4294967295|j>>>10),j=R+(B^P&(N^B))+F[4]+4118548399&4294967295,R=P+(j<<7&4294967295|j>>>25),j=B+(N^R&(P^N))+F[5]+1200080426&4294967295,B=R+(j<<12&4294967295|j>>>20),j=N+(P^B&(R^P))+F[6]+2821735955&4294967295,N=B+(j<<17&4294967295|j>>>15),j=P+(R^N&(B^R))+F[7]+4249261313&4294967295,P=N+(j<<22&4294967295|j>>>10),j=R+(B^P&(N^B))+F[8]+1770035416&4294967295,R=P+(j<<7&4294967295|j>>>25),j=B+(N^R&(P^N))+F[9]+2336552879&4294967295,B=R+(j<<12&4294967295|j>>>20),j=N+(P^B&(R^P))+F[10]+4294925233&4294967295,N=B+(j<<17&4294967295|j>>>15),j=P+(R^N&(B^R))+F[11]+2304563134&4294967295,P=N+(j<<22&4294967295|j>>>10),j=R+(B^P&(N^B))+F[12]+1804603682&4294967295,R=P+(j<<7&4294967295|j>>>25),j=B+(N^R&(P^N))+F[13]+4254626195&4294967295,B=R+(j<<12&4294967295|j>>>20),j=N+(P^B&(R^P))+F[14]+2792965006&4294967295,N=B+(j<<17&4294967295|j>>>15),j=P+(R^N&(B^R))+F[15]+1236535329&4294967295,P=N+(j<<22&4294967295|j>>>10),j=R+(N^B&(P^N))+F[1]+4129170786&4294967295,R=P+(j<<5&4294967295|j>>>27),j=B+(P^N&(R^P))+F[6]+3225465664&4294967295,B=R+(j<<9&4294967295|j>>>23),j=N+(R^P&(B^R))+F[11]+643717713&4294967295,N=B+(j<<14&4294967295|j>>>18),j=P+(B^R&(N^B))+F[0]+3921069994&4294967295,P=N+(j<<20&4294967295|j>>>12),j=R+(N^B&(P^N))+F[5]+3593408605&4294967295,R=P+(j<<5&4294967295|j>>>27),j=B+(P^N&(R^P))+F[10]+38016083&4294967295,B=R+(j<<9&4294967295|j>>>23),j=N+(R^P&(B^R))+F[15]+3634488961&4294967295,N=B+(j<<14&4294967295|j>>>18),j=P+(B^R&(N^B))+F[4]+3889429448&4294967295,P=N+(j<<20&4294967295|j>>>12),j=R+(N^B&(P^N))+F[9]+568446438&4294967295,R=P+(j<<5&4294967295|j>>>27),j=B+(P^N&(R^P))+F[14]+3275163606&4294967295,B=R+(j<<9&4294967295|j>>>23),j=N+(R^P&(B^R))+F[3]+4107603335&4294967295,N=B+(j<<14&4294967295|j>>>18),j=P+(B^R&(N^B))+F[8]+1163531501&4294967295,P=N+(j<<20&4294967295|j>>>12),j=R+(N^B&(P^N))+F[13]+2850285829&4294967295,R=P+(j<<5&4294967295|j>>>27),j=B+(P^N&(R^P))+F[2]+4243563512&4294967295,B=R+(j<<9&4294967295|j>>>23),j=N+(R^P&(B^R))+F[7]+1735328473&4294967295,N=B+(j<<14&4294967295|j>>>18),j=P+(B^R&(N^B))+F[12]+2368359562&4294967295,P=N+(j<<20&4294967295|j>>>12),j=R+(P^N^B)+F[5]+4294588738&4294967295,R=P+(j<<4&4294967295|j>>>28),j=B+(R^P^N)+F[8]+2272392833&4294967295,B=R+(j<<11&4294967295|j>>>21),j=N+(B^R^P)+F[11]+1839030562&4294967295,N=B+(j<<16&4294967295|j>>>16),j=P+(N^B^R)+F[14]+4259657740&4294967295,P=N+(j<<23&4294967295|j>>>9),j=R+(P^N^B)+F[1]+2763975236&4294967295,R=P+(j<<4&4294967295|j>>>28),j=B+(R^P^N)+F[4]+1272893353&4294967295,B=R+(j<<11&4294967295|j>>>21),j=N+(B^R^P)+F[7]+4139469664&4294967295,N=B+(j<<16&4294967295|j>>>16),j=P+(N^B^R)+F[10]+3200236656&4294967295,P=N+(j<<23&4294967295|j>>>9),j=R+(P^N^B)+F[13]+681279174&4294967295,R=P+(j<<4&4294967295|j>>>28),j=B+(R^P^N)+F[0]+3936430074&4294967295,B=R+(j<<11&4294967295|j>>>21),j=N+(B^R^P)+F[3]+3572445317&4294967295,N=B+(j<<16&4294967295|j>>>16),j=P+(N^B^R)+F[6]+76029189&4294967295,P=N+(j<<23&4294967295|j>>>9),j=R+(P^N^B)+F[9]+3654602809&4294967295,R=P+(j<<4&4294967295|j>>>28),j=B+(R^P^N)+F[12]+3873151461&4294967295,B=R+(j<<11&4294967295|j>>>21),j=N+(B^R^P)+F[15]+530742520&4294967295,N=B+(j<<16&4294967295|j>>>16),j=P+(N^B^R)+F[2]+3299628645&4294967295,P=N+(j<<23&4294967295|j>>>9),j=R+(N^(P|~B))+F[0]+4096336452&4294967295,R=P+(j<<6&4294967295|j>>>26),j=B+(P^(R|~N))+F[7]+1126891415&4294967295,B=R+(j<<10&4294967295|j>>>22),j=N+(R^(B|~P))+F[14]+2878612391&4294967295,N=B+(j<<15&4294967295|j>>>17),j=P+(B^(N|~R))+F[5]+4237533241&4294967295,P=N+(j<<21&4294967295|j>>>11),j=R+(N^(P|~B))+F[12]+1700485571&4294967295,R=P+(j<<6&4294967295|j>>>26),j=B+(P^(R|~N))+F[3]+2399980690&4294967295,B=R+(j<<10&4294967295|j>>>22),j=N+(R^(B|~P))+F[10]+4293915773&4294967295,N=B+(j<<15&4294967295|j>>>17),j=P+(B^(N|~R))+F[1]+2240044497&4294967295,P=N+(j<<21&4294967295|j>>>11),j=R+(N^(P|~B))+F[8]+1873313359&4294967295,R=P+(j<<6&4294967295|j>>>26),j=B+(P^(R|~N))+F[15]+4264355552&4294967295,B=R+(j<<10&4294967295|j>>>22),j=N+(R^(B|~P))+F[6]+2734768916&4294967295,N=B+(j<<15&4294967295|j>>>17),j=P+(B^(N|~R))+F[13]+1309151649&4294967295,P=N+(j<<21&4294967295|j>>>11),j=R+(N^(P|~B))+F[4]+4149444226&4294967295,R=P+(j<<6&4294967295|j>>>26),j=B+(P^(R|~N))+F[11]+3174756917&4294967295,B=R+(j<<10&4294967295|j>>>22),j=N+(R^(B|~P))+F[2]+718787259&4294967295,N=B+(j<<15&4294967295|j>>>17),j=P+(B^(N|~R))+F[9]+3951481745&4294967295,I.g[0]=I.g[0]+R&4294967295,I.g[1]=I.g[1]+(N+(j<<21&4294967295|j>>>11))&4294967295,I.g[2]=I.g[2]+N&4294967295,I.g[3]=I.g[3]+B&4294967295}r.prototype.v=function(I,R){R===void 0&&(R=I.length);const P=R-this.blockSize,F=this.C;let N=this.h,B=0;for(;B<R;){if(N==0)for(;B<=P;)i(this,I,B),B+=this.blockSize;if(typeof I=="string"){for(;B<R;)if(F[N++]=I.charCodeAt(B++),N==this.blockSize){i(this,F),N=0;break}}else for(;B<R;)if(F[N++]=I[B++],N==this.blockSize){i(this,F),N=0;break}}this.h=N,this.o+=R},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var R=1;R<I.length-8;++R)I[R]=0;R=this.o*8;for(var P=I.length-8;P<I.length;++P)I[P]=R&255,R/=256;for(this.v(I),I=Array(16),R=0,P=0;P<4;++P)for(let F=0;F<32;F+=8)I[R++]=this.g[P]>>>F&255;return I};function s(I,R){var P=o;return Object.prototype.hasOwnProperty.call(P,I)?P[I]:P[I]=R(I)}function a(I,R){this.h=R;const P=[];let F=!0;for(let N=I.length-1;N>=0;N--){const B=I[N]|0;F&&B==R||(P[N]=B,F=!1)}this.g=P}var o={};function l(I){return-128<=I&&I<128?s(I,function(R){return new a([R|0],R<0?-1:0)}):new a([I|0],I<0?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return g;if(I<0)return w(c(-I));const R=[];let P=1;for(let F=0;I>=P;F++)R[F]=I/P|0,P*=4294967296;return new a(R,0)}function h(I,R){if(I.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(I.charAt(0)=="-")return w(h(I.substring(1),R));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=c(Math.pow(R,8));let F=g;for(let B=0;B<I.length;B+=8){var N=Math.min(8,I.length-B);const j=parseInt(I.substring(B,B+N),R);N<8?(N=c(Math.pow(R,N)),F=F.j(N).add(c(j))):(F=F.j(P),F=F.add(c(j)))}return F}var g=l(0),m=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-w(this).m();let I=0,R=1;for(let P=0;P<this.g.length;P++){const F=this.i(P);I+=(F>=0?F:4294967296+F)*R,R*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(x(this))return"-"+w(this).toString(I);const R=c(Math.pow(I,6));var P=this;let F="";for(;;){const N=M(P,R).g;P=T(P,N.j(R));let B=((P.g.length>0?P.g[0]:P.h)>>>0).toString(I);if(P=N,v(P))return B+F;for(;B.length<6;)B="0"+B;F=B+F}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(let R=0;R<I.g.length;R++)if(I.g[R]!=0)return!1;return!0}function x(I){return I.h==-1}n.l=function(I){return I=T(this,I),x(I)?-1:v(I)?0:1};function w(I){const R=I.g.length,P=[];for(let F=0;F<R;F++)P[F]=~I.g[F];return new a(P,~I.h).add(m)}n.abs=function(){return x(this)?w(this):this},n.add=function(I){const R=Math.max(this.g.length,I.g.length),P=[];let F=0;for(let N=0;N<=R;N++){let B=F+(this.i(N)&65535)+(I.i(N)&65535),j=(B>>>16)+(this.i(N)>>>16)+(I.i(N)>>>16);F=j>>>16,B&=65535,j&=65535,P[N]=j<<16|B}return new a(P,P[P.length-1]&-2147483648?-1:0)};function T(I,R){return I.add(w(R))}n.j=function(I){if(v(this)||v(I))return g;if(x(this))return x(I)?w(this).j(w(I)):w(w(this).j(I));if(x(I))return w(this.j(w(I)));if(this.l(y)<0&&I.l(y)<0)return c(this.m()*I.m());const R=this.g.length+I.g.length,P=[];for(var F=0;F<2*R;F++)P[F]=0;for(F=0;F<this.g.length;F++)for(let N=0;N<I.g.length;N++){const B=this.i(F)>>>16,j=this.i(F)&65535,ve=I.i(N)>>>16,ke=I.i(N)&65535;P[2*F+2*N]+=j*ke,b(P,2*F+2*N),P[2*F+2*N+1]+=B*ke,b(P,2*F+2*N+1),P[2*F+2*N+1]+=j*ve,b(P,2*F+2*N+1),P[2*F+2*N+2]+=B*ve,b(P,2*F+2*N+2)}for(I=0;I<R;I++)P[I]=P[2*I+1]<<16|P[2*I];for(I=R;I<2*R;I++)P[I]=0;return new a(P,0)};function b(I,R){for(;(I[R]&65535)!=I[R];)I[R+1]+=I[R]>>>16,I[R]&=65535,R++}function A(I,R){this.g=I,this.h=R}function M(I,R){if(v(R))throw Error("division by zero");if(v(I))return new A(g,g);if(x(I))return R=M(w(I),R),new A(w(R.g),w(R.h));if(x(R))return R=M(I,w(R)),new A(w(R.g),R.h);if(I.g.length>30){if(x(I)||x(R))throw Error("slowDivide_ only works with positive integers.");for(var P=m,F=R;F.l(I)<=0;)P=O(P),F=O(F);var N=z(P,1),B=z(F,1);for(F=z(F,2),P=z(P,2);!v(F);){var j=B.add(F);j.l(I)<=0&&(N=N.add(P),B=j),F=z(F,1),P=z(P,1)}return R=T(I,N.j(R)),new A(N,R)}for(N=g;I.l(R)>=0;){for(P=Math.max(1,Math.floor(I.m()/R.m())),F=Math.ceil(Math.log(P)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),B=c(P),j=B.j(R);x(j)||j.l(I)>0;)P-=F,B=c(P),j=B.j(R);v(B)&&(B=m),N=N.add(B),I=T(I,j)}return new A(N,I)}n.B=function(I){return M(this,I).h},n.and=function(I){const R=Math.max(this.g.length,I.g.length),P=[];for(let F=0;F<R;F++)P[F]=this.i(F)&I.i(F);return new a(P,this.h&I.h)},n.or=function(I){const R=Math.max(this.g.length,I.g.length),P=[];for(let F=0;F<R;F++)P[F]=this.i(F)|I.i(F);return new a(P,this.h|I.h)},n.xor=function(I){const R=Math.max(this.g.length,I.g.length),P=[];for(let F=0;F<R;F++)P[F]=this.i(F)^I.i(F);return new a(P,this.h^I.h)};function O(I){const R=I.g.length+1,P=[];for(let F=0;F<R;F++)P[F]=I.i(F)<<1|I.i(F-1)>>>31;return new a(P,I.h)}function z(I,R){const P=R>>5;R%=32;const F=I.g.length-P,N=[];for(let B=0;B<F;B++)N[B]=R>0?I.i(B+P)>>>R|I.i(B+P+1)<<32-R:I.i(B+P);return new a(N,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,aj=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,bu=a}).apply(typeof BN<"u"?BN:typeof self<"u"?self:typeof window<"u"?window:{});var Sx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var oj,Sm,lj,i_,Mb,cj,uj,hj;(function(){var n,e=Object.defineProperty;function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sx=="object"&&Sx];for(var k=0;k<_.length;++k){var D=_[k];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var r=t(this);function i(_,k){if(k)e:{var D=r;_=_.split(".");for(var H=0;H<_.length-1;H++){var me=_[H];if(!(me in D))break e;D=D[me]}_=_[_.length-1],H=D[_],k=k(H),k!=H&&k!=null&&e(D,_,{configurable:!0,writable:!0,value:k})}}i("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(_){return _||function(k){var D=[],H;for(H in k)Object.prototype.hasOwnProperty.call(k,H)&&D.push([H,k[H]]);return D}});var s=s||{},a=this||self;function o(_){var k=typeof _;return k=="object"&&_!=null||k=="function"}function l(_,k,D){return _.call.apply(_.bind,arguments)}function c(_,k,D){return c=l,c.apply(null,arguments)}function h(_,k){var D=Array.prototype.slice.call(arguments,1);return function(){var H=D.slice();return H.push.apply(H,arguments),_.apply(this,H)}}function g(_,k){function D(){}D.prototype=k.prototype,_.Z=k.prototype,_.prototype=new D,_.prototype.constructor=_,_.Ob=function(H,me,Ce){for(var at=Array(arguments.length-2),nn=2;nn<arguments.length;nn++)at[nn-2]=arguments[nn];return k.prototype[me].apply(H,at)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function y(_){const k=_.length;if(k>0){const D=Array(k);for(let H=0;H<k;H++)D[H]=_[H];return D}return[]}function v(_,k){for(let H=1;H<arguments.length;H++){const me=arguments[H];var D=typeof me;if(D=D!="object"?D:me?Array.isArray(me)?"array":D:"null",D=="array"||D=="object"&&typeof me.length=="number"){D=_.length||0;const Ce=me.length||0;_.length=D+Ce;for(let at=0;at<Ce;at++)_[D+at]=me[at]}else _.push(me)}}class x{constructor(k,D){this.i=k,this.j=D,this.h=0,this.g=null}get(){let k;return this.h>0?(this.h--,k=this.g,this.g=k.next,k.next=null):k=this.i(),k}}function w(_){a.setTimeout(()=>{throw _},0)}function T(){var _=I;let k=null;return _.g&&(k=_.g,_.g=_.g.next,_.g||(_.h=null),k.next=null),k}class b{constructor(){this.h=this.g=null}add(k,D){const H=A.get();H.set(k,D),this.h?this.h.next=H:this.g=H,this.h=H}}var A=new x(()=>new M,_=>_.reset());class M{constructor(){this.next=this.g=this.h=null}set(k,D){this.h=k,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let O,z=!1,I=new b,R=()=>{const _=Promise.resolve(void 0);O=()=>{_.then(P)}};function P(){for(var _;_=T();){try{_.h.call(_.g)}catch(D){w(D)}var k=A;k.j(_),k.h<100&&(k.h++,_.next=k.g,k.g=_)}z=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(_,k){this.type=_,this.g=this.target=k,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,k=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const D=()=>{};a.addEventListener("test",D,k),a.removeEventListener("test",D,k)}catch{}return _})();function j(_){return/^[\s\xa0]*$/.test(_)}function ve(_,k){N.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,k)}g(ve,N),ve.prototype.init=function(_,k){const D=this.type=_.type,H=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=k,k=_.relatedTarget,k||(D=="mouseover"?k=_.fromElement:D=="mouseout"&&(k=_.toElement)),this.relatedTarget=k,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var ke="closure_listenable_"+(Math.random()*1e6|0),Ve=0;function Me(_,k,D,H,me){this.listener=_,this.proxy=null,this.src=k,this.type=D,this.capture=!!H,this.ha=me,this.key=++Ve,this.da=this.fa=!1}function ue(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function Ae(_,k,D){for(const H in _)k.call(D,_[H],H,_)}function be(_,k){for(const D in _)k.call(void 0,_[D],D,_)}function re(_){const k={};for(const D in _)k[D]=_[D];return k}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function se(_,k){let D,H;for(let me=1;me<arguments.length;me++){H=arguments[me];for(D in H)_[D]=H[D];for(let Ce=0;Ce<V.length;Ce++)D=V[Ce],Object.prototype.hasOwnProperty.call(H,D)&&(_[D]=H[D])}}function ne(_){this.src=_,this.g={},this.h=0}ne.prototype.add=function(_,k,D,H,me){const Ce=_.toString();_=this.g[Ce],_||(_=this.g[Ce]=[],this.h++);const at=le(_,k,H,me);return at>-1?(k=_[at],D||(k.fa=!1)):(k=new Me(k,this.src,Ce,!!H,me),k.fa=D,_.push(k)),k};function q(_,k){const D=k.type;if(D in _.g){var H=_.g[D],me=Array.prototype.indexOf.call(H,k,void 0),Ce;(Ce=me>=0)&&Array.prototype.splice.call(H,me,1),Ce&&(ue(k),_.g[D].length==0&&(delete _.g[D],_.h--))}}function le(_,k,D,H){for(let me=0;me<_.length;++me){const Ce=_[me];if(!Ce.da&&Ce.listener==k&&Ce.capture==!!D&&Ce.ha==H)return me}return-1}var Ie="closure_lm_"+(Math.random()*1e6|0),Fe={};function he(_,k,D,H,me){if(Array.isArray(k)){for(let Ce=0;Ce<k.length;Ce++)he(_,k[Ce],D,H,me);return null}return D=tr(D),_&&_[ke]?_.J(k,D,o(H)?!!H.capture:!1,me):Pe(_,k,D,!1,H,me)}function Pe(_,k,D,H,me,Ce){if(!k)throw Error("Invalid event type");const at=o(me)?!!me.capture:!!me;let nn=rn(_);if(nn||(_[Ie]=nn=new ne(_)),D=nn.add(k,D,H,at,Ce),D.proxy)return D;if(H=Be(),D.proxy=H,H.src=_,H.listener=D,_.addEventListener)B||(me=at),me===void 0&&(me=!1),_.addEventListener(k.toString(),H,me);else if(_.attachEvent)_.attachEvent(Nt(k.toString()),H);else if(_.addListener&&_.removeListener)_.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return D}function Be(){function _(D){return k.call(_.src,_.listener,D)}const k=ln;return _}function Rt(_,k,D,H,me){if(Array.isArray(k))for(var Ce=0;Ce<k.length;Ce++)Rt(_,k[Ce],D,H,me);else H=o(H)?!!H.capture:!!H,D=tr(D),_&&_[ke]?(_=_.i,Ce=String(k).toString(),Ce in _.g&&(k=_.g[Ce],D=le(k,D,H,me),D>-1&&(ue(k[D]),Array.prototype.splice.call(k,D,1),k.length==0&&(delete _.g[Ce],_.h--)))):_&&(_=rn(_))&&(k=_.g[k.toString()],_=-1,k&&(_=le(k,D,H,me)),(D=_>-1?k[_]:null)&&Dt(D))}function Dt(_){if(typeof _!="number"&&_&&!_.da){var k=_.src;if(k&&k[ke])q(k.i,_);else{var D=_.type,H=_.proxy;k.removeEventListener?k.removeEventListener(D,H,_.capture):k.detachEvent?k.detachEvent(Nt(D),H):k.addListener&&k.removeListener&&k.removeListener(H),(D=rn(k))?(q(D,_),D.h==0&&(D.src=null,k[Ie]=null)):ue(_)}}}function Nt(_){return _ in Fe?Fe[_]:Fe[_]="on"+_}function ln(_,k){if(_.da)_=!0;else{k=new ve(k,this);const D=_.listener,H=_.ha||_.src;_.fa&&Dt(_),_=D.call(H,k)}return _}function rn(_){return _=_[Ie],_ instanceof ne?_:null}var ut="__closure_events_fn_"+(Math.random()*1e9>>>0);function tr(_){return typeof _=="function"?_:(_[ut]||(_[ut]=function(k){return _.handleEvent(k)}),_[ut])}function dn(){F.call(this),this.i=new ne(this),this.M=this,this.G=null}g(dn,F),dn.prototype[ke]=!0,dn.prototype.removeEventListener=function(_,k,D,H){Rt(this,_,k,D,H)};function cn(_,k){var D,H=_.G;if(H)for(D=[];H;H=H.G)D.push(H);if(_=_.M,H=k.type||k,typeof k=="string")k=new N(k,_);else if(k instanceof N)k.target=k.target||_;else{var me=k;k=new N(H,_),se(k,me)}me=!0;let Ce,at;if(D)for(at=D.length-1;at>=0;at--)Ce=k.g=D[at],me=nr(Ce,H,!0,k)&&me;if(Ce=k.g=_,me=nr(Ce,H,!0,k)&&me,me=nr(Ce,H,!1,k)&&me,D)for(at=0;at<D.length;at++)Ce=k.g=D[at],me=nr(Ce,H,!1,k)&&me}dn.prototype.N=function(){if(dn.Z.N.call(this),this.i){var _=this.i;for(const k in _.g){const D=_.g[k];for(let H=0;H<D.length;H++)ue(D[H]);delete _.g[k],_.h--}}this.G=null},dn.prototype.J=function(_,k,D,H){return this.i.add(String(_),k,!1,D,H)},dn.prototype.K=function(_,k,D,H){return this.i.add(String(_),k,!0,D,H)};function nr(_,k,D,H){if(k=_.i.g[String(k)],!k)return!0;k=k.concat();let me=!0;for(let Ce=0;Ce<k.length;++Ce){const at=k[Ce];if(at&&!at.da&&at.capture==D){const nn=at.listener,Gr=at.ha||at.src;at.fa&&q(_.i,at),me=nn.call(Gr,H)!==!1&&me}}return me&&!H.defaultPrevented}function li(_,k){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=c(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(k)>2147483647?-1:a.setTimeout(_,k||0)}function Fn(_){_.g=li(()=>{_.g=null,_.i&&(_.i=!1,Fn(_))},_.l);const k=_.h;_.h=null,_.m.apply(null,k)}class dt extends F{constructor(k,D){super(),this.m=k,this.l=D,this.h=null,this.i=!1,this.g=null}j(k){this.h=arguments,this.g?this.i=!0:Fn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fn(_){F.call(this),this.h=_,this.g={}}g(fn,F);var ur=[];function vt(_){Ae(_.g,function(k,D){this.g.hasOwnProperty(D)&&Dt(k)},_),_.g={}}fn.prototype.N=function(){fn.Z.N.call(this),vt(this)},fn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zt=a.JSON.stringify,Gt=a.JSON.parse,Xr=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function xr(){}function Ki(){}var Qt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function xi(){N.call(this,"d")}g(xi,N);function je(){N.call(this,"c")}g(je,N);var xe={},ye=null;function zt(){return ye=ye||new dn}xe.Ia="serverreachability";function L(_){N.call(this,xe.Ia,_)}g(L,N);function kt(_){const k=zt();cn(k,new L(k))}xe.STAT_EVENT="statevent";function W(_,k){N.call(this,xe.STAT_EVENT,_),this.stat=k}g(W,N);function Y(_){const k=zt();cn(k,new W(k,_))}xe.Ja="timingevent";function Q(_,k){N.call(this,xe.Ja,_),this.size=k}g(Q,N);function fe(_,k){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},k)}function ce(){this.g=!0}ce.prototype.ua=function(){this.g=!1};function $e(_,k,D,H,me,Ce){_.info(function(){if(_.g)if(Ce){var at="",nn=Ce.split("&");for(let $n=0;$n<nn.length;$n++){var Gr=nn[$n].split("=");if(Gr.length>1){const qr=Gr[0];Gr=Gr[1];const Js=qr.split("_");at=Js.length>=2&&Js[1]=="type"?at+(qr+"="+Gr+"&"):at+(qr+"=redacted&")}}}else at=null;else at=Ce;return"XMLHTTP REQ ("+H+") [attempt "+me+"]: "+k+`
`+D+`
`+at})}function De(_,k,D,H,me,Ce,at){_.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+me+"]: "+k+`
`+D+`
`+Ce+" "+at})}function ze(_,k,D,H){_.info(function(){return"XMLHTTP TEXT ("+k+"): "+xt(_,D)+(H?" "+H:"")})}function it(_,k){_.info(function(){return"TIMEOUT: "+k})}ce.prototype.info=function(){};function xt(_,k){if(!_.g)return k;if(!k)return null;try{const Ce=JSON.parse(k);if(Ce){for(_=0;_<Ce.length;_++)if(Array.isArray(Ce[_])){var D=Ce[_];if(!(D.length<2)){var H=D[1];if(Array.isArray(H)&&!(H.length<1)){var me=H[0];if(me!="noop"&&me!="stop"&&me!="close")for(let at=1;at<H.length;at++)H[at]=""}}}}return Zt(Ce)}catch{return k}}var At={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Lt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},or;function br(){}g(br,xr),br.prototype.g=function(){return new XMLHttpRequest},or=new br;function Xi(_){return encodeURIComponent(String(_))}function U(_){var k=1;_=_.split(":");const D=[];for(;k>0&&_.length;)D.push(_.shift()),k--;return _.length&&D.push(_.join(":")),D}function J(_,k,D,H){this.j=_,this.i=k,this.l=D,this.S=H||1,this.V=new fn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var Z={},ee={};function te(_,k,D){_.M=1,_.A=El(_a(k)),_.u=D,_.R=!0,we(_,null)}function we(_,k){_.F=Date.now(),Te(_),_.B=_a(_.A);var D=_.B,H=_.S;Array.isArray(H)||(H=[String(H)]),Rg(D.i,"t",H),_.C=0,D=_.j.L,_.h=new K,_.g=hy(_.j,D?k:null,!_.u),_.P>0&&(_.O=new dt(c(_.Y,_,_.g),_.P)),k=_.V,D=_.g,H=_.ba;var me="readystatechange";Array.isArray(me)||(me&&(ur[0]=me.toString()),me=ur);for(let Ce=0;Ce<me.length;Ce++){const at=he(D,me[Ce],H||k.handleEvent,!1,k.h||k);if(!at)break;k.g[at.key]=at}k=_.J?re(_.J):{},_.u?(_.v||(_.v="POST"),k["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,k)):(_.v="GET",_.g.ea(_.B,_.v,null,k)),kt(),$e(_.i,_.v,_.B,_.l,_.S,_.u)}J.prototype.ba=function(_){_=_.target;const k=this.O;k&&Lo(_)==3?k.j():this.Y(_)},J.prototype.Y=function(_){try{if(_==this.g)e:{const nn=Lo(this.g),Gr=this.g.ya(),$n=this.g.ca();if(!(nn<3)&&(nn!=3||this.g&&(this.h.h||this.g.la()||cy(this.g)))){this.K||nn!=4||Gr==7||(Gr==8||$n<=0?kt(3):kt(2)),nt(this);var k=this.g.ca();this.X=k;var D=Le(this);if(this.o=k==200,De(this.i,this.v,this.B,this.l,this.S,nn,k),this.o){if(this.U&&!this.L){t:{if(this.g){var H,me=this.g;if((H=me.g?me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var Ce=H;break t}}Ce=null}if(_=Ce)ze(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ye(this,_);else{this.o=!1,this.m=3,Y(12),qe(this),pt(this);break e}}if(this.R){_=!0;let qr;for(;!this.K&&this.C<D.length;)if(qr=Se(this,D),qr==ee){nn==4&&(this.m=4,Y(14),_=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==Z){this.m=4,Y(15),ze(this.i,this.l,D,"[Invalid Chunk]"),_=!1;break}else ze(this.i,this.l,qr,null),Ye(this,qr);if(_e(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),nn!=4||D.length!=0||this.h.h||(this.m=1,Y(16),_=!1),this.o=this.o&&_,!_)ze(this.i,this.l,D,"[Invalid Chunked Response]"),qe(this),pt(this);else if(D.length>0&&!this.W){this.W=!0;var at=this.j;at.g==this&&at.aa&&!at.P&&(at.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),rh(at),at.P=!0,Y(11))}}else ze(this.i,this.l,D,null),Ye(this,D);nn==4&&qe(this),this.o&&!this.K&&(nn==4?qd(this.j,this):(this.o=!1,Te(this)))}else Cg(this.g),k==400&&D.indexOf("Unknown SID")>0?(this.m=3,Y(12)):(this.m=0,Y(13)),qe(this),pt(this)}}}catch{}};function Le(_){if(!_e(_))return _.g.la();const k=cy(_.g);if(k==="")return"";let D="";const H=k.length,me=Lo(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return qe(_),pt(_),"";_.h.i=new a.TextDecoder}for(let Ce=0;Ce<H;Ce++)_.h.h=!0,D+=_.h.i.decode(k[Ce],{stream:!(me&&Ce==H-1)});return k.length=0,_.h.g+=D,_.C=0,_.h.g}function _e(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function Se(_,k){var D=_.C,H=k.indexOf(`
`,D);return H==-1?ee:(D=Number(k.substring(D,H)),isNaN(D)?Z:(H+=1,H+D>k.length?ee:(k=k.slice(H,H+D),_.C=H+D,k)))}J.prototype.cancel=function(){this.K=!0,qe(this)};function Te(_){_.T=Date.now()+_.H,Xe(_,_.H)}function Xe(_,k){if(_.D!=null)throw Error("WatchDog timer not null");_.D=fe(c(_.aa,_),k)}function nt(_){_.D&&(a.clearTimeout(_.D),_.D=null)}J.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(it(this.i,this.B),this.M!=2&&(kt(),Y(17)),qe(this),this.m=2,pt(this)):Xe(this,this.T-_)};function pt(_){_.j.I==0||_.K||qd(_.j,_)}function qe(_){nt(_);var k=_.O;k&&typeof k.dispose=="function"&&k.dispose(),_.O=null,vt(_.V),_.g&&(k=_.g,_.g=null,k.abort(),k.dispose())}function Ye(_,k){try{var D=_.j;if(D.I!=0&&(D.g==_||Xa(D.h,_))){if(!_.L&&Xa(D.h,_)&&D.I==3){try{var H=D.Ba.g.parse(k)}catch{H=null}if(Array.isArray(H)&&H.length==3){var me=H;if(me[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<_.F)Xd(D),Zs(D);else break e;Fo(D),Y(18)}}else D.xa=me[1],0<D.xa-D.K&&me[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=fe(c(D.Va,D),6e3));_r(D.h)<=1&&D.ta&&(D.ta=void 0)}else Qs(D,11)}else if((_.L||D.g==_)&&Xd(D),!j(k))for(me=D.Ba.g.parse(k),k=0;k<me.length;k++){let $n=me[k];const qr=$n[0];if(!(qr<=D.K))if(D.K=qr,$n=$n[1],D.I==2)if($n[0]=="c"){D.M=$n[1],D.ba=$n[2];const Js=$n[3];Js!=null&&(D.ka=Js,D.j.info("VER="+D.ka));const Rl=$n[4];Rl!=null&&(D.za=Rl,D.j.info("SVER="+D.za));const jo=$n[5];jo!=null&&typeof jo=="number"&&jo>0&&(H=1.5*jo,D.O=H,D.j.info("backChannelRequestTimeoutMs_="+H)),H=D;const Vo=_.g;if(Vo){const Qd=Vo.g?Vo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qd){var Ce=H.h;Ce.g||Qd.indexOf("spdy")==-1&&Qd.indexOf("quic")==-1&&Qd.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&(xa(Ce,Ce.h),Ce.h=null))}if(H.G){const Mg=Vo.g?Vo.g.getResponseHeader("X-HTTP-Session-Id"):null;Mg&&(H.wa=Mg,Pn(H.J,H.G,Mg))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-_.F,D.j.info("Handshake RTT: "+D.T+"ms")),H=D;var at=_;if(H.na=Pg(H,H.L?H.ba:null,H.W),at.L){qs(H.h,at);var nn=at,Gr=H.O;Gr&&(nn.H=Gr),nn.D&&(nt(nn),Te(nn)),H.g=at}else qi(H);D.i.length>0&&Al(D)}else $n[0]!="stop"&&$n[0]!="close"||Qs(D,7);else D.I==3&&($n[0]=="stop"||$n[0]=="close"?$n[0]=="stop"?Qs(D,7):Hd(D):$n[0]!="noop"&&D.l&&D.l.qa($n),D.A=0)}}kt(4)}catch{}}var Ht=class{constructor(_,k){this.g=_,this.map=k}};function jn(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Un(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function _r(_){return _.h?1:_.g?_.g.size:0}function Xa(_,k){return _.h?_.h==k:_.g?_.g.has(k):!1}function xa(_,k){_.g?_.g.add(k):_.h=k}function qs(_,k){_.h&&_.h==k?_.h=null:_.g&&_.g.has(k)&&_.g.delete(k)}jn.prototype.cancel=function(){if(this.i=Br(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Br(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let k=_.i;for(const D of _.g.values())k=k.concat(D.G);return k}return y(_.i)}var Ec=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ar(_,k){if(_){_=_.split("&");for(let D=0;D<_.length;D++){const H=_[D].indexOf("=");let me,Ce=null;H>=0?(me=_[D].substring(0,H),Ce=_[D].substring(H+1)):me=_[D],k(me,Ce?decodeURIComponent(Ce.replace(/\+/g," ")):"")}}}function Io(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let k;_ instanceof Io?(this.l=_.l,Zu(this,_.j),this.o=_.o,this.g=_.g,Co(this,_.u),this.h=_.h,Sc(this,Ig(_.i)),this.m=_.m):_&&(k=String(_).match(Ec))?(this.l=!1,Zu(this,k[1]||"",!0),this.o=Qu(k[2]||""),this.g=Qu(k[3]||"",!0),Co(this,k[4]),this.h=Qu(k[5]||"",!0),Sc(this,k[6]||"",!0),this.m=Qu(k[7]||"")):(this.l=!1,this.i=new vn(null,this.l))}Io.prototype.toString=function(){const _=[];var k=this.j;k&&_.push(Ju(k,Eg,!0),":");var D=this.g;return(D||k=="file")&&(_.push("//"),(k=this.o)&&_.push(Ju(k,Eg,!0),"@"),_.push(Xi(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&_.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&_.push("/"),_.push(Ju(D,D.charAt(0)=="/"?eh:Sg,!0))),(D=this.i.toString())&&_.push("?",D),(D=this.m)&&_.push("#",Ju(D,Tg)),_.join("")},Io.prototype.resolve=function(_){const k=_a(this);let D=!!_.j;D?Zu(k,_.j):D=!!_.o,D?k.o=_.o:D=!!_.g,D?k.g=_.g:D=_.u!=null;var H=_.h;if(D)Co(k,_.u);else if(D=!!_.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var me=k.h.lastIndexOf("/");me!=-1&&(H=k.h.slice(0,me+1)+H)}if(me=H,me==".."||me==".")H="";else if(me.indexOf("./")!=-1||me.indexOf("/.")!=-1){H=me.lastIndexOf("/",0)==0,me=me.split("/");const Ce=[];for(let at=0;at<me.length;){const nn=me[at++];nn=="."?H&&at==me.length&&Ce.push(""):nn==".."?((Ce.length>1||Ce.length==1&&Ce[0]!="")&&Ce.pop(),H&&at==me.length&&Ce.push("")):(Ce.push(nn),H=!0)}H=Ce.join("/")}else H=me}return D?k.h=H:D=_.i.toString()!=="",D?Sc(k,Ig(_.i)):D=!!_.m,D&&(k.m=_.m),k};function _a(_){return new Io(_)}function Zu(_,k,D){_.j=D?Qu(k,!0):k,_.j&&(_.j=_.j.replace(/:$/,""))}function Co(_,k){if(k){if(k=Number(k),isNaN(k)||k<0)throw Error("Bad port number "+k);_.u=k}else _.u=null}function Sc(_,k,D){k instanceof vn?(_.i=k,Ud(_.i,_.l)):(D||(k=Ju(k,DE)),_.i=new vn(k,_.l))}function Pn(_,k,D){_.i.set(k,D)}function El(_){return Pn(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function Qu(_,k){return _?k?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Ju(_,k,D){return typeof _=="string"?(_=encodeURI(_).replace(k,wg),D&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function wg(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var Eg=/[#\/\?@]/g,Sg=/[#\?:]/g,eh=/[#\?]/g,DE=/[#\?@]/g,Tg=/#/g;function vn(_,k){this.h=this.g=null,this.i=_||null,this.j=!!k}function ko(_){_.g||(_.g=new Map,_.h=0,_.i&&Ar(_.i,function(k,D){_.add(decodeURIComponent(k.replace(/\+/g," ")),D)}))}n=vn.prototype,n.add=function(_,k){ko(this),this.i=null,_=Po(this,_);let D=this.g.get(_);return D||this.g.set(_,D=[]),D.push(k),this.h+=1,this};function bg(_,k){ko(_),k=Po(_,k),_.g.has(k)&&(_.i=null,_.h-=_.g.get(k).length,_.g.delete(k))}function zd(_,k){return ko(_),k=Po(_,k),_.g.has(k)}n.forEach=function(_,k){ko(this),this.g.forEach(function(D,H){D.forEach(function(me){_.call(k,me,H,this)},this)},this)};function Ag(_,k){ko(_);let D=[];if(typeof k=="string")zd(_,k)&&(D=D.concat(_.g.get(Po(_,k))));else for(_=Array.from(_.g.values()),k=0;k<_.length;k++)D=D.concat(_[k]);return D}n.set=function(_,k){return ko(this),this.i=null,_=Po(this,_),zd(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[k]),this.h+=1,this},n.get=function(_,k){return _?(_=Ag(this,_),_.length>0?String(_[0]):k):k};function Rg(_,k,D){bg(_,k),D.length>0&&(_.i=null,_.g.set(Po(_,k),y(D)),_.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],k=Array.from(this.g.keys());for(let H=0;H<k.length;H++){var D=k[H];const me=Xi(D);D=Ag(this,D);for(let Ce=0;Ce<D.length;Ce++){let at=me;D[Ce]!==""&&(at+="="+Xi(D[Ce])),_.push(at)}}return this.i=_.join("&")};function Ig(_){const k=new vn;return k.i=_.i,_.g&&(k.g=new Map(_.g),k.h=_.h),k}function Po(_,k){return k=String(k),_.j&&(k=k.toLowerCase()),k}function Ud(_,k){k&&!_.j&&(ko(_),_.i=null,_.g.forEach(function(D,H){const me=H.toLowerCase();H!=me&&(bg(this,H),Rg(this,me,D))},_)),_.j=k}function Mo(_,k){const D=new ce;if(a.Image){const H=new Image;H.onload=h(Mi,D,"TestLoadImage: loaded",!0,k,H),H.onerror=h(Mi,D,"TestLoadImage: error",!1,k,H),H.onabort=h(Mi,D,"TestLoadImage: abort",!1,k,H),H.ontimeout=h(Mi,D,"TestLoadImage: timeout",!1,k,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=_}else k(!1)}function No(_,k){const D=new ce,H=new AbortController,me=setTimeout(()=>{H.abort(),Mi(D,"TestPingServer: timeout",!1,k)},1e4);fetch(_,{signal:H.signal}).then(Ce=>{clearTimeout(me),Ce.ok?Mi(D,"TestPingServer: ok",!0,k):Mi(D,"TestPingServer: server error",!1,k)}).catch(()=>{clearTimeout(me),Mi(D,"TestPingServer: error",!1,k)})}function Mi(_,k,D,H,me){try{me&&(me.onload=null,me.onerror=null,me.onabort=null,me.ontimeout=null),H(D)}catch{}}function th(){this.g=new Xr}function Sl(_){this.i=_.Sb||null,this.h=_.ab||!1}g(Sl,xr),Sl.prototype.g=function(){return new Ys(this.i,this.h)};function Ys(_,k){dn.call(this),this.H=_,this.o=k,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Ys,dn),n=Ys.prototype,n.open=function(_,k){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=k,this.readyState=1,qa(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const k={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(k.body=_),(this.H||a).fetch(new Request(this.D,k)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Tc(this)),this.readyState=0},n.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,qa(this)),this.g&&(this.readyState=3,qa(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ay(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function ay(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}n.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var k=_.value?_.value:new Uint8Array(0);(k=this.B.decode(k,{stream:!_.done}))&&(this.response=this.responseText+=k)}_.done?Tc(this):qa(this),this.readyState==3&&ay(this)}},n.Oa=function(_){this.g&&(this.response=this.responseText=_,Tc(this))},n.Na=function(_){this.g&&(this.response=_,Tc(this))},n.ga=function(){this.g&&Tc(this)};function Tc(_){_.readyState=4,_.l=null,_.j=null,_.B=null,qa(_)}n.setRequestHeader=function(_,k){this.A.append(_,k)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],k=this.h.entries();for(var D=k.next();!D.done;)D=D.value,_.push(D[0]+": "+D[1]),D=k.next();return _.join(`\r
`)};function qa(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(Ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function oy(_){let k="";return Ae(_,function(D,H){k+=H,k+=":",k+=D,k+=`\r
`}),k}function $d(_,k,D){e:{for(H in D){var H=!1;break e}H=!0}H||(D=oy(D),typeof _=="string"?D!=null&&Xi(D):Pn(_,k,D))}function rr(_){dn.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(rr,dn);var ly=/^https?$/i,FE=["POST","PUT"];n=rr.prototype,n.Fa=function(_){this.H=_},n.ea=function(_,k,D,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);k=k?k.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():or.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(k,String(_),!0),this.B=!1}catch(Ce){bc(this,Ce);return}if(_=D||"",D=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var me in H)D.set(me,H[me]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Ce of H.keys())D.set(Ce,H.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(D.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),me=a.FormData&&_ instanceof a.FormData,!(Array.prototype.indexOf.call(FE,k,void 0)>=0)||H||me||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,at]of D)this.g.setRequestHeader(Ce,at);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(Ce){bc(this,Ce)}};function bc(_,k){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=k,_.o=5,Ac(_),bl(_)}function Ac(_){_.A||(_.A=!0,cn(_,"complete"),cn(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,cn(this,"complete"),cn(this,"abort"),bl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bl(this,!0)),rr.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Tl(this):this.Xa())},n.Xa=function(){Tl(this)};function Tl(_){if(_.h&&typeof s<"u"){if(_.v&&Lo(_)==4)setTimeout(_.Ca.bind(_),0);else if(cn(_,"readystatechange"),Lo(_)==4){_.h=!1;try{const Ce=_.ca();e:switch(Ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var k=!0;break e;default:k=!1}var D;if(!(D=k)){var H;if(H=Ce===0){let at=String(_.D).match(Ec)[1]||null;!at&&a.self&&a.self.location&&(at=a.self.location.protocol.slice(0,-1)),H=!ly.test(at?at.toLowerCase():"")}D=H}if(D)cn(_,"complete"),cn(_,"success");else{_.o=6;try{var me=Lo(_)>2?_.g.statusText:""}catch{me=""}_.l=me+" ["+_.ca()+"]",Ac(_)}}finally{bl(_)}}}}function bl(_,k){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const D=_.g;_.g=null,k||cn(_,"ready");try{D.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Lo(_){return _.g?_.g.readyState:0}n.ca=function(){try{return Lo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(_){if(this.g){var k=this.g.responseText;return _&&k.indexOf(_)==0&&(k=k.substring(_.length)),Gt(k)}};function cy(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function Cg(_){const k={};_=(_.g&&Lo(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<_.length;H++){if(j(_[H]))continue;var D=U(_[H]);const me=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Ce=k[me]||[];k[me]=Ce,Ce.push(D)}be(k,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Oo(_,k,D){return D&&D.internalChannelParams&&D.internalChannelParams[_]||k}function Wd(_){this.za=0,this.i=[],this.j=new ce,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Oo("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Oo("baseRetryDelayMs",5e3,_),this.Za=Oo("retryDelaySeedMs",1e4,_),this.Ta=Oo("forwardChannelMaxRetries",2,_),this.va=Oo("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new jn(_&&_.concurrentRequestLimit),this.Ba=new th,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wd.prototype,n.ka=8,n.I=1,n.connect=function(_,k,D,H){Y(0),this.W=_,this.H=k||{},D&&H!==void 0&&(this.H.OSID=D,this.H.OAID=H),this.F=this.X,this.J=Pg(this,null,this.W),Al(this)};function Hd(_){if(Kd(_),_.I==3){var k=_.V++,D=_a(_.J);if(Pn(D,"SID",_.M),Pn(D,"RID",k),Pn(D,"TYPE","terminate"),Do(_,D),k=new J(_,_.j,k),k.M=2,k.A=El(_a(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(k.A.toString(),"")}catch{}!D&&a.Image&&(new Image().src=k.A,D=!0),D||(k.g=hy(k.j,null),k.g.ea(k.A)),k.F=Date.now(),Te(k)}ih(_)}function Zs(_){_.g&&(rh(_),_.g.cancel(),_.g=null)}function Kd(_){Zs(_),_.v&&(a.clearTimeout(_.v),_.v=null),Xd(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&a.clearTimeout(_.m),_.m=null)}function Al(_){if(!Un(_.h)&&!_.m){_.m=!0;var k=_.Ea;O||R(),z||(O(),z=!0),I.add(k,_),_.D=0}}function uy(_,k){return _r(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=k.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=fe(c(_.Ea,_,k),Yd(_,_.D)),_.D++,!0)}n.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const me=new J(this,this.j,_);let Ce=this.o;if(this.U&&(Ce?(Ce=re(Ce),se(Ce,this.U)):Ce=this.U),this.u!==null||this.R||(me.J=Ce,Ce=null),this.S)e:{for(var k=0,D=0;D<this.i.length;D++){t:{var H=this.i[D];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(k+=H,k>4096){k=D;break e}if(k===4096||D===this.i.length-1){k=D+1;break e}}k=1e3}else k=1e3;k=kg(this,me,k),D=_a(this.J),Pn(D,"RID",_),Pn(D,"CVER",22),this.G&&Pn(D,"X-HTTP-Session-Id",this.G),Do(this,D),Ce&&(this.R?k="headers="+Xi(oy(Ce))+"&"+k:this.u&&$d(D,this.u,Ce)),xa(this.h,me),this.Ra&&Pn(D,"TYPE","init"),this.S?(Pn(D,"$req",k),Pn(D,"SID","null"),me.U=!0,te(me,D,null)):te(me,D,k),this.I=2}}else this.I==3&&(_?nh(this,_):this.i.length==0||Un(this.h)||nh(this))};function nh(_,k){var D;k?D=k.l:D=_.V++;const H=_a(_.J);Pn(H,"SID",_.M),Pn(H,"RID",D),Pn(H,"AID",_.K),Do(_,H),_.u&&_.o&&$d(H,_.u,_.o),D=new J(_,_.j,D,_.D+1),_.u===null&&(D.J=_.o),k&&(_.i=k.G.concat(_.i)),k=kg(_,D,1e3),D.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),xa(_.h,D),te(D,H,k)}function Do(_,k){_.H&&Ae(_.H,function(D,H){Pn(k,H,D)}),_.l&&Ae({},function(D,H){Pn(k,H,D)})}function kg(_,k,D){D=Math.min(_.i.length,D);const H=_.l?c(_.l.Ka,_.l,_):null;e:{var me=_.i;let nn=-1;for(;;){const Gr=["count="+D];nn==-1?D>0?(nn=me[0].g,Gr.push("ofs="+nn)):nn=0:Gr.push("ofs="+nn);let $n=!0;for(let qr=0;qr<D;qr++){var Ce=me[qr].g;const Js=me[qr].map;if(Ce-=nn,Ce<0)nn=Math.max(0,me[qr].g-100),$n=!1;else try{Ce="req"+Ce+"_"||"";try{var at=Js instanceof Map?Js:Object.entries(Js);for(const[Rl,jo]of at){let Vo=jo;o(jo)&&(Vo=Zt(jo)),Gr.push(Ce+Rl+"="+encodeURIComponent(Vo))}}catch(Rl){throw Gr.push(Ce+"type="+encodeURIComponent("_badmap")),Rl}}catch{H&&H(Js)}}if($n){at=Gr.join("&");break e}}at=void 0}return _=_.i.splice(0,D),k.G=_,at}function qi(_){if(!_.g&&!_.v){_.Y=1;var k=_.Da;O||R(),z||(O(),z=!0),I.add(k,_),_.A=0}}function Fo(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=fe(c(_.Da,_),Yd(_,_.A)),_.A++,!0)}n.Da=function(){if(this.v=null,Rc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=fe(c(this.Wa,this),_)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Y(10),Zs(this),Rc(this))};function rh(_){_.B!=null&&(a.clearTimeout(_.B),_.B=null)}function Rc(_){_.g=new J(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var k=_a(_.na);Pn(k,"RID","rpc"),Pn(k,"SID",_.M),Pn(k,"AID",_.K),Pn(k,"CI",_.F?"0":"1"),!_.F&&_.ia&&Pn(k,"TO",_.ia),Pn(k,"TYPE","xmlhttp"),Do(_,k),_.u&&_.o&&$d(k,_.u,_.o),_.O&&(_.g.H=_.O);var D=_.g;_=_.ba,D.M=1,D.A=El(_a(k)),D.u=null,D.R=!0,we(D,_)}n.Va=function(){this.C!=null&&(this.C=null,Zs(this),Fo(this),Y(19))};function Xd(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function qd(_,k){var D=null;if(_.g==k){Xd(_),rh(_),_.g=null;var H=2}else if(Xa(_.h,k))D=k.G,qs(_.h,k),H=1;else return;if(_.I!=0){if(k.o)if(H==1){D=k.u?k.u.length:0,k=Date.now()-k.F;var me=_.D;H=zt(),cn(H,new Q(H,D)),Al(_)}else qi(_);else if(me=k.m,me==3||me==0&&k.X>0||!(H==1&&uy(_,k)||H==2&&Fo(_)))switch(D&&D.length>0&&(k=_.h,k.i=k.i.concat(D)),me){case 1:Qs(_,5);break;case 4:Qs(_,10);break;case 3:Qs(_,6);break;default:Qs(_,2)}}}function Yd(_,k){let D=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(D*=2),D*k}function Qs(_,k){if(_.j.info("Error code "+k),k==2){var D=c(_.bb,_),H=_.Ua;const me=!H;H=new Io(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Zu(H,"https"),El(H),me?Mo(H.toString(),D):No(H.toString(),D)}else Y(2);_.I=0,_.l&&_.l.pa(k),ih(_),Kd(_)}n.bb=function(_){_?(this.j.info("Successfully pinged google.com"),Y(2)):(this.j.info("Failed to ping google.com"),Y(1))};function ih(_){if(_.I=0,_.ja=[],_.l){const k=Br(_.h);(k.length!=0||_.i.length!=0)&&(v(_.ja,k),v(_.ja,_.i),_.h.i.length=0,y(_.i),_.i.length=0),_.l.oa()}}function Pg(_,k,D){var H=D instanceof Io?_a(D):new Io(D);if(H.g!="")k&&(H.g=k+"."+H.g),Co(H,H.u);else{var me=a.location;H=me.protocol,k=k?k+"."+me.hostname:me.hostname,me=+me.port;const Ce=new Io(null);H&&Zu(Ce,H),k&&(Ce.g=k),me&&Co(Ce,me),D&&(Ce.h=D),H=Ce}return D=_.G,k=_.wa,D&&k&&Pn(H,D,k),Pn(H,"VER",_.ka),Do(_,H),H}function hy(_,k,D){if(k&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return k=_.Aa&&!_.ma?new rr(new Sl({ab:D})):new rr(_.ma),k.Fa(_.L),k}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function dy(){}n=dy.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zd(){}Zd.prototype.g=function(_,k){return new Ni(_,k)};function Ni(_,k){dn.call(this),this.g=new Wd(k),this.l=_,this.h=k&&k.messageUrlParams||null,_=k&&k.messageHeaders||null,k&&k.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=k&&k.initMessageHeaders||null,k&&k.messageContentType&&(_?_["X-WebChannel-Content-Type"]=k.messageContentType:_={"X-WebChannel-Content-Type":k.messageContentType}),k&&k.sa&&(_?_["X-WebChannel-Client-Profile"]=k.sa:_={"X-WebChannel-Client-Profile":k.sa}),this.g.U=_,(_=k&&k.Qb)&&!j(_)&&(this.g.u=_),this.A=k&&k.supportsCrossDomainXhr||!1,this.v=k&&k.sendRawJson||!1,(k=k&&k.httpSessionIdParam)&&!j(k)&&(this.g.G=k,_=this.h,_!==null&&k in _&&(_=this.h,k in _&&delete _[k])),this.j=new Ic(this)}g(Ni,dn),Ni.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ni.prototype.close=function(){Hd(this.g)},Ni.prototype.o=function(_){var k=this.g;if(typeof _=="string"){var D={};D.__data__=_,_=D}else this.v&&(D={},D.__data__=Zt(_),_=D);k.i.push(new Ht(k.Ya++,_)),k.I==3&&Al(k)},Ni.prototype.N=function(){this.g.l=null,delete this.j,Hd(this.g),delete this.g,Ni.Z.N.call(this)};function fy(_){xi.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var k=_.__sm__;if(k){e:{for(const D in k){_=D;break e}_=void 0}(this.i=_)&&(_=this.i,k=k!==null&&_ in k?k[_]:void 0),this.data=k}else this.data=_}g(fy,xi);function gy(){je.call(this),this.status=1}g(gy,je);function Ic(_){this.g=_}g(Ic,dy),Ic.prototype.ra=function(){cn(this.g,"a")},Ic.prototype.qa=function(_){cn(this.g,new fy(_))},Ic.prototype.pa=function(_){cn(this.g,new gy)},Ic.prototype.oa=function(){cn(this.g,"b")},Zd.prototype.createWebChannel=Zd.prototype.g,Ni.prototype.send=Ni.prototype.o,Ni.prototype.open=Ni.prototype.m,Ni.prototype.close=Ni.prototype.close,hj=function(){return new Zd},uj=function(){return zt()},cj=xe,Mb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},At.NO_ERROR=0,At.TIMEOUT=8,At.HTTP_ERROR=6,i_=At,Lt.COMPLETE="complete",lj=Lt,Ki.EventType=Qt,Qt.OPEN="a",Qt.CLOSE="b",Qt.ERROR="c",Qt.MESSAGE="d",dn.prototype.listen=dn.prototype.J,Sm=Ki,rr.prototype.listenOnce=rr.prototype.K,rr.prototype.getLastError=rr.prototype.Ha,rr.prototype.getLastErrorCode=rr.prototype.ya,rr.prototype.getStatus=rr.prototype.ca,rr.prototype.getResponseJson=rr.prototype.La,rr.prototype.getResponseText=rr.prototype.la,rr.prototype.send=rr.prototype.ea,rr.prototype.setWithCredentials=rr.prototype.Fa,oj=rr}).apply(typeof Sx<"u"?Sx:typeof self<"u"?self:typeof window<"u"?window:{});const GN="@firebase/firestore",zN="4.9.3";let Gi=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Gi.UNAUTHENTICATED=new Gi(null),Gi.GOOGLE_CREDENTIALS=new Gi("google-credentials-uid"),Gi.FIRST_PARTY=new Gi("first-party-uid"),Gi.MOCK_USER=new Gi("mock-user");let cg="12.7.0";const dd=new HR("@firebase/firestore");function $f(){return dd.logLevel}function Qe(n,...e){if(dd.logLevel<=yn.DEBUG){const t=e.map(iI);dd.debug(`Firestore (${cg}): ${n}`,...t)}}function vs(n,...e){if(dd.logLevel<=yn.ERROR){const t=e.map(iI);dd.error(`Firestore (${cg}): ${n}`,...t)}}function fd(n,...e){if(dd.logLevel<=yn.WARN){const t=e.map(iI);dd.warn(`Firestore (${cg}): ${n}`,...t)}}function iI(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function bt(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,dj(n,r,t)}function dj(n,e,t){let r=`FIRESTORE (${cg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw vs(r),new Error(r)}function Mt(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||dj(e,i,r)}function tn(n,e){return n}const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ct extends _l{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class il{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class fj{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Gi.UNAUTHENTICATED)))}shutdown(){}}class _J{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class vJ{constructor(e){this.t=e,this.currentUser=Gi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Mt(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new il;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new il,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{Qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new il)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Mt(typeof r.accessToken=="string",31837,{l:r}),new fj(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Mt(e===null||typeof e=="string",2055,{h:e}),new Gi(e)}}class wJ{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Gi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class EJ{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new wJ(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Gi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class UN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SJ{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ua(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Mt(this.o===void 0,3512);const r=s=>{s.error!=null&&Qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Qe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new UN(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Mt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new UN(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function TJ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class sI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=TJ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function en(n,e){return n<e?-1:n>e?1:0}function Nb(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return tT(i)===tT(s)?en(i,s):tT(i)?1:-1}return en(n.length,e.length)}const bJ=55296,AJ=57343;function tT(n){const e=n.charCodeAt(0);return e>=bJ&&e<=AJ}function O0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function gj(n){return n+"\0"}const $N="__name__";class Xo{constructor(e,t,r){t===void 0?t=0:t>e.length&&bt(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&bt(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Xo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Xo?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Xo.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return en(e.length,t.length)}static compareSegments(e,t){const r=Xo.isNumericId(e),i=Xo.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Xo.extractNumericId(e).compare(Xo.extractNumericId(t)):Nb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bu.fromString(e.substring(4,e.length-2))}}class Dn extends Xo{construct(e,t,r){return new Dn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ct(Oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Dn(t)}static emptyPath(){return new Dn([])}}const RJ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kr extends Xo{construct(e,t,r){return new kr(e,t,r)}static isValidIdentifier(e){return RJ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$N}static keyField(){return new kr([$N])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ct(Oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ct(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ct(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new ct(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kr(t)}static emptyPath(){return new kr([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Dn.fromString(e))}static fromName(e){return new ft(Dn.fromString(e).popFirst(5))}static empty(){return new ft(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Dn(e.slice()))}}function mj(n,e,t){if(!t)throw new ct(Oe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function IJ(n,e,t,r){if(e===!0&&r===!0)throw new ct(Oe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function WN(n){if(!ft.isDocumentKey(n))throw new ct(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function HN(n){if(ft.isDocumentKey(n))throw new ct(Oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function pj(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Bw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":bt(12329,{type:typeof n})}function $a(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ct(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bw(n);throw new ct(Oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ni(n,e){const t={typeString:n};return e&&(t.value=e),t}function P1(n,e){if(!pj(n))throw new ct(Oe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ct(Oe.INVALID_ARGUMENT,t);return!0}const KN=-62135596800,XN=1e6;class Kn{static now(){return Kn.fromMillis(Date.now())}static fromDate(e){return Kn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*XN);return new Kn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ct(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ct(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<KN)throw new ct(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ct(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/XN}_compareTo(e){return this.seconds===e.seconds?en(this.nanoseconds,e.nanoseconds):en(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Kn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(P1(e,Kn._jsonSchema))return new Kn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-KN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Kn._jsonSchemaVersion="firestore/timestamp/1.0",Kn._jsonSchema={type:ni("string",Kn._jsonSchemaVersion),seconds:ni("number"),nanoseconds:ni("number")};class Ot{static fromTimestamp(e){return new Ot(e)}static min(){return new Ot(new Kn(0,0))}static max(){return new Ot(new Kn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Mp=-1;class sv{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Lb(n){return n.fields.find((e=>e.kind===2))}function bh(n){return n.fields.filter((e=>e.kind!==2))}sv.UNKNOWN_ID=-1;class s_{constructor(e,t){this.fieldPath=e,this.kind=t}}class Np{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Np(0,ma.min())}}function CJ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ot.fromTimestamp(r===1e9?new Kn(t+1,0):new Kn(t,r));return new ma(i,ft.empty(),e)}function yj(n){return new ma(n.readTime,n.key,Mp)}class ma{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ma(Ot.min(),ft.empty(),Mp)}static max(){return new ma(Ot.max(),ft.empty(),Mp)}}function aI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(n.documentKey,e.documentKey),t!==0?t:en(n.largestBatchId,e.largestBatchId))}const xj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _j{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Nd(n){if(n.code!==Oe.FAILED_PRECONDITION||n.message!==xj)throw n;Qe("LocalStore","Unexpectedly lost primary lease")}class de{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&bt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new de(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof de?t:de.resolve(t)}catch(t){return de.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):de.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):de.reject(t)}static resolve(e){return new de(((t,r)=>{t(e)}))}static reject(e){return new de(((t,r)=>{r(e)}))}static waitFor(e){return new de(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=de.resolve(!1);for(const r of e)t=t.next((i=>i?de.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new de(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next((h=>{a[c]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new de(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const sa="SimpleDb";class Gw{static open(e,t,r,i){try{return new Gw(t,e.transaction(i,r))}catch(s){throw new Bm(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new il,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Bm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=oI(r.target.error);this.S.reject(new Bm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Qe(sa,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new PJ(t)}}class Au{static delete(e){return Qe(sa,"Removing database:",e),Ph(d6().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!w6())return!1;if(Au.F())return!0;const e=pi(),t=Au.M(e),r=0<t&&t<10,i=vj(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Au.M(pi())===12.2&&vs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Qe(sa,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new Bm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new ct(Oe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ct(Oe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Bm(e,a))},i.onupgradeneeded=s=>{Qe(sa,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{Qe(sa,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=Gw.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((c=>(o.C(),c))).catch((c=>(o.abort(c),de.reject(c)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,c=l.name!=="FirebaseError"&&a<3;if(Qe(sa,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function vj(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class kJ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ph(this.U.delete())}}class Bm extends ct{constructor(e,t){super(Oe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function $u(n){return n.name==="IndexedDbTransactionError"}class PJ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Qe(sa,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Qe(sa,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ph(r)}add(e){return Qe(sa,"ADD",this.store.name,e,e),Ph(this.store.add(e))}get(e){return Ph(this.store.get(e)).next((t=>(t===void 0&&(t=null),Qe(sa,"GET",this.store.name,e,t),t)))}delete(e){return Qe(sa,"DELETE",this.store.name,e),Ph(this.store.delete(e))}count(){return Qe(sa,"COUNT",this.store.name),Ph(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new de(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new de(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){Qe(sa,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new de(((r,i)=>{t.onerror=s=>{const a=oI(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new de(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new kJ(o),c=t(o.primaryKey,o.value,l);if(c instanceof de){const h=c.catch((g=>(l.done(),de.reject(g))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>de.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ph(n){return new de(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=oI(r.target.error);t(i)}}))}let qN=!1;function oI(n){const e=Au.M(pi());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ct("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return qN||(qN=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Gm="IndexBackfiller";class MJ{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Qe(Gm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Qe(Gm,`Documents written: ${t}`)}catch(t){$u(t)?Qe(Gm,"Ignoring IndexedDB error during index backfill: ",t):await Nd(t)}await this.re(6e4)}))}}class NJ{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return de.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return Qe(Gm,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(Qe(Gm,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=yj(s);aI(a,r)>0&&(r=a)})),new ma(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Da{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Da.ce=-1;const Xh=-1;function zw(n){return n==null}function Lp(n){return n===0&&1/n==-1/0}function LJ(n){return typeof n=="number"&&Number.isInteger(n)&&!Lp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const av="";function us(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=YN(e)),e=OJ(n.get(t),e);return YN(e)}function OJ(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case av:t+="";break;default:t+=s}}return t}function YN(n){return n+av+""}function Jo(n){const e=n.length;if(Mt(e>=2,64408,{path:n}),e===2)return Mt(n.charAt(0)===av&&n.charAt(1)==="",56145,{path:n}),Dn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(av,s);switch((a<0||a>t)&&bt(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:bt(61167,{path:n})}s=a+2}return new Dn(r)}const Ah="remoteDocuments",M1="owner",kf="owner",Op="mutationQueues",DJ="userId",lo="mutations",ZN="batchId",Gh="userMutationsIndex",QN=["userId","batchId"];function a_(n,e){return[n,us(e)]}function wj(n,e,t){return[n,us(e),t]}const FJ={},D0="documentMutations",ov="remoteDocumentsV14",jJ=["prefixPath","collectionGroup","readTime","documentId"],o_="documentKeyIndex",VJ=["prefixPath","collectionGroup","documentId"],Ej="collectionGroupIndex",BJ=["collectionGroup","readTime","prefixPath","documentId"],Dp="remoteDocumentGlobal",Ob="remoteDocumentGlobalKey",F0="targets",Sj="queryTargetsIndex",GJ=["canonicalId","targetId"],j0="targetDocuments",zJ=["targetId","path"],lI="documentTargetsIndex",UJ=["path","targetId"],lv="targetGlobalKey",qh="targetGlobal",Fp="collectionParents",$J=["collectionId","parent"],V0="clientMetadata",WJ="clientId",Uw="bundles",HJ="bundleId",$w="namedQueries",KJ="name",cI="indexConfiguration",XJ="indexId",Db="collectionGroupIndex",qJ="collectionGroup",zm="indexState",YJ=["indexId","uid"],Tj="sequenceNumberIndex",ZJ=["uid","sequenceNumber"],Um="indexEntries",QJ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],bj="documentKeyIndex",JJ=["indexId","uid","orderedDocumentKey"],Ww="documentOverlays",eee=["userId","collectionPath","documentId"],Fb="collectionPathOverlayIndex",tee=["userId","collectionPath","largestBatchId"],Aj="collectionGroupOverlayIndex",nee=["userId","collectionGroup","largestBatchId"],uI="globals",ree="name",Rj=[Op,lo,D0,Ah,F0,M1,qh,j0,V0,Dp,Fp,Uw,$w],iee=[...Rj,Ww],Ij=[Op,lo,D0,ov,F0,M1,qh,j0,V0,Dp,Fp,Uw,$w,Ww],Cj=Ij,hI=[...Cj,cI,zm,Um],see=hI,kj=[...hI,uI],aee=kj;class jb extends _j{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yi(n,e){const t=tn(n);return Au.O(t.le,e)}function JN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Wu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Pj(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Tr{constructor(e,t){this.comparator=e,this.root=t||zi.EMPTY}insert(e,t){return new Tr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zi.BLACK,null,null))}remove(e){return new Tr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tx(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tx(this.root,e,this.comparator,!0)}}class Tx{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zi{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??zi.RED,this.left=i??zi.EMPTY,this.right=s??zi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new zi(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return zi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return zi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw bt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw bt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw bt(27949);return e+(this.isRed()?0:1)}}zi.EMPTY=null,zi.RED=!0,zi.BLACK=!1;zi.EMPTY=new class{constructor(){this.size=0}get key(){throw bt(57766)}get value(){throw bt(16141)}get color(){throw bt(16727)}get left(){throw bt(29726)}get right(){throw bt(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new zi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zn{constructor(e){this.comparator=e,this.data=new Tr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new eL(this.data.getIterator())}getIteratorFrom(e){return new eL(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Zn(this.comparator);return t.data=e,t}}class eL{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Pf(n){return n.hasNext()?n.getNext():void 0}class Vs{constructor(e){this.fields=e,e.sort(kr.comparator)}static empty(){return new Vs([])}unionWith(e){let t=new Zn(kr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return O0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class Mj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ai{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Mj("Invalid base64 string: "+s):s}})(e);return new ai(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new ai(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return en(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ai.EMPTY_BYTE_STRING=new ai("");const oee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oc(n){if(Mt(!!n,39018),typeof n=="string"){let e=0;const t=oee.exec(n);if(Mt(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:wr(n.seconds),nanos:wr(n.nanos)}}function wr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function lc(n){return typeof n=="string"?ai.fromBase64String(n):ai.fromUint8Array(n)}const Nj="server_timestamp",Lj="__type__",Oj="__previous_value__",Dj="__local_write_time__";function dI(n){return(n?.mapValue?.fields||{})[Lj]?.stringValue===Nj}function Hw(n){const e=n.mapValue.fields[Oj];return dI(e)?Hw(e):e}function jp(n){const e=oc(n.mapValue.fields[Dj].timestampValue);return new Kn(e.seconds,e.nanos)}class lee{constructor(e,t,r,i,s,a,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const cv="(default)";class gd{constructor(e,t){this.projectId=e,this.database=t||cv}static empty(){return new gd("","")}get isDefaultDatabase(){return this.database===cv}isEqual(e){return e instanceof gd&&e.projectId===this.projectId&&e.database===this.database}}const fI="__type__",Fj="__max__",gu={mapValue:{fields:{__type__:{stringValue:Fj}}}},gI="__vector__",B0="value",l_={nullValue:"NULL_VALUE"};function Mu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dI(n)?4:jj(n)?9007199254740991:Kw(n)?10:11:bt(28295,{value:n})}function dl(n,e){if(n===e)return!0;const t=Mu(n);if(t!==Mu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return jp(n).isEqual(jp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=oc(i.timestampValue),o=oc(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return lc(i.bytesValue).isEqual(lc(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return wr(i.geoPointValue.latitude)===wr(s.geoPointValue.latitude)&&wr(i.geoPointValue.longitude)===wr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return wr(i.integerValue)===wr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=wr(i.doubleValue),o=wr(s.doubleValue);return a===o?Lp(a)===Lp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return O0(n.arrayValue.values||[],e.arrayValue.values||[],dl);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(JN(a)!==JN(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!dl(a[l],o[l])))return!1;return!0})(n,e);default:return bt(52216,{left:n})}}function Vp(n,e){return(n.values||[]).find((t=>dl(t,e)))!==void 0}function Nu(n,e){if(n===e)return 0;const t=Mu(n),r=Mu(e);if(t!==r)return en(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return en(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=wr(s.integerValue||s.doubleValue),l=wr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return tL(n.timestampValue,e.timestampValue);case 4:return tL(jp(n),jp(e));case 5:return Nb(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=lc(s),l=lc(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const h=en(o[c],l[c]);if(h!==0)return h}return en(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=en(wr(s.latitude),wr(a.latitude));return o!==0?o:en(wr(s.longitude),wr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return nL(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},c=o[B0]?.arrayValue,h=l[B0]?.arrayValue,g=en(c?.values?.length||0,h?.values?.length||0);return g!==0?g:nL(c,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===gu.mapValue&&a===gu.mapValue)return 0;if(s===gu.mapValue)return 1;if(a===gu.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let g=0;g<l.length&&g<h.length;++g){const m=Nb(l[g],h[g]);if(m!==0)return m;const y=Nu(o[l[g]],c[h[g]]);if(y!==0)return y}return en(l.length,h.length)})(n.mapValue,e.mapValue);default:throw bt(23264,{he:t})}}function tL(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return en(n,e);const t=oc(n),r=oc(e),i=en(t.seconds,r.seconds);return i!==0?i:en(t.nanos,r.nanos)}function nL(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Nu(t[i],r[i]);if(s)return s}return en(t.length,r.length)}function G0(n){return Vb(n)}function Vb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=oc(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return lc(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ft.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Vb(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Vb(t.fields[a])}`;return i+"}"})(n.mapValue):bt(61005,{value:n})}function c_(n){switch(Mu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hw(n);return e?16+c_(e):16;case 5:return 2*n.stringValue.length;case 6:return lc(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+c_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Wu(r.fields,((s,a)=>{i+=s.length+c_(a)})),i})(n.mapValue);default:throw bt(13486,{value:n})}}function Bp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Bb(n){return!!n&&"integerValue"in n}function Gp(n){return!!n&&"arrayValue"in n}function rL(n){return!!n&&"nullValue"in n}function iL(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function u_(n){return!!n&&"mapValue"in n}function Kw(n){return(n?.mapValue?.fields||{})[fI]?.stringValue===gI}function $m(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Wu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=$m(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$m(n.arrayValue.values[t]);return e}return{...n}}function jj(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Fj}const Vj={mapValue:{fields:{[fI]:{stringValue:gI},[B0]:{arrayValue:{}}}}};function cee(n){return"nullValue"in n?l_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Bp(gd.empty(),ft.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Kw(n)?Vj:{mapValue:{}}:bt(35942,{value:n})}function uee(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Bp(gd.empty(),ft.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Vj:"mapValue"in n?Kw(n)?{mapValue:{}}:gu:bt(61959,{value:n})}function sL(n,e){const t=Nu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function aL(n,e){const t=Nu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class os{constructor(e){this.value=e}static empty(){return new os({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!u_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$m(t)}setAll(e){let t=kr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=$m(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());u_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];u_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Wu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new os($m(this.value))}}function Bj(n){const e=[];return Wu(n.fields,((t,r)=>{const i=new kr([t]);if(u_(r)){const s=Bj(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Vs(e)}class jr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new jr(e,0,Ot.min(),Ot.min(),Ot.min(),os.empty(),0)}static newFoundDocument(e,t,r,i){return new jr(e,1,t,Ot.min(),r,i,0)}static newNoDocument(e,t){return new jr(e,2,t,Ot.min(),Ot.min(),os.empty(),0)}static newUnknownDocument(e,t){return new jr(e,3,t,Ot.min(),Ot.min(),os.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=os.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=os.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ot.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class z0{constructor(e,t){this.position=e,this.inclusive=t}}function oL(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ft.comparator(ft.fromName(a.referenceValue),t.key):r=Nu(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function lL(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!dl(n.position[t],e.position[t]))return!1;return!0}class uv{constructor(e,t="asc"){this.field=e,this.dir=t}}function hee(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Gj{}class xn extends Gj{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new dee(e,t,r):t==="array-contains"?new mee(e,r):t==="in"?new Kj(e,r):t==="not-in"?new pee(e,r):t==="array-contains-any"?new yee(e,r):new xn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new fee(e,r):new gee(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Nu(t,this.value)):t!==null&&Mu(this.value)===Mu(t)&&this.matchesComparison(Nu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return bt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qn extends Gj{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new qn(e,t)}matches(e){return U0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function U0(n){return n.op==="and"}function Gb(n){return n.op==="or"}function mI(n){return zj(n)&&U0(n)}function zj(n){for(const e of n.filters)if(e instanceof qn)return!1;return!0}function zb(n){if(n instanceof xn)return n.field.canonicalString()+n.op.toString()+G0(n.value);if(mI(n))return n.filters.map((e=>zb(e))).join(",");{const e=n.filters.map((t=>zb(t))).join(",");return`${n.op}(${e})`}}function Uj(n,e){return n instanceof xn?(function(r,i){return i instanceof xn&&r.op===i.op&&r.field.isEqual(i.field)&&dl(r.value,i.value)})(n,e):n instanceof qn?(function(r,i){return i instanceof qn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&Uj(a,i.filters[o])),!0):!1})(n,e):void bt(19439)}function $j(n,e){const t=n.filters.concat(e);return qn.create(t,n.op)}function Wj(n){return n instanceof xn?(function(t){return`${t.field.canonicalString()} ${t.op} ${G0(t.value)}`})(n):n instanceof qn?(function(t){return t.op.toString()+" {"+t.getFilters().map(Wj).join(" ,")+"}"})(n):"Filter"}class dee extends xn{constructor(e,t,r){super(e,t,r),this.key=ft.fromName(r.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class fee extends xn{constructor(e,t){super(e,"in",t),this.keys=Hj("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class gee extends xn{constructor(e,t){super(e,"not-in",t),this.keys=Hj("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Hj(n,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class mee extends xn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Gp(t)&&Vp(t.arrayValue,this.value)}}class Kj extends xn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Vp(this.value.arrayValue,t)}}class pee extends xn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Vp(this.value.arrayValue,t)}}class yee extends xn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Gp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Vp(this.value.arrayValue,r)))}}class xee{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function Ub(n,e=null,t=[],r=[],i=null,s=null,a=null){return new xee(n,e,t,r,i,s,a)}function md(n){const e=tn(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>zb(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),zw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>G0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>G0(r))).join(",")),e.Te=t}return e.Te}function N1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!hee(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Uj(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!lL(n.startAt,e.startAt)&&lL(n.endAt,e.endAt)}function hv(n){return ft.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function dv(n,e){return n.filters.filter((t=>t instanceof xn&&t.field.isEqual(e)))}function cL(n,e,t){let r=l_,i=!0;for(const s of dv(n,e)){let a=l_,o=!0;switch(s.op){case"<":case"<=":a=cee(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=l_}sL({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];sL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function uL(n,e,t){let r=gu,i=!0;for(const s of dv(n,e)){let a=gu,o=!0;switch(s.op){case">=":case">":a=uee(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=gu}aL({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];aL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class L1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function _ee(n,e,t,r,i,s,a,o){return new L1(n,e,t,r,i,s,a,o)}function Xw(n){return new L1(n)}function hL(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Xj(n){return n.collectionGroup!==null}function Wm(n){const e=tn(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Zn(kr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new uv(s,r))})),t.has(kr.keyField().canonicalString())||e.Ie.push(new uv(kr.keyField(),r))}return e.Ie}function Va(n){const e=tn(n);return e.Ee||(e.Ee=vee(e,Wm(n))),e.Ee}function vee(n,e){if(n.limitType==="F")return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new uv(i.field,s)}));const t=n.endAt?new z0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new z0(n.startAt.position,n.startAt.inclusive):null;return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function $b(n,e){const t=n.filters.concat([e]);return new L1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Wb(n,e,t){return new L1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function qw(n,e){return N1(Va(n),Va(e))&&n.limitType===e.limitType}function qj(n){return`${md(Va(n))}|lt:${n.limitType}`}function Wf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>Wj(i))).join(", ")}]`),zw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>G0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>G0(i))).join(",")),`Target(${r})`})(Va(n))}; limitType=${n.limitType})`}function O1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ft.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Wm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const c=oL(a,o,l);return a.inclusive?c<=0:c<0})(r.startAt,Wm(r),i)||r.endAt&&!(function(a,o,l){const c=oL(a,o,l);return a.inclusive?c>=0:c>0})(r.endAt,Wm(r),i))})(n,e)}function wee(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Yj(n){return(e,t)=>{let r=!1;for(const i of Wm(n)){const s=Eee(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Eee(n,e,t){const r=n.field.isKeyField()?ft.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Nu(l,c):bt(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return bt(19790,{direction:n.dir})}}class pc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Wu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return Pj(this.inner)}size(){return this.innerSize}}const See=new Tr(ft.comparator);function da(){return See}const Zj=new Tr(ft.comparator);function Tm(...n){let e=Zj;for(const t of n)e=e.insert(t.key,t);return e}function Qj(n){let e=Zj;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function el(){return Hm()}function Jj(){return Hm()}function Hm(){return new pc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Tee=new Tr(ft.comparator),bee=new Zn(ft.comparator);function un(...n){let e=bee;for(const t of n)e=e.add(t);return e}const Aee=new Zn(en);function Ree(){return Aee}function pI(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lp(e)?"-0":e}}function e8(n){return{integerValue:""+n}}function Iee(n,e){return LJ(e)?e8(e):pI(n,e)}class Yw{constructor(){this._=void 0}}function Cee(n,e,t){return n instanceof $0?(function(i,s){const a={fields:{[Lj]:{stringValue:Nj},[Dj]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&dI(s)&&(s=Hw(s)),s&&(a.fields[Oj]=s),{mapValue:a}})(t,e):n instanceof W0?n8(n,e):n instanceof H0?r8(n,e):(function(i,s){const a=t8(i,s),o=dL(a)+dL(i.Ae);return Bb(a)&&Bb(i.Ae)?e8(o):pI(i.serializer,o)})(n,e)}function kee(n,e,t){return n instanceof W0?n8(n,e):n instanceof H0?r8(n,e):t}function t8(n,e){return n instanceof zp?(function(r){return Bb(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class $0 extends Yw{}class W0 extends Yw{constructor(e){super(),this.elements=e}}function n8(n,e){const t=i8(e);for(const r of n.elements)t.some((i=>dl(i,r)))||t.push(r);return{arrayValue:{values:t}}}class H0 extends Yw{constructor(e){super(),this.elements=e}}function r8(n,e){let t=i8(e);for(const r of n.elements)t=t.filter((i=>!dl(i,r)));return{arrayValue:{values:t}}}class zp extends Yw{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function dL(n){return wr(n.integerValue||n.doubleValue)}function i8(n){return Gp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class s8{constructor(e,t){this.field=e,this.transform=t}}function Pee(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof W0&&i instanceof W0||r instanceof H0&&i instanceof H0?O0(r.elements,i.elements,dl):r instanceof zp&&i instanceof zp?dl(r.Ae,i.Ae):r instanceof $0&&i instanceof $0})(n.transform,e.transform)}class Mee{constructor(e,t){this.version=e,this.transformResults=t}}class ls{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ls}static exists(e){return new ls(void 0,e)}static updateTime(e){return new ls(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function h_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Zw{}function a8(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qw(n.key,ls.none()):new ug(n.key,n.data,ls.none());{const t=n.data,r=os.empty();let i=new Zn(kr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new yc(n.key,r,new Vs(i.toArray()),ls.none())}}function Nee(n,e,t){n instanceof ug?(function(i,s,a){const o=i.value.clone(),l=gL(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof yc?(function(i,s,a){if(!h_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=gL(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(o8(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Km(n,e,t,r){return n instanceof ug?(function(s,a,o,l){if(!h_(s.precondition,a))return o;const c=s.value.clone(),h=mL(s.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof yc?(function(s,a,o,l){if(!h_(s.precondition,a))return o;const c=mL(s.fieldTransforms,l,a),h=a.data;return h.setAll(o8(s)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(s,a,o){return h_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function Lee(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=t8(r.transform,i||null);s!=null&&(t===null&&(t=os.empty()),t.set(r.field,s))}return t||null}function fL(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&O0(r,i,((s,a)=>Pee(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ug extends Zw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class yc extends Zw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function o8(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function gL(n,e,t){const r=new Map;Mt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,kee(a,o,t[i]))}return r}function mL(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,Cee(s,a,e))}return r}class Qw extends Zw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class l8 extends Zw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yI{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Nee(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Km(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Km(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Jj();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=a8(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ot.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),un())}isEqual(e){return this.batchId===e.batchId&&O0(this.mutations,e.mutations,((t,r)=>fL(t,r)))&&O0(this.baseMutations,e.baseMutations,((t,r)=>fL(t,r)))}}class xI{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Mt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Tee})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new xI(e,t,r,i)}}class _I{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Oee{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qr,wn;function Dee(n){switch(n){case Oe.OK:return bt(64938);case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0;default:return bt(15467,{code:n})}}function c8(n){if(n===void 0)return vs("GRPC error has no .code"),Oe.UNKNOWN;switch(n){case Qr.OK:return Oe.OK;case Qr.CANCELLED:return Oe.CANCELLED;case Qr.UNKNOWN:return Oe.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return Oe.INTERNAL;case Qr.UNAVAILABLE:return Oe.UNAVAILABLE;case Qr.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case Qr.NOT_FOUND:return Oe.NOT_FOUND;case Qr.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case Qr.ABORTED:return Oe.ABORTED;case Qr.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case Qr.DATA_LOSS:return Oe.DATA_LOSS;default:return bt(39323,{code:n})}}(wn=Qr||(Qr={}))[wn.OK=0]="OK",wn[wn.CANCELLED=1]="CANCELLED",wn[wn.UNKNOWN=2]="UNKNOWN",wn[wn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wn[wn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wn[wn.NOT_FOUND=5]="NOT_FOUND",wn[wn.ALREADY_EXISTS=6]="ALREADY_EXISTS",wn[wn.PERMISSION_DENIED=7]="PERMISSION_DENIED",wn[wn.UNAUTHENTICATED=16]="UNAUTHENTICATED",wn[wn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wn[wn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wn[wn.ABORTED=10]="ABORTED",wn[wn.OUT_OF_RANGE=11]="OUT_OF_RANGE",wn[wn.UNIMPLEMENTED=12]="UNIMPLEMENTED",wn[wn.INTERNAL=13]="INTERNAL",wn[wn.UNAVAILABLE=14]="UNAVAILABLE",wn[wn.DATA_LOSS=15]="DATA_LOSS";function Fee(){return new TextEncoder}const jee=new bu([4294967295,4294967295],0);function pL(n){const e=Fee().encode(n),t=new aj;return t.update(e),new Uint8Array(t.digest())}function yL(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new bu([t,r],0),new bu([i,s],0)]}class vI{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new bm(`Invalid padding: ${t}`);if(r<0)throw new bm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bm(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new bm(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=bu.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(bu.fromNumber(r)));return i.compare(jee)===1&&(i=new bu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=pL(e),[r,i]=yL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new vI(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=pL(e),[r,i]=yL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class bm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Jw{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,D1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Jw(Ot.min(),i,new Tr(en),da(),un())}}class D1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new D1(r,t,un(),un(),un())}}class d_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class u8{constructor(e,t){this.targetId=e,this.Ce=t}}class h8{constructor(e,t,r=ai.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class xL{constructor(){this.ve=0,this.Fe=_L(),this.Me=ai.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=un(),t=un(),r=un();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:bt(38017,{changeType:s})}})),new D1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=_L()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Mt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Vee{constructor(e){this.Ge=e,this.ze=new Map,this.je=da(),this.Je=bx(),this.He=bx(),this.Ye=new Tr(en)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:bt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(hv(s))if(r===0){const a=new ft(s.path);this.et(t,a,jr.newNoDocument(a,Ot.min()))}else Mt(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=lc(r).toUint8Array()}catch(l){if(l instanceof Mj)return fd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new vI(a,i,s)}catch(l){return fd(l instanceof bm?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&hv(o.target)){const l=new ft(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,jr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=un();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new Jw(e,t,this.Ye,this.je,r);return this.je=da(),this.Je=bx(),this.He=bx(),this.Ye=new Tr(en),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new xL,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Zn(en),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Zn(en),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Qe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new xL),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function bx(){return new Tr(ft.comparator)}function _L(){return new Tr(ft.comparator)}const Bee={asc:"ASCENDING",desc:"DESCENDING"},Gee={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zee={and:"AND",or:"OR"};class Uee{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Hb(n,e){return n.useProto3Json||zw(e)?e:{value:e}}function K0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function d8(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function $ee(n,e){return K0(n,e.toTimestamp())}function Ss(n){return Mt(!!n,49232),Ot.fromTimestamp((function(t){const r=oc(t);return new Kn(r.seconds,r.nanos)})(n))}function wI(n,e){return Kb(n,e).canonicalString()}function Kb(n,e){const t=(function(i){return new Dn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function f8(n){const e=Dn.fromString(n);return Mt(E8(e),10190,{key:e.toString()}),e}function fv(n,e){return wI(n.databaseId,e.path)}function Yh(n,e){const t=f8(e);if(t.get(1)!==n.databaseId.projectId)throw new ct(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ct(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ft(p8(t))}function g8(n,e){return wI(n.databaseId,e)}function m8(n){const e=f8(n);return e.length===4?Dn.emptyPath():p8(e)}function Xb(n){return new Dn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function p8(n){return Mt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function vL(n,e,t){return{name:fv(n,e),fields:t.value.mapValue.fields}}function Wee(n,e,t){const r=Yh(n,e.name),i=Ss(e.updateTime),s=e.createTime?Ss(e.createTime):Ot.min(),a=new os({mapValue:{fields:e.fields}}),o=jr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function Hee(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:bt(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,h){return c.useProto3Json?(Mt(h===void 0||typeof h=="string",58123),ai.fromBase64String(h||"")):(Mt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ai.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const h=c.code===void 0?Oe.UNKNOWN:c8(c.code);return new ct(h,c.message||"")})(a);t=new h8(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Yh(n,r.document.name),s=Ss(r.document.updateTime),a=r.document.createTime?Ss(r.document.createTime):Ot.min(),o=new os({mapValue:{fields:r.document.fields}}),l=jr.newFoundDocument(i,s,a,o),c=r.targetIds||[],h=r.removedTargetIds||[];t=new d_(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Yh(n,r.document),s=r.readTime?Ss(r.readTime):Ot.min(),a=jr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new d_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Yh(n,r.document),s=r.removedTargetIds||[];t=new d_([],s,i,null)}else{if(!("filter"in e))return bt(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Oee(i,s),o=r.targetId;t=new u8(o,a)}}return t}function gv(n,e){let t;if(e instanceof ug)t={update:vL(n,e.key,e.value)};else if(e instanceof Qw)t={delete:fv(n,e.key)};else if(e instanceof yc)t={update:vL(n,e.key,e.data),updateMask:Qee(e.fieldMask)};else{if(!(e instanceof l8))return bt(16599,{Vt:e.type});t={verify:fv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof $0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof W0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof H0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof zp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw bt(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:$ee(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:bt(27497)})(n,e.precondition)),t}function qb(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?ls.updateTime(Ss(s.updateTime)):s.exists!==void 0?ls.exists(s.exists):ls.none()})(e.currentDocument):ls.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)Mt(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new $0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new W0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new H0(h)}else"increment"in o?l=new zp(a,o.increment):bt(16584,{proto:o});const c=kr.fromServerFormat(o.fieldPath);return new s8(c,l)})(n,i))):[];if(e.update){e.update.name;const i=Yh(n,e.update.name),s=new os({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const c=l.fieldPaths||[];return new Vs(c.map((h=>kr.fromServerFormat(h))))})(e.updateMask);return new yc(i,s,a,t,r)}return new ug(i,s,t,r)}if(e.delete){const i=Yh(n,e.delete);return new Qw(i,t)}if(e.verify){const i=Yh(n,e.verify);return new l8(i,t)}return bt(1463,{proto:e})}function Kee(n,e){return n&&n.length>0?(Mt(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?Ss(i.updateTime):Ss(s);return a.isEqual(Ot.min())&&(a=Ss(s)),new Mee(a,i.transformResults||[])})(t,e)))):[]}function y8(n,e){return{documents:[g8(n,e.path)]}}function x8(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=g8(n,i);const s=(function(c){if(c.length!==0)return w8(qn.create(c,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(c){if(c.length!==0)return c.map((h=>(function(m){return{field:Hf(m.field),direction:qee(m.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=Hb(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:i}}function _8(n){let e=m8(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Mt(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(g){const m=v8(g);return m instanceof qn&&mI(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map((m=>(function(v){return new uv(Kf(v.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(m)))})(t.orderBy));let o=null;t.limit&&(o=(function(g){let m;return m=typeof g=="object"?g.value:g,zw(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(g){const m=!!g.before,y=g.values||[];return new z0(y,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(g){const m=!g.before,y=g.values||[];return new z0(y,m)})(t.endAt)),_ee(e,i,a,s,o,"F",l,c)}function Xee(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return bt(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function v8(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Kf(t.unaryFilter.field);return xn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Kf(t.unaryFilter.field);return xn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Kf(t.unaryFilter.field);return xn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Kf(t.unaryFilter.field);return xn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return bt(61313);default:return bt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return xn.create(Kf(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return bt(58110);default:return bt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return qn.create(t.compositeFilter.filters.map((r=>v8(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return bt(1026)}})(t.compositeFilter.op))})(n):bt(30097,{filter:n})}function qee(n){return Bee[n]}function Yee(n){return Gee[n]}function Zee(n){return zee[n]}function Hf(n){return{fieldPath:n.canonicalString()}}function Kf(n){return kr.fromServerFormat(n.fieldPath)}function w8(n){return n instanceof xn?(function(t){if(t.op==="=="){if(iL(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NAN"}};if(rL(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(iL(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NOT_NAN"}};if(rL(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hf(t.field),op:Yee(t.op),value:t.value}}})(n):n instanceof qn?(function(t){const r=t.getFilters().map((i=>w8(i)));return r.length===1?r[0]:{compositeFilter:{op:Zee(t.op),filters:r}}})(n):bt(54877,{filter:n})}function Qee(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function E8(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Wl{constructor(e,t,r,i,s=Ot.min(),a=Ot.min(),o=ai.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Wl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class S8{constructor(e){this.yt=e}}function Jee(n,e){let t;if(e.document)t=Wee(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ft.fromSegments(e.noDocument.path),i=yd(e.noDocument.readTime);t=jr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return bt(56709);{const r=ft.fromSegments(e.unknownDocument.path),i=yd(e.unknownDocument.version);t=jr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new Kn(i[0],i[1]);return Ot.fromTimestamp(s)})(e.readTime)),t}function wL(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:mv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:fv(s,a.key),fields:a.data.value.mapValue.fields,updateTime:K0(s,a.version.toTimestamp()),createTime:K0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:pd(e.version)};else{if(!e.isUnknownDocument())return bt(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:pd(e.version)}}return r}function mv(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function pd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function yd(n){const e=new Kn(n.seconds,n.nanoseconds);return Ot.fromTimestamp(e)}function Mh(n,e){const t=(e.baseMutations||[]).map((s=>qb(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>qb(n.yt,s))),i=Kn.fromMillis(e.localWriteTimeMs);return new yI(e.batchId,i,t,r)}function Am(n){const e=yd(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?yd(n.lastLimboFreeSnapshotVersion):Ot.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return Mt(a===1,1966,{count:a}),Va(Xw(m8(s.documents[0])))})(n.query):(function(s){return Va(_8(s))})(n.query),new Wl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ai.fromBase64String(n.resumeToken))}function T8(n,e){const t=pd(e.snapshotVersion),r=pd(e.lastLimboFreeSnapshotVersion);let i;i=hv(e.target)?y8(n.yt,e.target):x8(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:md(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function b8(n){const e=_8({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wb(e,e.limit,"L"):e}function nT(n,e){return new _I(e.largestBatchId,qb(n.yt,e.overlayMutation))}function EL(n,e){const t=e.path.lastSegment();return[n,us(e.path.popLast()),t]}function SL(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:pd(r.readTime),documentKey:us(r.documentKey.path),largestBatchId:r.largestBatchId}}class ete{getBundleMetadata(e,t){return TL(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:yd(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return TL(e).put((function(i){return{bundleId:i.id,createTime:pd(Ss(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return bL(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:b8(s.bundledQuery),readTime:yd(s.readTime)}})(r)}))}saveNamedQuery(e,t){return bL(e).put((function(i){return{name:i.name,readTime:pd(Ss(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function TL(n){return yi(n,Uw)}function bL(n){return yi(n,$w)}class eE{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new eE(e,r)}getOverlay(e,t){return hm(e).get(EL(this.userId,t)).next((r=>r?nT(this.serializer,r):null))}getOverlays(e,t){const r=el();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new _I(t,a);i.push(this.St(e,o))})),de.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(us(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(hm(e).Z(Fb,o))})),de.waitFor(s)}getOverlaysForCollection(e,t,r){const i=el(),s=us(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return hm(e).J(Fb,a).next((o=>{for(const l of o){const c=nT(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=el();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return hm(e).ee({index:Aj,range:o},((l,c,h)=>{const g=nT(this.serializer,c);s.size()<i||g.largestBatchId===a?(s.set(g.getKey(),g),a=g.largestBatchId):h.done()})).next((()=>s))}St(e,t){return hm(e).put((function(i,s,a){const[o,l,c]=EL(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:gv(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function hm(n){return yi(n,Ww)}class tte{bt(e){return yi(e,uI)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?ai.fromUint8Array(r):ai.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Nh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(wr(e.integerValue));else if("doubleValue"in e){const r=wr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Lp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=oc(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(lc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?jj(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Kw(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):bt(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=B0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(wr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ft.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Nh.Kt=new Nh;const Mf=255;function nte(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function AL(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=nte(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class rte{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=AL(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=AL(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Mf),this.sn(255)}_n(){this.an(Mf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Mf?(this.sn(Mf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Mf?(this.an(Mf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class ite{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class ste{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class dm{constructor(){this.cn=new rte,this.ln=new ite(this.cn),this.hn=new ste(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Lh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Lh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:f_(this.En),directionalValue:f_(this.dn),orderedDocumentKey:f_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function qc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=RL(n.En,e.En),t!==0?t:(t=RL(n.dn,e.dn),t!==0?t:ft.comparator(n.In,e.In)))}function RL(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function f_(n){return v6()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function IL(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class CL{constructor(e){this.mn=new Zn(((t,r)=>kr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Mt(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Lb(e);if(t!==void 0&&!this.wn(t))return!1;const r=bh(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Zn(kr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new s_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new s_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new s_(r.field,r.dir==="asc"?0:1)));return new sv(sv.UNKNOWN_ID,this.collectionId,t,Np.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function A8(n){if(Mt(n instanceof xn||n instanceof qn,20012),n instanceof xn){if(n instanceof Kj){const t=n.value.arrayValue?.values?.map((r=>xn.create(n.field,"==",r)))||[];return qn.create(t,"or")}return n}const e=n.filters.map((t=>A8(t)));return qn.create(e,n.op)}function ate(n){if(n.getFilters().length===0)return[];const e=Qb(A8(n));return Mt(R8(e),7391),Yb(e)||Zb(e)?[e]:e.getFilters()}function Yb(n){return n instanceof xn}function Zb(n){return n instanceof qn&&mI(n)}function R8(n){return Yb(n)||Zb(n)||(function(t){if(t instanceof qn&&Gb(t)){for(const r of t.getFilters())if(!Yb(r)&&!Zb(r))return!1;return!0}return!1})(n)}function Qb(n){if(Mt(n instanceof xn||n instanceof qn,34018),n instanceof xn)return n;if(n.filters.length===1)return Qb(n.filters[0]);const e=n.filters.map((r=>Qb(r)));let t=qn.create(e,n.op);return t=pv(t),R8(t)?t:(Mt(t instanceof qn,64498),Mt(U0(t),40251),Mt(t.filters.length>1,57927),t.filters.reduce(((r,i)=>EI(r,i))))}function EI(n,e){let t;return Mt(n instanceof xn||n instanceof qn,38388),Mt(e instanceof xn||e instanceof qn,25473),t=n instanceof xn?e instanceof xn?(function(i,s){return qn.create([i,s],"and")})(n,e):kL(n,e):e instanceof xn?kL(e,n):(function(i,s){if(Mt(i.filters.length>0&&s.filters.length>0,48005),U0(i)&&U0(s))return $j(i,s.getFilters());const a=Gb(i)?i:s,o=Gb(i)?s:i,l=a.filters.map((c=>EI(c,o)));return qn.create(l,"or")})(n,e),pv(t)}function kL(n,e){if(U0(e))return $j(e,n.getFilters());{const t=e.filters.map((r=>EI(n,r)));return qn.create(t,"or")}}function pv(n){if(Mt(n instanceof xn||n instanceof qn,11850),n instanceof xn)return n;const e=n.getFilters();if(e.length===1)return pv(e[0]);if(zj(n))return n;const t=e.map((i=>pv(i))),r=[];return t.forEach((i=>{i instanceof xn?r.push(i):i instanceof qn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:qn.create(r,n.op)}class ote{constructor(){this.Cn=new SI}addToCollectionParentIndex(e,t){return this.Cn.add(t),de.resolve()}getCollectionParents(e,t){return de.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return de.resolve()}deleteFieldIndex(e,t){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,t){return de.resolve()}getDocumentsMatchingTarget(e,t){return de.resolve(null)}getIndexType(e,t){return de.resolve(0)}getFieldIndexes(e,t){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,t){return de.resolve(ma.min())}getMinOffsetFromCollectionGroup(e,t){return de.resolve(ma.min())}updateCollectionGroup(e,t,r){return de.resolve()}updateIndexEntries(e,t){return de.resolve()}}class SI{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Zn(Dn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Zn(Dn.comparator)).toArray()}}const PL="IndexedDbIndexManager",Ax=new Uint8Array(0);class lte{constructor(e,t){this.databaseId=t,this.vn=new SI,this.Fn=new pc((r=>md(r)),((r,i)=>N1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:us(i)};return ML(e).put(s)}return de.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[gj(t),""],!1,!0);return ML(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Jo(a.parent))}return r}))}addFieldIndex(e,t){const r=fm(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=Lf(e);return s.next((o=>{a.put(SL(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=fm(e),i=Lf(e),s=Nf(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=fm(e),r=Nf(e),i=Lf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return de.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new CL(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=Nf(e);let i=!0;const s=new Map;return de.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=un();const o=[];return de.forEach(s,((l,c)=>{Qe(PL,`Using index ${(function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(l)} to execute ${md(t)}`);const h=(function(A,M){const O=Lb(M);if(O===void 0)return null;for(const z of dv(A,O.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(c,l),g=(function(A,M){const O=new Map;for(const z of bh(M))for(const I of dv(A,z.fieldPath))switch(I.op){case"==":case"in":O.set(z.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return O.set(z.fieldPath.canonicalString(),I.value),Array.from(O.values())}return null})(c,l),m=(function(A,M){const O=[];let z=!0;for(const I of bh(M)){const R=I.kind===0?cL(A,I.fieldPath,A.startAt):uL(A,I.fieldPath,A.startAt);O.push(R.value),z&&(z=R.inclusive)}return new z0(O,z)})(c,l),y=(function(A,M){const O=[];let z=!0;for(const I of bh(M)){const R=I.kind===0?uL(A,I.fieldPath,A.endAt):cL(A,I.fieldPath,A.endAt);O.push(R.value),z&&(z=R.inclusive)}return new z0(O,z)})(c,l),v=this.On(l,c,m),x=this.On(l,c,y),w=this.Nn(l,c,g),T=this.Bn(l.indexId,h,v,m.inclusive,x,y.inclusive,w);return de.forEach(T,(b=>r.Y(b,t.limit).next((A=>{A.forEach((M=>{const O=ft.fromSegments(M.documentKey);a.has(O)||(a=a.add(O),o.push(O))}))}))))})).next((()=>o))}return de.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=ate(qn.create(e.filters,"and")).map((r=>Ub(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),c=l/(t!=null?t.length:1),h=[];for(let g=0;g<l;++g){const m=t?this.Ln(t[g/c]):Ax,y=this.kn(e,m,r[g%c],i),v=this.qn(e,m,s[g%c],a),x=o.map((w=>this.kn(e,m,w,!0)));h.push(...this.createRange(y,v,x))}return h}kn(e,t,r,i){const s=new Lh(e,ft.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new Lh(e,ft.empty(),t,r);return i?s.An():s}xn(e,t){const r=new CL(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return de.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let c=new Zn(kr.comparator),h=!1;for(const g of l.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:c=c.add(m.field));for(const g of l.orderBy)g.field.isKeyField()||(c=c.add(g.field));return c.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new dm;for(const i of bh(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);Nh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new dm;return Nh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new dm;return Nh.Kt.Dt(Bp(this.databaseId,t),r.Pn((function(s){const a=bh(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new dm);let s=0;for(const a of bh(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&Gp(o))i=this.Kn(i,a,o);else{const c=l.Pn(a.kind);Nh.Kt.Dt(o,c)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new dm;l.seed(o.un()),Nh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof xn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=fm(e),i=Lf(e);return(t?r.J(Db,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return de.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,g){const m=g?new Np(g.sequenceNumber,new ma(yd(g.readTime),new ft(Jo(g.documentKey)),g.largestBatchId)):Np.empty(),y=h.fields.map((([v,x])=>new s_(kr.fromServerFormat(v),x)));return new sv(h.indexId,h.collectionGroup,y,m)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:en(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=fm(e),s=Lf(e);return this.Gn(e).next((a=>i.J(Db,IDBKeyRange.bound(t,t)).next((o=>de.forEach(o,(l=>s.put(SL(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return de.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?de.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),de.forEach(o,(l=>this.zn(e,i,l).next((c=>{const h=this.jn(s,l);return c.isEqual(h)?de.resolve():this.Jn(e,s,l,c,h)})))))))}))}Hn(e,t,r,i){return Nf(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Nf(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Nf(e);let s=new Zn(qc);return i.ee({index:bj,range:IDBKeyRange.only([r.indexId,this.uid,f_(this.$n(r,t))])},((a,o)=>{s=s.add(new Lh(r.indexId,t,IL(o.arrayValue),IL(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Zn(qc);const i=this.Qn(t,e);if(i==null)return r;const s=Lb(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Gp(a))for(const o of a.arrayValue.values||[])r=r.add(new Lh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new Lh(t.indexId,e.key,Ax,i));return r}Jn(e,t,r,i,s){Qe(PL,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,c,h,g,m){const y=l.getIterator(),v=c.getIterator();let x=Pf(y),w=Pf(v);for(;x||w;){let T=!1,b=!1;if(x&&w){const A=h(x,w);A<0?b=!0:A>0&&(T=!0)}else x!=null?b=!0:T=!0;T?(g(w),w=Pf(v)):b?(m(x),x=Pf(y)):(x=Pf(y),w=Pf(v))}})(i,s,qc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),de.waitFor(a)}Gn(e){let t=1;return Lf(e).ee({index:Tj,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>qc(a,o))).filter(((a,o,l)=>!o||qc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=qc(a,e),l=qc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,Ax,ft.empty()),l=i[a+1].Vn(this.uid,Ax,ft.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return qc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(NL)}getMinOffset(e,t){return de.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||bt(44426))))).next(NL)}}function ML(n){return yi(n,Fp)}function Nf(n){return yi(n,Um)}function fm(n){return yi(n,cI)}function Lf(n){return yi(n,zm)}function NL(n){Mt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;aI(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ma(e.readTime,e.documentKey,t)}const LL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},I8=41943040;class is{static withCacheSize(e){return new is(e,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function C8(n,e,t){const r=n.store(lo),i=n.store(D0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,g,m)=>(o++,m.delete())));s.push(l.next((()=>{Mt(o===1,47070,{batchId:t.batchId})})));const c=[];for(const h of t.mutations){const g=wj(e,h.key.path,t.batchId);s.push(i.delete(g)),c.push(h.key)}return de.waitFor(s).next((()=>c))}function yv(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw bt(14731);e=n.noDocument}return JSON.stringify(e).length}is.DEFAULT_COLLECTION_PERCENTILE=10,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,is.DEFAULT=new is(I8,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),is.DISABLED=new is(-1,0,0);class tE{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Mt(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new tE(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Yc(e).ee({index:Gh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Xf(e),a=Yc(e);return a.add({}).next((o=>{Mt(typeof o=="number",49019);const l=new yI(o,t,r,i),c=(function(y,v,x){const w=x.baseMutations.map((b=>gv(y.yt,b))),T=x.mutations.map((b=>gv(y.yt,b)));return{userId:v,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:w,mutations:T}})(this.serializer,this.userId,l),h=[];let g=new Zn(((m,y)=>en(m.canonicalString(),y.canonicalString())));for(const m of i){const y=wj(this.userId,m.key.path,o);g=g.add(m.key.path.popLast()),h.push(a.put(c)),h.push(s.put(y,FJ))}return g.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),de.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Yc(e).get(t).next((r=>r?(Mt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Mh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?de.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Yc(e).ee({index:Gh,range:i},((a,o,l)=>{o.userId===this.userId&&(Mt(o.batchId>=r,47524,{tr:r}),s=Mh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Xh;return Yc(e).ee({index:Gh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Xh],[this.userId,Number.POSITIVE_INFINITY]);return Yc(e).J(Gh,t).next((r=>r.map((i=>Mh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=a_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Xf(e).ee({range:i},((a,o,l)=>{const[c,h,g]=a,m=Jo(h);if(c===this.userId&&t.path.isEqual(m))return Yc(e).get(g).next((y=>{if(!y)throw bt(61480,{nr:a,batchId:g});Mt(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:g}),s.push(Mh(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(en);const i=[];return t.forEach((s=>{const a=a_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Xf(e).ee({range:o},((c,h,g)=>{const[m,y,v]=c,x=Jo(y);m===this.userId&&s.path.isEqual(x)?r=r.add(v):g.done()}));i.push(l)})),de.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=a_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Zn(en);return Xf(e).ee({range:a},((l,c,h)=>{const[g,m,y]=l,v=Jo(m);g===this.userId&&r.isPrefixOf(v)?v.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Yc(e).get(s).next((a=>{if(a===null)throw bt(35274,{batchId:s});Mt(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(Mh(this.serializer,a))})))})),de.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return C8(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),de.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return de.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Xf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=Jo(s[1]);i.push(l)}else o.done()})).next((()=>{Mt(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return k8(e,this.userId,t)}_r(e){return P8(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Xh,lastStreamToken:""}))}}function k8(n,e,t){const r=a_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Xf(n).ee({range:s,X:!0},((o,l,c)=>{const[h,g,m]=o;h===e&&g===i&&(a=!0),c.done()})).next((()=>a))}function Yc(n){return yi(n,lo)}function Xf(n){return yi(n,D0)}function P8(n){return yi(n,Op)}class xd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xd(0)}static cr(){return new xd(-1)}}class cte{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new xd(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ot.fromTimestamp(new Kn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Of(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Mt(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return Of(e).ee(((a,o)=>{const l=Am(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>de.waitFor(s))).next((()=>i))}forEachTarget(e,t){return Of(e).ee(((r,i)=>{const s=Am(i);t(s)}))}lr(e){return OL(e).get(lv).next((t=>(Mt(t!==null,2888),t)))}hr(e,t){return OL(e).put(lv,t)}Pr(e,t){return Of(e).put(T8(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=md(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Of(e).ee({range:i,index:Sj},((a,o,l)=>{const c=Am(o);N1(t,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=ou(e);return t.forEach((a=>{const o=us(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),de.waitFor(i)}removeMatchingKeys(e,t,r){const i=ou(e);return de.forEach(t,(s=>{const a=us(s.path);return de.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=ou(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ou(e);let s=un();return i.ee({range:r,X:!0},((a,o,l)=>{const c=Jo(a[1]),h=new ft(c);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=us(t.path),i=IDBKeyRange.bound([r],[gj(r)],!1,!0);let s=0;return ou(e).ee({index:lI,X:!0,range:i},(([a,o],l,c)=>{a!==0&&(s++,c.done())})).next((()=>s>0))}At(e,t){return Of(e).get(t).next((r=>r?Am(r):null))}}function Of(n){return yi(n,F0)}function OL(n){return yi(n,qh)}function ou(n){return yi(n,j0)}const DL="LruGarbageCollector",ute=1048576;function FL([n,e],[t,r]){const i=en(n,t);return i===0?en(e,r):i}class hte{constructor(e){this.Ir=e,this.buffer=new Zn(FL),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();FL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class M8{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Qe(DL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){$u(t)?Qe(DL,"Ignoring IndexedDB error during garbage collection: ",t):await Nd(t)}await this.Vr(3e5)}))}}class dte{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return de.resolve(Da.ce);const r=new hte(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Qe("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(LL)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Qe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),LL):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(Qe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i)))).next((g=>(r=g,o=Date.now(),this.removeTargets(e,r,t)))).next((g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(c=Date.now(),$f()<=yn.DEBUG&&Qe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${g} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g}))))}}function N8(n,e){return new dte(n,e)}class fte{constructor(e,t){this.db=e,this.garbageCollector=N8(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Rx(e,r)}removeReference(e,t,r){return Rx(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Rx(e,t)}br(e,t){return(function(i,s){let a=!1;return P8(i).te((o=>k8(i,o,s).next((l=>(l&&(a=!0),de.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((c=>{if(!c)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Ot.min()),ou(e).delete((function(g){return[0,us(g.path)]})(a)))))}));i.push(l)}})).next((()=>de.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Rx(e,t)}Sr(e,t){const r=ou(e);let i,s=Da.ce;return r.ee({index:lI},(([a,o],{path:l,sequenceNumber:c})=>{a===0?(s!==Da.ce&&t(new ft(Jo(i)),s),s=c,i=l):s=Da.ce})).next((()=>{s!==Da.ce&&t(new ft(Jo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rx(n,e){return ou(n).put((function(r,i){return{targetId:0,path:us(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class L8{constructor(){this.changes=new pc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,jr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?de.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class gte{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return _h(e).put(r)}removeEntry(e,t,r){return _h(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],mv(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=jr.newInvalidDocument(t);return _h(e).ee({index:o_,range:IDBKeyRange.only(gm(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:jr.newInvalidDocument(t)};return _h(e).ee({index:o_,range:IDBKeyRange.only(gm(t))},((i,s)=>{r={document:this.Cr(t,s),size:yv(s)}})).next((()=>r))}getEntries(e,t){let r=da();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=da(),i=new Tr(ft.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,yv(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return de.resolve();let i=new Zn(BL);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(gm(i.first()),gm(i.last())),a=i.getIterator();let o=a.getNext();return _h(e).ee({index:o_,range:s},((l,c,h)=>{const g=ft.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&BL(o,g)<0;)r(o,null),o=a.getNext();o&&o.isEqual(g)&&(r(o,c),o=a.hasNext()?a.getNext():null),o?h.j(gm(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),mv(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return _h(e).J(IDBKeyRange.bound(o,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let h=da();for(const g of c){const m=this.Cr(ft.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(O1(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=da();const a=VL(t,r),o=VL(t,ma.max());return _h(e).ee({index:Ej,range:IDBKeyRange.bound(a,o,!0)},((l,c,h)=>{const g=this.Cr(ft.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(g.key,g),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new mte(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return jL(e).get(Ob).next((t=>(Mt(!!t,20021),t)))}Dr(e,t){return jL(e).put(Ob,t)}Cr(e,t){if(t){const r=Jee(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ot.min())))return r}return jr.newInvalidDocument(e)}}function O8(n){return new gte(n)}class mte extends L8{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new pc((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Zn(((s,a)=>en(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=wL(this.Nr.serializer,a);i=i.add(s.path.popLast());const c=yv(l);r+=c-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=wL(this.Nr.serializer,a.convertToNoDocument(Ot.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),de.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function jL(n){return yi(n,Dp)}function _h(n){return yi(n,ov)}function gm(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function VL(n,e){const t=e.documentKey.path.toArray();return[n,mv(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function BL(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=en(t[s],r[s]),i)return i;return i=en(t.length,r.length),i||(i=en(t[t.length-2],r[r.length-2]),i||en(t[t.length-1],r[r.length-1]))}class pte{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class D8{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Km(r.mutation,i,Vs.empty(),Kn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,un()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=un()){const i=el();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=Tm();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=el();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,un())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=da();const a=Hm(),o=(function(){return Hm()})();return t.forEach(((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof yc)?s=s.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),Km(h.mutation,c,h.mutation.getFieldMask(),Kn.now())):a.set(c.key,Vs.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,h)=>a.set(c,h))),t.forEach(((c,h)=>o.set(c,new pte(h,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=Hm();let i=new Tr(((a,o)=>a-o)),s=un();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||Vs.empty();h=o.applyToLocalView(c,h),r.set(l,h);const g=(i.get(o.batchId)||un()).add(l);i=i.insert(o.batchId,g)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,h=l.value,g=Jj();h.forEach((m=>{if(!s.has(m)){const y=a8(t.get(m),r.get(m));y!==null&&g.set(m,y),s=s.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,g))}return de.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ft.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Xj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):de.resolve(el());let o=Mp,l=s;return a.next((c=>de.forEach(c,((h,g)=>(o<g.largestBatchId&&(o=g.largestBatchId),s.get(h)?de.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,un()))).next((h=>({batchId:o,changes:Qj(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((r=>{let i=Tm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Tm();return this.indexManager.getCollectionParents(e,s).next((o=>de.forEach(o,(l=>{const c=(function(g,m){return new L1(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((h=>{h.forEach(((g,m)=>{a=a.insert(g,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,jr.newInvalidDocument(h)))}));let o=Tm();return a.forEach(((l,c)=>{const h=s.get(l);h!==void 0&&Km(h.mutation,c,Vs.empty(),Kn.now()),O1(t,c)&&(o=o.insert(l,c))})),o}))}}class yte{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return de.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ss(i.createTime)}})(t)),de.resolve()}getNamedQuery(e,t){return de.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:b8(i.bundledQuery),readTime:Ss(i.readTime)}})(t)),de.resolve()}}class xte{constructor(){this.overlays=new Tr(ft.comparator),this.qr=new Map}getOverlay(e,t){return de.resolve(this.overlays.get(t))}getOverlays(e,t){const r=el();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),de.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),de.resolve()}getOverlaysForCollection(e,t,r){const i=el(),s=t.length+1,a=new ft(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return de.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Tr(((c,h)=>c-h));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=el(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const o=el(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,h)=>o.set(c,h))),!(o.size()>=i)););return de.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new _I(t,r));let s=this.qr.get(t);s===void 0&&(s=un(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class _te{constructor(){this.sessionToken=ai.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,de.resolve()}}class TI{constructor(){this.Qr=new Zn(Si.$r),this.Ur=new Zn(Si.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Si(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Si(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ft(new Dn([])),r=new Si(t,e),i=new Si(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ft(new Dn([])),r=new Si(t,e),i=new Si(t,e+1);let s=un();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Si(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Si{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ft.comparator(e.key,t.key)||en(e.Yr,t.Yr)}static Kr(e,t){return en(e.Yr,t.Yr)||ft.comparator(e.key,t.key)}}class vte{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Zn(Si.$r)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new yI(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new Si(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return de.resolve(a)}lookupMutationBatch(e,t){return de.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?Xh:this.tr-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Si(t,0),i=new Si(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(en);return t.forEach((i=>{const s=new Si(i,0),a=new Si(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),de.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ft.isDocumentKey(s)||(s=s.child(""));const a=new Si(new ft(s),0);let o=new Zn(en);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)}),a),de.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Mt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return de.forEach(t.mutations,(i=>{const s=new Si(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Si(t,0),i=this.Zr.firstAfterOrEqual(r);return de.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class wte{constructor(e){this.ri=e,this.docs=(function(){return new Tr(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return de.resolve(r?r.document.mutableCopy():jr.newInvalidDocument(t))}getEntries(e,t){let r=da();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():jr.newInvalidDocument(i))})),de.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=da();const a=t.path,o=new ft(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||aI(yj(h),r)<=0||(i.has(h.key)||O1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,t,r,i){bt(9500)}ii(e,t){return de.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new Ete(this)}getSize(e){return de.resolve(this.size)}}class Ete extends L8{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),de.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Ste{constructor(e){this.persistence=e,this.si=new pc((t=>md(t)),N1),this.lastRemoteSnapshotVersion=Ot.min(),this.highestTargetId=0,this.oi=0,this._i=new TI,this.targetCount=0,this.ai=xd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),de.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new xd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,de.resolve()}updateTargetData(e,t){return this.Pr(t),de.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),de.waitFor(s).next((()=>i))}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return de.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),de.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),de.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),de.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return de.resolve(r)}containsKey(e,t){return de.resolve(this._i.containsKey(t))}}class bI{constructor(e,t){this.ui={},this.overlays={},this.ci=new Da(0),this.li=!1,this.li=!0,this.hi=new _te,this.referenceDelegate=e(this),this.Pi=new Ste(this),this.indexManager=new ote,this.remoteDocumentCache=(function(i){return new wte(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new S8(t),this.Ii=new yte(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xte,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new vte(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Qe("MemoryPersistence","Starting transaction:",e);const i=new Tte(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return de.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class Tte extends _j{constructor(e){super(),this.currentSequenceNumber=e}}class nE{constructor(e){this.persistence=e,this.Ri=new TI,this.Vi=null}static mi(e){return new nE(e)}get fi(){if(this.Vi)return this.Vi;throw bt(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),de.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),de.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.fi,(r=>{const i=ft.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Ot.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return de.or([()=>de.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class xv{constructor(e,t){this.persistence=e,this.pi=new pc((r=>us(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=N8(this,t)}static mi(e,t){return new xv(e,t)}Ei(){}di(e){return de.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return de.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?de.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Ot.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=c_(e.data.value)),t}br(e,t,r){return de.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class bte{constructor(e){this.serializer=e}k(e,t,r,i){const s=new Gw("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(M1)})(e),(function(l){l.createObjectStore(Op,{keyPath:DJ}),l.createObjectStore(lo,{keyPath:ZN,autoIncrement:!0}).createIndex(Gh,QN,{unique:!0}),l.createObjectStore(D0)})(e),GL(e),(function(l){l.createObjectStore(Ah)})(e));let a=de.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(j0),l.deleteObjectStore(F0),l.deleteObjectStore(qh)})(e),GL(e)),a=a.next((()=>(function(l){const c=l.store(qh),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ot.min().toTimestamp(),targetCount:0};return c.put(lv,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,c){return c.store(lo).J().next((g=>{l.deleteObjectStore(lo),l.createObjectStore(lo,{keyPath:ZN,autoIncrement:!0}).createIndex(Gh,QN,{unique:!0});const m=c.store(lo),y=g.map((v=>m.put(v)));return de.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(V0,{keyPath:WJ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(Dp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(Uw,{keyPath:HJ})})(e),(function(l){l.createObjectStore($w,{keyPath:KJ})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const c=l.createObjectStore(Ww,{keyPath:eee});c.createIndex(Fb,tee,{unique:!1}),c.createIndex(Aj,nee,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const c=l.createObjectStore(ov,{keyPath:jJ});c.createIndex(o_,VJ),c.createIndex(Ej,BJ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ah)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(cI,{keyPath:XJ,autoIncrement:!0}).createIndex(Db,qJ,{unique:!1}),l.createObjectStore(zm,{keyPath:YJ}).createIndex(Tj,ZJ,{unique:!1}),l.createObjectStore(Um,{keyPath:QJ}).createIndex(bj,JJ,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(zm).clear()})).next((()=>{t.objectStore(Um).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(uI,{keyPath:ree})})(e)}))),r<18&&i>=18&&v6()&&(a=a.next((()=>{t.objectStore(zm).clear()})).next((()=>{t.objectStore(Um).clear()}))),a}wi(e){let t=0;return e.store(Ah).ee(((r,i)=>{t+=yv(i)})).next((()=>{const r={byteSize:t};return e.store(Dp).put(Ob,r)}))}yi(e){const t=e.store(Op),r=e.store(lo);return t.J().next((i=>de.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Xh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Gh,a).next((o=>de.forEach(o,(l=>{Mt(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Mh(this.serializer,l);return C8(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const t=e.store(j0),r=e.store(Ah);return e.store(qh).get(lv).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new Dn(a),c=(function(g){return[0,us(g)]})(l);s.push(t.get(c).next((h=>h?de.resolve():(g=>t.put({targetId:0,path:us(g),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>de.waitFor(s)))}))}bi(e,t){e.createObjectStore(Fp,{keyPath:$J});const r=t.store(Fp),i=new SI,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:us(l)})}};return t.store(Ah).ee({X:!0},((a,o)=>{const l=new Dn(a);return s(l.popLast())})).next((()=>t.store(D0).ee({X:!0},(([a,o,l],c)=>{const h=Jo(o);return s(h.popLast())}))))}Di(e){const t=e.store(F0);return t.ee(((r,i)=>{const s=Am(i),a=T8(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(Ah),i=[];return r.ee(((s,a)=>{const o=t.store(ov),l=(function(g){return g.document?new ft(Dn.fromString(g.document.name).popFirst(5)):g.noDocument?ft.fromSegments(g.noDocument.path):g.unknownDocument?ft.fromSegments(g.unknownDocument.path):bt(36783)})(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(c))})).next((()=>de.waitFor(i)))}Fi(e,t){const r=t.store(lo),i=O8(this.serializer),s=new bI(nE.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let c=o.get(l.userId)??un();Mh(this.serializer,l).keys().forEach((h=>c=c.add(h))),o.set(l.userId,c)})),de.forEach(o,((l,c)=>{const h=new Gi(c),g=eE.wt(this.serializer,h),m=s.getIndexManager(h),y=tE.wt(h,this.serializer,m,s.referenceDelegate);return new D8(i,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new jb(t,Da.ce),l).next()}))}))}}function GL(n){n.createObjectStore(j0,{keyPath:zJ}).createIndex(lI,UJ,{unique:!0}),n.createObjectStore(F0,{keyPath:"targetId"}).createIndex(Sj,GJ,{unique:!0}),n.createObjectStore(qh)}const Zc="IndexedDbPersistence",rT=18e5,iT=5e3,sT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ate="main";class AI{constructor(e,t,r,i,s,a,o,l,c,h,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=c,this.Oi=h,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!AI.v())throw new ct(Oe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new fte(this,i),this.$i=t+Ate,this.serializer=new S8(l),this.Ui=new Au(this.$i,this.Ni,new bte(this.serializer)),this.hi=new tte,this.Pi=new cte(this.referenceDelegate,this.serializer),this.remoteDocumentCache=O8(this.serializer),this.Ii=new ete,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&vs(Zc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ct(Oe.FAILED_PRECONDITION,sT);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Da(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Ix(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if($u(e))return Qe(Zc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Qe(Zc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return mm(e).get(kf).next((t=>de.resolve(this.es(t))))}ts(e){return Ix(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,rT)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=yi(t,V0);return r.J().next((i=>{const s=this.ss(i,rT),a=i.filter((o=>s.indexOf(o)===-1));return de.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?de.resolve(!0):mm(e).get(kf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,iT)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ct(Oe.FAILED_PRECONDITION,sT);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ix(e).J().next((r=>this.ss(r,iT).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Qe(Zc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[M1,V0],(e=>{const t=new jb(e,Da.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Ix(e).J().next((t=>this.ss(t,rT).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return tE.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new lte(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return eE.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Qe(Zc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?aee:l===17?kj:l===16?see:l===15?hI:l===14?Cj:l===13?Ij:l===12?iee:l===11?Rj:void bt(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new jb(o,this.ci?this.ci.next():Da.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw vs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ct(Oe.FAILED_PRECONDITION,xj);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return mm(e).get(kf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,iT)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ct(Oe.FAILED_PRECONDITION,sT)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return mm(e).put(kf,t)}static v(){return Au.v()}Zi(e){const t=mm(e);return t.get(kf).next((r=>this.es(r)?(Qe(Zc,"Releasing primary lease."),t.delete(kf)):de.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(vs(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;_6()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Qe(Zc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return vs(Zc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){vs("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function mm(n){return yi(n,M1)}function Ix(n){return yi(n,V0)}function Rte(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class RI{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=un(),i=un();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new RI(e,t.fromCache,r,i)}}class Ite{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class F8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return _6()?8:vj(pi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new Ite;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?($f()<=yn.DEBUG&&Qe("QueryEngine","SDK will not create cache indexes for query:",Wf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),de.resolve()):($f()<=yn.DEBUG&&Qe("QueryEngine","Query:",Wf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?($f()<=yn.DEBUG&&Qe("QueryEngine","The SDK decides to create cache indexes for query:",Wf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Va(t))):de.resolve())}ys(e,t){if(hL(t))return de.resolve(null);let r=Va(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Wb(t,null,"F"),r=Va(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=un(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,Wb(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,i){return hL(t)||i.isEqual(Ot.min())?de.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?de.resolve(null):($f()<=yn.DEBUG&&Qe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wf(t)),this.vs(e,a,t,CJ(i,Mp)).next((o=>o)))}))}Ds(e,t){let r=new Zn(Yj(e));return t.forEach(((i,s)=>{O1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return $f()<=yn.DEBUG&&Qe("QueryEngine","Using full collection scan to execute query:",Wf(t)),this.ps.getDocumentsMatchingQuery(e,t,ma.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const II="LocalStore",Cte=3e8;class kte{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Tr(en),this.xs=new pc((s=>md(s)),N1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new D8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function j8(n,e,t,r){return new kte(n,e,t,r)}async function V8(n,e){const t=tn(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=un();for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function Pte(n,e){const t=tn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,h){const g=c.batch,m=g.keys();let y=de.resolve();return m.forEach((v=>{y=y.next((()=>h.getEntry(l,v))).next((x=>{const w=c.docVersions.get(v);Mt(w!==null,48541),x.version.compareTo(w)<0&&(g.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),h.addEntry(x)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,g)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=un();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function B8(n){const e=tn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Mte(n,e){const t=tn(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,g)=>{const m=i.get(g);if(!m)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,g))));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?y=y.withResumeToken(ai.EMPTY_BYTE_STRING,Ot.min()).withLastLimboFreeSnapshotVersion(Ot.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(g,y),(function(x,w,T){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=Cte?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=da(),c=un();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(Nte(s,a,e.documentUpdates).next((h=>{l=h.ks,c=h.qs}))),!r.isEqual(Ot.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return de.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function Nte(n,e,t){let r=un(),i=un();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=da();return t.forEach(((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ot.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Qe(II,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function Lte(n,e){const t=tn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Xh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Ote(n,e){const t=tn(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,de.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Wl(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Jb(n,e,t){const r=tn(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!$u(a))throw a;Qe(II,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function zL(n,e,t){const r=tn(n);let i=Ot.min(),s=un();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,h){const g=tn(l),m=g.xs.get(h);return m!==void 0?de.resolve(g.Ms.get(m)):g.Pi.getTargetData(c,h)})(r,a,Va(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Ot.min(),t?s:un()))).next((o=>(Dte(r,wee(e),o),{documents:o,Qs:s})))))}function Dte(n,e,t){let r=n.Os.get(e)||Ot.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class UL{constructor(){this.activeTargetIds=Ree()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class G8{constructor(){this.Mo=new UL,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new UL,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Fte{Oo(e){}shutdown(){}}const $L="ConnectivityMonitor";class WL{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Qe($L,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Qe($L,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Cx=null;function eA(){return Cx===null?Cx=(function(){return 268435456+Math.round(2147483648*Math.random())})():Cx++,"0x"+Cx.toString(16)}const aT="RestConnection",jte={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Vte{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===cv?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=eA(),o=this.zo(e,t.toUriEncodedString());Qe(aT,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(o),h=Pd(c);return this.Jo(e,o,l,r,h).then((g=>(Qe(aT,`Received RPC '${e}' ${a}: `,g),g)),(g=>{throw fd(aT,`RPC '${e}' ${a} failed with error: `,g,"url: ",o,"request:",r),g}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+cg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=jte[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Bte{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const es="WebChannelConnection";class Gte extends Vte{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=eA();return new Promise(((o,l)=>{const c=new oj;c.setWithCredentials(!0),c.listenOnce(lj.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case i_.NO_ERROR:const g=c.getResponseJson();Qe(es,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),o(g);break;case i_.TIMEOUT:Qe(es,`RPC '${e}' ${a} timed out`),l(new ct(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case i_.HTTP_ERROR:const m=c.getStatus();if(Qe(es,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const v=y?.error;if(v&&v.status&&v.message){const x=(function(T){const b=T.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(b)>=0?b:Oe.UNKNOWN})(v.status);l(new ct(x,v.message))}else l(new ct(Oe.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ct(Oe.UNAVAILABLE,"Connection failed."));break;default:bt(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Qe(es,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);Qe(es,`RPC '${e}' ${a} sending request:`,i),c.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=eA(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=hj(),o=uj(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");Qe(es,`Creating RPC '${e}' stream ${i}: ${h}`,l);const g=a.createWebChannel(h,l);this.I_(g);let m=!1,y=!1;const v=new Bte({Yo:w=>{y?Qe(es,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(m||(Qe(es,`Opening RPC '${e}' stream ${i} transport.`),g.open(),m=!0),Qe(es,`RPC '${e}' stream ${i} sending:`,w),g.send(w))},Zo:()=>g.close()}),x=(w,T,b)=>{w.listen(T,(A=>{try{b(A)}catch(M){setTimeout((()=>{throw M}),0)}}))};return x(g,Sm.EventType.OPEN,(()=>{y||(Qe(es,`RPC '${e}' stream ${i} transport opened.`),v.o_())})),x(g,Sm.EventType.CLOSE,(()=>{y||(y=!0,Qe(es,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(g))})),x(g,Sm.EventType.ERROR,(w=>{y||(y=!0,fd(es,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),v.a_(new ct(Oe.UNAVAILABLE,"The operation could not be completed")))})),x(g,Sm.EventType.MESSAGE,(w=>{if(!y){const T=w.data[0];Mt(!!T,16349);const b=T,A=b?.error||b[0]?.error;if(A){Qe(es,`RPC '${e}' stream ${i} received error:`,A);const M=A.status;let O=(function(R){const P=Qr[R];if(P!==void 0)return c8(P)})(M),z=A.message;O===void 0&&(O=Oe.INTERNAL,z="Unknown error status: "+M+" with message "+A.message),y=!0,v.a_(new ct(O,z)),g.close()}else Qe(es,`RPC '${e}' stream ${i} received:`,T),v.u_(T)}})),x(o,cj.STAT_EVENT,(w=>{w.stat===Mb.PROXY?Qe(es,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===Mb.NOPROXY&&Qe(es,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function zte(){return typeof window<"u"?window:null}function g_(){return typeof document<"u"?document:null}function rE(n){return new Uee(n,!0)}class z8{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Qe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const HL="PersistentStream";class U8{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new z8(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Oe.RESOURCE_EXHAUSTED?(vs(t.toString()),vs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new ct(Oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Qe(HL,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Qe(HL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ute extends U8{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Hee(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Ot.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ot.min():a.readTime?Ss(a.readTime):Ot.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Xb(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=hv(l)?{documents:y8(s,l)}:{query:x8(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=d8(s,a.resumeToken);const c=Hb(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ot.min())>0){o.readTime=K0(s,a.snapshotVersion.toTimestamp());const c=Hb(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const r=Xee(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Xb(this.serializer),t.removeTarget=e,this.q_(t)}}class $te extends U8{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Mt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Mt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Mt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Kee(e.writeResults,e.commitTime),r=Ss(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Xb(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>gv(this.serializer,r)))};this.q_(t)}}class Wte{}class Hte extends Wte{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ct(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,Kb(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ct(Oe.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,Kb(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ct(Oe.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Kte{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vs(t),this.aa=!1):Qe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const _d="RemoteStore";class Xte{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Ld(this)&&(Qe(_d,"Restarting streams for network reachability change."),await(async function(l){const c=tn(l);c.Ea.add(4),await F1(c),c.Ra.set("Unknown"),c.Ea.delete(4),await iE(c)})(this))}))})),this.Ra=new Kte(r,i)}}async function iE(n){if(Ld(n))for(const e of n.da)await e(!0)}async function F1(n){for(const e of n.da)await e(!1)}function $8(n,e){const t=tn(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),MI(t)?PI(t):hg(t).O_()&&kI(t,e))}function CI(n,e){const t=tn(n),r=hg(t);t.Ia.delete(e),r.O_()&&W8(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ld(t)&&t.Ra.set("Unknown"))}function kI(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ot.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hg(n).Y_(e)}function W8(n,e){n.Va.Ue(e),hg(n).Z_(e)}function PI(n){n.Va=new Vee({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),hg(n).start(),n.Ra.ua()}function MI(n){return Ld(n)&&!hg(n).x_()&&n.Ia.size>0}function Ld(n){return tn(n).Ea.size===0}function H8(n){n.Va=void 0}async function qte(n){n.Ra.set("Online")}async function Yte(n){n.Ia.forEach(((e,t)=>{kI(n,e)}))}async function Zte(n,e){H8(n),MI(n)?(n.Ra.ha(e),PI(n)):n.Ra.set("Unknown")}async function Qte(n,e,t){if(n.Ra.set("Online"),e instanceof h8&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){Qe(_d,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _v(n,r)}else if(e instanceof d_?n.Va.Ze(e):e instanceof u8?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ot.min()))try{const r=await B8(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(c);h&&s.Ia.set(c,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(ai.EMPTY_BYTE_STRING,h.snapshotVersion)),W8(s,l);const g=new Wl(h.target,l,c,h.sequenceNumber);kI(s,g)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){Qe(_d,"Failed to raise snapshot:",r),await _v(n,r)}}async function _v(n,e,t){if(!$u(e))throw e;n.Ea.add(1),await F1(n),n.Ra.set("Offline"),t||(t=()=>B8(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Qe(_d,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await iE(n)}))}function K8(n,e){return e().catch((t=>_v(n,t,e)))}async function j1(n){const e=tn(n),t=Lu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Xh;for(;Jte(e);)try{const i=await Lte(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,ene(e,i)}catch(i){await _v(e,i)}X8(e)&&q8(e)}function Jte(n){return Ld(n)&&n.Ta.length<10}function ene(n,e){n.Ta.push(e);const t=Lu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function X8(n){return Ld(n)&&!Lu(n).x_()&&n.Ta.length>0}function q8(n){Lu(n).start()}async function tne(n){Lu(n).ra()}async function nne(n){const e=Lu(n);for(const t of n.Ta)e.ea(t.mutations)}async function rne(n,e,t){const r=n.Ta.shift(),i=xI.from(r,e,t);await K8(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await j1(n)}async function ine(n,e){e&&Lu(n).X_&&await(async function(r,i){if((function(a){return Dee(a)&&a!==Oe.ABORTED})(i.code)){const s=r.Ta.shift();Lu(r).B_(),await K8(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await j1(r)}})(n,e),X8(n)&&q8(n)}async function KL(n,e){const t=tn(n);t.asyncQueue.verifyOperationInProgress(),Qe(_d,"RemoteStore received new credentials");const r=Ld(t);t.Ea.add(3),await F1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await iE(t)}async function sne(n,e){const t=tn(n);e?(t.Ea.delete(2),await iE(t)):e||(t.Ea.add(2),await F1(t),t.Ra.set("Unknown"))}function hg(n){return n.ma||(n.ma=(function(t,r,i){const s=tn(t);return s.sa(),new Ute(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:qte.bind(null,n),t_:Yte.bind(null,n),r_:Zte.bind(null,n),H_:Qte.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),MI(n)?PI(n):n.Ra.set("Unknown")):(await n.ma.stop(),H8(n))}))),n.ma}function Lu(n){return n.fa||(n.fa=(function(t,r,i){const s=tn(t);return s.sa(),new $te(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:tne.bind(null,n),r_:ine.bind(null,n),ta:nne.bind(null,n),na:rne.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await j1(n)):(await n.fa.stop(),n.Ta.length>0&&(Qe(_d,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class NI{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new il,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new NI(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ct(Oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function LI(n,e){if(vs("AsyncQueue",`${e}: ${n}`),$u(n))return new ct(Oe.UNAVAILABLE,`${e}: ${n}`);throw n}class y0{static emptySet(e){return new y0(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ft.comparator(t.key,r.key):(t,r)=>ft.comparator(t.key,r.key),this.keyedMap=Tm(),this.sortedSet=new Tr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof y0)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new y0;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class XL{constructor(){this.ga=new Tr(ft.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):bt(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class X0{constructor(e,t,r,i,s,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new X0(e,t,y0.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class ane{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class one{constructor(){this.queries=qL(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=tn(t),s=i.queries;i.queries=qL(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new ct(Oe.ABORTED,"Firestore shutting down"))}}function qL(){return new pc((n=>qj(n)),qw)}async function Y8(n,e){const t=tn(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new ane,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=LI(a,`Initialization of query '${Wf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&OI(t)}async function Z8(n,e){const t=tn(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function lne(n,e){const t=tn(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&OI(t)}function cne(n,e,t){const r=tn(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function OI(n){n.Ca.forEach((e=>{e.next()}))}var tA,YL;(YL=tA||(tA={})).Ma="default",YL.Cache="cache";class Q8{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new X0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=X0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tA.Cache}}class J8{constructor(e){this.key=e}}class e9{constructor(e){this.key=e}}class une{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=un(),this.mutatedKeys=un(),this.eu=Yj(e),this.tu=new y0(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new XL,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,g)=>{const m=i.get(h),y=O1(this.query,g)?g:null,v=!!m&&this.mutatedKeys.has(m.key),x=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;m&&y?m.data.isEqual(y.data)?v!==x&&(r.track({type:3,doc:y}),w=!0):this.su(m,y)||(r.track({type:2,doc:y}),w=!0,(l&&this.eu(y,l)>0||c&&this.eu(y,c)<0)&&(o=!0)):!m&&y?(r.track({type:0,doc:y}),w=!0):m&&!y&&(r.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(y?(a=a.add(y),s=x?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,g)=>(function(y,v){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return bt(20277,{Rt:w})}};return x(y)-x(v)})(h.type,g.type)||this.eu(h.doc,g.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new X0(this.query,e.tu,s,a,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new XL,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=un(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new e9(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new J8(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=un();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return X0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const DI="SyncEngine";class hne{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class dne{constructor(e){this.key=e,this.hu=!1}}class fne{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new pc((o=>qj(o)),qw),this.Iu=new Map,this.Eu=new Set,this.du=new Tr(ft.comparator),this.Au=new Map,this.Ru=new TI,this.Vu={},this.mu=new Map,this.fu=xd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function gne(n,e,t=!0){const r=a9(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await t9(r,e,t,!0),i}async function mne(n,e){const t=a9(n);await t9(t,e,!0,!1)}async function t9(n,e,t,r){const i=await Ote(n.localStore,Va(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await pne(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&$8(n.remoteStore,i),o}async function pne(n,e,t,r,i){n.pu=(g,m,y)=>(async function(x,w,T,b){let A=w.view.ru(T);A.Cs&&(A=await zL(x.localStore,w.query,!1).then((({documents:I})=>w.view.ru(I,A))));const M=b&&b.targetChanges.get(w.targetId),O=b&&b.targetMismatches.get(w.targetId)!=null,z=w.view.applyChanges(A,x.isPrimaryClient,M,O);return QL(x,w.targetId,z.au),z.snapshot})(n,g,m,y);const s=await zL(n.localStore,e,!0),a=new une(e,s.Qs),o=a.ru(s.documents),l=D1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=a.applyChanges(o,n.isPrimaryClient,l);QL(n,t,c.au);const h=new hne(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function yne(n,e,t){const r=tn(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!qw(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Jb(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&CI(r.remoteStore,i.targetId),nA(r,i.targetId)})).catch(Nd)):(nA(r,i.targetId),await Jb(r.localStore,i.targetId,!0))}async function xne(n,e){const t=tn(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),CI(t.remoteStore,r.targetId))}async function _ne(n,e,t){const r=o9(n);try{const i=await(function(a,o){const l=tn(a),c=Kn.now(),h=o.reduce(((y,v)=>y.add(v.key)),un());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let v=da(),x=un();return l.Ns.getEntries(y,h).next((w=>{v=w,v.forEach(((T,b)=>{b.isValidDocument()||(x=x.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,v))).next((w=>{g=w;const T=[];for(const b of o){const A=Lee(b,g.get(b.key).overlayedDocument);A!=null&&T.push(new yc(b.key,A,Bj(A.value.mapValue),ls.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,T,o)})).next((w=>{m=w;const T=w.applyToLocalDocumentSet(g,x);return l.documentOverlayCache.saveOverlays(y,w.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:Qj(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Tr(en)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(r,i.batchId,t),await V1(r,i.changes),await j1(r.remoteStore)}catch(i){const s=LI(i,"Failed to persist write");t.reject(s)}}async function n9(n,e){const t=tn(n);try{const r=await Mte(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Mt(a.hu,14607):i.removedDocuments.size>0&&(Mt(a.hu,42227),a.hu=!1))})),await V1(t,r,e)}catch(r){await Nd(r)}}function ZL(n,e,t){const r=tn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=tn(a);l.onlineState=o;let c=!1;l.queries.forEach(((h,g)=>{for(const m of g.Sa)m.va(o)&&(c=!0)})),c&&OI(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function vne(n,e,t){const r=tn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new Tr(ft.comparator);a=a.insert(s,jr.newNoDocument(s,Ot.min()));const o=un().add(s),l=new Jw(Ot.min(),new Map,new Tr(en),a,o);await n9(r,l),r.du=r.du.remove(s),r.Au.delete(e),FI(r)}else await Jb(r.localStore,e,!1).then((()=>nA(r,e,t))).catch(Nd)}async function wne(n,e){const t=tn(n),r=e.batch.batchId;try{const i=await Pte(t.localStore,e);i9(t,r,null),r9(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await V1(t,i)}catch(i){await Nd(i)}}async function Ene(n,e,t){const r=tn(n);try{const i=await(function(a,o){const l=tn(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let h;return l.mutationQueue.lookupMutationBatch(c,o).next((g=>(Mt(g!==null,37113),h=g.keys(),l.mutationQueue.removeMutationBatch(c,g)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h))).next((()=>l.localDocuments.getDocuments(c,h)))}))})(r.localStore,e);i9(r,e,t),r9(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await V1(r,i)}catch(i){await Nd(i)}}function r9(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function i9(n,e,t){const r=tn(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function nA(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||s9(n,r)}))}function s9(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(CI(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),FI(n))}function QL(n,e,t){for(const r of t)r instanceof J8?(n.Ru.addReference(r.key,e),Sne(n,r)):r instanceof e9?(Qe(DI,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||s9(n,r.key)):bt(19791,{wu:r})}function Sne(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Qe(DI,"New document in limbo: "+t),n.Eu.add(r),FI(n))}function FI(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ft(Dn.fromString(e)),r=n.fu.next();n.Au.set(r,new dne(t)),n.du=n.du.insert(t,r),$8(n.remoteStore,new Wl(Va(Xw(t.path)),r,"TargetPurposeLimboResolution",Da.ce))}}async function V1(n,e,t){const r=tn(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=RI.As(l.targetId,c);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,c){const h=tn(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>de.forEach(c,(m=>de.forEach(m.Es,(y=>h.persistence.referenceDelegate.addReference(g,m.targetId,y))).next((()=>de.forEach(m.ds,(y=>h.persistence.referenceDelegate.removeReference(g,m.targetId,y)))))))))}catch(g){if(!$u(g))throw g;Qe(II,"Failed to update sequence numbers: "+g)}for(const g of c){const m=g.targetId;if(!g.fromCache){const y=h.Ms.get(m),v=y.snapshotVersion,x=y.withLastLimboFreeSnapshotVersion(v);h.Ms=h.Ms.insert(m,x)}}})(r.localStore,s))}async function Tne(n,e){const t=tn(n);if(!t.currentUser.isEqual(e)){Qe(DI,"User change. New user:",e.toKey());const r=await V8(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new ct(Oe.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await V1(t,r.Ls)}}function bne(n,e){const t=tn(n),r=t.Au.get(e);if(r&&r.hu)return un().add(r.key);{let i=un();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function a9(n){const e=tn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=n9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vne.bind(null,e),e.Pu.H_=lne.bind(null,e.eventManager),e.Pu.yu=cne.bind(null,e.eventManager),e}function o9(n){const e=tn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wne.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ene.bind(null,e),e}class Up{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return j8(this.persistence,new F8,e.initialUser,this.serializer)}Cu(e){return new bI(nE.mi,this.serializer)}Du(e){return new G8}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Up.provider={build:()=>new Up};class Ane extends Up{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Mt(this.persistence.referenceDelegate instanceof xv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new M8(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?is.withCacheSize(this.cacheSizeBytes):is.DEFAULT;return new bI((r=>xv.mi(r,t)),this.serializer)}}class Rne extends Up{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await o9(this.xu.syncEngine),await j1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return j8(this.persistence,new F8,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new M8(r,e.asyncQueue,t)}Mu(e,t){const r=new NJ(t,this.persistence);return new MJ(e.asyncQueue,r)}Cu(e){const t=Rte(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?is.withCacheSize(this.cacheSizeBytes):is.DEFAULT;return new AI(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,zte(),g_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new G8}}class vv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ZL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Tne.bind(null,this.syncEngine),await sne(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new one})()}createDatastore(e){const t=rE(e.databaseInfo.databaseId),r=(function(s){return new Gte(s)})(e.databaseInfo);return(function(s,a,o,l){return new Hte(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new Xte(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>ZL(this.syncEngine,t,0)),(function(){return WL.v()?new WL:new Fte})())}createSyncEngine(e,t){return(function(i,s,a,o,l,c,h){const g=new fne(i,s,a,o,l,c);return h&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=tn(t);Qe(_d,"RemoteStore shutting down."),r.Ea.add(5),await F1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}vv.provider={build:()=>new vv};class l9{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ou="FirestoreClient";class Ine{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Gi.UNAUTHENTICATED,this.clientId=sI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{Qe(Ou,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(Qe(Ou,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new il;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=LI(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function oT(n,e){n.asyncQueue.verifyOperationInProgress(),Qe(Ou,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await V8(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function JL(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Cne(n);Qe(Ou,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>KL(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>KL(e.remoteStore,i))),n._onlineComponents=e}async function Cne(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Qe(Ou,"Using user provided OfflineComponentProvider");try{await oT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Oe.FAILED_PRECONDITION||i.code===Oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;fd("Error using user provided cache. Falling back to memory cache: "+t),await oT(n,new Up)}}else Qe(Ou,"Using default OfflineComponentProvider"),await oT(n,new Ane(void 0));return n._offlineComponents}async function c9(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Qe(Ou,"Using user provided OnlineComponentProvider"),await JL(n,n._uninitializedComponentsProvider._online)):(Qe(Ou,"Using default OnlineComponentProvider"),await JL(n,new vv))),n._onlineComponents}function kne(n){return c9(n).then((e=>e.syncEngine))}async function u9(n){const e=await c9(n),t=e.eventManager;return t.onListen=gne.bind(null,e.syncEngine),t.onUnlisten=yne.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mne.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=xne.bind(null,e.syncEngine),t}function Pne(n,e,t={}){const r=new il;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new l9({next:m=>{h.Nu(),a.enqueueAndForget((()=>Z8(s,g)));const y=m.docs.has(o);!y&&m.fromCache?c.reject(new ct(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&l.source==="server"?c.reject(new ct(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new Q8(Xw(o.path),h,{includeMetadataChanges:!0,qa:!0});return Y8(s,g)})(await u9(n),n.asyncQueue,e,t,r))),r.promise}function Mne(n,e,t={}){const r=new il;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new l9({next:m=>{h.Nu(),a.enqueueAndForget((()=>Z8(s,g))),m.fromCache&&l.source==="server"?c.reject(new ct(Oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new Q8(o,h,{includeMetadataChanges:!0,qa:!0});return Y8(s,g)})(await u9(n),n.asyncQueue,e,t,r))),r.promise}function h9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const e3=new Map;const d9="firestore.googleapis.com",t3=!0;class n3{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ct(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=d9,this.ssl=t3}else this.host=e.host,this.ssl=e.ssl??t3;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=I8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ute)throw new ct(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IJ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=h9(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ct(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ct(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ct(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n3({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ct(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ct(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n3(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new xJ;switch(r.type){case"firstParty":return new EJ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ct(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=e3.get(t);r&&(Qe("ComponentProvider","Removing Datastore"),e3.delete(t),r.terminate())})(this),Promise.resolve()}}function Nne(n,e,t,r={}){n=$a(n,sE);const i=Pd(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&($R(`https://${o}`),WR("Firestore",!0)),s.host!==d9&&s.host!==o&&fd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!cd(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=Gi.MOCK_USER;else{c=y6(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new ct(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Gi(g)}n._authCredentials=new _J(new fj(c,h))}}class dg{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new dg(this.firestore,e,this._query)}}class Wr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ru(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wr(this.firestore,e,this._key)}toJSON(){return{type:Wr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(P1(t,Wr._jsonSchema))return new Wr(e,r||null,new ft(Dn.fromString(t.referencePath)))}}Wr._jsonSchemaVersion="firestore/documentReference/1.0",Wr._jsonSchema={type:ni("string",Wr._jsonSchemaVersion),referencePath:ni("string")};class Ru extends dg{constructor(e,t,r){super(e,t,Xw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wr(this.firestore,null,new ft(e))}withConverter(e){return new Ru(this.firestore,e,this._path)}}function r3(n,e,...t){if(n=Pi(n),mj("collection","path",e),n instanceof sE){const r=Dn.fromString(e,...t);return HN(r),new Ru(n,null,r)}{if(!(n instanceof Wr||n instanceof Ru))throw new ct(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Dn.fromString(e,...t));return HN(r),new Ru(n.firestore,null,r)}}function x0(n,e,...t){if(n=Pi(n),arguments.length===1&&(e=sI.newId()),mj("doc","path",e),n instanceof sE){const r=Dn.fromString(e,...t);return WN(r),new Wr(n,null,new ft(r))}{if(!(n instanceof Wr||n instanceof Ru))throw new ct(Oe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Dn.fromString(e,...t));return WN(r),new Wr(n.firestore,n instanceof Ru?n.converter:null,new ft(r))}}const i3="AsyncQueue";class s3{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new z8(this,"async_queue_retry"),this._c=()=>{const r=g_();r&&Qe(i3,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=g_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=g_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new il;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!$u(e))throw e;Qe(i3,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,vs("INTERNAL UNHANDLED ERROR: ",a3(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=NI.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&bt(47125,{Pc:a3(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function a3(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Hu extends sE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new s3,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s3(e),this._firestoreClient=void 0,await e}}}function Lne(n,e){const t=typeof n=="object"?n:XR(),r=typeof n=="string"?n:cv,i=Dw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=g6("firestore");s&&Nne(i,...s)}return i}function jI(n){if(n._terminated)throw new ct(Oe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||f9(n),n._firestoreClient}function f9(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new lee(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,h9(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Ine(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function One(n,e){fd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Dne(n,vv.provider,{build:r=>new Rne(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Dne(n,e,t){if((n=$a(n,Hu))._firestoreClient||n._terminated)throw new ct(Oe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ct(Oe.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},f9(n)}class Ma{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ma(ai.fromBase64String(e))}catch(t){throw new ct(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ma(ai.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ma._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(P1(e,Ma._jsonSchema))return Ma.fromBase64String(e.bytes)}}Ma._jsonSchemaVersion="firestore/bytes/1.0",Ma._jsonSchema={type:ni("string",Ma._jsonSchemaVersion),bytes:ni("string")};class aE{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ct(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class oE{constructor(e){this._methodName=e}}class sl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ct(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ct(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return en(this._lat,e._lat)||en(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:sl._jsonSchemaVersion}}static fromJSON(e){if(P1(e,sl._jsonSchema))return new sl(e.latitude,e.longitude)}}sl._jsonSchemaVersion="firestore/geoPoint/1.0",sl._jsonSchema={type:ni("string",sl._jsonSchemaVersion),latitude:ni("number"),longitude:ni("number")};class al{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:al._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(P1(e,al._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new al(e.vectorValues);throw new ct(Oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}al._jsonSchemaVersion="firestore/vectorValue/1.0",al._jsonSchema={type:ni("string",al._jsonSchemaVersion),vectorValues:ni("object")};const Fne=/^__.*__$/;class jne{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new yc(e,this.data,this.fieldMask,t,this.fieldTransforms):new ug(e,this.data,t,this.fieldTransforms)}}class g9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new yc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function m9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw bt(40011,{Ac:n})}}class VI{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new VI({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return wv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(m9(this.Ac)&&Fne.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Vne{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||rE(e)}Cc(e,t,r,i=!1){return new VI({Ac:e,methodName:t,Dc:r,path:kr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lE(n){const e=n._freezeSettings(),t=rE(n._databaseId);return new Vne(n._databaseId,!!e.ignoreUndefinedProperties,t)}function p9(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);GI("Data must be an object, but it was:",a,r);const o=y9(r,a);let l,c;if(s.merge)l=new Vs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const g of s.mergeFields){const m=rA(e,g,t);if(!a.contains(m))throw new ct(Oe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);_9(h,m)||h.push(m)}l=new Vs(h),c=a.fieldTransforms.filter((g=>l.covers(g.field)))}else l=null,c=a.fieldTransforms;return new jne(new os(o),l,c)}class cE extends oE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cE}}class BI extends oE{_toFieldTransform(e){return new s8(e.path,new $0)}isEqual(e){return e instanceof BI}}function Bne(n,e,t,r){const i=n.Cc(1,e,t);GI("Data must be an object, but it was:",i,r);const s=[],a=os.empty();Wu(r,((l,c)=>{const h=zI(e,l,t);c=Pi(c);const g=i.yc(h);if(c instanceof cE)s.push(h);else{const m=B1(c,g);m!=null&&(s.push(h),a.set(h,m))}}));const o=new Vs(s);return new g9(a,o,i.fieldTransforms)}function Gne(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[rA(e,r,t)],l=[i];if(s.length%2!=0)throw new ct(Oe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)o.push(rA(e,s[m])),l.push(s[m+1]);const c=[],h=os.empty();for(let m=o.length-1;m>=0;--m)if(!_9(c,o[m])){const y=o[m];let v=l[m];v=Pi(v);const x=a.yc(y);if(v instanceof cE)c.push(y);else{const w=B1(v,x);w!=null&&(c.push(y),h.set(y,w))}}const g=new Vs(c);return new g9(h,g,a.fieldTransforms)}function zne(n,e,t,r=!1){return B1(t,n.Cc(r?4:3,e))}function B1(n,e){if(x9(n=Pi(n)))return GI("Unsupported field value:",e,n),y9(n,e);if(n instanceof oE)return(function(r,i){if(!m9(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=B1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Pi(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Iee(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Kn.fromDate(r);return{timestampValue:K0(i.serializer,s)}}if(r instanceof Kn){const s=new Kn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:K0(i.serializer,s)}}if(r instanceof sl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ma)return{bytesValue:d8(i.serializer,r._byteString)};if(r instanceof Wr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wI(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof al)return(function(a,o){return{mapValue:{fields:{[fI]:{stringValue:gI},[B0]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return pI(o.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Bw(r)}`)})(n,e)}function y9(n,e){const t={};return Pj(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wu(n,((r,i)=>{const s=B1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function x9(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Kn||n instanceof sl||n instanceof Ma||n instanceof Wr||n instanceof oE||n instanceof al)}function GI(n,e,t){if(!x9(t)||!pj(t)){const r=Bw(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function rA(n,e,t){if((e=Pi(e))instanceof aE)return e._internalPath;if(typeof e=="string")return zI(n,e);throw wv("Field path arguments must be of type string or ",n,!1,void 0,t)}const Une=new RegExp("[~\\*/\\[\\]]");function zI(n,e,t){if(e.search(Une)>=0)throw wv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new aE(...e.split("."))._internalPath}catch{throw wv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function wv(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new ct(Oe.INVALID_ARGUMENT,o+n+l)}function _9(n,e){return n.some((t=>t.isEqual(e)))}class v9{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Wr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $ne(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(UI("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class $ne extends v9{data(){return super.data()}}function UI(n,e){return typeof e=="string"?zI(n,e):e instanceof aE?e._internalPath:e._delegate._internalPath}function Wne(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ct(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $I{}class Hne extends $I{}function Kne(n,e,...t){let r=[];e instanceof $I&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof WI)).length,o=s.filter((l=>l instanceof uE)).length;if(a>1||a>0&&o>0)throw new ct(Oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class uE extends Hne{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new uE(e,t,r)}_apply(e){const t=this._parse(e);return w9(e._query,t),new dg(e.firestore,e.converter,$b(e._query,t))}_parse(e){const t=lE(e.firestore);return(function(s,a,o,l,c,h,g){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ct(Oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){l3(g,h);const v=[];for(const x of g)v.push(o3(l,s,x));m={arrayValue:{values:v}}}else m=o3(l,s,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||l3(g,h),m=zne(o,a,g,h==="in"||h==="not-in");return xn.create(c,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Xne(n,e,t){const r=e,i=UI("where",n);return uE._create(i,r,t)}class WI extends $I{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new WI(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:qn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)w9(a,l),a=$b(a,l)})(e._query,t),new dg(e.firestore,e.converter,$b(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function o3(n,e,t){if(typeof(t=Pi(t))=="string"){if(t==="")throw new ct(Oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xj(e)&&t.indexOf("/")!==-1)throw new ct(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Dn.fromString(t));if(!ft.isDocumentKey(r))throw new ct(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bp(n,new ft(r))}if(t instanceof Wr)return Bp(n,t._key);throw new ct(Oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bw(t)}.`)}function l3(n,e){if(!Array.isArray(n)||n.length===0)throw new ct(Oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function w9(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ct(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ct(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class qne{convertValue(e,t="none"){switch(Mu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw bt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Wu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[B0].arrayValue?.values?.map((r=>wr(r.doubleValue)));return new al(t)}convertGeoPoint(e){return new sl(wr(e.latitude),wr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Hw(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(jp(e));default:return null}}convertTimestamp(e){const t=oc(e);return new Kn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Dn.fromString(e);Mt(E8(r),9688,{name:e});const i=new gd(r.get(1),r.get(3)),s=new ft(r.popFirst(5));return i.isEqual(t)||vs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function E9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Rm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zh extends v9{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new m_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(UI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Zh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Zh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zh._jsonSchema={type:ni("string",Zh._jsonSchemaVersion),bundleSource:ni("string","DocumentSnapshot"),bundleName:ni("string"),bundle:ni("string")};class m_ extends Zh{data(e={}){return super.data(e)}}class _0{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Rm(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new m_(this._firestore,this._userDataWriter,r.key,r,new Rm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ct(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new m_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Rm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new m_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Rm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:Yne(o.type),doc:l,oldIndex:c,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=_0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sI.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Yne(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return bt(61501,{type:n})}}function Zne(n){n=$a(n,Wr);const e=$a(n.firestore,Hu);return Pne(jI(e),n._key).then((t=>nre(e,n,t)))}_0._jsonSchemaVersion="firestore/querySnapshot/1.0",_0._jsonSchema={type:ni("string",_0._jsonSchemaVersion),bundleSource:ni("string","QuerySnapshot"),bundleName:ni("string"),bundle:ni("string")};class S9 extends qne{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ma(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Wr(this.firestore,null,t)}}function Qne(n){n=$a(n,dg);const e=$a(n.firestore,Hu),t=jI(e),r=new S9(e);return Wne(n._query),Mne(t,n._query).then((i=>new _0(e,r,n,i)))}function c3(n,e,t){n=$a(n,Wr);const r=$a(n.firestore,Hu),i=E9(n.converter,e,t);return hE(r,[p9(lE(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ls.none())])}function Jne(n,e,t,...r){n=$a(n,Wr);const i=$a(n.firestore,Hu),s=lE(i);let a;return a=typeof(e=Pi(e))=="string"||e instanceof aE?Gne(s,"updateDoc",n._key,e,t,r):Bne(s,"updateDoc",n._key,e),hE(i,[a.toMutation(n._key,ls.exists(!0))])}function ere(n){return hE($a(n.firestore,Hu),[new Qw(n._key,ls.none())])}function tre(n,e){const t=$a(n.firestore,Hu),r=x0(n),i=E9(n.converter,e);return hE(t,[p9(lE(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ls.exists(!1))]).then((()=>r))}function hE(n,e){return(function(r,i){const s=new il;return r.asyncQueue.enqueueAndForget((async()=>_ne(await kne(r),i,s))),s.promise})(jI(n),e)}function nre(n,e,t){const r=t.docs.get(e._key),i=new S9(n);return new Zh(n,i,e._key,r,new Rm(t.hasPendingWrites,t.fromCache),e.converter)}function u3(){return new BI("serverTimestamp")}(function(e,t=!0){(function(i){cg=i})(Md),ud(new ku("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Hu(new vJ(r.getProvider("auth-internal")),new SJ(a,r.getProvider("app-check-internal")),(function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ct(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gd(c.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),nl(GN,zN,e),nl(GN,zN,"esm2020")})();const T9="firebasestorage.googleapis.com",rre="storageBucket",ire=120*1e3,sre=600*1e3;class vl extends _l{constructor(e,t,r=0){super(lT(e),`Firebase Storage: ${t} (${lT(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,vl.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lT(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var fl;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(fl||(fl={}));function lT(n){return"storage/"+n}function are(){const n="An unknown error occurred, please check the error payload for server response.";return new vl(fl.UNKNOWN,n)}function ore(){return new vl(fl.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function lre(){return new vl(fl.CANCELED,"User canceled the upload/download.")}function cre(n){return new vl(fl.INVALID_URL,"Invalid URL '"+n+"'.")}function ure(n){return new vl(fl.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function h3(n){return new vl(fl.INVALID_ARGUMENT,n)}function b9(){return new vl(fl.APP_DELETED,"The Firebase app was deleted.")}function hre(n){return new vl(fl.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class po{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=po.makeFromUrl(e,t)}catch{return new po(e,"")}if(r.path==="")return r;throw ure(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${g}/${h}/b/${i}/o${m}`,"i"),v={bucket:1,path:3},x=t===T9?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",T=new RegExp(`^https?://${x}/${i}/${w}`,"i"),A=[{regex:o,indices:l,postModify:s},{regex:y,indices:v,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let M=0;M<A.length;M++){const O=A[M],z=O.regex.exec(e);if(z){const I=z[O.indices.bucket];let R=z[O.indices.path];R||(R=""),r=new po(I,R),O.postModify(r);break}}if(r==null)throw cre(e);return r}}class dre{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function fre(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function h(...w){c||(c=!0,e.apply(null,w))}function g(w){i=setTimeout(()=>{i=null,n(y,l())},w)}function m(){s&&clearTimeout(s)}function y(w,...T){if(c){m();return}if(w){m(),h.call(null,w,...T);return}if(l()||a){m(),h.call(null,w,...T);return}r<64&&(r*=2);let A;o===1?(o=2,A=0):A=(r+Math.random())*1e3,g(A)}let v=!1;function x(w){v||(v=!0,m(),!c&&(i!==null?(w||(o=2),clearTimeout(i),g(0)):w||(o=1)))}return g(0),s=setTimeout(()=>{a=!0,x(!0)},t),x}function gre(n){n(!1)}function mre(n){return n!==void 0}function d3(n,e,t,r){if(r<e)throw h3(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw h3(`Invalid value for '${n}'. Expected ${t} or less.`)}function pre(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Ev;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Ev||(Ev={}));function yre(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class xre{constructor(e,t,r,i,s,a,o,l,c,h,g,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new kx(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Ev.NO_ERROR,l=s.getStatus();if(!o||yre(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Ev.ABORT;r(!1,new kx(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new kx(c,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());mre(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=are();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?b9():lre();a(l)}else{const l=ore();a(l)}};this.canceled_?t(!1,new kx(!1,null,!0)):this.backoffId_=fre(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&gre(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class kx{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function _re(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function vre(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function wre(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Ere(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Sre(n,e,t,r,i,s,a=!0,o=!1){const l=pre(n.urlParams),c=n.url+l,h=Object.assign({},n.headers);return wre(h,e),_re(h,t),vre(h,s),Ere(h,r),new xre(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function Tre(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function bre(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Sv{constructor(e,t){this._service=e,t instanceof po?this._location=t:this._location=po.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Sv(e,t)}get root(){const e=new po(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bre(this._location.path)}get storage(){return this._service}get parent(){const e=Tre(this._location.path);if(e===null)return null;const t=new po(this._location.bucket,e);return new Sv(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw hre(e)}}function f3(n,e){const t=e?.[rre];return t==null?null:po.makeFromBucketSpec(t,n)}function Are(n,e,t,r={}){n.host=`${e}:${t}`;const i=Pd(e);i&&($R(`https://${n.host}/b`),WR("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:y6(s,n.app.options.projectId))}class Rre{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=T9,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ire,this._maxUploadRetryTime=sre,this._requests=new Set,i!=null?this._bucket=po.makeFromBucketSpec(i,this._host):this._bucket=f3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=po.makeFromBucketSpec(this._url,e):this._bucket=f3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){d3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){d3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ua(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Sv(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new dre(b9());{const a=Sre(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const g3="@firebase/storage",m3="0.14.0";const A9="storage";function Ire(n=XR(),e){n=Pi(n);const r=Dw(n,A9).getImmediate({identifier:e}),i=g6("storage");return i&&Cre(r,...i),r}function Cre(n,e,t,r={}){Are(n,e,t,r)}function kre(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Rre(t,r,i,e,Md)}function Pre(){ud(new ku(A9,kre,"PUBLIC").setMultipleInstances(!0)),nl(g3,m3,""),nl(g3,m3,"esm2020")}Pre();const Mre={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},HI=T6(Mre),zh=gJ(HI),mu=Lne(HI);Ire(HI);One(mu).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const Nre={};function Lre(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const $p=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return $p(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return $p(r)(t)}}}},Ore=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,T)=>({...T,...w}),...e},a=!1;const o=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=$p(s.serialize),g=()=>{const w=s.partialize({...r()});let T;const b=h({state:w,version:s.version}).then(A=>c.setItem(s.name,A)).catch(A=>{T=A});if(T)throw T;return b},m=i.setState;i.setState=(w,T)=>{m(w,T),g()};const y=n((...w)=>{t(...w),g()},r,i);let v;const x=()=>{var w;if(!c)return;a=!1,o.forEach(b=>b(r()));const T=((w=s.onRehydrateStorage)==null?void 0:w.call(s,r()))||void 0;return $p(c.getItem.bind(c))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var A;return v=s.merge(b,(A=r())!=null?A:y),t(v,!0),g()}).then(()=>{T?.(v,void 0),a=!0,l.forEach(b=>b(v))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(c=w.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},x(),v||y},Dre=(n,e)=>(t,r,i)=>{let s={storage:Lre(()=>localStorage),partialize:x=>x,version:0,merge:(x,w)=>({...w,...x}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},r,i);const h=()=>{const x=s.partialize({...r()});return c.setItem(s.name,{state:x,version:s.version})},g=i.setState;i.setState=(x,w)=>{g(x,w),h()};const m=n((...x)=>{t(...x),h()},r,i);i.getInitialState=()=>m;let y;const v=()=>{var x,w;if(!c)return;a=!1,o.forEach(b=>{var A;return b((A=r())!=null?A:m)});const T=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(x=r())!=null?x:m))||void 0;return $p(c.getItem.bind(c))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var A;const[M,O]=b;if(y=s.merge(O,(A=r())!=null?A:m),t(y,!0),M)return h()}).then(()=>{T?.(y,void 0),y=r(),a=!0,l.forEach(b=>b(y))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(c=x.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||v(),y||m},Fre=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Nre?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Ore(n,e)):Dre(n,e),xc=Fre,sr=bs()(xc(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e}),setVoiceFeedbackEnabled:e=>n({voiceFeedbackEnabled:e}),setShowStepCounter:e=>n({showStepCounter:e}),setShowFontSliders:e=>n({showFontSliders:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),Qh=bs()(og((n,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},setAccessToken:t=>{n(r=>{r.accessToken=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new ho;await MN(zh,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},connectGoogleFit:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new ho;t.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await MN(zh,t),i=ho.credentialFromResult(r);return i?.accessToken?(n(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(n(s=>{s.loading=!1}),!1)}catch(t){return console.error("Google Fit connect error:",t),n(r=>{r.error=t.message,r.loading=!1}),!1}},logout:async()=>{n(t=>{t.loading=!0});try{await X6(zh),n(t=>{t.accessToken=null})}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),K6(zh,t=>{n(r=>{r.user=t,r.loading=!1}),t&&sr.getState().setVondstenLocalOnly(!1)}))}})));bs()(og((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=Kne(r3(mu,"vondsten"),Xne("userId","==",t)),s=(await Qne(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await tre(r3(mu,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=x0(mu,"vondsten",t);await Jne(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await ere(x0(mu,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const cT=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],p3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],R9=bs()(xc((n,e)=>({presets:[...cT],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=Ai.getState();p3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=Ai.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&p3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...cT]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...cT]}:n})),y3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],G1=bs()(xc((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=y3[i%y3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),jre=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],KI=bs()(xc((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||jre.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1})),XI=bs()(xc(n=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>n({parkingLocation:e}),clearParkingLocation:()=>n({parkingLocation:null}),setShowParkingButton:e=>n({showParkingButton:e})}),{name:"detectorapp-parking"}));function x3(){return new Date().toISOString().split("T")[0]}const Vre=bs()(xc((n,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:x3(),stepLength:.75,incrementStep:()=>{const t=e(),r=x3(),i=t.todayDate===r?t.todaySteps+1:1;n({steps:t.steps+1,distance:(t.steps+1)*t.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{n({steps:0,distance:0,startTime:null})},setActive:t=>{n({isActive:t,startTime:t?Date.now():e().startTime})},setStepLength:t=>{const r=e();n({stepLength:t,distance:r.steps*t})}}),{name:"step-counter-storage",partialize:n=>({todaySteps:n.todaySteps,todayDate:n.todayDate,stepLength:n.stepLength})}));let _3=0,v3=0,uT=!1;const w3=1.2,Bre=250,E3=.8;function Gre(n){const e=Math.sqrt(n.x**2+n.y**2+n.z**2),t=E3*v3+(1-E3)*e;v3=t;const r=Date.now(),i=r-_3;return t>w3&&!uT&&i>Bre?(uT=!0,_3=r,!0):(t<w3*.8&&(uT=!1),!1)}async function zre(){if(typeof DeviceMotionEvent>"u")return console.warn("DeviceMotion not supported"),!1;if(typeof DeviceMotionEvent.requestPermission=="function")try{return await DeviceMotionEvent.requestPermission()==="granted"}catch(n){return console.error("DeviceMotion permission denied:",n),!1}return!0}function Ure({target:n,viewOptions:e}){const t=X.useRef(null),r=X.useRef(null),i=Hr(a=>a.setMap),s=sr(a=>a.showScaleBar);return X.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new cq({target:n,controls:[],view:new Yo({center:fr(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),X.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new dq({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const S3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function $re(){const n=X.useRef(null),e=X.useRef(!1);Ure({target:"map"});const t=Hr(g=>g.map),r=Ai(g=>g.registerLayer),i=Ai(g=>g.setLayerVisibility),s=sr(g=>g.defaultBackground);X.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const g=new Eh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new IX}),m=new Eh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new zf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new Eh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new zf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),v=new Eh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new zf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),x=new Eh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new zf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),w=new Eh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new zf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(g),t.addLayer(m),t.addLayer(y),t.addLayer(v),t.addLayer(x),t.addLayer(w),console.log(" Base layers added:",{osm:g.getVisible(),cartodb:m.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",g),r("CartoDB (licht)",m),r("Luchtfoto",y),r("Labels Overlay",v),r("TMK 1850",x),r("Bonnebladen 1900",w),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const g=Vq();console.log(` Loading ${g.length} immediate-load layers (WMS/Tile)...`);const m=await Promise.allSettled(g.map(async v=>{try{const x=await v.factory();return x?{name:v.name,layer:x}:null}catch(x){return console.warn(` Failed to create ${v.name}:`,x),null}}));let y=0;m.forEach(v=>{if(v.status==="fulfilled"&&v.value){const{name:x,layer:w}=v.value;t.addLayer(w),r(x,w),y++,console.log(`   ${x}`)}}),console.log(` Immediate layers loaded: ${y}/${g.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}X.useEffect(()=>{if(!t||e.current)return;const g=setTimeout(()=>{const m=s||"CartoDB (licht)";S3.forEach(y=>{i(y,!1)}),S3.includes(m)?i(m,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${m}`)},100);return()=>clearTimeout(g)},[t,s,i]);const o=sr(g=>g.gpsAutoStart),l=as(g=>g.startTracking),c=X.useRef(!1);X.useEffect(()=>{if(!(!t||c.current)&&o){const g=setTimeout(()=>{l(),c.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(g)}},[t,o,l]);const h={width:"100%",height:"100vh"};return f.jsx("div",{id:"map",ref:n,style:h})}const qI=X.createContext({});function YI(n){const e=X.useRef(null);return e.current===null&&(e.current=n()),e.current}const dE=X.createContext(null),ZI=X.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class Wre extends X.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Hre({children:n,isPresent:e}){const t=X.useId(),r=X.useRef(null),i=X.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=X.useContext(ZI);return X.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),f.jsx(Wre,{isPresent:e,childRef:r,sizeRef:i,children:X.cloneElement(n,{ref:r})})}const Kre=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=YI(Xre),l=X.useId(),c=X.useCallback(g=>{o.set(g,!0);for(const m of o.values())if(!m)return;r&&r()},[o,r]),h=X.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:c,register:g=>(o.set(g,!1),()=>o.delete(g))}),s?[Math.random(),c]:[t,c]);return X.useMemo(()=>{o.forEach((g,m)=>o.set(m,!1))},[t]),X.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=f.jsx(Hre,{isPresent:t,children:n})),f.jsx(dE.Provider,{value:h,children:n})};function Xre(){return new Map}function I9(n=!0){const e=X.useContext(dE);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=X.useId();X.useEffect(()=>{n&&i(s)},[n]);const a=X.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const Px=n=>n.key||"";function T3(n){const e=[];return X.Children.forEach(n,t=>{X.isValidElement(t)&&e.push(t)}),e}const QI=typeof window<"u",C9=QI?X.useLayoutEffect:X.useEffect,kn=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=I9(a),c=X.useMemo(()=>T3(n),[n]),h=a&&!o?[]:c.map(Px),g=X.useRef(!0),m=X.useRef(c),y=YI(()=>new Map),[v,x]=X.useState(c),[w,T]=X.useState(c);C9(()=>{g.current=!1,m.current=c;for(let M=0;M<w.length;M++){const O=Px(w[M]);h.includes(O)?y.delete(O):y.get(O)!==!0&&y.set(O,!1)}},[w,h.length,h.join("-")]);const b=[];if(c!==v){let M=[...c];for(let O=0;O<w.length;O++){const z=w[O],I=Px(z);h.includes(I)||(M.splice(O,0,z),b.push(z))}s==="wait"&&b.length&&(M=b),T(T3(M)),x(c);return}const{forceRender:A}=X.useContext(qI);return f.jsx(f.Fragment,{children:w.map(M=>{const O=Px(M),z=a&&!o?!1:c===w||h.includes(O),I=()=>{if(y.has(O))y.set(O,!0);else return;let R=!0;y.forEach(P=>{P||(R=!1)}),R&&(A?.(),T(m.current),a&&l?.(),r&&r())};return f.jsx(Kre,{isPresent:z,initial:!g.current||t?void 0:!1,custom:z?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:z?void 0:I,children:M},O)})})},fa=n=>n;let k9=fa;function JI(n){let e;return()=>(e===void 0&&(e=n()),e)}const q0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Jl=n=>n*1e3,ec=n=>n/1e3,qre={useManualTiming:!1};function Yre(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(c){s.has(c)&&(l.schedule(c),n()),c(a)}const l={schedule:(c,h=!1,g=!1)=>{const y=g&&r?e:t;return h&&s.add(c),y.has(c)||y.add(c),c},cancel:c=>{t.delete(c),s.delete(c)},process:c=>{if(a=c,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const Mx=["read","resolveKeyframes","update","preRender","render","postRender"],Zre=40;function P9(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=Mx.reduce((T,b)=>(T[b]=Yre(s),T),{}),{read:o,resolveKeyframes:l,update:c,preRender:h,render:g,postRender:m}=a,y=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,Zre),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),h.process(i),g.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},v=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:Mx.reduce((T,b)=>{const A=a[b];return T[b]=(M,O=!1,z=!1)=>(t||v(),A.schedule(M,O,z)),T},{}),cancel:T=>{for(let b=0;b<Mx.length;b++)a[Mx[b]].cancel(T)},state:i,steps:a}}const{schedule:pr,cancel:Du,state:Vi,steps:hT}=P9(typeof requestAnimationFrame<"u"?requestAnimationFrame:fa,!0),M9=X.createContext({strict:!1}),b3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Y0={};for(const n in b3)Y0[n]={isEnabled:e=>b3[n].some(t=>!!e[t])};function Qre(n){for(const e in n)Y0[e]={...Y0[e],...n[e]}}const Jre=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Tv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Jre.has(n)}let N9=n=>!Tv(n);function eie(n){n&&(N9=e=>e.startsWith("on")?!Tv(e):n(e))}try{eie(require("@emotion/is-prop-valid").default)}catch{}function tie(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(N9(i)||t===!0&&Tv(i)||!e&&!Tv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function nie(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const fE=X.createContext({});function Wp(n){return typeof n=="string"||Array.isArray(n)}function gE(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const eC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],tC=["initial",...eC];function mE(n){return gE(n.animate)||tC.some(e=>Wp(n[e]))}function L9(n){return!!(mE(n)||n.variants)}function rie(n,e){if(mE(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Wp(t)?t:void 0,animate:Wp(r)?r:void 0}}return n.inherit!==!1?e:{}}function iie(n){const{initial:e,animate:t}=rie(n,X.useContext(fE));return X.useMemo(()=>({initial:e,animate:t}),[A3(e),A3(t)])}function A3(n){return Array.isArray(n)?n.join(" "):n}const sie=Symbol.for("motionComponentSymbol");function t0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function aie(n,e,t){return X.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):t0(t)&&(t.current=r))},[e])}const nC=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),oie="framerAppearId",O9="data-"+nC(oie),{schedule:rC}=P9(queueMicrotask,!1),D9=X.createContext({});function lie(n,e,t,r,i){var s,a;const{visualElement:o}=X.useContext(fE),l=X.useContext(M9),c=X.useContext(dE),h=X.useContext(ZI).reducedMotion,g=X.useRef(null);r=r||l.renderer,!g.current&&r&&(g.current=r(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const m=g.current,y=X.useContext(D9);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&cie(g.current,t,i,y);const v=X.useRef(!1);X.useInsertionEffect(()=>{m&&v.current&&m.update(t,c)});const x=t[O9],w=X.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,x)));return C9(()=>{m&&(v.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),rC.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),X.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,x)}),w.current=!1))}),m}function cie(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:F9(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&t0(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function F9(n){if(n)return n.options.allowProjection!==!1?n.projection:F9(n.parent)}function uie({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&Qre(n);function o(c,h){let g;const m={...X.useContext(ZI),...c,layoutId:hie(c)},{isStatic:y}=m,v=iie(c),x=r(c,y);if(!y&&QI){die();const w=fie(m);g=w.MeasureLayout,v.visualElement=lie(i,x,m,e,w.ProjectionNode)}return f.jsxs(fE.Provider,{value:v,children:[g&&v.visualElement?f.jsx(g,{visualElement:v.visualElement,...m}):null,t(i,c,aie(x,v.visualElement,h),x,y,v.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=X.forwardRef(o);return l[sie]=i,l}function hie({layoutId:n}){const e=X.useContext(qI).id;return e&&n!==void 0?e+"-"+n:n}function die(n,e){X.useContext(M9).strict}function fie(n){const{drag:e,layout:t}=Y0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const gie=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function iC(n){return typeof n!="string"||n.includes("-")?!1:!!(gie.indexOf(n)>-1||/[A-Z]/u.test(n))}function R3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function sC(n,e,t,r){if(typeof e=="function"){const[i,s]=R3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=R3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const iA=n=>Array.isArray(n),mie=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),pie=n=>iA(n)?n[n.length-1]||0:n,cs=n=>!!(n&&n.getVelocity);function p_(n){const e=cs(n)?n.get():n;return mie(e)?e.toValue():e}function yie({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:xie(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const j9=n=>(e,t)=>{const r=X.useContext(fE),i=X.useContext(dE),s=()=>yie(n,e,r,i);return t?s():YI(s)};function xie(n,e,t,r){const i={},s=r(n,{});for(const m in s)i[m]=p_(s[m]);let{initial:a,animate:o}=n;const l=mE(n),c=L9(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const g=h?o:a;if(g&&typeof g!="boolean"&&!gE(g)){const m=Array.isArray(g)?g:[g];for(let y=0;y<m.length;y++){const v=sC(n,m[y]);if(v){const{transitionEnd:x,transition:w,...T}=v;for(const b in T){let A=T[b];if(Array.isArray(A)){const M=h?A.length-1:0;A=A[M]}A!==null&&(i[b]=A)}for(const b in x)i[b]=x[b]}}}return i}const fg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Od=new Set(fg),V9=n=>e=>typeof e=="string"&&e.startsWith(n),B9=V9("--"),_ie=V9("var(--"),aC=n=>_ie(n)?vie.test(n.split("/*")[0].trim()):!1,vie=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,G9=(n,e)=>e&&typeof n=="number"?e.transform(n):n,cc=(n,e,t)=>t>e?e:t<n?n:t,gg={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Hp={...gg,transform:n=>cc(0,1,n)},Nx={...gg,default:1},z1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),tu=z1("deg"),ol=z1("%"),Ut=z1("px"),wie=z1("vh"),Eie=z1("vw"),I3={...ol,parse:n=>ol.parse(n)/100,transform:n=>ol.transform(n*100)},Sie={borderWidth:Ut,borderTopWidth:Ut,borderRightWidth:Ut,borderBottomWidth:Ut,borderLeftWidth:Ut,borderRadius:Ut,radius:Ut,borderTopLeftRadius:Ut,borderTopRightRadius:Ut,borderBottomRightRadius:Ut,borderBottomLeftRadius:Ut,width:Ut,maxWidth:Ut,height:Ut,maxHeight:Ut,top:Ut,right:Ut,bottom:Ut,left:Ut,padding:Ut,paddingTop:Ut,paddingRight:Ut,paddingBottom:Ut,paddingLeft:Ut,margin:Ut,marginTop:Ut,marginRight:Ut,marginBottom:Ut,marginLeft:Ut,backgroundPositionX:Ut,backgroundPositionY:Ut},Tie={rotate:tu,rotateX:tu,rotateY:tu,rotateZ:tu,scale:Nx,scaleX:Nx,scaleY:Nx,scaleZ:Nx,skew:tu,skewX:tu,skewY:tu,distance:Ut,translateX:Ut,translateY:Ut,translateZ:Ut,x:Ut,y:Ut,z:Ut,perspective:Ut,transformPerspective:Ut,opacity:Hp,originX:I3,originY:I3,originZ:Ut},C3={...gg,transform:Math.round},oC={...Sie,...Tie,zIndex:C3,size:Ut,fillOpacity:Hp,strokeOpacity:Hp,numOctaves:C3},bie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Aie=fg.length;function Rie(n,e,t){let r="",i=!0;for(let s=0;s<Aie;s++){const a=fg[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=G9(o,oC[a]);if(!l){i=!1;const h=bie[a]||a;r+=`${h}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function lC(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(Od.has(l)){a=!0;continue}else if(B9(l)){i[l]=c;continue}else{const h=G9(c,oC[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=Rie(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${c} ${h}`}}const Iie={offset:"stroke-dashoffset",array:"stroke-dasharray"},Cie={offset:"strokeDashoffset",array:"strokeDasharray"};function kie(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Iie:Cie;n[s.offset]=Ut.transform(-r);const a=Ut.transform(e),o=Ut.transform(t);n[s.array]=`${a} ${o}`}function k3(n,e,t){return typeof n=="string"?n:Ut.transform(e+t*n)}function Pie(n,e,t){const r=k3(e,n.x,n.width),i=k3(t,n.y,n.height);return`${r} ${i}`}function cC(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},h,g){if(lC(n,c,g),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:v}=n;m.transform&&(v&&(y.transform=m.transform),delete m.transform),v&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=Pie(v,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),a!==void 0&&kie(m,a,o,l,!1)}const uC=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),z9=()=>({...uC(),attrs:{}}),hC=n=>typeof n=="string"&&n.toLowerCase()==="svg";function U9(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const $9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function W9(n,e,t,r){U9(n,e,void 0,r);for(const i in e.attrs)n.setAttribute($9.has(i)?i:nC(i),e.attrs[i])}const bv={};function Mie(n){Object.assign(bv,n)}function H9(n,{layout:e,layoutId:t}){return Od.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!bv[n]||n==="opacity")}function dC(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(cs(i[a])||e.style&&cs(e.style[a])||H9(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function K9(n,e,t){const r=dC(n,e,t);for(const i in n)if(cs(n[i])||cs(e[i])){const s=fg.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function Nie(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const P3=["x","y","width","height","cx","cy","r"],Lie={useVisualState:j9({scrapeMotionValuesFromProps:K9,createRenderState:z9,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(Od.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<P3.length;o++){const l=P3[o];n[l]!==e[l]&&(a=!0)}a&&pr.read(()=>{Nie(t,r),pr.render(()=>{cC(r,i,hC(t.tagName),n.transformTemplate),W9(t,r)})})}})},Oie={useVisualState:j9({scrapeMotionValuesFromProps:dC,createRenderState:uC})};function X9(n,e,t){for(const r in e)!cs(e[r])&&!H9(r,t)&&(n[r]=e[r])}function Die({transformTemplate:n},e){return X.useMemo(()=>{const t=uC();return lC(t,e,n),Object.assign({},t.vars,t.style)},[e])}function Fie(n,e){const t=n.style||{},r={};return X9(r,t,n),Object.assign(r,Die(n,e)),r}function jie(n,e){const t={},r=Fie(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function Vie(n,e,t,r){const i=X.useMemo(()=>{const s=z9();return cC(s,e,hC(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};X9(s,n.style,n),i.style={...s,...i.style}}return i}function Bie(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(iC(t)?Vie:jie)(r,s,a,t),c=tie(r,typeof t=="string",n),h=t!==X.Fragment?{...c,...l,ref:i}:{},{children:g}=r,m=X.useMemo(()=>cs(g)?g.get():g,[g]);return X.createElement(t,{...h,children:m})}}function Gie(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...iC(r)?Lie:Oie,preloadedFeatures:n,useRender:Bie(i),createVisualElement:e,Component:r};return uie(a)}}function q9(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function pE(n,e,t){const r=n.getProps();return sC(r,e,t!==void 0?t:r.custom,n)}const zie=JI(()=>window.ScrollTimeline!==void 0);class Uie{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(zie()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class $ie extends Uie{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function fC(n,e){return n?n[e]||n.default||n:void 0}const sA=2e4;function Y9(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<sA;)e+=t,r=n.next(e);return e>=sA?1/0:e}function gC(n){return typeof n=="function"}function M3(n,e){n.timeline=e,n.onfinish=null}const mC=n=>Array.isArray(n)&&typeof n[0]=="number",Wie={linearEasing:void 0};function Hie(n,e){const t=JI(n);return()=>{var r;return(r=Wie[e])!==null&&r!==void 0?r:t()}}const Av=Hie(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Z9=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(q0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function Q9(n){return!!(typeof n=="function"&&Av()||!n||typeof n=="string"&&(n in aA||Av())||mC(n)||Array.isArray(n)&&n.every(Q9))}const Im=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,aA={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Im([0,.65,.55,1]),circOut:Im([.55,0,1,.45]),backIn:Im([.31,.01,.66,-.59]),backOut:Im([.33,1.53,.69,.99])};function J9(n,e){if(n)return typeof n=="function"&&Av()?Z9(n,e):mC(n)?Im(n):Array.isArray(n)?n.map(t=>J9(t,e)||aA.easeOut):aA[n]}const ao={x:!1,y:!1};function e7(){return ao.x||ao.y}function Kie(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function t7(n,e){const t=Kie(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function N3(n){return e=>{e.pointerType==="touch"||e7()||n(e)}}function Xie(n,e,t={}){const[r,i,s]=t7(n,t),a=N3(o=>{const{target:l}=o,c=e(o);if(typeof c!="function"||!l)return;const h=N3(g=>{c(g),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const n7=(n,e)=>e?n===e?!0:n7(n,e.parentElement):!1,pC=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,qie=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Yie(n){return qie.has(n.tagName)||n.tabIndex!==-1}const Cm=new WeakSet;function L3(n){return e=>{e.key==="Enter"&&n(e)}}function dT(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Zie=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=L3(()=>{if(Cm.has(t))return;dT(t,"down");const i=L3(()=>{dT(t,"up")}),s=()=>dT(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function O3(n){return pC(n)&&!e7()}function Qie(n,e,t={}){const[r,i,s]=t7(n,t),a=o=>{const l=o.currentTarget;if(!O3(o)||Cm.has(l))return;Cm.add(l);const c=e(o),h=(y,v)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!O3(y)||!Cm.has(l))&&(Cm.delete(l),typeof c=="function"&&c(y,{success:v}))},g=y=>{h(y,t.useGlobalTarget||n7(l,y.target))},m=y=>{h(y,!1)};window.addEventListener("pointerup",g,i),window.addEventListener("pointercancel",m,i)};return r.forEach(o=>{!Yie(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",c=>Zie(c,i),i)}),s}function Jie(n){return n==="x"||n==="y"?ao[n]?null:(ao[n]=!0,()=>{ao[n]=!1}):ao.x||ao.y?null:(ao.x=ao.y=!0,()=>{ao.x=ao.y=!1})}const r7=new Set(["width","height","top","left","right","bottom",...fg]);let y_;function ese(){y_=void 0}const ll={now:()=>(y_===void 0&&ll.set(Vi.isProcessing||qre.useManualTiming?Vi.timestamp:performance.now()),y_),set:n=>{y_=n,queueMicrotask(ese)}};function yC(n,e){n.indexOf(e)===-1&&n.push(e)}function xC(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class _C{constructor(){this.subscriptions=[]}add(e){return yC(this.subscriptions,e),()=>xC(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function i7(n,e){return e?n*(1e3/e):0}const D3=30,tse=n=>!isNaN(parseFloat(n));class nse{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=ll.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ll.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=tse(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new _C);const r=this.events[e].add(t);return e==="change"?()=>{r(),pr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ll.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>D3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,D3);return i7(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Kp(n,e){return new nse(n,e)}function rse(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Kp(t))}function ise(n,e){const t=pE(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=pie(s[a]);rse(n,a,o)}}function sse(n){return!!(cs(n)&&n.add)}function oA(n,e){const t=n.getValue("willChange");if(sse(t))return t.add(e)}function s7(n){return n.props[O9]}const a7=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,ase=1e-7,ose=12;function lse(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=a7(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>ase&&++o<ose);return a}function U1(n,e,t,r){if(n===e&&t===r)return fa;const i=s=>lse(s,0,1,n,t);return s=>s===0||s===1?s:a7(i(s),e,r)}const o7=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,l7=n=>e=>1-n(1-e),c7=U1(.33,1.53,.69,.99),vC=l7(c7),u7=o7(vC),h7=n=>(n*=2)<1?.5*vC(n):.5*(2-Math.pow(2,-10*(n-1))),wC=n=>1-Math.sin(Math.acos(n)),d7=l7(wC),f7=o7(wC),g7=n=>/^0[^.\s]+$/u.test(n);function cse(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||g7(n):!0}const Xm=n=>Math.round(n*1e5)/1e5,EC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function use(n){return n==null}const hse=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,SC=(n,e)=>t=>!!(typeof t=="string"&&hse.test(t)&&t.startsWith(n)||e&&!use(t)&&Object.prototype.hasOwnProperty.call(t,e)),m7=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(EC);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},dse=n=>cc(0,255,n),fT={...gg,transform:n=>Math.round(dse(n))},Uh={test:SC("rgb","red"),parse:m7("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+fT.transform(n)+", "+fT.transform(e)+", "+fT.transform(t)+", "+Xm(Hp.transform(r))+")"};function fse(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const lA={test:SC("#"),parse:fse,transform:Uh.transform},n0={test:SC("hsl","hue"),parse:m7("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+ol.transform(Xm(e))+", "+ol.transform(Xm(t))+", "+Xm(Hp.transform(r))+")"},rs={test:n=>Uh.test(n)||lA.test(n)||n0.test(n),parse:n=>Uh.test(n)?Uh.parse(n):n0.test(n)?n0.parse(n):lA.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Uh.transform(n):n0.transform(n)},gse=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function mse(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(EC))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(gse))===null||t===void 0?void 0:t.length)||0)>0}const p7="number",y7="color",pse="var",yse="var(",F3="${}",xse=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Xp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(xse,l=>(rs.test(l)?(r.color.push(s),i.push(y7),t.push(rs.parse(l))):l.startsWith(yse)?(r.var.push(s),i.push(pse),t.push(l)):(r.number.push(s),i.push(p7),t.push(parseFloat(l))),++s,F3)).split(F3);return{values:t,split:o,indexes:r,types:i}}function x7(n){return Xp(n).values}function _7(n){const{split:e,types:t}=Xp(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===p7?s+=Xm(i[a]):o===y7?s+=rs.transform(i[a]):s+=i[a]}return s}}const _se=n=>typeof n=="number"?0:n;function vse(n){const e=x7(n);return _7(n)(e.map(_se))}const Fu={test:mse,parse:x7,createTransformer:_7,getAnimatableNone:vse},wse=new Set(["brightness","contrast","saturate","opacity"]);function Ese(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(EC)||[];if(!r)return n;const i=t.replace(r,"");let s=wse.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const Sse=/\b([a-z-]*)\(.*?\)/gu,cA={...Fu,getAnimatableNone:n=>{const e=n.match(Sse);return e?e.map(Ese).join(" "):n}},Tse={...oC,color:rs,backgroundColor:rs,outlineColor:rs,fill:rs,stroke:rs,borderColor:rs,borderTopColor:rs,borderRightColor:rs,borderBottomColor:rs,borderLeftColor:rs,filter:cA,WebkitFilter:cA},TC=n=>Tse[n];function v7(n,e){let t=TC(n);return t!==cA&&(t=Fu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const bse=new Set(["auto","none","0"]);function Ase(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!bse.has(s)&&Xp(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=v7(t,i)}const j3=n=>n===gg||n===Ut,V3=(n,e)=>parseFloat(n.split(", ")[e]),B3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return V3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?V3(s[1],n):0}},Rse=new Set(["x","y","z"]),Ise=fg.filter(n=>!Rse.has(n));function Cse(n){const e=[];return Ise.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const Z0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:B3(4,13),y:B3(5,14)};Z0.translateX=Z0.x;Z0.translateY=Z0.y;const Jh=new Set;let uA=!1,hA=!1;function w7(){if(hA){const n=Array.from(Jh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=Cse(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}hA=!1,uA=!1,Jh.forEach(n=>n.complete()),Jh.clear()}function E7(){Jh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(hA=!0)})}function kse(){E7(),w7()}class bC{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Jh.add(this),uA||(uA=!0,pr.read(E7),pr.resolveKeyframes(w7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Jh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Jh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const S7=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Pse=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Mse(n){const e=Pse.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function T7(n,e,t=1){const[r,i]=Mse(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return S7(a)?parseFloat(a):a}return aC(i)?T7(i,e,t+1):i}const b7=n=>e=>e.test(n),Nse={test:n=>n==="auto",parse:n=>n},A7=[gg,Ut,ol,tu,Eie,wie,Nse],G3=n=>A7.find(b7(n));class R7 extends bC{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),aC(c))){const h=T7(c,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!r7.has(r)||e.length!==2)return;const[i,s]=e,a=G3(i),o=G3(s);if(a!==o)if(j3(a)&&j3(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)cse(e[i])&&r.push(i);r.length&&Ase(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Z0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=Z0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const z3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Fu.test(n)||n==="0")&&!n.startsWith("url("));function Lse(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Ose(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=z3(i,e),o=z3(s,e);return!a||!o?!1:Lse(n)||(t==="spring"||gC(t))&&r}const Dse=n=>n!==null;function yE(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(Dse),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const Fse=40;class I7{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ll.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Fse?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&kse(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ll.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Ose(e,r,i,s))if(a)this.options.duration=0;else{l&&l(yE(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Pr=(n,e,t)=>n+(e-n)*t;function gT(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function jse({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=gT(l,o,n+1/3),s=gT(l,o,n),a=gT(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Rv(n,e){return t=>t>0?e:n}const mT=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Vse=[lA,Uh,n0],Bse=n=>Vse.find(e=>e.test(n));function U3(n){const e=Bse(n);if(!e)return!1;let t=e.parse(n);return e===n0&&(t=jse(t)),t}const $3=(n,e)=>{const t=U3(n),r=U3(e);if(!t||!r)return Rv(n,e);const i={...t};return s=>(i.red=mT(t.red,r.red,s),i.green=mT(t.green,r.green,s),i.blue=mT(t.blue,r.blue,s),i.alpha=Pr(t.alpha,r.alpha,s),Uh.transform(i))},Gse=(n,e)=>t=>e(n(t)),$1=(...n)=>n.reduce(Gse),dA=new Set(["none","hidden"]);function zse(n,e){return dA.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Use(n,e){return t=>Pr(n,e,t)}function AC(n){return typeof n=="number"?Use:typeof n=="string"?aC(n)?Rv:rs.test(n)?$3:Hse:Array.isArray(n)?C7:typeof n=="object"?rs.test(n)?$3:$se:Rv}function C7(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>AC(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function $se(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=AC(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Wse(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const Hse=(n,e)=>{const t=Fu.createTransformer(e),r=Xp(n),i=Xp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?dA.has(n)&&!i.values.length||dA.has(e)&&!r.values.length?zse(n,e):$1(C7(Wse(r,i),i.values),t):Rv(n,e)};function k7(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Pr(n,e,t):AC(n)(n,e)}const Kse=5;function P7(n,e,t){const r=Math.max(e-Kse,0);return i7(t-n(r),e-r)}const Or={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},pT=.001;function Xse({duration:n=Or.duration,bounce:e=Or.bounce,velocity:t=Or.velocity,mass:r=Or.mass}){let i,s,a=1-e;a=cc(Or.minDamping,Or.maxDamping,a),n=cc(Or.minDuration,Or.maxDuration,ec(n)),a<1?(i=c=>{const h=c*a,g=h*n,m=h-t,y=fA(c,a),v=Math.exp(-g);return pT-m/y*v},s=c=>{const g=c*a*n,m=g*t+t,y=Math.pow(a,2)*Math.pow(c,2)*n,v=Math.exp(-g),x=fA(Math.pow(c,2),a);return(-i(c)+pT>0?-1:1)*((m-y)*v)/x}):(i=c=>{const h=Math.exp(-c*n),g=(c-t)*n+1;return-pT+h*g},s=c=>{const h=Math.exp(-c*n),g=(t-c)*(n*n);return h*g});const o=5/n,l=Yse(i,s,o);if(n=Jl(n),isNaN(l))return{stiffness:Or.stiffness,damping:Or.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const qse=12;function Yse(n,e,t){let r=t;for(let i=1;i<qse;i++)r=r-n(r)/e(r);return r}function fA(n,e){return n*Math.sqrt(1-e*e)}const Zse=["duration","bounce"],Qse=["stiffness","damping","mass"];function W3(n,e){return e.some(t=>n[t]!==void 0)}function Jse(n){let e={velocity:Or.velocity,stiffness:Or.stiffness,damping:Or.damping,mass:Or.mass,isResolvedFromDuration:!1,...n};if(!W3(n,Qse)&&W3(n,Zse))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*cc(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Or.mass,stiffness:i,damping:s}}else{const t=Xse(n);e={...e,...t,mass:Or.mass},e.isResolvedFromDuration=!0}return e}function M7(n=Or.visualDuration,e=Or.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:h,duration:g,velocity:m,isResolvedFromDuration:y}=Jse({...t,velocity:-ec(t.velocity||0)}),v=m||0,x=c/(2*Math.sqrt(l*h)),w=a-s,T=ec(Math.sqrt(l/h)),b=Math.abs(w)<5;r||(r=b?Or.restSpeed.granular:Or.restSpeed.default),i||(i=b?Or.restDelta.granular:Or.restDelta.default);let A;if(x<1){const O=fA(T,x);A=z=>{const I=Math.exp(-x*T*z);return a-I*((v+x*T*w)/O*Math.sin(O*z)+w*Math.cos(O*z))}}else if(x===1)A=O=>a-Math.exp(-T*O)*(w+(v+T*w)*O);else{const O=T*Math.sqrt(x*x-1);A=z=>{const I=Math.exp(-x*T*z),R=Math.min(O*z,300);return a-I*((v+x*T*w)*Math.sinh(R)+O*w*Math.cosh(R))/O}}const M={calculatedDuration:y&&g||null,next:O=>{const z=A(O);if(y)o.done=O>=g;else{let I=0;x<1&&(I=O===0?Jl(v):P7(A,O,z));const R=Math.abs(I)<=r,P=Math.abs(a-z)<=i;o.done=R&&P}return o.value=o.done?a:z,o},toString:()=>{const O=Math.min(Y9(M),sA),z=Z9(I=>M.next(O*I).value,O,30);return O+"ms "+z}};return M}function H3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:h}){const g=n[0],m={done:!1,value:g},y=R=>o!==void 0&&R<o||l!==void 0&&R>l,v=R=>o===void 0?l:l===void 0||Math.abs(o-R)<Math.abs(l-R)?o:l;let x=t*e;const w=g+x,T=a===void 0?w:a(w);T!==w&&(x=T-g);const b=R=>-x*Math.exp(-R/r),A=R=>T+b(R),M=R=>{const P=b(R),F=A(R);m.done=Math.abs(P)<=c,m.value=m.done?T:F};let O,z;const I=R=>{y(m.value)&&(O=R,z=M7({keyframes:[m.value,v(m.value)],velocity:P7(A,R,m.value),damping:i,stiffness:s,restDelta:c,restSpeed:h}))};return I(0),{calculatedDuration:null,next:R=>{let P=!1;return!z&&O===void 0&&(P=!0,M(R),I(R)),O!==void 0&&R>=O?z.next(R-O):(!P&&M(R),m)}}}const eae=U1(.42,0,1,1),tae=U1(0,0,.58,1),N7=U1(.42,0,.58,1),nae=n=>Array.isArray(n)&&typeof n[0]!="number",rae={linear:fa,easeIn:eae,easeInOut:N7,easeOut:tae,circIn:wC,circInOut:f7,circOut:d7,backIn:vC,backInOut:u7,backOut:c7,anticipate:h7},K3=n=>{if(mC(n)){k9(n.length===4);const[e,t,r,i]=n;return U1(e,t,r,i)}else if(typeof n=="string")return rae[n];return n};function iae(n,e,t){const r=[],i=t||k7,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||fa:e;o=$1(l,o)}r.push(o)}return r}function sae(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(k9(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=iae(e,r,i),l=o.length,c=h=>{if(a&&h<n[0])return e[0];let g=0;if(l>1)for(;g<n.length-2&&!(h<n[g+1]);g++);const m=q0(n[g],n[g+1],h);return o[g](m)};return t?h=>c(cc(n[0],n[s-1],h)):c}function aae(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=q0(0,e,r);n.push(Pr(t,1,i))}}function oae(n){const e=[0];return aae(e,n.length-1),e}function lae(n,e){return n.map(t=>t*e)}function cae(n,e){return n.map(()=>e||N7).splice(0,n.length-1)}function Iv({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=nae(r)?r.map(K3):K3(r),s={done:!1,value:e[0]},a=lae(t&&t.length===e.length?t:oae(e),n),o=sae(a,e,{ease:Array.isArray(i)?i:cae(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const uae=n=>{const e=({timestamp:t})=>n(t);return{start:()=>pr.update(e,!0),stop:()=>Du(e),now:()=>Vi.isProcessing?Vi.timestamp:ll.now()}},hae={decay:H3,inertia:H3,tween:Iv,keyframes:Iv,spring:M7},dae=n=>n/100;class RC extends I7{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||bC,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=gC(t)?t:hae[t]||Iv;let l,c;o!==Iv&&typeof e[0]!="number"&&(l=$1(dae,k7(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=Y9(h));const{calculatedDuration:g}=h,m=g+i,y=m*(r+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:g,resolvedDuration:m,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:g}=r;if(this.startTime===null)return s.next(0);const{delay:m,repeat:y,repeatType:v,repeatDelay:x,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-m*(this.speed>=0?1:-1),b=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let A=this.currentTime,M=s;if(y){const R=Math.min(this.currentTime,h)/g;let P=Math.floor(R),F=R%1;!F&&R>=1&&(F=1),F===1&&P--,P=Math.min(P,y+1),P%2&&(v==="reverse"?(F=1-F,x&&(F-=x/g)):v==="mirror"&&(M=a)),A=cc(0,1,F)*g}const O=b?{done:!1,value:l[0]}:M.next(A);o&&(O.value=o(O.value));let{done:z}=O;!b&&c!==null&&(z=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return I&&i!==void 0&&(O.value=yE(l,this.options,i)),w&&w(O.value),I&&this.finish(),O}get duration(){const{resolved:e}=this;return e?ec(e.calculatedDuration):0}get time(){return ec(this.currentTime)}set time(e){e=Jl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ec(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=uae,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const fae=new Set(["opacity","clipPath","filter","transform"]);function gae(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const h=J9(o,i);return Array.isArray(h)&&(c.easing=h),n.animate(c,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const mae=JI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Cv=10,pae=2e4;function yae(n){return gC(n.type)||n.type==="spring"||!Q9(n.ease)}function xae(n,e){const t=new RC({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<pae;)r=t.sample(s),i.push(r.value),s+=Cv;return{times:void 0,keyframes:i,duration:s-Cv,ease:"linear"}}const L7={anticipate:h7,backInOut:u7,circInOut:f7};function _ae(n){return n in L7}class X3 extends I7{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new R7(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&Av()&&_ae(s)&&(s=L7[s]),yae(this.options)){const{onComplete:g,onUpdate:m,motionValue:y,element:v,...x}=this.options,w=xae(e,x);e=w.keyframes,e.length===1&&(e[1]=e[0]),r=w.duration,i=w.times,s=w.ease,a="keyframes"}const h=gae(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(M3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:g}=this.options;o.set(yE(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return ec(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return ec(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Jl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return fa;const{animation:r}=t;M3(r,e)}return fa}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:g,element:m,...y}=this.options,v=new RC({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),x=Jl(this.time);c.setWithVelocity(v.sample(x-Cv).value,v.sample(x).value,Cv)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return mae()&&r&&fae.has(r)&&!l&&!c&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const vae={type:"spring",stiffness:500,damping:25,restSpeed:10},wae=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Eae={type:"keyframes",duration:.8},Sae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Tae=(n,{keyframes:e})=>e.length>2?Eae:Od.has(n)?n.startsWith("scale")?wae(e[1]):vae:Sae;function bae({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const IC=(n,e,t,r={},i,s)=>a=>{const o=fC(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Jl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};bae(o)||(h={...h,...Tae(n,h)}),h.duration&&(h.duration=Jl(h.duration)),h.repeatDelay&&(h.repeatDelay=Jl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let g=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=yE(h.keyframes,o);if(m!==void 0)return pr.update(()=>{h.onUpdate(m),h.onComplete()}),new $ie([])}return!s&&X3.supports(h)?new X3(h):new RC(h)};function Aae({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function O7(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const c=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const g in l){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),y=l[g];if(y===void 0||h&&Aae(h,g))continue;const v={delay:t,...fC(a||{},g)};let x=!1;if(window.MotionHandoffAnimation){const T=s7(n);if(T){const b=window.MotionHandoffAnimation(T,g,pr);b!==null&&(v.startTime=b,x=!0)}}oA(n,g),m.start(IC(g,m,y,n.shouldReduceMotion&&r7.has(g)?{type:!1}:v,n,x));const w=m.animation;w&&c.push(w)}return o&&Promise.all(c).then(()=>{pr.update(()=>{o&&ise(n,o)})}),c}function gA(n,e,t={}){var r;const i=pE(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(O7(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:g,staggerDirection:m}=s;return Rae(n,e,h+c,g,m,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,h]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function Rae(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(n.variantChildren).sort(Iae).forEach((c,h)=>{c.notify("AnimationStart",e),a.push(gA(c,e,{...s,delay:t+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(a)}function Iae(n,e){return n.sortNodePosition(e)}function Cae(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>gA(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=gA(n,e,t);else{const i=typeof e=="function"?pE(n,e,t.custom):e;r=Promise.all(O7(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const kae=tC.length;function D7(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?D7(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<kae;t++){const r=tC[t],i=n.props[r];(Wp(i)||i===!1)&&(e[r]=i)}return e}const Pae=[...eC].reverse(),Mae=eC.length;function Nae(n){return e=>Promise.all(e.map(({animation:t,options:r})=>Cae(n,t,r)))}function Lae(n){let e=Nae(n),t=q3(),r=!0;const i=l=>(c,h)=>{var g;const m=pE(n,h,l==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:y,transitionEnd:v,...x}=m;c={...c,...x,...v}}return c};function s(l){e=l(n)}function a(l){const{props:c}=n,h=D7(n.parent)||{},g=[],m=new Set;let y={},v=1/0;for(let w=0;w<Mae;w++){const T=Pae[w],b=t[T],A=c[T]!==void 0?c[T]:h[T],M=Wp(A),O=T===l?b.isActive:null;O===!1&&(v=w);let z=A===h[T]&&A!==c[T]&&M;if(z&&r&&n.manuallyAnimateOnMount&&(z=!1),b.protectedKeys={...y},!b.isActive&&O===null||!A&&!b.prevProp||gE(A)||typeof A=="boolean")continue;const I=Oae(b.prevProp,A);let R=I||T===l&&b.isActive&&!z&&M||w>v&&M,P=!1;const F=Array.isArray(A)?A:[A];let N=F.reduce(i(T),{});O===!1&&(N={});const{prevResolvedValues:B={}}=b,j={...B,...N},ve=Me=>{R=!0,m.has(Me)&&(P=!0,m.delete(Me)),b.needsAnimating[Me]=!0;const ue=n.getValue(Me);ue&&(ue.liveStyle=!1)};for(const Me in j){const ue=N[Me],Ae=B[Me];if(y.hasOwnProperty(Me))continue;let be=!1;iA(ue)&&iA(Ae)?be=!q9(ue,Ae):be=ue!==Ae,be?ue!=null?ve(Me):m.add(Me):ue!==void 0&&m.has(Me)?ve(Me):b.protectedKeys[Me]=!0}b.prevProp=A,b.prevResolvedValues=N,b.isActive&&(y={...y,...N}),r&&n.blockInitialAnimation&&(R=!1),R&&(!(z&&I)||P)&&g.push(...F.map(Me=>({animation:Me,options:{type:T}})))}if(m.size){const w={};m.forEach(T=>{const b=n.getBaseTarget(T),A=n.getValue(T);A&&(A.liveStyle=!0),w[T]=b??null}),g.push({animation:w})}let x=!!g.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(g):Promise.resolve()}function o(l,c){var h;if(t[l].isActive===c)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(l,c)}),t[l].isActive=c;const g=a(l);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=q3(),r=!0}}}function Oae(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!q9(e,n):!1}function vh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function q3(){return{animate:vh(!0),whileInView:vh(),whileHover:vh(),whileTap:vh(),whileDrag:vh(),whileFocus:vh(),exit:vh()}}class Ku{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Dae extends Ku{constructor(e){super(e),e.animationState||(e.animationState=Lae(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();gE(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Fae=0;class jae extends Ku{constructor(){super(...arguments),this.id=Fae++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Vae={animation:{Feature:Dae},exit:{Feature:jae}};function qp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function W1(n){return{point:{x:n.pageX,y:n.pageY}}}const Bae=n=>e=>pC(e)&&n(e,W1(e));function qm(n,e,t,r){return qp(n,e,Bae(t),r)}const Y3=(n,e)=>Math.abs(n-e);function Gae(n,e){const t=Y3(n.x,e.x),r=Y3(n.y,e.y);return Math.sqrt(t**2+r**2)}class F7{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=xT(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=Gae(g.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:v}=g,{timestamp:x}=Vi;this.history.push({...v,timestamp:x});const{onStart:w,onMove:T}=this.handlers;m||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=yT(m,this.transformPagePoint),pr.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:y,onSessionEnd:v,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=xT(g.type==="pointercancel"?this.lastMoveEventInfo:yT(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(g,w),v&&v(g,w)},!pC(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=W1(e),o=yT(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Vi;this.history=[{...l,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,xT(o,this.history)),this.removeListeners=$1(qm(this.contextWindow,"pointermove",this.handlePointerMove),qm(this.contextWindow,"pointerup",this.handlePointerUp),qm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Du(this.updatePoint)}}function yT(n,e){return e?{point:e(n.point)}:n}function Z3(n,e){return{x:n.x-e.x,y:n.y-e.y}}function xT({point:n},e){return{point:n,delta:Z3(n,j7(e)),offset:Z3(n,zae(e)),velocity:Uae(e,.1)}}function zae(n){return n[0]}function j7(n){return n[n.length-1]}function Uae(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=j7(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Jl(e)));)t--;if(!r)return{x:0,y:0};const s=ec(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const V7=1e-4,$ae=1-V7,Wae=1+V7,B7=.01,Hae=0-B7,Kae=0+B7;function pa(n){return n.max-n.min}function Xae(n,e,t){return Math.abs(n-e)<=t}function Q3(n,e,t,r=.5){n.origin=r,n.originPoint=Pr(e.min,e.max,n.origin),n.scale=pa(t)/pa(e),n.translate=Pr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=$ae&&n.scale<=Wae||isNaN(n.scale))&&(n.scale=1),(n.translate>=Hae&&n.translate<=Kae||isNaN(n.translate))&&(n.translate=0)}function Ym(n,e,t,r){Q3(n.x,e.x,t.x,r?r.originX:void 0),Q3(n.y,e.y,t.y,r?r.originY:void 0)}function J3(n,e,t){n.min=t.min+e.min,n.max=n.min+pa(e)}function qae(n,e,t){J3(n.x,e.x,t.x),J3(n.y,e.y,t.y)}function eO(n,e,t){n.min=e.min-t.min,n.max=n.min+pa(e)}function Zm(n,e,t){eO(n.x,e.x,t.x),eO(n.y,e.y,t.y)}function Yae(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Pr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Pr(t,n,r.max):Math.min(n,t)),n}function tO(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Zae(n,{top:e,left:t,bottom:r,right:i}){return{x:tO(n.x,t,i),y:tO(n.y,e,r)}}function nO(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function Qae(n,e){return{x:nO(n.x,e.x),y:nO(n.y,e.y)}}function Jae(n,e){let t=.5;const r=pa(n),i=pa(e);return i>r?t=q0(e.min,e.max-r,n.min):r>i&&(t=q0(n.min,n.max-i,e.min)),cc(0,1,t)}function eoe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const mA=.35;function toe(n=mA){return n===!1?n=0:n===!0&&(n=mA),{x:rO(n,"left","right"),y:rO(n,"top","bottom")}}function rO(n,e,t){return{min:iO(n,e),max:iO(n,t)}}function iO(n,e){return typeof n=="number"?n:n[e]||0}const sO=()=>({translate:0,scale:1,origin:0,originPoint:0}),r0=()=>({x:sO(),y:sO()}),aO=()=>({min:0,max:0}),Ur=()=>({x:aO(),y:aO()});function Ca(n){return[n("x"),n("y")]}function G7({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function noe({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function roe(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function _T(n){return n===void 0||n===1}function pA({scale:n,scaleX:e,scaleY:t}){return!_T(n)||!_T(e)||!_T(t)}function Rh(n){return pA(n)||z7(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function z7(n){return oO(n.x)||oO(n.y)}function oO(n){return n&&n!=="0%"}function kv(n,e,t){const r=n-t,i=e*r;return t+i}function lO(n,e,t,r,i){return i!==void 0&&(n=kv(n,i,r)),kv(n,t,r)+e}function yA(n,e=0,t=1,r,i){n.min=lO(n.min,e,t,r,i),n.max=lO(n.max,e,t,r,i)}function U7(n,{x:e,y:t}){yA(n.x,e.translate,e.scale,e.originPoint),yA(n.y,t.translate,t.scale,t.originPoint)}const cO=.999999999999,uO=1.0000000000001;function ioe(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&s0(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,U7(n,a)),r&&Rh(s.latestValues)&&s0(n,s.latestValues))}e.x<uO&&e.x>cO&&(e.x=1),e.y<uO&&e.y>cO&&(e.y=1)}function i0(n,e){n.min=n.min+e,n.max=n.max+e}function hO(n,e,t,r,i=.5){const s=Pr(n.min,n.max,i);yA(n,e,t,s,r)}function s0(n,e){hO(n.x,e.x,e.scaleX,e.scale,e.originX),hO(n.y,e.y,e.scaleY,e.scale,e.originY)}function $7(n,e){return G7(roe(n.getBoundingClientRect(),e))}function soe(n,e,t){const r=$7(n,t),{scroll:i}=e;return i&&(i0(r.x,i.offset.x),i0(r.y,i.offset.y)),r}const W7=({current:n})=>n?n.ownerDocument.defaultView:null,aoe=new WeakMap;class ooe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ur(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(W1(h).point)},s=(h,g)=>{const{drag:m,dragPropagation:y,onDragStart:v}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Jie(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ca(w=>{let T=this.getAxisMotionValue(w).get()||0;if(ol.test(T)){const{projection:b}=this.visualElement;if(b&&b.layout){const A=b.layout.layoutBox[w];A&&(T=pa(A)*(parseFloat(T)/100))}}this.originPoint[w]=T}),v&&pr.postRender(()=>v(h,g)),oA(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(h,g)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:v,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=g;if(y&&this.currentDirection===null){this.currentDirection=loe(w),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),x&&x(h,g)},o=(h,g)=>this.stop(h,g),l=()=>Ca(h=>{var g;return this.getAnimationState(h)==="paused"&&((g=this.getAxisMotionValue(h).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new F7(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:W7(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&pr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Lx(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=Yae(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&t0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Zae(i.layoutBox,t):this.constraints=!1,this.elastic=toe(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ca(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=eoe(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!t0(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=soe(r,i.root,this.visualElement.getTransformPagePoint());let a=Qae(i.layout.layoutBox,s);if(t){const o=t(noe(a));this.hasMutatedConstraints=!!o,o&&(a=G7(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ca(h=>{if(!Lx(h,t,this.currentDirection))return;let g=l&&l[h]||{};a&&(g={min:0,max:0});const m=i?200:1e6,y=i?40:1e7,v={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(h,v)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return oA(this.visualElement,e),r.start(IC(e,r,0,t,this.visualElement,!1))}stopAnimation(){Ca(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ca(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ca(t=>{const{drag:r}=this.getProps();if(!Lx(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Pr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!t0(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ca(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=Jae({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ca(a=>{if(!Lx(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Pr(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;aoe.set(this.visualElement,this);const e=this.visualElement.current,t=qm(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();t0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),pr.read(r);const a=qp(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ca(h=>{const g=this.getAxisMotionValue(h);g&&(this.originPoint[h]+=l[h].translate,g.set(g.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=mA,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Lx(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function loe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class coe extends Ku{constructor(e){super(e),this.removeGroupControls=fa,this.removeListeners=fa,this.controls=new ooe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fa}unmount(){this.removeGroupControls(),this.removeListeners()}}const dO=n=>(e,t)=>{n&&pr.postRender(()=>n(e,t))};class uoe extends Ku{constructor(){super(...arguments),this.removePointerDownListener=fa}onPointerDown(e){this.session=new F7(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:W7(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:dO(e),onStart:dO(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&pr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=qm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const x_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function fO(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const pm={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ut.test(n))n=parseFloat(n);else return n;const t=fO(n,e.target.x),r=fO(n,e.target.y);return`${t}% ${r}%`}},hoe={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=Fu.parse(n);if(i.length>5)return r;const s=Fu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const c=Pr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class doe extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Mie(foe),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),x_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||pr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),rC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function H7(n){const[e,t]=I9(),r=X.useContext(qI);return f.jsx(doe,{...n,layoutGroup:r,switchLayoutGroup:X.useContext(D9),isPresent:e,safeToRemove:t})}const foe={borderRadius:{...pm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pm,borderTopRightRadius:pm,borderBottomLeftRadius:pm,borderBottomRightRadius:pm,boxShadow:hoe};function goe(n,e,t){const r=cs(n)?n:Kp(n);return r.start(IC("",r,e,t)),r.animation}function moe(n){return n instanceof SVGElement&&n.tagName!=="svg"}const poe=(n,e)=>n.depth-e.depth;class yoe{constructor(){this.children=[],this.isDirty=!1}add(e){yC(this.children,e),this.isDirty=!0}remove(e){xC(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(poe),this.isDirty=!1,this.children.forEach(e)}}function xoe(n,e){const t=ll.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(Du(r),n(s-e))};return pr.read(r,!0),()=>Du(r)}const K7=["TopLeft","TopRight","BottomLeft","BottomRight"],_oe=K7.length,gO=n=>typeof n=="string"?parseFloat(n):n,mO=n=>typeof n=="number"||Ut.test(n);function voe(n,e,t,r,i,s){i?(n.opacity=Pr(0,t.opacity!==void 0?t.opacity:1,woe(r)),n.opacityExit=Pr(e.opacity!==void 0?e.opacity:1,0,Eoe(r))):s&&(n.opacity=Pr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<_oe;a++){const o=`border${K7[a]}Radius`;let l=pO(e,o),c=pO(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||mO(l)===mO(c)?(n[o]=Math.max(Pr(gO(l),gO(c),r),0),(ol.test(c)||ol.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=Pr(e.rotate||0,t.rotate||0,r))}function pO(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const woe=X7(0,.5,d7),Eoe=X7(.5,.95,fa);function X7(n,e,t){return r=>r<n?0:r>e?1:t(q0(n,e,r))}function yO(n,e){n.min=e.min,n.max=e.max}function Ra(n,e){yO(n.x,e.x),yO(n.y,e.y)}function xO(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function _O(n,e,t,r,i){return n-=e,n=kv(n,1/t,r),i!==void 0&&(n=kv(n,1/i,r)),n}function Soe(n,e=0,t=1,r=.5,i,s=n,a=n){if(ol.test(e)&&(e=parseFloat(e),e=Pr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Pr(s.min,s.max,r);n===s&&(o-=e),n.min=_O(n.min,e,t,o,i),n.max=_O(n.max,e,t,o,i)}function vO(n,e,[t,r,i],s,a){Soe(n,e[t],e[r],e[i],e.scale,s,a)}const Toe=["x","scaleX","originX"],boe=["y","scaleY","originY"];function wO(n,e,t,r){vO(n.x,e,Toe,t?t.x:void 0,r?r.x:void 0),vO(n.y,e,boe,t?t.y:void 0,r?r.y:void 0)}function EO(n){return n.translate===0&&n.scale===1}function q7(n){return EO(n.x)&&EO(n.y)}function SO(n,e){return n.min===e.min&&n.max===e.max}function Aoe(n,e){return SO(n.x,e.x)&&SO(n.y,e.y)}function TO(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function Y7(n,e){return TO(n.x,e.x)&&TO(n.y,e.y)}function bO(n){return pa(n.x)/pa(n.y)}function AO(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Roe{constructor(){this.members=[]}add(e){yC(this.members,e),e.scheduleRender()}remove(e){if(xC(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ioe(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:h,rotateX:g,rotateY:m,skewX:y,skewY:v}=t;c&&(r=`perspective(${c}px) ${r}`),h&&(r+=`rotate(${h}deg) `),g&&(r+=`rotateX(${g}deg) `),m&&(r+=`rotateY(${m}deg) `),y&&(r+=`skewX(${y}deg) `),v&&(r+=`skewY(${v}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Ih={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},km=typeof window<"u"&&window.MotionDebug!==void 0,vT=["","X","Y","Z"],Coe={visibility:"hidden"},RO=1e3;let koe=0;function wT(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function Z7(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=s7(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",pr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&Z7(r)}function Q7({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=koe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,km&&(Ih.totalNodes=Ih.resolvedTargetDeltas=Ih.recalculatedProjection=0),this.nodes.forEach(Noe),this.nodes.forEach(joe),this.nodes.forEach(Voe),this.nodes.forEach(Loe),km&&window.MotionDebug.record(Ih)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new yoe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new _C),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=moe(a),this.instance=a;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=xoe(m,250),x_.hasAnimatedSinceResize&&(x_.hasAnimatedSinceResize=!1,this.nodes.forEach(CO))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:y,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||$oe,{onLayoutAnimationStart:w,onLayoutAnimationComplete:T}=h.getProps(),b=!this.targetLayout||!Y7(this.targetLayout,v)||y,A=!m&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||A||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,A);const M={...fC(x,"layout"),onPlay:w,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else m||CO(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Du(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Boe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Z7(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const g=this.path[h];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(IO);return}this.isUpdating||this.nodes.forEach(Doe),this.isUpdating=!1,this.nodes.forEach(Foe),this.nodes.forEach(Poe),this.nodes.forEach(Moe),this.clearAllSnapshots();const o=ll.now();Vi.delta=cc(0,1e3/60,o-Vi.timestamp),Vi.timestamp=o,Vi.isProcessing=!0,hT.update.process(Vi),hT.preRender.process(Vi),hT.render.process(Vi),Vi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Ooe),this.sharedNodes.forEach(Goe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,pr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){pr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ur(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!q7(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;a&&(o||Rh(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Woe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return Ur();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(Hoe))){const{scroll:h}=this.root;h&&(i0(l.x,h.offset.x),i0(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=Ur();if(Ra(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:g,options:m}=h;h!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&Ra(l,a),i0(l.x,g.offset.x),i0(l.y,g.offset.y))}return l}applyTransform(a,o=!1){const l=Ur();Ra(l,a);for(let c=0;c<this.path.length;c++){const h=this.path[c];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&s0(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Rh(h.latestValues)&&s0(l,h.latestValues)}return Rh(this.latestValues)&&s0(l,this.latestValues),l}removeTransform(a){const o=Ur();Ra(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Rh(c.latestValues))continue;pA(c.latestValues)&&c.updateSnapshot();const h=Ur(),g=c.measurePageBox();Ra(h,g),wO(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Rh(this.latestValues)&&wO(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Vi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=Vi.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ur(),this.relativeTargetOrigin=Ur(),Zm(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),Ra(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ur(),this.targetWithTransforms=Ur()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),qae(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ra(this.target,this.layout.layoutBox),U7(this.target,this.targetDelta)):Ra(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ur(),this.relativeTargetOrigin=Ur(),Zm(this.relativeTargetOrigin,this.target,y.target),Ra(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}km&&Ih.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||pA(this.parent.latestValues)||z7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Vi.timestamp&&(c=!1),c)return;const{layout:h,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||g))return;Ra(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,y=this.treeScale.y;ioe(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Ur());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(xO(this.prevProjectionDelta.x,this.projectionDelta.x),xO(this.prevProjectionDelta.y,this.projectionDelta.y)),Ym(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==y||!AO(this.projectionDelta.x,this.prevProjectionDelta.x)||!AO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),km&&Ih.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=r0(),this.projectionDelta=r0(),this.projectionDeltaWithTransform=r0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},g=r0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=Ur(),y=l?l.source:void 0,v=this.layout?this.layout.source:void 0,x=y!==v,w=this.getStack(),T=!w||w.members.length<=1,b=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(Uoe));this.animationProgress=0;let A;this.mixTargetDelta=M=>{const O=M/1e3;kO(g.x,a.x,O),kO(g.y,a.y,O),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Zm(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),zoe(this.relativeTarget,this.relativeTargetOrigin,m,O),A&&Aoe(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Ur()),Ra(A,this.relativeTarget)),x&&(this.animationValues=h,voe(h,c,this.latestValues,O,b,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Du(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=pr.update(()=>{x_.hasAnimatedSinceResize=!0,this.currentAnimation=goe(0,RO,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(RO),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:h}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&J7(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Ur();const g=pa(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+g;const m=pa(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}Ra(o,l),s0(o,h),Ym(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Roe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&wT("z",a,c,this.animationValues);for(let h=0;h<vT.length;h++)wT(`rotate${vT[h]}`,a,c,this.animationValues),wT(`skew${vT[h]}`,a,c,this.animationValues);a.render();for(const h in c)a.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Coe;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=p_(a?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=p_(a?.pointerEvents)||""),this.hasProjected&&!Rh(this.latestValues)&&(x.transform=h?h({},""):"none",this.hasProjected=!1),x}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),c.transform=Ioe(this.projectionDeltaWithTransform,this.treeScale,m),h&&(c.transform=h(m,c.transform));const{x:y,y:v}=this.projectionDelta;c.transformOrigin=`${y.origin*100}% ${v.origin*100}% 0`,g.animationValues?c.opacity=g===this?(l=(o=m.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:c.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const x in bv){if(m[x]===void 0)continue;const{correct:w,applyTo:T}=bv[x],b=c.transform==="none"?m[x]:w(m[x],g);if(T){const A=T.length;for(let M=0;M<A;M++)c[T[M]]=b}else c[x]=b}return this.options.layoutId&&(c.pointerEvents=g===this?p_(a?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(IO),this.root.sharedNodes.clear()}}}function Poe(n){n.updateLayout()}function Moe(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?Ca(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],y=pa(m);m.min=r[g].min,m.max=m.min+y}):J7(s,t.layoutBox,r)&&Ca(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],y=pa(r[g]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+y)});const o=r0();Ym(o,r,t.layoutBox);const l=r0();a?Ym(l,n.applyTransform(i,!0),t.measuredBox):Ym(l,r,t.layoutBox);const c=!q7(o);let h=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:y}=g;if(m&&y){const v=Ur();Zm(v,t.layoutBox,m.layoutBox);const x=Ur();Zm(x,r,y.layoutBox),Y7(v,x)||(h=!0),g.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=v,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function Noe(n){km&&Ih.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function Loe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function Ooe(n){n.clearSnapshot()}function IO(n){n.clearMeasurements()}function Doe(n){n.isLayoutDirty=!1}function Foe(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function CO(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function joe(n){n.resolveTargetDelta()}function Voe(n){n.calcProjection()}function Boe(n){n.resetSkewAndRotation()}function Goe(n){n.removeLeadSnapshot()}function kO(n,e,t){n.translate=Pr(e.translate,0,t),n.scale=Pr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function PO(n,e,t,r){n.min=Pr(e.min,t.min,r),n.max=Pr(e.max,t.max,r)}function zoe(n,e,t,r){PO(n.x,e.x,t.x,r),PO(n.y,e.y,t.y,r)}function Uoe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const $oe={duration:.45,ease:[.4,0,.1,1]},MO=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),NO=MO("applewebkit/")&&!MO("chrome/")?Math.round:fa;function LO(n){n.min=NO(n.min),n.max=NO(n.max)}function Woe(n){LO(n.x),LO(n.y)}function J7(n,e,t){return n==="position"||n==="preserve-aspect"&&!Xae(bO(e),bO(t),.2)}function Hoe(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const Koe=Q7({attachResizeListener:(n,e)=>qp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ET={current:void 0},eV=Q7({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!ET.current){const n=new Koe({});n.mount(window),n.setOptions({layoutScroll:!0}),ET.current=n}return ET.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),Xoe={pan:{Feature:uoe},drag:{Feature:coe,ProjectionNode:eV,MeasureLayout:H7}};function OO(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&pr.postRender(()=>s(e,W1(e)))}class qoe extends Ku{mount(){const{current:e}=this.node;e&&(this.unmount=Xie(e,t=>(OO(this.node,t,"Start"),r=>OO(this.node,r,"End"))))}unmount(){}}class Yoe extends Ku{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=$1(qp(this.node.current,"focus",()=>this.onFocus()),qp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function DO(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&pr.postRender(()=>s(e,W1(e)))}class Zoe extends Ku{mount(){const{current:e}=this.node;e&&(this.unmount=Qie(e,t=>(DO(this.node,t,"Start"),(r,{success:i})=>DO(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const xA=new WeakMap,ST=new WeakMap,Qoe=n=>{const e=xA.get(n.target);e&&e(n)},Joe=n=>{n.forEach(Qoe)};function ele({root:n,...e}){const t=n||document;ST.has(t)||ST.set(t,{});const r=ST.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Joe,{root:n,...e})),r[i]}function tle(n,e,t){const r=ele(e);return xA.set(n,t),r.observe(n),()=>{xA.delete(n),r.unobserve(n)}}const nle={some:0,all:1};class rle extends Ku{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:nle[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:g}=this.node.getProps(),m=c?h:g;m&&m(l)};return tle(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(ile(e,t))&&this.startObserver()}unmount(){}}function ile({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const sle={inView:{Feature:rle},tap:{Feature:Zoe},focus:{Feature:Yoe},hover:{Feature:qoe}},ale={layout:{ProjectionNode:eV,MeasureLayout:H7}},_A={current:null},tV={current:!1};function ole(){if(tV.current=!0,!!QI)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>_A.current=n.matches;n.addListener(e),e()}else _A.current=!1}const lle=[...A7,rs,Fu],cle=n=>lle.find(b7(n)),FO=new WeakMap;function ule(n,e,t){for(const r in e){const i=e[r],s=t[r];if(cs(i))n.addValue(r,i);else if(cs(s))n.addValue(r,Kp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,Kp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const jO=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class hle{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=bC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=ll.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,pr.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=mE(t),this.isVariantNode=L9(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in m){const v=m[y];l[y]!==void 0&&cs(v)&&v.set(l[y],!1)}}mount(e){this.current=e,FO.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),tV.current||ole(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:_A.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){FO.delete(this.current),this.projection&&this.projection.unmount(),Du(this.notifyUpdate),Du(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Od.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&pr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Y0){const t=Y0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ur()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<jO.length;r++){const i=jO[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=ule(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Kp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(S7(i)||g7(i))?i=parseFloat(i):!cle(i)&&Fu.test(t)&&(i=v7(e,t)),this.setBaseTarget(e,cs(i)?i.get():i)),cs(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=sC(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!cs(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new _C),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class nV extends hle{constructor(){super(...arguments),this.KeyframeResolver=R7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;cs(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function dle(n){return window.getComputedStyle(n)}class fle extends nV{constructor(){super(...arguments),this.type="html",this.renderInstance=U9}readValueFromInstance(e,t){if(Od.has(t)){const r=TC(t);return r&&r.default||0}else{const r=dle(e),i=(B9(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return $7(e,t)}build(e,t,r){lC(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return dC(e,t,r)}}class gle extends nV{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ur}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Od.has(t)){const r=TC(t);return r&&r.default||0}return t=$9.has(t)?t:nC(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return K9(e,t,r)}build(e,t,r){cC(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){W9(e,t,r,i)}mount(e){this.isSVGTag=hC(e.tagName),super.mount(e)}}const mle=(n,e)=>iC(n)?new gle(e):new fle(e,{allowProjection:n!==X.Fragment}),ple=Gie({...Vae,...sle,...Xoe,...ale},mle),yt=nie(ple);const yle=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xle=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),VO=n=>{const e=xle(n);return e.charAt(0).toUpperCase()+e.slice(1)},rV=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),_le=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var vle={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const wle=X.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>X.createElement("svg",{ref:l,...vle,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:rV("lucide",i),...!s&&!_le(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,h])=>X.createElement(c,h)),...Array.isArray(s)?s:[s]]));const tt=(n,e)=>{const t=X.forwardRef(({className:r,...i},s)=>X.createElement(wle,{ref:s,iconNode:e,className:rV(`lucide-${yle(VO(n))}`,`lucide-${n}`,r),...i}));return t.displayName=VO(n),t};const Ele=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Sle=tt("archive-restore",Ele);const Tle=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],iV=tt("archive",Tle);const ble=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ale=tt("ban",ble);const Rle=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ile=tt("book-open",Rle);const Cle=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],sV=tt("bug",Cle);const kle=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],CC=tt("calendar",kle);const Ple=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],xE=tt("camera",Ple);const Mle=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],qf=tt("car",Mle);const Nle=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],aV=tt("chart-column",Nle);const Lle=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],uc=tt("check",Lle);const Ole=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_E=tt("chevron-down",Ole);const Dle=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Fle=tt("chevron-left",Dle);const jle=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],vE=tt("chevron-right",jle);const Vle=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],kC=tt("chevron-up",Vle);const Ble=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],oV=tt("circle-alert",Ble);const Gle=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],zle=tt("circle-check-big",Gle);const Ule=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pv=tt("clock",Ule);const $le=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],Wle=tt("cloud-off",$le);const Hle=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],vA=tt("cloud",Hle);const Kle=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Xle=tt("code",Kle);const qle=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Yle=tt("compass",qle);const Zle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],Mv=tt("crosshair",Zle);const Qle=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Nv=tt("download",Qle);const Jle=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],H1=tt("external-link",Jle);const ece=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Lv=tt("eye-off",ece);const tce=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ov=tt("eye",tce);const nce=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],PC=tt("file-text",nce);const rce=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],ice=tt("flame",rce);const sce=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],ace=tt("folder-open",sce);const oce=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],lce=tt("folder-plus",oce);const cce=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],uce=tt("folder",cce);const hce=[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]],wA=tt("footprints",hce);const dce=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],fce=tt("gauge",dce);const gce=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],mce=tt("gem",gce);const pce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],lV=tt("grid-3x3",pce);const yce=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],xce=tt("image-plus",yce);const _ce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],MC=tt("info",_ce);const vce=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],vo=tt("layers",vce);const wce=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],cV=tt("list",wce);const Ece=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],NC=tt("loader-circle",Ece);const Sce=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Tce=tt("locate-fixed",Sce);const bce=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],EA=tt("lock",bce);const Ace=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],LC=tt("log-out",Ace);const Rce=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Wa=tt("map-pin",Rce);const Ice=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],OC=tt("map",Ice);const Cce=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],kce=tt("menu",Cce);const Pce=[["path",{d:"M5 12h14",key:"1ays0h"}]],uV=tt("minus",Pce);const Mce=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],Q0=tt("mountain",Mce);const Nce=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Lce=tt("mouse-pointer",Nce);const Oce=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],wE=tt("navigation",Oce);const Dce=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],hV=tt("pause",Dce);const Fce=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],BO=tt("pen-line",Fce);const jce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Vce=tt("pen",jce);const Bce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],J0=tt("pencil",Bce);const Gce=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],zce=tt("person-standing",Gce);const Uce=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],dV=tt("play",Uce);const $ce=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ha=tt("plus",$ce);const Wce=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],GO=tt("refresh-cw",Wce);const Hce=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],fV=tt("rotate-ccw",Hce);const Kce=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Xce=tt("rotate-cw",Kce);const qce=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Dv=tt("route",qce);const Yce=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Yp=tt("ruler",Yce);const Zce=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],gV=tt("save",Zce);const Qce=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Jce=tt("scale",Qce);const eue=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],SA=tt("search",eue);const tue=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],TA=tt("settings",tue);const nue=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],rue=tt("settings-2",nue);const iue=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],sue=tt("share-2",iue);const aue=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],oue=tt("shield",aue);const lue=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],cue=tt("sliders-horizontal",lue);const uue=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],hue=tt("sliders-vertical",uue);const due=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],fue=tt("smartphone",due);const gue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],mue=tt("square",gue);const pue=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],yue=tt("tag",pue);const xue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],_ue=tt("target",xue);const vue=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],wue=tt("timer",vue);const Eue=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wl=tt("trash-2",Eue);const Sue=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],Tue=tt("tree-palm",Sue);const bue=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Aue=tt("trending-down",bue);const Rue=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Iue=tt("trending-up",Rue);const Cue=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],mV=tt("type",Cue);const kue=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],K1=tt("upload",kue);const Pue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],DC=tt("user",Pue);const Mue=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Nue=tt("volume-2",Mue);const Lue=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Oue=tt("waves",Lue);const Due=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Kr=tt("x",Due);function Fue(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=as(),a=X.useCallback(l=>{r(l)},[r]),o=X.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return X.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function jue(){const{tracking:n,toggle:e}=Fue();return f.jsx(yt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:f.jsx(Tce,{size:22,strokeWidth:2})})}const Vue="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function Bue(){const n=Hr(y=>y.map),e=as(y=>y.position),t=as(y=>y.accuracy),r=as(y=>y.tracking),i=as(y=>y.smoothHeading),s=sr(y=>y.showAccuracyCircle),a=as(y=>y.firstFix),o=as(y=>y.resetFirstFix),l=as(y=>y.config.centerOnUser),c=X.useRef(null),h=X.useRef(null),g=X.useRef(null),m=X.useMemo(()=>y=>new hn({image:new sg({src:Vue,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return X.useEffect(()=>{if(!n||!r&&!e)return;const y=fr([5.1214,52.0907]);return c.current=new gr({geometry:new ri(y)}),c.current.setStyle(m(0)),h.current=new gr({geometry:new ri(y)}),g.current=new mc({source:new xl({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(g.current),()=>{g.current&&n&&n.removeLayer(g.current)}},[n,r,e,m]),X.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const y=fr([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const v=n.getView().getResolution()||1,x=Math.min(t/v,80);h.current.setStyle(new hn({image:new Us({radius:x,fill:new Xn({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new hn({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),X.useEffect(()=>{if(!c.current)return;const y=i!==null?i*Math.PI/180:0;c.current.setStyle(m(y))},[i,m]),null}function Gue(){const n=Sr(t=>t.themesPanelOpen),e=Sr(t=>t.toggleThemesPanel);return f.jsx(yt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:f.jsx(OC,{size:22,strokeWidth:2})})}function zue(){return f.jsx(Gue,{})}const Ox=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],ru=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],co="default-vondsten",pV={id:co,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},Uue=n=>n.some(t=>t.id===co)?n:[{...pV,createdAt:new Date().toISOString()},...n],hs=bs()(xc((n,e)=>({layers:[{...pV}],colorIndex:0,addLayer:(t,r=ru)=>{const i=crypto.randomUUID(),s=Ox[e().colorIndex%Ox.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||ru,o=i.color||Ox[e().colorIndex%Ox.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:c,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===co?{...r,points:[]}:r).filter(r=>r.id===co),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:Uue(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===co?{...r,name:"Mijn vondsten"}:r)}:t}}));function hi({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=X.useState(t),a=Ai(w=>w.visible),o=Ai(w=>w.setLayerVisibility),l=KI(w=>w.isLayerUnlocked),c=w=>{const T=Lw[w],b=T?.tier??"free",A=T?.regions??["nl"];return l(w,b,A)},h=r?.filter(w=>c(w))||[],g=h.filter(w=>a[w]).length,m=h.length,y=m>0&&g===m,v=g>0&&g<m,x=w=>{if(w.stopPropagation(),!r||h.length===0)return;const T=!y;h.forEach(b=>{o(b,T)})};return f.jsxs("div",{className:"mb-0.5",children:[f.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[f.jsxs("button",{onClick:w=>{w.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[f.jsx(yt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:f.jsx(vE,{size:14})}),i?f.jsx(ace,{size:16,className:"text-blue-500"}):f.jsx(uce,{size:16,className:"text-blue-500"}),f.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),g>0&&f.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:g})]}),r&&r.length>0&&f.jsx("button",{onClick:x,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":v?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||v)&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),f.jsx(kn,{initial:!1,children:i&&f.jsx(yt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function ot({name:n,type:e,hasOverlay:t}){const r=Ai(A=>A.visible[n]),i=Ai(A=>A.visible["Labels Overlay"]),s=Ai(A=>A.loadingState[n]),a=Ai(A=>A.toggleLayer),o=Ai(A=>A.setLayerVisibility),l=KI(A=>A.isLayerUnlocked),c=s==="loading",h=s==="error",g=Lw[n],m=g?.tier??"free",y=g?.regions??["nl"],x=!l(n,m,y),w=A=>{A.stopPropagation(),!(c||x)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(O=>{o(O,O===n)}))},T=A=>{A.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:w,disabled:c||x,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${x?"opacity-50 cursor-not-allowed bg-gray-50":c?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:x?"Premium laag - upgrade om te ontgrendelen":void 0,children:[f.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":x?"text-gray-400":"text-gray-600"}`,children:[n,h&&f.jsx(oV,{size:12,className:"text-red-500"}),x&&f.jsx(EA,{size:12,className:"text-amber-500"})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:x?"#e5e7eb":c?"#93c5fd":b?"#3b82f6":"white",border:x?"2px solid #d1d5db":c?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:x?f.jsx(EA,{size:10,strokeWidth:3,className:"text-gray-400"}):c?f.jsx(NC,{size:10,strokeWidth:3,className:"animate-spin"}):b?f.jsx(uc,{size:12,strokeWidth:3}):null})]}),t&&b&&f.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:f.jsx(yue,{size:12})})]})}const $ue=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function yV({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=G1(),[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,g]=X.useState(n.name),[m,y]=X.useState(!1),v=X.useRef(null),x=X.useRef(null),w=n.features.features.length,T=[...new Set(n.features.features.map(I=>I.geometry?.type).filter(Boolean))];X.useEffect(()=>{l&&v.current&&(v.current.focus(),v.current.select())},[l]),X.useEffect(()=>{const I=R=>{x.current&&!x.current.contains(R.target)&&y(!1)};if(m)return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[m]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},A=()=>{const I=h.trim();I&&I!==n.name&&i(n.id,{name:I}),c(!1)},M=()=>{g(n.name),c(!1)},O=I=>{I.key==="Enter"?A():I.key==="Escape"&&M()},z=I=>{s(n.id,I),y(!1)};return e?f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),f.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:w})]}):f.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[f.jsxs("div",{className:"relative",ref:x,children:[f.jsx("button",{onClick:()=>y(!m),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),m&&f.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:$ue.map(I=>f.jsx("button",{onClick:()=>z(I),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${I===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:I},title:I},I))})]}),f.jsx("div",{className:"flex-1 min-w-0",children:l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("input",{ref:v,type:"text",value:h,onChange:I=>g(I.target.value),onKeyDown:O,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),f.jsx("button",{onClick:A,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:f.jsx(uc,{size:14})}),f.jsx("button",{onClick:M,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:f.jsx(Kr,{size:14})})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),f.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:f.jsx(J0,{size:12})})]}),f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[f.jsxs("span",{children:[w," ",w===1?"feature":"features"]}),T.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"mx-0.5",children:""}),f.jsx("span",{children:T.join(", ")})]})]})]})})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(wl,{size:14})})]})]})}function Wue(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=Sr(),{layers:r,toggleVisibility:i}=hs(),s=G1(g=>g.layers),a=X.useRef(null),o=sr(g=>g.layerPanelFontScale),l=sr(g=>g.setLayerPanelFontScale),c=sr(g=>g.showFontSliders),h=13*o/100;return X.useEffect(()=>{if(!n)return;const g=y=>{a.current&&!a.current.contains(y.target)&&e()},m=setTimeout(()=>{document.addEventListener("click",g)},100);return()=>{clearTimeout(m),document.removeEventListener("click",g)}},[n,e]),f.jsx(kn,{children:n&&f.jsxs(yt.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[f.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(vo,{size:14,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[c&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:g=>{l(parseInt(g.target.value))},onChange:g=>l(parseInt(g.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:f.jsx(Kr,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),f.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[r.filter(g=>!g.archived).length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:f.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(g=>!g.archived).map(g=>f.jsxs("button",{onClick:m=>{m.stopPropagation(),i(g.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${g.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[f.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[g.name,f.jsxs("span",{className:"text-xs text-gray-400",children:["(",g.points.length,")"]})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:g.visible?"#f97316":"white",border:g.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:g.visible&&f.jsx(uc,{size:12,strokeWidth:3})})]},g.id))]}),s.length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[f.jsx(K1,{size:12,className:"text-cyan-600"}),f.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(g=>f.jsx(yV,{layer:g,compact:!0},g.id)),f.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),f.jsxs("div",{className:"space-y-0",children:[f.jsx(ot,{name:"CartoDB (licht)",type:"base"}),f.jsx(ot,{name:"OpenStreetMap",type:"base"}),f.jsx(ot,{name:"Luchtfoto",type:"base",hasOverlay:!0}),f.jsx(ot,{name:"TMK 1850",type:"base",hasOverlay:!0}),f.jsx(ot,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),f.jsxs(hi,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[f.jsx(ot,{name:"Hunebedden",type:"overlay"}),f.jsx(ot,{name:"FAMKE Steentijd",type:"overlay"}),f.jsx(ot,{name:"Grafheuvels",type:"overlay"}),f.jsx(ot,{name:"Terpen",type:"overlay"}),f.jsxs(hi,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[f.jsx(ot,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),f.jsx(ot,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),f.jsx(ot,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),f.jsx(ot,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),f.jsx(ot,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),f.jsx(ot,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),f.jsx(ot,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]})]}),f.jsxs(hi,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","IKAW","Archeo Landschappen","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[f.jsx(ot,{name:"AMK Monumenten",type:"overlay"}),f.jsxs(hi,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[f.jsx(ot,{name:"AMK Romeins",type:"overlay"}),f.jsx(ot,{name:"AMK Steentijd",type:"overlay"}),f.jsx(ot,{name:"AMK Vroege ME",type:"overlay"}),f.jsx(ot,{name:"AMK Late ME",type:"overlay"}),f.jsx(ot,{name:"AMK Overig",type:"overlay"})]}),f.jsx(ot,{name:"Archeo Onderzoeken",type:"overlay"}),f.jsxs(hi,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsxs(hi,{title:"Romeinse wegen",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)"],children:[f.jsx(ot,{name:"Romeinse wegen (regio)",type:"overlay"}),f.jsx(ot,{name:"Romeinse wegen (Wereld)",type:"overlay"})]}),f.jsxs(hi,{title:"Romeinse forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsx(ot,{name:"Romeinse Forten",type:"overlay"}),f.jsx(ot,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),f.jsx(ot,{name:"IKAW",type:"overlay"}),f.jsx(ot,{name:"Archeo Landschappen",type:"overlay"}),f.jsxs(hi,{title:"Verwachtingen uiterwaarden",defaultExpanded:!1,layerNames:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[f.jsx(ot,{name:"UIKAV Punten",type:"overlay"}),f.jsx(ot,{name:"UIKAV Vlakken",type:"overlay"}),f.jsx(ot,{name:"UIKAV Expert",type:"overlay"}),f.jsx(ot,{name:"UIKAV Buffer",type:"overlay"}),f.jsx(ot,{name:"UIKAV Indeling",type:"overlay"})]})]}),f.jsxs(hi,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[f.jsx(ot,{name:"Rijksmonumenten",type:"overlay"}),f.jsx(ot,{name:"Werelderfgoed",type:"overlay"}),f.jsx(ot,{name:"Religieus Erfgoed",type:"overlay"}),f.jsx(ot,{name:"Kastelen",type:"overlay"}),f.jsx(ot,{name:"Runes",type:"overlay"})]}),f.jsxs(hi,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[f.jsx(ot,{name:"WWII Bunkers",type:"overlay"}),f.jsx(ot,{name:"Slagvelden",type:"overlay"}),f.jsx(ot,{name:"Militaire Vliegvelden",type:"overlay"}),f.jsx(ot,{name:"Verdedigingslinies",type:"overlay"}),f.jsx(ot,{name:"Militaire Objecten",type:"overlay"}),f.jsx(ot,{name:"Inundatiegebieden",type:"overlay"})]}),f.jsxs(hi,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[f.jsx(ot,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),f.jsx(ot,{name:"AHN4 Hillshade NL",type:"overlay"}),f.jsx(ot,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),f.jsx(ot,{name:"AHN 0.5m",type:"overlay"})]}),f.jsxs(hi,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[f.jsx(ot,{name:"Veengebieden",type:"overlay"}),f.jsx(ot,{name:"Geomorfologie",type:"overlay"}),f.jsx(ot,{name:"Bodemkaart",type:"overlay"}),f.jsx(ot,{name:"Essen",type:"overlay"})]}),f.jsxs(hi,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[f.jsx(ot,{name:"Gewaspercelen",type:"overlay"}),f.jsx(ot,{name:"Kadastrale Grenzen",type:"overlay"})]}),f.jsxs(hi,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[f.jsxs(hi,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[f.jsx(ot,{name:"Scheepswrakken",type:"overlay"}),f.jsx(ot,{name:"Woonheuvels ZH",type:"overlay"}),f.jsx(ot,{name:"Windmolens",type:"overlay"}),f.jsx(ot,{name:"Erfgoedlijnen",type:"overlay"}),f.jsx(ot,{name:"Oude Kernen",type:"overlay"})]}),f.jsxs(hi,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[f.jsx(ot,{name:"Relictenkaart Punten",type:"overlay"}),f.jsx(ot,{name:"Relictenkaart Lijnen",type:"overlay"}),f.jsx(ot,{name:"Relictenkaart Vlakken",type:"overlay"})]}),f.jsx(hi,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:f.jsx(ot,{name:"Verdronken Dorpen",type:"overlay"})})]}),f.jsxs(hi,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[f.jsx(ot,{name:"Fossiel Hotspots",type:"overlay"}),f.jsx(ot,{name:"Mineralen Hotspots",type:"overlay"}),f.jsx(ot,{name:"Goudrivieren",type:"overlay"}),f.jsx(ot,{name:"Fossielen Nederland",type:"overlay"}),f.jsx(ot,{name:"Fossielen Belgi",type:"overlay"}),f.jsx(ot,{name:"Fossielen Duitsland",type:"overlay"}),f.jsx(ot,{name:"Fossielen Frankrijk",type:"overlay"})]}),f.jsxs(hi,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Strandopgangen","Kringloopwinkels","Winkelcentra","Openbare Toiletten","Natuurparkeren"],children:[f.jsx(ot,{name:"Wandelroutes",type:"overlay"}),f.jsx(ot,{name:"Ruiterpaden",type:"overlay"}),f.jsx(ot,{name:"Laarzenpaden",type:"overlay"}),f.jsx(ot,{name:"Parken",type:"overlay"}),f.jsx(ot,{name:"Speeltuinen",type:"overlay"}),f.jsx(ot,{name:"Musea",type:"overlay"}),f.jsx(ot,{name:"Strandjes",type:"overlay"}),f.jsx(ot,{name:"Strandopgangen",type:"overlay"}),f.jsx(ot,{name:"Kringloopwinkels",type:"overlay"}),f.jsx(ot,{name:"Winkelcentra",type:"overlay"}),f.jsx(ot,{name:"Openbare Toiletten",type:"overlay"}),f.jsx(ot,{name:"Natuurparkeren",type:"overlay"})]})]})]})]})})}function Hue(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var vd=1,wd=2,v0=3,Kue=4,bA=5,zO=6378137,Xue=6356752314e-3,UO=.0066943799901413165,Qm=484813681109536e-20,He=Math.PI/2,que=.16666666666666666,Yue=.04722222222222222,Zue=.022156084656084655,lt=1e-10,Lr=.017453292519943295,Bs=57.29577951308232,Bn=Math.PI/4,Zp=Math.PI*2,$r=3.14159265359,Xs={};Xs.greenwich=0;Xs.lisbon=-9.131906111111;Xs.paris=2.337229166667;Xs.bogota=-74.080916666667;Xs.madrid=-3.687938888889;Xs.rome=12.452333333333;Xs.bern=7.439583333333;Xs.jakarta=106.807719444444;Xs.ferro=-17.666666666667;Xs.brussels=4.367975;Xs.stockholm=18.058277777778;Xs.athens=23.7163375;Xs.oslo=10.722916666667;const Que={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var $O=/[\s_\-\/\(\)]/g;function ju(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace($O,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace($O,""),a===r)return n[s]}function AA(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var c=l.split("=");return c.push(!0),o[c[0].toLowerCase()]=c[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Lr},lat_1:function(o){e.lat1=o*Lr},lat_2:function(o){e.lat2=o*Lr},lat_ts:function(o){e.lat_ts=o*Lr},lon_0:function(o){e.long0=o*Lr},lon_1:function(o){e.long1=o*Lr},lon_2:function(o){e.long2=o*Lr},alpha:function(o){e.alpha=parseFloat(o)*Lr},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Lr},lonc:function(o){e.longc=o*Lr},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=ju(Que,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Lr},pm:function(o){var l=ju(Xs,o);e.from_greenwich=(l||parseFloat(o))*Lr},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class xV{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const r=e.find(m=>Array.isArray(m)&&m[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(i){const m=this.convertUnit(i);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const y=e.find(v=>Array.isArray(v)&&v[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(m.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const a=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(l){const m=l.find(y=>Array.isArray(y));t.source_crs=m?this.convert(m):null}const c=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(c){const m=c.find(y=>Array.isArray(y));t.target_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class Jue extends xV{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class ehe extends xV{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function the(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function nhe(n){return(the(n)==="2019"?ehe:Jue).convert(n)}function rhe(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Qp=1,_V=2,vV=3,Fv=4,wV=5,FC=-1,ihe=/\s/,she=/[A-Za-z]/,ahe=/[A-Za-z84_]/,EE=/[,\]]/,EV=/[\d\.E\-\+]/;function _c(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Qp}_c.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Fv)for(;ihe.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Qp:return this.neutral(n);case _V:return this.keyword(n);case Fv:return this.quoted(n);case wV:return this.afterquote(n);case vV:return this.number(n);case FC:return}};_c.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Fv;return}if(EE.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};_c.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Qp;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Qp,this.currentObject=this.stack.pop(),this.currentObject||(this.state=FC);return}};_c.prototype.number=function(n){if(EV.test(n)){this.word+=n;return}if(EE.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};_c.prototype.quoted=function(n){if(n==='"'){this.state=wV;return}this.word+=n};_c.prototype.keyword=function(n){if(ahe.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Qp;return}if(EE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};_c.prototype.neutral=function(n){if(she.test(n)){this.word=n,this.state=_V;return}if(n==='"'){this.word="",this.state=Fv;return}if(EV.test(n)){this.word=n,this.state=vV;return}if(EE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};_c.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===FC)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function ohe(n){var e=new _c(n);return e.output()}function TT(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return a0(a,s),s},r);e&&(n[e]=i)}function a0(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},a0(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&a0(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&a0(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],TT(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],TT(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return a0(n,e[t]);return TT(e,t,n)}}var lhe=.017453292519943295;function oo(n){return n*lhe}function SV(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=oo(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=oo(n.lat0>0?90:-90),delete n.lat1)}function WO(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function HO(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function KO(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=HO(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-HO(n.ellipsoid.semi_minor_axis))))}function jv(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(jv(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,KO(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,KO(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=WO(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=WO(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":jv(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),SV(e),e)}var che=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function uhe(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function TV(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];che.indexOf(i)!==-1&&hhe(n[i]),typeof n[i]=="object"&&TV(n[i])}}function hhe(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=oo(n.rectified_grid_angle));function o(h){var g=n.to_meter||1;return h*g}var l=function(h){return uhe(n,h)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",oo],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",oo],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",oo],["lat0","latitude_of_origin",oo],["lat0","standard_parallel_1",oo],["lat1","standard_parallel_1",oo],["lat2","standard_parallel_2",oo],["azimuth","Azimuth"],["alpha","azimuth",oo],["srsCode","name"]];c.forEach(l),SV(n)}function Vv(n){if(typeof n=="object")return jv(n);const e=rhe(n);var t=ohe(n);if(e==="WKT2"){const s=nhe(t);return jv(s)}var r=t[0],i={};return a0(t,i),TV(i),i[r]}function ji(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?ji[n]=AA(arguments[1]):ji[n]=Vv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?ji[n]=Vv(arguments[1]):(ji[n]=t,t||delete ji[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?ji.apply(e,r):ji(r)});if(typeof n=="string"){if(n in ji)return ji[n]}else"EPSG"in n?ji["EPSG:"+n.EPSG]=n:"ESRI"in n?ji["ESRI:"+n.ESRI]=n:"IAU2000"in n?ji["IAU2000:"+n.IAU2000]=n:console.log(n);return}}Hue(ji);function dhe(n){return typeof n=="string"}function fhe(n){return n in ji}function ghe(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var mhe=["3857","900913","3785","102113"];function phe(n){var e=ju(n,"authority");if(e){var t=ju(e,"epsg");return t&&mhe.indexOf(t)>-1}}function yhe(n){var e=ju(n,"extension");if(e)return ju(e,"proj4")}function xhe(n){return n[0]==="+"}function _he(n){if(dhe(n)){if(fhe(n))return ji[n];if(ghe(n)){var e=Vv(n);if(phe(e))return ji["EPSG:3857"];var t=yhe(e);return t?AA(t):e}if(xhe(n))return AA(n)}else return"projName"in n?n:Vv(n)}function XO(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function gl(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function X1(n){return n<0?-1:1}function mt(n,e){return e||Math.abs(n)<=$r?n:n-X1(n)*Zp}function wo(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(He-e))/r}function Jp(n,e){for(var t=.5*n,r,i,s=He-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=He-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function vhe(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function whe(n){var e=n.x,t=n.y;if(t*Bs>90&&t*Bs<-90&&e*Bs>180&&e*Bs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-He)<=lt)return null;if(this.sphere)r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Bn+.5*t));else{var s=Math.sin(t),a=wo(this.e,t,s);r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function Ehe(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=He-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=Jp(this.e,s),i===-9999)return null}return r=mt(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var She=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const The={init:vhe,forward:whe,inverse:Ehe,names:She};function bhe(){}function qO(n){return n}var bV=["longlat","identity"];const Ahe={init:bhe,forward:qO,inverse:qO,names:bV};var Rhe=[The,Ahe],Ch={},o0=[];function AV(n,e){var t=o0.length;return n.names?(o0[t]=n,n.names.forEach(function(r){Ch[r.toLowerCase()]=t}),this):(console.log(e),!0)}function RV(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function Ihe(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Ch[e]<"u"&&o0[Ch[e]]||(e=RV(e),e in Ch&&o0[Ch[e]]))return o0[Ch[e]]}function Che(){Rhe.forEach(AV)}const khe={start:Che,add:AV,get:Ihe};var IV={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const Phe=IV.WGS84;function Mhe(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(que+a*(Yue+a*Zue)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function Nhe(n,e,t,r,i){if(!n){var s=ju(IV,r);s||(s=Phe),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<lt)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var __={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Lhe in __){var bT=__[Lhe];bT.datumName&&(__[bT.datumName]=bT)}function Ohe(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=bA:o.datum_type=Kue,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=vd),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=wd,o.datum_params[3]*=Qm,o.datum_params[4]*=Qm,o.datum_params[5]*=Qm,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=v0,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var jC={};function Dhe(n,e,t){return e instanceof ArrayBuffer?Fhe(n,e,t):{ready:jhe(n,e)}}function Fhe(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Ghe(i),a=zhe(i,s),o=Uhe(i,a,s,r),l={header:a,subgrids:o};return jC[n]=l,l}async function jhe(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(YO),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(YO),g=c[0]+(l[0]-1)*h[0],m=c[3]-(l[1]-1)*h[1],y=o[0],v=o[1],x=[];for(let b=l[1]-1;b>=0;b--)for(let A=l[0]-1;A>=0;A--){var w=b*l[0]+A;x.push([-pu(v[w]),pu(y[w])])}t.push({del:h,lim:l,ll:[-g,m],cvs:x})}var T={header:{nSubgrids:r},subgrids:t};return jC[n]=T,T}function Vhe(n){if(n===void 0)return null;var e=n.split(",");return e.map(Bhe)}function Bhe(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:jC[n]||null,isNull:!1}}function YO(n){return n*Math.PI/180}function pu(n){return n/3600*Math.PI/180}function Ghe(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function zhe(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:RA(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function RA(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function Uhe(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=Whe(n,i,t),l=Hhe(n,i,o,t,r),c=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[pu(o.lowerLongitude),pu(o.lowerLatitude)],del:[pu(o.longitudeInterval),pu(o.latitudeInterval)],lim:[c,h],count:o.gridNodeCount,cvs:$he(l)});var g=16;r===!1&&(g=8),i+=176+o.gridNodeCount*g}return s}function $he(n){return n.map(function(e){return[pu(e.longitudeShift),pu(e.latitudeShift)]})}function Whe(n,e,t){return{name:RA(n,e+8,e+16).trim(),parent:RA(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function Hhe(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var c={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(c.latitudeAccuracy=n.getFloat32(s+l*a+8,r),c.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(c)}return o}function Ba(n,e){if(!(this instanceof Ba))return new Ba(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var t=_he(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=Ba.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=ju(__,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=Nhe(t.a,t.b,t.rf,t.ellps,t.sphere),a=Mhe(s.a,s.b,s.rf,t.R_A),o=Vhe(t.nadgrids),l=t.datum||Ohe(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);XO(this,t),XO(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ba.projections=khe;Ba.projections.start();function Khe(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===vd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===wd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function CV(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,c;if(i<-He&&i>-1.001*He)i=-He;else if(i>He&&i<1.001*He)i=He;else{if(i<-He)return{x:-1/0,y:-1/0,z:n.z};if(i>He)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),c=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*c*Math.cos(r),y:(a+s)*c*Math.sin(r),z:(a*(1-e)+s)*o}}function kV(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,c,h,g,m,y,v,x,w,T,b,A,M=n.x,O=n.y,z=n.z?n.z:0,I,R,P;if(o=Math.sqrt(M*M+O*O),l=Math.sqrt(M*M+O*O+z*z),o/t<i){if(I=0,l/t<i)return R=He,P=-r,{x:n.x,y:n.y,z:n.z}}else I=Math.atan2(O,M);c=z/l,h=o/l,g=1/Math.sqrt(1-e*(2-e)*h*h),v=h*(1-e)*g,x=c*g,A=0;do A++,y=t/Math.sqrt(1-e*x*x),P=o*v+z*x-y*(1-e*x*x),m=e*y/(y+P),g=1/Math.sqrt(1-m*(2-m)*h*h),w=h*(1-m)*g,T=c*g,b=T*v-w*x,v=w,x=T;while(b*b>s&&A<a);return R=Math.atan(T/Math.abs(w)),{x:I,y:R,z:P}}function Xhe(n,e,t){if(e===vd)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===wd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6];return{x:c*(n.x-l*n.y+o*n.z)+r,y:c*(l*n.x+n.y-a*n.z)+i,z:c*(-o*n.x+a*n.y+n.z)+s}}}function qhe(n,e,t){if(e===vd)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===wd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=(n.x-r)/c,g=(n.y-i)/c,m=(n.z-s)/c;return{x:h+l*g-o*m,y:-l*h+g+a*m,z:o*h-a*g+m}}}function Dx(n){return n===vd||n===wd}function Yhe(n,e,t){if(Khe(n,e)||n.datum_type===bA||e.datum_type===bA)return t;var r=n.a,i=n.es;if(n.datum_type===v0){var s=ZO(n,!1,t);if(s!==0)return;r=zO,i=UO}var a=e.a,o=e.b,l=e.es;if(e.datum_type===v0&&(a=zO,o=Xue,l=UO),i===l&&r===a&&!Dx(n.datum_type)&&!Dx(e.datum_type))return t;if(t=CV(t,i,r),Dx(n.datum_type)&&(t=Xhe(t,n.datum_type,n.datum_params)),Dx(e.datum_type)&&(t=qhe(t,e.datum_type,e.datum_params)),t=kV(t,l,a,o),e.datum_type===v0){var c=ZO(e,!0,t);if(c!==0)return}return t}function ZO(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,c=0,h=l.length;c<h;c++){var g=l[c],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,y=g.ll[0]-m,v=g.ll[1]-m,x=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,w=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(v>r.y||y>r.x||w<r.y||x<r.x)&&(i=Zhe(r,e,g),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Bs+" "+r.y*Bs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function Zhe(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=mt(i.x-Math.PI)+Math.PI;var s=QO(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,c;do{if(c=QO(s,t),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=mt(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function QO(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var c={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},g=i.x*i.y,m=i.x*(1-i.y),y=(1-i.x)*(1-i.y),v=(1-i.x)*i.y;return s.x=y*o.x+m*l.x+v*h.x+g*c.x,s.y=y*o.y+m*l.y+v*h.y+g*c.y,s}function JO(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":c[o]=a;break;case"w":c[o]=-a;break;case"n":c[o]=a;break;case"s":c[o]=-a;break;case"u":t[o]!==void 0&&(c.z=a);break;case"d":t[o]!==void 0&&(c.z=-a);break;default:return null}return c}function PV(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function Qhe(n){e5(n.x),e5(n.y)}function e5(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function Jhe(n,e){return(n.datum.datum_type===vd||n.datum.datum_type===wd||n.datum.datum_type===v0)&&e.datumCode!=="WGS84"||(e.datum.datum_type===vd||e.datum.datum_type===wd||e.datum.datum_type===v0)&&n.datumCode!=="WGS84"}function Bv(n,e,t,r){var i;Array.isArray(t)?t=PV(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(Qhe(t),n.datum&&e.datum&&Jhe(n,e)&&(i=new Ba("WGS84"),t=Bv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=JO(n,!1,t)),n.projName==="longlat")t={x:t.x*Lr,y:t.y*Lr,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=Yhe(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Bs,y:t.y*Bs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?JO(e,!0,t):(t&&!s&&delete t.z,t)}var t5=Ba("WGS84");function AT(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=Bv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=Bv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function Fx(n){return n instanceof Ba?n:typeof n=="object"&&"oProj"in n?n.oProj:Ba(n)}function ede(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=Fx(n),r=t5,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=Fx(n),r=t5,s=!0),r||(r=Fx(n)),i||(i=Fx(e)),t?AT(r,i,t):(a={forward:function(o,l){return AT(r,i,o,l)},inverse:function(o,l){return AT(i,r,o,l)}},s&&(a.oProj=i),a)}var n5=6,MV="AJSAJS",NV="AFAFAF",l0=65,Ms=73,ka=79,Pm=86,Mm=90;const tde={forward:LV,inverse:nde,toPoint:OV};function LV(n,e){return e=e||5,sde(rde({lat:n[1],lon:n[0]}),e)}function nde(n){var e=VC(FV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function OV(n){var e=VC(FV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function RT(n){return n*(Math.PI/180)}function r5(n){return 180*(n/Math.PI)}function rde(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,c,h,g,m,y=RT(e),v=RT(t),x,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),a=(w-1)*6-180+3,x=RT(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),c=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),g=Math.cos(y)*(v-x),m=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var T=s*l*(g+(1-c+h)*g*g*g/6+(5-18*c+c*c+72*h-58*o)*g*g*g*g*g/120)+5e5,b=s*(m+l*Math.tan(y)*(g*g/2+(5-c+9*h+4*h*h)*g*g*g*g/24+(61-58*c+c*c+600*h-330*o)*g*g*g*g*g*g/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(T),zoneNumber:w,zoneLetter:ide(e)}}function VC(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,c=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,g,m,y,v,x,w,T,b,A=t-5e5,M=e;r<"N"&&(M-=1e7),w=(i-1)*6-180+3,l=o/(1-o),x=M/s,T=x/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=T+(3*c/2-27*c*c*c/32)*Math.sin(2*T)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*T)+151*c*c*c/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),g=Math.tan(b)*Math.tan(b),m=l*Math.cos(b)*Math.cos(b),y=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),v=A/(h*s);var O=b-h*Math.tan(b)/y*(v*v/2-(5+3*g+10*m-4*m*m-9*l)*v*v*v*v/24+(61+90*g+298*m+45*g*g-252*l-3*m*m)*v*v*v*v*v*v/720);O=r5(O);var z=(v-(1+2*g+m)*v*v*v/6+(5-2*m+28*g-3*m*m+8*l+24*g*g)*v*v*v*v*v/120)/Math.cos(b);z=w+r5(z);var I;if(n.accuracy){var R=VC({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});I={top:R.lat,right:R.lon,bottom:O,left:z}}else I={lat:O,lon:z};return I}function ide(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function sde(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+ade(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function ade(n,e,t){var r=DV(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return ode(i,s,r)}function DV(n){var e=n%n5;return e===0&&(e=n5),e}function ode(n,e,t){var r=t-1,i=MV.charCodeAt(r),s=NV.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>Mm&&(a=a-Mm+l0-1,l=!0),(a===Ms||i<Ms&&a>Ms||(a>Ms||i<Ms)&&l)&&a++,(a===ka||i<ka&&a>ka||(a>ka||i<ka)&&l)&&(a++,a===Ms&&a++),a>Mm&&(a=a-Mm+l0-1),o>Pm?(o=o-Pm+l0-1,l=!0):l=!1,(o===Ms||s<Ms&&o>Ms||(o>Ms||s<Ms)&&l)&&o++,(o===ka||s<ka&&o>ka||(o>ka||s<ka)&&l)&&(o++,o===Ms&&o++),o>Pm&&(o=o-Pm+l0-1);var c=String.fromCharCode(a)+String.fromCharCode(o);return c}function FV(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=DV(a),c=lde(t.charAt(0),l),h=cde(t.charAt(1),l);h<ude(o);)h+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,y=0,v=0,x,w,T,b,A;return m>0&&(x=1e5/Math.pow(10,m),w=n.substring(s,s+m),y=parseFloat(w)*x,T=n.substring(s+m),v=parseFloat(T)*x),b=y+c,A=v+h,{easting:b,northing:A,zoneLetter:o,zoneNumber:a,accuracy:x}}function lde(n,e){for(var t=MV.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ms&&t++,t===ka&&t++,t>Mm){if(i)throw"Bad character: "+n;t=l0,i=!0}r+=1e5}return r}function cde(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=NV.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ms&&t++,t===ka&&t++,t>Pm){if(i)throw"Bad character: "+n;t=l0,i=!0}r+=1e5}return r}function ude(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function eg(n,e,t){if(!(this instanceof eg))return new eg(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}eg.fromMGRS=function(n){return new eg(OV(n))};eg.prototype.toMGRS=function(n){return LV([this.x,this.y],n)};var hde=1,dde=.25,i5=.046875,s5=.01953125,a5=.01068115234375,fde=.75,gde=.46875,mde=.013020833333333334,pde=.007120768229166667,yde=.3645833333333333,xde=.005696614583333333,_de=.3076171875;function BC(n){var e=[];e[0]=hde-n*(dde+n*(i5+n*(s5+n*a5))),e[1]=n*(fde-n*(i5+n*(s5+n*a5)));var t=n*n;return e[2]=t*(gde-n*(mde+n*pde)),t*=n,e[3]=t*(yde-n*xde),e[4]=t*n*_de,e}function mg(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var vde=20;function GC(n,e,t){for(var r=1/(1-e),i=n,s=vde;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(mg(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<lt)return i}return i}function wde(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=BC(this.es),this.ml0=mg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Ede(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,g=Math.pow(h,2),m=this.ep2*Math.pow(l,2),y=Math.pow(m,2),v=Math.abs(l)>lt?Math.tan(t):0,x=Math.pow(v,2),w=Math.pow(x,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=mg(t,o,l,this.en);s=this.a*(this.k0*h*(1+g/6*(1-x+m+g/20*(5-18*x+w+14*m-58*x*m+g/42*(61+179*w-w*x-479*x)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+g/12*(5-x+9*m+4*y+g/30*(61+w-58*x+270*m-330*x*m+g/56*(1385+543*w-w*x-3111*x))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<lt)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(a),c>=1){if(c-1>lt)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function Sde(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=GC(e,this.es,this.en),Math.abs(t)<He){var g=Math.sin(t),m=Math.cos(t),y=Math.abs(m)>lt?Math.tan(t):0,v=this.ep2*Math.pow(m,2),x=Math.pow(v,2),w=Math.pow(y,2),T=Math.pow(w,2);e=1-this.es*Math.pow(g,2);var b=s*Math.sqrt(e)/this.k0,A=Math.pow(b,2);e=e*y,r=t-e*A/(1-this.es)*.5*(1-A/12*(5+3*w-9*v*w+v-4*x-A/30*(61+90*w-252*v*w+45*T+46*v-A/56*(1385+3633*w+4095*T+1574*T*w)))),i=mt(this.long0+b*(1-A/6*(1+2*w+v-A/20*(5+28*w+24*T+8*v*w+6*v-A/42*(61+662*w+1320*T+720*T*w))))/m,this.over)}else r=He*X1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),c=this.lat0+a/this.k0,h=Math.cos(c);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=mt(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var Tde=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const v_={init:wde,forward:Ede,inverse:Sde,names:Tde};function jV(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function js(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function bde(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function Ade(n){var e=Math.abs(n);return e=bde(e*(1+e/(js(1,e)+1))),n<0?-e:e}function zC(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function Rde(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function Ide(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function VV(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=jV(t),a=Ide(t),o=2*i*a,l=-2*r*s,c=n.length-1,h=n[c],g=0,m=0,y=0,v,x;--c>=0;)v=m,x=g,m=h,g=y,h=-v+o*m-l*g+n[c],y=-x+l*m+o*g;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function Cde(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(v_.init.apply(this),this.forward=v_.forward,this.inverse=v_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=zC(this.cbg,this.lat0);this.Zb=-this.Qn*(r+Rde(this.gtu,2*r))}function kde(n){var e=mt(n.x-this.long0,this.over),t=n.y;t=zC(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,js(r,i*a)),e=Ade(Math.tan(e));var o=VV(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,c=1/0),n.x=l,n.y=c,n}function Pde(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=VV(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(jV(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),c=Math.cos(e);t=Math.atan2(a*c,js(l,c*o)),e=Math.atan2(l,c*o),r=mt(e+this.long0,this.over),i=zC(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var Mde=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const w_={init:Cde,forward:kde,inverse:Pde,names:Mde};function Nde(n,e){if(n===void 0){if(n=Math.floor((mt(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var Lde="etmerc";function Ode(){var n=Nde(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Lr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,w_.init.apply(this),this.forward=w_.forward,this.inverse=w_.inverse}var Dde=["Universal Transverse Mercator System","utm"];const Fde={init:Ode,names:Dde,dependsOn:Lde};function UC(n,e){return Math.pow((1-n)/(1+n),e)}var jde=20;function Vde(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Bn)/(Math.pow(Math.tan(.5*this.lat0+Bn),this.C)*UC(this.e*n,this.ratexp))}function Bde(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Bn),this.C)*UC(this.e*Math.sin(t),this.ratexp))-He,n.x=this.C*e,n}function Gde(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+Bn)/this.K,1/this.C),s=jde;s>0&&(r=2*Math.atan(i*UC(this.e*Math.sin(n.y),-.5*this.e))-He,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const $C={init:Vde,forward:Bde,inverse:Gde};function zde(){$C.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Ude(n){var e,t,r,i;return n.x=mt(n.x-this.long0,this.over),$C.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function $de(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=js(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,$C.inverse.apply(this,[n]),n.x=mt(n.x+this.long0,this.over),n}var Wde=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Hde={init:zde,forward:Ude,inverse:$de,names:Wde};function WC(n,e,t){return e*=t,Math.tan(.5*(He+n))*Math.pow((1-e)/(1+e),.5*t)}function Kde(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=lt&&(this.k0=.5*(1+X1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=lt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=lt&&Math.abs(Math.cos(this.lat_ts))>lt&&(this.k0=.5*this.cons*gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/wo(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=gl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(WC(this.lat0,this.sinlat0,this.e))-He,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Xde(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,c,h,g=mt(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=lt&&Math.abs(t+this.lat0)<=lt?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(g)),n.x=this.a*s*i*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(g))+this.y0,n):(a=2*Math.atan(WC(t,r,this.e))-He,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=lt?(c=wo(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*c/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<lt?(s=2*this.a*this.k0/(1+l*Math.cos(g)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(g))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(g))+this.y0),n.x=s*l*Math.sin(g)+this.x0,n))}function qde(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=lt?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<lt?this.lat0>0?e=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=mt(this.long0+Math.atan2(n.x,n.y),this.over):e=mt(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=lt){if(a<=lt)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*Jp(this.e,r),e=this.con*mt(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=lt?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=mt(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*Jp(this.e,Math.tan(.5*(He+s)));return n.x=e,n.y=t,n}var Yde=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Zde={init:Kde,forward:Xde,inverse:qde,names:Yde,ssfn_:WC};function Qde(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),c=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*c}function Jde(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function efe(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,c=s,h=-1e3,g=0;Math.abs(c-h)>1e-7;){if(++g>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=c,n}var tfe=["somerc"];const nfe={init:Qde,forward:Jde,inverse:efe,names:tfe};var Yf=1e-7;function rfe(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(RV(t))!==-1}function ife(){var n,e,t,r,i,s,a,o,l,c,h=0,g,m=0,y=0,v=0,x=0,w=0,T=0;this.no_off=rfe(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var A=!1;if("rectified_grid_angle"in this&&(A=!0),b&&(T=this.alpha),A&&(h=this.rectified_grid_angle),b||A)m=this.longc;else if(y=this.long1,x=this.lat1,v=this.long2,w=this.lat2,Math.abs(x-w)<=Yf||(n=Math.abs(x))<=Yf||Math.abs(n-He)<=Yf||Math.abs(Math.abs(this.lat0)-He)<=Yf||Math.abs(Math.abs(w)-He)<=Yf)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>lt?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(wo(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||A?(b?(g=Math.asin(Math.sin(T)/r),A||(h=T)):(g=h,T=Math.asin(r*Math.sin(g))),this.lam0=m-Math.asin(.5*(i-1/i)*Math.tan(g))/this.B):(s=Math.pow(wo(this.e,x,Math.sin(x)),this.B),a=Math.pow(wo(this.e,w,Math.sin(w)),this.B),i=this.E/s,l=(a-s)/(a+s),c=this.E*this.E,c=(c-a*s)/(c+a*s),n=y-v,n<-Math.PI?v-=Zp:n>Math.PI&&(v+=Zp),this.lam0=mt(.5*(y+v)-Math.atan(c*Math.tan(.5*this.B*(y-v))/l)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*mt(y-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(Bn-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Bn+i))}function sfe(n){var e={},t,r,i,s,a,o,l,c;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-He)>lt){if(a=this.E/Math.pow(wo(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<lt)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Yf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else c=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function afe(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<lt)l.x=0,l.y=o<0?-He:He;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=Jp(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var ofe=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const lfe={init:ife,forward:sfe,inverse:afe,names:ofe};function cfe(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<lt)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=gl(this.e,e,t),i=wo(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=gl(this.e,s,a),l=wo(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-He)<lt?0:wo(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>lt?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function ufe(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=lt&&(t=X1(t)*(He-2*lt));var r=Math.abs(Math.abs(t)-He),i,s;if(r>lt)i=wo(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*mt(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function hfe(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=Jp(this.e,r),i===-9999)return null}else i=-He;return s=mt(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var dfe=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const ffe={init:cfe,forward:ufe,inverse:hfe,names:dfe};function gfe(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function mfe(n){var e,t,r,i,s,a,o,l=n.x,c=n.y,h=mt(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function pfe(n){var e,t,r,i,s,a,o,l,c=n.x;n.x=n.y,n.y=c,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var yfe=["Krovak","krovak"];const xfe={init:gfe,forward:mfe,inverse:pfe,names:yfe};function Es(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function q1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Y1(n){return .375*n*(1+.25*n*(1+.46875*n))}function Z1(n){return .05859375*n*n*(1+.75*n)}function Q1(n){return n*n*n*(35/3072)}function HC(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Xu(n){return Math.abs(n)<He?n:n-X1(n)*Math.PI}function Gv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function _fe(){this.sphere||(this.e0=q1(this.es),this.e1=Y1(this.es),this.e2=Z1(this.es),this.e3=Q1(this.es),this.ml0=this.a*Es(this.e0,this.e1,this.e2,this.e3,this.lat0))}function vfe(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=HC(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),h=c*c,g=this.es*a*a/(1-this.es),m=this.a*Es(this.e0,this.e1,this.e2,this.e3,i);e=o*c*(1-h*l*(1/6-(8-l+8*g)*h/120)),t=m-this.ml0+o*s/a*h*(.5+(5-l+6*g)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function wfe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=Gv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-He)<=lt)return n.x=this.long0,n.y=He,t<0&&(n.y*=-1),n;var l=HC(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),g=e*this.a/l,m=g*g;r=o-l*Math.tan(o)/c*g*g*(.5-(1+3*h)*g*g/24),i=g*(1-m*(h/3+(1+3*h)*h*m/15))/Math.cos(o)}return n.x=mt(i+this.long0,this.over),n.y=Xu(r),n}var Efe=["Cassini","Cassini_Soldner","cass"];const Sfe={init:_fe,forward:vfe,inverse:wfe,names:Efe};function Iu(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var IA=1,CA=2,kA=3,E_=4;function Tfe(){var n=Math.abs(this.lat0);if(Math.abs(n-He)<lt?this.mode=this.lat0<0?IA:CA:Math.abs(n)<lt?this.mode=kA:this.mode=E_,this.es>0){var e;switch(this.qp=Iu(this.e,1),this.mmf=.5/(1-this.es),this.apa=Nfe(this.es),this.mode){case CA:this.dd=1;break;case IA:this.dd=1;break;case kA:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case E_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Iu(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===E_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function bfe(n){var e,t,r,i,s,a,o,l,c,h,g=n.x,m=n.y;if(g=mt(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),h=Math.cos(m),r=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=lt)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(m+this.lat0)<lt)return null;t=Bn-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=r}}else{switch(o=0,l=0,c=0,r=Math.cos(g),i=Math.sin(g),s=Math.sin(m),a=Iu(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=He+m,a=this.qp-a;break;case this.S_POLE:c=m-He,a=this.qp+a;break}if(Math.abs(c)<lt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?t=this.ymf*c*(this.cosb1*o-this.sinb1*l*r):t=(c=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(c=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?c:-c)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function Afe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,c;if(this.sphere){var h=0,g,m=0;if(g=Math.sqrt(e*e+t*t),i=g*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(g)<=lt?0:Math.asin(t*m/g),e*=m,t=h*g;break;case this.OBLIQ:i=Math.abs(g)<=lt?this.lat0:Math.asin(h*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*g;break;case this.N_POLE:t=-t,i=He-i;break;case this.S_POLE:i-=He;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<lt)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(c=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*c,t=l*this.cosb1*s-t*this.sinb1*a):(c=t*a/l,o=this.qp*c,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;c=1-o/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,t),i=Lfe(Math.asin(c),this.apa)}return n.x=mt(this.long0+r,this.over),n.y=i,n}var Rfe=.3333333333333333,Ife=.17222222222222222,Cfe=.10257936507936508,kfe=.06388888888888888,Pfe=.0664021164021164,Mfe=.016415012942191543;function Nfe(n){var e,t=[];return t[0]=n*Rfe,e=n*n,t[0]+=e*Ife,t[1]=e*kfe,e*=n,t[0]+=e*Cfe,t[1]+=e*Pfe,t[2]=e*Mfe,t}function Lfe(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Ofe=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Dfe={init:Tfe,forward:bfe,inverse:Afe,names:Ofe,S_POLE:IA,N_POLE:CA,EQUIT:kA,OBLIQ:E_};function Vu(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Ffe(){Math.abs(this.lat1+this.lat2)<lt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=gl(this.e3,this.sin_po,this.cos_po),this.qs1=Iu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=gl(this.e3,this.sin_po,this.cos_po),this.qs2=Iu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Iu(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>lt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function jfe(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=Iu(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*mt(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function Vfe(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=mt(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function Bfe(n,e){var t,r,i,s,a,o=Vu(.5*e);if(n<lt)return o;for(var l=n*n,c=1;c<=25;c++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var Gfe=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const zfe={init:Ffe,forward:jfe,inverse:Vfe,names:Gfe,phi1z:Bfe};function Ufe(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function $fe(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=lt?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Wfe(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=Vu(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=mt(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var Hfe=["gnom"];const Kfe={init:Ufe,forward:$fe,inverse:Wfe,names:Hfe};function Xfe(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*He:He;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function qfe(){this.sphere||(this.k0=gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Yfe(n){var e=n.x,t=n.y,r,i,s=mt(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=Iu(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function Zfe(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=mt(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=Xfe(this.e,2*n.y*this.k0/this.a),e=mt(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var Qfe=["cea"];const Jfe={init:qfe,forward:Yfe,inverse:Zfe,names:Qfe};function e0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function t0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=Xu(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function n0e(n){var e=n.x,t=n.y;return n.x=mt(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Xu(this.lat0+(t-this.y0)/this.a),n}var r0e=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const i0e={init:e0e,forward:t0e,inverse:n0e,names:r0e};var o5=20;function s0e(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=q1(this.es),this.e1=Y1(this.es),this.e2=Z1(this.es),this.e3=Q1(this.es),this.ml0=this.a*Es(this.e0,this.e1,this.e2,this.e3,this.lat0)}function a0e(n){var e=n.x,t=n.y,r,i,s,a=mt(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=lt?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Xu(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=lt)r=this.a*a,i=-1*this.ml0;else{var o=HC(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*Es(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function o0e(n){var e,t,r,i,s,a,o,l,c;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=lt)e=mt(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=o5;s;--s)if(h=Math.tan(l),c=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=c,Math.abs(c)<=lt){t=l;break}e=mt(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=lt)t=0,e=mt(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var g,m,y,v,x;for(s=o5;s;--s)if(x=this.e*Math.sin(l),g=Math.sqrt(1-x*x)*Math.tan(l),m=this.a*Es(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),v=m/this.a,c=(a*(g*v+1)-v-.5*g*(v*v+o))/(this.es*Math.sin(2*l)*(v*v+o-2*a*v)/(4*g)+(a-v)*(g*y-2/Math.sin(2*l))-y),l-=c,Math.abs(c)<=lt){t=l;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=mt(this.long0+Math.asin(r*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var l0e=["Polyconic","American_Polyconic","poly"];const c0e={init:s0e,forward:a0e,inverse:o0e,names:l0e};function u0e(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function h0e(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/Qm*1e-5,o=s,l=1,c=0;for(e=1;e<=10;e++)l=l*a,c=c+this.A[e]*l;var h=c,g=o,m=1,y=0,v,x,w=0,T=0;for(e=1;e<=6;e++)v=m*h-y*g,x=y*h+m*g,m=v,y=x,w=w+this.B_re[e]*m-this.B_im[e]*y,T=T+this.B_im[e]*m+this.B_re[e]*y;return n.x=T*this.a+this.x0,n.y=w*this.a+this.y0,n}function d0e(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,c=0,h,g,m=0,y=0;for(e=1;e<=6;e++)h=l*a-c*o,g=c*a+l*o,l=h,c=g,m=m+this.C_re[e]*l-this.C_im[e]*c,y=y+this.C_im[e]*l+this.C_re[e]*c;for(var v=0;v<this.iterations;v++){var x=m,w=y,T,b,A=a,M=o;for(e=2;e<=6;e++)T=x*m-w*y,b=w*m+x*y,x=T,w=b,A=A+(e-1)*(this.B_re[e]*x-this.B_im[e]*w),M=M+(e-1)*(this.B_im[e]*x+this.B_re[e]*w);x=1,w=0;var O=this.B_re[1],z=this.B_im[1];for(e=2;e<=6;e++)T=x*m-w*y,b=w*m+x*y,x=T,w=b,O=O+e*(this.B_re[e]*x-this.B_im[e]*w),z=z+e*(this.B_im[e]*x+this.B_re[e]*w);var I=O*O+z*z;m=(A*O+M*z)/I,y=(M*O-A*z)/I}var R=m,P=y,F=1,N=0;for(e=1;e<=9;e++)F=F*R,N=N+this.D[e]*F;var B=this.lat0+N*Qm*1e5,j=this.long0+P;return n.x=j,n.y=B,n}var f0e=["New_Zealand_Map_Grid","nzmg"];const g0e={init:u0e,forward:h0e,inverse:d0e,names:f0e};function m0e(){}function p0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function y0e(n){n.x-=this.x0,n.y-=this.y0;var e=mt(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var x0e=["Miller_Cylindrical","mill"];const _0e={init:m0e,forward:p0e,inverse:y0e,names:x0e};var v0e=20;function w0e(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=BC(this.es)}function E0e(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=v0e;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<lt)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);t=this.a*mg(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function S0e(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Vu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Vu(Math.sin(e)/this.n)),r=mt(r+this.long0,this.over),e=Xu(e)):(e=GC(n.y/this.a,this.es,this.en),i=Math.abs(e),i<He?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=mt(t,this.over)):i-lt<He&&(r=this.long0)),n.x=r,n.y=e,n}var T0e=["Sinusoidal","sinu"];const b0e={init:w0e,forward:E0e,inverse:S0e,names:T0e};function A0e(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function R0e(n){for(var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<lt)break}i/=2,Math.PI/2-Math.abs(t)<lt&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function I0e(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=mt(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var C0e=["Mollweide","moll"];const k0e={init:A0e,forward:R0e,inverse:I0e,names:C0e};function P0e(){Math.abs(this.lat1+this.lat2)<lt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=q1(this.es),this.e1=Y1(this.es),this.e2=Z1(this.es),this.e3=Q1(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=gl(this.e,this.sin_phi,this.cos_phi),this.ml1=Es(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<lt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=gl(this.e,this.sin_phi,this.cos_phi),this.ml2=Es(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Es(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function M0e(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=Es(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*mt(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function N0e(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=mt(this.long0+s/this.ns,this.over),r=Xu(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=Gv(a,this.e0,this.e1,this.e2,this.e3),i=mt(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var L0e=["Equidistant_Conic","eqdc"];const O0e={init:P0e,forward:M0e,inverse:N0e,names:L0e};function D0e(){this.R=this.a}function F0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s;Math.abs(t)<=lt&&(i=this.x0+this.R*r,s=this.y0);var a=Vu(2*Math.abs(t/Math.PI));(Math.abs(r)<=lt||Math.abs(Math.abs(t)-He)<=lt)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,c=Math.sin(a),h=Math.cos(a),g=h/(c+h-1),m=g*g,y=g*(2/c-1),v=y*y,x=Math.PI*this.R*(o*(g-v)+Math.sqrt(l*(g-v)*(g-v)-(v+l)*(m-v)))/(v+l);r<0&&(x=-x),i=this.x0+x;var w=l+g;return x=Math.PI*this.R*(y*w-o*Math.sqrt((v+l)*(l+1)-w*w))/(v+l),t>=0?s=this.y0+x:s=this.y0-x,n.x=i,n.y=s,n}function j0e(n){var e,t,r,i,s,a,o,l,c,h,g,m,y;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,r=n.x/g,i=n.y/g,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,c=(a-o*o/3/l)/l,h=2*Math.sqrt(-c/3),g=3*y/c/h,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<lt?e=this.long0:e=mt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var V0e=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const B0e={init:D0e,forward:F0e,inverse:j0e,names:V0e};function G0e(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),c=Math.sin(o),h=Math.cos(o),g=Math.sin(l),m=Math.cos(l);let y=a,v,x=100,w,T,b,A,M,O,z,I,R,P,F,N,B,j;do{if(w=Math.sin(y),T=Math.cos(y),b=Math.sqrt(m*w*(m*w)+(h*g-c*m*T)*(h*g-c*m*T)),b===0)return{azi1:0,s12:0};A=c*g+h*m*T,M=Math.atan2(b,A),O=h*m*w/b,z=1-O*O,I=z!==0?A-2*c*g/z:0,R=s/16*z*(4+s*(4-3*z)),v=y,y=a+(1-R)*s*O*(M+R*b*(I+R*A*(-1+2*I*I)))}while(Math.abs(y-v)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(P=z*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),F=1+P/16384*(4096+P*(-768+P*(320-175*P))),N=P/1024*(256+P*(-128+P*(74-47*P))),B=N*b*(I+N/4*(A*(-1+2*I*I)-N/6*I*(-3+4*b*b)*(-3+4*I*I))),j=i*(1-s)*F*(M-B),{azi1:Math.atan2(m*w,h*g-c*m*T),s12:j})}function z0e(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),c=Math.sin(t),h=Math.cos(t),g=Math.atan2(o,l*h),m=l*c,y=1-m*m,v=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+v/16384*(4096+v*(-768+v*(320-175*v))),w=v/1024*(256+v*(-128+v*(74-47*v)));let T=r/(i*(1-s)*x),b,A=100,M,O,z,I;do M=Math.cos(2*g+T),O=Math.sin(T),z=Math.cos(T),I=w*O*(M+w/4*(z*(-1+2*M*M)-w/6*M*(-3+4*O*O)*(-3+4*M*M))),b=T,T=r/(i*(1-s)*x)+I;while(Math.abs(T-b)>1e-12&&--A>0);if(A===0)return{lat2:NaN,lon2:NaN};const R=o*O-l*z*h,P=Math.atan2(o*z+l*O*h,(1-s)*Math.sqrt(m*m+R*R)),F=Math.atan2(O*c,l*z-o*O*h),N=s/16*y*(4+s*(4-3*y)),B=F-(1-N)*s*m*(T+N*O*(M+N*z*(-1+2*M*M))),j=e+B;return{lat2:P,lon2:j}}function U0e(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function $0e(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=mt(e-this.long0,this.over),a,o,l,c,h,g,m,y,v,x,w;return this.sphere?Math.abs(this.sin_p12-1)<=lt?(n.x=this.x0+this.a*(He-t)*Math.sin(s),n.y=this.y0-this.a*(He-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=lt?(n.x=this.x0+this.a*(He+t)*Math.sin(s),n.y=this.y0+this.a*(He+t)*Math.cos(s),n):(v=this.sin_p12*r+this.cos_p12*i*Math.cos(s),m=Math.acos(v),y=m?m/Math.sin(m):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=q1(this.es),o=Y1(this.es),l=Z1(this.es),c=Q1(this.es),Math.abs(this.sin_p12-1)<=lt?(h=this.a*Es(a,o,l,c,He),g=this.a*Es(a,o,l,c,t),n.x=this.x0+(h-g)*Math.sin(s),n.y=this.y0-(h-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=lt?(h=this.a*Es(a,o,l,c,He),g=this.a*Es(a,o,l,c,t),n.x=this.x0+(h+g)*Math.sin(s),n.y=this.y0+(h+g)*Math.cos(s),n):Math.abs(e)<lt&&Math.abs(t-this.lat0)<lt?(n.x=n.y=0,n):(x=G0e(this.lat0,this.long0,t,e,this.a,this.f),w=x.azi1,n.x=x.s12*Math.sin(w),n.y=x.s12*Math.cos(w),n))}function W0e(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,c,h,g,m,y,v,x,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*He*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=lt?a=this.lat0:(a=Vu(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-He,Math.abs(o)<=lt?this.lat0>=0?s=mt(this.long0+Math.atan2(n.x,-n.y),this.over):s=mt(this.long0-Math.atan2(-n.x,n.y),this.over):s=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=q1(this.es),c=Y1(this.es),h=Z1(this.es),g=Q1(this.es),Math.abs(this.sin_p12-1)<=lt?(m=this.a*Es(l,c,h,g,He),e=Math.sqrt(n.x*n.x+n.y*n.y),y=m-e,a=Gv(y/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=lt?(m=this.a*Es(l,c,h,g,He),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-m,a=Gv(y/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(v=Math.atan2(n.x,n.y),x=Math.sqrt(n.x*n.x+n.y*n.y),w=z0e(this.lat0,this.long0,v,x,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var H0e=["Azimuthal_Equidistant","aeqd"];const K0e={init:U0e,forward:$0e,inverse:W0e,names:H0e};function X0e(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function q0e(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=lt)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Y0e(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Vu(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=lt?(o=this.lat0,n.x=a,n.y=o,n):(o=Vu(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-He,Math.abs(s)<=lt?(this.lat0>=0?a=mt(this.long0+Math.atan2(n.x,-n.y),this.over):a=mt(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var Z0e=["ortho"];const Q0e={init:X0e,forward:q0e,inverse:Y0e,names:Z0e};var Cr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Gn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function J0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=He-Bn/2?this.face=Cr.TOP:this.lat0<=-(He-Bn/2)?this.face=Cr.BOTTOM:Math.abs(this.long0)<=Bn?this.face=Cr.FRONT:Math.abs(this.long0)<=He+Bn?this.face=this.long0>0?Cr.RIGHT:Cr.LEFT:this.face=Cr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function ege(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Cr.TOP)s=He-t,r>=Bn&&r<=He+Bn?(l.value=Gn.AREA_0,i=r-He):r>He+Bn||r<=-(He+Bn)?(l.value=Gn.AREA_1,i=r>0?r-$r:r+$r):r>-(He+Bn)&&r<=-Bn?(l.value=Gn.AREA_2,i=r+He):(l.value=Gn.AREA_3,i=r);else if(this.face===Cr.BOTTOM)s=He+t,r>=Bn&&r<=He+Bn?(l.value=Gn.AREA_0,i=-r+He):r<Bn&&r>=-Bn?(l.value=Gn.AREA_1,i=-r):r<-Bn&&r>=-(He+Bn)?(l.value=Gn.AREA_2,i=-r-He):(l.value=Gn.AREA_3,i=r>0?-r+$r:-r-$r);else{var c,h,g,m,y,v,x;this.face===Cr.RIGHT?r=w0(r,+He):this.face===Cr.BACK?r=w0(r,+$r):this.face===Cr.LEFT&&(r=w0(r,-He)),m=Math.sin(t),y=Math.cos(t),v=Math.sin(r),x=Math.cos(r),c=y*x,h=y*v,g=m,this.face===Cr.FRONT?(s=Math.acos(c),i=jx(s,g,h,l)):this.face===Cr.RIGHT?(s=Math.acos(h),i=jx(s,g,-c,l)):this.face===Cr.BACK?(s=Math.acos(-c),i=jx(s,g,-h,l)):this.face===Cr.LEFT?(s=Math.acos(-h),i=jx(s,g,c,l)):(s=i=0,l.value=Gn.AREA_0)}return o=Math.atan(12/$r*(i+Math.acos(Math.sin(i)*Math.cos(Bn))-He)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Gn.AREA_1?o+=He:l.value===Gn.AREA_2?o+=$r:l.value===Gn.AREA_3&&(o+=1.5*$r),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function tge(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,c,h,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=Gn.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=Gn.AREA_1,t-=He):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=Gn.AREA_2,t=t<0?t+$r:t-$r):(g.value=Gn.AREA_3,t+=He),h=$r/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===Cr.TOP)c=Math.acos(l),e.phi=He-c,g.value===Gn.AREA_0?e.lam=o+He:g.value===Gn.AREA_1?e.lam=o<0?o+$r:o-$r:g.value===Gn.AREA_2?e.lam=o-He:e.lam=o;else if(this.face===Cr.BOTTOM)c=Math.acos(l),e.phi=c-He,g.value===Gn.AREA_0?e.lam=-o+He:g.value===Gn.AREA_1?e.lam=-o:g.value===Gn.AREA_2?e.lam=-o-He:e.lam=o<0?-o-$r:-o+$r;else{var m,y,v;m=l,h=m*m,h>=1?v=0:v=Math.sqrt(1-h)*Math.sin(o),h+=v*v,h>=1?y=0:y=Math.sqrt(1-h),g.value===Gn.AREA_1?(h=y,y=-v,v=h):g.value===Gn.AREA_2?(y=-y,v=-v):g.value===Gn.AREA_3&&(h=y,y=v,v=-h),this.face===Cr.RIGHT?(h=m,m=-y,y=h):this.face===Cr.BACK?(m=-m,y=-y):this.face===Cr.LEFT&&(h=m,m=y,y=-h),e.phi=Math.acos(-v)-He,e.lam=Math.atan2(y,m),this.face===Cr.RIGHT?e.lam=w0(e.lam,-He):this.face===Cr.BACK?e.lam=w0(e.lam,-$r):this.face===Cr.LEFT&&(e.lam=w0(e.lam,+He))}if(this.es!==0){var x,w,T;x=e.phi<0?1:0,w=Math.tan(e.phi),T=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function jx(n,e,t,r){var i;return n<lt?(r.value=Gn.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=Bn?r.value=Gn.AREA_0:i>Bn&&i<=He+Bn?(r.value=Gn.AREA_1,i-=He):i>He+Bn||i<=-(He+Bn)?(r.value=Gn.AREA_2,i=i>=0?i-$r:i+$r):(r.value=Gn.AREA_3,i+=He)),i}function w0(n,e){var t=n+e;return t<-$r?t+=Zp:t>+$r&&(t-=Zp),t}var nge=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const rge={init:J0e,forward:ege,inverse:tge,names:nge};var PA=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Nm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],BV=.8487,GV=1.3523,zV=Bs/5,ige=1/zV,c0=18,zv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},sge=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function age(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function oge(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function lge(n){var e=mt(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*zV);r<0?r=0:r>=c0&&(r=c0-1),t=Bs*(t-ige*r);var i={x:zv(PA[r],t)*e,y:zv(Nm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*BV+this.x0,i.y=i.y*this.a*GV+this.y0,i}function cge(n){var e={x:(n.x-this.x0)/(this.a*BV),y:Math.abs(n.y-this.y0)/(this.a*GV)};if(e.y>=1)e.x/=PA[c0][0],e.y=n.y<0?-He:He;else{var t=Math.floor(e.y*c0);for(t<0?t=0:t>=c0&&(t=c0-1);;)if(Nm[t][0]>e.y)--t;else if(Nm[t+1][0]<=e.y)++t;else break;var r=Nm[t],i=5*(e.y-r[0])/(Nm[t+1][0]-r[0]);i=age(function(s){return(zv(r,s)-e.y)/sge(r,s)},i,lt,100),e.x/=zv(PA[t],i),e.y=(5*t+i)*Lr,n.y<0&&(e.y=-e.y)}return e.x=mt(e.x+this.long0,this.over),e}var uge=["Robinson","robin"];const hge={init:oge,forward:lge,inverse:cge,names:uge};function dge(){this.name="geocent"}function fge(n){var e=CV(n,this.es,this.a);return e}function gge(n){var e=kV(n,this.es,this.a,this.b);return e}var mge=["Geocentric","geocentric","geocent","Geocent"];const pge={init:dge,forward:fge,inverse:gge,names:mge};var ss={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},ym={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function yge(){if(Object.keys(ym).forEach((function(t){if(typeof this[t]>"u")this[t]=ym[t].def;else{if(ym[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);ym[t].num&&(this[t]=parseFloat(this[t]))}ym[t].degrees&&(this[t]=this[t]*Lr)}).bind(this)),Math.abs(Math.abs(this.lat0)-He)<lt?this.mode=this.lat0<0?ss.S_POLE:ss.N_POLE:Math.abs(this.lat0)<lt?this.mode=ss.EQUIT:(this.mode=ss.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function xge(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case ss.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case ss.EQUIT:s=t*r;break;case ss.S_POLE:s=-e;break;case ss.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case ss.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case ss.EQUIT:s*=e;break;case ss.N_POLE:s*=-(t*r);break;case ss.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function _ge(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=js(n.x,n.y);if(Math.abs(s)<lt)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case ss.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case ss.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case ss.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case ss.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var vge=["Tilted_Perspective","tpers"];const wge={init:yge,forward:xge,inverse:_ge,names:vge};function Ege(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Sge(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/js(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/js(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/js(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/js(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/js(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Tge(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*js(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*js(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var bge=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Age={init:Ege,forward:Sge,inverse:Tge,names:bge};var Jm=1.340264,ep=-.081106,tp=893e-6,np=.003796,Uv=Math.sqrt(3)/2;function Rge(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Ige(n){var e=mt(n.x-this.long0,this.over),t=n.y,r=Math.asin(Uv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(Uv*(Jm+3*ep*i+s*(7*tp+9*np*i))),n.y=r*(Jm+ep*i+s*(tp+np*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Cge(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,c;for(c=0;c<t&&(i=r*r,s=i*i*i,a=r*(Jm+ep*i+s*(tp+np*i))-n.y,o=Jm+3*ep*i+s*(7*tp+9*np*i),r-=l=a/o,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,n.x=Uv*n.x*(Jm+3*ep*i+s*(7*tp+9*np*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/Uv),n.x=mt(n.x+this.long0,this.over),n}var kge=["eqearth","Equal Earth","Equal_Earth"];const Pge={init:Rge,forward:Ige,inverse:Cge,names:kge};var e1=1e-10;function Mge(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<e1)throw new Error;this.es?(this.en=BC(this.es),this.m1=mg(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Lge,this.forward=Nge):(Math.abs(this.phi1)+e1>=He?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Dge,this.forward=Oge)}function Nge(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-mg(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Lge(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=js(n.x,n.y=this.am1-n.y),i=GC(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<He)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-He)<=e1)r=0;else throw new Error;return n.x=mt(r+(this.long0||0),this.over),n.y=Xu(i),n}function Oge(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>e1?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Dge(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=js(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>He)throw new Error;return Math.abs(Math.abs(t)-He)<=e1?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=mt(e+(this.long0||0),this.over),n.y=Xu(t),n}var Fge=["bonne","Bonne (Werner lat_1=90)"];const jge={init:Mge,names:Fge},l5={OBLIQUE:{forward:Uge,inverse:Wge},TRANSVERSE:{forward:$ge,inverse:Hge}},$v={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Vge(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=bV.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ba(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys($v),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Lr;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],c=$v[l],h=Object.entries(c);if(h.some(([m])=>typeof this[m]<"u")){t=c;for(let m=0;m<h.length;m++){const[y,v]=h[m],x=i(y);if(typeof x>"u")throw new Error("Missing parameter: "+y+".");this[v]=x}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=zge(this,t);this.lamp=s,Math.abs(a)>lt?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=l5.OBLIQUE):this.projectionType=l5.TRANSVERSE}function Bge(n){return this.projectionType.forward(this,n)}function Gge(n){return this.projectionType.inverse(this,n)}function zge(n,e){let t,r;if(e===$v.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-He)<=lt)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===$v.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>He-lt)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>He-lt)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<lt)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<lt)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function Uge(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=mt(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Bs,o.y*=Bs),o}function $ge(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=mt(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Bs,a.y*=Bs),a}function Wge(n,e){n.isIdentity&&(e.x*=Lr,e.y*=Lr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=mt(e.x+n.long0),e}function Hge(n,e){n.isIdentity&&(e.x*=Lr,e.y*=Lr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=mt(e.x+n.long0),e}var Kge=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Xge={init:Vge,forward:Bge,inverse:Gge,names:Kge};function qge(n){n.Proj.projections.add(v_),n.Proj.projections.add(w_),n.Proj.projections.add(Fde),n.Proj.projections.add(Hde),n.Proj.projections.add(Zde),n.Proj.projections.add(nfe),n.Proj.projections.add(lfe),n.Proj.projections.add(ffe),n.Proj.projections.add(xfe),n.Proj.projections.add(Sfe),n.Proj.projections.add(Dfe),n.Proj.projections.add(zfe),n.Proj.projections.add(Kfe),n.Proj.projections.add(Jfe),n.Proj.projections.add(i0e),n.Proj.projections.add(c0e),n.Proj.projections.add(g0e),n.Proj.projections.add(_0e),n.Proj.projections.add(b0e),n.Proj.projections.add(k0e),n.Proj.projections.add(O0e),n.Proj.projections.add(B0e),n.Proj.projections.add(K0e),n.Proj.projections.add(Q0e),n.Proj.projections.add(rge),n.Proj.projections.add(hge),n.Proj.projections.add(pge),n.Proj.projections.add(wge),n.Proj.projections.add(Age),n.Proj.projections.add(Pge),n.Proj.projections.add(jge),n.Proj.projections.add(Xge)}const bn=Object.assign(ede,{defaultDatum:"WGS84",Proj:Ba,WGS84:new Ba("WGS84"),Point:eg,toPoint:PV,defs:ji,nadgrid:Dhe,transform:Bv,mgrs:tde,version:"__VERSION__"});qge(bn);class UV{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=gr,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?er(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=er(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Wt()}readFeature(e,t){return Wt()}readFeatures(e,t){return Wt()}readGeometry(e,t){return Wt()}readProjection(e){return Wt()}writeFeature(e,t){return Wt()}writeFeatures(e,t){return Wt()}writeGeometry(e,t){return Wt()}}function bo(n,e,t){const r=t?er(t.featureProjection):null,i=t?er(t.dataProjection):null;let s=n;if(r&&i&&!Kh(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(pp(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const Yge={Point:ri,LineString:bi,Polygon:Ua,MultiPoint:Cd,MultiLineString:ic,MultiPolygon:ad};function Zge(n,e,t){return Array.isArray(e[0])?(oF(n,0,e,t)||(n=n.slice(),ob(n,0,e,t)),n):(fR(n,0,e,t)||(n=n.slice(),F_(n,0,e,t)),n)}function $V(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>$V({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return bo(new Ds(r,r==="Polygon"?Zge(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function KC(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>KC(i,e));return new xo(r)}const t=Yge[n.type];return bo(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class Qge extends UV{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Vx(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Vx(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Wt()}readFeaturesFromObject(e,t){return Wt()}readGeometry(e,t){return this.readGeometryFromObject(Vx(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Wt()}readProjection(e){return this.readProjectionFromObject(Vx(e))}readProjectionFromObject(e){return Wt()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Wt()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Wt()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Wt()}}function Vx(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class XC extends Qge{constructor(e){e=e||{},super(),this.dataProjection=er(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=er(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=qC(r.geometry);if(this.featureClass===Ds)return $V({geometry:i,id:r.id,properties:r.properties},t);const s=new gr;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(KC(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const c=this.readFeatureFromObject(a[o],t);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return Jge(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=er(t.properties.name);else if(t.type==="EPSG")r=er("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=MA(a,t),delete s[e.getGeometryName()]),td(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return MA(e,this.adaptOptions(t))}}function qC(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=tme(n);break}case"LineString":{t=nme(n);break}case"Polygon":{t=ame(n);break}case"MultiPoint":{t=ime(n);break}case"MultiLineString":{t=rme(n);break}case"MultiPolygon":{t=sme(n);break}case"GeometryCollection":{t=eme(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function Jge(n,e){const t=qC(n);return KC(t,e)}function eme(n,e){return n.geometries.map(function(r){return qC(r)})}function tme(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:Id(e.length)}}function nme(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Id(e[0]?.length||2)}}function rme(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=y1(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:Id(t)}}function ime(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Id(e[0]?.length||2)}}function sme(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=FD(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:Id(r)}}function ame(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=y1(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:Id(r)}}function MA(n,e){n=bo(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=dme(n);break}case"LineString":{r=lme(n);break}case"Polygon":{r=fme(n,e);break}case"MultiPoint":{r=ume(n);break}case"MultiLineString":{r=cme(n);break}case"MultiPolygon":{r=hme(n,e);break}case"GeometryCollection":{r=ome(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function ome(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return MA(r,e)})}}function lme(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function cme(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function ume(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function hme(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function dme(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function fme(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const Wv="http://www.w3.org/2001/XMLSchema-instance";function Dd(n,e){return pg().createElementNS(n,e)}function Ao(n,e){return WV(n,e,[]).join("")}function WV(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)WV(r,e,t)}return t}function Hl(n){return"documentElement"in n}function Kl(n){return new DOMParser().parseFromString(n,"application/xml")}function c5(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Vn(s,i)}})}function fo(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function YC(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Ge(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function Je(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function HV(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=Ro(i.localName)}KV(t,r,s,a)}}function Ro(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return Dd(l,o)})}const ds=Ro();function Ws(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function gt(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function qu(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function _n(n,e,t,r,i){return r.push(n),qu(e,t,r,i),r.pop()}function KV(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let c=0;c<a;++c)o=t[c],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[c]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function ar(n,e,t,r,i,s,a){return i.push(n),KV(e,t,r,i,s,a),i.pop()}let IT;function gme(){return IT===void 0&&typeof XMLSerializer<"u"&&(IT=new XMLSerializer),IT}let CT;function pg(){return CT===void 0&&typeof document<"u"&&(CT=document.implementation.createDocument("","",null)),CT}class XV extends UV{constructor(){super(),this.xmlSerializer_=gme()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Kl(e);return this.readFeatureFromDocument(r,t)}return Hl(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Kl(e);return this.readFeaturesFromDocument(r,t)}return Hl(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Vn(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Wt()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Kl(e);return this.readGeometryFromDocument(r,t)}return Hl(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Kl(e);return this.readProjectionFromDocument(t)}return Hl(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function Bu(n){const e=Ao(n,!1);return mme(e)}function mme(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function SE(n){const e=Ao(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Cn(n){const e=Ao(n,!1);return pme(e)}function pme(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function t1(n){const e=Ao(n,!1);return yme(e)}function yme(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function on(n){return Ao(n,!1).trim()}function tg(n,e){On(n,e?"1":"0")}function xme(n,e){n.appendChild(pg().createCDATASection(e))}function _me(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+im(t.getUTCMonth()+1,2)+"-"+im(t.getUTCDate(),2)+"T"+im(t.getUTCHours(),2)+":"+im(t.getUTCMinutes(),2)+":"+im(t.getUTCSeconds(),2)+"Z";n.appendChild(pg().createTextNode(r))}function Ns(n,e){const t=e.toPrecision();n.appendChild(pg().createTextNode(t))}function Hv(n,e){const t=e.toString();n.appendChild(pg().createTextNode(t))}const vme=/^\s/,wme=/\s$/,Eme=/(\n|\t|\r|<|&| {2})/;function On(n,e){typeof e=="string"&&(vme.test(e)||wme.test(e)||Eme.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),xme(n,t)}):n.appendChild(pg().createTextNode(e))}const mr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Sme="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",Tme={rte:qV,trk:YV,wpt:ZV},bme=gt(mr,{rte:fo(qV),trk:fo(YV),wpt:fo(ZV)}),Ame=gt(mr,{text:Ge(on,"linkText"),type:Ge(on,"linkType")}),Rme=gt(mr,{name:Ge(on),email:epe,link:J1}),Ime=gt(mr,{name:Ge(on),desc:Ge(on),author:Ge(Zme),copyright:Ge(Qme),link:J1,time:Ge(SE),keywords:Ge(on),bounds:Jme,extensions:TE}),Cme=gt(mr,{year:Ge(t1),license:Ge(on)}),kme=gt(mr,{rte:Je(ipe),trk:Je(spe),wpt:Je(ope)});class Pme extends XV{constructor(e){super(),e=e||{},this.dataProjection=er("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Kl(e)):Hl(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!mr.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(mr.includes(t.namespaceURI)&&t.localName==="metadata")return _n({},Ime,t,[]);return null}readFeatureFromNode(e,t){if(!mr.includes(e.namespaceURI))return null;const r=Tme[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!mr.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=_n([],bme,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Dd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Wv),r.setAttributeNS(Wv,"xsi:schemaLocation",Sme),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),ar({node:r},kme,Yme,e,[t]),r}}const Mme=gt(mr,{name:Ge(on),cmt:Ge(on),desc:Ge(on),src:Ge(on),link:J1,number:Ge(t1),extensions:TE,type:Ge(on),rtept:tpe}),Nme=gt(mr,{ele:Ge(Cn),time:Ge(SE)}),Lme=gt(mr,{name:Ge(on),cmt:Ge(on),desc:Ge(on),src:Ge(on),link:J1,number:Ge(t1),type:Ge(on),extensions:TE,trkseg:rpe}),Ome=gt(mr,{trkpt:npe}),Dme=gt(mr,{ele:Ge(Cn),time:Ge(SE)}),Fme=gt(mr,{ele:Ge(Cn),time:Ge(SE),magvar:Ge(Cn),geoidheight:Ge(Cn),name:Ge(on),cmt:Ge(on),desc:Ge(on),src:Ge(on),link:J1,sym:Ge(on),type:Ge(on),fix:Ge(on),sat:Ge(t1),hdop:Ge(Cn),vdop:Ge(Cn),pdop:Ge(Cn),ageofdgpsdata:Ge(Cn),dgpsid:Ge(t1),extensions:TE}),jme=["text","type"],Vme=gt(mr,{text:Je(On),type:Je(On)}),Bme=gt(mr,["name","cmt","desc","src","link","number","type","rtept"]),Gme=gt(mr,{name:Je(On),cmt:Je(On),desc:Je(On),src:Je(On),link:Je(JC),number:Je(Hv),type:Je(On),rtept:HV(Je(ek))}),zme=gt(mr,["ele","time"]),Ume=gt(mr,["name","cmt","desc","src","link","number","type","trkseg"]),$me=gt(mr,{name:Je(On),cmt:Je(On),desc:Je(On),src:Je(On),link:Je(JC),number:Je(Hv),type:Je(On),trkseg:HV(Je(ape))}),Wme=Ro("trkpt"),Hme=gt(mr,{trkpt:Je(ek)}),Kme=gt(mr,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Xme=gt(mr,{ele:Je(Ns),time:Je(_me),magvar:Je(Ns),geoidheight:Je(Ns),name:Je(On),cmt:Je(On),desc:Je(On),src:Je(On),link:Je(JC),sym:Je(On),type:Je(On),fix:Je(On),sat:Je(Hv),hdop:Je(Ns),vdop:Je(Ns),pdop:Je(Ns),ageofdgpsdata:Je(Ns),dgpsid:Je(Hv)}),qme={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Yme(n,e,t){const r=n.getGeometry();if(r){const i=qme[r.getType()];if(i){const s=e[e.length-1].node;return Dd(s.namespaceURI,i)}}}function ZC(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function QC(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function Zme(n,e){const t=_n({},Rme,n,e);if(t)return t}function Qme(n,e){const t=_n({},Cme,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function Jme(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function epe(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function J1(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),qu(Ame,n,e)}function TE(n,e){const t=e[e.length-1];t.extensionsNode_=n}function tpe(n,e){const t=_n({},Nme,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;ZC(i,s,n,t)}}function npe(n,e){const t=_n({},Dme,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;ZC(i,s,n,t)}}function rpe(n,e){const t=e[e.length-1];qu(Ome,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function qV(n,e){const t=e[0],r=_n({flatCoordinates:[],layoutOptions:{}},Mme,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=QC(s,i),o=new bi(i,a);bo(o,!1,t);const l=new gr(o);return l.setProperties(r,!0),l}function YV(n,e){const t=e[0],r=_n({flatCoordinates:[],ends:[],layoutOptions:{}},Lme,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=QC(a,i,s),l=new ic(i,o,s);bo(l,!1,t);const c=new gr(l);return c.setProperties(r,!0),c}function ZV(n,e){const t=e[0],r=_n({},Fme,n,e);if(!r)return;const i={},s=ZC([],i,n,r),a=QC(i,s),o=new ri(s,a);bo(o,!1,t);const l=new gr(o);return l.setProperties(r,!0),l}function JC(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];ar({node:n},Vme,ds,s,t,jme)}function ek(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?zme[s]:Kme[s],c=Ws(a,l);ar({node:n,properties:a},Xme,ds,c,t,l)}function ipe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=bo(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=Bme[o.namespaceURI],c=Ws(i,l);ar(s,Gme,ds,c,t,l)}function spe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=bo(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=Ume[o.namespaceURI],c=Ws(i,l);ar(s,$me,ds,c,t,l)}function ape(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},ar(r,Hme,Wme,e.getCoordinates(),t)}function ope(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=bo(s,!0,r);i.geometryLayout=a.getLayout(),ek(n,a.getCoordinates(),t)}}const vc=["http://www.google.com/kml/ext/2.2"],Ct=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],lpe="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",u5={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},cpe=gt(Ct,{ExtendedData:dB,Region:fB,MultiGeometry:Ge(cB,"geometry"),LineString:Ge(oB,"geometry"),LinearRing:Ge(lB,"geometry"),Point:Ge(uB,"geometry"),Polygon:Ge(hB,"geometry"),Style:Ge(rk),StyleMap:Hpe,address:Ge(on),description:Ge(on),name:Ge(on),open:Ge(Bu),phoneNumber:Ge(on),styleUrl:Ge(nB),visibility:Ge(Bu)},gt(vc,{MultiTrack:Ge(Npe,"geometry"),Track:Ge(aB,"geometry")})),upe=gt(Ct,{ExtendedData:dB,Region:fB,Link:i1e,address:Ge(on),description:Ge(on),name:Ge(on),open:Ge(Bu),phoneNumber:Ge(on),visibility:Ge(Bu)}),hpe=gt(Ct,{href:Ge(tB)}),dpe=gt(Ct,{Altitude:Ge(Cn),Longitude:Ge(Cn),Latitude:Ge(Cn),Tilt:Ge(Cn),AltitudeMode:Ge(on),Heading:Ge(Cn),Roll:Ge(Cn)}),QV=gt(Ct,{LatLonAltBox:Zpe,Lod:Jpe}),fpe=gt(Ct,["Document","Placemark"]),gpe=gt(Ct,{Document:Je(d1e),Placemark:Je(pB)});let E0,S_=null,NA,rp,ip,sp,Kv,LA=null,tk,OA=null,DA,$h=null,h5=null,FA=null;function Xv(n){return 32/Math.min(n[0],n[1])}function mpe(){E0=[255,255,255,1],S_=new Xn({color:E0}),NA=[20,2],rp="pixels",ip="pixels",sp=[64,64],Kv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",LA=new sg({anchor:NA,anchorOrigin:"bottom-left",anchorXUnits:rp,anchorYUnits:ip,crossOrigin:"anonymous",rotation:0,scale:Xv(sp),size:sp,src:Kv}),tk="NO_IMAGE",OA=new zn({color:E0,width:1}),DA=new zn({color:[51,51,51,1],width:2}),$h=new ja({font:"bold 16px Helvetica",fill:S_,stroke:DA,scale:.8}),h5=new hn({fill:S_,image:LA,text:$h,stroke:OA,zIndex:0}),FA=[h5]}let Bx;function ppe(n){return n}class ype extends XV{constructor(e){super(),e=e||{},FA||mpe(),this.dataProjection=er("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:FA,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:ppe,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=gt(Ct,{Document:c5(this.readDocumentOrFolder_,this),Folder:c5(this.readDocumentOrFolder_,this),Placemark:fo(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=_n([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=_n({geometry:null},cpe,e,t,this);if(!r)return;const i=new gr,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&bo(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,h=_pe(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=rk.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=iB.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!Ct.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!Ct.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Vn(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Kl(e);return this.readNameFromDocument(t)}return Hl(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Ct.includes(t.namespaceURI)&&t.localName=="name")return on(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(Ct.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Kl(e);Vn(t,this.readNetworkLinksFromDocument(r))}else Hl(e)?Vn(t,this.readNetworkLinksFromDocument(e)):Vn(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Vn(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Ct.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=_n({},upe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Ct.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Vn(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Kl(e);Vn(t,this.readRegionFromDocument(r))}else Hl(e)?Vn(t,this.readRegionFromDocument(e)):Vn(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Vn(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Ct.includes(r.namespaceURI)&&r.localName=="Region"){const i=_n({},QV,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Ct.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Vn(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Kl(e);Vn(t,this.readCameraFromDocument(r))}else Hl(e)?Vn(t,this.readCameraFromDocument(e)):Vn(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Vn(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Ct.includes(r.namespaceURI)&&r.localName==="Camera"){const i=_n({},dpe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Ct.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Vn(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Dd(Ct[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",vc[0]),r.setAttributeNS(i,"xmlns:xsi",Wv),r.setAttributeNS(Wv,"xsi:schemaLocation",lpe);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=fpe[r.namespaceURI],l=Ws(a,o);return ar(s,gpe,ds,l,[t],o,this),r}}function xpe(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),c=i.getAnchor();t[0]=l[0]*(o[0]-c[0]),t[1]=l[1]*(o[1]/2-c[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||$h.getFont()),s.setScale(s.getScale()||$h.getScale()),s.setFill(s.getFill()||$h.getFill()),s.setStroke(s.getStroke()||DA)):s=$h.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new hn({image:i,text:s})}function _pe(n,e,t,r,i){return(function(s,a){let o=i,l="",c=[];if(o){const g=s.getGeometry();if(g)if(g instanceof xo)c=g.getGeometriesArrayRecursive().filter(function(m){const y=m.getType();return y==="Point"||y==="MultiPoint"}),o=c.length>0;else{const m=g.getType();o=m==="Point"||m==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(Bx||(Bx=document.createElement("textarea")),Bx.innerHTML=l,l=Bx.value));let h=t;if(n?h=n:e&&(h=JV(e,t,r)),o){const g=xpe(h[0],l);if(c.length>0){g.setGeometry(new xo(c));const m=new hn({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[g,m].concat(h.slice(1))}return g}return h})}function JV(n,e,t){return Array.isArray(n)?n:typeof n=="string"?JV(t[n],e,t):e}function bE(n){const e=Ao(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function eB(n){let e=Ao(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function tB(n){const e=Ao(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function nB(n){const e=Ao(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function vpe(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:u5[e],y:parseFloat(n.getAttribute("y")),yunits:u5[t],origin:r}}function rB(n){return Cn(n)}const wpe=gt(Ct,{Pair:Wpe});function iB(n,e){return _n(void 0,wpe,n,e,this)}const Epe=gt(Ct,{Icon:Ge(Dpe),color:Ge(bE),heading:Ge(Cn),hotSpot:Ge(vpe),scale:Ge(rB)});function Spe(n,e){const t=_n({},Epe,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=Kv);let l,c,h,g="bottom-left";const m=t.hotSpot;m?(l=[m.x,m.y],c=m.xunits,h=m.yunits,g=m.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=NA,c=rp,h=ip):a.includes("arrow-reverse")?(l=[54,42],c=rp,h=ip):a.includes("paddle")&&(l=[32,1],c=rp,h=ip));let y;const v=i.x,x=i.y;v!==void 0&&x!==void 0&&(y=[v,x]);let w;const T=i.w,b=i.h;T!==void 0&&b!==void 0&&(w=[T,b]);let A;const M=t.heading;M!==void 0&&(A=Yl(M));const O=t.scale,z=t.color;if(s){a==Kv&&(w=sp);const I=new sg({anchor:l,anchorOrigin:g,anchorXUnits:c,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:A,scale:O,size:w,src:this.iconUrlFunction_(a),color:z}),R=I.getScaleArray()[0],P=I.getSize();if(P===null){const F=I.getImageState();if(F===Et.IDLE||F===Et.LOADING){const N=function(){const B=I.getImageState();if(!(B===Et.IDLE||B===Et.LOADING)){const j=I.getSize();if(j&&j.length==2){const ve=Xv(j);I.setScale(R*ve)}I.unlistenImageChange(N)}};I.listenImageChange(N),F===Et.IDLE&&I.load()}}else if(P.length==2){const F=Xv(P);I.setScale(R*F)}r.imageStyle=I}else r.imageStyle=tk}const Tpe=gt(Ct,{color:Ge(bE),scale:Ge(rB)});function bpe(n,e){const t=_n({},Tpe,n,e);if(!t)return;const r=e[e.length-1],i=new ja({fill:new Xn({color:"color"in t?t.color:E0}),scale:t.scale});r.textStyle=i}const Ape=gt(Ct,{color:Ge(bE),width:Ge(Cn)});function Rpe(n,e){const t=_n({},Ape,n,e);if(!t)return;const r=e[e.length-1],i=new zn({color:"color"in t?t.color:E0,width:"width"in t?t.width:1});r.strokeStyle=i}const Ipe=gt(Ct,{color:Ge(bE),fill:Ge(Bu),outline:Ge(Bu)});function Cpe(n,e){const t=_n({},Ipe,n,e);if(!t)return;const r=e[e.length-1],i=new Xn({color:"color"in t?t.color:E0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const kpe=gt(Ct,{coordinates:YC(eB)});function sB(n,e){return _n(null,kpe,n,e)}function Ppe(n,e){const r=e[e.length-1].coordinates,i=Ao(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),c=parseFloat(a[3]);r.push([o,l,c])}else r.push([])}const Mpe=gt(vc,{Track:fo(aB)});function Npe(n,e){const t=_n([],Mpe,n,e);if(t)return new ic(t)}const Lpe=gt(Ct,{when:s1e},gt(vc,{coord:Ppe}));function aB(n,e){const t=_n({coordinates:[],whens:[]},Lpe,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new bi(r,"XYZM")}const Ope=gt(Ct,{href:Ge(tB)},gt(vc,{x:Ge(Cn),y:Ge(Cn),w:Ge(Cn),h:Ge(Cn)}));function Dpe(n,e){const t=_n({},Ope,n,e);return t||null}const Fpe=gt(Ct,{coordinates:YC(eB)});function nk(n,e){return _n(null,Fpe,n,e)}const AE=gt(Ct,{extrude:Ge(Bu),tessellate:Ge(Bu),altitudeMode:Ge(on)});function oB(n,e){const t=_n({},AE,n,e),r=nk(n,e);if(r){const i=new bi(r,"XYZ");return i.setProperties(t,!0),i}}function lB(n,e){const t=_n({},AE,n,e),r=nk(n,e);if(r){const i=new Ua(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const jpe=gt(Ct,{LineString:fo(oB),LinearRing:fo(lB),MultiGeometry:fo(cB),Point:fo(uB),Polygon:fo(hB)});function cB(n,e){const t=_n([],jpe,n,e);if(!t)return null;if(t.length===0)return new xo(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const c=t[0];o=c.getLayout(),l=c.getFlatCoordinates();for(let h=1,g=t.length;h<g;++h)a=t[h],Vn(l,a.getFlatCoordinates());r=new Cd(l,o),kT(r,t)}else if(s=="LineString")r=new ic(t),kT(r,t);else if(s=="Polygon")r=new ad(t),kT(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new xo(t);else throw new Error("Unknown geometry type found")}else r=new xo(t);return r}function uB(n,e){const t=_n({},AE,n,e),r=nk(n,e);if(r){const i=new ri(r,"XYZ");return i.setProperties(t,!0),i}}const Vpe=gt(Ct,{innerBoundaryIs:t1e,outerBoundaryIs:r1e});function hB(n,e){const t=_n({},AE,n,e),r=_n([null],Vpe,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Vn(i,r[o]),s.push(i.length);const a=new Ua(i,"XYZ",s);return a.setProperties(t,!0),a}}const Bpe=gt(Ct,{IconStyle:Spe,LabelStyle:bpe,LineStyle:Rpe,PolyStyle:Cpe});function rk(n,e){const t=_n({},Bpe,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:S_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=tk&&(s=t.imageStyle):s=LA;const a="textStyle"in t?t.textStyle:$h,o="strokeStyle"in t?t.strokeStyle:OA,l=t.outline;return l!==void 0&&!l?[new hn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new xo(m.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(g!=="Polygon"&&g!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new hn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new xo(m.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(g==="Polygon"||g==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new hn({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function kT(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let c=0;c<t;++c){const h=e[c];r[c]=h.get("extrude"),i[c]=h.get("tessellate"),s[c]=h.get("altitudeMode"),a=a||r[c]!==void 0,o=o||i[c]!==void 0,l=l||s[c]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const Gpe=gt(Ct,{displayName:Ge(on),value:Ge(on)});function zpe(n,e){const t=n.getAttribute("name");qu(Gpe,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const Upe=gt(Ct,{Data:zpe,SchemaData:Xpe});function dB(n,e){qu(Upe,n,e)}function fB(n,e){qu(QV,n,e)}const $pe=gt(Ct,{Style:Ge(rk),key:Ge(on),styleUrl:Ge(nB)});function Wpe(n,e){const t=_n({},$pe,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function Hpe(n,e){const t=iB.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const Kpe=gt(Ct,{SimpleData:qpe});function Xpe(n,e){qu(Kpe,n,e)}function qpe(n,e){const t=n.getAttribute("name");if(t!==null){const r=on(n),i=e[e.length-1];i[t]=r}}const Ype=gt(Ct,{altitudeMode:Ge(on),minAltitude:Ge(Cn),maxAltitude:Ge(Cn),north:Ge(Cn),south:Ge(Cn),east:Ge(Cn),west:Ge(Cn)});function Zpe(n,e){const t=_n({},Ype,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const Qpe=gt(Ct,{minLodPixels:Ge(Cn),maxLodPixels:Ge(Cn),minFadeExtent:Ge(Cn),maxFadeExtent:Ge(Cn)});function Jpe(n,e){const t=_n({},Qpe,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const e1e=gt(Ct,{LinearRing:fo(sB)});function t1e(n,e){const t=_n([],e1e,n,e);t.length>0&&e[e.length-1].push(...t)}const n1e=gt(Ct,{LinearRing:YC(sB)});function r1e(n,e){const t=_n(void 0,n1e,n,e);if(t){const r=e[e.length-1];r[0]=t}}function i1e(n,e){qu(hpe,n,e)}function s1e(n,e){const r=e[e.length-1].whens,i=Ao(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function RE(n,e){const t=za(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}On(n,i.join(""))}function a1e(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let c=1;c<a;++c)l+=","+e[c];for(let c=s;c<o;c+=s){l+=" "+e[c];for(let h=1;h<a;++h)l+=","+e[c+h]}}On(n,l)}const T_=gt(Ct,{Data:Je(o1e),value:Je(c1e),displayName:Je(l1e)});function o1e(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&ar(r,T_,ds,[i.displayName],t,["displayName"]),i!==null&&i.value&&ar(r,T_,ds,[i.value],t,["value"])):ar(r,T_,ds,[i],t,["value"])}function l1e(n,e){On(n,e)}function c1e(n,e){On(n,e)}const u1e=gt(Ct,{Placemark:Je(pB)}),h1e=function(n,e,t){const r=e[e.length-1].node;return Dd(r.namespaceURI,"Placemark")};function d1e(n,e,t){ar({node:n},u1e,h1e,e,t,void 0,this)}const f1e=Ro("Data");function g1e(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)ar(r,T_,f1e,[{name:i[o],value:s[o]}],t)}const d5=gt(Ct,["href"],gt(vc,["x","y","w","h"])),f5=gt(Ct,{href:Je(On)},gt(vc,{x:Je(Ns),y:Je(Ns),w:Je(Ns),h:Je(Ns)})),m1e=function(n,e,t){return Dd(vc[0],"gx:"+t)};function p1e(n,e,t){const r={node:n},i=t[t.length-1].node;let s=d5[i.namespaceURI],a=Ws(e,s);ar(r,f5,ds,a,t,s),s=d5[vc[0]],a=Ws(e,s),ar(r,f5,m1e,a,t,s)}const y1e=gt(Ct,["scale","heading","Icon","color","hotSpot"]),x1e=gt(Ct,{Icon:Je(p1e),color:Je(RE),heading:Je(Ns),hotSpot:Je(W1e),scale:Je(xB)});function _1e(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const w=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),w&&(w[0]!==a[0]/2||w[1]!==a[1]/2)){const b={x:w[0],xunits:"pixels",y:a[1]-w[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let c=e.getScaleArray()[0],h=a;if(h===null&&(h=sp),h.length==2){const w=Xv(h);c=c/w}c!==1&&(i.scale=c);const g=e.getRotation();g!==0&&(i.heading=g);const m=e.getColor();m&&(i.color=m);const y=t[t.length-1].node,v=y1e[y.namespaceURI],x=Ws(i,v);ar(r,x1e,ds,x,t,v)}const v1e=gt(Ct,["color","scale"]),w1e=gt(Ct,{color:Je(RE),scale:Je(xB)});function E1e(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=v1e[o.namespaceURI],c=Ws(i,l);ar(r,w1e,ds,c,t,l)}const S1e=gt(Ct,["color","width"]),T1e=gt(Ct,{color:Je(RE),width:Je(Ns)});function b1e(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=S1e[s.namespaceURI],o=Ws(i,a);ar(r,T1e,ds,o,t,a)}const A1e={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},gB=function(n,e,t){if(n){const r=e[e.length-1].node;return Dd(r.namespaceURI,A1e[n.getType()])}},R1e=Ro("Point"),I1e=Ro("LineString"),C1e=Ro("LinearRing"),k1e=Ro("Polygon"),P1e=gt(Ct,{LineString:Je(S0),Point:Je(S0),Polygon:Je(yB),GeometryCollection:Je(mB)});function mB(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=gB;else if(i==="MultiPoint")s=e.getPoints(),a=R1e;else if(i==="MultiLineString")s=e.getLineStrings(),a=I1e;else if(i==="MultiPolygon")s=e.getPolygons(),a=k1e;else throw new Error("Unknown geometry type");ar(r,P1e,a,s,t)}const M1e=gt(Ct,{LinearRing:Je(S0)});function g5(n,e,t){ar({node:n},M1e,C1e,[e],t)}const PT=gt(Ct,{ExtendedData:Je(g1e),MultiGeometry:Je(mB),LineString:Je(S0),LinearRing:Je(S0),Point:Je(S0),Polygon:Je(yB),Style:Je($1e),address:Je(On),description:Je(On),name:Je(On),open:Je(tg),phoneNumber:Je(On),styleUrl:Je(On),visibility:Je(tg)}),N1e=gt(Ct,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),L1e=Ro("ExtendedData");function pB(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const v=Array.isArray(y)?y:[y];let x=v;if(e.getGeometry()&&(x=v.filter(function(w){const T=w.getGeometryFunction()(e);if(T){const b=T.getType();return b==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(A){const M=A.getType();return M==="Point"||M==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let w=v,T=v;e.getGeometry()&&(w=v.filter(function(b){const A=b.getGeometryFunction()(e);if(A){const M=A.getType();return M==="GeometryCollection"?A.getGeometriesArrayRecursive().filter(function(O){const z=O.getType();return z==="LineString"||z==="MultiLineString"}).length:M==="LineString"||M==="MultiLineString"}}),T=v.filter(function(b){const A=b.getGeometryFunction()(e);if(A){const M=A.getType();return M==="GeometryCollection"?A.getGeometriesArrayRecursive().filter(function(O){const z=O.getType();return z==="Polygon"||z==="MultiPolygon"}).length:M==="Polygon"||M==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:w,polyStyles:T}}if(x.length&&i.name===void 0){const w=x[0].getText();w&&(i.name=w.getText())}}}const l=t[t.length-1].node,c=N1e[l.namespaceURI],h=Ws(i,c);if(ar(r,PT,ds,h,t,c),a.length>0){const y=Ws(i,a);ar(r,PT,L1e,[{names:a,values:y}],t)}const g=t[0];let m=e.getGeometry();m&&(m=bo(m,!0,g)),ar(r,PT,gB,[m],t)}const O1e=gt(Ct,["extrude","tessellate","altitudeMode","coordinates"]),D1e=gt(Ct,{extrude:Je(tg),tessellate:Je(tg),altitudeMode:Je(On),coordinates:Je(a1e)});function S0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=O1e[a.namespaceURI],l=Ws(s,o);ar(i,D1e,ds,l,t,o)}const F1e=gt(Ct,["color","fill","outline"]),m5=gt(Ct,{outerBoundaryIs:Je(g5),innerBoundaryIs:Je(g5)}),j1e=Ro("innerBoundaryIs"),V1e=Ro("outerBoundaryIs");function yB(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};ar(s,m5,j1e,r,t),ar(s,m5,V1e,[i],t)}const B1e=gt(Ct,{color:Je(RE),fill:Je(tg),outline:Je(tg)});function G1e(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=F1e[o.namespaceURI],c=Ws(a,l);ar(r,B1e,ds,c,t,l)}function xB(n,e){Ns(n,Math.round(e*1e6)/1e6)}const z1e=gt(Ct,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),U1e=gt(Ct,{IconStyle:Je(_1e),LabelStyle:Je(E1e),LineStyle:Je(b1e),PolyStyle:Je(G1e)});function $1e(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=z1e[s.namespaceURI],o=Ws(i,a);ar(r,U1e,ds,o,t,a)}function W1e(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function _B(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!Yx(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),P_(new pw({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=Yx(s);for(i=0;i<t;++i){const o=e[i],l=Yx(o);if(!Zx(s,o))if(n.defs[s]===n.defs[o])QT([a,l]);else{const c=n(s,o);u$(a,l,nM(a,l,c.forward),nM(l,a,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");_B(bn);let Wh=null,ap=null,Zf=null;function jA(n){Wh&&(n.removeLayer(Wh),Wh=null),ap&&(n.removeLayer(ap),ap=null),Zf=null}async function H1e(n,e){try{const t=Tn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=bn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;jA(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(c),!h.ok)return console.error("WFS request failed:",h.status),!1;const g=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(g).substring(0,500)),!g.features||g.features.length===0)return console.log("No parcel found at location"),!1;const m=g.features[0];console.log(" PARCEL ID:",m.id||m.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(m.bbox||"geen bbox"));const v=new XC().readFeature(m,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=v.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const w=m.properties||{};console.log(` Parcel: ${w.category||"unknown"} - ${w.gewasnaam||w.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(P=>P.toFixed(0)).join(", ")}`);const T=x.getExtent(),b=T[2]-T[0],A=T[3]-T[1],M=Math.max(b,A)*.05,O=[T[0]-M,T[1]-M,T[2]+M,T[3]+M],z=Math.max(b,A)*.3,I=[T[0]-z,T[1]-z,T[2]+z,T[3]+z];Zf=x,Wh=new ZK({source:new TX({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:O,zIndex:998}),Wh.on("prerender",P=>{if(!Zf)return;const F=P.context;if(!F)return;const N=P.frameState;if(!N)return;F.save(),F.beginPath(),(Zf.getType()==="Polygon"?Zf.getCoordinates()[0]:Zf.getCoordinates()[0][0]).forEach((j,ve)=>{const ke=n.getPixelFromCoordinate(j);if(!ke)return;const Ve=N.pixelRatio,Me=ke[0]*Ve,ue=ke[1]*Ve;ve===0?F.moveTo(Me,ue):F.lineTo(Me,ue)}),F.closePath(),F.clip()}),Wh.on("postrender",P=>{const F=P.context;F&&F.restore()}),n.addLayer(Wh);const R=new xl({features:[v]});return ap=new mc({source:R,style:new hn({fill:new Xn({color:"rgba(0, 0, 0, 0)"}),stroke:new zn({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(ap),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var qv={};qv.version="0.18.5";var vB=1252,K1e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wB=function(n){K1e.indexOf(n)!=-1&&(vB=n)};function X1e(){wB(1252)}var n1=function(n){wB(n)};function q1e(){n1(1200),X1e()}var Gx=function(e){return String.fromCharCode(e)},p5=function(e){return String.fromCharCode(e)},Yv,yu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r1(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),s=t>>2,r=n.charCodeAt(c++),a=(t&3)<<4|r>>4,i=n.charCodeAt(c++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=yu.charAt(s)+yu.charAt(a)+yu.charAt(o)+yu.charAt(l);return e}function hc(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)s=yu.indexOf(n.charAt(c++)),a=yu.indexOf(n.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=yu.indexOf(n.charAt(c++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=yu.indexOf(n.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Ln=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),wc=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Ed(n){return Ln?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function y5(n){return Ln?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var go=function(e){return Ln?wc(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function IE(n){if(typeof ArrayBuffer>"u")return go(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function ey(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function Y1e(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Ui=Ln?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:wc(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Z1e(n){for(var e=[],t=0,r=n.length+250,i=Ed(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Ed(65535),r=65530)}return e.push(i.slice(0,t)),Ui(e)}var op=/\u0000/g,zx=/[\u0001-\u0006]/g;function T0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function yo(n,e){var t=""+n;return t.length>=e?t:Fr("0",e-t.length)+t}function ik(n,e){var t=""+n;return t.length>=e?t:Fr(" ",e-t.length)+t}function Zv(n,e){var t=""+n;return t.length>=e?t:t+Fr(" ",e-t.length)}function Q1e(n,e){var t=""+Math.round(n);return t.length>=e?t:Fr("0",e-t.length)+t}function J1e(n,e){var t=""+n;return t.length>=e?t:Fr("0",e-t.length)+t}var x5=Math.pow(2,32);function Df(n,e){if(n>x5||n<-x5)return Q1e(n,e);var t=Math.round(n);return J1e(t,e)}function Qv(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var _5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],MT=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eye(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Vr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},v5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tye={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jv(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,c=0,h=0,g=Math.floor(i);c<e&&(g=Math.floor(i),o=g*a+s,h=g*c+l,!(i-g<5e-8));)i=1/(i-g),s=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=s):(h=c,o=a)),!t)return[0,r*o,h];var m=Math.floor(r*o/h);return[m,r*o-m*h,h]}function Ux(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=lye(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var EB=new Date(1899,11,31,0,0,0),nye=EB.getTime(),rye=new Date(1900,2,1,0,0,0);function SB(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=rye&&(t+=1440*60*1e3),(t-(nye+(n.getTimezoneOffset()-EB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function sk(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function iye(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function sye(n){var e=n<0?12:11,t=sk(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function aye(n){var e=sk(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function oye(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=sye(n):e===10?t=n.toFixed(10).substr(0,12):t=aye(n),sk(iye(t.toUpperCase()))}function VA(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):oye(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Gu(14,SB(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function lye(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function cye(n,e,t,r){var i="",s=0,a=0,o=t.y,l,c=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return MT[t.m-1][1];case 5:return MT[t.m-1][0];default:return MT[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return _5[t.q][0];default:return _5[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?yo(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=yo(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?yo(l,c):"";return h}function xu(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var TB=/%/g;function uye(n,e,t){var r=e.replace(TB,""),i=e.length-r.length;return tc(n,r,t*Math.pow(10,2*i))+Fr("%",i)}function hye(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return tc(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function bB(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+bB(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var AB=/# (\?+)( ?)\/( ?)(\d+)/;function dye(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Fr(" ",n[1].length+1+n[4].length):ik(a,n[1].length)+n[2]+"/"+n[3]+yo(o,n[4].length))}function fye(n,e,t){return t+(e===0?"":""+e)+Fr(" ",n[1].length+2+n[4].length)}var RB=/^#*0*\.([0#]+)/,IB=/\).*[0#]/,CB=/\(###\) ###\\?-####/;function ys(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function w5(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function E5(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function gye(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function mye(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ia(n,e,t){if(n.charCodeAt(0)===40&&!e.match(IB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ia("n",r,t):"("+Ia("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return hye(n,e,t);if(e.indexOf("%")!==-1)return uye(n,e,t);if(e.indexOf("E")!==-1)return bB(e,t);if(e.charCodeAt(0)===36)return"$"+Ia(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Df(l,e.length);if(e.match(/^[#?]+$/))return i=Df(t,0),i==="0"&&(i=""),i.length>e.length?i:ys(e.substr(0,e.length-i.length))+i;if(s=e.match(AB))return dye(s,l,c);if(e.match(/^#+0+$/))return c+Df(l,e.length-e.indexOf("0"));if(s=e.match(RB))return i=w5(t,s[1].length).replace(/^([^\.]+)$/,"$1."+ys(s[1])).replace(/\.$/,"."+ys(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Fr("0",ys(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+w5(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+xu(Df(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ia(n,e,-t):xu(""+(Math.floor(t)+gye(t,s[1].length)))+"."+yo(E5(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ia(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=T0(Ia(n,e.replace(/[\\-]/g,""),t)),a=0,T0(T0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(CB))return i=Ia(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jv(l,Math.pow(10,a)-1,!1),i=""+c,h=tc("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Zv(o[2],a),h.length<s[4].length&&(h=ys(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jv(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ik(o[1],a)+s[2]+"/"+s[3]+Zv(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Df(t,0),e.length<=i.length?i:ys(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return ys(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=E5(t,s[1].length),t<0?"-"+Ia(n,e,-t):xu(mye(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?yo(0,3-v.length):"")+v})+"."+yo(a,s[1].length);switch(e){case"###,##0.00":return Ia(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=xu(Df(l,0));return y!=="0"?c+y:"";case"###,###.00":return Ia(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ia(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function pye(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return tc(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function yye(n,e,t){var r=e.replace(TB,""),i=e.length-r.length;return tc(n,r,t*Math.pow(10,2*i))+Fr("%",i)}function kB(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+kB(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Wo(n,e,t){if(n.charCodeAt(0)===40&&!e.match(IB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Wo("n",r,t):"("+Wo("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return pye(n,e,t);if(e.indexOf("%")!==-1)return yye(n,e,t);if(e.indexOf("E")!==-1)return kB(e,t);if(e.charCodeAt(0)===36)return"$"+Wo(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+yo(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:ys(e.substr(0,e.length-i.length))+i;if(s=e.match(AB))return fye(s,l,c);if(e.match(/^#+0+$/))return c+yo(l,e.length-e.indexOf("0"));if(s=e.match(RB))return i=(""+t).replace(/^([^\.]+)$/,"$1."+ys(s[1])).replace(/\.$/,"."+ys(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Fr("0",ys(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+xu(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Wo(n,e,-t):xu(""+t)+"."+Fr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Wo(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=T0(Wo(n,e.replace(/[\\-]/g,""),t)),a=0,T0(T0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(CB))return i=Wo(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jv(l,Math.pow(10,a)-1,!1),i=""+c,h=tc("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Zv(o[2],a),h.length<s[4].length&&(h=ys(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jv(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ik(o[1],a)+s[2]+"/"+s[3]+Zv(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:ys(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return ys(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Wo(n,e,-t):xu(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?yo(0,3-v.length):"")+v})+"."+yo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=xu(""+l);return y!=="0"?c+y:"";default:if(e.match(/\.[0#?]*$/))return Wo(n,e.slice(0,e.lastIndexOf(".")),t)+ys(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function tc(n,e,t){return(t|0)===t?Wo(n,e,t):Ia(n,e,t)}function xye(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var PB=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function MB(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":Qv(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(PB))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function _ye(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",c,h,g,m="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!Qv(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(g=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(g);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),v=y==="("||y===")"?y:"t";i[i.length]={t:v,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(c==null&&(c=Ux(e,t,n.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Ux(e,t),c==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=Ux(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,m="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(PB)){if(c==null&&(c=Ux(e,t),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",MB(n)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var w=0,T=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",w<1&&(w=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var A="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=cye(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;A+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=VA(e,t);break}var O="",z,I;if(A.length>0){A.charCodeAt(0)==40?(z=e<0&&A.charCodeAt(0)===45?-e:e,I=tc("n",A,z)):(z=e<0&&r>1?-e:e,I=tc("n",A,z),z<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),M=I.length-1;var R=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){R=a;break}var P=i.length;if(R===i.length&&I.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=I.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=I.substr(0,M+1),M=-1),i[a].t="t",P=a);M>=0&&P<i.length&&(i[P].v=I.substr(0,M+1)+i[P].v)}else if(R!==i.length&&I.indexOf("E")===-1){for(M=I.indexOf(".")-1,a=R;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===R?i[a].v.indexOf(".")-1:i[a].v.length-1,O=i[a].v.substr(h+1);h>=0;--h)M>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(O=I.charAt(M--)+O);i[a].v=O,i[a].t="t",P=a}for(M>=0&&P<i.length&&(i[P].v=I.substr(0,M+1)+i[P].v),M=I.indexOf(".")+1,a=R;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==R)){for(h=i[a].v.indexOf(".")>-1&&a===R?i[a].v.indexOf(".")+1:0,O=i[a].v.substr(0,h);h<i[a].v.length;++h)M<I.length&&(O+=I.charAt(M++));i[a].v=O,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(z=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=tc(i[a].t,i[a].v,z),i[a].t="t");var F="";for(a=0;a!==i.length;++a)i[a]!=null&&(F+=i[a].v);return F}var S5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function T5(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function vye(n,e){var t=xye(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(S5),o=t[1].match(S5);return T5(e,a)?[r,t[0]]:T5(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function Gu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Vr)[n],r==null&&(r=t.table&&t.table[v5[n]]||Vr[v5[n]]),r==null&&(r=tye[n]||"General");break}if(Qv(r,0))return VA(e,t);e instanceof Date&&(e=SB(e,t.date1904));var i=vye(r,e);if(Qv(i[1]))return VA(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return _ye(i[1],e,t,i[0])}function NB(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Vr[t]==null){e<0&&(e=t);continue}if(Vr[t]==n){e=t;break}}e<0&&(e=391)}return Vr[e]=n,e}function CE(n){for(var e=0;e!=392;++e)n[e]!==void 0&&NB(n[e],e)}function kE(){Vr=eye()}var LB=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function wye(n){var e=typeof n=="number"?Vr[n]:n;return e=e.replace(LB,"(\\d+)"),new RegExp("^"+e+"$")}function Eye(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(LB)||[]).forEach(function(g,m){var y=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:r==-1&&i==-1&&s==-1?h:c+"T"+h}var Sye=(function(){var n={};n.version="1.2.0";function e(){for(var I=0,R=new Array(256),P=0;P!=256;++P)I=P,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,R[P]=I;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function r(I){var R=0,P=0,F=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)N[F]=I[F];for(F=0;F!=256;++F)for(P=I[F],R=256+F;R<4096;R+=256)P=N[R]=P>>>8^I[P&255];var B=[];for(F=1;F!=16;++F)B[F-1]=typeof Int32Array<"u"?N.subarray(F*256,F*256+256):N.slice(F*256,F*256+256);return B}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],h=i[5],g=i[6],m=i[7],y=i[8],v=i[9],x=i[10],w=i[11],T=i[12],b=i[13],A=i[14];function M(I,R){for(var P=R^-1,F=0,N=I.length;F<N;)P=P>>>8^t[(P^I.charCodeAt(F++))&255];return~P}function O(I,R){for(var P=R^-1,F=I.length-15,N=0;N<F;)P=A[I[N++]^P&255]^b[I[N++]^P>>8&255]^T[I[N++]^P>>16&255]^w[I[N++]^P>>>24]^x[I[N++]]^v[I[N++]]^y[I[N++]]^m[I[N++]]^g[I[N++]]^h[I[N++]]^c[I[N++]]^l[I[N++]]^o[I[N++]]^a[I[N++]]^s[I[N++]]^t[I[N++]];for(F+=15;N<F;)P=P>>>8^t[(P^I[N++])&255];return~P}function z(I,R){for(var P=R^-1,F=0,N=I.length,B=0,j=0;F<N;)B=I.charCodeAt(F++),B<128?P=P>>>8^t[(P^B)&255]:B<2048?(P=P>>>8^t[(P^(192|B>>6&31))&255],P=P>>>8^t[(P^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,j=I.charCodeAt(F++)&1023,P=P>>>8^t[(P^(240|B>>8&7))&255],P=P>>>8^t[(P^(128|B>>2&63))&255],P=P>>>8^t[(P^(128|j>>6&15|(B&3)<<4))&255],P=P>>>8^t[(P^(128|j&63))&255]):(P=P>>>8^t[(P^(224|B>>12&15))&255],P=P>>>8^t[(P^(128|B>>6&63))&255],P=P>>>8^t[(P^(128|B&63))&255]);return~P}return n.table=t,n.bstr=M,n.buf=O,n.str=z,n})(),Jn=(function(){var e={};e.version="1.2.1";function t(U,J){for(var K=U.split("/"),Z=J.split("/"),ee=0,te=0,we=Math.min(K.length,Z.length);ee<we;++ee){if(te=K[ee].length-Z[ee].length)return te;if(K[ee]!=Z[ee])return K[ee]<Z[ee]?-1:1}return K.length-Z.length}function r(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:r(U.slice(0,-1));var J=U.lastIndexOf("/");return J===-1?U:U.slice(0,J+1)}function i(U){if(U.charAt(U.length-1)=="/")return i(U.slice(0,-1));var J=U.lastIndexOf("/");return J===-1?U:U.slice(J+1)}function s(U,J){typeof J=="string"&&(J=new Date(J));var K=J.getHours();K=K<<6|J.getMinutes(),K=K<<5|J.getSeconds()>>>1,U.write_shift(2,K);var Z=J.getFullYear()-1980;Z=Z<<4|J.getMonth()+1,Z=Z<<5|J.getDate(),U.write_shift(2,Z)}function a(U){var J=U.read_shift(2)&65535,K=U.read_shift(2)&65535,Z=new Date,ee=K&31;K>>>=5;var te=K&15;K>>>=4,Z.setMilliseconds(0),Z.setFullYear(K+1980),Z.setMonth(te-1),Z.setDate(ee);var we=J&31;J>>>=5;var Le=J&63;return J>>>=6,Z.setHours(J),Z.setMinutes(Le),Z.setSeconds(we<<1),Z}function o(U){aa(U,0);for(var J={},K=0;U.l<=U.length-4;){var Z=U.read_shift(2),ee=U.read_shift(2),te=U.l+ee,we={};switch(Z){case 21589:K=U.read_shift(1),K&1&&(we.mtime=U.read_shift(4)),ee>5&&(K&2&&(we.atime=U.read_shift(4)),K&4&&(we.ctime=U.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}U.l=te,J[Z]=we}return J}var l;function c(){return l||(l={})}function h(U,J){if(U[0]==80&&U[1]==75)return kt(U,J);if((U[0]|32)==109&&(U[1]|32)==105)return it(U,J);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var K=3,Z=512,ee=0,te=0,we=0,Le=0,_e=0,Se=[],Te=U.slice(0,512);aa(Te,0);var Xe=g(Te);switch(K=Xe[0],K){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(Xe[1]==0)return kt(U,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Z!==512&&(Te=U.slice(0,Z),aa(Te,28));var nt=U.slice(0,Z);m(Te,K);var pt=Te.read_shift(4,"i");if(K===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);Te.l+=4,we=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Le=Te.read_shift(4,"i"),ee=Te.read_shift(4,"i"),_e=Te.read_shift(4,"i"),te=Te.read_shift(4,"i");for(var qe=-1,Ye=0;Ye<109&&(qe=Te.read_shift(4,"i"),!(qe<0));++Ye)Se[Ye]=qe;var Ht=y(U,Z);w(_e,te,Ht,Z,Se);var jn=b(Ht,we,Se,Z);jn[we].name="!Directory",ee>0&&Le!==j&&(jn[Le].name="!MiniFAT"),jn[Se[0]].name="!FAT",jn.fat_addrs=Se,jn.ssz=Z;var Un={},_r=[],Xa=[],xa=[];A(we,jn,Ht,_r,ee,Un,Xa,Le),v(Xa,xa,_r),_r.shift();var qs={FileIndex:Xa,FullPaths:xa};return J&&J.raw&&(qs.raw={header:nt,sectors:Ht}),qs}function g(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(ve,"Header Signature: "),U.l+=16;var J=U.read_shift(2,"u");return[U.read_shift(2,"u"),J]}function m(U,J){var K=9;switch(U.l+=2,K=U.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function y(U,J){for(var K=Math.ceil(U.length/J)-1,Z=[],ee=1;ee<K;++ee)Z[ee-1]=U.slice(ee*J,(ee+1)*J);return Z[K-1]=U.slice(K*J),Z}function v(U,J,K){for(var Z=0,ee=0,te=0,we=0,Le=0,_e=K.length,Se=[],Te=[];Z<_e;++Z)Se[Z]=Te[Z]=Z,J[Z]=K[Z];for(;Le<Te.length;++Le)Z=Te[Le],ee=U[Z].L,te=U[Z].R,we=U[Z].C,Se[Z]===Z&&(ee!==-1&&Se[ee]!==ee&&(Se[Z]=Se[ee]),te!==-1&&Se[te]!==te&&(Se[Z]=Se[te])),we!==-1&&(Se[we]=Z),ee!==-1&&Z!=Se[Z]&&(Se[ee]=Se[Z],Te.lastIndexOf(ee)<Le&&Te.push(ee)),te!==-1&&Z!=Se[Z]&&(Se[te]=Se[Z],Te.lastIndexOf(te)<Le&&Te.push(te));for(Z=1;Z<_e;++Z)Se[Z]===Z&&(te!==-1&&Se[te]!==te?Se[Z]=Se[te]:ee!==-1&&Se[ee]!==ee&&(Se[Z]=Se[ee]));for(Z=1;Z<_e;++Z)if(U[Z].type!==0){if(Le=Z,Le!=Se[Le])do Le=Se[Le],J[Z]=J[Le]+"/"+J[Z];while(Le!==0&&Se[Le]!==-1&&Le!=Se[Le]);Se[Z]=-1}for(J[0]+="/",Z=1;Z<_e;++Z)U[Z].type!==2&&(J[Z]+="/")}function x(U,J,K){for(var Z=U.start,ee=U.size,te=[],we=Z;K&&ee>0&&we>=0;)te.push(J.slice(we*B,we*B+B)),ee-=B,we=Oh(K,we*4);return te.length===0?Ne(0):Ui(te).slice(0,U.size)}function w(U,J,K,Z,ee){var te=j;if(U===j){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var we=K[U],Le=(Z>>>2)-1;if(!we)return;for(var _e=0;_e<Le&&(te=Oh(we,_e*4))!==j;++_e)ee.push(te);w(Oh(we,Z-4),J-1,K,Z,ee)}}function T(U,J,K,Z,ee){var te=[],we=[];ee||(ee=[]);var Le=Z-1,_e=0,Se=0;for(_e=J;_e>=0;){ee[_e]=!0,te[te.length]=_e,we.push(U[_e]);var Te=K[Math.floor(_e*4/Z)];if(Se=_e*4&Le,Z<4+Se)throw new Error("FAT boundary crossed: "+_e+" 4 "+Z);if(!U[Te])break;_e=Oh(U[Te],Se)}return{nodes:te,data:M5([we])}}function b(U,J,K,Z){var ee=U.length,te=[],we=[],Le=[],_e=[],Se=Z-1,Te=0,Xe=0,nt=0,pt=0;for(Te=0;Te<ee;++Te)if(Le=[],nt=Te+J,nt>=ee&&(nt-=ee),!we[nt]){_e=[];var qe=[];for(Xe=nt;Xe>=0;){qe[Xe]=!0,we[Xe]=!0,Le[Le.length]=Xe,_e.push(U[Xe]);var Ye=K[Math.floor(Xe*4/Z)];if(pt=Xe*4&Se,Z<4+pt)throw new Error("FAT boundary crossed: "+Xe+" 4 "+Z);if(!U[Ye]||(Xe=Oh(U[Ye],pt),qe[Xe]))break}te[nt]={nodes:Le,data:M5([_e])}}return te}function A(U,J,K,Z,ee,te,we,Le){for(var _e=0,Se=Z.length?2:0,Te=J[U].data,Xe=0,nt=0,pt;Xe<Te.length;Xe+=128){var qe=Te.slice(Xe,Xe+128);aa(qe,64),nt=qe.read_shift(2),pt=uk(qe,0,nt-Se),Z.push(pt);var Ye={name:pt,type:qe.read_shift(1),color:qe.read_shift(1),L:qe.read_shift(4,"i"),R:qe.read_shift(4,"i"),C:qe.read_shift(4,"i"),clsid:qe.read_shift(16),state:qe.read_shift(4,"i"),start:0,size:0},Ht=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);Ht!==0&&(Ye.ct=M(qe,qe.l-8));var jn=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);jn!==0&&(Ye.mt=M(qe,qe.l-8)),Ye.start=qe.read_shift(4,"i"),Ye.size=qe.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=j,Ye.name=""),Ye.type===5?(_e=Ye.start,ee>0&&_e!==j&&(J[_e].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",J[Ye.start]===void 0&&(J[Ye.start]=T(K,Ye.start,J.fat_addrs,J.ssz)),J[Ye.start].name=Ye.name,Ye.content=J[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:_e!==j&&Ye.start!==j&&J[_e]&&(Ye.content=x(Ye,J[_e].data,(J[Le]||{}).data))),Ye.content&&aa(Ye.content,0),te[pt]=Ye,we.push(Ye)}}function M(U,J){return new Date((ca(U,J+4)/1e7*Math.pow(2,32)+ca(U,J)/1e7-11644473600)*1e3)}function O(U,J){return c(),h(l.readFileSync(U),J)}function z(U,J){var K=J&&J.type;switch(K||Ln&&Buffer.isBuffer(U)&&(K="buffer"),K||"base64"){case"file":return O(U,J);case"base64":return h(go(hc(U)),J);case"binary":return h(go(U),J)}return h(U,J)}function I(U,J){var K=J||{},Z=K.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=Z+"/",U.FileIndex[0]={name:Z,type:5}),K.CLSID&&(U.FileIndex[0].clsid=K.CLSID),R(U)}function R(U){var J="Sh33tJ5";if(!Jn.find(U,"/"+J)){var K=Ne(4);K[0]=55,K[1]=K[3]=50,K[2]=54,U.FileIndex.push({name:J,type:2,content:K,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+J),P(U)}}function P(U,J){I(U);for(var K=!1,Z=!1,ee=U.FullPaths.length-1;ee>=0;--ee){var te=U.FileIndex[ee];switch(te.type){case 0:Z?K=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(te.R*te.L*te.C)&&(K=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!J)){var we=new Date(1987,1,19),Le=0,_e=Object.create?Object.create(null):{},Se=[];for(ee=0;ee<U.FullPaths.length;++ee)_e[U.FullPaths[ee]]=!0,U.FileIndex[ee].type!==0&&Se.push([U.FullPaths[ee],U.FileIndex[ee]]);for(ee=0;ee<Se.length;++ee){var Te=r(Se[ee][0]);Z=_e[Te],Z||(Se.push([Te,{name:i(Te).replace("/",""),type:1,clsid:Ve,ct:we,mt:we,content:null}]),_e[Te]=!0)}for(Se.sort(function(pt,qe){return t(pt[0],qe[0])}),U.FullPaths=[],U.FileIndex=[],ee=0;ee<Se.length;++ee)U.FullPaths[ee]=Se[ee][0],U.FileIndex[ee]=Se[ee][1];for(ee=0;ee<Se.length;++ee){var Xe=U.FileIndex[ee],nt=U.FullPaths[ee];if(Xe.name=i(nt).replace("/",""),Xe.L=Xe.R=Xe.C=-(Xe.color=1),Xe.size=Xe.content?Xe.content.length:0,Xe.start=0,Xe.clsid=Xe.clsid||Ve,ee===0)Xe.C=Se.length>1?1:-1,Xe.size=0,Xe.type=5;else if(nt.slice(-1)=="/"){for(Le=ee+1;Le<Se.length&&r(U.FullPaths[Le])!=nt;++Le);for(Xe.C=Le>=Se.length?-1:Le,Le=ee+1;Le<Se.length&&r(U.FullPaths[Le])!=r(nt);++Le);Xe.R=Le>=Se.length?-1:Le,Xe.type=1}else r(U.FullPaths[ee+1]||"")==r(nt)&&(Xe.R=ee+1),Xe.type=2}}}function F(U,J){var K=J||{};if(K.fileType=="mad")return xt(U,K);switch(P(U),K.fileType){case"zip":return Y(U,K)}var Z=(function(pt){for(var qe=0,Ye=0,Ht=0;Ht<pt.FileIndex.length;++Ht){var jn=pt.FileIndex[Ht];if(jn.content){var Un=jn.content.length;Un>0&&(Un<4096?qe+=Un+63>>6:Ye+=Un+511>>9)}}for(var _r=pt.FullPaths.length+3>>2,Xa=qe+7>>3,xa=qe+127>>7,qs=Xa+Ye+_r+xa,Br=qs+127>>7,Ec=Br<=109?0:Math.ceil((Br-109)/127);qs+Br+Ec+127>>7>Br;)Ec=++Br<=109?0:Math.ceil((Br-109)/127);var Ar=[1,Ec,Br,xa,_r,Ye,qe,0];return pt.FileIndex[0].size=qe<<6,Ar[7]=(pt.FileIndex[0].start=Ar[0]+Ar[1]+Ar[2]+Ar[3]+Ar[4]+Ar[5])+(Ar[6]+7>>3),Ar})(U),ee=Ne(Z[7]<<9),te=0,we=0;{for(te=0;te<8;++te)ee.write_shift(1,ke[te]);for(te=0;te<8;++te)ee.write_shift(2,0);for(ee.write_shift(2,62),ee.write_shift(2,3),ee.write_shift(2,65534),ee.write_shift(2,9),ee.write_shift(2,6),te=0;te<3;++te)ee.write_shift(2,0);for(ee.write_shift(4,0),ee.write_shift(4,Z[2]),ee.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),ee.write_shift(4,0),ee.write_shift(4,4096),ee.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:j),ee.write_shift(4,Z[3]),ee.write_shift(-4,Z[1]?Z[0]-1:j),ee.write_shift(4,Z[1]),te=0;te<109;++te)ee.write_shift(-4,te<Z[2]?Z[1]+te:-1)}if(Z[1])for(we=0;we<Z[1];++we){for(;te<236+we*127;++te)ee.write_shift(-4,te<Z[2]?Z[1]+te:-1);ee.write_shift(-4,we===Z[1]-1?j:we+1)}var Le=function(pt){for(we+=pt;te<we-1;++te)ee.write_shift(-4,te+1);pt&&(++te,ee.write_shift(-4,j))};for(we=te=0,we+=Z[1];te<we;++te)ee.write_shift(-4,Me.DIFSECT);for(we+=Z[2];te<we;++te)ee.write_shift(-4,Me.FATSECT);Le(Z[3]),Le(Z[4]);for(var _e=0,Se=0,Te=U.FileIndex[0];_e<U.FileIndex.length;++_e)Te=U.FileIndex[_e],Te.content&&(Se=Te.content.length,!(Se<4096)&&(Te.start=we,Le(Se+511>>9)));for(Le(Z[6]+7>>3);ee.l&511;)ee.write_shift(-4,Me.ENDOFCHAIN);for(we=te=0,_e=0;_e<U.FileIndex.length;++_e)Te=U.FileIndex[_e],Te.content&&(Se=Te.content.length,!(!Se||Se>=4096)&&(Te.start=we,Le(Se+63>>6)));for(;ee.l&511;)ee.write_shift(-4,Me.ENDOFCHAIN);for(te=0;te<Z[4]<<2;++te){var Xe=U.FullPaths[te];if(!Xe||Xe.length===0){for(_e=0;_e<17;++_e)ee.write_shift(4,0);for(_e=0;_e<3;++_e)ee.write_shift(4,-1);for(_e=0;_e<12;++_e)ee.write_shift(4,0);continue}Te=U.FileIndex[te],te===0&&(Te.start=Te.size?Te.start-1:j);var nt=te===0&&K.root||Te.name;if(Se=2*(nt.length+1),ee.write_shift(64,nt,"utf16le"),ee.write_shift(2,Se),ee.write_shift(1,Te.type),ee.write_shift(1,Te.color),ee.write_shift(-4,Te.L),ee.write_shift(-4,Te.R),ee.write_shift(-4,Te.C),Te.clsid)ee.write_shift(16,Te.clsid,"hex");else for(_e=0;_e<4;++_e)ee.write_shift(4,0);ee.write_shift(4,Te.state||0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,Te.start),ee.write_shift(4,Te.size),ee.write_shift(4,0)}for(te=1;te<U.FileIndex.length;++te)if(Te=U.FileIndex[te],Te.size>=4096)if(ee.l=Te.start+1<<9,Ln&&Buffer.isBuffer(Te.content))Te.content.copy(ee,ee.l,0,Te.size),ee.l+=Te.size+511&-512;else{for(_e=0;_e<Te.size;++_e)ee.write_shift(1,Te.content[_e]);for(;_e&511;++_e)ee.write_shift(1,0)}for(te=1;te<U.FileIndex.length;++te)if(Te=U.FileIndex[te],Te.size>0&&Te.size<4096)if(Ln&&Buffer.isBuffer(Te.content))Te.content.copy(ee,ee.l,0,Te.size),ee.l+=Te.size+63&-64;else{for(_e=0;_e<Te.size;++_e)ee.write_shift(1,Te.content[_e]);for(;_e&63;++_e)ee.write_shift(1,0)}if(Ln)ee.l=ee.length;else for(;ee.l<ee.length;)ee.write_shift(1,0);return ee}function N(U,J){var K=U.FullPaths.map(function(_e){return _e.toUpperCase()}),Z=K.map(function(_e){var Se=_e.split("/");return Se[Se.length-(_e.slice(-1)=="/"?2:1)]}),ee=!1;J.charCodeAt(0)===47?(ee=!0,J=K[0].slice(0,-1)+J):ee=J.indexOf("/")!==-1;var te=J.toUpperCase(),we=ee===!0?K.indexOf(te):Z.indexOf(te);if(we!==-1)return U.FileIndex[we];var Le=!te.match(zx);for(te=te.replace(op,""),Le&&(te=te.replace(zx,"!")),we=0;we<K.length;++we)if((Le?K[we].replace(zx,"!"):K[we]).replace(op,"")==te||(Le?Z[we].replace(zx,"!"):Z[we]).replace(op,"")==te)return U.FileIndex[we];return null}var B=64,j=-2,ve="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],Ve="00000000000000000000000000000000",Me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(U,J,K){c();var Z=F(U,K);l.writeFileSync(J,Z)}function Ae(U){for(var J=new Array(U.length),K=0;K<U.length;++K)J[K]=String.fromCharCode(U[K]);return J.join("")}function be(U,J){var K=F(U,J);switch(J&&J.type||"buffer"){case"file":return c(),l.writeFileSync(J.filename,K),K;case"binary":return typeof K=="string"?K:Ae(K);case"base64":return r1(typeof K=="string"?K:Ae(K));case"buffer":if(Ln)return Buffer.isBuffer(K)?K:wc(K);case"array":return typeof K=="string"?go(K):K}return K}var re;function V(U){try{var J=U.InflateRaw,K=new J;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)re=U;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function se(U,J){if(!re)return zt(U,J);var K=re.InflateRaw,Z=new K,ee=Z._processChunk(U.slice(U.l),Z._finishFlushFlag);return U.l+=Z.bytesRead,ee}function ne(U){return re?re.deflateRawSync(U):Xr(U)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(U){var J=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(J>>16|J>>8|J)&255}for(var he=typeof Uint8Array<"u",Pe=he?new Uint8Array(256):[],Be=0;Be<256;++Be)Pe[Be]=Fe(Be);function Rt(U,J){var K=Pe[U&255];return J<=8?K>>>8-J:(K=K<<8|Pe[U>>8&255],J<=16?K>>>16-J:(K=K<<8|Pe[U>>16&255],K>>>24-J))}function Dt(U,J){var K=J&7,Z=J>>>3;return(U[Z]|(K<=6?0:U[Z+1]<<8))>>>K&3}function Nt(U,J){var K=J&7,Z=J>>>3;return(U[Z]|(K<=5?0:U[Z+1]<<8))>>>K&7}function ln(U,J){var K=J&7,Z=J>>>3;return(U[Z]|(K<=4?0:U[Z+1]<<8))>>>K&15}function rn(U,J){var K=J&7,Z=J>>>3;return(U[Z]|(K<=3?0:U[Z+1]<<8))>>>K&31}function ut(U,J){var K=J&7,Z=J>>>3;return(U[Z]|(K<=1?0:U[Z+1]<<8))>>>K&127}function tr(U,J,K){var Z=J&7,ee=J>>>3,te=(1<<K)-1,we=U[ee]>>>Z;return K<8-Z||(we|=U[ee+1]<<8-Z,K<16-Z)||(we|=U[ee+2]<<16-Z,K<24-Z)||(we|=U[ee+3]<<24-Z),we&te}function dn(U,J,K){var Z=J&7,ee=J>>>3;return Z<=5?U[ee]|=(K&7)<<Z:(U[ee]|=K<<Z&255,U[ee+1]=(K&7)>>8-Z),J+3}function cn(U,J,K){var Z=J&7,ee=J>>>3;return K=(K&1)<<Z,U[ee]|=K,J+1}function nr(U,J,K){var Z=J&7,ee=J>>>3;return K<<=Z,U[ee]|=K&255,K>>>=8,U[ee+1]=K,J+8}function li(U,J,K){var Z=J&7,ee=J>>>3;return K<<=Z,U[ee]|=K&255,K>>>=8,U[ee+1]=K&255,U[ee+2]=K>>>8,J+16}function Fn(U,J){var K=U.length,Z=2*K>J?2*K:J+5,ee=0;if(K>=J)return U;if(Ln){var te=y5(Z);if(U.copy)U.copy(te);else for(;ee<U.length;++ee)te[ee]=U[ee];return te}else if(he){var we=new Uint8Array(Z);if(we.set)we.set(U);else for(;ee<K;++ee)we[ee]=U[ee];return we}return U.length=Z,U}function dt(U){for(var J=new Array(U),K=0;K<U;++K)J[K]=0;return J}function fn(U,J,K){var Z=1,ee=0,te=0,we=0,Le=0,_e=U.length,Se=he?new Uint16Array(32):dt(32);for(te=0;te<32;++te)Se[te]=0;for(te=_e;te<K;++te)U[te]=0;_e=U.length;var Te=he?new Uint16Array(_e):dt(_e);for(te=0;te<_e;++te)Se[ee=U[te]]++,Z<ee&&(Z=ee),Te[te]=0;for(Se[0]=0,te=1;te<=Z;++te)Se[te+16]=Le=Le+Se[te-1]<<1;for(te=0;te<_e;++te)Le=U[te],Le!=0&&(Te[te]=Se[Le+16]++);var Xe=0;for(te=0;te<_e;++te)if(Xe=U[te],Xe!=0)for(Le=Rt(Te[te],Z)>>Z-Xe,we=(1<<Z+4-Xe)-1;we>=0;--we)J[Le|we<<Xe]=Xe&15|te<<4;return Z}var ur=he?new Uint16Array(512):dt(512),vt=he?new Uint16Array(32):dt(32);if(!he){for(var Zt=0;Zt<512;++Zt)ur[Zt]=0;for(Zt=0;Zt<32;++Zt)vt[Zt]=0}(function(){for(var U=[],J=0;J<32;J++)U.push(5);fn(U,vt,32);var K=[];for(J=0;J<=143;J++)K.push(8);for(;J<=255;J++)K.push(9);for(;J<=279;J++)K.push(7);for(;J<=287;J++)K.push(8);fn(K,ur,288)})();var Gt=(function(){for(var J=he?new Uint8Array(32768):[],K=0,Z=0;K<Ie.length-1;++K)for(;Z<Ie[K+1];++Z)J[Z]=K;for(;Z<32768;++Z)J[Z]=29;var ee=he?new Uint8Array(259):[];for(K=0,Z=0;K<le.length-1;++K)for(;Z<le[K+1];++Z)ee[Z]=K;function te(Le,_e){for(var Se=0;Se<Le.length;){var Te=Math.min(65535,Le.length-Se),Xe=Se+Te==Le.length;for(_e.write_shift(1,+Xe),_e.write_shift(2,Te),_e.write_shift(2,~Te&65535);Te-- >0;)_e[_e.l++]=Le[Se++]}return _e.l}function we(Le,_e){for(var Se=0,Te=0,Xe=he?new Uint16Array(32768):[];Te<Le.length;){var nt=Math.min(65535,Le.length-Te);if(nt<10){for(Se=dn(_e,Se,+(Te+nt==Le.length)),Se&7&&(Se+=8-(Se&7)),_e.l=Se/8|0,_e.write_shift(2,nt),_e.write_shift(2,~nt&65535);nt-- >0;)_e[_e.l++]=Le[Te++];Se=_e.l*8;continue}Se=dn(_e,Se,+(Te+nt==Le.length)+2);for(var pt=0;nt-- >0;){var qe=Le[Te];pt=(pt<<5^qe)&32767;var Ye=-1,Ht=0;if((Ye=Xe[pt])&&(Ye|=Te&-32768,Ye>Te&&(Ye-=32768),Ye<Te))for(;Le[Ye+Ht]==Le[Te+Ht]&&Ht<250;)++Ht;if(Ht>2){qe=ee[Ht],qe<=22?Se=nr(_e,Se,Pe[qe+1]>>1)-1:(nr(_e,Se,3),Se+=5,nr(_e,Se,Pe[qe-23]>>5),Se+=3);var jn=qe<8?0:qe-4>>2;jn>0&&(li(_e,Se,Ht-le[qe]),Se+=jn),qe=J[Te-Ye],Se=nr(_e,Se,Pe[qe]>>3),Se-=3;var Un=qe<4?0:qe-2>>1;Un>0&&(li(_e,Se,Te-Ye-Ie[qe]),Se+=Un);for(var _r=0;_r<Ht;++_r)Xe[pt]=Te&32767,pt=(pt<<5^Le[Te])&32767,++Te;nt-=Ht-1}else qe<=143?qe=qe+48:Se=cn(_e,Se,1),Se=nr(_e,Se,Pe[qe]),Xe[pt]=Te&32767,++Te}Se=nr(_e,Se,0)-1}return _e.l=(Se+7)/8|0,_e.l}return function(_e,Se){return _e.length<8?te(_e,Se):we(_e,Se)}})();function Xr(U){var J=Ne(50+Math.floor(U.length*1.1)),K=Gt(U,J);return J.slice(0,K)}var xr=he?new Uint16Array(32768):dt(32768),Ki=he?new Uint16Array(32768):dt(32768),Qt=he?new Uint16Array(128):dt(128),xi=1,je=1;function xe(U,J){var K=rn(U,J)+257;J+=5;var Z=rn(U,J)+1;J+=5;var ee=ln(U,J)+4;J+=4;for(var te=0,we=he?new Uint8Array(19):dt(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Se=he?new Uint8Array(8):dt(8),Te=he?new Uint8Array(8):dt(8),Xe=we.length,nt=0;nt<ee;++nt)we[q[nt]]=te=Nt(U,J),_e<te&&(_e=te),Se[te]++,J+=3;var pt=0;for(Se[0]=0,nt=1;nt<=_e;++nt)Te[nt]=pt=pt+Se[nt-1]<<1;for(nt=0;nt<Xe;++nt)(pt=we[nt])!=0&&(Le[nt]=Te[pt]++);var qe=0;for(nt=0;nt<Xe;++nt)if(qe=we[nt],qe!=0){pt=Pe[Le[nt]]>>8-qe;for(var Ye=(1<<7-qe)-1;Ye>=0;--Ye)Qt[pt|Ye<<qe]=qe&7|nt<<3}var Ht=[];for(_e=1;Ht.length<K+Z;)switch(pt=Qt[ut(U,J)],J+=pt&7,pt>>>=3){case 16:for(te=3+Dt(U,J),J+=2,pt=Ht[Ht.length-1];te-- >0;)Ht.push(pt);break;case 17:for(te=3+Nt(U,J),J+=3;te-- >0;)Ht.push(0);break;case 18:for(te=11+ut(U,J),J+=7;te-- >0;)Ht.push(0);break;default:Ht.push(pt),_e<pt&&(_e=pt);break}var jn=Ht.slice(0,K),Un=Ht.slice(K);for(nt=K;nt<286;++nt)jn[nt]=0;for(nt=Z;nt<30;++nt)Un[nt]=0;return xi=fn(jn,xr,286),je=fn(Un,Ki,30),J}function ye(U,J){if(U[0]==3&&!(U[1]&3))return[Ed(J),2];for(var K=0,Z=0,ee=y5(J||1<<18),te=0,we=ee.length>>>0,Le=0,_e=0;(Z&1)==0;){if(Z=Nt(U,K),K+=3,Z>>>1)Z>>1==1?(Le=9,_e=5):(K=xe(U,K),Le=xi,_e=je);else{K&7&&(K+=8-(K&7));var Se=U[K>>>3]|U[(K>>>3)+1]<<8;if(K+=32,Se>0)for(!J&&we<te+Se&&(ee=Fn(ee,te+Se),we=ee.length);Se-- >0;)ee[te++]=U[K>>>3],K+=8;continue}for(;;){!J&&we<te+32767&&(ee=Fn(ee,te+32767),we=ee.length);var Te=tr(U,K,Le),Xe=Z>>>1==1?ur[Te]:xr[Te];if(K+=Xe&15,Xe>>>=4,(Xe>>>8&255)===0)ee[te++]=Xe;else{if(Xe==256)break;Xe-=257;var nt=Xe<8?0:Xe-4>>2;nt>5&&(nt=0);var pt=te+le[Xe];nt>0&&(pt+=tr(U,K,nt),K+=nt),Te=tr(U,K,_e),Xe=Z>>>1==1?vt[Te]:Ki[Te],K+=Xe&15,Xe>>>=4;var qe=Xe<4?0:Xe-2>>1,Ye=Ie[Xe];for(qe>0&&(Ye+=tr(U,K,qe),K+=qe),!J&&we<pt&&(ee=Fn(ee,pt+100),we=ee.length);te<pt;)ee[te]=ee[te-Ye],++te}}}return J?[ee,K+7>>>3]:[ee.slice(0,te),K+7>>>3]}function zt(U,J){var K=U.slice(U.l||0),Z=ye(K,J);return U.l+=Z[1],Z[0]}function L(U,J){if(U)typeof console<"u"&&console.error(J);else throw new Error(J)}function kt(U,J){var K=U;aa(K,0);var Z=[],ee=[],te={FileIndex:Z,FullPaths:ee};I(te,{root:J.root});for(var we=K.length-4;(K[we]!=80||K[we+1]!=75||K[we+2]!=5||K[we+3]!=6)&&we>=0;)--we;K.l=we+4,K.l+=4;var Le=K.read_shift(2);K.l+=6;var _e=K.read_shift(4);for(K.l=_e,we=0;we<Le;++we){K.l+=20;var Se=K.read_shift(4),Te=K.read_shift(4),Xe=K.read_shift(2),nt=K.read_shift(2),pt=K.read_shift(2);K.l+=8;var qe=K.read_shift(4),Ye=o(K.slice(K.l+Xe,K.l+Xe+nt));K.l+=Xe+nt+pt;var Ht=K.l;K.l=qe+4,W(K,Se,Te,te,Ye),K.l=Ht}return te}function W(U,J,K,Z,ee){U.l+=2;var te=U.read_shift(2),we=U.read_shift(2),Le=a(U);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var _e=U.read_shift(4),Se=U.read_shift(4),Te=U.read_shift(4),Xe=U.read_shift(2),nt=U.read_shift(2),pt="",qe=0;qe<Xe;++qe)pt+=String.fromCharCode(U[U.l++]);if(nt){var Ye=o(U.slice(U.l,U.l+nt));(Ye[21589]||{}).mt&&(Le=Ye[21589].mt),((ee||{})[21589]||{}).mt&&(Le=ee[21589].mt)}U.l+=nt;var Ht=U.slice(U.l,U.l+Se);switch(we){case 8:Ht=se(U,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var jn=!1;te&8&&(_e=U.read_shift(4),_e==134695760&&(_e=U.read_shift(4),jn=!0),Se=U.read_shift(4),Te=U.read_shift(4)),Se!=J&&L(jn,"Bad compressed size: "+J+" != "+Se),Te!=K&&L(jn,"Bad uncompressed size: "+K+" != "+Te),Lt(Z,pt,Ht,{unsafe:!0,mt:Le})}function Y(U,J){var K=J||{},Z=[],ee=[],te=Ne(1),we=K.compression?8:0,Le=0,_e=0,Se=0,Te=0,Xe=0,nt=U.FullPaths[0],pt=nt,qe=U.FileIndex[0],Ye=[],Ht=0;for(_e=1;_e<U.FullPaths.length;++_e)if(pt=U.FullPaths[_e].slice(nt.length),qe=U.FileIndex[_e],!(!qe.size||!qe.content||pt=="Sh33tJ5")){var jn=Te,Un=Ne(pt.length);for(Se=0;Se<pt.length;++Se)Un.write_shift(1,pt.charCodeAt(Se)&127);Un=Un.slice(0,Un.l),Ye[Xe]=Sye.buf(qe.content,0);var _r=qe.content;we==8&&(_r=ne(_r)),te=Ne(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,Le),te.write_shift(2,we),qe.mt?s(te,qe.mt):te.write_shift(4,0),te.write_shift(-4,Ye[Xe]),te.write_shift(4,_r.length),te.write_shift(4,qe.content.length),te.write_shift(2,Un.length),te.write_shift(2,0),Te+=te.length,Z.push(te),Te+=Un.length,Z.push(Un),Te+=_r.length,Z.push(_r),te=Ne(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,Le),te.write_shift(2,we),te.write_shift(4,0),te.write_shift(-4,Ye[Xe]),te.write_shift(4,_r.length),te.write_shift(4,qe.content.length),te.write_shift(2,Un.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,jn),Ht+=te.l,ee.push(te),Ht+=Un.length,ee.push(Un),++Xe}return te=Ne(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Xe),te.write_shift(2,Xe),te.write_shift(4,Ht),te.write_shift(4,Te),te.write_shift(2,0),Ui([Ui(Z),Ui(ee),te])}var Q={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function fe(U,J){if(U.ctype)return U.ctype;var K=U.name||"",Z=K.match(/\.([^\.]+)$/);return Z&&Q[Z[1]]||J&&(Z=(K=J).match(/[\.\\]([^\.\\])+$/),Z&&Q[Z[1]])?Q[Z[1]]:"application/octet-stream"}function ce(U){for(var J=r1(U),K=[],Z=0;Z<J.length;Z+=76)K.push(J.slice(Z,Z+76));return K.join(`\r
`)+`\r
`}function $e(U){var J=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var Te=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Z=J.split(`\r
`),ee=0;ee<Z.length;++ee){var te=Z[ee];if(te.length==0){K.push("");continue}for(var we=0;we<te.length;){var Le=76,_e=te.slice(we,we+Le);_e.charAt(Le-1)=="="?Le--:_e.charAt(Le-2)=="="?Le-=2:_e.charAt(Le-3)=="="&&(Le-=3),_e=te.slice(we,we+Le),we+=Le,we<te.length&&(_e+="="),K.push(_e)}}return K.join(`\r
`)}function De(U){for(var J=[],K=0;K<U.length;++K){for(var Z=U[K];K<=U.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+U[++K];J.push(Z)}for(var ee=0;ee<J.length;++ee)J[ee]=J[ee].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return go(J.join(`\r
`))}function ze(U,J,K){for(var Z="",ee="",te="",we,Le=0;Le<10;++Le){var _e=J[Le];if(!_e||_e.match(/^\s*$/))break;var Se=_e.match(/^(.*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":Z=Se[2].trim();break;case"content-type":te=Se[2].trim();break;case"content-transfer-encoding":ee=Se[2].trim();break}}switch(++Le,ee.toLowerCase()){case"base64":we=go(hc(J.slice(Le).join("")));break;case"quoted-printable":we=De(J.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ee)}var Te=Lt(U,Z.slice(K.length),we,{unsafe:!0});te&&(Te.ctype=te)}function it(U,J){if(Ae(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=J&&J.root||"",Z=(Ln&&Buffer.isBuffer(U)?U.toString("binary"):Ae(U)).split(`\r
`),ee=0,te="";for(ee=0;ee<Z.length;++ee)if(te=Z[ee],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),K||(K=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),te.slice(0,K.length)!=K););var we=(Z[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var Le="--"+(we[1]||""),_e=[],Se=[],Te={FileIndex:_e,FullPaths:Se};I(Te);var Xe,nt=0;for(ee=0;ee<Z.length;++ee){var pt=Z[ee];pt!==Le&&pt!==Le+"--"||(nt++&&ze(Te,Z.slice(Xe,ee),K),Xe=ee)}return Te}function xt(U,J){var K=J||{},Z=K.boundary||"SheetJS";Z="------="+Z;for(var ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],te=U.FullPaths[0],we=te,Le=U.FileIndex[0],_e=1;_e<U.FullPaths.length;++_e)if(we=U.FullPaths[_e].slice(te.length),Le=U.FileIndex[_e],!(!Le.size||!Le.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ht){return"_x"+Ht.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ht){return"_u"+Ht.charCodeAt(0).toString(16)+"_"});for(var Se=Le.content,Te=Ln&&Buffer.isBuffer(Se)?Se.toString("binary"):Ae(Se),Xe=0,nt=Math.min(1024,Te.length),pt=0,qe=0;qe<=nt;++qe)(pt=Te.charCodeAt(qe))>=32&&pt<128&&++Xe;var Ye=Xe>=nt*4/5;ee.push(Z),ee.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+we),ee.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),ee.push("Content-Type: "+fe(Le,we)),ee.push(""),ee.push(Ye?$e(Te):ce(Te))}return ee.push(Z+`--\r
`),ee.join(`\r
`)}function At(U){var J={};return I(J,U),J}function Lt(U,J,K,Z){var ee=Z&&Z.unsafe;ee||I(U);var te=!ee&&Jn.find(U,J);if(!te){var we=U.FullPaths[0];J.slice(0,we.length)==we?we=J:(we.slice(-1)!="/"&&(we+="/"),we=(we+J).replace("//","/")),te={name:i(J),type:2},U.FileIndex.push(te),U.FullPaths.push(we),ee||Jn.utils.cfb_gc(U)}return te.content=K,te.size=K?K.length:0,Z&&(Z.CLSID&&(te.clsid=Z.CLSID),Z.mt&&(te.mt=Z.mt),Z.ct&&(te.ct=Z.ct)),te}function or(U,J){I(U);var K=Jn.find(U,J);if(K){for(var Z=0;Z<U.FileIndex.length;++Z)if(U.FileIndex[Z]==K)return U.FileIndex.splice(Z,1),U.FullPaths.splice(Z,1),!0}return!1}function br(U,J,K){I(U);var Z=Jn.find(U,J);if(Z){for(var ee=0;ee<U.FileIndex.length;++ee)if(U.FileIndex[ee]==Z)return U.FileIndex[ee].name=i(K),U.FullPaths[ee]=K,!0}return!1}function Xi(U){P(U,!0)}return e.find=N,e.read=z,e.parse=h,e.write=be,e.writeFile=ue,e.utils={cfb_new:At,cfb_add:Lt,cfb_del:or,cfb_mov:br,cfb_gc:Xi,ReadShift:cp,CheckField:QB,prep_blob:aa,bconcat:Ui,use_zlib:V,_deflateRaw:Xr,_inflateRaw:zt,consts:Me},e})();function Tye(n){return typeof n=="string"?IE(n):Array.isArray(n)?Y1e(n):n}function ty(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=IE(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?s1(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([Tye(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=ey(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Hi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function b5(n,e){for(var t=[],r=Hi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function ak(n){for(var e=[],t=Hi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function PE(n){for(var e=[],t=Hi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function bye(n){for(var e=[],t=Hi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var ew=new Date(1899,11,30,0,0,0);function Hs(n,e){var t=n.getTime(),r=ew.getTime()+(n.getTimezoneOffset()-ew.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var OB=new Date,Aye=ew.getTime()+(OB.getTimezoneOffset()-ew.getTimezoneOffset())*6e4,A5=OB.getTimezoneOffset();function DB(n){var e=new Date;return e.setTime(n*24*60*60*1e3+Aye),e.getTimezoneOffset()!==A5&&e.setTime(e.getTime()+(e.getTimezoneOffset()-A5)*6e4),e}var R5=new Date("2017-02-19T19:06:09.000Z"),FB=isNaN(R5.getFullYear())?new Date("2/19/17"):R5,Rye=FB.getFullYear()==2017;function Ts(n,e){var t=new Date(n);if(Rye)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(FB.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ME(n,e){if(Ln&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Ks(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ks(n[t]));return e}function Fr(n,e){for(var t="";t.length<e;)t+=n;return t}function nc(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var Iye=["january","february","march","april","may","june","july","august","september","october","november","december"];function i1(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Iye.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function an(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Ln?r=wc(t):r=Z1e(t),Jn.utils.cfb_add(n,e,r)}Jn.utils.cfb_add(n,e,t)}else n.file(e,t)}function ok(){return Jn.utils.cfb_new()}var oi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Cye={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lk=ak(Cye),ck=/[&<>'"]/g,kye=/[\u0000-\u0008\u000b-\u001f]/g;function Yn(n){var e=n+"";return e.replace(ck,function(t){return lk[t]}).replace(kye,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function I5(n){return Yn(n).replace(/ /g,"_x0020_")}var jB=/[\u0000-\u001f]/g;function Pye(n){var e=n+"";return e.replace(ck,function(t){return lk[t]}).replace(/\n/g,"<br/>").replace(jB,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Mye(n){var e=n+"";return e.replace(ck,function(t){return lk[t]}).replace(jB,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Nye(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function Lye(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function NT(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function C5(n){var e=Ed(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function k5(n){return wc(n,"binary").toString("utf8")}var $x="foo bar baz",lp=Ln&&(k5($x)==NT($x)&&k5||C5($x)==NT($x)&&C5)||NT,s1=Ln?function(n){return wc(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Oye=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),VB=/(^\s|\s$|\n)/;function $i(n,e){return"<"+n+(e.match(VB)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function a1(n){return Hi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function rt(n,e,t){return"<"+n+(t!=null?a1(t):"")+(e!=null?(e.match(VB)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function BA(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function Dye(n,e){switch(typeof n){case"string":var t=rt("vt:lpwstr",Yn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return rt((n|0)==n?"vt:i4":"vt:r8",Yn(String(n)));case"boolean":return rt("vt:bool",n?"true":"false")}if(n instanceof Date)return rt("vt:filetime",BA(n));throw new Error("Unable to serialize "+n)}var Ri={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],la={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Fye(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function jye(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var P5=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},M5=Ln?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:wc(e)})):P5(n)}:P5,N5=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(Lm(n,i)));return r.join("").replace(op,"")},uk=Ln?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(op,""):N5(n,e,t)}:N5,L5=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},BB=Ln?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):L5(n,e,t)}:L5,O5=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Qf(n,i)));return r.join("")},ny=Ln?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):O5(e,t,r)}:O5,GB=function(n,e){var t=ca(n,e);return t>0?ny(n,e+4,e+4+t-1):""},zB=GB,UB=function(n,e){var t=ca(n,e);return t>0?ny(n,e+4,e+4+t-1):""},$B=UB,WB=function(n,e){var t=2*ca(n,e);return t>0?ny(n,e+4,e+4+t-1):""},HB=WB,KB=function(e,t){var r=ca(e,t);return r>0?uk(e,t+4,t+4+r):""},XB=KB,qB=function(n,e){var t=ca(n,e);return t>0?ny(n,e+4,e+4+t):""},YB=qB,ZB=function(n,e){return Fye(n,e)},tw=ZB,hk=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ln&&(zB=function(e,t){if(!Buffer.isBuffer(e))return GB(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},$B=function(e,t){if(!Buffer.isBuffer(e))return UB(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},HB=function(e,t){if(!Buffer.isBuffer(e))return WB(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},XB=function(e,t){if(!Buffer.isBuffer(e))return KB(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},YB=function(e,t){if(!Buffer.isBuffer(e))return qB(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},tw=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):ZB(e,t)},hk=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Qf=function(n,e){return n[e]},Lm=function(n,e){return n[e+1]*256+n[e]},Vye=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},ca=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Oh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},Bye=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function cp(n,e){var t="",r,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Ln&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(Lm(this,c)),c+=2;n*=2;break;case"utf8":t=ny(this,this.l,this.l+n);break;case"utf16le":n*=2,t=uk(this,this.l,this.l+n);break;case"wstr":return cp.call(this,n,"dbcs");case"lpstr-ansi":t=zB(this,this.l),n=4+ca(this,this.l);break;case"lpstr-cp":t=$B(this,this.l),n=4+ca(this,this.l);break;case"lpwstr":t=HB(this,this.l),n=4+2*ca(this,this.l);break;case"lpp4":n=4+ca(this,this.l),t=XB(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+ca(this,this.l),t=YB(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Qf(this,this.l+n++))!==0;)s.push(Gx(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=Lm(this,this.l+n))!==0;)s.push(Gx(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Qf(this,c),this.l=c+1,o=cp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Gx(Lm(this,c))),c+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Qf(this,c),this.l=c+1,o=cp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Gx(Qf(this,c))),c+=1}t=s.join("");break;default:switch(n){case 1:return r=Qf(this,this.l),this.l++,r;case 2:return r=(e==="i"?Vye:Lm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?Oh:Bye)(this,this.l),this.l+=4,r):(i=ca(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=tw(this,this.l):i=tw([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=BB(this,this.l,n);break}}return this.l+=n,t}var Gye=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},zye=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},Uye=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function $ye(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)Uye(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,Gye(this,e,this.l);break;case 8:if(r=8,t==="f"){jye(this,e,this.l);break}case 16:break;case-4:r=4,zye(this,e,this.l);break}return this.l+=r,this}function QB(n,e){var t=BB(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function aa(n,e){n.l=e,n.read_shift=cp,n.chk=QB,n.write_shift=$ye}function ml(n,e){n.l+=e}function Ne(n){var e=Ed(n);return aa(e,0),e}function Gs(){var n=[],e=Ln?256:2048,t=function(c){var h=Ne(c);return aa(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},a=function(){return i(),Ui(n)},o=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ue(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=F2e[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&hk(t)&&n.push(t)}}function up(n,e,t){var r=Ks(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function D5(n,e,t){var r=Ks(n);return r.s=up(r.s,e.s,t),r.e=up(r.e,e.s,t),r}function hp(n,e){if(n.cRel&&n.c<0)for(n=Ks(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ks(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Qn(n);return!n.cRel&&n.cRel!=null&&(t=Kye(t)),!n.rRel&&n.rRel!=null&&(t=Wye(t)),t}function LT(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+fs(n.s.c)+":"+(n.e.cRel?"":"$")+fs(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Wi(n.s.r)+":"+(n.e.rRel?"":"$")+Wi(n.e.r):hp(n.s,e.biff)+":"+hp(n.e,e.biff)}function dk(n){return parseInt(Hye(n),10)-1}function Wi(n){return""+(n+1)}function Wye(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Hye(n){return n.replace(/\$(\d+)$/,"$1")}function fk(n){for(var e=Xye(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function fs(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function Kye(n){return n.replace(/^([A-Z])/,"$$$1")}function Xye(n){return n.replace(/^\$([A-Z])/,"$1")}function qye(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ci(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Qn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ya(n){var e=n.indexOf(":");return e==-1?{s:Ci(n),e:Ci(n)}:{s:Ci(n.slice(0,e)),e:Ci(n.slice(e+1))}}function si(n,e){return typeof e>"u"||typeof e=="number"?si(n.s,n.e):(typeof n!="string"&&(n=Qn(n)),typeof e!="string"&&(e=Qn(e)),n==e?n:n+":"+e)}function yr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function F5(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=Gu(n.z,t?Hs(e):e)}catch{}try{return n.w=Gu((n.XF||{}).numFmtId||(t?14:0),t?Hs(e):e)}catch{return""+e}}function dc(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?ry[n.v]||n.v:e==null?F5(n,n.v):F5(n,e))}function Fd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function JB(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Ci(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=yr(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[g].length;++m)if(!(typeof e[g][m]>"u")){var y={v:e[g][m]},v=a+g,x=o+m;if(c.s.r>v&&(c.s.r=v),c.s.c>x&&(c.s.c=x),c.e.r<v&&(c.e.r=v),c.e.c<x&&(c.e.c=x),e[g][m]&&typeof e[g][m]=="object"&&!Array.isArray(e[g][m])&&!(e[g][m]instanceof Date))y=e[g][m];else if(Array.isArray(y.v)&&(y.f=e[g][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Vr[14],r.cellDates?(y.t="d",y.w=Gu(y.z,Hs(y.v))):(y.t="n",y.v=Hs(y.v),y.w=Gu(y.z,y.v))):y.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(y.z=s[v][x].z),s[v][x]=y;else{var w=Qn({c:x,r:v});s[w]&&s[w].z&&(y.z=s[w].z),s[w]=y}}}return c.s.c<1e7&&(s["!ref"]=si(c)),s}function xg(n,e){return JB(null,n,e)}function Yye(n){return n.read_shift(4,"i")}function Eo(n,e){return e||(e=Ne(4)),e.write_shift(4,n),e}function gs(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function ki(n,e){var t=!1;return e==null&&(t=!0,e=Ne(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function Zye(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Qye(n,e){return e||(e=Ne(4)),e.write_shift(2,0),e.write_shift(2,0),e}function gk(n,e){var t=n.l,r=n.read_shift(1),i=gs(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(Zye(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function Jye(n,e){var t=!1;return e==null&&(t=!0,e=Ne(15+4*n.t.length)),e.write_shift(1,0),ki(n.t,e),t?e.slice(0,e.l):e}var exe=gk;function txe(n,e){var t=!1;return e==null&&(t=!0,e=Ne(23+4*n.t.length)),e.write_shift(1,1),ki(n.t,e),e.write_shift(4,1),Qye({},e),t?e.slice(0,e.l):e}function Ka(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function jd(n,e){return e==null&&(e=Ne(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Vd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Bd(n,e){return e==null&&(e=Ne(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var nxe=gs,eG=ki;function mk(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function nw(n,e){var t=!1;return e==null&&(t=!0,e=Ne(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var rxe=gs,GA=mk,pk=nw;function tG(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?tw([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Oh(e,0)>>2;return t?i/100:i}function nG(n,e){e==null&&(e=Ne(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function rG(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function ixe(n,e){return e||(e=Ne(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Gd=rG,_g=ixe;function vg(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Sd(n,e){return(e||Ne(8)).write_shift(8,n,"f")}function sxe(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=gxe[i];c&&(e.rgb=X5(c));break;case 2:e.rgb=X5([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function rw(n,e){if(e||(e=Ne(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function axe(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function oxe(n,e){e||(e=Ne(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var iG=2,ia=3,Wx=11,iw=19,Hx=64,lxe=65,cxe=71,uxe=4108,hxe=4126,Bi=80,j5={1:{n:"CodePage",t:iG},2:{n:"Category",t:Bi},3:{n:"PresentationFormat",t:Bi},4:{n:"ByteCount",t:ia},5:{n:"LineCount",t:ia},6:{n:"ParagraphCount",t:ia},7:{n:"SlideCount",t:ia},8:{n:"NoteCount",t:ia},9:{n:"HiddenCount",t:ia},10:{n:"MultimediaClipCount",t:ia},11:{n:"ScaleCrop",t:Wx},12:{n:"HeadingPairs",t:uxe},13:{n:"TitlesOfParts",t:hxe},14:{n:"Manager",t:Bi},15:{n:"Company",t:Bi},16:{n:"LinksUpToDate",t:Wx},17:{n:"CharacterCount",t:ia},19:{n:"SharedDoc",t:Wx},22:{n:"HyperlinksChanged",t:Wx},23:{n:"AppVersion",t:ia,p:"version"},24:{n:"DigSig",t:lxe},26:{n:"ContentType",t:Bi},27:{n:"ContentStatus",t:Bi},28:{n:"Language",t:Bi},29:{n:"Version",t:Bi},255:{},2147483648:{n:"Locale",t:iw},2147483651:{n:"Behavior",t:iw},1919054434:{}},V5={1:{n:"CodePage",t:iG},2:{n:"Title",t:Bi},3:{n:"Subject",t:Bi},4:{n:"Author",t:Bi},5:{n:"Keywords",t:Bi},6:{n:"Comments",t:Bi},7:{n:"Template",t:Bi},8:{n:"LastAuthor",t:Bi},9:{n:"RevNumber",t:Bi},10:{n:"EditTime",t:Hx},11:{n:"LastPrinted",t:Hx},12:{n:"CreatedDate",t:Hx},13:{n:"ModifiedDate",t:Hx},14:{n:"PageCount",t:ia},15:{n:"WordCount",t:ia},16:{n:"CharCount",t:ia},17:{n:"Thumbnail",t:cxe},18:{n:"Application",t:Bi},19:{n:"DocSecurity",t:ia},255:{},2147483648:{n:"Locale",t:iw},2147483651:{n:"Behavior",t:iw},1919054434:{}};function dxe(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var fxe=dxe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),gxe=Ks(fxe),ry={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mxe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Kx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function sG(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function aG(n,e){var t=bye(mxe),r=[],i;r[r.length]=oi,r[r.length]=rt("Types",null,{xmlns:Ri.CT,"xmlns:xsd":Ri.xsd,"xmlns:xsi":Ri.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return rt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=rt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Kx[l][e.bookType]||Kx[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=rt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Kx[l][e.bookType]||Kx[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(c){r[r.length]=rt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var In={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function oG(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function b0(n){var e=[oi,rt("Relationships",null,{xmlns:Ri.RELS})];return Hi(n["!id"]).forEach(function(t){e[e.length]=rt("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Hn(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[In.HLINK,In.XPATH,In.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function pxe(n){var e=[oi];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function B5(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function yxe(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function xxe(n){var e=[oi];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(B5(n[t][0],n[t][1])),e.push(yxe("",n[t][0]));return e.push(B5("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function lG(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+qv.version+"</meta:generator></office:meta></office:document-meta>"}var ed=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function OT(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Yn(e),r[r.length]=t?rt(n,e,t):$i(n,e))}function cG(n,e){var t=e||{},r=[oi,rt("cp:coreProperties",null,{"xmlns:cp":Ri.CORE_PROPS,"xmlns:dc":Ri.dc,"xmlns:dcterms":Ri.dcterms,"xmlns:dcmitype":Ri.dcmitype,"xmlns:xsi":Ri.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&OT("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:BA(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&OT("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:BA(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=ed.length;++s){var a=ed[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&OT(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var A0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],uG=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hG(n){var e=[],t=rt;return n||(n={}),n.Application="SheetJS",e[e.length]=oi,e[e.length]=rt("Properties",null,{xmlns:Ri.EXT_PROPS,"xmlns:vt":Ri.vt}),A0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Yn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Yn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function dG(n){var e=[oi,rt("Properties",null,{xmlns:Ri.CUST_PROPS,"xmlns:vt":Ri.vt})];if(!n)return e.join("");var t=1;return Hi(n).forEach(function(i){++t,e[e.length]=rt("property",Dye(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Yn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var G5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function _xe(n,e){var t=[];return Hi(G5).map(function(r){for(var i=0;i<ed.length;++i)if(ed[i][1]==r)return ed[i];for(i=0;i<A0.length;++i)if(A0[i][1]==r)return A0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push($i(G5[r[1]]||r[1],i))}}),rt("DocumentProperties",t.join(""),{xmlns:la.o})}function vxe(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Hi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<ed.length;++a)if(s==ed[a][1])return;for(a=0;a<A0.length;++a)if(s==A0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(rt(I5(s),o,{"dt:dt":l}))}}),e&&Hi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(rt(I5(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+la.o+'">'+i.join("")+"</"+r+">"}function wxe(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Ne(8);return a.write_shift(4,r),a.write_shift(4,i),a}function z5(n,e){var t=Ne(4),r=Ne(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Ne(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=wxe(e);break;case 31:case 80:for(r=Ne(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Ui([t,r])}var fG=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Exe(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function U5(n,e,t){var r=Ne(8),i=[],s=[],a=8,o=0,l=Ne(8),c=Ne(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=Ne(8),c.write_shift(4,0),i.unshift(c);var h=[Ne(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var g=n[o][0];for(l=Ne(8+2*(g.length+1)+(g.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,g.length+1),l.write_shift(0,g,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Ui(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(fG.indexOf(n[o][0])>-1||uG.indexOf(n[o][0])>-1)&&n[o][1]!=null){var m=n[o][1],y=0;if(e){y=+e[n[o][0]];var v=t[y];if(v.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}l=z5(v.t,m)}else{var w=Exe(m);w==-1&&(w=31,m=String(m)),l=z5(w,m)}s.push(l),c=Ne(8),c.write_shift(4,e?y:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Ui([r].concat(i).concat(s))}function $5(n,e,t,r,i,s){var a=Ne(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Jn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=U5(n,t,r);if(o.push(l),i){var c=U5(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Ui(o)}function Sxe(n,e){e||(e=Ne(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function Txe(n,e){return n.read_shift(e)===1}function xs(n,e){return e||(e=Ne(2)),e.write_shift(2,+!!n),e}function gG(n){return n.read_shift(2,"u")}function Pa(n,e){return e||(e=Ne(2)),e.write_shift(2,n),e}function mG(n,e,t){return t||(t=Ne(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function pG(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function bxe(n){var e=n.t||"",t=Ne(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Ne(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return Ui(i)}function Axe(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function Rxe(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):Axe(n,r,t)}function Ixe(n,e,t){if(t.biff>5)return Rxe(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function yG(n,e,t){return t||(t=Ne(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function W5(n,e){e||(e=Ne(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function Cxe(n){var e=Ne(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),W5(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&W5(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Td(n,e,t,r){return r||(r=Ne(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function kxe(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function Pxe(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function xG(n,e){return e||(e=Ne(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function yk(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ne(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Mxe(n,e){var t=!e||e.biff==8,r=Ne(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function Nxe(n,e){var t=!e||e.biff>=8?2:1,r=Ne(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Lxe(n,e){var t=Ne(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=bxe(n[i]);var s=Ui([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function Oxe(){var n=Ne(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Dxe(n){var e=Ne(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Fxe(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Ne(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function jxe(n,e,t,r){var i=Ne(10);return Td(n,e,r,i),i.write_shift(4,t),i}function Vxe(n,e,t,r,i){var s=!i||i.biff==8,a=Ne(8+ +s+(1+s)*t.length);return Td(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function Bxe(n,e,t,r){var i=t&&t.biff==5;r||(r=Ne(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Gxe(n,e){var t=e.biff==8||!e.biff?4:2,r=Ne(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function H5(n,e,t,r){var i=t&&t.biff==5;r||(r=Ne(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function zxe(n){var e=Ne(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Uxe(n,e,t,r,i,s){var a=Ne(8);return Td(n,e,r,a),mG(t,s,a),a}function $xe(n,e,t,r){var i=Ne(14);return Td(n,e,r,i),Sd(t,i),i}function Wxe(n,e,t){if(t.biff<8)return Hxe(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(kxe(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function Hxe(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=pG(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function Kxe(n){var e=Ne(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)xG(n[t],e);return e}function Xxe(n){var e=Ne(24),t=Ci(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Ui([e,Cxe(n[1])])}function qxe(n){var e=n[1].Tooltip,t=Ne(10+2*(e.length+1));t.write_shift(2,2048);var r=Ci(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function Yxe(n){return n||(n=Ne(4)),n.write_shift(2,1),n.write_shift(2,1),n}function Zxe(n,e,t){if(!t.cellStyles)return ml(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function Qxe(n,e){var t=Ne(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function Jxe(n){for(var e=Ne(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function e_e(n,e,t){var r=Ne(15);return sy(r,n,e),r.write_shift(8,t,"f"),r}function t_e(n,e,t){var r=Ne(9);return sy(r,n,e),r.write_shift(2,t),r}var n_e=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=ak({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],h=Ed(1);switch(l.type){case"base64":h=go(hc(o));break;case"binary":h=go(o);break;case"buffer":case"array":h=o;break}aa(h,0);var g=h.read_shift(1),m=!!(g&136),y=!1,v=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var x=0,w=521;g==2&&(x=h.read_shift(2)),h.l+=3,g!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),g!=2&&(w=h.read_shift(2));var T=h.read_shift(2),b=l.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var A=[],M={},O=Math.min(h.length,g==2?521:w-10-(y?264:0)),z=v?32:11;h.l<O&&h[h.l]!=13;)switch(M={},M.name=Yv.utils.decode(b,h.slice(h.l,h.l+z)).replace(/[\u0000\r\n].*$/g,""),h.l+=z,M.type=String.fromCharCode(h.read_shift(1)),g!=2&&!v&&(M.offset=h.read_shift(4)),M.len=h.read_shift(1),g==2&&(M.offset=h.read_shift(2)),M.dec=h.read_shift(1),M.name.length&&A.push(M),g!=2&&(h.l+=v?13:14),M.type){case"B":(!y||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var I=0,R=0;for(c[0]=[],R=0;R!=A.length;++R)c[0][R]=A[R].name;for(;x-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,c[++I]=[],R=0,R=0;R!=A.length;++R){var P=h.slice(h.l,h.l+A[R].len);h.l+=A[R].len,aa(P,0);var F=Yv.utils.decode(b,P);switch(A[R].type){case"C":F.trim().length&&(c[I][R]=F.replace(/\s+$/,""));break;case"D":F.length===8?c[I][R]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):c[I][R]=F;break;case"F":c[I][R]=parseFloat(F.trim());break;case"+":case"I":c[I][R]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":c[I][R]=!0;break;case"N":case"F":c[I][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));c[I][R]="##MEMO##"+(v?parseInt(F.trim(),10):P.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(c[I][R]=+F||0);break;case"@":c[I][R]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[I][R]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[I][R]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[I][R]=-P.read_shift(-8,"f");break;case"B":if(y&&A[R].len==8){c[I][R]=P.read_shift(8,"f");break}case"G":case"P":P.l+=A[R].len;break;case"0":if(A[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[R].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=A,c}function r(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=xg(t(o,c),c);return h["!cols"]=c.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete c.DBF,h}function i(o,l){try{return Fd(r(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&n1(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=Gs(),g=cw(o,{header:1,raw:!0,cellDates:!0}),m=g[0],y=g.slice(1),v=o["!cols"]||[],x=0,w=0,T=0,b=1;for(x=0;x<m.length;++x){if(((v[x]||{}).DBF||{}).name){m[x]=v[x].DBF.name,++T;continue}if(m[x]!=null){if(++T,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(w=0;w<1024;++w)if(m.indexOf(m[x]+"_"+w)==-1){m[x]+="_"+w;break}}}}var A=yr(o["!ref"]),M=[],O=[],z=[];for(x=0;x<=A.e.c-A.s.c;++x){var I="",R="",P=0,F=[];for(w=0;w<y.length;++w)y[w][x]!=null&&F.push(y[w][x]);if(F.length==0||m[x]==null){M[x]="?";continue}for(w=0;w<F.length;++w){switch(typeof F[w]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=F[w]instanceof Date?"D":"C";break;default:R="C"}P=Math.max(P,String(F[w]).length),I=I&&I!=R?"C":R}P>250&&(P=250),R=((v[x]||{}).DBF||{}).type,R=="C"&&v[x].DBF.len>P&&(P=v[x].DBF.len),I=="B"&&R=="N"&&(I="N",z[x]=v[x].DBF.dec,P=v[x].DBF.len),O[x]=I=="C"||R=="N"?P:s[I]||0,b+=O[x],M[x]=I}var N=h.next(32);for(N.write_shift(4,318902576),N.write_shift(4,y.length),N.write_shift(2,296+32*T),N.write_shift(2,b),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+e[vB]||3)<<8),x=0,w=0;x<m.length;++x)if(m[x]!=null){var B=h.next(32),j=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,j,"sbcs"),B.write_shift(1,M[x]=="?"?"C":M[x],"sbcs"),B.write_shift(4,w),B.write_shift(1,O[x]||s[M[x]]||0),B.write_shift(1,z[x]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),w+=O[x]||s[M[x]]||0}var ve=h.next(264);for(ve.write_shift(4,13),x=0;x<65;++x)ve.write_shift(4,0);for(x=0;x<y.length;++x){var ke=h.next(b);for(ke.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(M[w]){case"L":ke.write_shift(1,y[x][w]==null?63:y[x][w]?84:70);break;case"B":ke.write_shift(8,y[x][w]||0,"f");break;case"N":var Ve="0";for(typeof y[x][w]=="number"&&(Ve=y[x][w].toFixed(z[w]||0)),T=0;T<O[w]-Ve.length;++T)ke.write_shift(1,32);ke.write_shift(1,Ve,"sbcs");break;case"D":y[x][w]?(ke.write_shift(4,("0000"+y[x][w].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(y[x][w].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+y[x][w].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Me=String(y[x][w]!=null?y[x][w]:"").slice(0,O[w]);for(ke.write_shift(1,Me,"sbcs"),T=0;T<O[w]-Me.length;++T)ke.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),r_e=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Hi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,y){var v=n[y];return typeof v=="number"?p5(v):v},r=function(m,y,v){var x=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?m:p5(x)};n["|"]=254;function i(m,y){switch(y.type){case"base64":return s(hc(m),y);case"binary":return s(m,y);case"buffer":return s(Ln&&Buffer.isBuffer(m)?m.toString("binary"):ey(m),y);case"array":return s(ME(m),y)}throw new Error("Unrecognized type "+y.type)}function s(m,y){var v=m.split(/[\n\r]+/),x=-1,w=-1,T=0,b=0,A=[],M=[],O=null,z={},I=[],R=[],P=[],F=0,N;for(+y.codepage>=0&&n1(+y.codepage);T!==v.length;++T){F=0;var B=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=B.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),ve=j[0],ke;if(B.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&M.push(B.slice(3).replace(/;;/g,";"));break;case"C":var Ve=!1,Me=!1,ue=!1,Ae=!1,be=-1,re=-1;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"A":break;case"X":w=parseInt(j[b].slice(1))-1,Me=!0;break;case"Y":for(x=parseInt(j[b].slice(1))-1,Me||(w=0),N=A.length;N<=x;++N)A[N]=[];break;case"K":ke=j[b].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(nc(ke))?isNaN(i1(ke).getDate())||(ke=Ts(ke)):(ke=nc(ke),O!==null&&MB(O)&&(ke=DB(ke))),Ve=!0;break;case"E":Ae=!0;var V=tve(j[b].slice(1),{r:x,c:w});A[x][w]=[A[x][w],V];break;case"S":ue=!0,A[x][w]=[A[x][w],"S5S"];break;case"G":break;case"R":be=parseInt(j[b].slice(1))-1;break;case"C":re=parseInt(j[b].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}if(Ve&&(A[x][w]&&A[x][w].length==2?A[x][w][0]=ke:A[x][w]=ke,O=null),ue){if(Ae)throw new Error("SYLK shared formula cannot have own formula");var se=be>-1&&A[be][re];if(!se||!se[1])throw new Error("SYLK shared formula cannot find base");A[x][w][1]=nve(se[1],{r:x-be,c:w-re})}break;case"F":var ne=0;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"X":w=parseInt(j[b].slice(1))-1,++ne;break;case"Y":for(x=parseInt(j[b].slice(1))-1,N=A.length;N<=x;++N)A[N]=[];break;case"M":F=parseInt(j[b].slice(1))/20;break;case"F":break;case"G":break;case"P":O=M[parseInt(j[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=j[b].slice(1).split(" "),N=parseInt(P[0],10);N<=parseInt(P[1],10);++N)F=parseInt(P[2],10),R[N-1]=F===0?{hidden:!0}:{wch:F},xk(R[N-1]);break;case"C":w=parseInt(j[b].slice(1))-1,R[w]||(R[w]={});break;case"R":x=parseInt(j[b].slice(1))-1,I[x]||(I[x]={}),F>0?(I[x].hpt=F,I[x].hpx=SG(F)):F===0&&(I[x].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}ne<1&&(O=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}}return I.length>0&&(z["!rows"]=I),R.length>0&&(z["!cols"]=R),y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),[A,z]}function a(m,y){var v=i(m,y),x=v[0],w=v[1],T=xg(x,y);return Hi(w).forEach(function(b){T[b]=w[b]}),T}function o(m,y){return Fd(a(m,y),y)}function l(m,y,v,x){var w="C;Y"+(v+1)+";X"+(x+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+vk(m.f,{r:v,c:x}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,y){y.forEach(function(v,x){var w="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=sw(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=aw(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function h(m,y){y.forEach(function(v,x){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*ow(v.hpx)+";"),w.length>2&&m.push(w+"R"+(x+1))})}function g(m,y){var v=["ID;PWXL;N;E"],x=[],w=yr(m["!ref"]),T,b=Array.isArray(m),A=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&c(v,m["!cols"]),m["!rows"]&&h(v,m["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var M=w.s.r;M<=w.e.r;++M)for(var O=w.s.c;O<=w.e.c;++O){var z=Qn({r:M,c:O});T=b?(m[M]||[])[O]:m[z],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,m,M,O))}return v.join(A)+A+x.join(A)+A+"E"+A}return{to_workbook:o,to_sheet:a,from_sheet:g}})(),i_e=(function(){function n(s,a){switch(a.type){case"base64":return e(hc(s),a);case"binary":return e(s,a);case"buffer":return e(Ln&&Buffer.isBuffer(s)?s.toString("binary"):ey(s),a);case"array":return e(ME(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,h=0,g=[];h!==o.length;++h){if(o[h].trim()==="BOT"){g[++l]=[],c=0;continue}if(!(l<0)){var m=o[h].trim().split(","),y=m[0],v=m[1];++h;for(var x=o[h]||"";(x.match(/["]/g)||[]).length&1&&h<o.length-1;)x+=`
`+o[++h];switch(x=x.trim(),+y){case-1:if(x==="BOT"){g[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?g[l][c]=!0:x==="FALSE"?g[l][c]=!1:isNaN(nc(v))?isNaN(i1(v).getDate())?g[l][c]=v:g[l][c]=Ts(v):g[l][c]=nc(v),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),g[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(g=g.slice(0,a.sheetRows)),g}function t(s,a){return xg(n(s,a),a)}function r(s,a){return Fd(t(s,a),a)}var i=(function(){var s=function(l,c,h,g,m){l.push(c),l.push(h+","+g),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,c,h,g){l.push(c+","+h),l.push(c==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(l){var c=[],h=yr(l["!ref"]),g,m=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,h.e.r-h.s.r+1,""),s(c,"TUPLES",0,h.e.c-h.s.c+1,""),s(c,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(c,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var x=Qn({r:y,c:v});if(g=m?(l[y]||[])[v]:l[x],!g){a(c,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?a(c,1,0,"="+g.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Gu(g.z||Vr[14],Hs(Ts(g.v)))),a(c,0,g.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,b=c.join(T);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),_G=(function(){function n(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var y=g.split(`
`),v=-1,x=-1,w=0,T=[];w!==y.length;++w){var b=y[w].trim().split(":");if(b[0]==="cell"){var A=Ci(b[1]);if(T.length<=A.r)for(v=T.length;v<=A.r;++v)T[v]||(T[v]=[]);switch(v=A.r,x=A.c,b[2]){case"t":T[v][x]=n(b[3]);break;case"v":T[v][x]=+b[3];break;case"vtf":var M=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[v][x]=!!+b[4];break;default:T[v][x]=+b[4];break}b[2]=="vtf"&&(T[v][x]=[T[v][x],M])}}}return m&&m.sheetRows&&(T=T.slice(0,m.sheetRows)),T}function r(g,m){return xg(t(g,m),m)}function i(g,m){return Fd(r(g,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(g){if(!g||!g["!ref"])return"";for(var m=[],y=[],v,x="",w=ya(g["!ref"]),T=Array.isArray(g),b=w.s.r;b<=w.e.r;++b)for(var A=w.s.c;A<=w.e.c;++A)if(x=Qn({r:b,c:A}),v=T?(g[b]||[])[A]:g[x],!(!v||v.v==null||v.t==="z")){switch(y=["cell",x,"t"],v.t){case"s":case"str":y.push(e(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=e(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var M=Hs(Ts(v.v));y[2]="vtc",y[3]="nd",y[4]=""+M,y[5]=v.w||Gu(v.z||Vr[14],M);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(g){return[s,a,o,a,c(g),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),s_e=(function(){function n(h,g,m,y,v){v.raw?g[m][y]=h:h===""||(h==="TRUE"?g[m][y]=!0:h==="FALSE"?g[m][y]=!1:isNaN(nc(h))?isNaN(i1(h).getDate())?g[m][y]=h:g[m][y]=Ts(h):g[m][y]=nc(h))}function e(h,g){var m=g||{},y=[];if(!h||h.length===0)return y;for(var v=h.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var w=10,T=0,b=0;b<=x;++b)T=v[b].indexOf(" "),T==-1?T=v[b].length:T++,w=Math.max(w,T);for(b=0;b<=x;++b){y[b]=[];var A=0;for(n(v[b].slice(0,w).trim(),y,b,A,m),A=1;A<=(v[b].length-w)/10+1;++A)n(v[b].slice(w+(A-1)*10,w+A*10).trim(),y,b,A,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var g={},m=!1,y=0,v=0;y<h.length;++y)(v=h.charCodeAt(y))==34?m=!m:!m&&v in t&&(g[v]=(g[v]||0)+1);v=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&v.push([g[y],y]);if(!v.length){g=r;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&v.push([g[y],y])}return v.sort(function(x,w){return x[0]-w[0]||r[x[1]]-r[w[1]]}),t[v.pop()[1]]||44}function s(h,g){var m=g||{},y="",v=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):m&&m.FS?y=m.FS:y=i(h.slice(0,1024));var w=0,T=0,b=0,A=0,M=0,O=y.charCodeAt(0),z=!1,I=0,R=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=m.dateNF!=null?wye(m.dateNF):null;function F(){var N=h.slice(A,M),B={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)B.t="z";else if(m.raw)B.t="s",B.v=N;else if(N.trim().length===0)B.t="s",B.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(B.t="s",B.v=N.slice(2,-1).replace(/""/g,'"')):rve(N)?(B.t="n",B.f=N.slice(1)):(B.t="s",B.v=N);else if(N=="TRUE")B.t="b",B.v=!0;else if(N=="FALSE")B.t="b",B.v=!1;else if(!isNaN(b=nc(N)))B.t="n",m.cellText!==!1&&(B.w=N),B.v=b;else if(!isNaN(i1(N).getDate())||P&&N.match(P)){B.z=m.dateNF||Vr[14];var j=0;P&&N.match(P)&&(N=Eye(N,m.dateNF,N.match(P)||[]),j=1),m.cellDates?(B.t="d",B.v=Ts(N,j)):(B.t="n",B.v=Hs(Ts(N,j))),m.cellText!==!1&&(B.w=Gu(B.z,B.v instanceof Date?Hs(B.v):B.v)),m.cellNF||delete B.z}else B.t="s",B.v=N;if(B.t=="z"||(m.dense?(v[w]||(v[w]=[]),v[w][T]=B):v[Qn({c:T,r:w})]=B),A=M+1,R=h.charCodeAt(A),x.e.c<T&&(x.e.c=T),x.e.r<w&&(x.e.r=w),I==O)++T;else if(T=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;M<h.length;++M)switch(I=h.charCodeAt(M)){case 34:R===34&&(z=!z);break;case O:case 10:case 13:if(!z&&F())break e;break}return M-A>0&&F(),v["!ref"]=si(x),v}function a(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,g):xg(e(h,g),g)}function o(h,g){var m="",y=g.type=="string"?[0,0,0,0]:ySe(h,g);switch(g.type){case"base64":m=hc(h);break;case"binary":m=h;break;case"buffer":g.codepage==65001?m=h.toString("utf8"):g.codepage&&typeof Yv<"u"||(m=Ln&&Buffer.isBuffer(h)?h.toString("binary"):ey(h));break;case"array":m=ME(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=lp(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=lp(m):g.type=="binary"&&typeof Yv<"u",m.slice(0,19)=="socialcalc:version:"?_G.to_sheet(g.type=="string"?m:lp(m),g):a(m,g)}function l(h,g){return Fd(o(h,g),g)}function c(h){for(var g=[],m=yr(h["!ref"]),y,v=Array.isArray(h),x=m.s.r;x<=m.e.r;++x){for(var w=[],T=m.s.c;T<=m.e.c;++T){var b=Qn({r:x,c:T});if(y=v?(h[x]||[])[T]:h[b],!y||y.v==null){w.push("          ");continue}for(var A=(y.w||(dc(y),y.w)||"").slice(0,10);A.length<10;)A+=" ";w.push(A+(T===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),K5=(function(){function n(V,se,ne){if(V){aa(V,V.l||0);for(var q=ne.Enum||be;V.l<V.length;){var le=V.read_shift(2),Ie=q[le]||q[65535],Fe=V.read_shift(2),he=V.l+Fe,Pe=Ie.f&&Ie.f(V,Fe,ne);if(V.l=he,se(Pe,Ie,le))return}}}function e(V,se){switch(se.type){case"base64":return t(go(hc(V)),se);case"binary":return t(go(V),se);case"buffer":case"array":return t(V,se)}throw"Unsupported type "+se.type}function t(V,se){if(!V)return V;var ne=se||{},q=ne.dense?[]:{},le="Sheet1",Ie="",Fe=0,he={},Pe=[],Be=[],Rt={s:{r:0,c:0},e:{r:0,c:0}},Dt=ne.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ne.Enum=be,n(V,function(ut,tr,dn){switch(dn){case 0:ne.vers=ut,ut>=4096&&(ne.qpro=!0);break;case 6:Rt=ut;break;case 204:ut&&(Ie=ut);break;case 222:Ie=ut;break;case 15:case 51:ne.qpro||(ut[1].v=ut[1].v.slice(1));case 13:case 14:case 16:dn==14&&(ut[2]&112)==112&&(ut[2]&15)>1&&(ut[2]&15)<15&&(ut[1].z=ne.dateNF||Vr[14],ne.cellDates&&(ut[1].t="d",ut[1].v=DB(ut[1].v))),ne.qpro&&ut[3]>Fe&&(q["!ref"]=si(Rt),he[le]=q,Pe.push(le),q=ne.dense?[]:{},Rt={s:{r:0,c:0},e:{r:0,c:0}},Fe=ut[3],le=Ie||"Sheet"+(Fe+1),Ie="");var cn=ne.dense?(q[ut[0].r]||[])[ut[0].c]:q[Qn(ut[0])];if(cn){cn.t=ut[1].t,cn.v=ut[1].v,ut[1].z!=null&&(cn.z=ut[1].z),ut[1].f!=null&&(cn.f=ut[1].f);break}ne.dense?(q[ut[0].r]||(q[ut[0].r]=[]),q[ut[0].r][ut[0].c]=ut[1]):q[Qn(ut[0])]=ut[1];break}},ne);else if(V[2]==26||V[2]==14)ne.Enum=re,V[2]==14&&(ne.qpro=!0,V.l=0),n(V,function(ut,tr,dn){switch(dn){case 204:le=ut;break;case 22:ut[1].v=ut[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ut[3]>Fe&&(q["!ref"]=si(Rt),he[le]=q,Pe.push(le),q=ne.dense?[]:{},Rt={s:{r:0,c:0},e:{r:0,c:0}},Fe=ut[3],le="Sheet"+(Fe+1)),Dt>0&&ut[0].r>=Dt)break;ne.dense?(q[ut[0].r]||(q[ut[0].r]=[]),q[ut[0].r][ut[0].c]=ut[1]):q[Qn(ut[0])]=ut[1],Rt.e.c<ut[0].c&&(Rt.e.c=ut[0].c),Rt.e.r<ut[0].r&&(Rt.e.r=ut[0].r);break;case 27:ut[14e3]&&(Be[ut[14e3][0]]=ut[14e3][1]);break;case 1537:Be[ut[0]]=ut[1],ut[0]==Fe&&(le=ut[1]);break}},ne);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(q["!ref"]=si(Rt),he[Ie||le]=q,Pe.push(Ie||le),!Be.length)return{SheetNames:Pe,Sheets:he};for(var Nt={},ln=[],rn=0;rn<Be.length;++rn)he[Pe[rn]]?(ln.push(Be[rn]||Pe[rn]),Nt[Be[rn]]=he[Be[rn]]||he[Pe[rn]]):(ln.push(Be[rn]),Nt[Be[rn]]={"!ref":"A1"});return{SheetNames:ln,Sheets:Nt}}function r(V,se){var ne=se||{};if(+ne.codepage>=0&&n1(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Gs(),le=yr(V["!ref"]),Ie=Array.isArray(V),Fe=[];st(q,0,s(1030)),st(q,6,l(le));for(var he=Math.min(le.e.r,8191),Pe=le.s.r;Pe<=he;++Pe)for(var Be=Wi(Pe),Rt=le.s.c;Rt<=le.e.c;++Rt){Pe===le.s.r&&(Fe[Rt]=fs(Rt));var Dt=Fe[Rt]+Be,Nt=Ie?(V[Pe]||[])[Rt]:V[Dt];if(!(!Nt||Nt.t=="z"))if(Nt.t=="n")(Nt.v|0)==Nt.v&&Nt.v>=-32768&&Nt.v<=32767?st(q,13,y(Pe,Rt,Nt.v)):st(q,14,x(Pe,Rt,Nt.v));else{var ln=dc(Nt);st(q,15,g(Pe,Rt,ln.slice(0,239)))}}return st(q,1),q.end()}function i(V,se){var ne=se||{};if(+ne.codepage>=0&&n1(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Gs();st(q,0,a(V));for(var le=0,Ie=0;le<V.SheetNames.length;++le)(V.Sheets[V.SheetNames[le]]||{})["!ref"]&&st(q,27,Ae(V.SheetNames[le],Ie++));var Fe=0;for(le=0;le<V.SheetNames.length;++le){var he=V.Sheets[V.SheetNames[le]];if(!(!he||!he["!ref"])){for(var Pe=yr(he["!ref"]),Be=Array.isArray(he),Rt=[],Dt=Math.min(Pe.e.r,8191),Nt=Pe.s.r;Nt<=Dt;++Nt)for(var ln=Wi(Nt),rn=Pe.s.c;rn<=Pe.e.c;++rn){Nt===Pe.s.r&&(Rt[rn]=fs(rn));var ut=Rt[rn]+ln,tr=Be?(he[Nt]||[])[rn]:he[ut];if(!(!tr||tr.t=="z"))if(tr.t=="n")st(q,23,F(Nt,rn,Fe,tr.v));else{var dn=dc(tr);st(q,22,I(Nt,rn,Fe,dn.slice(0,239)))}}++Fe}}return st(q,1),q.end()}function s(V){var se=Ne(2);return se.write_shift(2,V),se}function a(V){var se=Ne(26);se.write_shift(2,4096),se.write_shift(2,4),se.write_shift(4,0);for(var ne=0,q=0,le=0,Ie=0;Ie<V.SheetNames.length;++Ie){var Fe=V.SheetNames[Ie],he=V.Sheets[Fe];if(!(!he||!he["!ref"])){++le;var Pe=ya(he["!ref"]);ne<Pe.e.r&&(ne=Pe.e.r),q<Pe.e.c&&(q=Pe.e.c)}}return ne>8191&&(ne=8191),se.write_shift(2,ne),se.write_shift(1,le),se.write_shift(1,q),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(1,1),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(4,0),se}function o(V,se,ne){var q={s:{c:0,r:0},e:{c:0,r:0}};return se==8&&ne.qpro?(q.s.c=V.read_shift(1),V.l++,q.s.r=V.read_shift(2),q.e.c=V.read_shift(1),V.l++,q.e.r=V.read_shift(2),q):(q.s.c=V.read_shift(2),q.s.r=V.read_shift(2),se==12&&ne.qpro&&(V.l+=2),q.e.c=V.read_shift(2),q.e.r=V.read_shift(2),se==12&&ne.qpro&&(V.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(V){var se=Ne(8);return se.write_shift(2,V.s.c),se.write_shift(2,V.s.r),se.write_shift(2,V.e.c),se.write_shift(2,V.e.r),se}function c(V,se,ne){var q=[{c:0,r:0},{t:"n",v:0},0,0];return ne.qpro&&ne.vers!=20768?(q[0].c=V.read_shift(1),q[3]=V.read_shift(1),q[0].r=V.read_shift(2),V.l+=2):(q[2]=V.read_shift(1),q[0].c=V.read_shift(2),q[0].r=V.read_shift(2)),q}function h(V,se,ne){var q=V.l+se,le=c(V,se,ne);if(le[1].t="s",ne.vers==20768){V.l++;var Ie=V.read_shift(1);return le[1].v=V.read_shift(Ie,"utf8"),le}return ne.qpro&&V.l++,le[1].v=V.read_shift(q-V.l,"cstr"),le}function g(V,se,ne){var q=Ne(7+ne.length);q.write_shift(1,255),q.write_shift(2,se),q.write_shift(2,V),q.write_shift(1,39);for(var le=0;le<q.length;++le){var Ie=ne.charCodeAt(le);q.write_shift(1,Ie>=128?95:Ie)}return q.write_shift(1,0),q}function m(V,se,ne){var q=c(V,se,ne);return q[1].v=V.read_shift(2,"i"),q}function y(V,se,ne){var q=Ne(7);return q.write_shift(1,255),q.write_shift(2,se),q.write_shift(2,V),q.write_shift(2,ne,"i"),q}function v(V,se,ne){var q=c(V,se,ne);return q[1].v=V.read_shift(8,"f"),q}function x(V,se,ne){var q=Ne(13);return q.write_shift(1,255),q.write_shift(2,se),q.write_shift(2,V),q.write_shift(8,ne,"f"),q}function w(V,se,ne){var q=V.l+se,le=c(V,se,ne);if(le[1].v=V.read_shift(8,"f"),ne.qpro)V.l=q;else{var Ie=V.read_shift(2);M(V.slice(V.l,V.l+Ie),le),V.l+=Ie}return le}function T(V,se,ne){var q=se&32768;return se&=-32769,se=(q?V:0)+(se>=8192?se-16384:se),(q?"":"$")+(ne?fs(se):Wi(se))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(V,se){aa(V,0);for(var ne=[],q=0,le="",Ie="",Fe="",he="";V.l<V.length;){var Pe=V[V.l++];switch(Pe){case 0:ne.push(V.read_shift(8,"f"));break;case 1:Ie=T(se[0].c,V.read_shift(2),!0),le=T(se[0].r,V.read_shift(2),!1),ne.push(Ie+le);break;case 2:{var Be=T(se[0].c,V.read_shift(2),!0),Rt=T(se[0].r,V.read_shift(2),!1);Ie=T(se[0].c,V.read_shift(2),!0),le=T(se[0].r,V.read_shift(2),!1),ne.push(Be+Rt+":"+Ie+le)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ne.push("("+ne.pop()+")");break;case 5:ne.push(V.read_shift(2));break;case 6:{for(var Dt="";Pe=V[V.l++];)Dt+=String.fromCharCode(Pe);ne.push('"'+Dt.replace(/"/g,'""')+'"')}break;case 8:ne.push("-"+ne.pop());break;case 23:ne.push("+"+ne.pop());break;case 22:ne.push("NOT("+ne.pop()+")");break;case 20:case 21:he=ne.pop(),Fe=ne.pop(),ne.push(["AND","OR"][Pe-20]+"("+Fe+","+he+")");break;default:if(Pe<32&&A[Pe])he=ne.pop(),Fe=ne.pop(),ne.push(Fe+A[Pe]+he);else if(b[Pe]){if(q=b[Pe][1],q==69&&(q=V[V.l++]),q>ne.length){console.error("WK1 bad formula parse 0x"+Pe.toString(16)+":|"+ne.join("|")+"|");return}var Nt=ne.slice(-q);ne.length-=q,ne.push(b[Pe][0]+"("+Nt.join(",")+")")}else return Pe<=7?console.error("WK1 invalid opcode "+Pe.toString(16)):Pe<=24?console.error("WK1 unsupported op "+Pe.toString(16)):Pe<=30?console.error("WK1 invalid opcode "+Pe.toString(16)):Pe<=115?console.error("WK1 unsupported function opcode "+Pe.toString(16)):console.error("WK1 unrecognized opcode "+Pe.toString(16))}}ne.length==1?se[1].f=""+ne[0]:console.error("WK1 bad formula parse |"+ne.join("|")+"|")}function O(V){var se=[{c:0,r:0},{t:"n",v:0},0];return se[0].r=V.read_shift(2),se[3]=V[V.l++],se[0].c=V[V.l++],se}function z(V,se){var ne=O(V);return ne[1].t="s",ne[1].v=V.read_shift(se-4,"cstr"),ne}function I(V,se,ne,q){var le=Ne(6+q.length);le.write_shift(2,V),le.write_shift(1,ne),le.write_shift(1,se),le.write_shift(1,39);for(var Ie=0;Ie<q.length;++Ie){var Fe=q.charCodeAt(Ie);le.write_shift(1,Fe>=128?95:Fe)}return le.write_shift(1,0),le}function R(V,se){var ne=O(V);ne[1].v=V.read_shift(2);var q=ne[1].v>>1;if(ne[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return ne[1].v=q,ne}function P(V,se){var ne=O(V),q=V.read_shift(4),le=V.read_shift(4),Ie=V.read_shift(2);if(Ie==65535)return q===0&&le===3221225472?(ne[1].t="e",ne[1].v=15):q===0&&le===3489660928?(ne[1].t="e",ne[1].v=42):ne[1].v=0,ne;var Fe=Ie&32768;return Ie=(Ie&32767)-16446,ne[1].v=(1-Fe*2)*(le*Math.pow(2,Ie+32)+q*Math.pow(2,Ie)),ne}function F(V,se,ne,q){var le=Ne(14);if(le.write_shift(2,V),le.write_shift(1,ne),le.write_shift(1,se),q==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var Ie=0,Fe=0,he=0,Pe=0;return q<0&&(Ie=1,q=-q),Fe=Math.log2(q)|0,q/=Math.pow(2,Fe-31),Pe=q>>>0,(Pe&2147483648)==0&&(q/=2,++Fe,Pe=q>>>0),q-=Pe,Pe|=2147483648,Pe>>>=0,q*=Math.pow(2,32),he=q>>>0,le.write_shift(4,he),le.write_shift(4,Pe),Fe+=16383+(Ie?32768:0),le.write_shift(2,Fe),le}function N(V,se){var ne=P(V);return V.l+=se-14,ne}function B(V,se){var ne=O(V),q=V.read_shift(4);return ne[1].v=q>>6,ne}function j(V,se){var ne=O(V),q=V.read_shift(8,"f");return ne[1].v=q,ne}function ve(V,se){var ne=j(V);return V.l+=se-10,ne}function ke(V,se){return V[V.l+se-1]==0?V.read_shift(se,"cstr"):""}function Ve(V,se){var ne=V[V.l++];ne>se-1&&(ne=se-1);for(var q="";q.length<ne;)q+=String.fromCharCode(V[V.l++]);return q}function Me(V,se,ne){if(!(!ne.qpro||se<21)){var q=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var le=V.read_shift(se-21,"cstr");return[q,le]}}function ue(V,se){for(var ne={},q=V.l+se;V.l<q;){var le=V.read_shift(2);if(le==14e3){for(ne[le]=[0,""],ne[le][0]=V.read_shift(2);V[V.l];)ne[le][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ne}function Ae(V,se){var ne=Ne(5+V.length);ne.write_shift(2,14e3),ne.write_shift(2,se);for(var q=0;q<V.length;++q){var le=V.charCodeAt(q);ne[ne.l++]=le>127?95:le}return ne[ne.l++]=0,ne}var be={0:{n:"BOF",f:gG},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:Ve},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),a_e=/^\s|\s$|[\t\n\r]/;function vG(n,e){if(!e.bookSST)return"";var t=[oi];t[t.length]=rt("sst",null,{xmlns:yg[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(a_e)&&(s+=' xml:space="preserve"'),s+=">"+Yn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function o_e(n){return[n.read_shift(4),n.read_shift(4)]}function l_e(n,e){return e||(e=Ne(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var c_e=Jye;function u_e(n){var e=Gs();Ue(e,159,l_e(n));for(var t=0;t<n.length;++t)Ue(e,19,c_e(n[t]));return Ue(e,160),e.end()}function h_e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function wG(n){var e=0,t,r=h_e(n),i=r.length+1,s,a,o,l,c;for(t=Ed(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var d_e=(function(){function n(i,s){switch(s.type){case"base64":return e(hc(i),s);case"binary":return e(i,s);case"buffer":return e(Ln&&Buffer.isBuffer(i)?i.toString("binary"):ey(i),s);case"array":return e(ME(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,g){Array.isArray(o)&&(o[g]=[]);for(var m=/\\\w+\b/g,y=0,v,x=-1;v=m.exec(h);){switch(v[0]){case"\\cell":var w=h.slice(y,m.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var T={v:w,t:"s"};Array.isArray(o)?o[g][x]=T:o[Qn({r:g,c:x})]=T}break}y=m.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=si(c),o}function t(i,s){return Fd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=yr(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var g=Qn({r:c,c:h});o=l?(i[c]||[])[h]:i[g],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(dc(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function X5(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var f_e=6,rc=f_e;function sw(n){return Math.floor((n+Math.round(128/rc)/256)*rc)}function aw(n){return Math.floor((n-5)/rc*100+.5)/100}function zA(n){return Math.round((n*rc+5)/rc*256)/256}function xk(n){n.width?(n.wpx=sw(n.width),n.wch=aw(n.wpx),n.MDW=rc):n.wpx?(n.wch=aw(n.wpx),n.width=zA(n.wch),n.MDW=rc):typeof n.wch=="number"&&(n.width=zA(n.wch),n.wpx=sw(n.width),n.MDW=rc),n.customWidth&&delete n.customWidth}var g_e=96,EG=g_e;function ow(n){return n*96/EG}function SG(n){return n*EG/96}function m_e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=rt("numFmt",null,{numFmtId:r,formatCode:Yn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=rt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function p_e(n){var e=[];return e[e.length]=rt("cellXfs",null),n.forEach(function(t){e[e.length]=rt("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=rt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function TG(n,e){var t=[oi,rt("styleSheet",null,{xmlns:yg[0],"xmlns:vt":Ri.vt})],r;return n.SSF&&(r=m_e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=p_e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function y_e(n,e){var t=n.read_shift(2),r=gs(n);return[t,r]}function x_e(n,e,t){t||(t=Ne(6+4*e.length)),t.write_shift(2,n),ki(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function __e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=axe(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=sxe(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=gs(n),r}function v_e(n,e){e||(e=Ne(153)),e.write_shift(2,n.sz*20),oxe(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),rw(n.color,e);var r=0;return r=2,e.write_shift(1,r),ki(n.name,e),e.length>e.l?e.slice(0,e.l):e}var w_e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],DT,E_e=ml;function q5(n,e){e||(e=Ne(84)),DT||(DT=ak(w_e));var t=DT[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(rw({auto:1},e),rw({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function S_e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function bG(n,e,t){t||(t=Ne(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function xm(n,e){return e||(e=Ne(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var T_e=ml;function b_e(n,e){return e||(e=Ne(51)),e.write_shift(1,0),xm(null,e),xm(null,e),xm(null,e),xm(null,e),xm(null,e),e.length>e.l?e.slice(0,e.l):e}function A_e(n,e){return e||(e=Ne(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),nw(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function R_e(n,e,t){var r=Ne(2052);return r.write_shift(4,n),nw(e,r),nw(t,r),r.length>r.l?r.slice(0,r.l):r}function I_e(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ue(n,615,Eo(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ue(n,44,x_e(i,e[i]))}),Ue(n,616))}}function C_e(n){var e=1;Ue(n,611,Eo(e)),Ue(n,43,v_e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ue(n,612)}function k_e(n){var e=2;Ue(n,603,Eo(e)),Ue(n,45,q5({patternType:"none"})),Ue(n,45,q5({patternType:"gray125"})),Ue(n,604)}function P_e(n){var e=1;Ue(n,613,Eo(e)),Ue(n,46,b_e()),Ue(n,614)}function M_e(n){var e=1;Ue(n,626,Eo(e)),Ue(n,47,bG({numFmtId:0},65535)),Ue(n,627)}function N_e(n,e){Ue(n,617,Eo(e.length)),e.forEach(function(t){Ue(n,47,bG(t,0))}),Ue(n,618)}function L_e(n){var e=1;Ue(n,619,Eo(e)),Ue(n,48,A_e({xfId:0,name:"Normal"})),Ue(n,620)}function O_e(n){var e=0;Ue(n,505,Eo(e)),Ue(n,506)}function D_e(n){var e=0;Ue(n,508,R_e(e,"TableStyleMedium9","PivotStyleMedium4")),Ue(n,509)}function F_e(n,e){var t=Gs();return Ue(t,278),I_e(t,n.SSF),C_e(t),k_e(t),P_e(t),M_e(t),N_e(t,e.cellXfs),L_e(t),O_e(t),D_e(t),Ue(t,279),t.end()}function AG(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[oi];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function j_e(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:gs(n)}}function V_e(n){var e=Ne(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),ki(n.name,e),e.slice(0,e.l)}function B_e(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function G_e(n){var e=Ne(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function z_e(n,e){var t=Ne(8+2*e.length);return t.write_shift(4,n),ki(e,t),t.slice(0,t.l)}function U_e(n){return n.l+=4,n.read_shift(4)!=0}function $_e(n,e){var t=Ne(8);return t.write_shift(4,n),t.write_shift(4,1),t}function W_e(){var n=Gs();return Ue(n,332),Ue(n,334,Eo(1)),Ue(n,335,V_e({name:"XLDAPR",version:12e4,flags:3496657072})),Ue(n,336),Ue(n,339,z_e(1,"XLDAPR")),Ue(n,52),Ue(n,35,Eo(514)),Ue(n,4096,Eo(0)),Ue(n,4097,Pa(1)),Ue(n,36),Ue(n,53),Ue(n,340),Ue(n,337,$_e(1)),Ue(n,51,G_e([[1,0]])),Ue(n,338),Ue(n,333),n.end()}function RG(){var n=[oi];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function H_e(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Qn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var u0=1024;function IG(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[rt("xml",null,{"xmlns:v":la.v,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:mv":la.mv}).replace(/\/>/,">"),rt("o:shapelayout",rt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),rt("v:shapetype",[rt("v:stroke",null,{joinstyle:"miter"}),rt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];u0<n*1e3;)u0+=1e3;return e.forEach(function(s){var a=Ci(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?rt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=rt("v:fill",l,o),h={on:"t",obscured:"t"};++u0,i=i.concat(["<v:shape"+a1({id:"_x0000_s"+u0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,rt("v:shadow",null,h),rt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",$i("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),$i("x:AutoFill","False"),$i("x:Row",String(a.r)),$i("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function CG(n){var e=[oi,rt("comments",null,{xmlns:yg[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Yn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Yn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push($i("t",Yn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push($i("t",Yn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function K_e(n,e,t){var r=[oi,rt("ThreadedComments",null,{xmlns:Ri.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(rt("threadedComment",$i("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function X_e(n){var e=[oi,rt("personList",null,{xmlns:Ri.TCMNT,"xmlns:x":yg[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(rt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function q_e(n){var e={};e.iauthor=n.read_shift(4);var t=Gd(n);return e.rfx=t.s,e.ref=Qn(t.s),n.l+=16,e}function Y_e(n,e){return e==null&&(e=Ne(36)),e.write_shift(4,n[1].iauthor),_g(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Z_e=gs;function Q_e(n){return ki(n.slice(0,54))}function J_e(n){var e=Gs(),t=[];return Ue(e,628),Ue(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ue(e,632,Q_e(i.a)))})}),Ue(e,631),Ue(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Ci(r[0]),e:Ci(r[0])};Ue(e,635,Y_e([s,i])),i.t&&i.t.length>0&&Ue(e,637,txe(i)),Ue(e,636),delete i.iauthor})}),Ue(e,634),Ue(e,629),e.end()}function eve(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Jn.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var kG=["xlsb","xlsm","xlam","biff8","xla"],tve=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,i+(o?"":"$")+fs(h)+(l?"":"$")+Wi(c)}return function(i,s){return e=s,i.replace(n,t)}})(),_k=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vk=(function(){return function(e,t){return e.replace(_k,function(r,i,s,a,o,l){var c=fk(a)-(s?0:t.c),h=dk(l)-(o?0:t.r),g=h==0?"":o?h+1:"["+h+"]",m=c==0?"":s?c+1:"["+c+"]";return i+"R"+g+"C"+m})}})();function nve(n,e){return n.replace(_k,function(t,r,i,s,a,o){return r+(i=="$"?i+s:fs(fk(s)+e.c))+(a=="$"?a+o:Wi(dk(o)+e.r))})}function rve(n){return n.length!=1}function Zr(n){n.l+=1}function zu(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function PG(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return MG(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=zu(n),o=zu(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function MG(n){var e=zu(n),t=zu(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function ive(n,e,t){if(t.biff<8)return MG(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=zu(n),a=zu(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function NG(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return sve(n);var r=n.read_shift(t&&t.biff==12?4:2),i=zu(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function sve(n){var e=zu(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function ave(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function ove(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return lve(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function lve(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function cve(n,e,t){var r=(n[n.l++]&96)>>5,i=PG(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function uve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=PG(n,s,t);return[r,i,a]}function hve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function dve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function fve(n,e,t){var r=(n[n.l++]&96)>>5,i=ive(n,e-1,t);return[r,i]}function gve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Y5(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function mve(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function pve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function yve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function xve(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function _ve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function LG(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function vve(n){return n.read_shift(2),LG(n)}function wve(n){return n.read_shift(2),LG(n)}function Eve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=NG(n,0,t);return[r,i]}function Sve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=ove(n,0,t);return[r,i]}function Tve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=NG(n,0,t);return[r,i,s]}function bve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[bwe[i],FG[i],r]}function Ave(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:Rve(n);return[i,(s[0]===0?FG:Twe)[s[1]]]}function Rve(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function Ive(n,e,t){n.l+=t&&t.biff==2?3:4}function Cve(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function kve(n){return n.l++,ry[n.read_shift(1)]}function Pve(n){return n.l++,n.read_shift(2)}function Mve(n){return n.l++,n.read_shift(1)!==0}function Nve(n){return n.l++,vg(n)}function Lve(n,e,t){return n.l++,pG(n,e-1,t)}function Ove(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Txe(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=ry[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=vg(n);break;case 2:t[1]=Ixe(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Dve(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?Gd:Pxe)(n));return i}function Fve(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Ove(n,t.biff);return a}function jve(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function Vve(n,e,t){if(t.biff==5)return Bve(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function Bve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function Gve(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function zve(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Uve(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function $ve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var Wve=ml,Hve=ml,Kve=ml;function iy(n,e,t){return n.l+=2,[ave(n)]}function wk(n){return n.l+=6,[]}var Xve=iy,qve=wk,Yve=wk,Zve=iy;function OG(n){return n.l+=2,[gG(n),n.read_shift(2)&1]}var Qve=iy,Jve=OG,ewe=wk,twe=iy,nwe=iy,rwe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function iwe(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=rwe[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function swe(n){return n.l+=2,[n.read_shift(4)]}function awe(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function owe(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function lwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function cwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function uwe(n){return n.l+=4,[0,0]}var Z5={1:{n:"PtgExp",f:Cve},2:{n:"PtgTbl",f:Kve},3:{n:"PtgAdd",f:Zr},4:{n:"PtgSub",f:Zr},5:{n:"PtgMul",f:Zr},6:{n:"PtgDiv",f:Zr},7:{n:"PtgPower",f:Zr},8:{n:"PtgConcat",f:Zr},9:{n:"PtgLt",f:Zr},10:{n:"PtgLe",f:Zr},11:{n:"PtgEq",f:Zr},12:{n:"PtgGe",f:Zr},13:{n:"PtgGt",f:Zr},14:{n:"PtgNe",f:Zr},15:{n:"PtgIsect",f:Zr},16:{n:"PtgUnion",f:Zr},17:{n:"PtgRange",f:Zr},18:{n:"PtgUplus",f:Zr},19:{n:"PtgUminus",f:Zr},20:{n:"PtgPercent",f:Zr},21:{n:"PtgParen",f:Zr},22:{n:"PtgMissArg",f:Zr},23:{n:"PtgStr",f:Lve},26:{n:"PtgSheet",f:awe},27:{n:"PtgEndSheet",f:owe},28:{n:"PtgErr",f:kve},29:{n:"PtgBool",f:Mve},30:{n:"PtgInt",f:Pve},31:{n:"PtgNum",f:Nve},32:{n:"PtgArray",f:gve},33:{n:"PtgFunc",f:bve},34:{n:"PtgFuncVar",f:Ave},35:{n:"PtgName",f:jve},36:{n:"PtgRef",f:Eve},37:{n:"PtgArea",f:cve},38:{n:"PtgMemArea",f:Gve},39:{n:"PtgMemErr",f:Wve},40:{n:"PtgMemNoMem",f:Hve},41:{n:"PtgMemFunc",f:zve},42:{n:"PtgRefErr",f:Uve},43:{n:"PtgAreaErr",f:hve},44:{n:"PtgRefN",f:Sve},45:{n:"PtgAreaN",f:fve},46:{n:"PtgMemAreaN",f:lwe},47:{n:"PtgMemNoMemN",f:cwe},57:{n:"PtgNameX",f:Vve},58:{n:"PtgRef3d",f:Tve},59:{n:"PtgArea3d",f:uve},60:{n:"PtgRefErr3d",f:$ve},61:{n:"PtgAreaErr3d",f:dve},255:{}},hwe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dwe={1:{n:"PtgElfLel",f:OG},2:{n:"PtgElfRw",f:twe},3:{n:"PtgElfCol",f:Xve},6:{n:"PtgElfRwV",f:nwe},7:{n:"PtgElfColV",f:Zve},10:{n:"PtgElfRadical",f:Qve},11:{n:"PtgElfRadicalS",f:ewe},13:{n:"PtgElfColS",f:qve},15:{n:"PtgElfColSV",f:Yve},16:{n:"PtgElfRadicalLel",f:Jve},25:{n:"PtgList",f:iwe},29:{n:"PtgSxName",f:swe},255:{}},fwe={0:{n:"PtgAttrNoop",f:uwe},1:{n:"PtgAttrSemi",f:_ve},2:{n:"PtgAttrIf",f:yve},4:{n:"PtgAttrChoose",f:mve},8:{n:"PtgAttrGoto",f:pve},16:{n:"PtgAttrSum",f:Ive},32:{n:"PtgAttrBaxcel",f:Y5},33:{n:"PtgAttrBaxcel",f:Y5},64:{n:"PtgAttrSpace",f:vve},65:{n:"PtgAttrSpaceSemi",f:wve},128:{n:"PtgAttrIfError",f:xve},255:{}};function gwe(n,e,t,r){if(r.biff<8)return ml(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=Fve(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=Dve(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(ml(n,e)),s}function mwe(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=Z5[s]||Z5[hwe[s]],(s===24||s===25)&&(i=(s===24?dwe:fwe)[n[n.l+1]]),!i||!i.f?ml(n,e):a.push([i.n,i.f(n,e,t)]);return a}function pwe(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var ywe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xwe(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function DG(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Q5(n,e,t){var r=DG(n,e,t);return r=="#REF"?r:xwe(r,t)}function ng(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,h,g=0,m=0,y,v="";if(!n[0]||!n[0][0])return"";for(var x=-1,w="",T=0,b=n[0].length;T<b;++T){var A=n[0][T];switch(A[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(n[0][x][1][0]){case 0:w=Fr(" ",n[0][x][1][1]);break;case 1:w=Fr("\r",n[0][x][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}c=c+w,x=-1}o.push(c+ywe[A[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=up(A[1][1],a,i),o.push(hp(h,s));break;case"PtgRefN":h=t?up(A[1][1],t,i):A[1][1],o.push(hp(h,s));break;case"PtgRef3d":g=A[1][1],h=up(A[1][2],a,i),v=Q5(r,g,i),o.push(v+"!"+hp(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=A[1][0],O=A[1][1];M||(M=0),M&=127;var z=M==0?[]:o.slice(-M);o.length-=M,O==="User"&&(O=z.shift()),o.push(O+"("+z.join(",")+")");break;case"PtgBool":o.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(A[1]);break;case"PtgNum":o.push(String(A[1]));break;case"PtgStr":o.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(A[1]);break;case"PtgAreaN":y=D5(A[1][1],t?{s:t}:a,i),o.push(LT(y,i));break;case"PtgArea":y=D5(A[1][1],a,i),o.push(LT(y,i));break;case"PtgArea3d":g=A[1][1],y=A[1][2],v=Q5(r,g,i),o.push(v+"!"+LT(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=A[1][2];var I=(r.names||[])[m-1]||(r[0]||[])[m],R=I?I.Name:"SH33TJSNAME"+String(m);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var P=A[1][1];m=A[1][2];var F;if(i.biff<=5)P<0&&(P=-P),r[P]&&(F=r[P][m]);else{var N="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][m]&&r[P][m].itab>0&&(N=r.SheetNames[r[P][m].itab-1]+"!"):N=r.SheetNames[m-1]+"!"),r[P]&&r[P][m])N+=r[P][m].Name;else if(r[0]&&r[0][m])N+=r[0][m].Name;else{var B=(DG(r,P,i)||"").split(";;");B[m-1]?N=B[m-1]:N+="SH33TJSERRX"}o.push(N);break}F||(F={Name:"SH33TJSERRY"}),o.push(F.Name);break;case"PtgParen":var j="(",ve=")";if(x>=0){switch(w="",n[0][x][1][0]){case 2:j=Fr(" ",n[0][x][1][1])+j;break;case 3:j=Fr("\r",n[0][x][1][1])+j;break;case 4:ve=Fr(" ",n[0][x][1][1])+ve;break;case 5:ve=Fr("\r",n[0][x][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}o.push(j+o.pop()+ve);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:A[1][1],r:A[1][0]};var ke={c:t.c,r:t.r};if(r.sharedf[Qn(h)]){var Ve=r.sharedf[Qn(h)];o.push(ng(Ve,a,ke,r,i))}else{var Me=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(ng(c[1],a,ke,r,i)),Me=!0;break}Me||o.push(A[1])}break;case"PtgArray":o.push("{"+pwe(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ue.indexOf(n[0][T][0])==-1){A=n[0][x];var Ae=!0;switch(A[1][0]){case 4:Ae=!1;case 0:w=Fr(" ",A[1][1]);break;case 5:Ae=!1;case 1:w=Fr("\r",A[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}o.push((Ae?w:"")+o.pop()+(Ae?"":w)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function _we(n){if(n==null){var e=Ne(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Sd(n);return Sd(0)}function vwe(n,e,t,r,i){var s=Td(e,t,i),a=_we(n.v),o=Ne(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Ne(n.bf.length),h=0;h<n.bf.length;++h)c[h]=n.bf[h];var g=Ui([s,a,o,c]);return g}function NE(n,e,t){var r=n.read_shift(4),i=mwe(n,r,t),s=n.read_shift(4),a=s>0?gwe(n,s,i,t):null;return[i,a]}var wwe=NE,LE=NE,Ewe=NE,Swe=NE,Twe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},FG={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bwe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Awe(n){var e="of:="+n.replace(_k,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Rwe(n){return n.replace(/\./,"!")}var dp=typeof Map<"u";function Ek(n,e,t){var r=0,i=n.length;if(t){if(dp?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=dp?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(dp?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function OE(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(rc=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=aw(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=zA(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function jG(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Yu(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){NB(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Iwe(n,e,t){if(n&&n["!ref"]){var r=yr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function Cwe(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+si(n[t])+'"/>';return e+"</mergeCells>"}function kwe(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=s1(Yn(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),o=(o||"")+rt("outlinePr",null,c)}!s&&!o||(i[i.length]=rt("sheetPr",o,a))}var Pwe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Mwe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Nwe(n){var e={sheet:1};return Pwe.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),Mwe.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=wG(n.password).toString(16).toUpperCase()),rt("sheetProtection",null,e)}function Lwe(n){return jG(n),rt("pageMargins",null,n)}function Owe(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=rt("col",null,OE(i,r)));return t[t.length]="</cols>",t.join("")}function Dwe(n,e,t,r){var i=typeof n.ref=="string"?n.ref:si(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=ya(i);a.s.r==a.e.r&&(a.e.r=ya(e["!ref"]).e.r,i=si(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),rt("autoFilter",null,{ref:i})}function Fwe(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),rt("sheetViews",rt("sheetView",null,i),{})}function jwe(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=ry[n.v];break;case"d":r&&r.cellDates?i=Ts(n.v,-1).toISOString():(n=Ks(n),n.t="n",i=""+(n.v=Hs(Ts(n.v)))),typeof n.z>"u"&&(n.z=Vr[14]);break;default:i=n.v;break}var o=$i("v",Yn(i)),l={r:e},c=Yu(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=$i("v",""+Ek(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=rt("f",Yn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),rt("c",o,l)}function Vwe(n,e,t,r){var i=[],s=[],a=yr(n["!ref"]),o="",l,c="",h=[],g=0,m=0,y=n["!rows"],v=Array.isArray(n),x={r:c},w,T=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=fs(m);for(g=a.s.r;g<=a.e.r;++g){for(s=[],c=Wi(g),m=a.s.c;m<=a.e.c;++m){l=h[m]+c;var b=v?(n[g]||[])[m]:n[l];b!==void 0&&(o=jwe(b,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[g])&&(x={r:c},y&&y[g]&&(w=y[g],w.hidden&&(x.hidden=1),T=-1,w.hpx?T=ow(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(x.ht=T,x.customHeight=1),w.level&&(x.outlineLevel=w.level)),i[i.length]=rt("row",s.join(""),x))}if(y)for(;g<y.length;++g)y&&y[g]&&(x={r:g+1},w=y[g],w.hidden&&(x.hidden=1),T=-1,w.hpx?T=ow(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(x.ht=T,x.customHeight=1),w.level&&(x.outlineLevel=w.level),i[i.length]=rt("row","",x));return i.join("")}function VG(n,e,t,r){var i=[oi,rt("worksheet",null,{xmlns:yg[0],"xmlns:r":Ri.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",h=yr(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=si(h)}r||(r={}),l["!comments"]=[];var g=[];kwe(l,t,n,e,i),i[i.length]=rt("dimension",null,{ref:c}),i[i.length]=Fwe(l,e,n,t),e.sheetFormat&&(i[i.length]=rt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Owe(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Vwe(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=Nwe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Dwe(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Cwe(l["!merges"]));var m=-1,y,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(y={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=Hn(r,-1,Yn(x[1].Target).replace(/#.*$/,""),In.HLINK),y["r:id"]="rId"+v),(m=x[1].Target.indexOf("#"))>-1&&(y.location=Yn(x[1].Target.slice(m+1))),x[1].Tooltip&&(y.tooltip=Yn(x[1].Tooltip)),i[i.length]=rt("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Lwe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=$i("ignoredErrors",rt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),g.length>0&&(v=Hn(r,-1,"../drawings/drawing"+(n+1)+".xml",In.DRAW),i[i.length]=rt("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=g),l["!comments"].length>0&&(v=Hn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",In.VML),i[i.length]=rt("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Bwe(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function Gwe(n,e,t){var r=Ne(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=ow(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var g=-1,m=-1,y=h<<10;y<h+1<<10;++y){c.c=y;var v=Array.isArray(t)?(t[c.r]||[])[c.c]:t[Qn(c)];v&&(g<0&&(g=y),m=y)}g<0||(++o,r.write_shift(4,g),r.write_shift(4,m))}var x=r.l;return r.l=l,r.write_shift(4,o),r.l=x,r.length>r.l?r.slice(0,r.l):r}function zwe(n,e,t,r){var i=Gwe(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ue(n,0,i)}var Uwe=Gd,$we=_g;function Wwe(){}function Hwe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=nxe(n),t}function Kwe(n,e,t){t==null&&(t=Ne(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return rw({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),eG(n,t),t.slice(0,t.l)}function Xwe(n){var e=Ka(n);return[e]}function qwe(n,e,t){return t==null&&(t=Ne(8)),jd(e,t)}function Ywe(n){var e=Vd(n);return[e]}function Zwe(n,e,t){return t==null&&(t=Ne(4)),Bd(e,t)}function Qwe(n){var e=Ka(n),t=n.read_shift(1);return[e,t,"b"]}function Jwe(n,e,t){return t==null&&(t=Ne(9)),jd(e,t),t.write_shift(1,n.v?1:0),t}function eEe(n){var e=Vd(n),t=n.read_shift(1);return[e,t,"b"]}function tEe(n,e,t){return t==null&&(t=Ne(5)),Bd(e,t),t.write_shift(1,n.v?1:0),t}function nEe(n){var e=Ka(n),t=n.read_shift(1);return[e,t,"e"]}function rEe(n,e,t){return t==null&&(t=Ne(9)),jd(e,t),t.write_shift(1,n.v),t}function iEe(n){var e=Vd(n),t=n.read_shift(1);return[e,t,"e"]}function sEe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function aEe(n){var e=Ka(n),t=n.read_shift(4);return[e,t,"s"]}function oEe(n,e,t){return t==null&&(t=Ne(12)),jd(e,t),t.write_shift(4,e.v),t}function lEe(n){var e=Vd(n),t=n.read_shift(4);return[e,t,"s"]}function cEe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),t.write_shift(4,e.v),t}function uEe(n){var e=Ka(n),t=vg(n);return[e,t,"n"]}function hEe(n,e,t){return t==null&&(t=Ne(16)),jd(e,t),Sd(n.v,t),t}function dEe(n){var e=Vd(n),t=vg(n);return[e,t,"n"]}function fEe(n,e,t){return t==null&&(t=Ne(12)),Bd(e,t),Sd(n.v,t),t}function gEe(n){var e=Ka(n),t=tG(n);return[e,t,"n"]}function mEe(n,e,t){return t==null&&(t=Ne(12)),jd(e,t),nG(n.v,t),t}function pEe(n){var e=Vd(n),t=tG(n);return[e,t,"n"]}function yEe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),nG(n.v,t),t}function xEe(n){var e=Ka(n),t=gk(n);return[e,t,"is"]}function _Ee(n){var e=Ka(n),t=gs(n);return[e,t,"str"]}function vEe(n,e,t){return t==null&&(t=Ne(12+4*n.v.length)),jd(e,t),ki(n.v,t),t.length>t.l?t.slice(0,t.l):t}function wEe(n){var e=Vd(n),t=gs(n);return[e,t,"str"]}function EEe(n,e,t){return t==null&&(t=Ne(8+4*n.v.length)),Bd(e,t),ki(n.v,t),t.length>t.l?t.slice(0,t.l):t}function SEe(n,e,t){var r=n.l+e,i=Ka(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=LE(n,r-n.l,t);a[3]=ng(o,null,i,t.supbooks,t)}else n.l=r;return a}function TEe(n,e,t){var r=n.l+e,i=Ka(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=LE(n,r-n.l,t);a[3]=ng(o,null,i,t.supbooks,t)}else n.l=r;return a}function bEe(n,e,t){var r=n.l+e,i=Ka(n);i.r=t["!row"];var s=vg(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=LE(n,r-n.l,t);a[3]=ng(o,null,i,t.supbooks,t)}else n.l=r;return a}function AEe(n,e,t){var r=n.l+e,i=Ka(n);i.r=t["!row"];var s=gs(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=LE(n,r-n.l,t);a[3]=ng(o,null,i,t.supbooks,t)}else n.l=r;return a}var REe=Gd,IEe=_g;function CEe(n,e){return e==null&&(e=Ne(4)),e.write_shift(4,n),e}function kEe(n,e){var t=n.l+e,r=Gd(n),i=mk(n),s=gs(n),a=gs(n),o=gs(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function PEe(n,e){var t=Ne(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));_g({s:Ci(n[0]),e:Ci(n[0])},t),pk("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return ki(i||"",t),ki(n[1].Tooltip||"",t),ki("",t),t.slice(0,t.l)}function MEe(){}function NEe(n,e,t){var r=n.l+e,i=rG(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=wwe(n,r-n.l,t);a[1]=o}else n.l=r;return a}function LEe(n,e,t){var r=n.l+e,i=Gd(n),s=[i];if(t.cellFormula){var a=Swe(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function OEe(n,e,t){t==null&&(t=Ne(18));var r=OE(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var BG=["left","right","top","bottom","header","footer"];function DEe(n){var e={};return BG.forEach(function(t){e[t]=vg(n)}),e}function FEe(n,e){return e==null&&(e=Ne(48)),jG(n),BG.forEach(function(t){Sd(n[t],e)}),e}function jEe(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function VEe(n,e,t){t==null&&(t=Ne(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function BEe(n){var e=Ne(24);return e.write_shift(4,4),e.write_shift(4,1),_g(n,e),e}function GEe(n,e){return e==null&&(e=Ne(66)),e.write_shift(2,n.password?wG(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function zEe(){}function UEe(){}function $Ee(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ks(e),e.z=e.z||Vr[14],e.v=Hs(Ts(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Yu(i.cellXfs,e,i),e.l&&s["!links"].push([Qn(l),e.l]),e.c&&s["!comments"].push([Qn(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=Ek(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ue(n,18,cEe(e,l)):Ue(n,7,oEe(e,l))):(l.t="str",a?Ue(n,17,EEe(e,l)):Ue(n,6,vEe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ue(n,13,yEe(e,l)):Ue(n,2,mEe(e,l)):a?Ue(n,16,fEe(e,l)):Ue(n,5,hEe(e,l)),!0;case"b":return l.t="b",a?Ue(n,15,tEe(e,l)):Ue(n,4,Jwe(e,l)),!0;case"e":return l.t="e",a?Ue(n,14,sEe(e,l)):Ue(n,3,rEe(e,l)),!0}return a?Ue(n,12,Zwe(e,l)):Ue(n,1,qwe(e,l)),!0}function WEe(n,e,t,r){var i=yr(e["!ref"]||"A1"),s,a="",o=[];Ue(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=c;++h){a=Wi(h),zwe(n,e,i,h);var g=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(o[m]=fs(m)),s=o[m]+a;var y=l?(e[h]||[])[m]:e[s];if(!y){g=!1;continue}g=$Ee(n,y,h,m,r,e,g)}}Ue(n,146)}function HEe(n,e){!e||!e["!merges"]||(Ue(n,177,CEe(e["!merges"].length)),e["!merges"].forEach(function(t){Ue(n,176,IEe(t))}),Ue(n,178))}function KEe(n,e){!e||!e["!cols"]||(Ue(n,390),e["!cols"].forEach(function(t,r){t&&Ue(n,60,OEe(r,t))}),Ue(n,391))}function XEe(n,e){!e||!e["!ref"]||(Ue(n,648),Ue(n,649,BEe(yr(e["!ref"]))),Ue(n,650))}function qEe(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Hn(t,-1,r[1].Target.replace(/#.*$/,""),In.HLINK);Ue(n,494,PEe(r,i))}}),delete e["!links"]}function YEe(n,e,t,r){if(e["!comments"].length>0){var i=Hn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",In.VML);Ue(n,551,pk("rId"+i)),e["!legacy"]=i}}function ZEe(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:si(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ya(s);o.s.r==o.e.r&&(o.e.r=ya(e["!ref"]).e.r,s=si(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ue(n,161,_g(yr(s))),Ue(n,162)}}function QEe(n,e,t){Ue(n,133),Ue(n,137,VEe(e,t)),Ue(n,138),Ue(n,134)}function JEe(n,e){e["!protect"]&&Ue(n,535,GEe(e["!protect"]))}function e2e(n,e,t,r){var i=Gs(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=yr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ue(i,129),(t.vbaraw||a["!outline"])&&Ue(i,147,Kwe(o,a["!outline"])),Ue(i,148,$we(l)),QEe(i,a,t.Workbook),KEe(i,a),WEe(i,a,n,e),JEe(i,a),ZEe(i,a,t,n),HEe(i,a),qEe(i,a,r),a["!margins"]&&Ue(i,476,FEe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&XEe(i,a),YEe(i,a,n,r),Ue(i,130),i.end()}function t2e(n,e){n.l+=10;var t=gs(n);return{name:t}}var n2e=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function r2e(n){return!n.Workbook||!n.Workbook.WBProps?"false":Lye(n.Workbook.WBProps.date1904)?"true":"false"}var i2e="][*?/\\".split("");function GG(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return i2e.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function s2e(n,e,t){n.forEach(function(r,i){GG(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function a2e(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];s2e(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)Iwe(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function zG(n){var e=[oi];e[e.length]=rt("workbook",null,{xmlns:yg[0],"xmlns:r":Ri.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(n2e.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=rt("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Yn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=rt("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=rt("definedName",Yn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function o2e(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=GA(n),t.name=gs(n),t}function l2e(n,e){return e||(e=Ne(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),pk(n.strRelID,e),ki(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function c2e(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?gs(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function u2e(n,e){e||(e=Ne(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),eG(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function h2e(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=rxe(n),a=Ewe(n,0,t),o=mk(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function d2e(n,e){Ue(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ue(n,156,l2e(i))}Ue(n,144)}function f2e(n,e){e||(e=Ne(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return ki("SheetJS",e),ki(qv.version,e),ki(qv.version,e),ki("7262",e),e.length>e.l?e.slice(0,e.l):e}function g2e(n,e){e||(e=Ne(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function m2e(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ue(n,135),Ue(n,158,g2e(i)),Ue(n,136))}}function p2e(n,e){var t=Gs();return Ue(t,131),Ue(t,128,f2e()),Ue(t,153,u2e(n.Workbook&&n.Workbook.WBProps||null)),m2e(t,n),d2e(t,n),Ue(t,132),t.end()}function y2e(n,e,t){return(e.slice(-4)===".bin"?p2e:zG)(n)}function x2e(n,e,t,r,i){return(e.slice(-4)===".bin"?e2e:VG)(n,t,r,i)}function _2e(n,e,t){return(e.slice(-4)===".bin"?F_e:TG)(n,t)}function v2e(n,e,t){return(e.slice(-4)===".bin"?u_e:vG)(n,t)}function w2e(n,e,t){return(e.slice(-4)===".bin"?J_e:CG)(n)}function E2e(n){return(n.slice(-4)===".bin"?W_e:RG)()}function S2e(n,e){var t=[];return n.Props&&t.push(_xe(n.Props,e)),n.Custprops&&t.push(vxe(n.Props,n.Custprops)),t.join("")}function T2e(){return""}function b2e(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(rt("NumberFormat",null,{"ss:Format":Yn(Vr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(rt("Style",s.join(""),a))}),rt("Styles",t.join(""))}function UG(n){return rt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+vk(n.Ref,{r:0,c:0})})}function A2e(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(UG(i)))}return rt("Names",t.join(""))}function R2e(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(UG(o)))}return s.join("")}function I2e(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(rt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(rt("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(rt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(rt("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push($i("ProtectContents","True")),n["!protect"].objects&&i.push($i("ProtectObjects","True")),n["!protect"].scenarios&&i.push($i("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push($i("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push($i("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":rt("WorksheetOptions",i.join(""),{xmlns:la.x})}function C2e(n){return n.map(function(e){var t=Nye(e.t||""),r=rt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return rt("Comment",r,{"ss:Author":e.a})}).join("")}function k2e(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Yn(vk(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=Ci(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Yn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Yn(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var g="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":g="Number",m=String(n.v);break;case"b":g="Boolean",m=n.v?"1":"0";break;case"e":g="Error",m=ry[n.v];break;case"d":g="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Vr[14]);break;case"s":g="String",m=Mye(n.v||"");break}var y=Yu(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var v=n.v!=null?m:"",x=n.t=="z"?"":'<Data ss:Type="'+g+'">'+v+"</Data>";return(n.c||[]).length>0&&(x+=C2e(n.c)),rt("Cell",x,o)}function P2e(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=SG(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function M2e(n,e,t,r){if(!n["!ref"])return"";var i=yr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(w,T){xk(w);var b=!!w.width,A=OE(T,w),M={"ss:Index":T+1};b&&(M["ss:Width"]=sw(A.width)),w.hidden&&(M["ss:Hidden"]="1"),o.push(rt("Column",null,M))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var h=[P2e(c,(n["!rows"]||[])[c])],g=i.s.c;g<=i.e.c;++g){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>g)&&!(s[a].s.r>c)&&!(s[a].e.c<g)&&!(s[a].e.r<c)){(s[a].s.c!=g||s[a].s.r!=c)&&(m=!0);break}if(!m){var y={r:c,c:g},v=Qn(y),x=l?(n[c]||[])[g]:n[v];h.push(k2e(x,v,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function N2e(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?R2e(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?M2e(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(I2e(s,e,n,t)),r.join("")}function L2e(n,e){e||(e={}),n.SSF||(n.SSF=Ks(Vr)),n.SSF&&(kE(),CE(n.SSF),e.revssf=PE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Yu(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(S2e(n,e)),t.push(T2e()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(rt("Worksheet",N2e(r,e,n),{"ss:Name":Yn(n.SheetNames[r])}));return t[2]=b2e(n,e),t[3]=A2e(n),oi+rt("Workbook",t.join(""),{xmlns:la.ss,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:ss":la.ss,"xmlns:dt":la.dt,"xmlns:html":la.html})}var FT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function O2e(n,e){var t=[],r=[],i=[],s=0,a,o=b5(j5,"n"),l=b5(V5,"n");if(n.Props)for(a=Hi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Hi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)fG.indexOf(i[s][0])>-1||uG.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&Jn.utils.cfb_add(e,"/SummaryInformation",$5(r,FT.SI,l,V5)),(t.length||c.length)&&Jn.utils.cfb_add(e,"/DocumentSummaryInformation",$5(t,FT.DSI,o,j5,c.length?c:null,FT.UDI))}function D2e(n,e){var t=e||{},r=Jn.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Jn.utils.cfb_add(r,i,$G(n,t)),t.biff==8&&(n.Props||n.Custprops)&&O2e(n,r),t.biff==8&&n.vbaraw&&eve(r,Jn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var F2e={0:{f:Bwe},1:{f:Xwe},2:{f:gEe},3:{f:nEe},4:{f:Qwe},5:{f:uEe},6:{f:_Ee},7:{f:aEe},8:{f:AEe},9:{f:bEe},10:{f:SEe},11:{f:TEe},12:{f:Ywe},13:{f:pEe},14:{f:iEe},15:{f:eEe},16:{f:dEe},17:{f:wEe},18:{f:lEe},19:{f:gk},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:h2e},40:{},42:{},43:{f:__e},44:{f:y_e},45:{f:E_e},46:{f:T_e},47:{f:S_e},48:{},49:{f:Yye},50:{},51:{f:B_e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Zxe},62:{f:xEe},63:{f:H_e},64:{f:zEe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ml,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:jEe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Hwe},148:{f:Uwe,p:16},151:{f:MEe},152:{},153:{f:c2e},154:{},155:{},156:{f:o2e},157:{},158:{},159:{T:1,f:o_e},160:{T:-1},161:{T:1,f:Gd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:REe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:j_e},336:{T:-1},337:{f:U_e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:GA},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Wxe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:NEe},427:{f:LEe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DEe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Wwe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kEe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:GA},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Z_e},633:{T:1},634:{T:-1},635:{T:1,f:q_e},636:{T:-1},637:{f:exe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:t2e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:UEe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function st(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&hk(t)&&n.push(t)}}function j2e(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return st(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(h=n.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function sy(n,e,t){return n||(n=Ne(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function V2e(n,e,t,r){var i=Ne(9);return sy(i,n,e),mG(t,r||"b",i),i}function B2e(n,e,t){var r=Ne(8+2*t.length);return sy(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function G2e(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Hs(Ts(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?st(n,2,t_e(t,r,i)):st(n,3,e_e(t,r,i));return;case"b":case"e":st(n,5,V2e(t,r,e.v,e.t));return;case"s":case"str":st(n,4,B2e(t,r,(e.v||"").slice(0,255)));return}st(n,1,sy(null,t,r))}function z2e(n,e,t,r){var i=Array.isArray(e),s=yr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=si(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Wi(c);for(var h=s.s.c;h<=s.e.c;++h){c===s.s.r&&(l[h]=fs(h)),a=l[h]+o;var g=i?(e[c]||[])[h]:e[a];g&&G2e(n,g,c,h)}}}function U2e(n,e){for(var t=e||{},r=Gs(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return st(r,t.biff==4?1033:t.biff==3?521:9,yk(n,16,t)),z2e(r,n.Sheets[n.SheetNames[i]],i,t),st(r,10),r.end()}function $2e(n,e,t){st(n,49,Fxe({sz:12,name:"Arial"},t))}function W2e(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&st(n,1054,Bxe(i,e[i],t))})}function H2e(n,e){var t=Ne(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),st(n,2151,t),t=Ne(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),xG(yr(e["!ref"]||"A1"),t),t.write_shift(4,4),st(n,2152,t)}function K2e(n,e){for(var t=0;t<16;++t)st(n,224,H5({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){st(n,224,H5(r,0,e))})}function X2e(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];st(n,440,Xxe(r)),r[1].Tooltip&&st(n,2048,qxe(r))}delete e["!links"]}function q2e(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&st(n,125,Qxe(OE(i,r),i))})}}function Y2e(n,e,t,r,i){var s=16+Yu(i.cellXfs,e,i);if(e.v==null&&!e.bf){st(n,513,Td(t,r,s));return}if(e.bf)st(n,6,vwe(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Hs(Ts(e.v)):e.v;st(n,515,$xe(t,r,a,s));break;case"b":case"e":st(n,517,Uxe(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=Ek(i.Strings,e.v,i.revStrings);st(n,253,jxe(t,r,o,s))}else st(n,516,Vxe(t,r,(e.v||"").slice(0,255),s,i));break;default:st(n,513,Td(t,r,s))}}function Z2e(n,e,t){var r=Gs(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),c=e.biff==8,h,g="",m=[],y=yr(s["!ref"]||"A1"),v=c?65536:16384;if(y.e.c>255||y.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}st(r,2057,yk(t,16,e)),st(r,13,Pa(1)),st(r,12,Pa(100)),st(r,15,xs(!0)),st(r,17,xs(!1)),st(r,16,Sd(.001)),st(r,95,xs(!0)),st(r,42,xs(!1)),st(r,43,xs(!1)),st(r,130,Pa(1)),st(r,128,zxe()),st(r,131,xs(!1)),st(r,132,xs(!1)),c&&q2e(r,s["!cols"]),st(r,512,Gxe(y,e)),c&&(s["!links"]=[]);for(var x=y.s.r;x<=y.e.r;++x){g=Wi(x);for(var w=y.s.c;w<=y.e.c;++w){x===y.s.r&&(m[w]=fs(w)),h=m[w]+g;var T=l?(s[x]||[])[w]:s[h];T&&(Y2e(r,T,x,w,e),c&&T.l&&s["!links"].push([h,T.l]))}}var b=o.CodeName||o.name||i;return c&&st(r,574,Dxe((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&st(r,229,Kxe(s["!merges"])),c&&X2e(r,s),st(r,442,yG(b)),c&&H2e(r,s),st(r,10),r.end()}function Q2e(n,e,t){var r=Gs(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(st(r,2057,yk(n,5,t)),t.bookType=="xla"&&st(r,135),st(r,225,o?Pa(1200):null),st(r,193,Sxe(2)),l&&st(r,191),l&&st(r,192),st(r,226),st(r,92,Mxe("SheetJS",t)),st(r,66,Pa(o?1200:1252)),o&&st(r,353,Pa(0)),o&&st(r,448),st(r,317,Jxe(n.SheetNames.length)),o&&n.vbaraw&&st(r,211),o&&n.vbaraw){var c=a.CodeName||"ThisWorkbook";st(r,442,yG(c))}st(r,156,Pa(17)),st(r,25,xs(!1)),st(r,18,xs(!1)),st(r,19,Pa(0)),o&&st(r,431,xs(!1)),o&&st(r,444,Pa(0)),st(r,61,Oxe()),st(r,64,xs(!1)),st(r,141,Pa(0)),st(r,34,xs(r2e(n)=="true")),st(r,14,xs(!0)),o&&st(r,439,xs(!1)),st(r,218,Pa(0)),$2e(r,n,t),W2e(r,n.SSF,t),K2e(r,t),o&&st(r,352,xs(!1));var h=r.end(),g=Gs();o&&st(g,140,Yxe()),o&&t.Strings&&j2e(g,252,Lxe(t.Strings)),st(g,10);var m=g.end(),y=Gs(),v=0,x=0;for(x=0;x<n.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*n.SheetNames[x].length;var w=h.length+v+m.length;for(x=0;x<n.SheetNames.length;++x){var T=s[x]||{};st(y,133,Nxe({pos:w,hs:T.Hidden||0,dt:0,name:n.SheetNames[x]},t)),w+=e[x].length}var b=y.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var A=[];return h.length&&A.push(h),b.length&&A.push(b),m.length&&A.push(m),Ui(A)}function J2e(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Ks(Vr)),n&&n.SSF&&(kE(),CE(n.SSF),t.revssf=PE(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sk(t),t.cellXfs=[],Yu(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=Z2e(i,t,n);return r.unshift(Q2e(n,r,t)),Ui(r)}function $G(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=ya(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return J2e(n,e);case 4:case 3:case 2:return U2e(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function eSe(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>a)&&!(i[c].e.r<t||i[c].e.c<a)){if(i[c].s.r<t||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var h=Qn({r:t,c:a}),g=r.dense?(n[t]||[])[a]:n[h],m=g&&g.v!=null&&(g.h||Pye(g.w||(dc(g),g.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?m='<span contenteditable="true">'+m+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(rt("td",m,y))}}var v="<tr>";return v+s.join("")+"</tr>"}var tSe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nSe="</body></html>";function rSe(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function WG(n,e){var t=e||{},r=t.header!=null?t.header:tSe,i=t.footer!=null?t.footer:nSe,s=[r],a=ya(n["!ref"]);t.dense=Array.isArray(n),s.push(rSe(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(eSe(n,a,o,t));return s.push("</table>"+i),s.join("")}function HG(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?Ci(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=ya(n["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var g=[],m=0,y=n["!rows"]||(n["!rows"]=[]),v=0,x=0,w=0,T=0,b=0,A=0;for(n["!cols"]||(n["!cols"]=[]);v<o.length&&x<l;++v){var M=o[v];if(J5(M)){if(r.display)continue;y[x]={hidden:!0}}var O=M.children;for(w=T=0;w<O.length;++w){var z=O[w];if(!(r.display&&J5(z))){var I=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Oye(z.innerHTML),R=z.getAttribute("data-z")||z.getAttribute("z");for(m=0;m<g.length;++m){var P=g[m];P.s.c==T+s&&P.s.r<x+i&&x+i<=P.e.r&&(T=P.e.c+1-s,m=-1)}A=+z.getAttribute("colspan")||1,((b=+z.getAttribute("rowspan")||1)>1||A>1)&&g.push({s:{r:x+i,c:T+s},e:{r:x+i+(b||1)-1,c:T+s+(A||1)-1}});var F={t:"s",v:I},N=z.getAttribute("data-t")||z.getAttribute("t")||"";I!=null&&(I.length==0?F.t=N||"z":r.raw||I.trim().length==0||N=="s"||(I==="TRUE"?F={t:"b",v:!0}:I==="FALSE"?F={t:"b",v:!1}:isNaN(nc(I))?isNaN(i1(I).getDate())||(F={t:"d",v:Ts(I)},r.cellDates||(F={t:"n",v:Hs(F.v)}),F.z=r.dateNF||Vr[14]):F={t:"n",v:nc(I)})),F.z===void 0&&R!=null&&(F.z=R);var B="",j=z.getElementsByTagName("A");if(j&&j.length)for(var ve=0;ve<j.length&&!(j[ve].hasAttribute("href")&&(B=j[ve].getAttribute("href"),B.charAt(0)!="#"));++ve);B&&B.charAt(0)!="#"&&(F.l={Target:B}),r.dense?(n[x+i]||(n[x+i]=[]),n[x+i][T+s]=F):n[Qn({c:T+s,r:x+i})]=F,c.e.c<T+s&&(c.e.c=T+s),T+=A}}++x}return g.length&&(n["!merges"]=(n["!merges"]||[]).concat(g)),c.e.r=Math.max(c.e.r,x-1+i),n["!ref"]=si(c),x>=l&&(n["!fullref"]=si((c.e.r=o.length-v+x-1+i,c))),n}function KG(n,e){var t=e||{},r=t.dense?[]:{};return HG(r,n,e)}function iSe(n,e){return Fd(KG(n,e),e)}function J5(n){var e="",t=sSe(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function sSe(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var aSe=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+a1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return oi+e}})(),eD=(function(){var n=function(s){return Yn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Yn(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,g=ya(s["!ref"]||"A1"),m=s["!merges"]||[],y=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=g.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",w=s["!rows"]||[];for(c=0;c<g.s.r;++c)x=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=g.e.r;++c){for(x=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),h=0;h<g.s.c;++h)l.push(e);for(;h<=g.e.c;++h){var T=!1,b={},A="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>h)&&!(m[y].s.r>c)&&!(m[y].e.c<h)&&!(m[y].e.r<c)){(m[y].s.c!=h||m[y].s.r!=c)&&(T=!0),b["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,b["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(T){l.push(t);continue}var M=Qn({r:c,c:h}),O=v?(s[c]||[])[h]:s[M];if(O&&O.f&&(b["table:formula"]=Yn(Awe(O.f)),O.F&&O.F.slice(0,M.length)==M)){var z=ya(O.F);b["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,b["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!O){l.push(e);continue}switch(O.t){case"b":A=O.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=O.v?"true":"false";break;case"n":A=O.w||String(O.v||0),b["office:value-type"]="float",b["office:value"]=O.v||0;break;case"s":case"str":A=O.v==null?"":O.v,b["office:value-type"]="string";break;case"d":A=O.w||Ts(O.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Ts(O.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var I=n(A);if(O.l&&O.l.Target){var R=O.l.Target;R=R.charAt(0)=="#"?"#"+Rwe(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),I=rt("text:a",I,{"xlink:href":R.replace(/&/g,"&amp;")})}l.push("          "+rt("table:table-cell",rt("text:p",I,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var g=c["!cols"][h];if(g.width==null&&g.wpx==null&&g.wch==null)continue;xk(g),g.ods=o;var m=c["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var g=c["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[oi],c=a1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=a1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(lG().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var g=0;g!=a.SheetNames.length;++g)l.push(r(a.Sheets[a.SheetNames[g]],a,g));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function XG(n,e){if(e.bookType=="fods")return eD(n,e);var t=ok(),r="",i=[],s=[];return r="mimetype",an(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",an(t,r,eD(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",an(t,r,aSe(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",an(t,r,oi+lG()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",an(t,r,xxe(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",an(t,r,pxe(i)),t}function lw(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function oSe(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):go(s1(n))}function lSe(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Uu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function cSe(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function o1(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Wn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function R0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function di(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=o1(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=o1(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Di(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Wn(r*8+i.type)),i.type==2&&e.push(Wn(i.data.length)),e.push(i.data))})}),Uu(e)}function ro(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=o1(n,r),s=di(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:R0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=di(o.data),c=R0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=R0(s[3][0].data)>>>0>0),t.push(a)}return t}function Ff(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Wn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Wn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Wn(a.data.length)}],r[2].push({data:Di(a.meta),type:2})});var s=Di(r);e.push(Wn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Uu(e)}function uSe(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=o1(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Uu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var h=Uu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function io(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(uSe(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Uu(e)}function jf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Wn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Uu(e)}function jT(n,e){var t=new Uint8Array(32),r=lw(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,cSe(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function VT(n,e){var t=new Uint8Array(32),r=lw(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Qc(n){var e=di(n);return o1(e[1][0].data)}function hSe(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&R0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=lw(n[7][0].data),h=0,g=[],m=lw(n[4][0].data),y=0,v=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}c.setUint16(x*2,h,!0),m.setUint16(x*2,y,!0);var w,T;switch(typeof e[x]){case"string":w=jT({t:"s",v:e[x]},t),T=VT({t:"s",v:e[x]},t);break;case"number":w=jT({t:"n",v:e[x]},t),T=VT({t:"n",v:e[x]},t);break;case"boolean":w=jT({t:"b",v:e[x]},t),T=VT({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}g.push(w),h+=w.length,v.push(T),y+=T.length,++l}for(n[2][0].data=Wn(l);x<n[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return n[6][0].data=Uu(g),n[3][0].data=Uu(v),l}function dSe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ya(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(si(r)));var s=cw(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(se){return se.forEach(function(ne){typeof ne=="string"&&a.push(ne)})});var o={},l=[],c=Jn.read(e.numbers,{type:"base64"});c.FileIndex.map(function(se,ne){return[se,c.FullPaths[ne]]}).forEach(function(se){var ne=se[0],q=se[1];if(ne.type==2&&ne.name.match(/\.iwa/)){var le=ne.content,Ie=io(le),Fe=ro(Ie);Fe.forEach(function(he){l.push(he.id),o[he.id]={deps:[],location:q,type:R0(he.messages[0].meta[1][0].data)}})}}),l.sort(function(se,ne){return se-ne});var h=l.filter(function(se){return se>1}).map(function(se){return[se,Wn(se)]});c.FileIndex.map(function(se,ne){return[se,c.FullPaths[ne]]}).forEach(function(se){var ne=se[0];if(se[1],!!ne.name.match(/\.iwa/)){var q=ro(io(ne.content));q.forEach(function(le){le.messages.forEach(function(Ie){h.forEach(function(Fe){le.messages.some(function(he){return R0(he.meta[1][0].data)!=11006&&lSe(he.data,Fe[1])})&&o[Fe[0]].deps.push(le.id)})})})}});for(var g=Jn.find(c,o[1].location),m=ro(io(g.content)),y,v=0;v<m.length;++v){var x=m[v];x.id==1&&(y=x)}var w=Qc(di(y.messages[0].data)[1][0].data);for(g=Jn.find(c,o[w].location),m=ro(io(g.content)),v=0;v<m.length;++v)x=m[v],x.id==w&&(y=x);for(w=Qc(di(y.messages[0].data)[2][0].data),g=Jn.find(c,o[w].location),m=ro(io(g.content)),v=0;v<m.length;++v)x=m[v],x.id==w&&(y=x);for(w=Qc(di(y.messages[0].data)[2][0].data),g=Jn.find(c,o[w].location),m=ro(io(g.content)),v=0;v<m.length;++v)x=m[v],x.id==w&&(y=x);var T=di(y.messages[0].data);{T[6][0].data=Wn(r.e.r+1),T[7][0].data=Wn(r.e.c+1);var b=Qc(T[46][0].data),A=Jn.find(c,o[b].location),M=ro(io(A.content));{for(var O=0;O<M.length&&M[O].id!=b;++O);if(M[O].id!=b)throw"Bad ColumnRowUIDMapArchive";var z=di(M[O].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var I=0;I<=r.e.c;++I){var R=[];R[1]=R[2]=[{type:0,data:Wn(I+420690)}],z[1].push({type:2,data:Di(R)}),z[2].push({type:0,data:Wn(I)}),z[3].push({type:0,data:Wn(I)})}z[4]=[],z[5]=[],z[6]=[];for(var P=0;P<=r.e.r;++P)R=[],R[1]=R[2]=[{type:0,data:Wn(P+726270)}],z[4].push({type:2,data:Di(R)}),z[5].push({type:0,data:Wn(P)}),z[6].push({type:0,data:Wn(P)});M[O].messages[0].data=Di(z)}A.content=jf(Ff(M)),A.size=A.content.length,delete T[46];var F=di(T[4][0].data);{F[7][0].data=Wn(r.e.r+1);var N=di(F[1][0].data),B=Qc(N[2][0].data);A=Jn.find(c,o[B].location),M=ro(io(A.content));{if(M[0].id!=B)throw"Bad HeaderStorageBucket";var j=di(M[0].messages[0].data);for(P=0;P<s.length;++P){var ve=di(j[2][0].data);ve[1][0].data=Wn(P),ve[4][0].data=Wn(s[P].length),j[2][P]={type:j[2][0].type,data:Di(ve)}}M[0].messages[0].data=Di(j)}A.content=jf(Ff(M)),A.size=A.content.length;var ke=Qc(F[2][0].data);A=Jn.find(c,o[ke].location),M=ro(io(A.content));{if(M[0].id!=ke)throw"Bad HeaderStorageBucket";for(j=di(M[0].messages[0].data),I=0;I<=r.e.c;++I)ve=di(j[2][0].data),ve[1][0].data=Wn(I),ve[4][0].data=Wn(r.e.r+1),j[2][I]={type:j[2][0].type,data:Di(ve)};M[0].messages[0].data=Di(j)}A.content=jf(Ff(M)),A.size=A.content.length;var Ve=Qc(F[4][0].data);(function(){for(var se=Jn.find(c,o[Ve].location),ne=ro(io(se.content)),q,le=0;le<ne.length;++le){var Ie=ne[le];Ie.id==Ve&&(q=Ie)}var Fe=di(q.messages[0].data);{Fe[3]=[];var he=[];a.forEach(function(Rt,Dt){he[1]=[{type:0,data:Wn(Dt)}],he[2]=[{type:0,data:Wn(1)}],he[3]=[{type:2,data:oSe(Rt)}],Fe[3].push({type:2,data:Di(he)})})}q.messages[0].data=Di(Fe);var Pe=Ff(ne),Be=jf(Pe);se.content=Be,se.size=se.content.length})();var Me=di(F[3][0].data);{var ue=Me[1][0];delete Me[2];var Ae=di(ue.data);{var be=Qc(Ae[2][0].data);(function(){for(var se=Jn.find(c,o[be].location),ne=ro(io(se.content)),q,le=0;le<ne.length;++le){var Ie=ne[le];Ie.id==be&&(q=Ie)}var Fe=di(q.messages[0].data);{delete Fe[6],delete Me[7];var he=new Uint8Array(Fe[5][0].data);Fe[5]=[];for(var Pe=0,Be=0;Be<=r.e.r;++Be){var Rt=di(he);Pe+=hSe(Rt,s[Be],a),Rt[1][0].data=Wn(Be),Fe[5].push({data:Di(Rt),type:2})}Fe[1]=[{type:0,data:Wn(r.e.c+1)}],Fe[2]=[{type:0,data:Wn(r.e.r+1)}],Fe[3]=[{type:0,data:Wn(Pe)}],Fe[4]=[{type:0,data:Wn(r.e.r+1)}]}q.messages[0].data=Di(Fe);var Dt=Ff(ne),Nt=jf(Dt);se.content=Nt,se.size=se.content.length})()}ue.data=Di(Ae)}F[3][0].data=Di(Me)}T[4][0].data=Di(F)}y.messages[0].data=Di(T);var re=Ff(m),V=jf(re);return g.content=V,g.size=g.content.length,c}function fSe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Sk(n){fSe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function gSe(n,e){return e.bookType=="ods"?XG(n,e):e.bookType=="numbers"?dSe(n,e):e.bookType=="xlsb"?mSe(n,e):pSe(n,e)}function mSe(n,e){u0=1024,n&&!n.SSF&&(n.SSF=Ks(Vr)),n&&n.SSF&&(kE(),CE(n.SSF),e.revssf=PE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,dp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=kG.indexOf(e.bookType)>-1,i=sG();Sk(e=e||{});var s=ok(),a="",o=0;if(e.cellXfs=[],Yu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",an(s,a,cG(n.Props,e)),i.coreprops.push(a),Hn(e.rels,2,a,In.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,an(s,a,hG(n.Props)),i.extprops.push(a),Hn(e.rels,3,a,In.EXT_PROPS),n.Custprops!==n.Props&&Hi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",an(s,a,dG(n.Custprops)),i.custprops.push(a),Hn(e.rels,4,a,In.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,an(s,a,x2e(o-1,a,e,n,h)),i.sheets.push(a),Hn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,In.WS[0])}if(g){var y=g["!comments"],v=!1,x="";y&&y.length>0&&(x="xl/comments"+o+"."+t,an(s,x,w2e(y,x)),i.comments.push(x),Hn(h,-1,"../comments"+o+"."+t,In.CMNT),v=!0),g["!legacy"]&&v&&an(s,"xl/drawings/vmlDrawing"+o+".vml",IG(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&an(s,oG(a),b0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,an(s,a,v2e(e.Strings,a,e)),i.strs.push(a),Hn(e.wbrels,-1,"sharedStrings."+t,In.SST)),a="xl/workbook."+t,an(s,a,y2e(n,a)),i.workbooks.push(a),Hn(e.rels,1,a,In.WB),a="xl/theme/theme1.xml",an(s,a,AG(n.Themes,e)),i.themes.push(a),Hn(e.wbrels,-1,"theme/theme1.xml",In.THEME),a="xl/styles."+t,an(s,a,_2e(n,a,e)),i.styles.push(a),Hn(e.wbrels,-1,"styles."+t,In.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",an(s,a,n.vbaraw),i.vba.push(a),Hn(e.wbrels,-1,"vbaProject.bin",In.VBA)),a="xl/metadata."+t,an(s,a,E2e(a)),i.metadata.push(a),Hn(e.wbrels,-1,"metadata."+t,In.XLMETA),an(s,"[Content_Types].xml",aG(i,e)),an(s,"_rels/.rels",b0(e.rels)),an(s,"xl/_rels/workbook."+t+".rels",b0(e.wbrels)),delete e.revssf,delete e.ssf,s}function pSe(n,e){u0=1024,n&&!n.SSF&&(n.SSF=Ks(Vr)),n&&n.SSF&&(kE(),CE(n.SSF),e.revssf=PE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,dp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=kG.indexOf(e.bookType)>-1,i=sG();Sk(e=e||{});var s=ok(),a="",o=0;if(e.cellXfs=[],Yu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",an(s,a,cG(n.Props,e)),i.coreprops.push(a),Hn(e.rels,2,a,In.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,an(s,a,hG(n.Props)),i.extprops.push(a),Hn(e.rels,3,a,In.EXT_PROPS),n.Custprops!==n.Props&&Hi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",an(s,a,dG(n.Custprops)),i.custprops.push(a),Hn(e.rels,4,a,In.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var g={"!id":{}},m=n.Sheets[n.SheetNames[o-1]],y=(m||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,an(s,a,VG(o-1,e,n,g)),i.sheets.push(a),Hn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,In.WS[0])}if(m){var v=m["!comments"],x=!1,w="";if(v&&v.length>0){var T=!1;v.forEach(function(b){b[1].forEach(function(A){A.T==!0&&(T=!0)})}),T&&(w="xl/threadedComments/threadedComment"+o+"."+t,an(s,w,K_e(v,h,e)),i.threadedcomments.push(w),Hn(g,-1,"../threadedComments/threadedComment"+o+"."+t,In.TCMNT)),w="xl/comments"+o+"."+t,an(s,w,CG(v)),i.comments.push(w),Hn(g,-1,"../comments"+o+"."+t,In.CMNT),x=!0}m["!legacy"]&&x&&an(s,"xl/drawings/vmlDrawing"+o+".vml",IG(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&an(s,oG(a),b0(g))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,an(s,a,vG(e.Strings,e)),i.strs.push(a),Hn(e.wbrels,-1,"sharedStrings."+t,In.SST)),a="xl/workbook."+t,an(s,a,zG(n)),i.workbooks.push(a),Hn(e.rels,1,a,In.WB),a="xl/theme/theme1.xml",an(s,a,AG(n.Themes,e)),i.themes.push(a),Hn(e.wbrels,-1,"theme/theme1.xml",In.THEME),a="xl/styles."+t,an(s,a,TG(n,e)),i.styles.push(a),Hn(e.wbrels,-1,"styles."+t,In.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",an(s,a,n.vbaraw),i.vba.push(a),Hn(e.wbrels,-1,"vbaProject.bin",In.VBA)),a="xl/metadata."+t,an(s,a,RG()),i.metadata.push(a),Hn(e.wbrels,-1,"metadata."+t,In.XLMETA),h.length>1&&(a="xl/persons/person.xml",an(s,a,X_e(h)),i.people.push(a),Hn(e.wbrels,-1,"persons/person.xml",In.PEOPLE)),an(s,"[Content_Types].xml",aG(i,e)),an(s,"_rels/.rels",b0(e.rels)),an(s,"xl/_rels/workbook."+t+".rels",b0(e.wbrels)),delete e.revssf,delete e.ssf,s}function ySe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=hc(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function qG(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return ty(e.file,Jn.write(n,{type:Ln?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Jn.write(n,e)}function xSe(n,e){var t=Ks(e||{}),r=gSe(n,t);return _Se(r,t)}function _Se(n,e){var t={},r=Ln?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?Jn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(IE(i))}return e.password&&typeof encrypt_agile<"u"?qG(encrypt_agile(i,e.password),e):e.type==="file"?ty(e.file,i):e.type=="string"?lp(i):i}function vSe(n,e){var t=e||{},r=D2e(n,t);return qG(r,t)}function Ho(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return r1(s1(r));case"binary":return s1(r);case"string":return n;case"file":return ty(e.file,r,"utf8");case"buffer":return Ln?wc(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ho(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function wSe(n,e){switch(e.type){case"base64":return r1(n);case"binary":return n;case"string":return n;case"file":return ty(e.file,n,"binary");case"buffer":return Ln?wc(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Xx(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?r1(t):e.type=="string"?lp(t):t;case"file":return ty(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function YG(n,e){q1e(),a2e(n);var t=Ks(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=YG(n,t);return t.type="array",IE(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ho(L2e(n,t),t);case"slk":case"sylk":return Ho(r_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Ho(WG(n.Sheets[n.SheetNames[i]],t),t);case"txt":return wSe(ZG(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Ho(Tk(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Ho(i_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return Xx(n_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Ho(s_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Ho(d_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Ho(_G.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Ho(XG(n,t),t);case"wk1":return Xx(K5.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return Xx(K5.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Xx($G(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),vSe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xSe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function ESe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function SSe(n,e,t){var r={};return r.type="file",r.file=e,ESe(r),YG(n,r)}function TSe(n,e,t,r,i,s,a,o){var l=Wi(t),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),g=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var v=a?n[t][y]:n[r[y]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[y]!=null&&(m[s[y]]=c);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[y]!=null){if(x==null)if(v.t=="e"&&x===null)m[s[y]]=null;else if(c!==void 0)m[s[y]]=c;else if(h&&x===null)m[s[y]]=null;else continue;else m[s[y]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:dc(v,x,o);x!=null&&(g=!1)}}return{row:m,isempty:g}}function cw(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof h){case"string":l=yr(h);break;case"number":l=yr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var g=Wi(l.s.r),m=[],y=[],v=0,x=0,w=Array.isArray(n),T=l.s.r,b=0,A={};w&&!n[T]&&(n[T]=[]);var M=c.skipHidden&&n["!cols"]||[],O=c.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(M[b]||{}).hidden)switch(m[b]=fs(b),t=w?n[T][b]:n[m[b]+g],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=m[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=dc(t,null,c),x=A[a]||0,!x)A[a]=1;else{do o=a+"_"+x++;while(A[o]);A[a]=x,A[o]=1}s[b]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(O[T]||{}).hidden){var z=TSe(n,l,T,m,r,s,w,c);(z.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(y[v++]=z.row)}return y.length=v,y}var tD=/"/g;function bSe(n,e,t,r,i,s,a,o){for(var l=!0,c=[],h="",g=Wi(t),m=e.s.c;m<=e.e.c;++m)if(r[m]){var y=o.dense?(n[t]||[])[m]:n[r[m]+g];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:dc(y,null,o));for(var v=0,x=0;v!==h.length;++v)if((x=h.charCodeAt(v))===i||x===s||x===34||o.forceQuotes){h='"'+h.replace(tD,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(tD,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function Tk(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=yr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),h="",g=[];r.dense=Array.isArray(n);for(var m=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(m[v]||{}).hidden||(g[v]=fs(v));for(var x=0,w=i.s.r;w<=i.e.r;++w)(y[w]||{}).hidden||(h=bSe(n,i,w,g,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(c,"")),(h||r.blankrows!==!1)&&t.push((x++?o:"")+h)));return delete r.dense,t.join("")}function ZG(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Tk(n,e);return t}function ASe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=yr(n["!ref"]),s="",a=[],o,l=[],c=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=fs(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Wi(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=c?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function QG(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Ci(r.origin):r.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var g=yr(s["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),a==-1&&(a=g.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var m=r.header||[],y=0;e.forEach(function(x,w){Hi(x).forEach(function(T){(y=m.indexOf(T))==-1&&(m[y=m.length]=T);var b=x[T],A="z",M="",O=Qn({c:o+y,r:a+w+i});c=l1(s,O),b&&typeof b=="object"&&!(b instanceof Date)?s[O]=b:(typeof b=="number"?A="n":typeof b=="boolean"?A="b":typeof b=="string"?A="s":b instanceof Date?(A="d",r.cellDates||(A="n",b=Hs(b)),M=r.dateNF||Vr[14]):b===null&&r.nullError&&(A="e",b=0),c?(c.t=A,c.v=b,delete c.w,delete c.R,M&&(c.z=M)):s[O]=c={t:A,v:b},M&&(c.z=M))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var v=Wi(a);if(i)for(y=0;y<m.length;++y)s[fs(y+o)+v]={t:"s",v:m[y]};return s["!ref"]=si(h),s}function RSe(n,e){return QG(null,n,e)}function l1(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=Ci(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?l1(n,Qn(e)):l1(n,Qn({r:e,c:t||0}))}function ISe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function CSe(){return{SheetNames:[],Sheets:{}}}function kSe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(GG(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function PSe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=ISe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function MSe(n,e){return n.z=e,n}function JG(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function NSe(n,e,t){return JG(n,"#"+e,t)}function LSe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function OSe(n,e,t,r){for(var i=typeof e!="string"?e:yr(e),s=typeof e=="string"?e:si(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=l1(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var BT={encode_col:fs,encode_row:Wi,encode_cell:Qn,encode_range:si,decode_col:fk,decode_row:dk,split_cell:qye,decode_cell:Ci,decode_range:ya,format_cell:dc,sheet_add_aoa:JB,sheet_add_json:QG,sheet_add_dom:HG,aoa_to_sheet:xg,json_to_sheet:RSe,table_to_sheet:KG,table_to_book:iSe,sheet_to_csv:Tk,sheet_to_txt:ZG,sheet_to_json:cw,sheet_to_html:WG,sheet_to_formulae:ASe,sheet_to_row_object_array:cw,sheet_get_cell:l1,book_new:CSe,book_append_sheet:kSe,book_set_sheet_visibility:PSe,cell_set_number_format:MSe,cell_set_hyperlink:JG,cell_set_internal_link:NSe,cell_add_comment:LSe,sheet_set_array_formula:OSe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const cl=bs()(xc((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(c=>{const h=new Date(c.timestamp).toLocaleDateString("nl-NL"),g=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${h},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${g},${c.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=BT.json_to_sheet(r),s=BT.book_new();BT.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,SSe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),DSe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 47 - 270 n.Chr.",beschrijving:'Romeins castellum op de plek van het huidige Utrecht. De naam betekent "oversteekplaats" - hier stak de belangrijke noord-zuidroute de Rijn over via een brug of veerpont. Klein fort voor enkele honderden soldaten. De Domkerk staat deels op Romeinse fundamenten. Onder het Domplein zijn bij opgravingen resten gevonden. Bij de brug werden ritueel munten geofferd aan de rivier. Later groeide Traiectum uit tot de middeleeuwse bisschopsstad Utrecht. Vondsten: Centraal Museum Utrecht.',watWasHier:"Klein castellum dat de rivieroversteek bewaakte. Brug of veerpont over de Rijn. Belangrijke noord-zuidroute.",watTeZien:"Domkerk staat op Romeinse fundamenten. Centraal Museum toont vondsten. Onder Domplein zijn resten gevonden.",verwachteVondsten:"Munten (veel geofferd bij de brug), sieraden, aardewerk, bouwmateriaal, bronzen voorwerpen.",betekenis:"Belangrijk knooppunt waar landweg de rivier kruiste. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in Valkenburg (Zuid-Holland), vernoemd naar keizerin Agrippina, moeder van Nero. Een van de best onderzochte forten aan de Nederlandse Limes door uitgebreide opgravingen sinds 1941. Het fort werd minstens 6 keer herbouwd na overstromingen en branden. Garnizoen van hulptroepen (auxilia), geen legionairs. Werkplaatsen, opslagruimtes en een haven aan de Rijn. Inscripties gevonden die eenheden noemen. Veel informatie over dagelijks soldatenleven. Te bezoeken: Archeologisch Steunpunt Valkenburg.",watWasHier:"Middelgroot castellum met hulptroepen. Minstens 6x herbouwd. Werkplaatsen, opslag en haven.",watTeZien:"Archeologisch Steunpunt Valkenburg. Delen opgegraven en beschermd.",verwachteVondsten:"Militaire uitrusting, importaardewerk uit Rijnland en Galli, munten, inscripties, bouwmateriaal.",betekenis:"Best onderzochte fort aan de Rijn. Veel informatie over dagelijks soldatenleven.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 19 v.Chr. - 70 n.Chr.",beschrijving:"Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare, een van de grootste ten noorden van de Alpen. Hier waren tijdelijk twee complete legioenen gestationeerd (Legio X Gemina en anderen): circa 10.000 soldaten. Uitvalsbasis voor veldtochten naar Germani onder Augustus en Tiberius. De wallen zijn nog zichtbaar in het landschap. Vondsten van hoge kwaliteit: legioensinsignes, wapens, munten van Augustus. Later vervangen door het permanente castellum op de Hunerberg. Museum Het Valkhof toont de rijke vondsten.",watWasHier:"Reusachtig legerkamp voor 2 legioenen (10.000 soldaten). Uitvalsbasis voor Germaanse oorlogen.",watTeZien:"Wallen zichtbaar in landschap op Hunnerberg. Museum Het Valkhof met vele vondsten.",verwachteVondsten:"Hoogwaardige militaria, legioenstempels, munten van Augustus/Tiberius, wapens, helmen.",betekenis:"Belangrijkste vroeg-Romeinse legerbasis in Nederland. Startpunt Germaanse veldtochten.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum Batavorum",latinNaam:"Lugdunum Batavorum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Katwijk aan de Noordzeekust - het westelijkste fort van de gehele Limes. Hier mondde de Rijn uit in zee. Het fort bewaakte de riviermonding en was startpunt voor zeereizen naar Britannia. Er stond ook een vuurtoren (pharos). Helaas is het fort door kustafslag in zee verdwenen. Na stormen spoelen soms vondsten aan op het strand van Katwijk. Munten, aardewerk en militaria. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De Brittenburg, lang zichtbaar bij laag water, was waarschijnlijk deel van dit complex.",watWasHier:"Castellum bij Rijnmonding met vuurtoren. Startpunt zeereizen naar Britannia.",watTeZien:"Fort verdwenen in zee. Rijksmuseum van Oudheden Leiden toont vondsten.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria op strand Katwijk.",betekenis:"Westelijk eindpunt Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-batavorum-katwijk/"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Alphen aan den Rijn aan de Oude Rijn. De moderne stadsnaam is afgeleid van Albaniana. Middelgroot fort voor hulptroepen dat de rivierroute bewaakte. Bij opgravingen in de binnenstad zijn resten van het fort en de vicus gevonden. Archeon, het archeologische themapark, ligt in de buurt en geeft een beeld van het Romeinse leven. Vondsten: militaria, aardewerk (terra sigillata), munten, fibulae. De natte bodem heeft organisch materiaal bewaard.",watWasHier:"Middelgroot castellum met hulptroepen. Vicus buiten de muren.",watTeZien:"Resten onder binnenstad. Archeon nabij.",verwachteVondsten:"Militaria, terra sigillata, munten, fibulae. Organisch materiaal door natte bodem.",betekenis:"Oorsprong stadsnaam Alphen. Onderdeel fortenketen Oude Rijn.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg aan de Oude Rijn. Garnizoen van hulptroepen (auxilia). Het fort had de standaard rechthoekige plattegrond met poorten aan vier zijden. Buiten de muren lag een vicus met handelaren, ambachtslieden en soldatenfamilies. Bij opgravingen zijn grafvelden gevonden met crematies en bijgiften. De locatie Roomburg ("Romeinse burcht") verwijst naar de Romeinse oorsprong. Rijksmuseum van Oudheden in Leiden toont vondsten. Matilo is onderdeel van de UNESCO Werelderfgoed Limes.',watWasHier:"Standaard castellum met vicus en grafvelden. Hulptroepen gestationeerd.",watTeZien:"Locatie Roomburg. Rijksmuseum van Oudheden Leiden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Plaatsnaam Roomburg verwijst naar fort.",bronnen:[]},Corbulo:{naam:"Corbulo",latinNaam:"Fossa Corbulonis",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Voorburg, nabij het Kanaal van Corbulo (Fossa Corbulonis). Dit kanaal verbond de Rijn met de Maas en werd rond 47 n.Chr. gegraven door generaal Corbulo om troepen sneller te kunnen verplaatsen. Het fort bewaakte dit strategische kanaal. In de buurt lag ook Forum Hadriani, de enige Romeinse stad in Nederland met stadsrechten. Vondsten wijzen op zowel militaire als civiele activiteit. Museon in Den Haag toont de geschiedenis. Het kanaal is nog steeds traceerbaar in het landschap als de Vliet.",watWasHier:"Fort bij Kanaal van Corbulo. Nabij Forum Hadriani (Romeinse stad).",watTeZien:"Kanaal traceerbaar als Vliet. Museon Den Haag.",verwachteVondsten:"Militaria, civiel aardewerk, munten, bouwmateriaal van stad.",betekenis:"Bewaakte strategisch kanaal. Nabij enige Romeinse stad in Nederland.",bronnen:[]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Tongeren-Sacramentstraat",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp in Tongeren (Belgi), de oudste stad van Belgi. Later omgebouwd tot boerderij. Tongeren (Atuatuca Tungrorum) was de civitas-hoofdstad van de Tungri. Het kamp dateert uit de veroveringsperiode. Julius Caesar noemt Atuatuca als winterkamp. Na pacificatie werd de militaire functie niet meer nodig en ontstond een civiele stad. Tongeren heeft een uitstekend Gallo-Romeins Museum met vondsten van vele opgravingen in de stad.",watWasHier:"Vroeg legerkamp, later boerderij. Oudste stad Belgi.",watTeZien:"Gallo-Romeins Museum Tongeren met vele vondsten.",verwachteVondsten:"Vroege militaria, later civiel materiaal, bouwresten.",betekenis:"Oorsprong van Tongeren als oudste Belgische stad.",bronnen:["https://www.galloromeinsmuseum.be"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Kastell Aachen",latinNaam:"Aquae Granni",type:"versterking",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeinse versterking in Aken (Duits: Aachen), bekend om de hete bronnen (Aquae Granni). De Romeinen waarderen de thermale bronnen voor bad- en geneeskundige doeleinden. In de late keizertijd werd een fort gebouwd voor verdediging tegen Germaanse invallen. Karel de Grote koos later deze locatie voor zijn paleis vanwege de historische betekenis en de bronnen. De Dom van Aken staat deels op Romeinse fundamenten. Centre Charlemagne toont de geschiedenis.",watWasHier:"Laat-Romeins fort bij thermale bronnen. Later Karolingisch paleis.",watTeZien:"Dom van Aken op Romeinse fundamenten. Centre Charlemagne.",verwachteVondsten:"Laat-Romeinse munten, militaria, badhuisresten.",betekenis:"Continuteit van Romeinse tijd tot Karel de Grote.",bronnen:[]}},FSe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},jSe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function VSe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function BSe(n){try{const e=Tn(n),t=bn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const h=typeof c=="number"?c:parseFloat(c);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const GSe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},zSe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function nD(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function USe(){const n=Hr(dt=>dt.map),e=cl(dt=>dt.removeVondst),t=cl(dt=>dt.updateVondst),r=cl(dt=>dt.vondsten),{layers:i,addPoint:s,addLayer:a}=hs(),[o,l]=X.useState([]),[c,h]=X.useState(0),[g,m]=X.useState(!1),[y,v]=X.useState(null),[x,w]=X.useState(!1),[T,b]=X.useState(!1),[A,M]=X.useState(null),[O,z]=X.useState(null),[I,R]=X.useState(null),[P,F]=X.useState(null),[N,B]=X.useState(!1),[j,ve]=X.useState(null),[ke,Ve]=X.useState(null),[Me,ue]=X.useState(null),[Ae,be]=X.useState(!1),[re,V]=X.useState(""),[se,ne]=X.useState([]),q=se[c]||null,[le,Ie]=X.useState(()=>{const dt=localStorage.getItem("popupTextScale");return dt?parseInt(dt):100}),Fe=dt=>{Ie(dt),localStorage.setItem("popupTextScale",dt.toString())},he=o[c]||"",Pe=o.length>1,Be=dt=>{const fn=dt.match(/<strong[^>]*>(.*?)<\/strong>/);if(fn){const ur=fn[1].replace(/<[^>]+>/g,""),vt=dt.replace(fn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:ur,contentWithoutTitle:vt}}return{title:"",contentWithoutTitle:dt}},Rt=dt=>dt.replace(/class="([^"]*)"/g,(ur,vt)=>{if(vt.includes("text-xs")){const Zt=vt.replace(/\btext-xs\b/g,"").trim();return Zt?`style="font-size:0.857em" class="${Zt}"`:'style="font-size:0.857em"'}if(vt.includes("text-sm")){const Zt=vt.replace(/\btext-sm\b/g,"").trim();return Zt?`class="${Zt}"`:""}return ur}).replace(/class=""/g,""),{title:Dt,contentWithoutTitle:Nt}=Be(he),ln=Rt(Nt),rn=he.includes("Landbouwperceel"),ut=he.includes("data-vondst-id="),tr=()=>{h(dt=>(dt-1+o.length)%o.length)},dn=()=>{h(dt=>(dt+1)%o.length)},cn=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||T){console.log(" STOP - map:",!!n,"coord:",y,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),b(!0);try{await H1e(n,y)&&w(!0)}catch(dt){console.error("Failed to load height map:",dt)}finally{b(!1)}},nr=()=>{n&&(jA(n),w(!1))};X.useEffect(()=>{if(!n)return;const dt=vt=>{let Zt='<strong class="text-purple-800">AMK Monument</strong>';if(vt.toponiem&&(Zt+=`<br/><span class="text-sm font-semibold">${vt.toponiem}</span>`),vt.kwaliteitswaarde&&(Zt+=`<br/><span class="text-sm text-purple-700">${vt.kwaliteitswaarde}</span>`),vt.omschrijving&&(Zt+=`<br/><span class="text-xs text-gray-600 mt-1 block">${vt.omschrijving}</span>`),vt.txt_label){const Gt=vt.txt_label.split(", ").slice(0,3).join(", ");Zt+=`<br/><span class="text-xs text-gray-500 italic">${Gt}${vt.txt_label.split(", ").length>3?"...":""}</span>`}return Zt},fn=async(vt,Zt)=>{const Gt=[],Xr=n.getLayers().getArray().filter(xr=>xr instanceof Eh&&xr.getVisible()?xr.getSource()instanceof MX:!1);for(const xr of Xr){const Ki=xr.getSource();if(!Ki)continue;const Qt=xr.get("title")||"";if(Qt.startsWith("Paleokaart"))continue;if(Qt==="Archeo Landschappen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,Q=Y.landschapsnaam||Y.naam||"Archeologisch Landschap",fe=Y.omschrijving||"";let ce=`<strong class="text-green-800">${Q}</strong>`;fe&&(ce+=`<br/><span class="text-sm text-gray-600">${fe}</span>`),ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Gt.push(ce)}}catch(je){console.warn("Archeo Landschappen WMS query failed:",je)}continue}if(Qt==="Essen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(Y.naam||Y.Naam||Y.NAME)&&(Q+=`<br/><span class="text-sm font-semibold text-amber-700">${Y.naam||Y.Naam||Y.NAME}</span>`),(Y.type||Y.Type||Y.TYPE)&&(Q+=`<br/><span class="text-xs text-gray-600">${Y.type||Y.Type||Y.TYPE}</span>`),(Y.omschrijving||Y.Omschrijving)&&(Q+=`<br/><span class="text-xs text-gray-500">${Y.omschrijving||Y.Omschrijving}</span>`),Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',Q+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Q+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',Q+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Q+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Gt.push(Q)}}catch(je){console.warn("Essen WMS query failed:",je)}continue}if(Qt==="FAMKE Steentijd"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';Q+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart voor oude vondsten</span>';const fe=Y.advies||Y.Advies||"";if(fe){Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',Q+=`<div class="text-sm text-amber-700 mt-1">${fe}</div>`;const ce=fe.toLowerCase();let $e="",De="text-gray-600",ze="";ce.includes("karterend")?($e="Op deze plek verwachten archeologen vondsten uit de steentijd of bronstijd. Bij graafwerk moet er eerst onderzoek komen.",ze="Goede kans op oude vondsten (vuursteen, bijlen, aardewerk)",De="text-amber-600"):ce.includes("waarderend")?($e="Hier zijn mogelijk belangrijke vindplaatsen. Proefsleuven zijn nodig om te kijken wat er precies zit.",ze="Mogelijk interessante vondsten uit de prehistorie",De="text-orange-600"):ce.includes("geen")?($e="De kans op prehistorische vondsten is hier klein. De grond is waarschijnlijk te jong of te veel verstoord.",ze="Weinig kans op steentijd-vondsten",De="text-green-600"):ce.includes("quickscan")&&($e="Hier is eerst bureau-onderzoek nodig. Er kunnen vondsten zitten, maar dat is nog niet zeker.",ze="Onbekend, nader onderzoek nodig",De="text-blue-600"),$e&&(Q+=`<div class="text-sm ${De} mt-1">${$e}</div>`),ze&&(Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Q+=`<div class="text-sm text-gray-700 mt-1">${ze}</div>`),Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',Q+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>'}Gt.push(Q)}}catch(je){console.warn("FAMKE WMS query failed:",je)}continue}if(Qt==="Archeo Onderzoeken"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}&FEATURE_COUNT=20`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0)for(const Y of W.features){const Q=Y.properties;let fe='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';const ce=Q.type_onderzoek||"";ce&&(fe+=`<br/><span class="text-sm font-semibold text-blue-700">${ce}</span>`);const $e=Q.projectnaam||Q.project_naam||Q.naam||"";if($e&&(fe+=`<br/><span class="text-sm text-gray-800">${$e}</span>`),Q.onderzoeksmeldingnummer&&(fe+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${Q.onderzoeksmeldingnummer}</span>`),Q.uitvoerder&&(fe+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${Q.uitvoerder}</span>`),Q.startdatum||Q.einddatum){const ze=[Q.startdatum,Q.einddatum].filter(Boolean).join(" - ");fe+=`<br/><span class="text-xs text-gray-600">Periode: ${ze}</span>`}Q.gemeente&&(fe+=`<br/><span class="text-xs text-gray-500">${Q.gemeente}</span>`);const De=[];if(Q.periode_paleolithicum&&De.push("Paleolithicum"),Q.periode_mesolithicum&&De.push("Mesolithicum"),Q.periode_neolithicum&&De.push("Neolithicum"),Q.periode_bronstijd&&De.push("Bronstijd"),Q.periode_ijzertijd&&De.push("IJzertijd"),Q.periode_romeins&&De.push("Romeins"),Q.periode_middeleeuwen&&De.push("Middeleeuwen"),Q.periode_nieuwe_tijd&&De.push("Nieuwe tijd"),De.length>0&&(fe+=`<br/><span class="text-sm text-purple-700">Datering: ${De.join(", ")}</span>`),fe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ce.toLowerCase().includes("opgraving")?fe+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':ce.toLowerCase().includes("bureauonderzoek")?fe+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':ce.toLowerCase().includes("booronderzoek")?fe+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':ce.toLowerCase().includes("proefsleuven")?fe+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':ce.toLowerCase().includes("begeleiding")?fe+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':ce.toLowerCase().includes("inventariserend")?fe+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':fe+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',fe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',fe+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',fe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>',Q.onderzoeksmeldingnummer){const ze=Q.onderzoeksmeldingnummer;fe+=`<div class="text-sm text-gray-700 mt-1"><a href="https://easy.dans.knaw.nl/ui/datasets?q=${encodeURIComponent(ze)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek rapport in DANS-EASY</a></div>`,fe+='<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in ARCHIS</a></div>'}fe+='<div class="text-sm text-gray-700 mt-1"><a href="https://bibliotheek.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bibliotheek voor Archeologie</a></div>',Gt.push(fe)}}catch(je){console.warn("Archeo Onderzoeken WMS query failed:",je)}continue}if(Qt==="IKAW"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=500,L=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,Q=Math.round(Y.PALETTE_INDEX||Y.palette_index||0),fe=zSe[Q]||`Trefkans onbekend (${Q})`;let ce='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';ce+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ce+=`<div class="text-sm text-orange-700 mt-1">${fe}</div>`;const De={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[Q];De&&(ce+=`<div class="text-sm ${De.kleur} mt-1">${De.tekst}</div>`,ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce+=`<div class="text-sm text-gray-700 mt-1">${De.vondsten}</div>`),ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Gt.push(ce)}}catch(je){console.warn("IKAW WMS query failed:",je)}continue}if(Qt==="Inundatiegebieden"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-blue-800">Inundatiegebied</strong>';(Y["linie-naam"]||Y.linie_naam)&&(Q+=`<br/><span class="text-sm font-semibold text-blue-700">${Y["linie-naam"]||Y.linie_naam}</span>`),Y.naam&&(Q+=`<br/><span class="text-sm text-gray-700">${Y.naam}</span>`),Y.periode&&(Q+=`<br/><span class="text-xs text-gray-500">${Y.periode}</span>`),Y.lin_period&&(Q+=`<br/><span class="text-xs text-gray-400">${Y.lin_period}</span>`),Gt.push(Q)}}catch(je){console.warn("Inundatiegebieden WMS query failed:",je)}continue}if(Qt==="Militaire Objecten"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=50,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,Q=Y.obj_soort||"",fe=Y.obj_naam||"",ce=Y.lin_period||"",$e=Y["linie-naam"]||Y.linie_naam||"";let De=Q||"Militair Object",ze="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",it="";const xt=Q.toLowerCase();xt.includes("fort")?(ze="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",it="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):xt.includes("schans")?(ze="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",it="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):xt.includes("batterij")||xt.includes("battery")?(ze="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",it="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):xt.includes("bunker")||xt.includes("kazemat")?(ze="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",it="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):xt.includes("sluis")||xt.includes("inlaatwerk")?(ze="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",it="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):xt.includes("toren")||xt.includes("wachttoren")?(ze="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",it="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):xt.includes("kazerne")&&(ze="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",it="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let At=`<strong class="text-stone-800">${De}</strong>`;fe&&(At+=`<br/><span class="text-sm font-semibold text-stone-700">${fe}</span>`),$e&&(At+=`<br/><span class="text-sm text-blue-600">${$e}</span>`),ce&&(At+=`<br/><span class="text-xs text-gray-500">${ce}</span>`),At+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',At+=`<div class="text-sm text-gray-700 mt-1">${ze}</div>`,it&&(At+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',At+=`<div class="text-sm text-gray-700 mt-1">${it}</div>`),At+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',At+='<div class="text-sm text-gray-700 mt-1">',At+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',At+="</div>",Gt.push(At)}}catch(je){console.warn("Militaire Objecten WMS query failed:",je)}continue}if(Qt==="Verdedigingslinies"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-amber-800">Verdedigingslinie</strong>';const fe={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},ce=Y.naam||Y.lin_naam||"";if(ce){Q+=`<br/><span class="text-sm font-semibold text-amber-700">${ce}</span>`;const $e=Object.entries(fe).find(([De])=>ce.toLowerCase().includes(De.toLowerCase())||De.toLowerCase().includes(ce.toLowerCase()));$e&&(Q+=`<br/><span class="text-sm text-gray-700">${$e[1]}</span>`)}Y.lin_period&&(Q+=`<br/><span class="text-xs text-purple-600">${Y.lin_period}</span>`),Y.status&&(Q+=`<br/><span class="text-xs text-gray-400">${Y.status}</span>`),Gt.push(Q)}}catch(je){console.warn("Verdedigingslinies WMS query failed:",je)}continue}if(Qt==="Rijksmonumenten"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=50,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-red-800">Rijksmonument</strong>';(Y.cbsNaam||Y.cbs_naam)&&(Q+=`<br/><span class="text-sm font-semibold">${Y.cbsNaam||Y.cbs_naam}</span>`),Y.hoofdcategorie&&(Q+=`<br/><span class="text-sm text-red-700">${Y.hoofdcategorie}</span>`),Y.subcategorie&&(Q+=`<br/><span class="text-xs text-gray-600">${Y.subcategorie}</span>`),Y.rijksmonumentnummer&&(Q+=`<br/><span class="text-xs text-gray-500">Nr: ${Y.rijksmonumentnummer}</span>`),(Y.bouwjaar||Y.oorspronkelijkebouwjaar)&&(Q+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Y.bouwjaar||Y.oorspronkelijkebouwjaar}</span>`),Q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Y.rijksmonumentnummer&&(Q+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${Y.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),Q+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Gt.push(Q)}}catch(je){console.warn("Rijksmonumenten WMS query failed:",je)}continue}if(Qt==="Werelderfgoed"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=500,L=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(Y.siteName||Y.naam)&&(Q+=`<br/><span class="text-sm font-semibold text-cyan-700">${Y.siteName||Y.naam}</span>`),Y.siteDesignation&&(Q+=`<br/><span class="text-xs text-gray-600">${Y.siteDesignation}</span>`),Gt.push(Q)}}catch(je){console.warn("Werelderfgoed WMS query failed:",je)}continue}if(Qt==="Terpen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,Q=Y.naam||Y.NAAM||Y.Naam||"Terp",fe=Y.plaats||Y.PLAATS||Y.Plaats||"";let ce=`<strong class="text-orange-800">${Q}</strong>`;fe&&(ce+=`<br/><span class="text-sm text-gray-500">${fe}</span>`),ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Een terp is een kunstmatige heuvel. Mensen bouwden deze heuvels om droog te wonen in het vlakke, natte land. Terpen zijn vaak meer dan 2000 jaar oud.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Op en rond terpen worden vaak vondsten gedaan:</div>',ce+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',ce+="<li>Middeleeuws aardewerk en botten</li>",ce+="<li>Munten uit verschillende periodes</li>",ce+="<li>Metalen voorwerpen (gespen, fibulae, sieraden)</li>",ce+="<li>Soms Romeinse of zelfs prehistorische vondsten</li>",ce+="</ul>",ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waarom zijn terpen interessant?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Terpen waren vaak dorpskernen waar mensen eeuwenlang woonden. Door de ophoging bleven veel voorwerpen goed bewaard. Let op: sommige terpen zijn beschermd monument!</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Veel terpen zijn nog zichtbaar in het landschap. Vraag altijd toestemming aan de grondeigenaar voordat je gaat detecteren.</div>',Gt.push(ce)}}catch(je){console.warn("Terpen WMS query failed:",je)}continue}if(Qt==="Religieus Erfgoed"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=50,L=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,Q=Y.naam||Y.NAAM||Y.name||Y.NAME||"Onbekend",fe=Y.denominatie||Y.DENOMINATIE||Y.religie||"",ce=Y.type||Y.TYPE||Y.functie||"",$e=Y.bouwjaar||Y.BOUWJAAR||Y.jaar||"",De=Y.gemeente||Y.GEMEENTE||Y.plaats||"";let ze=`<strong class="text-purple-800">${Q}</strong>`;const it=ce.toLowerCase();let xt="Een religieus gebouw of heilige plek.",At="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";it.includes("kerk")||it.includes("church")?(xt="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",At="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):it.includes("kapel")||it.includes("chapel")?(xt="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",At="Devotionalia, munten, kruisjes, rozenkransen"):it.includes("synagoge")?(xt="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",At="Munten, knopen, kleine religieuze voorwerpen"):it.includes("klooster")||it.includes("monastery")?(xt="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",At="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):it.includes("toren")||it.includes("tower")?(xt="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",At="Munten, knopen, bouwmateriaal"):(it.includes("begraafplaats")||it.includes("cemetery"))&&(xt="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",At="Detecteren hier niet toegestaan"),fe&&(ze+=`<br/><span class="text-sm text-purple-600">${fe}</span>`),ce&&(ze+=`<br/><span class="text-sm text-gray-600">${ce}</span>`),$e&&(ze+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${$e}</span>`),De&&(ze+=`<br/><span class="text-xs text-gray-400">${De}</span>`),ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ze+=`<div class="text-sm text-gray-700 mt-1">${xt}</div>`,ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ze+=`<div class="text-sm text-gray-700 mt-1">${At}</div>`,ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',it.includes("begraafplaats")?ze+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':ze+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Gt.push(ze)}}catch(je){console.warn("Religieus Erfgoed WMS query failed:",je)}continue}if(Qt==="Gewaspercelen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=50,zt=`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`,L=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${zt}`,kt=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${zt}`,[W,Y]=await Promise.all([fetch(L),fetch(kt).catch(()=>null)]),Q=await W.json();if(Q.features&&Q.features.length>0){const fe=Q.features[0].properties;let ce='<strong class="text-green-800">Landbouwperceel</strong>';if((fe.gewas||fe.gewasnaam)&&(ce+=`<br/><span class="text-sm font-semibold text-green-700">${fe.gewas||fe.gewasnaam}</span>`),(fe.categorie||fe.category)&&(ce+=`<br/><span class="text-xs text-gray-600">${fe.categorie||fe.category}</span>`),fe.oppervlakte&&(ce+=`<br/><span class="text-xs text-gray-500">${fe.oppervlakte} ha</span>`),Y)try{const $e=await Y.json();if($e.features&&$e.features.length>0){const De=$e.features[0].properties,ze=De.first_soilname||De.soilname||De.bodemtype,it=De.first_soilcode||De.soilcode||De.maparea_soilcode;if(ze){ce+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${ze}</span>`;const xt=nD(ze,it);xt.length>0&&(ce+=`<br/><span class="text-xs text-gray-500 italic">${xt.join("  ")}</span>`)}}}catch{}Gt.push(ce)}}catch(je){console.warn("BRP Gewaspercelen WMS query failed:",je)}continue}if(Qt==="Kadastrale Grenzen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=20,L=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,Q=Y.kadastraleGemeenteWaarde||Y.kadastrale_gemeente_waarde||Y.kadastraleGemeente||GSe[String(Y.kadastraleGemeenteCode)]||Y.kadastraleGemeenteCode,fe=Y.sectie||Y.Sectie||"",ce=Y.perceelnummer||Y.perceelNummer||Y.Perceelnummer||"",$e=Y.kadastraleGrootteWaarde||Y.kadastrale_grootte_waarde||Y.kadastraleGrootte||Y.oppervlakte,De=Y.AKRKadastraleGemeenteCodeWaarde||Y.akrKadastraleGemeenteCodeWaarde||"",ze=[Q,fe,ce].filter(Boolean).join(" "),it=De&&fe&&ce?`${De}-${fe}-${ce}`:"";let xt='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(ze&&(xt+=`<br/><span class="text-sm text-indigo-700">${ze}</span>`),it&&(xt+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${it}</span>`),$e){const At=typeof $e=="number"?$e:parseFloat($e);isNaN(At)||(xt+=`<br/><span class="text-xs text-gray-600">${At.toLocaleString("nl-NL")} m</span>`)}xt+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Gt.push(xt)}}catch(je){console.warn("Kadastrale Grenzen WMS query failed:",je)}continue}if(Qt==="Scheepswrakken"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-cyan-800">Scheepswrak</strong>';(Y.naam||Y.NAAM)&&(Q+=`<br/><span class="text-sm font-semibold text-cyan-700">${Y.naam||Y.NAAM}</span>`),(Y.type||Y.TYPE)&&(Q+=`<br/><span class="text-sm text-gray-700">${Y.type||Y.TYPE}</span>`),(Y.datering||Y.DATERING)&&(Q+=`<br/><span class="text-xs text-gray-500">Datering: ${Y.datering||Y.DATERING}</span>`),(Y.bron||Y.BRON)&&(Q+=`<br/><span class="text-xs text-gray-400">${Y.bron||Y.BRON}</span>`),Gt.push(Q)}}catch(je){console.warn("Scheepswrakken WMS query failed:",je)}continue}if(Qt==="Woonheuvels ZH"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-orange-800">Woonheuvel</strong>';(Y.naam||Y.NAAM)&&(Q+=`<br/><span class="text-sm font-semibold text-orange-700">${Y.naam||Y.NAAM}</span>`),(Y.type||Y.TYPE)&&(Q+=`<br/><span class="text-sm text-gray-700">${Y.type||Y.TYPE}</span>`),Gt.push(Q)}}catch(je){console.warn("Woonheuvels WMS query failed:",je)}continue}if(Qt==="Romeinse Forten"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-red-800">Romeins Fort</strong>';(Y.naam||Y.NAAM)&&(Q+=`<br/><span class="text-sm font-semibold text-red-700">${Y.naam||Y.NAAM}</span>`),(Y.type||Y.TYPE)&&(Q+=`<br/><span class="text-sm text-gray-700">${Y.type||Y.TYPE}</span>`),(Y.periode||Y.PERIODE)&&(Q+=`<br/><span class="text-xs text-gray-500">${Y.periode||Y.PERIODE}</span>`),Gt.push(Q)}}catch(je){console.warn("Romeinse Forten WMS query failed:",je)}continue}if(Qt==="Windmolens"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=50,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-amber-800">Windmolen</strong>';(Y.naam||Y.NAAM)&&(Q+=`<br/><span class="text-sm font-semibold text-amber-700">${Y.naam||Y.NAAM}</span>`),(Y.type||Y.TYPE||Y.functie||Y.FUNCTIE)&&(Q+=`<br/><span class="text-sm text-gray-700">${Y.type||Y.TYPE||Y.functie||Y.FUNCTIE}</span>`),(Y.bouwjaar||Y.BOUWJAAR)&&(Q+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Y.bouwjaar||Y.BOUWJAAR}</span>`),Gt.push(Q)}}catch(je){console.warn("Windmolens WMS query failed:",je)}continue}if(Qt==="Erfgoedlijnen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-purple-800">Erfgoedlijn</strong>';(Y.naam||Y.NAAM||Y.erfgoedlijn)&&(Q+=`<br/><span class="text-sm font-semibold text-purple-700">${Y.naam||Y.NAAM||Y.erfgoedlijn}</span>`),(Y.type||Y.TYPE)&&(Q+=`<br/><span class="text-sm text-gray-700">${Y.type||Y.TYPE}</span>`),(Y.omschrijving||Y.OMSCHRIJVING)&&(Q+=`<br/><span class="text-xs text-gray-500">${Y.omschrijving||Y.OMSCHRIJVING}</span>`),Gt.push(Q)}}catch(je){console.warn("Erfgoedlijnen WMS query failed:",je)}continue}if(Qt==="Oude Kernen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-stone-800">Historische Kern</strong>';(Y.naam||Y.NAAM)&&(Q+=`<br/><span class="text-sm font-semibold text-stone-700">${Y.naam||Y.NAAM}</span>`),(Y.type||Y.TYPE)&&(Q+=`<br/><span class="text-sm text-gray-700">${Y.type||Y.TYPE}</span>`),(Y.periode||Y.PERIODE)&&(Q+=`<br/><span class="text-xs text-gray-500">${Y.periode||Y.PERIODE}</span>`),Gt.push(Q)}}catch(je){console.warn("Oude Kernen WMS query failed:",je)}continue}if(Qt==="Relictenkaart Punten"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,Q={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},fe=Y.type?.replace(/[0-9]/g,"")||"",ce=Q[fe]||Y.type||"Cultuurhistorisch object";let $e='<strong class="text-emerald-800">Relict</strong>';$e+=`<br/><span class="text-sm font-semibold text-emerald-700">${ce}</span>`,Y.type&&fe!==Y.type&&($e+=`<br/><span class="text-xs text-gray-500">Code: ${Y.type}</span>`),Y.streek&&($e+=`<br/><span class="text-xs text-gray-400">Streek: ${Y.streek}</span>`),Gt.push($e)}}catch(je){console.warn("Relictenkaart Punten WMS query failed:",je)}continue}if(Qt==="Relictenkaart Lijnen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,fe={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[Y.klasse]||`Historisch lijnrelict (${Y.klasse})`;let ce='<strong class="text-teal-800">Lijnrelict</strong>';ce+=`<br/><span class="text-sm font-semibold text-teal-700">${fe}</span>`,Gt.push(ce)}}catch(je){console.warn("Relictenkaart Lijnen WMS query failed:",je)}continue}if(Qt==="Relictenkaart Vlakken"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=100,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties,fe={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[Y.klasse]||`Historisch landschap (${Y.klasse})`;let ce='<strong class="text-lime-800">Landschapsrelict</strong>';if(ce+=`<br/><span class="text-sm font-semibold text-lime-700">${fe}</span>`,Y.st_area_shape_){const $e=(Y.st_area_shape_/1e4).toFixed(1);ce+=`<br/><span class="text-xs text-gray-500">${$e} ha</span>`}Gt.push(ce)}}catch(je){console.warn("Relictenkaart Vlakken WMS query failed:",je)}continue}if(Qt==="Verdronken Dorpen"){try{const je=Tn(vt),xe=bn("EPSG:4326","EPSG:28992",je),ye=200,L=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-ye},${xe[1]-ye},${xe[0]+ye},${xe[1]+ye}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const Y=W.features[0].properties;let Q='<strong class="text-blue-800">Verdronken Dorp</strong>';(Y.naam||Y.NAAM)&&(Q+=`<br/><span class="text-sm font-semibold text-blue-700">${Y.naam||Y.NAAM}</span>`),(Y.verdronken||Y.VERDRONKEN||Y.jaar||Y.JAAR)&&(Q+=`<br/><span class="text-xs text-gray-600">Verdronken: ${Y.verdronken||Y.VERDRONKEN||Y.jaar||Y.JAAR}</span>`),(Y.gemeente||Y.GEMEENTE)&&(Q+=`<br/><span class="text-xs text-gray-500">${Y.gemeente||Y.GEMEENTE}</span>`),(Y.bron||Y.BRON)&&(Q+=`<br/><span class="text-xs text-gray-400">${Y.bron||Y.BRON}</span>`),Gt.push(Q)}}catch(je){console.warn("Verdronken Dorpen WMS query failed:",je)}continue}const xi=Ki.getFeatureInfoUrl(vt,Zt,"EPSG:3857",{INFO_FORMAT:"application/json"});if(xi)try{const xe=await(await fetch(xi)).json();if(xe.features&&xe.features.length>0){const ye=xe.features[0].properties;if(Qt==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const Y=ye.value_list??ye.GRAY_INDEX??ye.value??ye.gray_index??ye.dtm_05m??ye.DTM_05M??ye.hoogte??ye.HOOGTE??ye.elevation??ye.ELEVATION;if(Y!=null&&!isNaN(Number(Y))){const Q=typeof Y=="number"?Y.toFixed(2):Number(Y).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${Q} m NAP</span>`,Gt.push(W)}else{let Q=!1;const fe=["geometry","id","fid","gml_id","bbox"];for(const[ce,$e]of Object.entries(ye))!fe.includes(ce.toLowerCase())&&$e!==null&&$e!==""&&(W+=`<br/><span class="text-xs text-gray-600">${ce}: ${$e}</span>`,Q=!0);Q&&Gt.push(W)}continue}if(Qt==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',Y=!1;const Q=ye.landform_subgroup_description,fe=ye.relief_klasse,ce=ye.relief_subklasse,$e=ye.genese_description,De=ye.active_process;if(Q&&(W+=`<br/><span class="text-sm text-green-700">${Q}</span>`,Y=!0),fe){const ze=ce&&ce!==fe?`${fe} (${ce})`:fe;W+=`<br/><span class="text-xs text-gray-600">Relief: ${ze}</span>`,Y=!0}if($e&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${$e}</span>`,Y=!0),De&&De!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${De}</span>`,Y=!0),!Y){const ze=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[it,xt]of Object.entries(ye))!ze.includes(it.toLowerCase())&&xt!==null&&xt!==""&&!it.includes("validfrom")&&!it.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${it}: ${xt}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Gt.push(W);continue}let zt=`<strong>${Qt}</strong>`;const L=ye.first_soilname||ye.soilname,kt=ye.soilcode||ye.first_soilcode;if(L&&(zt+=`<br/><span class="text-sm text-amber-700">${L}</span>`,Qt==="Bodemkaart")){const W=nD(L,kt);W.length>0&&(zt+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(ye.soilslope&&ye.soilslope!=="Niet opgenomen"&&(zt+=`<br/><span class="text-xs text-gray-500">Helling: ${ye.soilslope}</span>`),!L){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[Y,Q]of Object.entries(ye))!W.includes(Y)&&Q&&Q!=="Niet opgenomen"&&(zt+=`<br/><span class="text-xs text-gray-600">${Y}: ${Q}</span>`)}Gt.push(zt)}}catch(je){console.warn("WMS GetFeatureInfo failed:",je)}}return Gt},ur=async vt=>{const Zt=[],Gt=[],Xr=xe=>{if(!xe)return;const ye=xe.getType(),L=xe.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:ye,coordinates:L}},xr=BSe(vt.coordinate),Ki=[];n.forEachFeatureAtPixel(vt.pixel,xe=>{Ki.push(xe)});for(const xe of Ki){const ye=xe.getProperties(),{geometry:zt,...L}=ye;if(L.vondst){const Q=L.vondst,fe=`<strong>${Q.objectType}</strong>
            <div data-vondst-id="${Q.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${Q.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${Q.period}</span>
            ${Q.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${Q.depth} cm</span>`:""}
            ${Q.condition&&Q.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${Q.condition}</span>`:""}
            ${Q.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${Q.weight} gram</span>`:""}
            ${Q.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${Q.notes}</span>`:""}
            ${Q.photoUrl?`<br/><a href="${Q.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(Q.timestamp).toLocaleDateString("nl-NL")}</span>`;Zt.push(fe),Gt.push(null),M(Q.id);continue}if(L.layerType==="customPoint"&&L.customPoint){const Q=L.customPoint,fe=L.customLayerName||"Mijn Laag",ce=L.customLayerColor||"#f97316";let $e="";if(Q.popupContent?($e=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${ce}"></span>
              <span class="text-xs font-medium" style="color: ${ce}">${fe}</span>
            </div>`,$e+=Q.popupContent):($e=`<strong>${Q.name}</strong>`,$e+=`<br/><span class="text-xs text-gray-500">${fe}</span>`,Q.category&&Q.category!=="Overig"&&($e+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${Q.category}</span>`)),Q.photos&&Q.photos.length>0){$e+='<div class="flex flex-wrap gap-1 my-2">';for(const De of Q.photos.slice(0,3)){const ze=De.thumbnailUrl||De.thumbnailBase64;ze&&($e+=`<img src="${ze}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}Q.photos.length>3&&($e+=`<span class="text-xs text-gray-400 self-end">+${Q.photos.length-3} meer</span>`),$e+="</div>"}Q.notes&&!Q.popupContent&&($e+=`<br/><span class="text-sm text-gray-600 mt-1">${Q.notes}</span>`),Q.url&&($e+=`<br/><a href="${Q.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),$e+=`<br/><span class="text-xs text-gray-400">${new Date(Q.createdAt).toLocaleDateString("nl-NL")}</span>`,Zt.push($e),Gt.push(null);continue}if(L.layerType==="importedLayer"){const Q=L.layerName||"Gemporteerde laag",fe=L.layerColor||"#8b5cf6",ce=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],$e=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.description||"Feature";let De=`<strong style="color: ${fe}">${$e}</strong>`;De+=`<br/><span class="text-xs text-gray-500">${Q}</span>`;const ze=Object.entries(L).filter(([it])=>!ce.includes(it)&&it!=="name"&&it!=="Name");if(ze.length>0){De+='<div class="mt-2 space-y-1">';for(const[it,xt]of ze)if(xt!=null&&xt!==""){const At=it.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,or=>or.toUpperCase());let Lt=String(xt);Lt.length>200&&(Lt=Lt.substring(0,200)+"..."),Lt.startsWith("http://")||Lt.startsWith("https://")?De+=`<div class="text-sm"><span class="text-gray-500">${At}:</span> <a href="${Lt}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:De+=`<div class="text-sm"><span class="text-gray-500">${At}:</span> <span class="text-gray-700">${Lt}</span></div>`}De+="</div>"}Zt.push(De),Gt.push({geometry:Xr(zt),properties:L,popupHtml:De});continue}if(L.kwaliteitswaarde&&L.kwaliteitswaarde.includes("archeologische waarde")){const Q=dt(L);Zt.push(Q),Gt.push({geometry:Xr(zt),properties:L,popupHtml:Q});continue}if(L.layerType==="romeinsFort"||L.layerType==="romeinsFortLijn"){const Q=L.Name||L.name||"";L.description;const fe=DSe[Q]||null,ce=fe||FSe;let $e=`<strong class="text-red-800">${fe?ce.naam:Q||"Romeins Fort"}</strong>`;if($e+=`<br/><span class="text-sm text-red-700">${jSe[ce.type]||ce.type}</span>`,$e+=`<br/><span class="text-sm text-gray-500">${ce.periode}</span>`,L.layerType==="romeinsFortLijn"&&($e+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),$e+=`<br/><span class="text-xs text-gray-600 mt-1 block">${ce.beschrijving}</span>`,fe?.bronnen&&fe.bronnen.length>0){const De=fe.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];$e+=`<br/><a href="${fe.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${De}</a>`}Zt.push($e),Gt.push({geometry:Xr(zt),properties:L,popupHtml:$e});continue}let kt=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.route_name||L.road_name;kt||(L.leisure==="playground"?kt="Speeltuin":L.leisure==="park"?kt="Park":L.leisure==="swimming_area"||L.sport==="swimming"?kt="Zwemplek":L.tourism==="museum"?kt="Museum":L.amenity==="cafe"||L.amenity==="restaurant"?kt=L.amenity==="cafe"?"Caf":"Restaurant":L.historic==="castle"?kt="Kasteel":kt="Info"),(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats")))&&(kt="Bunker"),L.historic==="battlefield"&&(kt="Historisch slagveld");let W=`<strong>${kt}</strong>`;if(L.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${L.category}</span>`),L.from_to&&L.from_to!==kt&&(W+=`<br/><span class="text-sm text-gray-600">${L.from_to}</span>`),L.route&&L.route!==kt&&(W+=`<br/><span class="text-sm text-gray-600">${L.route}</span>`),L.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${L.TOPONIEM}</span>`,L.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${L.PLAATS}</span>`)),(L.AARD_VINDP||L.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${L.AARD_VINDP||L.Aard_vindp}</span>`),L.BEGIN_PER&&L.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.BEGIN_PER} - ${L.EIND_PER}</span>`),(L.AARD_OPM||L.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${L.AARD_OPM||L.Aard_opmer}</span>`),L.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${L.Gemeente}</span>`),L.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${L.Bron}</span>`),L.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${L.Bron_besch}</span>`),L.Dat_st_z&&L.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${L.Dat_st_z} - ${L.Dat_ei_z}</span>`),L.Begin&&L.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.Begin} - ${L.Einde}</span>`),L.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${L.Uiterwaard}</span>`),L.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${L.rivier}</span>`),L.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${L.Beschrijvi}</span>`),L.leisure&&L.name){const Q=L.leisure==="playground"?"Speeltuin":L.leisure==="park"?"Park":L.leisure==="swimming_area"?"Zwemplek":null;Q&&(W+=`<br/><span class="text-sm text-green-700">${Q}</span>`)}if((L.tourism==="museum"||L.museum)&&L.name&&(W+='<br/><span class="text-sm text-purple-700">Museum</span>'),(L.leisure==="swimming_area"||L.sport==="swimming")&&L.name&&(W+='<br/><span class="text-sm text-cyan-700">Zwemplek</span>'),L.osm_id&&L.address!==void 0&&(W+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',L.address&&(W+=`<br/><span class="text-xs text-gray-500">${L.address}</span>`),L.phone&&(W+=`<br/><span class="text-xs text-gray-600">${L.phone}</span>`)),L.site_type==="tumulus"){const Q=xe.getGeometry()?.getCoordinates();let fe="",ce="";if(Q){const $e=Tn(Q),De=$e[0],ze=$e[1];De>5.5&&De<6.3&&ze>52&&ze<52.5?(fe="Veluwe",ce="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):De>6.2&&De<7.1&&ze>52.6&&ze<53.3?(fe="Drenthe",ce="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):De>4.5&&De<6&&ze>51.3&&ze<51.9?(fe="Noord-Brabant",ce="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):De>5.5&&De<6.3&&ze>50.7&&ze<51.6?(fe="Limburg",ce="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):De>5&&De<5.6&&ze>52&&ze<52.4&&(fe="Utrechtse Heuvelrug",ce="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',fe&&(W+=`<br/><span class="text-sm text-gray-500">${fe}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',ce&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ce}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',L.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${L.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(L.historic==="castle"||L.castle_type){const Q={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},fe=L.castle_type?Q[L.castle_type]:null,ce=fe?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-700">${ce}</span>`,L.start_date&&(W+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${L.start_date}</span>`),L.heritage&&(W+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',fe?W+=`<div class="text-sm text-gray-700 mt-1">${fe.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',fe?W+=`<div class="text-sm text-gray-700 mt-1">${fe.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',L.wikipedia||L.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',L.wikipedia){const $e=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}L.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(L.historic==="ruins"){const Q=L.ruins_type||"";let fe="Rune",ce="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",$e="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(Q.toLowerCase().includes("church")||Q.toLowerCase().includes("kerk")?(fe="Kerkrune",ce="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",$e="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):Q.toLowerCase().includes("castle")||Q.toLowerCase().includes("kasteel")?(fe="Kasteelrune",ce="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",$e="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):Q.toLowerCase().includes("mill")||Q.toLowerCase().includes("molen")?(fe="Molenrune",ce="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",$e="Gereedschap, munten, huishoudelijke voorwerpen"):Q.toLowerCase().includes("fort")&&(fe="Fortrune",ce="De overblijfselen van een militair fort of verdedigingswerk.",$e="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-amber-700">${fe}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ce}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,L.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.wikipedia){const De=L.wikipedia.startsWith("http")?L.wikipedia:`https://${L.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${L.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${De}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats"))){const Q={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},fe=L.name||"",ce=L.bunker_type?Q[L.bunker_type]||L.bunker_type:"";fe&&fe!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${fe}</span>`),ce&&ce!==fe&&(W+=`<br/><span class="text-xs text-gray-500">${ce}</span>`);const $e=xe.getGeometry()?.getCoordinates();let De="",ze="",it="";if($e){const xt=Tn($e),At=xt[0],Lt=xt[1],or=At<4.8||At<5.2&&Lt>51.8&&Lt<53.5,br=At>4.2&&At<4.4&&Lt>52&&Lt<52.15,Xi=At>4.5&&At<4.7&&Lt>52.4&&Lt<52.5,U=At>4&&At<4.2&&Lt>51.95&&Lt<52.05,J=At<4.2&&Lt<51.6,K=At>5.2&&At<5.8&&Lt>51.9&&Lt<52.3;br?(De="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",ze="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",it="Atlantikwall Museum Scheveningen"):Xi?(De="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",ze="https://www.bunkermuseum.nl/",it="Bunkermuseum IJmuiden"):U?(De="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",ze="https://www.atlantikwallhoekvanholland.nl/",it="Atlantikwall Hoek van Holland"):J?(De="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",ze="https://www.bunkermuseumzoutelande.nl/",it="Bunkermuseum Zoutelande"):or?(De="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",ze="https://nl.wikipedia.org/wiki/Atlantikwall",it="Atlantikwall (Wikipedia)"):K?(De="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",ze="https://nl.wikipedia.org/wiki/Grebbelinie",it="Grebbelinie (Wikipedia)"):(De="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",ze="https://nl.wikipedia.org/wiki/Atlantikwall",it="WOII bunkers (Wikipedia)")}else De="Een bunker uit de Tweede Wereldoorlog.",ze="https://nl.wikipedia.org/wiki/Atlantikwall",it="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${De}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${ze}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${it}</a>`,L.website?W+=`<br/><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(L.historic==="battlefield"){const Q=L.name||"Onbekend slagveld",ce={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[Q];if(Q!=="Onbekend slagveld"&&Q!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${Q}</span>`),ce)W+=`<br/><span class="text-xs text-gray-500">${ce.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ce.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ce.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ce.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${ce.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,Q.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),Q.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(L.date&&(W+=`<br/><span class="text-xs text-gray-500">${L.date}</span>`),L.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),L.wikipedia){const $e=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bron==="Paleobiology Database"){const Q=De=>{const ze={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[it,xt]of Object.entries(ze))if(De.toLowerCase().includes(it.toLowerCase()))return xt;return""},fe=De=>{const ze={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[it,xt]of Object.entries(ze))if(De.toLowerCase().includes(it.toLowerCase()))return xt;return""},ce=De=>{const ze={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let it=De;for(const[xt,At]of Object.entries(ze))it=it.replace(new RegExp(xt,"gi"),At);return it},$e=De=>{const ze={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let it=De;for(const[xt,At]of Object.entries(ze))it=it.replace(new RegExp(xt,"gi"),At);return it};if(L.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${L.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',L.taxonomie&&L.taxonomie!=="Onbekend"){const De=Q(L.taxonomie);De?(W+=`<div class="text-sm text-gray-700 mt-1">${De}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${L.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${L.taxonomie}</div>`}if(L.aantal_fossielen){const De=parseInt(L.aantal_fossielen),ze=De>100?"Veel fossielen gevonden op deze locatie.":De>10?"Meerdere fossielen gevonden op deze locatie.":`${L.aantal_fossielen} fossiel${De>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${ze}</div>`}if(L.periode&&L.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const De=fe(L.periode);W+=`<div class="text-sm text-gray-700 mt-1">${L.periode}</div>`,De&&(W+=`<div class="text-sm text-gray-600">${De}</div>`),L.ouderdom&&L.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${L.ouderdom}</div>`)}(L.gesteente||L.formatie||L.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',L.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${ce(L.gesteente)}</div>`),L.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${L.formatie}</div>`,L.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${L.lid}</div>`)),L.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${$e(L.milieu)}</div>`))}if(L.layerType==="fossielHotspot"){const Q=[];if(L.type&&Q.push(L.type),L.region&&Q.push(L.region),L.country){const fe={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Q.push(fe[L.country]||L.country)}if(Q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),(L.finds||L.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${L.period}</div>`),L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const ce=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${ce} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="mineralenHotspot"){const Q=[];if(L.region&&Q.push(L.region),L.country){const fe={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Q.push(fe[L.country]||L.country)}if(Q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),L.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.minerals}</div>`,L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const ce=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")||L.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${ce} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="goudrivier"){const Q=[];if(L.river&&Q.push(L.river),L.region&&Q.push(L.region),L.country){const fe={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Q.push(fe[L.country]||L.country)}if(Q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),(L.goldType||L.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.goldType}</div>`),L.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${L.origin}</div>`)),L.legal||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',L.legal){const ce=L.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${ce} mt-1">${L.legal}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="wandelroute"){const Q=[];if(L.region&&Q.push(L.region),L.country){const fe={NL:"Nederland",BE:"Belgi"};Q.push(fe[L.country]||L.country)}if(Q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),L.distance||L.duration){const fe=L.distance?`${L.distance} km`:"",ce=L.duration?`${L.duration}`:"",$e=[fe,ce].filter(Boolean).join("  ");$e&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${$e}</span>`)}(L.description||L.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${L.highlights}</div>`)),L.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.startAddress}</div>`),L.url&&(W+=`<div class="mt-3"><a href="${L.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(L.layerType==="hunebed"){L.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`);const Q=[];if(L.stones){const fe=L.stones.toLowerCase(),ce=fe.match(/(\d+)\s*dekst[^\s,]*/i),$e=fe.match(/(\d+)\s*draagst[^\s,]*/i),De=fe.match(/(\d+)\s*sluitst[^\s,]*/i),ze=fe.match(/(\d+)\s*poortst[^\s,]*/i),it=fe.match(/(\d+)\s*gangdekst[^\s,]*/i),xt=fe.match(/(\d+)\s*gangzijst[^\s,]*/i);ce&&Q.push(`${ce[1]} deksteen${parseInt(ce[1])>1?"en":""} (de grote steen${parseInt(ce[1])>1?"en":""} bovenop)`),$e&&Q.push(`${$e[1]} draagstenen (de stenen die de dekstenen dragen)`),De&&Q.push(`${De[1]} sluitsteen${parseInt(De[1])>1?"en":""} (afsluiting aan de korte zijden)`),ze&&Q.push(`${ze[1]} poortsteen${parseInt(ze[1])>1?"en":""} (bij de ingang)`),it&&Q.push(`${it[1]} gangdeksteen${parseInt(it[1])>1?"en":""} (boven de toegangsgang)`),xt&&Q.push(`${xt[1]} gangzijstenen (langs de toegangsgang)`)}if(L.length&&Q.push(`Een grafkamer van ${L.length} lang`),L.width&&Q.push(`${L.width}`),Q.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',Q.forEach(fe=>{W+=`<li>${fe}</li>`}),W+="</ul>"),L.notable){const fe=L.notable.toLowerCase();let ce="Wat is hier bijzonder?";fe.includes("grootste")?ce="Waarom is dit het grootste hunebed?":fe.includes("klein")||fe.includes("kindhunebed")?ce="Waarom is dit hunebed zo klein?":fe.includes("cluster")||fe.includes("naast elkaar")?ce="Waarom liggen hier meerdere hunebedden?":(fe.includes("enige")||fe.includes("westelijk")||fe.includes("noordelijk"))&&(ce="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${ce}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${L.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',L.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',L.access?W+=`<div class="text-sm text-gray-700 mt-1">${L.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',L.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${L.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((L.inventarisnummer||L.locatie_naam)&&(L.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${L.locatie_naam}</span>`),L.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${L.inventarisnummer}</span>`),L.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${L.datering_tekst}</span>`)),(L.veensoort||L.dikte)&&(L.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${L.veensoort}</span>`),L.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${L.dikte}</span>`)),L.nature&&L.debut){W+=`<br/><span class="text-sm text-purple-700">${L.nature}</span>`;const Q=L.debut===L.fin?L.debut:`${L.debut} - ${L.fin}`;Q&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${Q}</span>`),L.structure&&(W+=`<br/><span class="text-xs text-gray-600">${L.structure}</span>`),L.commune&&(W+=`<br/><span class="text-xs text-gray-500">${L.commune}</span>`),L.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${L.decouvert}</span>`),L.numero&&(W+=`<br/><span class="text-xs text-gray-400">${L.numero}</span>`)}if((L.NATURE_OPE||L.CODE_OPERA)&&(L.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${L.TITRE}</span>`),L.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${L.NATURE_OPE}</span>`),L.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${L.AUTEUR}</span>`),L.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.DATE}</span>`),L.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${L.COMMUNE}</span>`)),L.type_protection&&(L.n_site||L.t_site)){const Q=L.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${Q}">${L.type_protection}</span>`,L.n_site&&(W+=`<br/><span class="text-sm font-semibold">${L.n_site}</span>`),L.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${L.t_site}</span>`),L.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${L.c_site}</span>`),L.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${L.d_creation}</span>`)}if(L.type_protection&&L.cod_diren){const Q=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${Q}">${L.type_protection}</span>`,L.proced&&(W+=`<br/><span class="text-xs text-gray-600">${L.proced}</span>`),L.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.d_proced}</span>`),L.comment){const fe=String(L.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${fe}${String(L.comment).length>150?"...":""}</span>`}}if(L.type_protection&&L.nomsite){const Q=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${Q}">${L.type_protection}</span>`,L.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${L.caractere}</span>`),L.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.datedecis}</span>`),L.descriptio){const fe=String(L.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${fe}${String(L.descriptio).length>150?"...":""}</span>`}}if(L.secteur&&L.style){if(W+=`<br/><span class="text-sm text-gray-700">${L.secteur}</span>`,L["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${L["sous-secteur"]}</span>`),L.description){const Q=String(L.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${Q}${String(L.description).length>150?"...":""}</span>`}L.url&&(W+=`<br/><a href="${L.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(L.nature_operation||L.synthese){L.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${L.nature_operation}</span>`),L.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${L.responsable_operation}</span>`),L.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.date_operation}</span>`);const Q=[];if(L.prehistoire==="Oui"&&Q.push("Prehistorie"),L.protohistoire==="Oui"&&Q.push("Protohistorie"),L.antiquite==="Oui"&&Q.push("Romeins"),L.moyen_age==="Oui"&&Q.push("Middeleeuwen"),L.temps_modernes==="Oui"&&Q.push("Moderne tijd"),Q.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${Q.join(", ")}</span>`),L.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${L.adresse}</span>`),L.synthese){const fe=String(L.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${fe}${String(L.synthese).length>200?"...":""}</span>`}}if(L.operator&&(W+=`<br/><span class="text-sm text-gray-600">${L.operator}</span>`),L.opening_hours){const Q=VSe(String(L.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${Q}</span>`}if(L.website&&(W+=`<br/><a href="${L.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),L.addr_street){const Q=[L.addr_street,L.addr_housenumber,L.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${Q}</span>`}const Y=L.description||L.omschrijving||L.descr||L.info;Y&&Y!==kt&&(W+=`<br/><span class="text-sm text-gray-600">${Y}</span>`),Zt.push(W),Gt.push({geometry:Xr(zt),properties:L,popupHtml:W})}const Qt=n.getView().getResolution()||1,xi=await fn(vt.coordinate,Qt);Zt.push(...xi);for(const xe of xi)Gt.push(null);const je=await xr;if(Zt.length===0&&je!==null){const xe=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
          </div>`;Zt.push(xe),Gt.push(null)}if(Zt.length>0&&je!==null&&(Zt[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
        </div>`),Zt.length>0){l(Zt),ne(Gt),h(0),console.log(` KLIK OPGESLAGEN: [${vt.coordinate[0].toFixed(0)}, ${vt.coordinate[1].toFixed(0)}]`),v(vt.coordinate),w(!1),B(!1),be(!1),V(""),ve(null);const xe=Tn(vt.coordinate);Ve(xe),R(`https://www.google.com/maps/dir/?api=1&destination=${xe[1]},${xe[0]}`),F(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${xe[1]},${xe[0]}`),m(!0)}};return n.on("click",ur),()=>{n.un("click",ur)}},[n]);const li=()=>{m(!1),n&&x&&(jA(n),w(!1))},Fn=(dt,fn)=>{fn.offset.y>100&&li()};return f.jsx(kn,{children:g&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:li}),f.jsxs(yt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",style:{fontSize:`${14*le/100}px`},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:Fn,children:[f.jsx("div",{className:"flex justify-center pt-2 pb-1",children:f.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),f.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[Pe&&f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx("button",{onClick:tr,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:f.jsx(Fle,{size:18})}),f.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[c+1,"/",o.length]}),f.jsx("button",{onClick:dn,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:f.jsx(vE,{size:18})})]}),f.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Dt||"Info"}),ke&&f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>B(!N),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${j?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:j?f.jsx(uc,{size:18}):f.jsx(Ha,{size:18})}),N&&f.jsxs("div",{className:"absolute right-0 bottom-full mb-1 z-50 bg-white rounded-lg shadow-md py-1 min-w-[180px] max-w-[220px]",children:[f.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),f.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(dt=>!dt.archived).map(dt=>f.jsxs("button",{onClick:()=>{const fn=q;s(dt.id,{name:Dt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ke[0],ke[1]],sourceLayer:Dt,geometry:fn?.geometry,sourceProperties:fn?.properties,popupContent:fn?.popupHtml}),B(!1),ve(dt.name),setTimeout(()=>ve(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:dt.color}}),f.jsx("span",{className:"truncate",children:dt.name})]},dt.id))}),f.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Ae?f.jsxs("div",{className:"px-2 py-1",children:[f.jsx("input",{type:"text",value:re,onChange:dt=>V(dt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:dt=>{if(dt.key==="Enter"&&re.trim()){const fn=a(re.trim()),ur=q;s(fn,{name:Dt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ke[0],ke[1]],sourceLayer:Dt,geometry:ur?.geometry,sourceProperties:ur?.properties,popupContent:ur?.popupHtml}),B(!1),be(!1),V(""),ve(re.trim()),setTimeout(()=>ve(null),2e3)}else dt.key==="Escape"&&(be(!1),V(""))}}),f.jsxs("div",{className:"flex gap-1 mt-1",children:[f.jsx("button",{onClick:()=>{if(re.trim()){const dt=a(re.trim()),fn=q;s(dt,{name:Dt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ke[0],ke[1]],sourceLayer:Dt,geometry:fn?.geometry,sourceProperties:fn?.properties,popupContent:fn?.popupHtml}),B(!1),be(!1),V(""),ve(re.trim()),setTimeout(()=>ve(null),2e3)}},disabled:!re.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),f.jsx("button",{onClick:()=>{be(!1),V("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):f.jsxs("button",{onClick:()=>be(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx(Ha,{size:14}),f.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),P&&f.jsx("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:f.jsx(zce,{size:18})}),I&&f.jsx("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:f.jsx(H1,{size:18})}),f.jsx("button",{onClick:li,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:f.jsx(Kr,{size:18})})]}),f.jsx("div",{className:"px-4 py-3 max-h-[45vh] overflow-y-auto select-text",style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:ln}}),f.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2",children:[f.jsx(mV,{size:14,className:"text-gray-400 flex-shrink-0"}),f.jsx("input",{type:"range",min:"80",max:"150",value:le,onChange:dt=>Fe(parseInt(dt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),f.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[le,"%"]})]}),ut&&A&&!O&&f.jsxs("div",{className:"px-4 pb-4 flex gap-2",children:[f.jsxs("button",{onClick:()=>{const dt=r.find(fn=>fn.id===A);dt&&z(dt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(J0,{size:16}),f.jsx("span",{children:"Bewerken"})]}),f.jsxs("button",{onClick:()=>{e(A),m(!1),M(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(wl,{size:16}),f.jsx("span",{children:"Verwijderen"})]})]}),O&&f.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3",children:[f.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),f.jsx("input",{type:"text",value:O.objectType,onChange:dt=>z({...O,objectType:dt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),f.jsx("input",{type:"text",value:O.material,onChange:dt=>z({...O,material:dt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),f.jsx("input",{type:"text",value:O.period,onChange:dt=>z({...O,period:dt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),f.jsx("textarea",{value:O.notes,onChange:dt=>z({...O,notes:dt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>z(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),f.jsx("button",{onClick:()=>{t(O.id,{objectType:O.objectType,material:O.material,period:O.period,notes:O.notes}),z(null),m(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),rn&&y&&f.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:x?f.jsxs("button",{onClick:nr,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(Q0,{size:16}),f.jsx("span",{children:"Hoogtekaart verbergen"})]}):f.jsx("button",{onClick:cn,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?f.jsxs(f.Fragment,{children:[f.jsx(NC,{size:16,className:"animate-spin"}),f.jsx("span",{children:"Laden..."})]}):f.jsxs(f.Fragment,{children:[f.jsx(Q0,{size:16}),f.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const rD=1e-4;function $Se(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<rD&&i<rD})}function WSe(){const n=Hr(P=>P.map),e=Sr(P=>P.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=Sr(),s=hs(P=>P.layers),[a,o]=X.useState(null),[l,c]=X.useState(!1),[h,g]=X.useState(!1),[m,y]=X.useState(!1),v=X.useRef(null),x=X.useRef(null);X.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const P=n.getViewport();if(!P){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",P);const F=600,N=15,B=Ae=>{if(console.log(" Touch start, touches:",Ae.touches.length),Ae.touches.length!==1)return;const be=Ae.touches[0];x.current={x:be.clientX,y:be.clientY},console.log(" Starting long press timer at:",x.current),v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",x.current),!x.current)return;const re=window.__olMap;if(!re){console.log(" Map not available (global)");return}const V=P.getBoundingClientRect(),se=[x.current.x-V.left,x.current.y-V.top],ne=re.getCoordinateFromPixel(se);if(ne){const q=Tn(ne);Ae.preventDefault(),o({pixel:[x.current.x,x.current.y],coordinate:q}),c(!0),g(!1),setTimeout(()=>g(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",q)}},F)},j=Ae=>{if(!v.current||!x.current)return;const be=Ae.touches[0],re=be.clientX-x.current.x,V=be.clientY-x.current.y,se=Math.sqrt(re*re+V*V);se>N&&(console.log(" Touch moved too much, cancelling. Distance:",se),clearTimeout(v.current),v.current=null)},ve=()=>{console.log(" Touch end, timer active:",!!v.current),v.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(v.current),v.current=null),x.current=null},ke=Ae=>{l&&Ae.preventDefault()},Ve=Ae=>{Ae.button===0&&(console.log(" Mouse down"),x.current={x:Ae.clientX,y:Ae.clientY},v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!x.current)return;const be=window.__olMap;if(console.log(" __olMap:",be),console.log(" __olMap constructor:",be?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof be?.getCoordinateAtPixel),!be){console.log(" Map not available (global)");return}const re=P.getBoundingClientRect(),V=[x.current.x-re.left,x.current.y-re.top];console.log(" Pixel:",V);const se=be.getCoordinateFromPixel(V);if(console.log(" Coordinate:",se),se){const ne=Tn(se);o({pixel:[x.current.x,x.current.y],coordinate:ne}),c(!0),g(!1),setTimeout(()=>g(!0),300),console.log(" Long press (mouse) detected at:",ne)}},F))},Me=Ae=>{if(!v.current||!x.current)return;const be=Ae.clientX-x.current.x,re=Ae.clientY-x.current.y;Math.sqrt(be*be+re*re)>N&&(console.log(" Mouse moved, cancelling"),clearTimeout(v.current),v.current=null)},ue=()=>{console.log(" Mouse up"),v.current&&(clearTimeout(v.current),v.current=null),x.current=null};return P.addEventListener("touchstart",B,{passive:!1}),P.addEventListener("touchmove",j,{passive:!0}),P.addEventListener("touchend",ve),P.addEventListener("touchcancel",ve),P.addEventListener("contextmenu",ke),P.addEventListener("mousedown",Ve),P.addEventListener("mousemove",Me),P.addEventListener("mouseup",ue),P.addEventListener("mouseleave",ue),()=>{P.removeEventListener("touchstart",B),P.removeEventListener("touchmove",j),P.removeEventListener("touchend",ve),P.removeEventListener("touchcancel",ve),P.removeEventListener("contextmenu",ke),P.removeEventListener("mousedown",Ve),P.removeEventListener("mousemove",Me),P.removeEventListener("mouseup",ue),P.removeEventListener("mouseleave",ue),v.current&&clearTimeout(v.current)}},[n,l]);const w=()=>{h&&(c(!1),o(null),g(!1),y(!1))},T=()=>{c(!1),o(null),g(!1),y(!1)},b=P=>{if(!a)return;const[F,N]=a.coordinate;t(P,{lat:N,lng:F}),T()},A=()=>{r(),T()},M=()=>{if(!a)return;const[P,F]=a.coordinate;e({lat:F,lng:P}),c(!1),o(null),g(!1)},O=()=>{if(!a)return;const[P,F]=a.coordinate,N=`https://www.google.com/maps?q=${F},${P}`;window.open(N,"_blank"),c(!1),o(null),g(!1)},z=()=>{if(!a)return;const P=document.createElement("input");P.type="file",P.accept="image/*",P.capture="environment",P.onchange=async F=>{const N=F.target.files?.[0];if(!N)return;const[B,j]=a.coordinate;e({lat:j,lng:B},N)},P.click(),T()},I=()=>{i(),T()},R=P=>{const[F,N]=P;return`${N.toFixed(5)}N, ${F.toFixed(5)}E`};return f.jsx(kn,{children:l&&a&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w}),f.jsxs(yt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:Math.min(a.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[f.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[f.jsx(Wa,{size:16}),f.jsx("span",{className:"text-xs font-mono",children:R(a.coordinate)})]})}),f.jsxs("div",{className:"bg-white",children:[f.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Mv,{size:20,className:"text-orange-500"}),f.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),f.jsxs("button",{onClick:z,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(xE,{size:20,className:"text-green-500"}),f.jsx("span",{className:"font-medium",children:"Foto maken"})]}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>y(!m),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(vo,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),f.jsx(vE,{size:16,className:`text-gray-400 transition-transform ${m?"rotate-90":""}`})]}),f.jsx(kn,{children:m&&f.jsx(yt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?f.jsxs("button",{onClick:A,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[f.jsx(Ha,{size:14}),f.jsx("span",{children:"Maak eerst een laag aan"})]}):f.jsxs(f.Fragment,{children:[s.map(P=>{const F=a?$Se(P,a.coordinate):!1;return f.jsxs("button",{onClick:()=>!F&&b(P.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${F?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:F?"Al toegevoegd aan deze laag":void 0,disabled:F,children:[F&&f.jsx(uc,{size:14,className:"text-green-500 flex-shrink-0"}),f.jsx("span",{className:"truncate",children:P.name}),f.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:F?"al toegevoegd":`(${P.points.length})`})]},P.id)}),f.jsxs("button",{onClick:A,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[f.jsx(Ha,{size:14}),f.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),f.jsxs("button",{onClick:I,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(rue,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),f.jsxs("button",{onClick:O,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(H1,{size:20,className:"text-blue-600"}),f.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]})]}),f.jsx("div",{className:"bg-white",children:f.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[f.jsx(Kr,{size:18}),f.jsx("span",{children:"Annuleren"})]})})]})]})})}const HSe={Compass:Yle,TreePalm:Tue,Mountain:Q0,Waves:Oue,Search:SA,Target:_ue,Layers:vo,Grid:lV},KSe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},XSe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},iD=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],qSe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],YSe=[5.2913,52.1326],ZSe=8;function QSe(){const n=Ai(N=>N.setLayerVisibility),e=as(N=>N.stopTracking),t=Hr(N=>N.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=Sr(),{presets:a,applyPreset:o,updatePreset:l,createPreset:c,resetToDefaults:h}=R9(),g=Ai(N=>N.visible),m=sr(N=>N.presetPanelFontScale),y=sr(N=>N.setPresetPanelFontScale),v=sr(N=>N.showFontSliders),x=12*m/100,[w,T]=X.useState(null),[b,A]=X.useState(!1),[M,O]=X.useState(""),z=()=>{s(),iD.forEach(N=>n(N,!1)),qSe.forEach(N=>{n(N,N==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:fr(YSe),zoom:ZSe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},I=N=>{o(N),s()},R=(N,B)=>{N.stopPropagation();const j=Object.entries(g).filter(([ve,ke])=>ke&&iD.includes(ve)).map(([ve])=>ve);l(B,{layers:j}),T(B),setTimeout(()=>T(null),2e3),console.log(" Lagen opgeslagen naar preset")},P=()=>{M.trim()&&(c(M.trim(),"Layers"),O(""),A(!1))},F=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return f.jsxs(f.Fragment,{children:[f.jsx(yt.button,{onClick:z,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:f.jsx(fV,{size:20,className:"text-gray-600"})}),f.jsx(yt.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?f.jsx(kC,{size:20,className:"text-blue-600"}):f.jsx(vo,{size:20,className:"text-blue-600"})}),f.jsx(kn,{children:r&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),f.jsxs(yt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${x}px`},children:[f.jsx("span",{className:"font-medium text-white",children:"Presets"}),v&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:m,onInput:N=>{y(parseInt(N.target.value))},onChange:N=>y(parseInt(N.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${m}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),f.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(N=>{const B=HSe[N.icon]||vo,j=KSe[N.icon]||"text-blue-600",ve=XSe[N.icon]||"hover:bg-blue-50",ke=w===N.id;return f.jsxs("button",{onClick:()=>I(N.id),className:`w-full h-8 flex items-center gap-2 px-2 ${ve} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${ke?"bg-green-50":""}`,style:{fontSize:`${x}px`},children:[f.jsx(B,{size:14,className:`${j} flex-shrink-0`}),f.jsx("span",{className:"text-gray-700 truncate flex-1",children:N.name}),ke?f.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:f.jsx(uc,{size:14,className:"text-green-500"})}):f.jsx("span",{onClick:Ve=>R(Ve,N.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:f.jsx(gV,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},N.id)})}),f.jsx("div",{className:"border-t border-gray-200 p-2",children:b?f.jsxs("div",{className:"flex gap-1",children:[f.jsx("input",{type:"text",value:M,onChange:N=>O(N.target.value),onKeyDown:N=>{N.key==="Enter"&&P(),N.key==="Escape"&&A(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${x}px`}}),f.jsx("button",{onClick:P,disabled:!M.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:f.jsx(uc,{size:14})})]}):f.jsxs("div",{className:"flex gap-1",children:[f.jsxs("button",{onClick:()=>A(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${x}px`},children:[f.jsx(Ha,{size:14}),f.jsx("span",{children:"Nieuwe preset"})]}),f.jsx("button",{onClick:F,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:f.jsx(Xce,{size:14})})]})})]})]})})]})}function JSe(){const n=Hr(a=>a.map),[e,t]=X.useState(0),[r,i]=X.useState(!1);X.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),c=l*180/Math.PI;t(c),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return f.jsx(kn,{children:r&&f.jsx(yt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:f.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[f.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),f.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),f.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const eTe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],tTe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function nTe(){const[n,e]=X.useState(!1),[t,r]=X.useState(!1),i=Ai(h=>h.visible),s=Ai(h=>h.opacity),a=Ai(h=>h.setLayerOpacity),o=eTe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),c=o.length>3;return f.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[f.jsxs(yt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[f.jsx(cue,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&f.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),f.jsxs(yt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[f.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),f.jsx("div",{className:"space-y-3",children:l.map(h=>{const g=s[h.name]??h.default;return f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>a(h.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${tTe[h.color]}`}),f.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(g*100),"%"]})]})]},h.name)})}),c&&f.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?f.jsxs(f.Fragment,{children:[f.jsx(kC,{size:14}),"Minder tonen"]}):f.jsxs(f.Fragment,{children:[f.jsx(_E,{size:14}),o.length-3," meer..."]})})]})]})})]})}function rTe(){const n=Hr(A=>A.map),[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState([]),[o,l]=X.useState(!1),[c,h]=X.useState(!1),g=X.useRef(null),m=X.useRef(null),y=X.useRef();X.useEffect(()=>{e&&g.current&&g.current.focus()},[e]),X.useEffect(()=>{if(!e)return;const A=M=>{m.current&&!m.current.contains(M.target)&&v()};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[e]),X.useEffect(()=>{if(!e)return;const A=M=>{M.key==="Escape"&&v()};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[e]),X.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();M.response?.docs&&a(M.response.docs)}catch(A){console.error("Search error:",A),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const v=()=>{t(!1),i(""),a([]),l(!1)},x=async A=>{try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(A)}`)).json();if(O.response?.docs?.[0]?.centroide_ll){const I=O.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(I)return{lng:parseFloat(I[1]),lat:parseFloat(I[2])}}}catch(M){console.error("Lookup error:",M)}return null},w=async A=>{if(!n)return;const M=await x(A.id);M&&n.getView().animate({center:fr([M.lng,M.lat]),zoom:16,duration:1e3}),v()},T=async(A,M)=>{M.stopPropagation();const O=await x(A.id);if(O){const z=`https://www.google.com/maps?q=${O.lat},${O.lng}`;window.open(z,"_blank")}v()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?f.jsxs("div",{ref:m,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[f.jsxs(yt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[f.jsx(SA,{size:18,className:"search-icon"}),f.jsx("input",{ref:g,type:"text",value:r,onChange:A=>{i(A.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),f.jsx("button",{onClick:v,className:"search-clear",title:"Sluiten",children:f.jsx(Kr,{size:18})})]}),f.jsx(kn,{children:o&&s.length>0&&f.jsx(yt.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(A=>f.jsxs("li",{className:"search-result-item",children:[f.jsx("div",{className:"search-result-content",onClick:()=>w(A),children:f.jsx("span",{className:"search-result-text",children:A.weergavenaam})}),f.jsx("button",{className:"search-navigate-btn",onClick:M=>T(A,M),title:"Open in Google Maps",children:f.jsx(H1,{size:20})})]},A.id))})}),o&&c&&f.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):f.jsx(yt.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:f.jsx(SA,{size:22,className:"text-gray-600"})})}function iTe(){const n=Hr(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return f.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[f.jsx(yt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:f.jsx(Ha,{size:18,className:"text-gray-600"})}),f.jsx(yt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:f.jsx(uV,{size:18,className:"text-gray-600"})})]})}const sTe="detector2024",UA="detectorapp-auth";function aTe({children:n}){const[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState(!1),[o,l]=X.useState(""),[c,h]=X.useState(!0);X.useEffect(()=>{localStorage.getItem(UA)==="authenticated"&&t(!0),h(!1)},[]);const g=m=>{m.preventDefault(),l(""),r===sTe?(localStorage.setItem(UA,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return c?f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:f.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?f.jsx(f.Fragment,{children:n}):f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:f.jsxs(yt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(EA,{size:32,className:"text-blue-600"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),f.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:s?"text":"password",value:r,onChange:m=>i(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),f.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?f.jsx(Lv,{size:20}):f.jsx(Ov,{size:20})})]})]}),o&&f.jsx(yt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),f.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),f.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function oTe(){localStorage.removeItem(UA),window.location.reload()}function lTe({isOpen:n,onClose:e}){const t=cl(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((c,h)=>h[1]-c[1]),o=l=>Math.max(...Object.values(l),1);return f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(aV,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Kr,{size:18})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(Wa,{size:48,className:"mx-auto mb-3 opacity-30"}),f.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),f.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[f.jsx(GT,{icon:f.jsx(Wa,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),f.jsx(GT,{icon:f.jsx(Yp,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),f.jsx(GT,{icon:f.jsx(Jce,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),f.jsx(qx,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),f.jsx(qx,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),f.jsx(qx,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&f.jsx(qx,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[f.jsx(CC,{size:14}),"Recente Vondsten"]}),f.jsx("div",{className:"space-y-2",children:r.recent.map(l=>f.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),f.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),f.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),f.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function GT({icon:n,value:e,label:t,color:r}){return f.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[f.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),f.jsx("div",{className:"text-xl font-bold",children:e}),f.jsx("div",{className:"text-xs opacity-70",children:t})]})}function qx({title:n,data:e,max:t,color:r}){return e.length===0?null:f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),f.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),f.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:f.jsx(yt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),f.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function cTe(n){const{type:e,coordinates:t}=n,r=o=>fr(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new ri(r(t));case"LineString":return new bi(i(t));case"Polygon":return new Ua(s(t));case"MultiPoint":return new Cd(i(t));case"MultiLineString":return new ic(s(t));case"MultiPolygon":return new ad(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function uTe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new hn({image:new Us({radius:o,fill:new Xn({color:r}),stroke:new zn({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new hn({stroke:new zn({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=hTe(r,.3);return new hn({fill:new Xn({color:l}),stroke:new zn({color:r,width:2})})}return new hn({image:new Us({radius:o,fill:new Xn({color:r}),stroke:new zn({color:"#ffffff",width:2})})})}function hTe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function dTe(){const n=Hr(r=>r.map),e=G1(r=>r.layers),t=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new xl;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const c=cTe(o.geometry);if(!c)return;const h=new gr({geometry:c,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((g,m)=>uTe(i,o.geometry.type,m)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new mc({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),X.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");_B(bn);function fTe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function gTe(n){const[e,t]=n;return bn("EPSG:28992","EPSG:4326",[e,t])}function ez(n,e){return typeof n[0]=="number"?e(n):n.map(t=>ez(t,e))}function mTe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function pTe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,h)=>({type:"Feature",geometry:c,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const c=mTe(s[0].geometry);c&&(a=fTe(c))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(c=>{if(!c.geometry)return c;const h=ez(c.geometry.coordinates,gTe);return{...c,geometry:{...c.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function yTe(n){const e=[],t=[];try{const r=await n.text(),s=new ype({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new XC().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},y=m.name||m.Name||`Feature ${g+1}`,v=m.description||m.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:v}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function xTe(n){const e=[],t=[];try{const r=await n.text(),s=new Pme().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new XC().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},y=m.name||m.Name||`Waypoint ${g+1}`,v=m.desc||m.description||"",x=m.time||null,w=m.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:v,time:x,elevation:w}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return c.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function bk(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function _Te(){return".geojson,.json,.kml,.gpx"}function Ak(){return"GeoJSON, KML (Google My Maps), GPX"}async function vTe(n){switch(bk(n.name)){case"geojson":return pTe(n);case"kml":return yTe(n);case"gpx":return xTe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${Ak()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function wTe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:bk(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${Ak()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function ETe({isOpen:n,onClose:e}){const t=G1(R=>R.addLayer),r=X.useRef(null),[i,s]=X.useState("idle"),[a,o]=X.useState(null),[l,c]=X.useState(null),[h,g]=X.useState(""),[m,y]=X.useState(null),[v,x]=X.useState(!1),w=X.useCallback(()=>{s("idle"),o(null),c(null),g(""),y(null),r.current&&(r.current.value="")},[]),T=X.useCallback(()=>{w(),e()},[w,e]),b=X.useCallback(async R=>{const P=wTe(R);if(!P.valid){y(P.error||"Ongeldig bestand"),s("error");return}o(R),s("parsing"),y(null);const F=R.name.replace(/\.[^/.]+$/,"");g(F);try{const N=await vTe(R);if(!N.success){y(N.errors.join(`
`)),s("error");return}if(N.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}c(N),s("preview")}catch(N){y(N instanceof Error?N.message:"Onbekende fout bij parsen"),s("error")}},[]),A=X.useCallback(R=>{const P=R.target.files?.[0];P&&b(P)},[b]),M=X.useCallback(R=>{R.preventDefault(),x(!0)},[]),O=X.useCallback(R=>{R.preventDefault(),x(!1)},[]),z=X.useCallback(R=>{R.preventDefault(),x(!1);const P=R.dataTransfer.files?.[0];P&&b(P)},[b]),I=X.useCallback(()=>{if(!l||!h.trim())return;const R=a?bk(a.name):"geojson";t({name:h.trim(),type:R==="unsupported"?"geojson":R,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(K1,{size:18}),f.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),f.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Kr,{size:18})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:M,onDragLeave:O,onDrop:z,children:[f.jsx(PC,{size:40,className:"mx-auto text-gray-400 mb-3"}),f.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),f.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),f.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),f.jsx("input",{ref:r,type:"file",accept:_Te(),onChange:A,className:"hidden"})]}),f.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[f.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),f.jsx("p",{children:Ak()})]})]}),i==="parsing"&&f.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[f.jsx(NC,{size:40,className:"text-purple-500 animate-spin mb-4"}),f.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),f.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[f.jsx(oV,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),f.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:m})]})]}),f.jsx("button",{onClick:w,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[f.jsx(zle,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),f.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&f.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[f.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),f.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((R,P)=>f.jsx("li",{children:R},P))})]}),f.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Features:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Types:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),f.jsx("input",{type:"text",value:h,onChange:R=>g(R.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[f.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),f.jsx("button",{onClick:I,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function STe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=Qh();return X.useEffect(()=>{s()},[s]),e?f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[f.jsx(vA,{size:16,className:"animate-pulse"}),f.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?f.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?f.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:f.jsx(DC,{size:16,className:"text-green-600"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),f.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[f.jsx(vA,{size:12}),"Cloud sync actief"]})]}),f.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(LC,{size:16})})]}):f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[f.jsx(Wle,{size:16}),f.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),f.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[f.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),f.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&f.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const TTe="https://forms.gle/R5LCk11Bzu5XrkBj8";function bTe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=Sr(),s=sr(),{presets:a,createPreset:o,deletePreset:l,updatePreset:c}=R9(),h=cl(q=>q.vondsten),g=G1(q=>q.layers),{layers:m,updateLayer:y}=hs(),{devMode:v,setDevMode:x,tier:w}=KI(),{showParkingButton:T,setShowParkingButton:b}=XI(),[A,M]=X.useState(""),[O,z]=X.useState(!1),[I,R]=X.useState(!1),[P,F]=X.useState(null),[N,B]=X.useState(""),[j,ve]=X.useState(null),[ke,Ve]=X.useState(""),[Me,ue]=X.useState("algemeen"),Ae=14*s.fontScale/100,be=()=>{A.trim()&&(o(A.trim(),"Layers"),M(""),z(!1))},re=(q,le)=>{F(q),B(le)},V=q=>{N.trim()&&(c(q,{name:N.trim()}),console.log(` Preset hernoemd naar "${N.trim()}"`)),F(null),B("")},se=()=>{F(null),B("")},ne=[{id:"algemeen",label:"Algemeen",icon:f.jsx(hue,{size:14})},{id:"lagen",label:"Lagen",icon:f.jsx(vo,{size:14})},{id:"vondsten",label:"Vondsten",icon:f.jsx(Wa,{size:14})}];return f.jsxs(f.Fragment,{children:[f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Ae}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(TA,{size:18,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:q=>{s.setFontScale(parseInt(q.target.value))},onChange:q=>s.setFontScale(parseInt(q.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:f.jsx(Kr,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:ne.map(q=>f.jsxs("button",{onClick:()=>ue(q.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Me===q.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[q.icon,q.label]},q.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Ae}px`},children:[Me==="algemeen"&&f.jsxs(f.Fragment,{children:[f.jsx(ra,{title:"Account",icon:f.jsx(DC,{size:16}),children:f.jsx(STe,{})}),f.jsxs(ra,{title:"Kaart",icon:f.jsx(OC,{size:16}),children:[f.jsx(ATe,{label:"Standaard achtergrond",children:f.jsxs("select",{value:s.defaultBackground,onChange:q=>s.setDefaultBackground(q.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),f.jsx("option",{value:"OpenStreetMap",children:"OSM"}),f.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),f.jsx(so,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),f.jsxs(ra,{title:"GPS",icon:f.jsx(wE,{size:16}),children:[f.jsx(so,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),f.jsx(so,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),f.jsxs(ra,{title:"Feedback",icon:f.jsx(fue,{size:16}),children:[f.jsx(so,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),f.jsx(so,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[f.jsx(Nue,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),f.jsxs(ra,{title:"Development",icon:f.jsx(Xle,{size:16}),children:[f.jsx(so,{label:"Dev Mode (alles ontgrendeld)",checked:v,onChange:x}),f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",f.jsx("span",{className:"font-medium text-blue-600",children:w}),v&&f.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Me==="lagen"&&f.jsxs(f.Fragment,{children:[f.jsx(ra,{title:"Mijn lagen",icon:f.jsx(vo,{size:16}),isOwn:!0,children:f.jsxs("div",{className:"space-y-1",children:[m.filter(q=>!q.archived).length===0?f.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):m.filter(q=>!q.archived).map(q=>f.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:j===q.id?f.jsx("input",{type:"text",value:ke,onChange:le=>Ve(le.target.value),onKeyDown:le=>{le.key==="Enter"?(ke.trim()&&y(q.id,{name:ke.trim()}),ve(null)):le.key==="Escape"&&ve(null)},onBlur:()=>{ke.trim()&&y(q.id,{name:ke.trim()}),ve(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:q.name}),f.jsxs("span",{className:"text-xs text-gray-400",children:[q.points.length," punten"]}),f.jsx("button",{onClick:()=>{ve(q.id),Ve(q.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:f.jsx(J0,{size:12})})]})},q.id)),f.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(TA,{size:14}),f.jsx("span",{children:"Lagen beheren"})]})]})}),f.jsx(ra,{title:"Lagen importeren",icon:f.jsx(K1,{size:16}),children:f.jsxs("div",{className:"space-y-1",children:[g.length>0&&f.jsxs(f.Fragment,{children:[g.map(q=>f.jsx(yV,{layer:q},q.id)),f.jsx("div",{className:"border-t border-gray-100 my-2"})]}),f.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(Ha,{size:14}),f.jsx("span",{children:"Nieuwe laag importeren"})]}),f.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),f.jsx(ra,{title:"Presets",icon:f.jsx(vo,{size:16}),children:f.jsxs("div",{className:"space-y-2",children:[a.map(q=>f.jsx("div",{className:"flex items-center justify-between py-1",children:P===q.id?f.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[f.jsx("input",{type:"text",value:N,onChange:le=>B(le.target.value),onKeyDown:le=>{le.key==="Enter"&&V(q.id),le.key==="Escape"&&se()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),f.jsx("button",{onClick:()=>V(q.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),f.jsx("button",{onClick:se,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[q.name,q.isBuiltIn&&f.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),f.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",q.layers.length," lagen)"]})]}),!q.isBuiltIn&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>re(q.id,q.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(J0,{size:14})}),f.jsx("button",{onClick:()=>l(q.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(wl,{size:14})})]})]})},q.id)),O?f.jsxs("div",{className:"flex gap-2 mt-2",children:[f.jsx("input",{type:"text",value:A,onChange:q=>M(q.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:q=>q.key==="Enter"&&be(),autoFocus:!0}),f.jsx("button",{onClick:be,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),f.jsx("button",{onClick:()=>z(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):f.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(Ha,{size:14}),f.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Me==="vondsten"&&f.jsxs(f.Fragment,{children:[f.jsxs(ra,{title:"Vondsten",icon:f.jsx(Wa,{size:16}),isOwn:!0,children:[f.jsx(so,{label:"Vondsten knop tonen",checked:s.showVondstButton,onChange:s.setShowVondstButton}),f.jsx("p",{className:"text-gray-500 mt-1 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),f.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(aV,{size:14}),f.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),f.jsx(RTe,{})]}),f.jsxs(ra,{title:"Route opnemen",icon:f.jsx(Dv,{size:16}),isOwn:!0,children:[f.jsx(so,{label:"Route knop tonen",checked:s.showRouteRecordButton,onChange:s.setShowRouteRecordButton}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Neem je route op tijdens het detecteren of wandelen. Routes worden lokaal opgeslagen en kunnen als GPX gexporteerd worden."})]}),f.jsxs(ra,{title:"Parkeerhulp",icon:f.jsx(qf,{size:16}),children:[f.jsx(so,{label:"Parkeerknop tonen",checked:T,onChange:b}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Sla op waar je auto staat en navigeer er later naar terug."})]}),f.jsxs(ra,{title:"Stappenteller",icon:f.jsx(wA,{size:16}),children:[f.jsx(so,{label:"Stappenteller tonen",checked:s.showStepCounter,onChange:s.setShowStepCounter}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Tel je stappen tijdens het detecteren. Werkt het beste op mobiel."})]}),f.jsxs(ra,{title:"Tekstgrootte",icon:f.jsx(mV,{size:16}),children:[f.jsx(so,{label:"Tekstgrootte schuifjes tonen",checked:s.showFontSliders,onChange:s.setShowFontSliders}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Toon schuifjes in menu's om de tekstgrootte aan te passen."})]})]})]}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Ae}px`},children:[f.jsxs("a",{href:TTe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(sV,{size:16}),f.jsx("span",{children:"Meld een bug"})]}),f.jsxs("button",{onClick:oTe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(LC,{size:16}),f.jsx("span",{children:"Uitloggen"})]}),f.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),f.jsx(lTe,{isOpen:t,onClose:r}),f.jsx(ETe,{isOpen:I,onClose:()=>R(!1)})]})}function ra({title:n,icon:e,children:t,isOwn:r}){return f.jsxs("section",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[f.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),f.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),f.jsx("div",{className:"space-y-2",children:t})]})}function ATe({label:n,children:e}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function so({label:n,checked:e,onChange:t}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),f.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function RTe(){const[n,e]=X.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=cl(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],c=h=>{h(),e(!1)};return t.length===0?f.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[f.jsx(Nv,{size:14}),f.jsx("span",{children:"Geen vondsten om te exporteren"})]}):f.jsxs("div",{className:"relative mt-2",children:[f.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Nv,{size:14}),f.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),f.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&f.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,g)=>f.jsxs("button",{onClick:()=>c(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[f.jsx("span",{className:"text-gray-700",children:h.label}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},g))})]})}const uw="2.30.9";function ITe({size:n=18}){return f.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function CTe(){const[n,e]=X.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=Qh(),{toggleInfoPanel:a,toggleSettingsPanel:o}=Sr(),l=sr(b=>b.menuFontScale),c=sr(b=>b.setMenuFontScale),h=sr(b=>b.showFontSliders),g={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},m=()=>e(!1),y=()=>{m(),a()},v=()=>{m(),o()},x=()=>{m(),i()},w=()=>{m(),s()},T=13*l/100;return f.jsxs(f.Fragment,{children:[f.jsx(yt.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:g,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?f.jsx(Kr,{size:22,className:"text-white"}):f.jsx(kce,{size:22,className:"text-gray-600"})}),f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),f.jsxs(yt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${T}px`},children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[f.jsx("span",{className:"font-medium text-white",style:{fontSize:`${T}px`},children:"Menu"}),h&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:b=>c(parseInt(b.target.value)),onChange:b=>c(parseInt(b.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?f.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:f.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?f.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?f.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:f.jsx(DC,{size:16,className:"text-white"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),f.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),f.jsx("button",{onClick:w,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(LC,{size:16})})]})}):f.jsxs("button",{onClick:x,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[f.jsx(ITe,{size:18}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),f.jsx("div",{className:"py-1",children:f.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[f.jsx(MC,{size:18,className:"text-blue-500"}),f.jsx("span",{children:"Info & handleiding"})]})}),f.jsx("div",{className:"mt-auto border-t border-gray-100",children:f.jsxs("button",{onClick:v,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[f.jsx(TA,{size:18,className:"text-gray-500"}),f.jsx("span",{children:"Instellingen"})]})}),f.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",uw]})]})]})})]})}const kTe="https://forms.gle/R5LCk11Bzu5XrkBj8";function PTe(){const{infoPanelOpen:n,toggleInfoPanel:e}=Sr(),[t,r]=X.useState("info"),i=[{id:"info",label:"Info",icon:f.jsx(MC,{size:14})},{id:"functies",label:"Functies",icon:f.jsx(PC,{size:14})},{id:"handleiding",label:"Handleiding",icon:f.jsx(Ile,{size:14})}];return f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[f.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",uw]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:f.jsx(Kr,{size:18,className:"text-white",strokeWidth:2.5})})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>f.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&f.jsx(MTe,{}),t==="functies"&&f.jsx(NTe,{}),t==="handleiding"&&f.jsx(LTe,{}),f.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[f.jsxs("a",{href:kTe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[f.jsx(sV,{size:14}),f.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),f.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",uw," - Gratis en zonder tracking"]})]})]})]})]})})}function MTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),f.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),f.jsxs("ul",{className:"space-y-2 text-gray-600",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Mindat.org"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Paleontica / Fossielen data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Map5.nl / Kadaster"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciale data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Locatiegegevens:"})," Alleen voor navigatie, niet opgeslagen of gedeeld."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Geen tracking:"})," Geen analytics, cookies of gebruiksstatistieken."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Lokale opslag:"})," Standaard blijft alle data op je apparaat."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Google sync (optioneel):"})," Met Google login worden lagen en vondsten veilig gesynchroniseerd. Alleen jij hebt toegang."]})]})]})]})}function NTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(OC,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(mce,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(lce,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(vA,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(wE,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),f.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),f.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),f.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),f.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),f.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Wa,{size:16,className:"text-orange-600"}),"Vondsten"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),f.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),f.jsx("li",{children:"Foto's toevoegen (link of upload)"}),f.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),f.jsx("li",{children:"Dashboard met statistieken"}),f.jsx("li",{children:"Cloud sync met Google account"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(vo,{size:16,className:"text-purple-600"}),"Presets"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Lce,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),f.jsx("li",{children:"Oppervlakte in m en hectare"}),f.jsx("li",{children:"Gewas en bouwplan met uitleg"}),f.jsx("li",{children:"Bodemtype met beschrijving"}),f.jsx("li",{children:"AHN hoogte in meters NAP"}),f.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),f.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(oue,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function LTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),f.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[f.jsxs("li",{children:["Tik op de ",f.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),f.jsxs("li",{children:["Kies een ",f.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),f.jsxs("li",{children:["Of open ",f.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),f.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsx("p",{children:"Rechtsboven vind je het menu met:"}),f.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"})," Tik op de ",f.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),f.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),f.jsxs("li",{children:["Combineer ",f.jsx("strong",{children:"AMK"})," met ",f.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),f.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),f.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),f.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(H1,{size:16,className:"text-blue-600"}),"Handige links"]}),f.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("li",{children:[f.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function tz(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function zT(n){let e=0;for(let t=1;t<n.length;t++)e+=tz(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const So=bs()(xc((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=a;o&&(c+=l-o);const h=l-s-c,g=zT(i),m={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:g,totalDuration:h,pausedDuration:c,createdAt:new Date().toISOString()};return n(y=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[m,...y.savedRoutes]})),m},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if(tz(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.has(t)?i.delete(t):i.add(t),{visibleRouteIds:i}})},showRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.add(t),{visibleRouteIds:i}})},hideRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.delete(t),{visibleRouteIds:i}})},showAllRoutes:()=>{n(t=>({visibleRouteIds:new Set(t.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{n({visibleRouteIds:new Set})},toggleHeatmap:()=>{n(t=>({heatmapEnabled:!t.heatmapEnabled}))},setHeatmapEnabled:t=>{n({heatmapEnabled:t})},toggleGrid:()=>{n(t=>({gridEnabled:!t.gridEnabled}))},setGridEnabled:t=>{n({gridEnabled:t})},setGridCenter:t=>{n({gridCenter:t})},setGridSize:t=>{n({gridSize:t})},setGridCount:t=>{n({gridCount:t})},setGridColor:t=>{n({gridColor:t})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{n({gridCenter:[t.coords.longitude,t.coords.latitude],gridEnabled:!0})},t=>{console.error("Could not get location:",t)})},setAutoPauseEnabled:t=>{n({autoPauseEnabled:t})},setAutoPauseSeconds:t=>{n({autoPauseSeconds:t})},importRouteFromGPX:(t,r)=>{try{const s=new DOMParser().parseFromString(t,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const o=s.querySelectorAll("trkpt");if(o.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((o.length>0?o:s.querySelectorAll("wpt")).forEach(w=>{const T=parseFloat(w.getAttribute("lat")||"0"),b=parseFloat(w.getAttribute("lon")||"0"),A=w.querySelector("time"),M=A?new Date(A.textContent||"").getTime():Date.now();!isNaN(T)&&!isNaN(b)&&l.push({coordinates:[b,T],timestamp:isNaN(M)?Date.now():M})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const h=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,g=zT(l),m=l[0].timestamp,y=l[l.length-1].timestamp,v=y-m,x={id:crypto.randomUUID(),name:h,points:l,startTime:m,endTime:y,totalDistance:g,totalDuration:v>0?v:0,pausedDuration:0,createdAt:new Date().toISOString()};return n(w=>({savedRoutes:[x,...w.savedRoutes]})),{success:!0,routeId:x.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,notes:r}:s)}))},addPhotoToRoute:(t,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};n(s=>({savedRoutes:s.savedRoutes.map(a=>a.id===t?{...a,photos:[...a.photos||[],i]}:a)}))},removePhotoFromRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,photos:(s.photos||[]).filter(a=>a.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:t}=e();return zT(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:n=>({savedRoutes:n.savedRoutes,visibleRouteIds:Array.from(n.visibleRouteIds),heatmapEnabled:n.heatmapEnabled,gridEnabled:n.gridEnabled,gridCenter:n.gridCenter,gridSize:n.gridSize,gridCount:n.gridCount,gridColor:n.gridColor,autoPauseEnabled:n.autoPauseEnabled,autoPauseSeconds:n.autoPauseSeconds}),merge:(n,e)=>({...e,...n,visibleRouteIds:new Set(n?.visibleRouteIds||[])})}));function nz(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let _u=null,fp=null;function rz(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;_u=window.speechSynthesis;const n=()=>{const e=_u?.getVoices()||[];fp=e.find(t=>t.lang.startsWith("nl")||t.name.toLowerCase().includes("dutch")||t.name.toLowerCase().includes("nederland"))||null,!fp&&e.length>0&&(fp=e[0])};return n(),_u&&(_u.onvoiceschanged=n),!0}function OTe(n,e){if(!_u&&!rz()||!_u)return;_u.cancel();const t=new SpeechSynthesisUtterance(n);fp&&(t.voice=fp),t.lang="nl-NL",t.rate=e?.rate,t.pitch=e?.pitch??1,t.volume=e?.volume??1,_u.speak(t)}function DTe(n){const e=[];e.push(`${n.type} toegevoegd`),n.material&&n.material!=="Onbekend"&&e.push(`Materiaal: ${n.material}`),n.period&&n.period!=="Onbekend"&&e.push(`Periode: ${n.period}`),n.layerName&&n.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${n.layerName}`);const t=e.join(". ");OTe(t,{rate:1.1})}rz();function UT({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,g]=X.useState(""),m=e&&!r.includes(e),y=()=>{c(!0),g(m?e:""),o(!1)},v=()=>{h.trim()&&t(h.trim()),c(!1)};return l?f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:h,onChange:x=>g(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),v()),x.key==="Escape"&&c(!1)},onBlur:v,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):f.jsxs("div",{className:"relative",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[f.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",m&&f.jsx(BO,{size:12,className:"inline ml-1 text-orange-500"})]}),f.jsx(_E,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&f.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[f.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[f.jsx(BO,{size:12}),"Eigen invoer..."]}),f.jsx("div",{className:"border-t border-gray-100"}),r.map(x=>f.jsx("button",{type:"button",onClick:()=>{t(x),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${x===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:x},x))]})]})}function iz({onClose:n,initialLocation:e}){const t=as(Be=>Be.position),r=Hr(Be=>Be.map),i=Sr(Be=>Be.vondstFormPhoto),s=hs(Be=>Be.layers),a=hs(Be=>Be.addPoint),o=sr(Be=>Be.voiceFeedbackEnabled),l=So(Be=>Be.state),c=So(Be=>Be.startTime);So(Be=>Be.savedRoutes);const h=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,g=l==="recording"||l==="paused",m=h(),[y,v]=X.useState(""),[x,w]=X.useState(""),[T,b]=X.useState(""),[A,M]=X.useState(""),[O,z]=X.useState(!1),[I,R]=X.useState(void 0),[P,F]=X.useState(void 0),[N,B]=X.useState(co),[j,ve]=X.useState(i),[ke,Ve]=X.useState(null);X.useEffect(()=>{if(j){const Be=URL.createObjectURL(j);return Ve(Be),()=>URL.revokeObjectURL(Be)}else Ve(null)},[j]);const[Me,ue]=X.useState(e?"map-pick":t?"gps":"map-center"),[Ae,be]=X.useState(e||null),[re,V]=X.useState(!1),se=()=>{if(Me==="gps"&&t)return{lat:t.lat,lng:t.lng};if(Me==="map-pick"&&Ae)return Ae;if(r){const Be=r.getView().getCenter();if(Be){const[Rt,Dt]=Tn(Be);return{lat:Dt,lng:Rt}}}return null},ne=se();X.useEffect(()=>{if(!re||!r)return;const Be=Rt=>{const[Dt,Nt]=Tn(Rt.coordinate);be({lat:Nt,lng:Dt}),ue("map-pick"),V(!1)};return r.on("click",Be),()=>r.un("click",Be)},[re,r]);const q=()=>V(!0),le=()=>{t&&(ue("gps"),be(null))},Ie=()=>{const Be=document.createElement("input");Be.type="file",Be.accept="image/*",Be.capture="environment",Be.onchange=Rt=>{const Dt=Rt.target.files?.[0];Dt&&ve(Dt)},Be.click()},Fe=()=>ve(null),he=async Be=>{Be.preventDefault();const Rt=se();if(!Rt){alert("Geen locatie beschikbaar");return}if(!x){alert("Vul een naam/type in");return}z(!0);try{let Dt=y||"";if(N===co){const ln=[];T&&ln.push(`Materiaal: ${T}`),A&&ln.push(`Periode: ${A}`),I&&ln.push(`Gewicht: ${I}g`),P&&ln.push(`Lengte: ${P}mm`),ln.length>0&&(Dt=ln.join(" | ")+(y?` | ${y}`:""))}a(N,{coordinates:[Rt.lng,Rt.lat],name:x,category:N===co?x:"Overig",notes:Dt||"",...g&&c?{routeId:`recording-${c}`,routeName:m||void 0}:{}});const Nt=s.find(ln=>ln.id===N)?.name||"Vondsten";o&&DTe({type:x,material:T||void 0,period:A||void 0,layerName:Nt}),alert(`Toegevoegd aan ${Nt}! `),n()}catch(Dt){alert("Fout bij opslaan: "+Dt.message)}finally{z(!1)}},Pe=X.useMemo(()=>s.map(Be=>({id:Be.id,name:Be.name,color:Be.color})),[s]);return re?f.jsx(yt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:f.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Mv,{size:24,className:"animate-pulse"}),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),f.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),f.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):f.jsx(yt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:f.jsxs(yt.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[f.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[f.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),f.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Kr,{size:20})})]}),f.jsxs("form",{onSubmit:he,className:"flex-1 overflow-y-auto",children:[f.jsxs("div",{className:"p-5 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),ke?f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:ke,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),f.jsx("button",{type:"button",onClick:Fe,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:f.jsx(wl,{size:16})})]}):f.jsxs("button",{type:"button",onClick:Ie,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[f.jsx(xE,{size:32}),f.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),ne&&f.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[f.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[ne.lat.toFixed(6),"N, ",ne.lng.toFixed(6),"E"]}),f.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Me==="gps"?" GPS locatie":Me==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!ne&&f.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:f.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),f.jsxs("div",{className:"flex gap-2",children:[t&&Me!=="gps"&&f.jsxs("button",{type:"button",onClick:le,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[f.jsx(wE,{size:16}),"GPS"]}),f.jsxs("button",{type:"button",onClick:q,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[f.jsx(Mv,{size:16}),"Kies op kaart"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:Pe.map(Be=>f.jsx("button",{type:"button",onClick:()=>B(Be.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${N===Be.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Be.name},Be.id))})]}),N===co&&f.jsx(UT,{label:"Type vondst",value:x,onChange:w,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),N!==co&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:x,onChange:Be=>w(Be.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),N===co&&f.jsxs(f.Fragment,{children:[f.jsx(UT,{label:"Materiaal",value:T,onChange:b,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),f.jsx(UT,{label:"Periode",value:A,onChange:M,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),f.jsx("input",{type:"number",value:I??"",onChange:Be=>R(Be.target.value?parseFloat(Be.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),f.jsx("input",{type:"number",value:P??"",onChange:Be=>F(Be.target.value?parseFloat(Be.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),f.jsx("textarea",{value:y,onChange:Be=>v(Be.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),f.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:f.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),f.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[f.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),f.jsx("button",{type:"submit",disabled:O||!ne||re||!x,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:O?"Opslaan...":"Opslaan"})]})]})]})})}function FTe(){const{user:n,setUser:e,setLoading:t}=Qh();return X.useEffect(()=>{const s=K6(zh,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await JZ(zh)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await X6(zh)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function jTe(){const{isAuthenticated:n,loginAnonymous:e}=FTe(),t=sr(c=>c.vondstenLocalOnly),r=sr(c=>c.showVondstButton),i=Sr(c=>c.vondstFormOpen),s=Sr(c=>c.vondstFormLocation),a=Sr(c=>c.openVondstForm),o=Sr(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return f.jsxs(f.Fragment,{children:[f.jsx(yt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:f.jsx(Wa,{size:22,strokeWidth:2})}),f.jsx(kn,{children:i&&f.jsx(iz,{onClose:o,initialLocation:s||void 0})})]})}function VTe(){const n=sr(Ie=>Ie.showRouteRecordButton),e=Sr(Ie=>Ie.toggleRouteDashboard),{state:t,startRecording:r,pauseRecording:i,resumeRecording:s,stopRecording:a,cancelRecording:o,addPoint:l,getCurrentDistance:c,getCurrentDuration:h,getAverageSpeed:g,currentPoints:m,savedRoutes:y,autoPauseEnabled:v,autoPauseSeconds:x}=So(),[w,T]=X.useState(!1),[b,A]=X.useState(""),[M,O]=X.useState(!1),[z,I]=X.useState(!1),R=X.useRef(null),P=X.useRef(null),F=X.useRef(null),N=Ie=>{const Fe=Math.floor(Ie/1e3),he=Math.floor(Fe/3600),Pe=Math.floor(Fe%3600/60),Be=Fe%60;return he>0?`${he}:${Pe.toString().padStart(2,"0")}:${Be.toString().padStart(2,"0")}`:`${Pe}:${Be.toString().padStart(2,"0")}`},B=Ie=>Ie<1e3?`${Math.round(Ie)} m`:`${(Ie/1e3).toFixed(2)} km`,j=Ie=>`${Ie.toFixed(1)} km/h`,ve=(Ie,Fe,he,Pe)=>{const Rt=(Pe-Fe)*Math.PI/180,Dt=(he-Ie)*Math.PI/180,Nt=Math.sin(Rt/2)*Math.sin(Rt/2)+Math.cos(Fe*Math.PI/180)*Math.cos(Pe*Math.PI/180)*Math.sin(Dt/2)*Math.sin(Dt/2);return 6371e3*(2*Math.atan2(Math.sqrt(Nt),Math.sqrt(1-Nt)))};if(X.useEffect(()=>(t==="recording"?(I(!1),"geolocation"in navigator&&R.current===null&&(R.current=navigator.geolocation.watchPosition(Ie=>{const Fe=Ie.coords.longitude,he=Ie.coords.latitude,Pe=Date.now();l(Fe,he,Ie.coords.accuracy),v&&P.current?ve(P.current.lon,P.current.lat,Fe,he)>3?(P.current={lon:Fe,lat:he,time:Pe},F.current&&(clearTimeout(F.current),F.current=null)):Pe-P.current.time>=x*1e3&&(i(),I(!0),P.current=null):P.current={lon:Fe,lat:he,time:Pe}},Ie=>{console.error("GPS error:",Ie)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(R.current!==null&&(navigator.geolocation.clearWatch(R.current),R.current=null),F.current&&(clearTimeout(F.current),F.current=null)),()=>{R.current!==null&&(navigator.geolocation.clearWatch(R.current),R.current=null),F.current&&(clearTimeout(F.current),F.current=null)}),[t,l,v,x,i]),!n)return null;const ke=()=>{r(),O(!0)},Ve=()=>{i()},Me=()=>{s()},ue=()=>{A(`Route ${new Date().toLocaleDateString("nl-NL")}`),T(!0)},Ae=()=>{const Ie=a(b);T(!1),O(!1),A(""),Ie&&confirm(`Route "${Ie.name}" opgeslagen! (${B(Ie.totalDistance)})

Direct exporteren als GPX?`)&&nz(Ie)},be=()=>{m.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(o(),T(!1),O(!1))},re=c(),V=h(),se=g(),ne=Ie=>{switch(Ie){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-purple-500 hover:bg-purple-600"}},q=Ie=>{switch(Ie){case"recording":return f.jsx(hV,{size:22,strokeWidth:2});case"paused":return f.jsx(dV,{size:22,strokeWidth:2});default:return f.jsx(Dv,{size:22,strokeWidth:2})}},le=()=>{switch(t){case"idle":ke();break;case"recording":Ve();break;case"paused":Me();break}};return f.jsxs(f.Fragment,{children:[f.jsxs(yt.button,{className:`fixed bottom-2 right-[114px] z-[1000] w-11 h-11 ${ne(t)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:le,title:t==="idle"?"Route opnemen":t==="recording"?"Pauzeren":"Hervatten",children:[q(t),t==="recording"&&f.jsx(yt.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),f.jsx(kn,{children:t==="idle"&&y.length>0&&f.jsxs(yt.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-purple-400 hover:bg-purple-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e,title:`Mijn routes (${y.length})`,children:[f.jsx(cV,{size:18,strokeWidth:2}),f.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-purple-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:y.length})]})}),f.jsx(kn,{children:(t==="recording"||t==="paused")&&f.jsx(yt.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ue,title:"Stoppen en opslaan",children:f.jsx(mue,{size:18,strokeWidth:2,fill:"currentColor"})})}),f.jsx(kn,{children:M&&t!=="idle"&&f.jsxs(yt.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t==="recording"?" Opname":z?" Auto-pauze":" Gepauzeerd"}),f.jsx("button",{onClick:()=>O(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:f.jsx(Kr,{size:14})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Yp,{size:16,className:"text-purple-500"}),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:B(re)})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Pv,{size:16,className:"text-blue-500"}),f.jsx(BTe,{duration:V,recordingState:t,formatTime:N})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(fce,{size:16,className:"text-green-500"}),f.jsx("span",{className:"text-sm text-gray-600",children:j(se)})]}),f.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[m.length," punten opgenomen"]})]})]})}),f.jsx(kn,{children:w&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>T(!1)}),f.jsxs(yt.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Afstand:"}),f.jsx("span",{className:"font-medium",children:B(re)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Duur:"}),f.jsx("span",{className:"font-medium",children:N(V)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),f.jsx("span",{className:"font-medium",children:j(se)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Punten:"}),f.jsx("span",{className:"font-medium",children:m.length})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),f.jsx("input",{type:"text",value:b,onChange:Ie=>A(Ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:be,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),f.jsxs("button",{onClick:Ae,disabled:m.length<2,className:"flex-1 px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(gV,{size:16}),"Opslaan"]})]}),m.length<2&&f.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function BTe({duration:n,recordingState:e,formatTime:t}){const[r,i]=X.useState(n);return X.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),X.useEffect(()=>{i(n)},[n]),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function GTe(){const n=Hr(s=>s.map),{currentPoints:e,state:t}=So(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new xl;i.current=s;const a=new mc({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>fr(a.coordinates));if(s.length>=2){const a=new gr({geometry:new bi(s)});a.setStyle(new hn({stroke:new zn({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new gr({geometry:new ri(s[0])});a.setStyle(new hn({image:new Us({radius:8,fill:new Xn({color:"rgba(34, 197, 94, 1)"}),stroke:new zn({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new gr({geometry:new ri(s[s.length-1])});a.setStyle(new hn({image:new Us({radius:6,fill:new Xn({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new zn({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const sD=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function zTe(){const n=Hr(s=>s.map),{savedRoutes:e,visibleRouteIds:t}=So(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new xl;i.current=s;const a=new mc({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(a=>t.has(a.id)).forEach((a,o)=>{const l=sD[o%sD.length],c=a.points.map(x=>fr(x.coordinates));if(c.length<2)return;const h=new gr({geometry:new bi(c),routeId:a.id,routeName:a.name});h.setStyle(new hn({stroke:new zn({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(h);const g=new gr({geometry:new ri(c[0]),routeId:a.id,type:"start"});g.setStyle(new hn({image:new Us({radius:8,fill:new Xn({color:"#22c55e"}),stroke:new zn({color:"white",width:2})}),text:new ja({text:"S",font:"bold 10px sans-serif",fill:new Xn({color:"white"}),offsetY:1})})),i.current.addFeature(g);const m=new gr({geometry:new ri(c[c.length-1]),routeId:a.id,type:"end"});m.setStyle(new hn({image:new Us({radius:8,fill:new Xn({color:"#ef4444"}),stroke:new zn({color:"white",width:2})}),text:new ja({text:"E",font:"bold 10px sans-serif",fill:new Xn({color:"white"}),offsetY:1})})),i.current.addFeature(m);const y=Math.floor(c.length/2),v=new gr({geometry:new ri(c[y]),routeId:a.id,type:"label"});v.setStyle(new hn({text:new ja({text:a.name,font:"12px sans-serif",fill:new Xn({color:"#1f2937"}),stroke:new zn({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(v)})},[e,t]),null}function UTe(){const n=Hr(a=>a.map),{savedRoutes:e,visibleRouteIds:t,heatmapEnabled:r}=So(),i=X.useRef(null),s=X.useRef(null);return X.useEffect(()=>{if(!n)return;const a=new xl;s.current=a;const o=new KK({source:a,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=o,n.addLayer(o),()=>{n&&i.current&&n.removeLayer(i.current)}},[n]),X.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const a=e.filter(l=>t.has(l.id)),o=[];for(const l of a)for(const c of l.points){const h=new gr({geometry:new ri(fr(c.coordinates))});o.push(h)}s.current.addFeatures(o),i.current.setVisible(o.length>0)},[e,t,r]),null}function $Te(n,e,t,r){const i=[],s=e/111e3,a=e/(111e3*Math.cos(n[1]*Math.PI/180)),o=Math.floor(t/2),l=n[0]-o*a,c=n[0]+o*a,h=n[1]-o*s,g=n[1]+o*s;for(let x=-o;x<=o;x++){const w=n[0]+x*a,T=[fr([w,h]),fr([w,g])],b=new gr({geometry:new bi(T),type:"grid-line"});b.setStyle(new hn({stroke:new zn({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(b)}for(let x=-o;x<=o;x++){const w=n[1]+x*s,T=[fr([l,w]),fr([c,w])],b=new gr({geometry:new bi(T),type:"grid-line"});b.setStyle(new hn({stroke:new zn({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(b)}const m="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let x=-o;x<o;x++)for(let w=-o;w<o;w++){const T=n[0]+(w+.5)*a,b=n[1]+(x+.5)*s,A=x+o,M=w+o;if(A>=0&&A<m.length){const O=`${m[A]}${M+1}`,z=new gr({geometry:new bi([fr([T,b]),fr([T,b])]),type:"grid-label"});z.setStyle(new hn({text:new ja({text:O,font:"12px sans-serif",fill:new Xn({color:r}),stroke:new zn({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(z)}}const y=new gr({geometry:new bi([fr([n[0]-a*.2,n[1]]),fr([n[0]+a*.2,n[1]])]),type:"grid-center"});y.setStyle(new hn({stroke:new zn({color:"#ef4444",width:3})})),i.push(y);const v=new gr({geometry:new bi([fr([n[0],n[1]-s*.2]),fr([n[0],n[1]+s*.2])]),type:"grid-center"});return v.setStyle(new hn({stroke:new zn({color:"#ef4444",width:3})})),i.push(v),i}function WTe(){const n=Hr(l=>l.map),{gridEnabled:e,gridCenter:t,gridSize:r,gridCount:i,gridColor:s}=So(),a=X.useRef(null),o=X.useRef(null);return X.useEffect(()=>{if(!n)return;const l=new xl;o.current=l;const c=new mc({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return a.current=c,n.addLayer(c),()=>{a.current&&n&&n.removeLayer(a.current)}},[n]),X.useEffect(()=>{if(!o.current||!a.current)return;if(o.current.clear(),!e||!t){a.current.setVisible(!1);return}const l=$Te(t,r,i,s);o.current.addFeatures(l),a.current.setVisible(!0)},[e,t,r,i,s]),null}function HTe(n){const e=[];let t=0;return n.points.forEach((r,i)=>{if(i>0){const o=n.points[i-1],l=6371e3,c=(r.coordinates[1]-o.coordinates[1])*Math.PI/180,h=(r.coordinates[0]-o.coordinates[0])*Math.PI/180,g=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2),m=2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g));t+=l*m}const s=5,a=Math.sin(t/50)*2+Math.sin(t/120)*1.5+Math.sin(t/30+r.coordinates[0]*1e3)*.5;e.push({distance:t,elevation:Math.max(0,s+a)})}),e}function KTe({route:n,onClose:e}){const t=X.useRef(null),[r,i]=X.useState([]),[s,a]=X.useState({min:0,max:0,gain:0,loss:0});X.useEffect(()=>{const l=HTe(n);if(i(l),l.length>0){const c=l.map(v=>v.elevation),h=Math.min(...c),g=Math.max(...c);let m=0,y=0;for(let v=1;v<l.length;v++){const x=l[v].elevation-l[v-1].elevation;x>0?m+=x:y+=Math.abs(x)}a({min:h,max:g,gain:m,loss:y})}},[n]),X.useEffect(()=>{const l=t.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const h=l.width,g=l.height,m={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,h,g);const y=Math.max(...r.map(O=>O.distance)),v=Math.min(...r.map(O=>O.elevation))-1,x=Math.max(...r.map(O=>O.elevation))+1,w=O=>m.left+O/y*(h-m.left-m.right),T=O=>g-m.bottom-(O-v)/(x-v)*(g-m.top-m.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const b=5;for(let O=0;O<=b;O++){const z=v+(x-v)*(O/b),I=T(z);c.beginPath(),c.moveTo(m.left,I),c.lineTo(h-m.right,I),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${z.toFixed(1)}m`,m.left-5,I+3)}const A=5;for(let O=0;O<=A;O++){const z=y/A*O,I=w(z);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(z<1e3?`${Math.round(z)}m`:`${(z/1e3).toFixed(1)}km`,I,g-10)}c.beginPath(),c.moveTo(w(r[0].distance),g-m.bottom),r.forEach(O=>{c.lineTo(w(O.distance),T(O.elevation))}),c.lineTo(w(r[r.length-1].distance),g-m.bottom),c.closePath();const M=c.createLinearGradient(0,m.top,0,g-m.bottom);M.addColorStop(0,"rgba(139, 92, 246, 0.3)"),M.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=M,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((O,z)=>{const I=w(O.distance),R=T(O.elevation);z===0?c.moveTo(I,R):c.lineTo(I,R)}),c.stroke()},[r]);const o=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return f.jsxs(yt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Q0,{size:20}),f.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(Kr,{size:18})})]}),f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:n.name}),f.jsx("p",{className:"text-xs text-gray-500",children:o(n.totalDistance)})]}),f.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:f.jsx(uV,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:f.jsx(Q0,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:f.jsx(Iue,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:f.jsx(Aue,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),f.jsx("div",{className:"flex-1 p-3",children:f.jsx("canvas",{ref:t,width:350,height:200,className:"w-full h-full"})}),f.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:f.jsxs("p",{className:"text-xs text-yellow-700",children:[f.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const XTe=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,qTe=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},aD=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function YTe({route:n,onClose:e}){const{updateRouteNotes:t,addPhotoToRoute:r,removePhotoFromRoute:i}=So(),[s,a]=X.useState(n.notes||""),[o,l]=X.useState("info"),c=X.useRef(null),h=()=>{t(n.id,s)},g=async v=>{const x=v.target.files?.[0];if(!x)return;const w=URL.createObjectURL(x);r(n.id,{url:w,caption:x.name}),c.current&&(c.current.value="")},m=v=>{confirm("Foto verwijderen?")&&i(n.id,v)},y=So(v=>v.savedRoutes.find(x=>x.id===n.id))||n;return f.jsxs(yt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[f.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),f.jsxs(yt.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h3",{className:"font-medium truncate",children:y.name}),f.jsx("p",{className:"text-xs text-purple-200",children:aD(y.createdAt)})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:f.jsx(Kr,{size:18})})]}),f.jsxs("div",{className:"flex border-b border-gray-200",children:[f.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(Wa,{size:16,className:"inline mr-1"}),"Info"]}),f.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(xE,{size:16,className:"inline mr-1"}),"Foto's (",y.photos?.length||0,")"]}),f.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(PC,{size:16,className:"inline mr-1"}),"Notities"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o==="info"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[f.jsx(Yp,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),f.jsx("p",{className:"text-lg font-semibold",children:XTe(y.totalDistance)})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[f.jsx(Pv,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),f.jsx("p",{className:"text-lg font-semibold",children:qTe(y.totalDuration)})]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[f.jsx(Wa,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),f.jsxs("p",{className:"text-lg font-semibold",children:[y.points.length," GPS punten"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[f.jsx(CC,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),f.jsx("p",{className:"text-sm",children:aD(y.createdAt)})]})]}),o==="photos"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:g,className:"hidden"}),f.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[f.jsx(Ha,{size:24}),f.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),y.photos&&y.photos.length>0?f.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.photos.map(v=>f.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[f.jsx("img",{src:v.url,alt:v.caption||"Route foto",className:"w-full h-full object-cover"}),f.jsx("button",{onClick:()=>m(v.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:f.jsx(wl,{size:12})}),v.caption&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:v.caption})]},v.id))}):f.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),o==="notes"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("textarea",{value:s,onChange:v=>a(v.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),f.jsx("button",{onClick:h,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function ZTe({route:n,size:e=80}){const t=X.useRef(null);return X.useEffect(()=>{const r=t.current;if(!r||n.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=n.points.map(M=>M.coordinates[0]),a=n.points.map(M=>M.coordinates[1]),o=Math.min(...s),l=Math.max(...s),c=Math.min(...a),h=Math.max(...a),g=8,m=e-g*2,y=e-g*2,v=M=>l===o?e/2:g+(M-o)/(l-o)*m,x=M=>h===c?e/2:g+y-(M-c)/(h-c)*y;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),n.points.forEach((M,O)=>{const z=v(M.coordinates[0]),I=x(M.coordinates[1]);O===0?i.moveTo(z,I):i.lineTo(z,I)}),i.stroke();const w=v(n.points[0].coordinates[0]),T=x(n.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(w,T,4,0,Math.PI*2),i.fill();const b=v(n.points[n.points.length-1].coordinates[0]),A=x(n.points[n.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(b,A,4,0,Math.PI*2),i.fill()},[n,e]),n.points.length<2?f.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:f.jsx(Wa,{size:20})}):f.jsx("canvas",{ref:t,width:e,height:e,className:"rounded"})}const $T=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,WT=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},oD=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function QTe({isOpen:n,onClose:e,onViewRoute:t}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:a,visibleRouteIds:o,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:h,heatmapEnabled:g,toggleHeatmap:m,gridEnabled:y,toggleGrid:v,centerGridOnCurrentLocation:x,gridSize:w,setGridSize:T,autoPauseEnabled:b,setAutoPauseEnabled:A,autoPauseSeconds:M,setAutoPauseSeconds:O,importRouteFromGPX:z}=So(),[I,R]=X.useState(null),[P,F]=X.useState(""),[N,B]=X.useState(!1),[j,ve]=X.useState(!1),[ke,Ve]=X.useState(null),[Me,ue]=X.useState(null),Ae=X.useRef(null),be=async he=>{const Pe=` ${he.name}

 Afstand: ${$T(he.totalDistance)}
 Duur: ${WT(he.totalDuration)}
 ${he.points.length} GPS punten
 ${oD(he.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:he.name,text:Pe});return}catch(Be){Be.name!=="AbortError"&&console.error("Share failed:",Be)}try{await navigator.clipboard.writeText(Pe),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",Pe)}},re=async he=>{const Pe=he.target.files?.[0];if(Pe){try{const Be=await Pe.text(),Rt=z(Be,Pe.name.replace(".gpx",""));Rt.success?alert(`Route gemporteerd: ${Pe.name}`):alert(`Import mislukt: ${Rt.error}`)}catch{alert("Fout bij lezen van bestand")}Ae.current&&(Ae.current.value="")}},V=he=>{R(he.id),F(he.name)},se=he=>{P.trim()&&s(he,P.trim()),R(null),F("")},ne=he=>{confirm(`Weet je zeker dat je "${he.name}" wilt verwijderen?`)&&i(he.id)},q=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&a()},le=he=>{l(he);const Pe=r.find(Be=>Be.id===he);Pe&&t&&t(Pe)},Ie=r.reduce((he,Pe)=>he+Pe.totalDistance,0),Fe=r.reduce((he,Pe)=>he+Pe.totalDuration,0);return f.jsxs(f.Fragment,{children:[f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Dv,{size:20}),f.jsx("span",{className:"font-medium",children:"Mijn Routes"}),f.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(Kr,{size:18})})]}),r.length>0&&f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(Yp,{size:14}),f.jsxs("span",{children:["Totaal: ",$T(Ie)]})]}),f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(Pv,{size:14}),f.jsx("span",{children:WT(Fe)})]})]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>ve(!j),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${b?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:b?"Auto-pauze uit":"Auto-pauze aan",children:f.jsx(wue,{size:14})}),f.jsx("button",{onClick:()=>B(!N),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${y?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:y?"Grid verbergen":"Grid tonen",children:f.jsx(lV,{size:14})}),f.jsx("button",{onClick:m,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${g?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:g?"Heatmap verbergen":"Heatmap tonen",children:f.jsx(ice,{size:14})}),f.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:f.jsx(Ov,{size:14})}),f.jsx("button",{onClick:h,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:f.jsx(Lv,{size:14})})]})]}),f.jsx(kn,{children:N&&f.jsx(yt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),f.jsx("button",{onClick:v,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${y?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:y?"Aan":"Uit"})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("button",{onClick:x,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(Mv,{size:14}),"Centreer op mijn locatie"]})}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",w,"m"]}),f.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:w,onChange:he=>T(Number(he.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[f.jsx("span",{children:"5m"}),f.jsx("span",{children:"50m"})]})]}),f.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),f.jsx(kn,{children:j&&f.jsx(yt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),f.jsx("button",{onClick:()=>A(!b),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${b?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:b?"Aan":"Uit"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",M<60?`${M}s`:`${Math.floor(M/60)}m ${M%60}s`]}),f.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:M,onChange:he=>O(Number(he.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[f.jsx("span",{children:"30s"}),f.jsx("span",{children:"5min"})]})]}),f.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",M<60?`${M} seconden`:`${Math.floor(M/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?f.jsxs("div",{className:"text-center py-12 text-gray-500",children:[f.jsx(Dv,{size:48,className:"mx-auto mb-3 text-gray-300"}),f.jsx("p",{className:"font-medium",children:"Nog geen routes"}),f.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(he=>f.jsxs(yt.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[f.jsx(ZTe,{route:he,size:70}),f.jsxs("div",{className:"flex-1 min-w-0",children:[I===he.id?f.jsx("input",{type:"text",value:P,onChange:Pe=>F(Pe.target.value),onKeyDown:Pe=>{Pe.key==="Enter"&&se(he.id),Pe.key==="Escape"&&R(null)},onBlur:()=>se(he.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:he.name}),f.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(CC,{size:12}),oD(he.createdAt)]})}),f.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Yp,{size:12}),$T(he.totalDistance)]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Pv,{size:12}),WT(he.totalDuration)]}),f.jsxs("span",{children:[he.points.length," punten"]})]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>le(he.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${o.has(he.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:o.has(he.id)?"Verbergen op kaart":"Tonen op kaart",children:o.has(he.id)?f.jsx(Ov,{size:16}):f.jsx(Lv,{size:16})}),f.jsx("button",{onClick:()=>V(he),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(J0,{size:16})}),f.jsx("button",{onClick:()=>ue(he),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:f.jsx(MC,{size:16})}),f.jsx("button",{onClick:()=>Ve(he),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:f.jsx(Q0,{size:16})}),f.jsx("button",{onClick:()=>be(he),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:f.jsx(sue,{size:16})}),f.jsx("button",{onClick:()=>nz(he),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:f.jsx(Nv,{size:16})}),f.jsx("button",{onClick:()=>ne(he),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(wl,{size:16})})]})]},he.id))}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[f.jsx("input",{ref:Ae,type:"file",accept:".gpx",onChange:re,className:"hidden"}),f.jsxs("button",{onClick:()=>Ae.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[f.jsx(K1,{size:16}),"GPX bestand importeren"]}),r.length>0&&f.jsx("button",{onClick:q,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),f.jsx(kn,{children:ke&&f.jsx(KTe,{route:ke,onClose:()=>Ve(null)})}),f.jsx(kn,{children:Me&&f.jsx(YTe,{route:Me,onClose:()=>ue(null)})})]})}function JTe(){const[n,e]=X.useState(!1),{parkingLocation:t,setParkingLocation:r,clearParkingLocation:i,showParkingButton:s}=XI(),a=as(v=>v.position),o=Hr(v=>v.map);if(!s)return null;const l=()=>{if(!a){alert("GPS positie niet beschikbaar. Zet GPS aan.");return}r({lat:a.lat,lng:a.lng,timestamp:new Date().toISOString()}),navigator.vibrate&&navigator.vibrate(100),e(!1)},c=()=>{if(!t)return;const v=`https://www.google.com/maps/dir/?api=1&destination=${t.lat},${t.lng}&travelmode=walking`;window.open(v,"_blank"),e(!1)},h=()=>{if(!t||!o)return;o.getView().animate({center:fr([t.lng,t.lat]),zoom:18,duration:500}),e(!1)},g=()=>{confirm("Parkeerlocatie wissen?")&&(i(),e(!1))},m=v=>new Date(v).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),y=v=>{const x=new Date(v),w=new Date;if(x.toDateString()===w.toDateString())return"Vandaag";const b=new Date(w);return b.setDate(b.getDate()-1),x.toDateString()===b.toDateString()?"Gisteren":x.toLocaleDateString("nl-NL",{day:"numeric",month:"short"})};return f.jsxs(f.Fragment,{children:[f.jsx(yt.button,{className:`
          fixed bottom-[60px] right-2 z-[800]
          w-11 h-11 cursor-pointer border-0 outline-none
          flex items-center justify-center
          rounded-xl backdrop-blur-sm
          transition-all duration-200
          ${t?"bg-gradient-to-br from-amber-400 to-amber-600 text-white shadow-lg shadow-amber-500/30":"bg-white/80 text-gray-600 hover:bg-white/90 shadow-sm"}
        `,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:t?"Auto geparkeerd":"Parkeren",children:f.jsx(qf,{size:20})}),f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 z-[899]",onClick:()=>e(!1)}),f.jsxs(yt.div,{initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},className:"fixed bottom-[116px] right-2 z-[900] w-56 bg-white rounded-xl shadow-xl overflow-hidden",children:[f.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-amber-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(qf,{size:18}),f.jsx("span",{className:"font-medium text-sm",children:"Parkeerhulp"})]}),f.jsx("button",{onClick:()=>e(!1),className:"p-1 rounded hover:bg-amber-400 transition-colors border-0 outline-none",children:f.jsx(Kr,{size:16})})]}),f.jsx("div",{className:"p-2",children:t?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"px-3 py-2 mb-2 bg-amber-50 rounded-lg border border-amber-200",children:[f.jsx("div",{className:"text-xs text-amber-700 mb-1",children:"Geparkeerd"}),f.jsxs("div",{className:"text-sm font-medium text-gray-800",children:[y(t.timestamp)," om ",m(t.timestamp)]})]}),f.jsxs("button",{onClick:h,className:"w-full flex items-center gap-3 px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(qf,{size:16,className:"text-amber-500"}),f.jsx("span",{children:"Toon op kaart"})]}),f.jsxs("button",{onClick:c,className:"w-full flex items-center gap-3 px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(wE,{size:16,className:"text-blue-500"}),f.jsx("span",{children:"Navigeer naar auto"})]}),f.jsx("hr",{className:"my-2 border-gray-200"}),f.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(qf,{size:16,className:"text-green-500"}),f.jsx("span",{children:"Nieuwe locatie opslaan"})]}),f.jsxs("button",{onClick:g,className:"w-full flex items-center gap-3 px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(wl,{size:16}),f.jsx("span",{children:"Wissen"})]})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"px-3 py-3 mb-2 text-center text-gray-500 text-sm",children:"Geen parkeerlocatie opgeslagen"}),f.jsxs("button",{onClick:l,disabled:!a,className:`
                        w-full flex items-center justify-center gap-2 px-4 py-3
                        text-sm font-medium rounded-lg transition-colors border-0 outline-none
                        ${a?"bg-amber-500 text-white hover:bg-amber-600":"bg-gray-200 text-gray-400 cursor-not-allowed"}
                      `,children:[f.jsx(qf,{size:18}),f.jsx("span",{children:"Hier geparkeerd"})]}),!a&&f.jsx("p",{className:"text-xs text-center text-gray-400 mt-2",children:"Zet GPS aan om te parkeren"})]})})]})]})})]})}const ebe='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="%23f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><path d="M9 17h6"/><circle cx="17" cy="17" r="2"/></svg>';function tbe(){const n=Hr(r=>r.map),e=XI(r=>r.parkingLocation),t=X.useRef(null);return X.useEffect(()=>{if(!n)return;const r=new xl,i=new mc({source:r,zIndex:950,properties:{name:"parking-marker"}});return n.addLayer(i),t.current=i,()=>{t.current&&n.removeLayer(t.current)}},[n]),X.useEffect(()=>{const r=t.current;if(!r)return;const i=r.getSource();if(!i||(i.clear(),!e))return;const s=new gr({geometry:new ri(fr([e.lng,e.lat])),type:"parking"});s.setStyle(new hn({image:new sg({src:`data:image/svg+xml,${encodeURIComponent(ebe.replace(/%23/g,"#"))}`,scale:1.2,anchor:[.5,.5]}),text:new ja({text:"Auto",offsetY:24,font:"bold 11px sans-serif",fill:new Xn({color:"#78350f"}),stroke:new zn({color:"#ffffff",width:3}),padding:[2,4,2,4]})})),i.addFeature(s)},[e]),null}const nbe="https://www.googleapis.com/fitness/v1/users/me/dataset:aggregate";async function rbe(n){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());return ibe(n,t,e)}async function ibe(n,e,t){const r={aggregateBy:[{dataTypeName:"com.google.step_count.delta",dataSourceId:"derived:com.google.step_count.delta:com.google.android.gms:estimated_steps"}],bucketByTime:{durationMillis:t.getTime()-e.getTime()},startTimeMillis:e.getTime(),endTimeMillis:t.getTime()};try{const i=await fetch(nbe,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok)throw i.status===401?(console.warn(" Google Fit: Token verlopen, opnieuw inloggen vereist"),new Error("TOKEN_EXPIRED")):i.status===403?(console.warn(" Google Fit: Geen toegang - Fitness API mogelijk niet ingeschakeld"),new Error("FITNESS_API_DISABLED")):new Error(`Google Fit API error: ${i.status}`);const s=await i.json();let a=0;for(const o of s.bucket||[])for(const l of o.dataset||[])for(const c of l.point||[])for(const h of c.value||[])a+=h.intVal||0;return console.log(` Google Fit: ${a} stappen vandaag`),a}catch(i){throw i.message==="TOKEN_EXPIRED"||i.message==="FITNESS_API_DISABLED"||console.error(" Google Fit fout:",i),i}}function sbe({size:n=16,className:e=""}){return f.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,className:e,children:[f.jsx("path",{fill:"#4285F4",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"}),f.jsx("path",{fill:"#fff",d:"M12 6.5c-.83 0-1.5.67-1.5 1.5v4c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V8c0-.83-.67-1.5-1.5-1.5zm3.5 5.5c0 1.93-1.57 3.5-3.5 3.5S8.5 13.93 8.5 12h-2c0 2.76 2.01 5.05 4.64 5.46.17.03.34.04.51.04h.7c.17 0 .34-.01.51-.04C15.49 17.05 17.5 14.76 17.5 12h-2z"})]})}function abe(){const{steps:n,distance:e,isActive:t,todaySteps:r,setActive:i,incrementStep:s,resetSession:a}=Vre(),o=sr(B=>B.showStepCounter),l=Qh(B=>B.accessToken),c=Qh(B=>B.user),h=Qh(B=>B.connectGoogleFit),[g,m]=X.useState(!1),[y,v]=X.useState(null),[x,w]=X.useState(null),[T,b]=X.useState(!1),[A,M]=X.useState(null),[O,z]=X.useState(!1),I=B=>B>=1e3?`${(B/1e3).toFixed(2)} km`:`${Math.round(B)} m`,R=X.useCallback(async()=>{if(l){b(!0),M(null);try{const B=await rbe(l);w(B)}catch(B){B.message==="TOKEN_EXPIRED"?M("Opnieuw inloggen vereist"):B.message==="FITNESS_API_DISABLED"?M("Google Fit niet gekoppeld"):M("Kon stappen niet ophalen"),console.error("Google Fit error:",B)}finally{b(!1)}}},[l]);X.useEffect(()=>{g&&l&&x===null&&!A&&R()},[g,l,x,A,R]);const P=async()=>{z(!0),M(null);try{const B=await h()}catch{M("Koppelen mislukt")}finally{z(!1)}},F=X.useCallback(B=>{if(!t)return;const j=B.accelerationIncludingGravity;j&&Gre({x:j.x||0,y:j.y||0,z:j.z||0})&&s()},[t,s]);X.useEffect(()=>{if(!(!t||!y))return window.addEventListener("devicemotion",F),()=>{window.removeEventListener("devicemotion",F)}},[t,y,F]);const N=async()=>{if(!t&&y===null){const B=await zre();if(v(B),!B){alert("Stappenteller heeft toegang tot bewegingssensoren nodig.");return}}i(!t)};return o?f.jsx(yt.div,{className:"fixed bottom-[180px] right-2 z-[800]",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:f.jsx(kn,{mode:"wait",children:g?f.jsxs(yt.div,{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden w-48",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},children:[f.jsxs("div",{className:`px-3 py-2 flex items-center justify-between ${t?"bg-green-500 text-white":"bg-gray-100 text-gray-700"}`,children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wA,{size:16,className:t?"animate-pulse":""}),f.jsx("span",{className:"font-medium text-sm",children:"Stappenteller"})]}),f.jsx("button",{onClick:()=>m(!1),className:"p-0.5 rounded hover:bg-black/10 transition-colors",children:f.jsx(_E,{size:16})})]}),f.jsxs("div",{className:"p-3 space-y-2",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-3xl font-bold text-gray-800",children:n.toLocaleString()}),f.jsx("div",{className:"text-xs text-gray-500",children:"stappen deze sessie"})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Afstand:"}),f.jsx("span",{className:"font-medium",children:I(e)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Vandaag (app):"}),f.jsx("span",{className:"font-medium",children:r.toLocaleString()})]}),c&&f.jsxs("div",{className:"flex justify-between items-center text-sm",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(sbe,{size:14}),f.jsx("span",{className:"text-gray-500",children:"Google Fit:"})]}),f.jsx("div",{className:"flex items-center gap-1",children:l?T?f.jsx(GO,{size:12,className:"animate-spin text-blue-500"}):A?f.jsx("span",{className:"text-xs text-red-400",children:A}):x!==null?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"font-medium text-blue-600",children:x.toLocaleString()}),f.jsx("button",{onClick:R,className:"p-0.5 hover:bg-gray-100 rounded",title:"Vernieuwen",children:f.jsx(GO,{size:10,className:"text-gray-400"})})]}):f.jsx("button",{onClick:R,className:"text-xs text-blue-500 hover:underline",children:"Ophalen"}):f.jsx("button",{onClick:P,disabled:O,className:"text-xs text-blue-500 hover:underline disabled:opacity-50",children:O?"Koppelen...":"Koppelen"})})]}),f.jsxs("div",{className:"flex gap-2 pt-2",children:[f.jsx(yt.button,{onClick:N,className:`flex-1 flex items-center justify-center gap-1 py-2 rounded-lg text-sm font-medium transition-colors ${t?"bg-orange-100 text-orange-600 hover:bg-orange-200":"bg-green-100 text-green-600 hover:bg-green-200"}`,whileTap:{scale:.95},children:t?f.jsxs(f.Fragment,{children:[f.jsx(hV,{size:14}),f.jsx("span",{children:"Pauze"})]}):f.jsxs(f.Fragment,{children:[f.jsx(dV,{size:14}),f.jsx("span",{children:"Start"})]})}),f.jsx(yt.button,{onClick:()=>{a()},className:"px-3 py-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",whileTap:{scale:.95},title:"Reset sessie",children:f.jsx(fV,{size:14})})]})]}),y===!1&&f.jsx("div",{className:"px-3 pb-3 text-xs text-red-500",children:"Geen toegang tot bewegingssensoren"})]},"expanded"):f.jsxs(yt.button,{onClick:()=>m(!0),className:`flex items-center gap-2 px-3 py-2 rounded-full shadow-lg transition-all ${t?"bg-green-500 text-white":"bg-white text-gray-700 border border-gray-200"}`,whileTap:{scale:.95},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[f.jsx(wA,{size:18,className:t?"animate-pulse":""}),f.jsx("span",{className:"font-medium text-sm",children:n.toLocaleString()}),f.jsx(kC,{size:14,className:"opacity-50"})]},"collapsed")})}):null}const lD={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},obe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function lbe(){const n=Hr(i=>i.map),e=cl(i=>i.vondsten),t=sr(i=>i.showLocalVondsten),r=X.useRef(null);return X.useEffect(()=>{if(!n)return;const i=new xl;return e.forEach(s=>{const a=new gr({geometry:new ri(fr([s.location.lng,s.location.lat])),vondst:s}),o=lD[s.objectType]||lD.Anders,l=obe[s.objectType]||"?";a.setStyle((c,h)=>{let v=12;h>50?v=6:h>10?v=Math.max(6,12-(h-10)/10):h<2&&(v=14);const x=Math.max(8,Math.min(12,v-2));return new hn({image:new Us({radius:v,fill:new Xn({color:o}),stroke:new zn({color:"#ffffff",width:v>8?2:1})}),text:v>=8?new ja({text:l,font:`bold ${x}px sans-serif`,fill:new Xn({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new mc({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),X.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const cbe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function ube(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?fr(s):s.map(r),i=r(t);switch(e){case"Point":return new ri(i);case"LineString":return new bi(i);case"Polygon":return new Ua(i);case"MultiPoint":return new Cd(i);case"MultiLineString":return new ic(i);case"MultiPolygon":return new ad(i);default:return new ri(fr(t))}}function hbe(){const n=Hr(i=>i.map),e=hs(i=>i.layers),t=sr(i=>i.showCustomPointLayers),r=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new xl;s.points.forEach(l=>{let c;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?c=ube(l.geometry):c=new ri(fr(l.coordinates));const g=new gr({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),m=cbe[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;g.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new hn({fill:new Xn({color:s.color+"40"}),stroke:new zn({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new hn({stroke:new zn({color:s.color,width:3})}):new hn({image:new Us({radius:8,fill:new Xn({color:s.color}),stroke:new zn({color:"#ffffff",width:2})})}))}else g.setStyle((y,v)=>{let b=12;v>50?b=6:v>10?b=Math.max(6,12-(v-10)/10):v<2&&(b=14);const A=Math.max(8,Math.min(12,b-2));return new hn({image:new Us({radius:b,fill:new Xn({color:s.color}),stroke:new zn({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new ja({text:m,font:`bold ${A}px sans-serif`,fill:new Xn({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(g)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new mc({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function dbe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=Sr(),{addLayer:t}=hs(),r=sr(),[i,s]=X.useState(""),[a,o]=X.useState([...ru]),[l,c]=X.useState(""),h=14*r.fontScale/100,g=()=>{const w=l.trim();w&&!a.includes(w)&&(o([...a,w]),c(""))},m=w=>{o(a.filter(T=>T!==w))},y=w=>{a.includes(w)?o(a.filter(T=>T!==w)):o([...a,w])},v=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...ru]),c(""),e())},x=()=>{s(""),o([...ru]),c(""),e()};return f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(vo,{size:18}),f.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:w=>r.setFontScale(parseInt(w.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Kr,{size:18})})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),f.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:ru.map(w=>f.jsx("button",{onClick:()=>y(w),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(w)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:w},w))})]}),a.filter(w=>!ru.includes(w)).length>0&&f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(w=>!ru.includes(w)).map(w=>f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{onClick:()=>y(w),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:w}),f.jsx("button",{onClick:()=>m(w),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:f.jsx(wl,{size:12})})]},w))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:l,onChange:w=>c(w.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:w=>w.key==="Enter"&&g()}),f.jsx("button",{onClick:g,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:f.jsx(Ha,{size:20})})]})]})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[f.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:v,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const sz=200,fbe=.7;async function gbe(n,e=sz){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(c=>{c?t(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",fbe)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function mbe(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function pbe(n){const e=await gbe(n,sz),t=await mbe(e);return{thumbnailBlob:e,thumbnailBase64:t}}function ybe(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const HT=5;function xbe({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=X.useRef(null),s=X.useRef(null),a=async l=>{const c=l.target.files;if(!c||c.length===0)return;const h=HT-n.length,g=Array.from(c).slice(0,h);for(const m of g)try{const{thumbnailBase64:y}=await pbe(m),v={id:ybe(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(v)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<HT;return f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",HT,")"]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>f.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[f.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&f.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:f.jsx(Kr,{size:12,className:"text-white"})}),l.pendingUpload&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[f.jsx(xE,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),f.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[f.jsx(xce,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),f.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),f.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function _be(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=Sr(),{addPoint:i,getLayer:s}=hs(),a=sr(),[o,l]=X.useState(""),[c,h]=X.useState(""),[g,m]=X.useState(""),[y,v]=X.useState([]),x=e?s(e):null,w=14*a.fontScale/100,T=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:c.trim(),url:g.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),m(""),v([]),r())},b=()=>{l(""),h(""),m(""),v([]),r()};return x?f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Wa,{size:18}),f.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:A=>a.setFontScale(parseInt(A.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Kr,{size:18})})]})]}),f.jsx("div",{className:"px-4 py-1.5",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),f.jsx("span",{className:"text-sm text-gray-600",children:x.name})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${w}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),f.jsx("input",{type:"text",value:o,onChange:A=>l(A.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsx(xbe,{photos:y,onAddPhoto:A=>v([...y,A]),onRemovePhoto:A=>v(y.filter(M=>M.id!==A))}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),f.jsx("textarea",{value:c,onChange:A=>h(A.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),f.jsx("input",{type:"url",value:g,onChange:A=>m(A.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),f.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${w}px`},children:[f.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:T,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function vbe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=Sr(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=hs(),h=sr(),g=14*h.fontScale/100,[m,y]=X.useState(null),[v,x]=X.useState(null),[w,T]=X.useState(null),[b,A]=X.useState(!1),M=i.filter(j=>!j.archived),O=i.filter(j=>j.archived),z=b?O:M,I=j=>{v===j?(s(j),x(null)):(x(j),setTimeout(()=>x(null),3e3))},R=j=>{l(j)},P=async j=>{const ve=j.target.files?.[0];if(ve){try{const ke=await ve.text(),Ve=c(ke);Ve.success||(T(Ve.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}j.target.value=""}},F=()=>{y(null),x(null),T(null),A(!1),e()},N=j=>{r(j)},B=()=>{F(),t()};return f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:F}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(vo,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:F,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Kr,{size:18})})]})]}),f.jsxs("div",{className:"flex border-b border-gray-100",children:[f.jsxs("button",{onClick:()=>A(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",M.length,")"]}),f.jsxs("button",{onClick:()=>A(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[f.jsx(iV,{size:14}),"Archief (",O.length,")"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${g}px`},children:[z.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:b?f.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),f.jsxs("button",{onClick:B,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[f.jsx(Ha,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):f.jsx("div",{className:"divide-y divide-gray-100",children:z.map(j=>f.jsx(Ebe,{layer:j,isExpanded:m===j.id,onToggleExpand:()=>y(m===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>N(j.id),onExport:()=>R(j.id),onDelete:()=>I(j.id),confirmDelete:v===j.id,onRename:ve=>hs.getState().updateLayer(j.id,{name:ve}),onChangeColor:ve=>hs.getState().updateLayer(j.id,{color:ve})},j.id))}),w&&f.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:w})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${g}px`},children:[f.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[f.jsx(K1,{size:16}),f.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),f.jsx("input",{type:"file",accept:".geojson,.json",onChange:P,className:"hidden"})]}),f.jsxs("button",{onClick:B,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[f.jsx(Ha,{size:16}),f.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const wbe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function Ebe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:c,onChangeColor:h}){const[g,m]=X.useState(!1),[y,v]=X.useState(n.name),[x,w]=X.useState(!1),T=X.useRef(null);X.useEffect(()=>{g&&T.current&&(T.current.focus(),T.current.select())},[g]);const b=()=>{v(n.name),m(!0)},A=()=>{const R=y.trim();R&&R!==n.name&&c(R),m(!1)},M=()=>{v(n.name),m(!1)},O=R=>{R.key==="Enter"?A():R.key==="Escape"&&M()},z=n.points.filter(R=>R.status==="completed").length,I=n.points.length;return f.jsxs("div",{className:"bg-white",children:[f.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[f.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?f.jsx(_E,{size:16}):f.jsx(vE,{size:16})}),f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>w(!x),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),x&&f.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:wbe.map(R=>f.jsx("button",{onClick:()=>{h(R),w(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${R===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:R}},R))})]}),g?f.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[f.jsx("input",{ref:T,type:"text",value:y,onChange:R=>v(R.target.value),onKeyDown:O,onBlur:A,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),f.jsx("button",{onClick:A,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:f.jsx(uc,{size:16})})]}):f.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),f.jsx("div",{className:"text-xs text-gray-500",children:I>0?f.jsxs("span",{className:z===I?"text-green-600":"",children:[z,"/",I," voltooid"]}):"Geen punten"})]}),!g&&f.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:f.jsx(J0,{size:16})}),f.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:f.jsx(cV,{size:18})}),!n.archived&&f.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?f.jsx(Ov,{size:18}):f.jsx(Lv,{size:18})}),f.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?f.jsx(Sle,{size:18}):f.jsx(iV,{size:18})}),f.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:f.jsx(Nv,{size:18})}),f.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(wl,{size:18})})]}),f.jsx(kn,{children:e&&f.jsx(yt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:f.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(R=>f.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:R},R))}),n.points.length>0&&f.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(R=>f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("span",{className:`font-medium ${R.status==="completed"?"text-green-600 line-through":R.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:R.name})},R.id)),n.points.length>5&&f.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),f.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function Sbe(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=Sr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=hs(),o=sr(),[l,c]=X.useState("all"),[h,g]=X.useState(null),[m,y]=X.useState(""),[v,x]=X.useState(null),w=e?r(e):null,T=14*o.fontScale/100;if(!w)return null;const b=w.points.filter(N=>l==="all"?!0:N.status===l),A=w.points.length,M=w.points.filter(N=>N.status==="completed").length,O=w.points.filter(N=>N.status==="todo").length,z=w.points.filter(N=>N.status==="skipped").length,I=(N,B)=>{i(w.id,N,B)},R=N=>{s(w.id,N,{notes:m}),g(null),y("")},P=N=>{v===N?(a(w.id,N),x(null)):(x(N),setTimeout(()=>x(null),3e3))},F=()=>{g(null),x(null),t()};return f.jsx(kn,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(yt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:F}),f.jsxs(yt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:w.color}}),f.jsx("span",{className:"font-medium truncate",children:w.name})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:N=>o.setFontScale(parseInt(N.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:F,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Kr,{size:18})})]})]}),f.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[f.jsxs("span",{className:"text-orange-800 font-medium",children:[M,"/",A," voltooid"]}),f.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[f.jsxs("span",{className:"text-orange-600",children:[O," te doen"]}),z>0&&f.jsxs("span",{className:"text-gray-500",children:[z," overgeslagen"]})]})]}),f.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(N=>f.jsxs("button",{onClick:()=>c(N),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===N?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[N==="all"&&"Alles",N==="todo"&&"Te doen",N==="completed"&&"Voltooid",N==="skipped"&&"Overgeslagen"]},N))}),f.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:b.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:f.jsx("p",{children:"Geen punten gevonden"})}):f.jsx("div",{className:"divide-y divide-gray-100",children:b.map(N=>f.jsx("div",{className:"p-3",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[f.jsx("button",{onClick:()=>I(N.id,N.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${N.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:N.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:f.jsx(uc,{size:14,className:N.status==="completed"?"text-green-600":"text-gray-400"})}),f.jsx("button",{onClick:()=>I(N.id,N.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${N.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:N.status==="skipped"?"Markeer als te doen":"Overslaan",children:f.jsx(Ale,{size:14,className:N.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),N.photos&&N.photos.length>0&&f.jsxs("div",{className:"relative flex-shrink-0",children:[f.jsx("img",{src:N.photos[0].thumbnailUrl||N.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),N.photos.length>1&&f.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",N.photos.length-1]})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`font-medium truncate ${N.status==="completed"?"text-green-700 line-through":N.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:N.name}),N.sourceLayer&&f.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",N.sourceLayer]})]}),h===N.id?f.jsxs("div",{className:"mt-2",children:[f.jsx("textarea",{value:m,onChange:B=>y(B.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),f.jsxs("div",{className:"flex gap-2 mt-1",children:[f.jsx("button",{onClick:()=>R(N.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),f.jsx("button",{onClick:()=>{g(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):N.notes?f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N.notes}):null,N.url&&f.jsxs("a",{href:N.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[f.jsx(H1,{size:12}),"Link"]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>{g(N.id),y(N.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:f.jsx(Vce,{size:14})}),f.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${N.coordinates[1]},${N.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:f.jsx(Wa,{size:14})}),f.jsx("button",{onClick:()=>P(N.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${v===N.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:v===N.id?"Klik nogmaals":"Verwijderen",children:f.jsx(wl,{size:14})})]})]})},N.id))})})]})]})})}class cD{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function Tbe(){const n=as(c=>c.tracking),e=as(c=>c.headingSource);as(c=>c.speed);const t=as(c=>c.setSmoothedHeading),r=X.useRef(new cD(6)),i=X.useRef(new cD(10)),s=X.useRef(0),a=X.useRef(null),o=33,l=X.useCallback((c,h)=>{const g=performance.now();if(g-s.current<o)return;const m=h==="gps"?r.current:i.current;m.add(c);const y=m.getSmoothed();y!==null&&(s.current=g,t(y))},[t]);X.useEffect(()=>{if(!n)return;const c=g=>{g.coords.heading!==null&&g.coords.speed!==null&&g.coords.speed>.8&&g.coords.accuracy<20&&l(g.coords.heading,"gps")},h=navigator.geolocation.watchPosition(c,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),X.useEffect(()=>{if(!n||e!=="compass")return;let c=0;const h=50,g=y=>{const v=performance.now();if(!(v-c<h)&&(c=v,y.alpha!==null)){const x=(360-y.alpha)%360;l(x,"compass")}},m=y=>{const v=performance.now();v-c<h||(c=v,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",g),window.addEventListener("deviceorientation",m),()=>{window.removeEventListener("deviceorientationabsolute",g),window.removeEventListener("deviceorientation",m)}},[n,e,l]),X.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),X.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function bbe(){const n=Hr(i=>i.map),e=Ai(i=>i.setLayerOpacity),t=Ai(i=>i.visible),r=X.useRef(null);X.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const uD=2e3;function Abe(){const n=Qh(m=>m.user),{layers:e,clearAll:t}=hs(),{vondsten:r,clearAll:i}=cl(),s=X.useRef(null),a=X.useRef(!0),o=X.useRef(""),l=X.useRef(""),c=X.useCallback(async m=>{if(n)try{const y=x0(mu,"users",n.uid);await c3(y,{layers:m,layersUpdatedAt:u3()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=X.useCallback(async m=>{if(n)try{const y=x0(mu,"users",n.uid);await c3(y,{vondsten:m,vondstenUpdatedAt:u3()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),g=X.useCallback(async()=>{if(n)try{const m=x0(mu,"users",n.uid),y=await Zne(m);if(y.exists()){const v=y.data();if(v.layers&&Array.isArray(v.layers)){const x=v.layers,w=hs.getState().layers,T=[...x],b=new Set(x.map(A=>A.id));w.forEach(A=>{b.has(A.id)||T.push(A)}),hs.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${x.length} lagen geladen uit cloud`)}if(v.vondsten&&Array.isArray(v.vondsten)){const x=v.vondsten,w=cl.getState().vondsten,T=[...x],b=new Set(x.map(A=>A.id));w.forEach(A=>{b.has(A.id)||T.push(A)}),cl.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${x.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await c(e),await h(r);a.current=!1}catch(m){console.error(" Fout bij laden uit cloud:",m),a.current=!1}},[n,e,r,c,h]);return X.useEffect(()=>{n?(a.current=!0,g()):(a.current=!0,o.current="",l.current="")},[n?.uid]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(e);if(m!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=m,c(e)},uD),()=>{s.current&&clearTimeout(s.current)}},[n,e,c]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(r);if(m!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=m,h(r)},uD),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:c,syncVondstenToCloud:h}}function Rbe(){Tbe(),bbe(),Abe();const e=14*sr(o=>o.fontScale)/100,t=Sr(o=>o.vondstFormOpen),r=Sr(o=>o.vondstFormLocation),i=Sr(o=>o.closeVondstForm),s=Sr(o=>o.routeDashboardOpen),a=Sr(o=>o.toggleRouteDashboard);return f.jsx(aTe,{children:f.jsxs("div",{style:{fontSize:`${e}px`},children:[f.jsx($re,{}),f.jsx(Bue,{}),f.jsx(lbe,{}),f.jsx(dTe,{}),f.jsx(hbe,{}),f.jsx(GTe,{}),f.jsx(zTe,{}),f.jsx(UTe,{}),f.jsx(WTe,{}),f.jsx(USe,{}),f.jsx(WSe,{}),f.jsx(rTe,{}),f.jsx(jue,{}),f.jsx(JTe,{}),f.jsx(tbe,{}),f.jsx(abe,{}),f.jsx(jTe,{}),f.jsx(VTe,{}),f.jsx(iTe,{}),f.jsx(zue,{}),f.jsx(Wue,{}),f.jsx(nTe,{}),f.jsx(CTe,{}),f.jsx(QSe,{}),f.jsx(PTe,{}),f.jsx(JSe,{}),f.jsx(bTe,{}),f.jsx(dbe,{}),f.jsx(_be,{}),f.jsx(vbe,{}),f.jsx(Sbe,{}),f.jsx(QTe,{isOpen:s,onClose:a}),f.jsx(kn,{children:t&&f.jsx(iz,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${uw}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");wU.createRoot(document.getElementById("root")).render(f.jsx(Rbe,{}));export{Us as C,Xn as F,XC as G,ZK as I,bi as L,ri as P,hn as S,Eh as T,xl as V,MX as a,TX as b,mc as c,zn as d,ja as e,gr as f,fr as g,sg as h,bn as p,_B as r};
//# sourceMappingURL=index-giZw7zC8.js.map
